<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2015-June/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1433263250.447920.28908.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001230.html">
   <LINK REL="Next"  HREF="001232.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Rich Salz</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1433263250.447920.28908.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">rsalz at openssl.org
       </A><BR>
    <I>Tue Jun  2 16:40:50 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001230.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="001232.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1231">[ date ]</a>
              <a href="thread.html#1231">[ thread ]</a>
              <a href="subject.html#1231">[ subject ]</a>
              <a href="author.html#1231">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  9c3bcfa027cb32421ed20ab77553860b922b82fc (commit)
      from  366e2a60b2fcc727b061f1459343245476ad6c3b (commit)


- Log -----------------------------------------------------------------
commit 9c3bcfa027cb32421ed20ab77553860b922b82fc
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at akamai.com</A>&gt;
Date:   Fri May 15 13:50:38 2015 -0400

    Standardize handling of #ifdef'd options.
    
    Here are the &quot;rules&quot; for handling flags that depend on #ifdef:
    
    - Do not ifdef the enum.  Only ifdef the OPTIONS table.  All ifdef'd
      entries appear at the end; by convention &quot;engine&quot; is last.  This
      ensures that at run-time, the flag will never be recognized/allowed.
      The next two bullets entries are for silencing compiler warnings:
    - In the while/switch parsing statement, use #ifdef for the body to
      disable it; leave the &quot;case OPT_xxx:&quot; and &quot;break&quot; statements outside
      the ifdef/ifndef.  See ciphers.c for example.
    - If there are multiple options controlled by a single guard, OPT_FOO,
      OPT_BAR, etc., put a an #ifdef around the set, and then do &quot;#else&quot;
      and a series of case labels and a break. See OPENSSL_NO_AES in cms.c
      for example.
    
    Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;

-----------------------------------------------------------------------

Summary of changes:
 apps/ciphers.c  |  14 +++---
 apps/cms.c      |  15 ++++---
 apps/crl.c      |  16 +++----
 apps/dgst.c     |   2 +-
 apps/dhparam.c  |   6 +--
 apps/dsa.c      |  24 ++++++-----
 apps/dsaparam.c |   6 +--
 apps/ec.c       |   6 +--
 apps/enc.c      |  12 +++---
 apps/gendsa.c   |   2 +-
 apps/genpkey.c  |   1 +
 apps/passwd.c   |   4 +-
 apps/pkcs12.c   |   2 +-
 apps/req.c      |   2 +-
 apps/rsa.c      |  18 ++++----
 apps/s_client.c | 130 ++++++++++++++++++++++++++------------------------------
 apps/s_server.c | 127 +++++++++++++++++++++++++++++-------------------------
 apps/s_time.c   |   6 +--
 apps/speed.c    |  16 +++----
 apps/ts.c       |   2 +-
 apps/verify.c   |   2 +-
 apps/x509.c     |  28 ++++++------
 22 files changed, 222 insertions(+), 219 deletions(-)

diff --git a/apps/ciphers.c b/apps/ciphers.c
index b1b3bdd..a2ccf28 100644
--- a/apps/ciphers.c
+++ b/apps/ciphers.c
@@ -64,12 +64,8 @@
 
 typedef enum OPTION_choice {
     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,
-#ifndef OPENSSL_NO_SSL_TRACE
     OPT_STDNAME,
-#endif
-#ifndef OPENSSL_NO_SSL3
     OPT_SSL3,
-#endif
     OPT_TLS1,
     OPT_V, OPT_UPPER_V, OPT_S
 } OPTION_CHOICE;
@@ -79,13 +75,13 @@ OPTIONS ciphers_options[] = {
     {&quot;v&quot;, OPT_V, '-', &quot;Verbose listing of the SSL/TLS ciphers&quot;},
     {&quot;V&quot;, OPT_UPPER_V, '-', &quot;Even more verbose&quot;},
     {&quot;s&quot;, OPT_S, '-', &quot;Only supported ciphers&quot;},
+    {&quot;tls1&quot;, OPT_TLS1, '-', &quot;TLS1 mode&quot;},
 #ifndef OPENSSL_NO_SSL_TRACE
     {&quot;stdname&quot;, OPT_STDNAME, '-', &quot;Show standard cipher names&quot;},
 #endif
 #ifndef OPENSSL_NO_SSL3
     {&quot;ssl3&quot;, OPT_SSL3, '-', &quot;SSL3 mode&quot;},
 #endif
-    {&quot;tls1&quot;, OPT_TLS1, '-', &quot;TLS1 mode&quot;},
     {NULL}
 };
 
@@ -125,16 +121,16 @@ int ciphers_main(int argc, char **argv)
         case OPT_S:
             use_supported = 1;
             break;
-#ifndef OPENSSL_NO_SSL_TRACE
         case OPT_STDNAME:
+#ifndef OPENSSL_NO_SSL_TRACE
             stdname = verbose = 1;
-            break;
 #endif
-#ifndef OPENSSL_NO_SSL3
+            break;
         case OPT_SSL3:
+#ifndef OPENSSL_NO_SSL3
             meth = SSLv3_client_method();
-            break;
 #endif
+            break;
         case OPT_TLS1:
             meth = TLSv1_client_method();
             break;
diff --git a/apps/cms.c b/apps/cms.c
index 7ccca5b..e40686b 100644
--- a/apps/cms.c
+++ b/apps/cms.c
@@ -208,6 +208,8 @@ OPTIONS cms_options[] = {
     {&quot;keyopt&quot;, OPT_KEYOPT, 's', &quot;Set public key parameters as n:v pairs&quot;},
     {&quot;receipt_request_from&quot;, OPT_RR_FROM, 's'},
     {&quot;receipt_request_to&quot;, OPT_RR_TO, 's'},
+    {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
+    OPT_V_OPTIONS,
 # ifndef OPENSSL_NO_AES
     {&quot;aes128-wrap&quot;, OPT_AES128_WRAP, '-', &quot;Use AES128 to wrap key&quot;},
     {&quot;aes192-wrap&quot;, OPT_AES192_WRAP, '-', &quot;Use AES192 to wrap key&quot;},
@@ -219,9 +221,7 @@ OPTIONS cms_options[] = {
 # ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
 # endif
-    {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
-    OPT_V_OPTIONS,
-    {NULL},
+    {NULL}
 };
 
 int cms_main(int argc, char **argv)
@@ -588,11 +588,11 @@ int cms_main(int argc, char **argv)
                 goto end;
             vpmtouched++;
             break;
-# ifndef OPENSSL_NO_DES
         case OPT_3DES_WRAP:
+# ifndef OPENSSL_NO_DES
             wrap_cipher = EVP_des_ede3_wrap();
-            break;
 # endif
+            break;
 # ifndef OPENSSL_NO_AES
         case OPT_AES128_WRAP:
             wrap_cipher = EVP_aes_128_wrap();
@@ -603,6 +603,11 @@ int cms_main(int argc, char **argv)
         case OPT_AES256_WRAP:
             wrap_cipher = EVP_aes_256_wrap();
             break;
+# else
+        case OPT_AES128_WRAP:
+        case OPT_AES192_WRAP:
+        case OPT_AES256_WRAP:
+            break;
 # endif
         }
     }
diff --git a/apps/crl.c b/apps/crl.c
index 17391e2..c897335 100644
--- a/apps/crl.c
+++ b/apps/crl.c
@@ -95,11 +95,11 @@ OPTIONS crl_options[] = {
     {&quot;verify&quot;, OPT_VERIFY, '-'},
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Print out a text format version&quot;},
     {&quot;hash&quot;, OPT_HASH, '-', &quot;Print hash value&quot;},
+    {&quot;nameopt&quot;, OPT_NAMEOPT, 's', &quot;Various certificate name options&quot;},
+    {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest&quot;},
 #ifndef OPENSSL_NO_MD5
     {&quot;hash_old&quot;, OPT_HASH_OLD, '-', &quot;Print old-style (MD5) hash value&quot;},
 #endif
-    {&quot;nameopt&quot;, OPT_NAMEOPT, 's', &quot;Various certificate name options&quot;},
-    {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest&quot;},
     {NULL}
 };
 
@@ -117,11 +117,11 @@ int crl_main(int argc, char **argv)
     char *infile = NULL, *outfile = NULL, *crldiff = NULL, *keyfile = NULL;
     char *CAfile = NULL, *CApath = NULL, *prog;
     OPTION_CHOICE o;
-    int hash = 0, issuer = 0, lastupdate = 0, nextupdate = 0, noout =
-        0, text = 0;
+    int hash = 0, issuer = 0, lastupdate = 0, nextupdate = 0, noout = 0;
     int informat = FORMAT_PEM, outformat = FORMAT_PEM, keyformat = FORMAT_PEM;
-    int ret = 1, num = 0, badsig = 0, fingerprint = 0, crlnumber =
-        0, i, do_ver = 0;
+    int ret = 1, num = 0, badsig = 0, fingerprint = 0, crlnumber = 0;
+    int text = 0, do_ver = 0;
+    int i;
 #ifndef OPENSSL_NO_MD5
     int hash_old = 0;
 #endif
@@ -170,11 +170,11 @@ int crl_main(int argc, char **argv)
             CAfile = opt_arg();
             do_ver = 1;
             break;
-#ifndef OPENSSL_NO_MD5
         case OPT_HASH_OLD:
+#ifndef OPENSSL_NO_MD5
             hash_old = ++num;
-            break;
 #endif
+            break;
         case OPT_VERIFY:
             do_ver = 1;
             break;
diff --git a/apps/dgst.c b/apps/dgst.c
index 308555c..e6142ca 100644
--- a/apps/dgst.c
+++ b/apps/dgst.c
@@ -111,11 +111,11 @@ OPTIONS dgst_options[] = {
     {&quot;mac&quot;, OPT_MAC, 's', &quot;Create MAC (not neccessarily HMAC)&quot;},
     {&quot;sigop&quot;, OPT_SIGOPT, 's', &quot;Signature parameter in n:v form&quot;},
     {&quot;macop&quot;, OPT_MACOPT, 's', &quot;MAC algorithm parameters in n:v form or key&quot;},
+    {&quot;&quot;, OPT_DIGEST, '-', &quot;Any supported digest&quot;},
 #ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
     {&quot;engine_impl&quot;, OPT_ENGINE_IMPL, '-'},
 #endif
-    {&quot;&quot;, OPT_DIGEST, '-', &quot;Any supported digest&quot;},
     {NULL}
 };
 
diff --git a/apps/dhparam.c b/apps/dhparam.c
index 931bf10..2e5ce2c 100644
--- a/apps/dhparam.c
+++ b/apps/dhparam.c
@@ -153,13 +153,13 @@ OPTIONS dhparam_options[] = {
     {&quot;C&quot;, OPT_C, '-', &quot;Print C code&quot;},
     {&quot;2&quot;, OPT_2, '-', &quot;Generate parameters using 2 as the generator value&quot;},
     {&quot;5&quot;, OPT_5, '-', &quot;Generate parameters using 5 as the generator value&quot;},
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
-# endif
 # ifndef OPENSSL_NO_DSA
     {&quot;dsaparam&quot;, OPT_DSAPARAM, '-',
      &quot;Read or generate DSA parameters, convert to DH&quot;},
 # endif
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
+# endif
     {NULL}
 };
 
diff --git a/apps/dsa.c b/apps/dsa.c
index f02f293..f61e151 100644
--- a/apps/dsa.c
+++ b/apps/dsa.c
@@ -82,14 +82,8 @@ OPTIONS dsa_options[] = {
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
     {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format, DER PEM PVK&quot;},
     {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format, DER PEM PVK&quot;},
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
-# endif
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
-    {&quot;pvk-strong&quot;, OPT_PVK_STRONG, '-'},
-    {&quot;pvk-weak&quot;, OPT_PVK_WEAK, '-'},
-    {&quot;pvk-none&quot;, OPT_PVK_NONE, '-'},
     {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't print key out&quot;},
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Print the key in text&quot;},
     {&quot;modulus&quot;, OPT_MODULUS, '-', &quot;Print the DSA public value&quot;},
@@ -98,6 +92,14 @@ OPTIONS dsa_options[] = {
     {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
     {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
     {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
+# ifndef OPENSSL_NO_RC4
+    {&quot;pvk-strong&quot;, OPT_PVK_STRONG, '-'},
+    {&quot;pvk-weak&quot;, OPT_PVK_WEAK, '-'},
+    {&quot;pvk-none&quot;, OPT_PVK_NONE, '-'},
+# endif
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
+# endif
     {NULL}
 };
 
@@ -118,11 +120,6 @@ int dsa_main(int argc, char **argv)
         switch (o) {
         case OPT_EOF:
         case OPT_ERR:
-#ifdef OPENSSL_NO_RC4
-        case OPT_PVK_STRONG:
-        case OPT_PVK_WEAK:
-        case OPT_PVK_NONE:
-#endif
  opthelp:
             ret = 0;
             BIO_printf(bio_err, &quot;%s: Use -help for summary.\n&quot;, prog);
@@ -166,6 +163,11 @@ int dsa_main(int argc, char **argv)
         case OPT_PVK_NONE:
             pvk_encr = 0;
             break;
+#else
+        case OPT_PVK_STRONG:
+        case OPT_PVK_WEAK:
+        case OPT_PVK_NONE:
+            break;
 #endif
         case OPT_NOOUT:
             noout = 1;
diff --git a/apps/dsaparam.c b/apps/dsaparam.c
index ffd81ff..27170a2 100644
--- a/apps/dsaparam.c
+++ b/apps/dsaparam.c
@@ -103,12 +103,12 @@ OPTIONS dsaparam_options[] = {
     {&quot;genkey&quot;, OPT_GENKEY, '-', &quot;Generate a DSA key&quot;},
     {&quot;rand&quot;, OPT_RAND, 's', &quot;Files to use for random number input&quot;},
     {&quot;non-fips-allow&quot;, OPT_NON_FIPS_ALLOW, '-'},
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
-# endif
 # ifdef GENCB_TEST
     {&quot;timebomb&quot;, OPT_TIMEBOMB, 'p', &quot;Interrupt keygen after 'pnum' seconds&quot;},
 # endif
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
+# endif
     {NULL}
 };
 
diff --git a/apps/ec.c b/apps/ec.c
index 83a6aa4..341243f 100644
--- a/apps/ec.c
+++ b/apps/ec.c
@@ -92,9 +92,6 @@ OPTIONS ec_options[] = {
     {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format - DER or PEM&quot;},
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
     {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format - DER or PEM&quot;},
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-# endif
     {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't print key out&quot;},
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Print the key&quot;},
     {&quot;param_out&quot;, OPT_PARAM_OUT, '-', &quot;Print the elliptic curve parameters&quot;},
@@ -106,6 +103,9 @@ OPTIONS ec_options[] = {
      &quot;Specifies the way the ec parameters are encoded&quot;},
     {&quot;conv_form&quot;, OPT_CONV_FORM, 's', &quot;Specifies the point conversion form &quot;},
     {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+# endif
     {NULL}
 };
 
diff --git a/apps/enc.c b/apps/enc.c
index d045d15..628142a 100644
--- a/apps/enc.c
+++ b/apps/enc.c
@@ -92,9 +92,6 @@ OPTIONS enc_options[] = {
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
     {&quot;pass&quot;, OPT_PASS, 's', &quot;Passphrase source&quot;},
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-#endif
     {&quot;e&quot;, OPT_E, '-', &quot;Encrypt&quot;},
     {&quot;d&quot;, OPT_D, '-', &quot;Decrypt&quot;},
     {&quot;p&quot;, OPT_P, '-', &quot;Print the iv/key&quot;},
@@ -107,9 +104,6 @@ OPTIONS enc_options[] = {
     {&quot;A&quot;, OPT_UPPER_A, '-'},
     {&quot;a&quot;, OPT_A, '-', &quot;base64 encode/decode, depending on encryption flag&quot;},
     {&quot;base64&quot;, OPT_A, '-', &quot;Base64 output as a single line&quot;},
-#ifdef ZLIB
-    {&quot;z&quot;, OPT_Z, '-', &quot;Use zlib as the 'encryption'&quot;},
-#endif
     {&quot;bufsize&quot;, OPT_BUFSIZE, 's', &quot;Buffer size&quot;},
     {&quot;k&quot;, OPT_K, 's', &quot;Passphrase&quot;},
     {&quot;kfile&quot;, OPT_KFILE, '&lt;', &quot;Fead passphrase from file&quot;},
@@ -120,6 +114,12 @@ OPTIONS enc_options[] = {
     {&quot;non-fips-allow&quot;, OPT_NON_FIPS_ALLOW, '-'},
     {&quot;none&quot;, OPT_NONE, '-', &quot;Don't encrypt&quot;},
     {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
+#ifdef ZLIB
+    {&quot;z&quot;, OPT_Z, '-', &quot;Use zlib as the 'encryption'&quot;},
+#endif
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#endif
     {NULL}
 };
 
diff --git a/apps/gendsa.c b/apps/gendsa.c
index a832ec3..01bbceb 100644
--- a/apps/gendsa.c
+++ b/apps/gendsa.c
@@ -84,10 +84,10 @@ OPTIONS gendsa_options[] = {
     {&quot;passout&quot;, OPT_PASSOUT, 's'},
     {&quot;rand&quot;, OPT_RAND, 's',
      &quot;Load the file(s) into the random number generator&quot;},
+    {&quot;&quot;, OPT_CIPHER, '-', &quot;Encrypt the output with any supported cipher&quot;},
 # ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
 # endif
-    {&quot;&quot;, OPT_CIPHER, '-', &quot;Encrypt the output with any supported cipher&quot;},
     {NULL}
 };
 
diff --git a/apps/genpkey.c b/apps/genpkey.c
index b9843cf..7c8d551 100644
--- a/apps/genpkey.c
+++ b/apps/genpkey.c
@@ -89,6 +89,7 @@ OPTIONS genpkey_options[] = {
 #ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
 #endif
+    /* This is deliberately last. */
     {OPT_HELP_STR, 1, 1,
      &quot;Order of options may be important!  See the documentation.\n&quot;},
     {NULL}
diff --git a/apps/passwd.c b/apps/passwd.c
index f34ef9f..2e37629 100644
--- a/apps/passwd.c
+++ b/apps/passwd.c
@@ -101,6 +101,8 @@ OPTIONS passwd_options[] = {
     {&quot;quiet&quot;, OPT_QUIET, '-', &quot;No warnings&quot;},
     {&quot;table&quot;, OPT_TABLE, '-', &quot;Format output as table&quot;},
     {&quot;reverse&quot;, OPT_REVERSE, '-', &quot;Switch table columns&quot;},
+    {&quot;salt&quot;, OPT_SALT, 's', &quot;Use provided salt&quot;},
+    {&quot;stdin&quot;, OPT_STDIN, '-', &quot;Read passwords from stdin&quot;},
 # ifndef NO_MD5CRYPT_1
     {&quot;apr1&quot;, OPT_APR1, '-', &quot;MD5-based password algorithm, Apache variant&quot;},
     {&quot;1&quot;, OPT_1, '-', &quot;MD5-based password algorithm&quot;},
@@ -108,8 +110,6 @@ OPTIONS passwd_options[] = {
 # ifndef OPENSSL_NO_DES
     {&quot;crypt&quot;, OPT_CRYPT, '-', &quot;Standard Unix password algorithm (default)&quot;},
 # endif
-    {&quot;salt&quot;, OPT_SALT, 's', &quot;Use provided salt&quot;},
-    {&quot;stdin&quot;, OPT_STDIN, '-', &quot;Read passwords from stdin&quot;},
     {NULL}
 };
 
diff --git a/apps/pkcs12.c b/apps/pkcs12.c
index 82131e8..9ab7f69 100644
--- a/apps/pkcs12.c
+++ b/apps/pkcs12.c
@@ -149,10 +149,10 @@ OPTIONS pkcs12_options[] = {
     {&quot;password&quot;, OPT_PASSWORD, 's', &quot;Set import/export password source&quot;},
     {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;PEM-format directory of CA's&quot;},
     {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;PEM-format file of CA's&quot;},
+    {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
 # ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
 # endif
-    {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
     {NULL}
 };
 
diff --git a/apps/req.c b/apps/req.c
index 3bae59e..00d7c4a 100644
--- a/apps/req.c
+++ b/apps/req.c
@@ -176,11 +176,11 @@ OPTIONS req_options[] = {
      &quot;Cert extension section (override value in config file)&quot;},
     {&quot;reqexts&quot;, OPT_REQEXTS, 's',
      &quot;Request extension section (override value in config file)&quot;},
+    {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest&quot;},
 #ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
     {&quot;keygen_engine&quot;, OPT_KEYGEN_ENGINE, 's'},
 #endif
-    {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest&quot;},
     {NULL}
 };
 
diff --git a/apps/rsa.c b/apps/rsa.c
index 87cb702..51581ae 100644
--- a/apps/rsa.c
+++ b/apps/rsa.c
@@ -138,14 +138,16 @@ OPTIONS rsa_options[] = {
     {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
     {&quot;RSAPublicKey_in&quot;, OPT_RSAPUBKEY_IN, '-', &quot;Input is an RSAPublicKey&quot;},
     {&quot;RSAPublicKey_out&quot;, OPT_RSAPUBKEY_OUT, '-', &quot;Output is an RSAPublicKey&quot;},
-    {&quot;pvk-strong&quot;, OPT_PVK_STRONG, '-'},
-    {&quot;pvk-weak&quot;, OPT_PVK_WEAK, '-'},
-    {&quot;pvk-none&quot;, OPT_PVK_NONE, '-'},
     {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't print key out&quot;},
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Print the key in text&quot;},
     {&quot;modulus&quot;, OPT_MODULUS, '-', &quot;Print the RSA key modulus&quot;},
     {&quot;check&quot;, OPT_CHECK, '-', &quot;Verify key consistency&quot;},
     {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
+# ifdef OPENSSL_NO_RC4
+    {&quot;pvk-strong&quot;, OPT_PVK_STRONG, '-'},
+    {&quot;pvk-weak&quot;, OPT_PVK_WEAK, '-'},
+    {&quot;pvk-none&quot;, OPT_PVK_NONE, '-'},
+# endif
 # ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
 # endif
@@ -170,11 +172,6 @@ int rsa_main(int argc, char **argv)
         switch (o) {
         case OPT_EOF:
         case OPT_ERR:
-#ifdef OPENSSL_NO_RC4
-        case OPT_PVK_STRONG:
-        case OPT_PVK_WEAK:
-        case OPT_PVK_NONE:
-#endif
  opthelp:
             BIO_printf(bio_err, &quot;%s: Use -help for summary.\n&quot;, prog);
             goto end;
@@ -227,6 +224,11 @@ int rsa_main(int argc, char **argv)
         case OPT_PVK_NONE:
             pvk_encr = 0;
             break;
+#else
+        case OPT_PVK_STRONG:
+        case OPT_PVK_WEAK:
+        case OPT_PVK_NONE:
+            break;
 #endif
         case OPT_NOOUT:
             noout = 1;
diff --git a/apps/s_client.c b/apps/s_client.c
index 009e5fe..22aa270 100644
--- a/apps/s_client.c
+++ b/apps/s_client.c
@@ -509,17 +509,9 @@ OPTIONS s_client_options[] = {
     {&quot;quiet&quot;, OPT_QUIET, '-', &quot;No s_client output&quot;},
     {&quot;ign_eof&quot;, OPT_IGN_EOF, '-', &quot;Ignore input eof (default when -quiet)&quot;},
     {&quot;no_ign_eof&quot;, OPT_NO_IGN_EOF, '-', &quot;Don't ignore input eof&quot;},
-#ifndef OPENSSL_NO_SSL3
-    {&quot;ssl3&quot;, OPT_SSL3, '-', &quot;Just use SSLv3&quot;},
-#endif
     {&quot;tls1_2&quot;, OPT_TLS1_2, '-', &quot;Just use TLSv1.2&quot;},
     {&quot;tls1_1&quot;, OPT_TLS1_1, '-', &quot;Just use TLSv1.1&quot;},
     {&quot;tls1&quot;, OPT_TLS1, '-', &quot;Just use TLSv1&quot;},
-    {&quot;dtls&quot;, OPT_DTLS, '-'},
-    {&quot;dtls1&quot;, OPT_DTLS1, '-', &quot;Just use DTLSv1&quot;},
-    {&quot;dtls1_2&quot;, OPT_DTLS1_2, '-'},
-    {&quot;timeout&quot;, OPT_TIMEOUT, '-'},
-    {&quot;mtu&quot;, OPT_MTU, 'p', &quot;Set the link layer MTU&quot;},
     {&quot;starttls&quot;, OPT_STARTTLS, 's',
      &quot;Use the STARTTLS command before starting TLS&quot;},
     {&quot;xmpphost&quot;, OPT_XMPPHOST, 's', &quot;Host to use with \&quot;-starttls xmpp\&quot;&quot;},
@@ -534,6 +526,48 @@ OPTIONS s_client_options[] = {
     {&quot;keymatexportlen&quot;, OPT_KEYMATEXPORTLEN, 'p',
      &quot;Export len bytes of keying material (default 20)&quot;},
     {&quot;fallback_scsv&quot;, OPT_FALLBACKSCSV, '-', &quot;Send the fallback SCSV&quot;},
+    {&quot;name&quot;, OPT_SMTPHOST, 's', &quot;Hostname to use for \&quot;-starttls smtp\&quot;&quot;},
+    {&quot;CRL&quot;, OPT_CRL, '&lt;'},
+    {&quot;crl_download&quot;, OPT_CRL_DOWNLOAD, '-'},
+    {&quot;CRLform&quot;, OPT_CRLFORM, 'F'},
+    {&quot;verify_return_error&quot;, OPT_VERIFY_RET_ERROR, '-'},
+    {&quot;verify_quiet&quot;, OPT_VERIFY_QUIET, '-'},
+    {&quot;brief&quot;, OPT_BRIEF, '-'},
+    {&quot;prexit&quot;, OPT_PREXIT, '-'},
+    {&quot;security_debug&quot;, OPT_SECURITY_DEBUG, '-'},
+    {&quot;security_debug_verbose&quot;, OPT_SECURITY_DEBUG_VERBOSE, '-'},
+    {&quot;cert_chain&quot;, OPT_CERT_CHAIN, '&lt;'},
+    {&quot;chainCApath&quot;, OPT_CHAINCAPATH, '/'},
+    {&quot;verifyCApath&quot;, OPT_VERIFYCAPATH, '/'},
+    {&quot;build_chain&quot;, OPT_BUILD_CHAIN, '-'},
+    {&quot;chainCAfile&quot;, OPT_CHAINCAFILE, '&lt;'},
+    {&quot;verifyCAfile&quot;, OPT_VERIFYCAFILE, '&lt;'},
+    {&quot;nocommands&quot;, OPT_NOCMDS, '-', &quot;Do not use interactive command letters&quot;},
+    {&quot;servername&quot;, OPT_SERVERNAME, 's',
+     &quot;Set TLS extension servername in ClientHello&quot;},
+    {&quot;tlsextdebug&quot;, OPT_TLSEXTDEBUG, '-',
+     &quot;Hex dump of all TLS extensions received&quot;},
+    {&quot;status&quot;, OPT_STATUS, '-', &quot;Request certificate status from server&quot;},
+    {&quot;serverinfo&quot;, OPT_SERVERINFO, 's',
+     &quot;types  Send empty ClientHello extensions (comma-separated numbers)&quot;},
+    {&quot;alpn&quot;, OPT_ALPN, 's',
+     &quot;Enable ALPN extension, considering named protocols supported (comma-separated list)&quot;},
+    OPT_S_OPTIONS,
+    OPT_V_OPTIONS,
+    OPT_X_OPTIONS,
+#ifndef OPENSSL_NO_SSL3
+    {&quot;ssl3&quot;, OPT_SSL3, '-', &quot;Just use SSLv3&quot;},
+#endif
+#ifndef OPENSSL_NO_DTLS1
+    {&quot;dtls&quot;, OPT_DTLS, '-'},
+    {&quot;dtls1&quot;, OPT_DTLS1, '-', &quot;Just use DTLSv1&quot;},
+    {&quot;dtls1_2&quot;, OPT_DTLS1_2, '-'},
+    {&quot;timeout&quot;, OPT_TIMEOUT, '-'},
+    {&quot;mtu&quot;, OPT_MTU, 'p', &quot;Set the link layer MTU&quot;},
+#endif
+#ifndef OPENSSL_NO_SSL_TRACE
+    {&quot;trace&quot;, OPT_TRACE, '-'},
+#endif
 #ifdef WATT32
     {&quot;wdebug&quot;, OPT_WDEBUG, '-', &quot;WATT-32 tcp debugging&quot;},
 #endif
@@ -556,44 +590,14 @@ OPTIONS s_client_options[] = {
      &quot;Tolerate other than the known g N values.&quot;},
     {&quot;srp_strength&quot;, OPT_SRP_STRENGTH, 'p', &quot;Minimal mength in bits for N&quot;},
 #endif
-    {&quot;name&quot;, OPT_SMTPHOST, 's', &quot;Hostname to use for \&quot;-starttls smtp\&quot;&quot;},
-    {&quot;servername&quot;, OPT_SERVERNAME, 's',
-     &quot;Set TLS extension servername in ClientHello&quot;},
-    {&quot;tlsextdebug&quot;, OPT_TLSEXTDEBUG, '-',
-     &quot;Hex dump of all TLS extensions received&quot;},
-    {&quot;status&quot;, OPT_STATUS, '-', &quot;Request certificate status from server&quot;},
-    {&quot;serverinfo&quot;, OPT_SERVERINFO, 's',
-     &quot;types  Send empty ClientHello extensions (comma-separated numbers)&quot;},
-    {&quot;alpn&quot;, OPT_ALPN, 's',
-     &quot;Enable ALPN extension, considering named protocols supported (comma-separated list)&quot;},
 #ifndef OPENSSL_NO_NEXTPROTONEG
     {&quot;nextprotoneg&quot;, OPT_NEXTPROTONEG, 's',
      &quot;Enable NPN extension, considering named protocols supported (comma-separated list)&quot;},
 #endif
-    {&quot;CRL&quot;, OPT_CRL, '&lt;'},
-    {&quot;crl_download&quot;, OPT_CRL_DOWNLOAD, '-'},
-    {&quot;CRLform&quot;, OPT_CRLFORM, 'F'},
-    {&quot;verify_return_error&quot;, OPT_VERIFY_RET_ERROR, '-'},
-    {&quot;verify_quiet&quot;, OPT_VERIFY_QUIET, '-'},
-    {&quot;brief&quot;, OPT_BRIEF, '-'},
-    {&quot;prexit&quot;, OPT_PREXIT, '-'},
-    {&quot;trace&quot;, OPT_TRACE, '-'},
-    {&quot;security_debug&quot;, OPT_SECURITY_DEBUG, '-'},
-    {&quot;security_debug_verbose&quot;, OPT_SECURITY_DEBUG_VERBOSE, '-'},
-    {&quot;cert_chain&quot;, OPT_CERT_CHAIN, '&lt;'},
-    {&quot;chainCApath&quot;, OPT_CHAINCAPATH, '/'},
-    {&quot;verifyCApath&quot;, OPT_VERIFYCAPATH, '/'},
-    {&quot;build_chain&quot;, OPT_BUILD_CHAIN, '-'},
-    {&quot;chainCAfile&quot;, OPT_CHAINCAFILE, '&lt;'},
-    {&quot;verifyCAfile&quot;, OPT_VERIFYCAFILE, '&lt;'},
-    {&quot;nocommands&quot;, OPT_NOCMDS, '-', &quot;Do not use interactive command letters&quot;},
 #ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
     {&quot;ssl_client_engine&quot;, OPT_SSL_CLIENT_ENGINE, 's'},
 #endif
-    OPT_S_OPTIONS,
-    OPT_V_OPTIONS,
-    OPT_X_OPTIONS,
     {NULL}
 };
 
@@ -706,29 +710,6 @@ int s_client_main(int argc, char **argv)
     prog = opt_init(argc, argv, s_client_options);
     while ((o = opt_next()) != OPT_EOF) {
         switch (o) {
-#ifndef WATT32
-        case OPT_WDEBUG:
-#endif
-#ifdef OPENSSL_NO_JPAKE
-        case OPT_JPAKE:
-#endif
-#ifdef OPENSSL_NO_SSL_TRACE
-        case OPT_TRACE:
-#endif
-#ifdef OPENSSL_NO_PSK
-        case OPT_PSK_IDENTITY:
-        case OPT_PSK:
-#endif
-#ifdef OPENSSL_NO_SSL3
-        case OPT_SSL3:
-#endif
-#ifdef OPENSSL_NO_DTLS1
-        case OPT_DTLS:
-        case OPT_DTLS1:
-        case OPT_DTLS1_2:
-        case OPT_TIMEOUT:
-        case OPT_MTU:
-#endif
         case OPT_EOF:
         case OPT_ERR:
  opthelp:
@@ -866,22 +847,22 @@ int s_client_main(int argc, char **argv)
         case OPT_STATUS:
             c_status_req = 1;
             break;
-#ifdef WATT32
         case OPT_WDEBUG:
+#ifdef WATT32
             dbug_init();
-            break;
 #endif
+            break;
         case OPT_MSG:
             c_msg = 1;
             break;
         case OPT_MSGFILE:
             bio_c_msg = BIO_new_file(opt_arg(), &quot;w&quot;);
             break;
-#ifndef OPENSSL_NO_SSL_TRACE
         case OPT_TRACE:
+#ifndef OPENSSL_NO_SSL_TRACE
             c_msg = 2;
-            break;
 #endif
+            break;
         case OPT_SECURITY_DEBUG:
             sdebug = 1;
             break;
@@ -908,6 +889,9 @@ int s_client_main(int argc, char **argv)
                 BIO_printf(bio_err, &quot;Not a hex number '%s'\n&quot;, psk_key);
                 goto end;
             }
+#else
+        case OPT_PSK_IDENTITY:
+        case OPT_PSK:
             break;
 #endif
 #ifndef OPENSSL_NO_SRP
@@ -941,11 +925,11 @@ int s_client_main(int argc, char **argv)
         case OPT_SRP_MOREGROUPS:
             break;
 #endif
-#ifndef OPENSSL_NO_SSL3
         case OPT_SSL3:
+#ifndef OPENSSL_NO_SSL3
             meth = SSLv3_client_method();
-            break;
 #endif
+            break;
         case OPT_TLS1_2:
             meth = TLSv1_2_client_method();
             break;
@@ -974,6 +958,13 @@ int s_client_main(int argc, char **argv)
         case OPT_MTU:
             socket_mtu = atol(opt_arg());
             break;
+#else
+        case OPT_DTLS:
+        case OPT_DTLS1:
+        case OPT_DTLS1_2:
+        case OPT_TIMEOUT:
+        case OPT_MTU:
+            break;
 #endif
         case OPT_FALLBACKSCSV:
             fallback_scsv = 1;
@@ -1038,13 +1029,12 @@ int s_client_main(int argc, char **argv)
                 goto end;
         case OPT_SERVERNAME:
             servername = opt_arg();
-            /* meth=TLSv1_client_method(); */
             break;
-#ifndef OPENSSL_NO_JPAKE
         case OPT_JPAKE:
+#ifndef OPENSSL_NO_JPAKE
             jpake_secret = opt_arg();
-            break;
 #endif
+            break;
         case OPT_USE_SRTP:
             srtp_profiles = opt_arg();
             break;
diff --git a/apps/s_server.c b/apps/s_server.c
index 189019d..6bd0257 100644
--- a/apps/s_server.c
+++ b/apps/s_server.c
@@ -806,9 +806,7 @@ typedef enum OPTION_choice {
     OPT_BRIEF, OPT_NO_TMP_RSA, OPT_NO_DHE, OPT_NO_ECDHE,
     OPT_NO_RESUME_EPHEMERAL, OPT_PSK_HINT, OPT_PSK, OPT_SRPVFILE,
     OPT_SRPUSERSEED, OPT_REV, OPT_WWW, OPT_UPPER_WWW, OPT_HTTP,
-#ifndef OPENSSL_NO_SSL3
     OPT_SSL3,
-#endif
     OPT_TLS1_2, OPT_TLS1_1, OPT_TLS1, OPT_DTLS, OPT_DTLS1,
     OPT_DTLS1_2, OPT_TIMEOUT, OPT_MTU, OPT_CHAIN,
     OPT_ID_PREFIX, OPT_RAND, OPT_SERVERNAME, OPT_SERVERNAME_FATAL,
@@ -821,7 +819,6 @@ typedef enum OPTION_choice {
 
 OPTIONS s_server_options[] = {
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-
     {&quot;port&quot;, OPT_PORT, 'p'},
     {&quot;accept&quot;, OPT_PORT, 'p',
      &quot;TCP/IP port to accept on (default is &quot; PORT_STR &quot;)&quot;},
@@ -851,9 +848,6 @@ OPTIONS s_server_options[] = {
     {&quot;dkeyform&quot;, OPT_DKEYFORM, 'F',
      &quot;Second key format (PEM, DER or ENGINE) PEM default&quot;},
     {&quot;dpass&quot;, OPT_DPASS, 's', &quot;Second private key file pass phrase source&quot;},
-#ifdef FIONBIO
-    {&quot;nbio&quot;, OPT_NBIO, '-', &quot;Use non-blocking IO&quot;},
-#endif
     {&quot;nbio_test&quot;, OPT_NBIO_TEST, '-', &quot;Test with the non-blocking test bio&quot;},
     {&quot;crlf&quot;, OPT_CRLF, '-', &quot;Convert LF from terminal into CRLF&quot;},
     {&quot;debug&quot;, OPT_DEBUG, '-', &quot;Print more output&quot;},
@@ -865,47 +859,13 @@ OPTIONS s_server_options[] = {
     {&quot;nocert&quot;, OPT_NOCERT, '-', &quot;Don't use any certificates (Anon-DH)&quot;},
     {&quot;quiet&quot;, OPT_QUIET, '-', &quot;No server output&quot;},
     {&quot;no_tmp_rsa&quot;, OPT_NO_TMP_RSA, '-', &quot;Do not generate a tmp RSA key&quot;},
-#ifndef OPENSSL_NO_PSK
-    {&quot;psk_hint&quot;, OPT_PSK_HINT, 's', &quot;PSK identity hint to use&quot;},
-    {&quot;psk&quot;, OPT_PSK, 's', &quot;PSK in hex (without 0x)&quot;},
-# ifndef OPENSSL_NO_JPAKE
-    {&quot;jpake&quot;, OPT_JPAKE, 's', &quot;JPAKE secret to use&quot;},
-# endif
-#endif
-#ifndef OPENSSL_NO_SRP
-    {&quot;srpvfile&quot;, OPT_SRPVFILE, '&lt;', &quot;The verifier file for SRP&quot;},
-    {&quot;srpuserseed&quot;, OPT_SRPUSERSEED, 's',
-     &quot;A seed string for a default user salt&quot;},
-#endif
-#ifndef OPENSSL_NO_SSL3
-    {&quot;ssl3&quot;, OPT_SSL3, '-', &quot;Just talk SSLv3&quot;},
-#endif
     {&quot;tls1_2&quot;, OPT_TLS1_2, '-', &quot;just talk TLSv1.2&quot;},
     {&quot;tls1_1&quot;, OPT_TLS1_1, '-', &quot;Just talk TLSv1.1&quot;},
     {&quot;tls1&quot;, OPT_TLS1, '-', &quot;Just talk TLSv1&quot;},
-#ifndef OPENSSL_NO_DTLS1
-    {&quot;dtls&quot;, OPT_DTLS, '-'},
-    {&quot;dtls1&quot;, OPT_DTLS1, '-', &quot;Just talk DTLSv1&quot;},
-    {&quot;dtls1_2&quot;, OPT_DTLS1_2, '-', &quot;Just talk DTLSv1.2&quot;},
-    {&quot;timeout&quot;, OPT_TIMEOUT, '-', &quot;Enable timeouts&quot;},
-    {&quot;mtu&quot;, OPT_MTU, 'p', &quot;Set link layer MTU&quot;},
-    {&quot;chain&quot;, OPT_CHAIN, '-', &quot;Read a certificate chain&quot;},
-#endif
-#ifndef OPENSSL_NO_DH
-    {&quot;no_dhe&quot;, OPT_NO_DHE, '-', &quot;Disable ephemeral DH&quot;},
-#endif
-#ifndef OPENSSL_NO_EC
-    {&quot;no_ecdhe&quot;, OPT_NO_ECDHE, '-', &quot;Disable ephemeral ECDH&quot;},
-#endif
     {&quot;no_resume_ephemeral&quot;, OPT_NO_RESUME_EPHEMERAL, '-',
      &quot;Disable caching and tickets if ephemeral (EC)DH is used&quot;},
     {&quot;www&quot;, OPT_WWW, '-', &quot;Respond to a 'GET /' with a status page&quot;},
     {&quot;WWW&quot;, OPT_UPPER_WWW, '-', &quot;Respond to a 'GET with the file ./path&quot;},
-    {&quot;HTTP&quot;, OPT_HTTP, '-', &quot;Like -WWW but ./path incluedes HTTP headers&quot;},
-    {&quot;id_prefix&quot;, OPT_ID_PREFIX, 's',
-     &quot;Generate SSL/TLS session IDs prefixed by arg&quot;},
-    {&quot;rand&quot;, OPT_RAND, 's',
-     &quot;Load the file(s) into the random number generator&quot;},
     {&quot;servername&quot;, OPT_SERVERNAME, 's',
      &quot;Servername for HostName TLS extension&quot;},
     {&quot;servername_fatal&quot;, OPT_SERVERNAME_FATAL, '-',
@@ -916,14 +876,11 @@ OPTIONS s_server_options[] = {
      &quot;-Private Key file to use for servername if not in -cert2&quot;},
     {&quot;tlsextdebug&quot;, OPT_TLSEXTDEBUG, '-',
      &quot;Hex dump of all TLS extensions received&quot;},
-#ifndef OPENSSL_NO_NEXTPROTONEG
-    {&quot;nextprotoneg&quot;, OPT_NEXTPROTONEG, 's',
-     &quot;Set the advertised protocols for the NPN extension (comma-separated list)&quot;},
-#endif
-    {&quot;use_srtp&quot;, OPT_SRTP_PROFILES, '&lt;',
-     &quot;Offer SRTP key management with a colon-separated profile list&quot;},
-    {&quot;alpn&quot;, OPT_ALPN, 's',
-     &quot;Set the advertised protocols for the ALPN extension (comma-separated list)&quot;},
+    {&quot;HTTP&quot;, OPT_HTTP, '-', &quot;Like -WWW but ./path incluedes HTTP headers&quot;},
+    {&quot;id_prefix&quot;, OPT_ID_PREFIX, 's',
+     &quot;Generate SSL/TLS session IDs prefixed by arg&quot;},
+    {&quot;rand&quot;, OPT_RAND, 's',
+     &quot;Load the file(s) into the random number generator&quot;},
     {&quot;keymatexport&quot;, OPT_KEYMATEXPORT, 's',
      &quot;Export keying material using label&quot;},
     {&quot;keymatexportlen&quot;, OPT_KEYMATEXPORTLEN, 'p',
@@ -953,12 +910,54 @@ OPTIONS s_server_options[] = {
     {&quot;security_debug_verbose&quot;, OPT_SECURITY_DEBUG_VERBOSE, '-'},
     {&quot;brief&quot;, OPT_BRIEF, '-'},
     {&quot;rev&quot;, OPT_REV, '-'},
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's'},
-#endif
     OPT_S_OPTIONS,
     OPT_V_OPTIONS,
     OPT_X_OPTIONS,
+#ifdef FIONBIO
+    {&quot;nbio&quot;, OPT_NBIO, '-', &quot;Use non-blocking IO&quot;},
+#endif
+#ifndef OPENSSL_NO_PSK
+    {&quot;psk_hint&quot;, OPT_PSK_HINT, 's', &quot;PSK identity hint to use&quot;},
+    {&quot;psk&quot;, OPT_PSK, 's', &quot;PSK in hex (without 0x)&quot;},
+# ifndef OPENSSL_NO_JPAKE
+    {&quot;jpake&quot;, OPT_JPAKE, 's', &quot;JPAKE secret to use&quot;},
+# endif
+#endif
+#ifndef OPENSSL_NO_SRP
+    {&quot;srpvfile&quot;, OPT_SRPVFILE, '&lt;', &quot;The verifier file for SRP&quot;},
+    {&quot;srpuserseed&quot;, OPT_SRPUSERSEED, 's',
+     &quot;A seed string for a default user salt&quot;},
+#endif
+#ifndef OPENSSL_NO_SSL3
+    {&quot;ssl3&quot;, OPT_SSL3, '-', &quot;Just talk SSLv3&quot;},
+#endif
+#ifndef OPENSSL_NO_DTLS1
+    {&quot;dtls&quot;, OPT_DTLS, '-'},
+    {&quot;dtls1&quot;, OPT_DTLS1, '-', &quot;Just talk DTLSv1&quot;},
+    {&quot;dtls1_2&quot;, OPT_DTLS1_2, '-', &quot;Just talk DTLSv1.2&quot;},
+    {&quot;timeout&quot;, OPT_TIMEOUT, '-', &quot;Enable timeouts&quot;},
+    {&quot;mtu&quot;, OPT_MTU, 'p', &quot;Set link layer MTU&quot;},
+    {&quot;chain&quot;, OPT_CHAIN, '-', &quot;Read a certificate chain&quot;},
+#endif
+#ifndef OPENSSL_NO_DH
+    {&quot;no_dhe&quot;, OPT_NO_DHE, '-', &quot;Disable ephemeral DH&quot;},
+#endif
+#ifndef OPENSSL_NO_EC
+    {&quot;no_ecdhe&quot;, OPT_NO_ECDHE, '-', &quot;Disable ephemeral ECDH&quot;},
+#endif
+#ifndef OPENSSL_NO_NEXTPROTONEG
+    {&quot;nextprotoneg&quot;, OPT_NEXTPROTONEG, 's',
+     &quot;Set the advertised protocols for the NPN extension (comma-separated list)&quot;},
+#endif
+#ifndef OPENSSL_NO_SRTP
+    {&quot;use_srtp&quot;, OPT_SRTP_PROFILES, '&lt;',
+     &quot;Offer SRTP key management with a colon-separated profile list&quot;},
+    {&quot;alpn&quot;, OPT_ALPN, 's',
+     &quot;Set the advertised protocols for the ALPN extension (comma-separated list)&quot;},
+#endif
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's'},
+#endif
     {NULL}
 };
 
@@ -1246,13 +1245,11 @@ int s_server_main(int argc, char *argv[])
         case OPT_MSGFILE:
             bio_s_msg = BIO_new_file(opt_arg(), &quot;w&quot;);
             break;
-#ifndef OPENSSL_NO_SSL_TRACE
         case OPT_TRACE:
+#ifndef OPENSSL_NO_SSL_TRACE
             s_msg = 2;
-            break;
 #else
-        case OPT_TRACE:
-            goto opthelp;
+            break;
 #endif
         case OPT_SECURITY_DEBUG:
             sdebug = 1;
@@ -1296,6 +1293,10 @@ int s_server_main(int argc, char *argv[])
                 goto end;
             }
             break;
+#else
+        case OPT_PSK_HINT:
+        case OPT_PSK:
+            break;
 #endif
 #ifndef OPENSSL_NO_SRP
         case OPT_SRPVFILE:
@@ -1323,11 +1324,11 @@ int s_server_main(int argc, char *argv[])
         case OPT_HTTP:
             www = 3;
             break;
-#ifndef OPENSSL_NO_SSL3
         case OPT_SSL3:
+#ifndef OPENSSL_NO_SSL3
             meth = SSLv3_server_method();
-            break;
 #endif
+            break;
         case OPT_TLS1_2:
             meth = TLSv1_2_server_method();
             break;
@@ -1359,6 +1360,14 @@ int s_server_main(int argc, char *argv[])
         case OPT_CHAIN:
             cert_chain = 1;
             break;
+#else
+        case OPT_DTLS:
+        case OPT_DTLS1:
+        case OPT_DTLS1_2:
+        case OPT_TIMEOUT:
+        case OPT_MTU:
+        case OPT_CHAIN:
+            break;
 #endif
         case OPT_ID_PREFIX:
             session_id_prefix = opt_arg();
@@ -1381,11 +1390,11 @@ int s_server_main(int argc, char *argv[])
         case OPT_KEY2:
             s_key_file2 = opt_arg();
             break;
-#ifndef OPENSSL_NO_NEXTPROTONEG
         case OPT_NEXTPROTONEG:
+# ifndef OPENSSL_NO_NEXTPROTONEG
             next_proto_neg_in = opt_arg();
-            break;
 #endif
+            break;
         case OPT_ALPN:
             alpn_in = opt_arg();
             break;
diff --git a/apps/s_time.c b/apps/s_time.c
index 74decd2..4f56174 100644
--- a/apps/s_time.c
+++ b/apps/s_time.c
@@ -114,9 +114,7 @@ typedef enum OPTION_choice {
     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,
     OPT_CONNECT, OPT_CIPHER, OPT_CERT, OPT_KEY, OPT_CAPATH,
     OPT_CAFILE, OPT_NEW, OPT_REUSE, OPT_BUGS, OPT_VERIFY, OPT_TIME,
-#ifndef OPENSSL_NO_SSL3
     OPT_SSL3,
-#endif
     OPT_WWW
 } OPTION_CHOICE;
 
@@ -227,11 +225,11 @@ int s_time_main(int argc, char **argv)
                 goto end;
             }
             break;
-#ifndef OPENSSL_NO_SSL3
         case OPT_SSL3:
+#ifndef OPENSSL_NO_SSL3
             meth = SSLv3_client_method();
-            break;
 #endif
+            break;
         }
     }
     argc = opt_num_rest();
diff --git a/apps/speed.c b/apps/speed.c
index b93237e..45a060f 100644
--- a/apps/speed.c
+++ b/apps/speed.c
@@ -358,19 +358,19 @@ OPTIONS speed_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] ciphers...\n&quot;},
     {OPT_HELP_STR, 1, '-', &quot;Valid options are:\n&quot;},
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+    {&quot;evp&quot;, OPT_EVP, 's', &quot;Use specified EVP cipher&quot;},
+    {&quot;decrypt&quot;, OPT_DECRYPT, '-',
+     &quot;Time decryption instead of encryption (only EVP)&quot;},
+    {&quot;mr&quot;, OPT_MR, '-', &quot;Produce machine readable output&quot;},
+    {&quot;mb&quot;, OPT_MB, '-'},
+    {&quot;misalign&quot;, OPT_MISALIGN, 'n', &quot;Amount to mis-align buffers&quot;},
 #if defined(TIMES) || defined(USE_TOD)
     {&quot;elapsed&quot;, OPT_ELAPSED, '-',
      &quot;Measure time in real time instead of CPU user time&quot;},
 #endif
-    {&quot;evp&quot;, OPT_EVP, 's', &quot;Use specified EVP cipher&quot;},
-    {&quot;decrypt&quot;, OPT_DECRYPT, '-',
-     &quot;Time decryption instead of encryption (only EVP)&quot;},
 #ifndef NO_FORK
     {&quot;multi&quot;, OPT_MULTI, 'p', &quot;Run benchmarks in parallel&quot;},
 #endif
-    {&quot;mr&quot;, OPT_MR, '-', &quot;Produce machine readable output&quot;},
-    {&quot;mb&quot;, OPT_MB, '-'},
-    {&quot;misalign&quot;, OPT_MISALIGN, 'n', &quot;Amount to mis-align buffers&quot;},
 #ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
 #endif
@@ -829,11 +829,11 @@ int speed_main(int argc, char **argv)
         case OPT_ENGINE:
             (void)setup_engine(opt_arg(), 0);
             break;
-#ifndef NO_FORK
         case OPT_MULTI:
+#ifndef NO_FORK
             multi = atoi(opt_arg());
-            break;
 #endif
+            break;
         case OPT_MISALIGN:
             if (!opt_int(opt_arg(), &amp;misalign))
                 goto end;
diff --git a/apps/ts.c b/apps/ts.c
index dfbf7ea..feec34b 100644
--- a/apps/ts.c
+++ b/apps/ts.c
@@ -151,10 +151,10 @@ OPTIONS ts_options[] = {
     {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;Path to trusted CA files&quot;},
     {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;File with trusted CA certs&quot;},
     {&quot;untrusted&quot;, OPT_UNTRUSTED, '&lt;', &quot;File with untrusted certs&quot;},
+    {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest&quot;},
 #ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
 #endif
-    {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest&quot;},
     {NULL}
 };
 
diff --git a/apps/verify.c b/apps/verify.c
index 0235194..227b85b 100644
--- a/apps/verify.c
+++ b/apps/verify.c
@@ -91,10 +91,10 @@ OPTIONS verify_options[] = {
     {&quot;CRLfile&quot;, OPT_CRLFILE, '&lt;'},
     {&quot;crl_download&quot;, OPT_CRL_DOWNLOAD, '-'},
     {&quot;show_chain&quot;, OPT_SHOW_CHAIN, '-'},
+    OPT_V_OPTIONS,
 #ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
 #endif
-    OPT_V_OPTIONS,
     {NULL}
 };
 
diff --git a/apps/x509.c b/apps/x509.c
index 77a2a6b..0345cf0 100644
--- a/apps/x509.c
+++ b/apps/x509.c
@@ -107,13 +107,9 @@ typedef enum OPTION_choice {
     OPT_PURPOSE, OPT_STARTDATE, OPT_ENDDATE, OPT_CHECKEND, OPT_CHECKHOST,
     OPT_CHECKEMAIL, OPT_CHECKIP, OPT_NOOUT, OPT_TRUSTOUT, OPT_CLRTRUST,
     OPT_CLRREJECT, OPT_ALIAS, OPT_CACREATESERIAL, OPT_CLREXT, OPT_OCSPID,
-#ifndef OPENSSL_NO_MD5
     OPT_SUBJECT_HASH_OLD,
     OPT_ISSUER_HASH_OLD,
-#endif
-#ifdef OPENSSL_SSL_DEBUG_BROKEN_PROTOCOL
     OPT_FORCE_VERSION,
-#endif
     OPT_BADSIG, OPT_MD, OPT_ENGINE, OPT_NOCERT
 } OPTION_CHOICE;
 
@@ -130,12 +126,6 @@ OPTIONS x509_options[] = {
     {&quot;serial&quot;, OPT_SERIAL, '-', &quot;Print serial number value&quot;},
     {&quot;subject_hash&quot;, OPT_HASH, '-', &quot;Print subject hash value&quot;},
     {&quot;issuer_hash&quot;, OPT_ISSUER_HASH, '-', &quot;Print issuer hash value&quot;},
-#ifndef OPENSSL_NO_MD5
-    {&quot;subject_hash_old&quot;, OPT_SUBJECT_HASH_OLD, '-',
-     &quot;Print old-style (MD5) issuer hash value&quot;},
-    {&quot;issuer_hash_old&quot;, OPT_ISSUER_HASH_OLD, '-',
-     &quot;Print old-style (MD5) subject hash value&quot;},
-#endif
     {&quot;hash&quot;, OPT_HASH, '-', &quot;Synonym for -subject_hash&quot;},
     {&quot;subject&quot;, OPT_SUBJECT, '-', &quot;Print subject DN&quot;},
     {&quot;issuer&quot;, OPT_ISSUER, '-', &quot;Print issuer DN&quot;},
@@ -194,12 +184,18 @@ OPTIONS x509_options[] = {
     {&quot;clrreject&quot;, OPT_CLRREJECT, '-'},
     {&quot;badsig&quot;, OPT_BADSIG, '-'},
     {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest&quot;},
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#ifndef OPENSSL_NO_MD5
+    {&quot;subject_hash_old&quot;, OPT_SUBJECT_HASH_OLD, '-',
+     &quot;Print old-style (MD5) issuer hash value&quot;},
+    {&quot;issuer_hash_old&quot;, OPT_ISSUER_HASH_OLD, '-',
+     &quot;Print old-style (MD5) subject hash value&quot;},
 #endif
 #ifdef OPENSSL_SSL_DEBUG_BROKEN_PROTOCOL
     {&quot;force_version&quot;, OPT_FORCE_VERSION, 'p'},
 #endif
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#endif
     {NULL}
 };
 
@@ -291,11 +287,11 @@ int x509_main(int argc, char **argv)
             if (!sigopts || !sk_OPENSSL_STRING_push(sigopts, opt_arg()))
                 goto opthelp;
             break;
-#ifdef OPENSSL_SSL_DEBUG_BROKEN_PROTOCOL
         case OPT_FORCE_VERSION:
+#ifdef OPENSSL_SSL_DEBUG_BROKEN_PROTOCOL
             force_version = atoi(opt_arg()) - 1;
-            break;
 #endif
+            break;
         case OPT_DAYS:
             days = atoi(opt_arg());
             break;
@@ -459,6 +455,10 @@ int x509_main(int argc, char **argv)
         case OPT_ISSUER_HASH_OLD:
             issuer_hash_old = ++num;
             break;
+#else
+        case OPT_SUBJECT_HASH_OLD:
+        case OPT_ISSUER_HASH_OLD:
+            break;
 #endif
         case OPT_DATES:
             startdate = ++num;
</PRE>















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001230.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="001232.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1231">[ date ]</a>
              <a href="thread.html#1231">[ thread ]</a>
              <a href="subject.html#1231">[ subject ]</a>
              <a href="author.html#1231">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
