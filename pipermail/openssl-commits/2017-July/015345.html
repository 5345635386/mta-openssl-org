<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2017-July/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1499218427.226955.3152.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015341.html">
   <LINK REL="Next"  HREF="015346.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>paul.dale at oracle.com</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1499218427.226955.3152.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">paul.dale at oracle.com
       </A><BR>
    <I>Wed Jul  5 01:33:47 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="015341.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="015346.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15345">[ date ]</a>
              <a href="thread.html#15345">[ thread ]</a>
              <a href="subject.html#15345">[ subject ]</a>
              <a href="author.html#15345">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  0904e79a6e6109240d5a552f2699408b26cf63ee (commit)
      from  ff281ee8369350d88e8b57af139614f5683e1e8c (commit)


- Log -----------------------------------------------------------------
commit 0904e79a6e6109240d5a552f2699408b26cf63ee
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
Date:   Wed Jun 14 20:34:37 2017 -0400

    Undo commit d420ac2
    
    [extended tests]
    
    Original text:
        Use BUF_strlcpy() instead of strcpy().
        Use BUF_strlcat() instead of strcat().
        Use BIO_snprintf() instead of sprintf().
        In some cases, keep better track of buffer lengths.
        This is part of a large change submitted by Markus Friedl &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">markus at openbsd.org</A>&gt;
    
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">paul.dale at oracle.com</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3701">https://github.com/openssl/openssl/pull/3701</A>)

-----------------------------------------------------------------------

Summary of changes:
 apps/enc.c               |  6 +++---
 apps/engine.c            |  4 ++--
 apps/pkcs12.c            |  2 +-
 apps/req.c               | 36 ++++++++++++++++++------------------
 apps/s_time.c            | 13 ++++++-------
 apps/x509.c              |  6 +++---
 crypto/asn1/a_gentm.c    |  6 +++---
 crypto/asn1/a_mbstr.c    |  4 ++--
 crypto/asn1/a_time.c     |  9 +++------
 crypto/asn1/a_utctm.c    |  6 +++---
 crypto/asn1/asn1_par.c   |  8 ++++----
 crypto/asn1/x_long.c     |  9 ++-------
 crypto/bio/b_dump.c      | 27 ++++++++++++---------------
 crypto/bio/bio_cb.c      | 48 +++++++++++++++++++++++-------------------------
 crypto/bio/bss_file.c    | 10 +++++-----
 crypto/bn/bn_print.c     | 13 ++++++-------
 crypto/conf/conf_def.c   |  4 ++--
 crypto/conf/conf_mod.c   |  8 ++++----
 crypto/cversion.c        |  4 +---
 crypto/des/ecb_enc.c     |  2 +-
 crypto/engine/eng_ctrl.c | 10 +++-------
 crypto/evp/evp_pbe.c     |  2 +-
 crypto/mem_dbg.c         | 23 ++++++++---------------
 crypto/objects/obj_dat.c |  2 +-
 crypto/pem/pem_lib.c     | 14 ++++++--------
 crypto/rand/rand_egd.c   |  2 +-
 crypto/x509/by_dir.c     |  4 ++--
 crypto/x509v3/v3_alt.c   |  5 ++---
 crypto/x509v3/v3_info.c  |  8 ++++----
 29 files changed, 132 insertions(+), 163 deletions(-)

diff --git a/apps/enc.c b/apps/enc.c
index d200075..3383073 100644
--- a/apps/enc.c
+++ b/apps/enc.c
@@ -312,9 +312,9 @@ int enc_main(int argc, char **argv)
             for (;;) {
                 char prompt[200];
 
-                BIO_snprintf(prompt, sizeof prompt, &quot;enter %s %s password:&quot;,
-                             OBJ_nid2ln(EVP_CIPHER_nid(cipher)),
-                             (enc) ? &quot;encryption&quot; : &quot;decryption&quot;);
+                sprintf(prompt, &quot;enter %s %s password:&quot;,
+                        OBJ_nid2ln(EVP_CIPHER_nid(cipher)),
+                        (enc) ? &quot;encryption&quot; : &quot;decryption&quot;);
                 strbuf[0] = '\0';
                 i = EVP_read_pw_string((char *)strbuf, SIZE, prompt, enc);
                 if (i == 0) {
diff --git a/apps/engine.c b/apps/engine.c
index 7724084..61fb758 100644
--- a/apps/engine.c
+++ b/apps/engine.c
@@ -67,8 +67,8 @@ static int append_buf(char **buf, int *size, const char *s)
     }
 
     if (**buf != '\0')
-        OPENSSL_strlcat(*buf, &quot;, &quot;, *size);
-    OPENSSL_strlcat(*buf, s, *size);
+        strcat(*buf, &quot;, &quot;);
+    strcat(*buf, s);
 
     return 1;
 }
diff --git a/apps/pkcs12.c b/apps/pkcs12.c
index 9449679..82d2bb9 100644
--- a/apps/pkcs12.c
+++ b/apps/pkcs12.c
@@ -455,7 +455,7 @@ int pkcs12_main(int argc, char **argv)
         }
 
         if (!twopass)
-            OPENSSL_strlcpy(macpass, pass, sizeof macpass);
+            strcpy(macpass, pass);
 
         p12 = PKCS12_create(cpass, name, key, ucert, certs,
                             key_pbe, cert_pbe, iter, -1, keytype);
diff --git a/apps/req.c b/apps/req.c
index 34d9065..9b6c48d 100644
--- a/apps/req.c
+++ b/apps/req.c
@@ -984,30 +984,30 @@ static int prompt_info(X509_REQ *req,
             /* If OBJ not recognised ignore it */
             if ((nid = OBJ_txt2nid(type)) == NID_undef)
                 goto start;
-            if (BIO_snprintf(buf, sizeof buf, &quot;%s_default&quot;, v-&gt;name)
-                &gt;= (int)sizeof(buf)) {
+            if (strlen(v-&gt;name) + sizeof(&quot;_default&quot;) &gt; sizeof(buf)) {
                 BIO_printf(bio_err, &quot;Name '%s' too long\n&quot;, v-&gt;name);
                 return 0;
             }
+            sprintf(buf, &quot;%s_default&quot;, v-&gt;name);
 
             if ((def = NCONF_get_string(req_conf, dn_sect, buf)) == NULL) {
                 ERR_clear_error();
                 def = &quot;&quot;;
             }
 
-            BIO_snprintf(buf, sizeof buf, &quot;%s_value&quot;, v-&gt;name);
+            sprintf(buf, &quot;%s_value&quot;, v-&gt;name);
             if ((value = NCONF_get_string(req_conf, dn_sect, buf)) == NULL) {
                 ERR_clear_error();
                 value = NULL;
             }
 
-            BIO_snprintf(buf, sizeof buf, &quot;%s_min&quot;, v-&gt;name);
+            sprintf(buf, &quot;%s_min&quot;, v-&gt;name);
             if (!NCONF_get_number(req_conf, dn_sect, buf, &amp;n_min)) {
                 ERR_clear_error();
                 n_min = -1;
             }
 
-            BIO_snprintf(buf, sizeof buf, &quot;%s_max&quot;, v-&gt;name);
+            sprintf(buf, &quot;%s_max&quot;, v-&gt;name);
             if (!NCONF_get_number(req_conf, dn_sect, buf, &amp;n_max)) {
                 ERR_clear_error();
                 n_max = -1;
@@ -1044,11 +1044,11 @@ static int prompt_info(X509_REQ *req,
                 if ((nid = OBJ_txt2nid(type)) == NID_undef)
                     goto start2;
 
-                if (BIO_snprintf(buf, sizeof buf, &quot;%s_default&quot;, type)
-                    &gt;= (int)sizeof(buf)) {
+                if (strlen(type) + sizeof(&quot;_default&quot;) &gt; sizeof(buf)) {
                     BIO_printf(bio_err, &quot;Name '%s' too long\n&quot;, v-&gt;name);
                     return 0;
                 }
+                sprintf(buf, &quot;%s_default&quot;, type);
 
                 if ((def = NCONF_get_string(req_conf, attr_sect, buf))
                     == NULL) {
@@ -1056,20 +1056,20 @@ static int prompt_info(X509_REQ *req,
                     def = &quot;&quot;;
                 }
 
-                BIO_snprintf(buf, sizeof buf, &quot;%s_value&quot;, type);
+                sprintf(buf, &quot;%s_value&quot;, type);
                 if ((value = NCONF_get_string(req_conf, attr_sect, buf))
                     == NULL) {
                     ERR_clear_error();
                     value = NULL;
                 }
 
-                BIO_snprintf(buf, sizeof buf, &quot;%s_min&quot;, type);
+                sprintf(buf, &quot;%s_min&quot;, type);
                 if (!NCONF_get_number(req_conf, attr_sect, buf, &amp;n_min)) {
                     ERR_clear_error();
                     n_min = -1;
                 }
 
-                BIO_snprintf(buf, sizeof buf, &quot;%s_max&quot;, type);
+                sprintf(buf, &quot;%s_max&quot;, type);
                 if (!NCONF_get_number(req_conf, attr_sect, buf, &amp;n_max)) {
                     ERR_clear_error();
                     n_max = -1;
@@ -1168,8 +1168,8 @@ static int add_DN_object(X509_NAME *n, char *text, const char *def,
         BIO_printf(bio_err, &quot;%s [%s]:&quot;, text, def);
     (void)BIO_flush(bio_err);
     if (value != NULL) {
-        OPENSSL_strlcpy(buf, value, sizeof buf);
-        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        strcpy(buf, value);
+        strcat(buf, &quot;\n&quot;);
         BIO_printf(bio_err, &quot;%s\n&quot;, value);
     } else {
         buf[0] = '\0';
@@ -1187,8 +1187,8 @@ static int add_DN_object(X509_NAME *n, char *text, const char *def,
     if (buf[0] == '\n') {
         if ((def == NULL) || (def[0] == '\0'))
             return 1;
-        OPENSSL_strlcpy(buf, def, sizeof buf);
-        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        strcpy(buf, def);
+        strcat(buf, &quot;\n&quot;);
     } else if ((buf[0] == '.') &amp;&amp; (buf[1] == '\n')) {
         return 1;
     }
@@ -1228,8 +1228,8 @@ static int add_attribute_object(X509_REQ *req, char *text, const char *def,
         BIO_printf(bio_err, &quot;%s [%s]:&quot;, text, def);
     (void)BIO_flush(bio_err);
     if (value != NULL) {
-        OPENSSL_strlcpy(buf, value, sizeof buf);
-        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        strcpy(buf, value);
+        strcat(buf, &quot;\n&quot;);
         BIO_printf(bio_err, &quot;%s\n&quot;, value);
     } else {
         buf[0] = '\0';
@@ -1247,8 +1247,8 @@ static int add_attribute_object(X509_REQ *req, char *text, const char *def,
     if (buf[0] == '\n') {
         if ((def == NULL) || (def[0] == '\0'))
             return 1;
-        OPENSSL_strlcpy(buf, def, sizeof buf);
-        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        strcpy(buf, def);
+        strcat(buf, &quot;\n&quot;);
     } else if ((buf[0] == '.') &amp;&amp; (buf[1] == '\n')) {
         return 1;
     }
diff --git a/apps/s_time.c b/apps/s_time.c
index bae2524..c4f4037 100644
--- a/apps/s_time.c
+++ b/apps/s_time.c
@@ -173,7 +173,7 @@ int s_time_main(int argc, char **argv)
             break;
         case OPT_WWW:
             www_path = opt_arg();
-            buf_size = strlen(www_path) + sizeof(fmt_http_get_cmd) - 2;  /* 2 is for %s */
+            buf_size = strlen(www_path) + sizeof(fmt_http_get_cmd);
             if (buf_size &gt; sizeof(buf)) {
                 BIO_printf(bio_err, &quot;%s: -www option is too long\n&quot;, prog);
                 goto end;
@@ -230,8 +230,8 @@ int s_time_main(int argc, char **argv)
             goto end;
 
         if (www_path != NULL) {
-            buf_len = BIO_snprintf(buf, sizeof buf,
-                                   fmt_http_get_cmd, www_path);
+            sprintf(buf, fmt_http_get_cmd, www_path);
+            buf_len = strlen(buf);
             if (SSL_write(scon, buf, buf_len) &lt;= 0)
                 goto end;
             while ((i = SSL_read(scon, buf, sizeof(buf))) &gt; 0)
@@ -288,8 +288,8 @@ int s_time_main(int argc, char **argv)
     }
 
     if (www_path != NULL) {
-        buf_len = BIO_snprintf(buf, sizeof buf,
-                               fmt_http_get_cmd, www_path);
+        sprintf(buf, fmt_http_get_cmd, www_path);
+        buf_len = strlen(buf);
         if (SSL_write(scon, buf, buf_len) &lt;= 0)
             goto end;
         while (SSL_read(scon, buf, sizeof(buf)) &gt; 0)
@@ -319,8 +319,7 @@ int s_time_main(int argc, char **argv)
             goto end;
 
         if (www_path != NULL) {
-            BIO_snprintf(buf, sizeof buf, &quot;GET %s HTTP/1.0\r\n\r\n&quot;,
-                         www_path);
+            sprintf(buf, &quot;GET %s HTTP/1.0\r\n\r\n&quot;, www_path);
             if (SSL_write(scon, buf, strlen(buf)) &lt;= 0)
                 goto end;
             while ((i = SSL_read(scon, buf, sizeof(buf))) &gt; 0)
diff --git a/apps/x509.c b/apps/x509.c
index 689d5a2..484192b 100644
--- a/apps/x509.c
+++ b/apps/x509.c
@@ -906,15 +906,15 @@ static ASN1_INTEGER *x509_load_serial(const char *CAfile, const char *serialfile
            : (strlen(serialfile))) + 1;
     buf = app_malloc(len, &quot;serial# buffer&quot;);
     if (serialfile == NULL) {
-        OPENSSL_strlcpy(buf, CAfile, len);
+        strcpy(buf, CAfile);
         for (p = buf; *p; p++)
             if (*p == '.') {
                 *p = '\0';
                 break;
             }
-        OPENSSL_strlcat(buf, POSTFIX, len);
+        strcat(buf, POSTFIX);
     } else {
-        OPENSSL_strlcpy(buf, serialfile, len);
+        strcpy(buf, serialfile);
     }
 
     serial = load_serial(buf, create, NULL);
diff --git a/crypto/asn1/a_gentm.c b/crypto/asn1/a_gentm.c
index bd90d05..2c5fb1c 100644
--- a/crypto/asn1/a_gentm.c
+++ b/crypto/asn1/a_gentm.c
@@ -237,9 +237,9 @@ ASN1_GENERALIZEDTIME *ASN1_GENERALIZEDTIME_adj(ASN1_GENERALIZEDTIME *s,
         tmps-&gt;data = (unsigned char *)p;
     }
 
-    BIO_snprintf(p, len, &quot;%04d%02d%02d%02d%02d%02dZ&quot;, ts-&gt;tm_year + 1900,
-                 ts-&gt;tm_mon + 1, ts-&gt;tm_mday, ts-&gt;tm_hour, ts-&gt;tm_min,
-                 ts-&gt;tm_sec);
+    sprintf(p, &quot;%04d%02d%02d%02d%02d%02dZ&quot;, ts-&gt;tm_year + 1900,
+            ts-&gt;tm_mon + 1, ts-&gt;tm_mday, ts-&gt;tm_hour, ts-&gt;tm_min,
+            ts-&gt;tm_sec);
     tmps-&gt;length = strlen(p);
     tmps-&gt;type = V_ASN1_GENERALIZEDTIME;
 #ifdef CHARSET_EBCDIC_not
diff --git a/crypto/asn1/a_mbstr.c b/crypto/asn1/a_mbstr.c
index 5578e92..46764b2 100644
--- a/crypto/asn1/a_mbstr.c
+++ b/crypto/asn1/a_mbstr.c
@@ -100,14 +100,14 @@ int ASN1_mbstring_ncopy(ASN1_STRING **out, const unsigned char *in, int len,
 
     if ((minsize &gt; 0) &amp;&amp; (nchar &lt; minsize)) {
         ASN1err(ASN1_F_ASN1_MBSTRING_NCOPY, ASN1_R_STRING_TOO_SHORT);
-        BIO_snprintf(strbuf, sizeof strbuf, &quot;%ld&quot;, minsize);
+        sprintf(strbuf, &quot;%ld&quot;, minsize);
         ERR_add_error_data(2, &quot;minsize=&quot;, strbuf);
         return -1;
     }
 
     if ((maxsize &gt; 0) &amp;&amp; (nchar &gt; maxsize)) {
         ASN1err(ASN1_F_ASN1_MBSTRING_NCOPY, ASN1_R_STRING_TOO_LONG);
-        BIO_snprintf(strbuf, sizeof strbuf, &quot;%ld&quot;, maxsize);
+        sprintf(strbuf, &quot;%ld&quot;, maxsize);
         ERR_add_error_data(2, &quot;maxsize=&quot;, strbuf);
         return -1;
     }
diff --git a/crypto/asn1/a_time.c b/crypto/asn1/a_time.c
index 12b1ff5..f0ec42f 100644
--- a/crypto/asn1/a_time.c
+++ b/crypto/asn1/a_time.c
@@ -64,7 +64,6 @@ ASN1_GENERALIZEDTIME *ASN1_TIME_to_generalizedtime(const ASN1_TIME *t,
 {
     ASN1_GENERALIZEDTIME *ret = NULL;
     char *str;
-    int newlen;
 
     if (!ASN1_TIME_check(t))
         return NULL;
@@ -85,16 +84,14 @@ ASN1_GENERALIZEDTIME *ASN1_TIME_to_generalizedtime(const ASN1_TIME *t,
     /* grow the string */
     if (!ASN1_STRING_set(ret, NULL, t-&gt;length + 2))
         goto err;
-    /* ASN1_STRING_set() allocated 'len + 1' bytes. */
-    newlen = t-&gt;length + 2 + 1;
     str = (char *)ret-&gt;data;
     /* Work out the century and prepend */
     if (t-&gt;data[0] &gt;= '5')
-        OPENSSL_strlcpy(str, &quot;19&quot;, newlen);
+        strcpy(str, &quot;19&quot;);
     else
-        OPENSSL_strlcpy(str, &quot;20&quot;, newlen);
+        strcpy(str, &quot;20&quot;);
 
-    OPENSSL_strlcat(str, (const char *)t-&gt;data, newlen);
+    strcat(str, (const char *)t-&gt;data);
 
  done:
    if (out != NULL &amp;&amp; *out == NULL)
diff --git a/crypto/asn1/a_utctm.c b/crypto/asn1/a_utctm.c
index ee98e4b..25393ee 100644
--- a/crypto/asn1/a_utctm.c
+++ b/crypto/asn1/a_utctm.c
@@ -199,9 +199,9 @@ ASN1_UTCTIME *ASN1_UTCTIME_adj(ASN1_UTCTIME *s, time_t t,
         s-&gt;data = (unsigned char *)p;
     }
 
-    BIO_snprintf(p, len, &quot;%02d%02d%02d%02d%02d%02dZ&quot;, ts-&gt;tm_year % 100,
-                 ts-&gt;tm_mon + 1, ts-&gt;tm_mday, ts-&gt;tm_hour, ts-&gt;tm_min,
-                 ts-&gt;tm_sec);
+    sprintf(p, &quot;%02d%02d%02d%02d%02d%02dZ&quot;, ts-&gt;tm_year % 100,
+            ts-&gt;tm_mon + 1, ts-&gt;tm_mday, ts-&gt;tm_hour, ts-&gt;tm_min,
+            ts-&gt;tm_sec);
     s-&gt;length = strlen(p);
     s-&gt;type = V_ASN1_UTCTIME;
 #ifdef CHARSET_EBCDIC_not
diff --git a/crypto/asn1/asn1_par.c b/crypto/asn1/asn1_par.c
index af045cb..19b21e7 100644
--- a/crypto/asn1/asn1_par.c
+++ b/crypto/asn1/asn1_par.c
@@ -38,13 +38,13 @@ static int asn1_print_info(BIO *bp, int tag, int xclass, int constructed,
 
     p = str;
     if ((xclass &amp; V_ASN1_PRIVATE) == V_ASN1_PRIVATE)
-        BIO_snprintf(str, sizeof str, &quot;priv [ %d ] &quot;, tag);
+        sprintf(str, &quot;priv [ %d ] &quot;, tag);
     else if ((xclass &amp; V_ASN1_CONTEXT_SPECIFIC) == V_ASN1_CONTEXT_SPECIFIC)
-        BIO_snprintf(str, sizeof str, &quot;cont [ %d ]&quot;, tag);
+        sprintf(str, &quot;cont [ %d ]&quot;, tag);
     else if ((xclass &amp; V_ASN1_APPLICATION) == V_ASN1_APPLICATION)
-        BIO_snprintf(str, sizeof str, &quot;appl [ %d ]&quot;, tag);
+        sprintf(str, &quot;appl [ %d ]&quot;, tag);
     else if (tag &gt; 30)
-        BIO_snprintf(str, sizeof str, &quot;&lt;ASN1 %d&gt;&quot;, tag);
+        sprintf(str, &quot;&lt;ASN1 %d&gt;&quot;, tag);
     else
         p = ASN1_tag2str(tag);
 
diff --git a/crypto/asn1/x_long.c b/crypto/asn1/x_long.c
index 4bb6611..78f4b76 100644
--- a/crypto/asn1/x_long.c
+++ b/crypto/asn1/x_long.c
@@ -89,12 +89,8 @@ static int long_i2c(ASN1_VALUE **pval, unsigned char *cont, int *putype,
     long ltmp;
     unsigned long utmp, sign;
     int clen, pad, i;
-    /* this exists to bypass broken gcc optimization */
-    char *cp = (char *)pval;
-
-    /* use memcpy, because we may not be long aligned */
-    memcpy(&amp;ltmp, cp, sizeof(long));
 
+    ltmp = *(long *)pval;
     if (ltmp == it-&gt;size)
         return -1;
     /*
@@ -136,7 +132,6 @@ static int long_c2i(ASN1_VALUE **pval, const unsigned char *cont, int len,
     int i;
     long ltmp;
     unsigned long utmp = 0, sign = 0x100;
-    char *cp = (char *)pval;
 
     if (len &gt; 1) {
         /*
@@ -188,7 +183,7 @@ static int long_c2i(ASN1_VALUE **pval, const unsigned char *cont, int len,
         ASN1err(ASN1_F_LONG_C2I, ASN1_R_INTEGER_TOO_LARGE_FOR_LONG);
         return 0;
     }
-    memcpy(cp, &amp;ltmp, sizeof(long));
+    *(long*)pval = ltmp;
     return 1;
 }
 
diff --git a/crypto/bio/b_dump.c b/crypto/bio/b_dump.c
index a27954f..491b973 100644
--- a/crypto/bio/b_dump.c
+++ b/crypto/bio/b_dump.c
@@ -54,36 +54,34 @@ int BIO_dump_indent_cb(int (*cb) (const void *data, size_t len, void *u),
     if ((rows * dump_width) &lt; len)
         rows++;
     for (i = 0; i &lt; rows; i++) {
-        OPENSSL_strlcpy(buf, str, sizeof buf);
-        BIO_snprintf(tmp, sizeof tmp, &quot;%04x - &quot;, i * dump_width);
-        OPENSSL_strlcat(buf, tmp, sizeof buf);
+        strcpy(buf, str);
+        sprintf(tmp, &quot;%04x - &quot;, i * dump_width);
+        strcat(buf, tmp);
         for (j = 0; j &lt; dump_width; j++) {
             if (((i * dump_width) + j) &gt;= len) {
-                OPENSSL_strlcat(buf, &quot;   &quot;, sizeof buf);
+                strcat(buf, &quot;   &quot;);
             } else {
                 ch = ((unsigned char)*(s + i * dump_width + j)) &amp; 0xff;
-                BIO_snprintf(tmp, sizeof tmp, &quot;%02x%c&quot;, ch,
-                             j == 7 ? '-' : ' ');
-                OPENSSL_strlcat(buf, tmp, sizeof buf);
+                sprintf(tmp, &quot;%02x%c&quot;, ch, j == 7 ? '-' : ' ');
+                strcat(buf, tmp);
             }
         }
-        OPENSSL_strlcat(buf, &quot;  &quot;, sizeof buf);
+        strcat(buf, &quot;  &quot;);
         for (j = 0; j &lt; dump_width; j++) {
             if (((i * dump_width) + j) &gt;= len)
                 break;
             ch = ((unsigned char)*(s + i * dump_width + j)) &amp; 0xff;
 #ifndef CHARSET_EBCDIC
-            BIO_snprintf(tmp, sizeof tmp, &quot;%c&quot;,
-                         ((ch &gt;= ' ') &amp;&amp; (ch &lt;= '~')) ? ch : '.');
+            sprintf(tmp, &quot;%c&quot;, ((ch &gt;= ' ') &amp;&amp; (ch &lt;= '~')) ? ch : '.');
 #else
-            BIO_snprintf(tmp, sizeof tmp, &quot;%c&quot;,
+            sprintf(tmp, &quot;%c&quot;,
                          ((ch &gt;= os_toascii[' ']) &amp;&amp; (ch &lt;= os_toascii['~']))
                          ? os_toebcdic[ch]
                          : '.');
 #endif
-            OPENSSL_strlcat(buf, tmp, sizeof buf);
+            strcat(buf, tmp);
         }
-        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        strcat(buf, &quot;\n&quot;);
         /*
          * if this is the last call then update the ddt_dump thing so that we
          * will move the selection point in the debug window
@@ -92,8 +90,7 @@ int BIO_dump_indent_cb(int (*cb) (const void *data, size_t len, void *u),
     }
 #ifdef TRUNCATE
     if (trc &gt; 0) {
-        BIO_snprintf(buf, sizeof buf, &quot;%s%04x - &lt;SPACES/NULS&gt;\n&quot;, str,
-                     len + trc);
+        sprintf(buf, &quot;%s%04x - &lt;SPACES/NULS&gt;\n&quot;, str, len + trc);
         ret += cb((void *)buf, strlen(buf), u);
     }
 #endif
diff --git a/crypto/bio/bio_cb.c b/crypto/bio/bio_cb.c
index 69ea3d0..13368e8 100644
--- a/crypto/bio/bio_cb.c
+++ b/crypto/bio/bio_cb.c
@@ -22,69 +22,67 @@ long BIO_debug_callback(BIO *bio, int cmd, const char *argp,
     char *p;
     long r = 1;
     int len;
-    size_t p_maxlen;
 
     if (BIO_CB_RETURN &amp; cmd)
         r = ret;
 
-    len = BIO_snprintf(buf, sizeof buf, &quot;BIO[%p]: &quot;, (void *)bio);
+    len = sprintf(buf, &quot;BIO[%p]: &quot;, (void *)bio);
 
     /* Ignore errors and continue printing the other information. */
     if (len &lt; 0)
         len = 0;
     p = buf + len;
-    p_maxlen = sizeof(buf) - len;
 
     switch (cmd) {
     case BIO_CB_FREE:
-        BIO_snprintf(p, p_maxlen, &quot;Free - %s\n&quot;, bio-&gt;method-&gt;name);
+        sprintf(p, &quot;Free - %s\n&quot;, bio-&gt;method-&gt;name);
         break;
     case BIO_CB_READ:
         if (bio-&gt;method-&gt;type &amp; BIO_TYPE_DESCRIPTOR)
-            BIO_snprintf(p, p_maxlen, &quot;read(%d,%lu) - %s fd=%d\n&quot;,
-                         bio-&gt;num, (unsigned long)argi,
-                         bio-&gt;method-&gt;name, bio-&gt;num);
+            sprintf(p, &quot;read(%d,%lu) - %s fd=%d\n&quot;,
+                    bio-&gt;num, (unsigned long)argi,
+                    bio-&gt;method-&gt;name, bio-&gt;num);
         else
-            BIO_snprintf(p, p_maxlen, &quot;read(%d,%lu) - %s\n&quot;,
-                         bio-&gt;num, (unsigned long)argi, bio-&gt;method-&gt;name);
+            sprintf(p, &quot;read(%d,%lu) - %s\n&quot;,
+                    bio-&gt;num, (unsigned long)argi, bio-&gt;method-&gt;name);
         break;
     case BIO_CB_WRITE:
         if (bio-&gt;method-&gt;type &amp; BIO_TYPE_DESCRIPTOR)
-            BIO_snprintf(p, p_maxlen, &quot;write(%d,%lu) - %s fd=%d\n&quot;,
-                         bio-&gt;num, (unsigned long)argi,
-                         bio-&gt;method-&gt;name, bio-&gt;num);
+            sprintf(p, &quot;write(%d,%lu) - %s fd=%d\n&quot;,
+                    bio-&gt;num, (unsigned long)argi,
+                    bio-&gt;method-&gt;name, bio-&gt;num);
         else
-            BIO_snprintf(p, p_maxlen, &quot;write(%d,%lu) - %s\n&quot;,
-                         bio-&gt;num, (unsigned long)argi, bio-&gt;method-&gt;name);
+            sprintf(p, &quot;write(%d,%lu) - %s\n&quot;,
+                    bio-&gt;num, (unsigned long)argi, bio-&gt;method-&gt;name);
         break;
     case BIO_CB_PUTS:
-        BIO_snprintf(p, p_maxlen, &quot;puts() - %s\n&quot;, bio-&gt;method-&gt;name);
+        sprintf(p, &quot;puts() - %s\n&quot;, bio-&gt;method-&gt;name);
         break;
     case BIO_CB_GETS:
-        BIO_snprintf(p, p_maxlen, &quot;gets(%lu) - %s\n&quot;, (unsigned long)argi,
-                     bio-&gt;method-&gt;name);
+        sprintf(p, &quot;gets(%lu) - %s\n&quot;, (unsigned long)argi,
+                bio-&gt;method-&gt;name);
         break;
     case BIO_CB_CTRL:
-        BIO_snprintf(p, p_maxlen, &quot;ctrl(%lu) - %s\n&quot;, (unsigned long)argi,
-                     bio-&gt;method-&gt;name);
+        sprintf(p, &quot;ctrl(%lu) - %s\n&quot;, (unsigned long)argi,
+                bio-&gt;method-&gt;name);
         break;
     case BIO_CB_RETURN | BIO_CB_READ:
-        BIO_snprintf(p, p_maxlen, &quot;read return %ld\n&quot;, ret);
+        sprintf(p, &quot;read return %ld\n&quot;, ret);
         break;
     case BIO_CB_RETURN | BIO_CB_WRITE:
-        BIO_snprintf(p, p_maxlen, &quot;write return %ld\n&quot;, ret);
+        sprintf(p, &quot;write return %ld\n&quot;, ret);
         break;
     case BIO_CB_RETURN | BIO_CB_GETS:
-        BIO_snprintf(p, p_maxlen, &quot;gets return %ld\n&quot;, ret);
+        sprintf(p, &quot;gets return %ld\n&quot;, ret);
         break;
     case BIO_CB_RETURN | BIO_CB_PUTS:
-        BIO_snprintf(p, p_maxlen, &quot;puts return %ld\n&quot;, ret);
+        sprintf(p, &quot;puts return %ld\n&quot;, ret);
         break;
     case BIO_CB_RETURN | BIO_CB_CTRL:
-        BIO_snprintf(p, p_maxlen, &quot;ctrl return %ld\n&quot;, ret);
+        sprintf(p, &quot;ctrl return %ld\n&quot;, ret);
         break;
     default:
-        BIO_snprintf(p, p_maxlen, &quot;bio callback - unknown type (%d)\n&quot;, cmd);
+        sprintf(p, &quot;bio callback - unknown type (%d)\n&quot;, cmd);
         break;
     }
 
diff --git a/crypto/bio/bss_file.c b/crypto/bio/bss_file.c
index ae9867e..49d8f09 100644
--- a/crypto/bio/bss_file.c
+++ b/crypto/bio/bss_file.c
@@ -271,15 +271,15 @@ static long file_ctrl(BIO *b, int cmd, long num, void *ptr)
         b-&gt;shutdown = (int)num &amp; BIO_CLOSE;
         if (num &amp; BIO_FP_APPEND) {
             if (num &amp; BIO_FP_READ)
-                OPENSSL_strlcpy(p, &quot;a+&quot;, sizeof p);
+                strcpy(p, &quot;a+&quot;);
             else
-                OPENSSL_strlcpy(p, &quot;a&quot;, sizeof p);
+                strcpy(p, &quot;a&quot;);
         } else if ((num &amp; BIO_FP_READ) &amp;&amp; (num &amp; BIO_FP_WRITE))
-            OPENSSL_strlcpy(p, &quot;r+&quot;, sizeof p);
+            strcpy(p, &quot;r+&quot;);
         else if (num &amp; BIO_FP_WRITE)
-            OPENSSL_strlcpy(p, &quot;w&quot;, sizeof p);
+            strcpy(p, &quot;w&quot;);
         else if (num &amp; BIO_FP_READ)
-            OPENSSL_strlcpy(p, &quot;r&quot;, sizeof p);
+            strcpy(p, &quot;r&quot;);
         else {
             BIOerr(BIO_F_FILE_CTRL, BIO_R_BAD_FOPEN_MODE);
             ret = 0;
diff --git a/crypto/bn/bn_print.c b/crypto/bn/bn_print.c
index 8216760..708067a 100644
--- a/crypto/bn/bn_print.c
+++ b/crypto/bn/bn_print.c
@@ -77,7 +77,6 @@ char *BN_bn2dec(const BIGNUM *a)
     if ((t = BN_dup(a)) == NULL)
         goto err;
 
-#define BUF_REMAIN (num+3 - (size_t)(p - buf))
     p = buf;
     lp = bn_data;
     if (BN_is_zero(t)) {
@@ -101,12 +100,12 @@ char *BN_bn2dec(const BIGNUM *a)
          * the last one needs truncation. The blocks need to be reversed in
          * order.
          */
-        BIO_snprintf(p, BUF_REMAIN, BN_DEC_FMT1, *lp);
+        sprintf(p, BN_DEC_FMT1, *lp);
         while (*p)
             p++;
         while (lp != bn_data) {
             lp--;
-            BIO_snprintf(p, BUF_REMAIN, BN_DEC_FMT2, *lp);
+            sprintf(p, BN_DEC_FMT2, *lp);
             while (*p)
                 p++;
         }
@@ -332,11 +331,11 @@ char *BN_options(void)
     if (!init) {
         init++;
 #ifdef BN_LLONG
-        BIO_snprintf(data, sizeof data, &quot;bn(%d,%d)&quot;,
-                     (int)sizeof(BN_ULLONG) * 8, (int)sizeof(BN_ULONG) * 8);
+        sprintf(data, &quot;bn(%d,%d)&quot;,
+                (int)sizeof(BN_ULLONG) * 8, (int)sizeof(BN_ULONG) * 8);
 #else
-        BIO_snprintf(data, sizeof data, &quot;bn(%d,%d)&quot;,
-                     (int)sizeof(BN_ULONG) * 8, (int)sizeof(BN_ULONG) * 8);
+        sprintf(data, &quot;bn(%d,%d)&quot;,
+                (int)sizeof(BN_ULONG) * 8, (int)sizeof(BN_ULONG) * 8);
 #endif
     }
     return (data);
diff --git a/crypto/conf/conf_def.c b/crypto/conf/conf_def.c
index a7b11d1..78acdec 100644
--- a/crypto/conf/conf_def.c
+++ b/crypto/conf/conf_def.c
@@ -323,7 +323,7 @@ static int def_load_bio(CONF *conf, BIO *in, long *line)
                 CONFerr(CONF_F_DEF_LOAD_BIO, ERR_R_MALLOC_FAILURE);
                 goto err;
             }
-            OPENSSL_strlcpy(v-&gt;name, pname, strlen(pname) + 1);
+            strcpy(v-&gt;name, pname);
             if (!str_copy(conf, psection, &amp;(v-&gt;value), start))
                 goto err;
 
@@ -353,7 +353,7 @@ static int def_load_bio(CONF *conf, BIO *in, long *line)
     OPENSSL_free(section);
     if (line != NULL)
         *line = eline;
-    BIO_snprintf(btmp, sizeof btmp, &quot;%ld&quot;, eline);
+    sprintf(btmp, &quot;%ld&quot;, eline);
     ERR_add_error_data(2, &quot;line &quot;, btmp);
     if (h != conf-&gt;data) {
         CONF_free(conf-&gt;data);
diff --git a/crypto/conf/conf_mod.c b/crypto/conf/conf_mod.c
index 31f838e..33a9698 100644
--- a/crypto/conf/conf_mod.c
+++ b/crypto/conf/conf_mod.c
@@ -171,7 +171,7 @@ static int module_run(const CONF *cnf, const char *name, const char *value,
         if (!(flags &amp; CONF_MFLAGS_SILENT)) {
             char rcode[DECIMAL_SIZE(ret) + 1];
             CONFerr(CONF_F_MODULE_RUN, CONF_R_MODULE_INITIALIZATION_ERROR);
-            BIO_snprintf(rcode, sizeof rcode, &quot;%-8d&quot;, ret);
+            sprintf(rcode, &quot;%-8d&quot;, ret);
             ERR_add_error_data(6, &quot;module=&quot;, name, &quot;, value=&quot;, value,
                                &quot;, retcode=&quot;, rcode);
         }
@@ -492,11 +492,11 @@ char *CONF_get1_default_config_file(void)
 
     if (file == NULL)
         return NULL;
-    OPENSSL_strlcpy(file, X509_get_default_cert_area(), len + 1);
+    strcpy(file, X509_get_default_cert_area());
 #ifndef OPENSSL_SYS_VMS
-    OPENSSL_strlcat(file, &quot;/&quot;, len + 1);
+    strcat(file, &quot;/&quot;);
 #endif
-    OPENSSL_strlcat(file, OPENSSL_CONF, len + 1);
+    strcat(file, OPENSSL_CONF);
 
     return file;
 }
diff --git a/crypto/cversion.c b/crypto/cversion.c
index 96d8a5b..4e00702 100644
--- a/crypto/cversion.c
+++ b/crypto/cversion.c
@@ -9,9 +9,7 @@
 
 #include &quot;internal/cryptlib.h&quot;
 
-#ifndef NO_WINDOWS_BRAINDEATH
-# include &quot;buildinf.h&quot;
-#endif
+#include &quot;buildinf.h&quot;
 
 unsigned long OpenSSL_version_num(void)
 {
diff --git a/crypto/des/ecb_enc.c b/crypto/des/ecb_enc.c
index bd130c6..0b292a2 100644
--- a/crypto/des/ecb_enc.c
+++ b/crypto/des/ecb_enc.c
@@ -24,7 +24,7 @@ const char *DES_options(void)
             size = &quot;int&quot;;
         else
             size = &quot;long&quot;;
-        BIO_snprintf(buf, sizeof buf, &quot;des(%s)&quot;, size);
+        sprintf(buf, &quot;des(%s)&quot;, size);
         init = 0;
     }
     return (buf);
diff --git a/crypto/engine/eng_ctrl.c b/crypto/engine/eng_ctrl.c
index 7925f4f..8168111 100644
--- a/crypto/engine/eng_ctrl.c
+++ b/crypto/engine/eng_ctrl.c
@@ -109,19 +109,15 @@ static int int_ctrl_helper(ENGINE *e, int cmd, long i, void *p,
     case ENGINE_CTRL_GET_NAME_LEN_FROM_CMD:
         return strlen(e-&gt;cmd_defns[idx].cmd_name);
     case ENGINE_CTRL_GET_NAME_FROM_CMD:
-        return BIO_snprintf(s, strlen(e-&gt;cmd_defns[idx].cmd_name) + 1,
-                            &quot;%s&quot;, e-&gt;cmd_defns[idx].cmd_name);
+        return sprintf(s, &quot;%s&quot;, e-&gt;cmd_defns[idx].cmd_name);
     case ENGINE_CTRL_GET_DESC_LEN_FROM_CMD:
         if (e-&gt;cmd_defns[idx].cmd_desc)
             return strlen(e-&gt;cmd_defns[idx].cmd_desc);
         return strlen(int_no_description);
     case ENGINE_CTRL_GET_DESC_FROM_CMD:
         if (e-&gt;cmd_defns[idx].cmd_desc)
-            return BIO_snprintf(s,
-                                strlen(e-&gt;cmd_defns[idx].cmd_desc) + 1,
-                                &quot;%s&quot;, e-&gt;cmd_defns[idx].cmd_desc);
-        return BIO_snprintf(s, strlen(int_no_description) + 1, &quot;%s&quot;,
-                            int_no_description);
+            return sprintf(s, &quot;%s&quot;, e-&gt;cmd_defns[idx].cmd_desc);
+        return sprintf(s, &quot;%s&quot;, int_no_description);
     case ENGINE_CTRL_GET_CMD_FLAGS:
         return e-&gt;cmd_defns[idx].cmd_flags;
     }
diff --git a/crypto/evp/evp_pbe.c b/crypto/evp/evp_pbe.c
index ce7aa2c..354532d 100644
--- a/crypto/evp/evp_pbe.c
+++ b/crypto/evp/evp_pbe.c
@@ -90,7 +90,7 @@ int EVP_PBE_CipherInit(ASN1_OBJECT *pbe_obj, const char *pass, int passlen,
         char obj_tmp[80];
         EVPerr(EVP_F_EVP_PBE_CIPHERINIT, EVP_R_UNKNOWN_PBE_ALGORITHM);
         if (!pbe_obj)
-            OPENSSL_strlcpy(obj_tmp, &quot;NULL&quot;, sizeof obj_tmp);
+            strcpy(obj_tmp, &quot;NULL&quot;);
         else
             i2t_ASN1_OBJECT(obj_tmp, sizeof obj_tmp, pbe_obj);
         ERR_add_error_data(2, &quot;TYPE=&quot;, obj_tmp);
diff --git a/crypto/mem_dbg.c b/crypto/mem_dbg.c
index 4c4e7d3..c0bb2be 100644
--- a/crypto/mem_dbg.c
+++ b/crypto/mem_dbg.c
@@ -467,24 +467,19 @@ static void print_leak(const MEM *m, MEM_LEAK *l)
     } tid;
     CRYPTO_THREAD_ID ti;
 
-#define BUF_REMAIN (sizeof buf - (size_t)(bufp - buf))
-
     lcl = localtime(&amp;m-&gt;time);
-    BIO_snprintf(bufp, BUF_REMAIN, &quot;[%02d:%02d:%02d] &quot;,
-                 lcl-&gt;tm_hour, lcl-&gt;tm_min, lcl-&gt;tm_sec);
+    sprintf(bufp, &quot;[%02d:%02d:%02d] &quot;, lcl-&gt;tm_hour, lcl-&gt;tm_min, lcl-&gt;tm_sec);
     bufp += strlen(bufp);
 
-    BIO_snprintf(bufp, BUF_REMAIN, &quot;%5lu file=%s, line=%d, &quot;,
-                 m-&gt;order, m-&gt;file, m-&gt;line);
+    sprintf(bufp, &quot;%5lu file=%s, line=%d, &quot;, m-&gt;order, m-&gt;file, m-&gt;line);
     bufp += strlen(bufp);
 
     tid.ltid = 0;
     tid.tid = m-&gt;threadid;
-    BIO_snprintf(bufp, BUF_REMAIN, &quot;thread=%lu, &quot;, tid.ltid);
+    sprintf(bufp, &quot;thread=%lu, &quot;, tid.ltid);
     bufp += strlen(bufp);
 
-    BIO_snprintf(bufp, BUF_REMAIN, &quot;number=%d, address=%p\n&quot;,
-                 m-&gt;num, m-&gt;addr);
+    sprintf(bufp, &quot;number=%d, address=%p\n&quot;, m-&gt;num, m-&gt;addr);
     bufp += strlen(bufp);
 
     l-&gt;print_cb(buf, strlen(buf), l-&gt;print_cb_arg);
@@ -506,20 +501,18 @@ static void print_leak(const MEM *m, MEM_LEAK *l)
             memset(buf, '&gt;', ami_cnt);
             tid.ltid = 0;
             tid.tid = amip-&gt;threadid;
-            BIO_snprintf(buf + ami_cnt, sizeof buf - ami_cnt,
-                         &quot; thread=%lu, file=%s, line=%d, info=\&quot;&quot;,
-                         tid.ltid, amip-&gt;file,
-                         amip-&gt;line);
+            sprintf(buf + ami_cnt, &quot; thread=%lu, file=%s, line=%d, info=\&quot;&quot;,
+                    tid.ltid, amip-&gt;file, amip-&gt;line);
             buf_len = strlen(buf);
             info_len = strlen(amip-&gt;info);
             if (128 - buf_len - 3 &lt; info_len) {
                 memcpy(buf + buf_len, amip-&gt;info, 128 - buf_len - 3);
                 buf_len = 128 - 3;
             } else {
-                OPENSSL_strlcpy(buf + buf_len, amip-&gt;info, sizeof buf - buf_len);
+                strcpy(buf + buf_len, amip-&gt;info);
                 buf_len = strlen(buf);
             }
-            BIO_snprintf(buf + buf_len, sizeof buf - buf_len, &quot;\&quot;\n&quot;);
+            sprintf(buf + buf_len, &quot;\&quot;\n&quot;);
 
             l-&gt;print_cb(buf, strlen(buf), l-&gt;print_cb_arg);
 
diff --git a/crypto/objects/obj_dat.c b/crypto/objects/obj_dat.c
index f8c1db3..72919ce 100644
--- a/crypto/objects/obj_dat.c
+++ b/crypto/objects/obj_dat.c
@@ -500,7 +500,7 @@ int OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no_name)
             n += i;
             OPENSSL_free(bndec);
         } else {
-            BIO_snprintf(tbuf, sizeof tbuf, &quot;.%lu&quot;, l);
+            sprintf(tbuf, &quot;.%lu&quot;, l);
             i = strlen(tbuf);
             if (buf &amp;&amp; (buf_len &gt; 0)) {
                 OPENSSL_strlcpy(buf, tbuf, buf_len);
diff --git a/crypto/pem/pem_lib.c b/crypto/pem/pem_lib.c
index e937b0e..f18dcca 100644
--- a/crypto/pem/pem_lib.c
+++ b/crypto/pem/pem_lib.c
@@ -81,9 +81,9 @@ void PEM_proc_type(char *buf, int type)
     else
         str = &quot;BAD-TYPE&quot;;
 
-    OPENSSL_strlcat(buf, &quot;Proc-Type: 4,&quot;, PEM_BUFSIZE);
-    OPENSSL_strlcat(buf, str, PEM_BUFSIZE);
-    OPENSSL_strlcat(buf, &quot;\n&quot;, PEM_BUFSIZE);
+    strcat(buf, &quot;Proc-Type: 4,&quot;);
+    strcat(buf, str);
+    strcat(buf, &quot;\n&quot;);
 }
 
 void PEM_dek_info(char *buf, const char *type, int len, char *str)
@@ -92,12 +92,10 @@ void PEM_dek_info(char *buf, const char *type, int len, char *str)
     long i;
     int j;
 
-    OPENSSL_strlcat(buf, &quot;DEK-Info: &quot;, PEM_BUFSIZE);
-    OPENSSL_strlcat(buf, type, PEM_BUFSIZE);
-    OPENSSL_strlcat(buf, &quot;,&quot;, PEM_BUFSIZE);
+    strcat(buf, &quot;DEK-Info: &quot;);
+    strcat(buf, type);
+    strcat(buf, &quot;,&quot;);
     j = strlen(buf);
-    if (j + (len * 2) + 1 &gt; PEM_BUFSIZE)
-        return;
     for (i = 0; i &lt; len; i++) {
         buf[j + i * 2] = map[(str[i] &gt;&gt; 4) &amp; 0x0f];
         buf[j + i * 2 + 1] = map[(str[i]) &amp; 0x0f];
diff --git a/crypto/rand/rand_egd.c b/crypto/rand/rand_egd.c
index dd58b21..3f812c6 100644
--- a/crypto/rand/rand_egd.c
+++ b/crypto/rand/rand_egd.c
@@ -102,7 +102,7 @@ int RAND_query_egd_bytes(const char *path, unsigned char *buf, int bytes)
     addr.sun_family = AF_UNIX;
     if (strlen(path) &gt;= sizeof(addr.sun_path))
         return (-1);
-    OPENSSL_strlcpy(addr.sun_path, path, sizeof addr.sun_path);
+    strcpy(addr.sun_path, path);
     len = offsetof(struct sockaddr_un, sun_path) + strlen(path);
     fd = socket(AF_UNIX, SOCK_STREAM, 0);
     if (fd == -1)
diff --git a/crypto/x509/by_dir.c b/crypto/x509/by_dir.c
index 201ed12..b519dc4 100644
--- a/crypto/x509/by_dir.c
+++ b/crypto/x509/by_dir.c
@@ -295,8 +295,8 @@ static int get_cert_by_subject(X509_LOOKUP *xl, X509_LOOKUP_TYPE type,
                 BIO_snprintf(b-&gt;data, b-&gt;max,
                              &quot;%s%08lx.%s%d&quot;, ent-&gt;dir, h, postfix, k);
             } else {
-                BIO_snprintf(b-&gt;data, b-&gt;max,
-                             &quot;%s%c%08lx.%s%d&quot;, ent-&gt;dir, c, h, postfix, k);
+                sprintf(b-&gt;data,
+                        &quot;%s%c%08lx.%s%d&quot;, ent-&gt;dir, c, h, postfix, k);
             }
 #ifndef OPENSSL_NO_POSIX_IO
 # ifdef _WIN32
diff --git a/crypto/x509v3/v3_alt.c b/crypto/x509v3/v3_alt.c
index 6f50bfd..6d4323a 100644
--- a/crypto/x509v3/v3_alt.c
+++ b/crypto/x509v3/v3_alt.c
@@ -108,12 +108,11 @@ STACK_OF(CONF_VALUE) *i2v_GENERAL_NAME(X509V3_EXT_METHOD *method,
     case GEN_IPADD:
         p = gen-&gt;d.ip-&gt;data;
         if (gen-&gt;d.ip-&gt;length == 4)
-            BIO_snprintf(oline, sizeof oline,
-                         &quot;%d.%d.%d.%d&quot;, p[0], p[1], p[2], p[3]);
+            sprintf(oline, &quot;%d.%d.%d.%d&quot;, p[0], p[1], p[2], p[3]);
         else if (gen-&gt;d.ip-&gt;length == 16) {
             oline[0] = 0;
             for (i = 0; i &lt; 8; i++) {
-                BIO_snprintf(htmp, sizeof htmp, &quot;%X&quot;, p[0] &lt;&lt; 8 | p[1]);
+                sprintf(htmp, &quot;%X&quot;, p[0] &lt;&lt; 8 | p[1]);
                 p += 2;
                 strcat(oline, htmp);
                 if (i != 7)
diff --git a/crypto/x509v3/v3_info.c b/crypto/x509v3/v3_info.c
index c29c7e2..590cbc4 100644
--- a/crypto/x509v3/v3_info.c
+++ b/crypto/x509v3/v3_info.c
@@ -78,13 +78,13 @@ static STACK_OF(CONF_VALUE) *i2v_AUTHORITY_INFO_ACCESS(
         tret = tmp;
         vtmp = sk_CONF_VALUE_value(tret, i);
         i2t_ASN1_OBJECT(objtmp, sizeof objtmp, desc-&gt;method);
-        nlen = strlen(objtmp) + strlen(vtmp-&gt;name) + 5;
+        nlen = strlen(objtmp) + 3 + strlen(vtmp-&gt;name) + 1;
         ntmp = OPENSSL_malloc(nlen);
         if (ntmp == NULL)
             goto err;
-        OPENSSL_strlcpy(ntmp, objtmp, nlen);
-        OPENSSL_strlcat(ntmp, &quot; - &quot;, nlen);
-        OPENSSL_strlcat(ntmp, vtmp-&gt;name, nlen);
+        strcpy(ntmp, objtmp);
+        strcat(ntmp, &quot; - &quot;);
+        strcat(ntmp, vtmp-&gt;name);
         OPENSSL_free(vtmp-&gt;name);
         vtmp-&gt;name = ntmp;
 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015341.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="015346.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15345">[ date ]</a>
              <a href="thread.html#15345">[ thread ]</a>
              <a href="subject.html#15345">[ subject ]</a>
              <a href="author.html#15345">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
