<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2021-July/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1625532796.802039.29281.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034865.html">
   <LINK REL="Next"  HREF="034868.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl]  master update</H1>
    <B>Dr. Paul Dale</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1625532796.802039.29281.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl]  master update">pauli at openssl.org
       </A><BR>
    <I>Tue Jul  6 00:53:16 UTC 2021</I>
    <P><UL>
        <LI>Previous message: <A HREF="034865.html">[openssl]  master update
</A></li>
        <LI>Next message: <A HREF="034868.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34867">[ date ]</a>
              <a href="thread.html#34867">[ thread ]</a>
              <a href="subject.html#34867">[ subject ]</a>
              <a href="author.html#34867">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  2f61bc17d42bce0d5958cabc971f4f1343353fb3 (commit)
       via  3f773c911a03c5be2eff00beaf94e88f1d997b22 (commit)
      from  1627a41f1db38c0e762cbbcb452a869924370561 (commit)


- Log -----------------------------------------------------------------
commit 2f61bc17d42bce0d5958cabc971f4f1343353fb3
Author: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
Date:   Thu Jul 1 17:41:47 2021 +0200

    update fips checksums
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15974">https://github.com/openssl/openssl/pull/15974</A>)

commit 3f773c911a03c5be2eff00beaf94e88f1d997b22
Author: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
Date:   Thu Jul 1 17:41:02 2021 +0200

    fips module header inclusion fine-tunning
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15974">https://github.com/openssl/openssl/pull/15974</A>)

-----------------------------------------------------------------------

Summary of changes:
 crypto/dh/dh_backend.c                             |  3 +
 crypto/dh/dh_lib.c                                 |  4 +-
 crypto/dsa/dsa_backend.c                           |  3 +
 crypto/dsa/dsa_lib.c                               |  4 +-
 crypto/ec/ec_backend.c                             |  5 +-
 crypto/ec/ec_key.c                                 |  4 +-
 crypto/ec/ec_kmeth.c                               |  4 +-
 crypto/ec/ecx_backend.c                            |  3 +
 crypto/evp/digest.c                                |  4 +-
 crypto/evp/evp_enc.c                               |  4 +-
 crypto/evp/evp_lib.c                               |  2 +-
 crypto/evp/evp_rand.c                              |  5 --
 crypto/evp/kdf_lib.c                               |  3 -
 crypto/evp/keymgmt_lib.c                           |  1 -
 crypto/evp/m_sigver.c                              |  1 -
 crypto/evp/p_lib.c                                 | 11 ++-
 crypto/evp/pmeth_check.c                           |  4 +-
 crypto/evp/pmeth_gn.c                              |  4 +-
 crypto/evp/pmeth_lib.c                             |  9 ++-
 crypto/rsa/rsa_backend.c                           |  5 +-
 crypto/rsa/rsa_lib.c                               |  4 +-
 crypto/rsa/rsa_sign.c                              | 32 ++++----
 include/crypto/dh.h                                |  1 -
 include/crypto/dsa.h                               |  1 -
 include/crypto/ec.h                                |  1 -
 include/crypto/ecx.h                               |  1 -
 include/crypto/rsa.h                               |  1 -
 providers/common/include/prov/provider_util.h      |  2 +-
 providers/common/provider_util.c                   |  3 +
 providers/fips-sources.checksums                   | 88 ++++++++--------------
 providers/fips.checksum                            |  2 +-
 providers/fips.module.sources                      | 22 ------
 .../implementations/keymgmt/mac_legacy_kmgmt.c     |  3 +
 providers/implementations/macs/cmac_prov.c         |  3 +-
 providers/implementations/macs/gmac_prov.c         |  1 -
 providers/implementations/macs/hmac_prov.c         |  1 -
 .../implementations/signature/mac_legacy_sig.c     |  3 +
 ssl/s3_cbc.c                                       |  4 +-
 38 files changed, 122 insertions(+), 134 deletions(-)

diff --git a/crypto/dh/dh_backend.c b/crypto/dh/dh_backend.c
index a727d5c87b..7bd5c617de 100644
--- a/crypto/dh/dh_backend.c
+++ b/crypto/dh/dh_backend.c
@@ -15,6 +15,9 @@
 
 #include &lt;openssl/err.h&gt;
 #include &lt;openssl/core_names.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/x509.h&gt;
+#endif
 #include &quot;internal/param_build_set.h&quot;
 #include &quot;crypto/dh.h&quot;
 #include &quot;dh_local.h&quot;
diff --git a/crypto/dh/dh_lib.c b/crypto/dh/dh_lib.c
index 7154f8c2ab..29cda5d7bf 100644
--- a/crypto/dh/dh_lib.c
+++ b/crypto/dh/dh_lib.c
@@ -15,7 +15,9 @@
 
 #include &lt;stdio.h&gt;
 #include &lt;openssl/bn.h&gt;
-#include &lt;openssl/engine.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/engine.h&gt;
+#endif
 #include &lt;openssl/obj_mac.h&gt;
 #include &lt;openssl/core_names.h&gt;
 #include &quot;internal/cryptlib.h&quot;
diff --git a/crypto/dsa/dsa_backend.c b/crypto/dsa/dsa_backend.c
index e4fa070f23..5e3ff85154 100644
--- a/crypto/dsa/dsa_backend.c
+++ b/crypto/dsa/dsa_backend.c
@@ -15,6 +15,9 @@
 
 #include &lt;openssl/core_names.h&gt;
 #include &lt;openssl/err.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/x509.h&gt;
+#endif
 #include &quot;crypto/dsa.h&quot;
 #include &quot;dsa_local.h&quot;
 
diff --git a/crypto/dsa/dsa_lib.c b/crypto/dsa/dsa_lib.c
index 5512b99ef1..ccc7016592 100644
--- a/crypto/dsa/dsa_lib.c
+++ b/crypto/dsa/dsa_lib.c
@@ -14,7 +14,9 @@
 #include &quot;internal/deprecated.h&quot;
 
 #include &lt;openssl/bn.h&gt;
-#include &lt;openssl/engine.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/engine.h&gt;
+#endif
 #include &quot;internal/cryptlib.h&quot;
 #include &quot;internal/refcount.h&quot;
 #include &quot;crypto/dsa.h&quot;
diff --git a/crypto/ec/ec_backend.c b/crypto/ec/ec_backend.c
index 9b4467f2be..381da71f33 100644
--- a/crypto/ec/ec_backend.c
+++ b/crypto/ec/ec_backend.c
@@ -17,7 +17,10 @@
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/params.h&gt;
 #include &lt;openssl/err.h&gt;
-#include &lt;openssl/engine.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/engine.h&gt;
+# include &lt;openssl/x509.h&gt;
+#endif
 #include &quot;crypto/bn.h&quot;
 #include &quot;crypto/ec.h&quot;
 #include &quot;ec_local.h&quot;
diff --git a/crypto/ec/ec_key.c b/crypto/ec/ec_key.c
index ba6b8df514..eb14f4e409 100644
--- a/crypto/ec/ec_key.c
+++ b/crypto/ec/ec_key.c
@@ -19,7 +19,9 @@
 #include &quot;ec_local.h&quot;
 #include &quot;internal/refcount.h&quot;
 #include &lt;openssl/err.h&gt;
-#include &lt;openssl/engine.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/engine.h&gt;
+#endif
 #include &lt;openssl/self_test.h&gt;
 #include &quot;prov/providercommon.h&quot;
 #include &quot;crypto/bn.h&quot;
diff --git a/crypto/ec/ec_kmeth.c b/crypto/ec/ec_kmeth.c
index 91b7a44082..8c011635cb 100644
--- a/crypto/ec/ec_kmeth.c
+++ b/crypto/ec/ec_kmeth.c
@@ -15,7 +15,9 @@
 
 #include &lt;string.h&gt;
 #include &lt;openssl/ec.h&gt;
-#include &lt;openssl/engine.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/engine.h&gt;
+#endif
 #include &lt;openssl/err.h&gt;
 #include &quot;ec_local.h&quot;
 
diff --git a/crypto/ec/ecx_backend.c b/crypto/ec/ecx_backend.c
index 14278592cd..a0144d5a86 100644
--- a/crypto/ec/ecx_backend.c
+++ b/crypto/ec/ecx_backend.c
@@ -13,6 +13,9 @@
 #include &lt;openssl/ec.h&gt;
 #include &lt;openssl/rand.h&gt;
 #include &lt;openssl/err.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/x509.h&gt;
+#endif
 #include &quot;crypto/ecx.h&quot;
 #include &quot;ecx_backend.h&quot;
 
diff --git a/crypto/evp/digest.c b/crypto/evp/digest.c
index 4a5c926103..1f2910bc69 100644
--- a/crypto/evp/digest.c
+++ b/crypto/evp/digest.c
@@ -14,7 +14,9 @@
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/ec.h&gt;
-#include &lt;openssl/engine.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/engine.h&gt;
+#endif
 #include &lt;openssl/params.h&gt;
 #include &lt;openssl/core_names.h&gt;
 #include &quot;internal/cryptlib.h&quot;
diff --git a/crypto/evp/evp_enc.c b/crypto/evp/evp_enc.c
index 3a8e2c643e..e0f411aa06 100644
--- a/crypto/evp/evp_enc.c
+++ b/crypto/evp/evp_enc.c
@@ -16,7 +16,9 @@
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/err.h&gt;
 #include &lt;openssl/rand.h&gt;
-#include &lt;openssl/engine.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/engine.h&gt;
+#endif
 #include &lt;openssl/params.h&gt;
 #include &lt;openssl/core_names.h&gt;
 #include &quot;internal/cryptlib.h&quot;
diff --git a/crypto/evp/evp_lib.c b/crypto/evp/evp_lib.c
index 0b08c9adfd..f78df52ab1 100644
--- a/crypto/evp/evp_lib.c
+++ b/crypto/evp/evp_lib.c
@@ -25,11 +25,11 @@
 #include &lt;openssl/dh.h&gt;
 #include &lt;openssl/ec.h&gt;
 #include &quot;crypto/evp.h&quot;
-#include &quot;crypto/asn1.h&quot;
 #include &quot;internal/provider.h&quot;
 #include &quot;evp_local.h&quot;
 
 #if !defined(FIPS_MODULE)
+# include &quot;crypto/asn1.h&quot;
 
 int EVP_CIPHER_param_to_asn1(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
 {
diff --git a/crypto/evp/evp_rand.c b/crypto/evp/evp_rand.c
index 7b1a44241e..0db755e06b 100644
--- a/crypto/evp/evp_rand.c
+++ b/crypto/evp/evp_rand.c
@@ -7,13 +7,9 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &lt;openssl/evp.h&gt;
-
 #include &lt;stdio.h&gt;
 #include &lt;stdlib.h&gt;
-#include &lt;openssl/engine.h&gt;
 #include &lt;openssl/evp.h&gt;
-#include &lt;openssl/x509v3.h&gt;
 #include &lt;openssl/rand.h&gt;
 #include &lt;openssl/core.h&gt;
 #include &lt;openssl/core_names.h&gt;
@@ -22,7 +18,6 @@
 #include &quot;internal/numbers.h&quot;
 #include &quot;internal/provider.h&quot;
 #include &quot;internal/core.h&quot;
-#include &quot;crypto/asn1.h&quot;
 #include &quot;crypto/evp.h&quot;
 #include &quot;evp_local.h&quot;
 
diff --git a/crypto/evp/kdf_lib.c b/crypto/evp/kdf_lib.c
index 5552b26601..8177626ae0 100644
--- a/crypto/evp/kdf_lib.c
+++ b/crypto/evp/kdf_lib.c
@@ -11,13 +11,10 @@
 #include &lt;stdio.h&gt;
 #include &lt;stdlib.h&gt;
 #include &quot;internal/cryptlib.h&quot;
-#include &lt;openssl/engine.h&gt;
 #include &lt;openssl/evp.h&gt;
-#include &lt;openssl/x509v3.h&gt;
 #include &lt;openssl/kdf.h&gt;
 #include &lt;openssl/core.h&gt;
 #include &lt;openssl/core_names.h&gt;
-#include &quot;crypto/asn1.h&quot;
 #include &quot;crypto/evp.h&quot;
 #include &quot;internal/numbers.h&quot;
 #include &quot;internal/provider.h&quot;
diff --git a/crypto/evp/keymgmt_lib.c b/crypto/evp/keymgmt_lib.c
index f3dd876cfd..32e4fbcbaa 100644
--- a/crypto/evp/keymgmt_lib.c
+++ b/crypto/evp/keymgmt_lib.c
@@ -11,7 +11,6 @@
 #include &quot;internal/cryptlib.h&quot;
 #include &quot;internal/nelem.h&quot;
 #include &quot;crypto/evp.h&quot;
-#include &quot;crypto/asn1.h&quot;
 #include &quot;internal/core.h&quot;
 #include &quot;internal/provider.h&quot;
 #include &quot;evp_local.h&quot;
diff --git a/crypto/evp/m_sigver.c b/crypto/evp/m_sigver.c
index 0da6498030..5c5ed05876 100644
--- a/crypto/evp/m_sigver.c
+++ b/crypto/evp/m_sigver.c
@@ -11,7 +11,6 @@
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/objects.h&gt;
-#include &lt;openssl/x509.h&gt;
 #include &quot;crypto/evp.h&quot;
 #include &quot;internal/provider.h&quot;
 #include &quot;internal/numbers.h&quot;   /* includes SIZE_MAX */
diff --git a/crypto/evp/p_lib.c b/crypto/evp/p_lib.c
index 07be8884fe..fa3a0258fa 100644
--- a/crypto/evp/p_lib.c
+++ b/crypto/evp/p_lib.c
@@ -22,13 +22,14 @@
 #include &lt;openssl/err.h&gt;
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/evp.h&gt;
-#include &lt;openssl/x509.h&gt;
 #include &lt;openssl/rsa.h&gt;
 #include &lt;openssl/dsa.h&gt;
 #include &lt;openssl/dh.h&gt;
 #include &lt;openssl/ec.h&gt;
 #include &lt;openssl/cmac.h&gt;
-#include &lt;openssl/engine.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/engine.h&gt;
+#endif
 #include &lt;openssl/params.h&gt;
 #include &lt;openssl/param_build.h&gt;
 #include &lt;openssl/encoder.h&gt;
@@ -36,14 +37,16 @@
 
 #include &quot;internal/numbers.h&quot;   /* includes SIZE_MAX */
 #include &quot;internal/ffc.h&quot;
-#include &quot;crypto/asn1.h&quot;
 #include &quot;crypto/evp.h&quot;
 #include &quot;crypto/dh.h&quot;
 #include &quot;crypto/dsa.h&quot;
 #include &quot;crypto/ec.h&quot;
 #include &quot;crypto/ecx.h&quot;
 #include &quot;crypto/rsa.h&quot;
-#include &quot;crypto/x509.h&quot;
+#ifndef FIPS_MODULE
+# include &quot;crypto/asn1.h&quot;
+# include &quot;crypto/x509.h&quot;
+#endif
 #include &quot;internal/provider.h&quot;
 #include &quot;evp_local.h&quot;
 
diff --git a/crypto/evp/pmeth_check.c b/crypto/evp/pmeth_check.c
index 112965e794..2ecf2d0251 100644
--- a/crypto/evp/pmeth_check.c
+++ b/crypto/evp/pmeth_check.c
@@ -13,7 +13,9 @@
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &quot;crypto/bn.h&quot;
-#include &quot;crypto/asn1.h&quot;
+#ifndef FIPS_MODULE
+# include &quot;crypto/asn1.h&quot;
+#endif
 #include &quot;crypto/evp.h&quot;
 #include &quot;evp_local.h&quot;
 
diff --git a/crypto/evp/pmeth_gn.c b/crypto/evp/pmeth_gn.c
index 2d96e3c227..af3d990869 100644
--- a/crypto/evp/pmeth_gn.c
+++ b/crypto/evp/pmeth_gn.c
@@ -16,7 +16,9 @@
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &quot;crypto/bn.h&quot;
-#include &quot;crypto/asn1.h&quot;
+#ifndef FIPS_MODULE
+# include &quot;crypto/asn1.h&quot;
+#endif
 #include &quot;crypto/evp.h&quot;
 #include &quot;evp_local.h&quot;
 
diff --git a/crypto/evp/pmeth_lib.c b/crypto/evp/pmeth_lib.c
index 1256e981eb..c214163588 100644
--- a/crypto/evp/pmeth_lib.c
+++ b/crypto/evp/pmeth_lib.c
@@ -15,15 +15,18 @@
 
 #include &lt;stdio.h&gt;
 #include &lt;stdlib.h&gt;
-#include &lt;openssl/engine.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/engine.h&gt;
+#endif
 #include &lt;openssl/evp.h&gt;
-#include &lt;openssl/x509v3.h&gt;
 #include &lt;openssl/core_names.h&gt;
 #include &lt;openssl/dh.h&gt;
 #include &lt;openssl/rsa.h&gt;
 #include &lt;openssl/kdf.h&gt;
 #include &quot;internal/cryptlib.h&quot;
-#include &quot;crypto/asn1.h&quot;
+#ifndef FIPS_MODULE
+# include &quot;crypto/asn1.h&quot;
+#endif
 #include &quot;crypto/evp.h&quot;
 #include &quot;crypto/dh.h&quot;
 #include &quot;crypto/ec.h&quot;
diff --git a/crypto/rsa/rsa_backend.c b/crypto/rsa/rsa_backend.c
index e824dcaf3c..85ad54e4cf 100644
--- a/crypto/rsa/rsa_backend.c
+++ b/crypto/rsa/rsa_backend.c
@@ -18,9 +18,12 @@
 #include &lt;openssl/params.h&gt;
 #include &lt;openssl/err.h&gt;
 #include &lt;openssl/evp.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/x509.h&gt;
+# include &quot;crypto/asn1.h&quot;
+#endif
 #include &quot;internal/sizes.h&quot;
 #include &quot;internal/param_build_set.h&quot;
-#include &quot;crypto/asn1.h&quot;
 #include &quot;crypto/rsa.h&quot;
 #include &quot;rsa_local.h&quot;
 
diff --git a/crypto/rsa/rsa_lib.c b/crypto/rsa/rsa_lib.c
index 70eaa59a8b..6433282597 100644
--- a/crypto/rsa/rsa_lib.c
+++ b/crypto/rsa/rsa_lib.c
@@ -15,7 +15,9 @@
 
 #include &lt;openssl/crypto.h&gt;
 #include &lt;openssl/core_names.h&gt;
-#include &lt;openssl/engine.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/engine.h&gt;
+#endif
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/param_build.h&gt;
 #include &quot;internal/cryptlib.h&quot;
diff --git a/crypto/rsa/rsa_sign.c b/crypto/rsa/rsa_sign.c
index 21a2e9d727..c5a664dc0b 100644
--- a/crypto/rsa/rsa_sign.c
+++ b/crypto/rsa/rsa_sign.c
@@ -18,22 +18,22 @@
 #include &lt;openssl/bn.h&gt;
 #include &lt;openssl/rsa.h&gt;
 #include &lt;openssl/objects.h&gt;
-#include &lt;openssl/x509.h&gt;
-#include &quot;crypto/x509.h&quot;
-#ifndef OPENSSL_NO_MD2
-# include &lt;openssl/md2.h&gt; /* uses MD2_DIGEST_LENGTH */
-#endif
-#ifndef OPENSSL_NO_MD4
-# include &lt;openssl/md4.h&gt; /* uses MD4_DIGEST_LENGTH */
-#endif
-#ifndef OPENSSL_NO_MD5
-# include &lt;openssl/md5.h&gt; /* uses MD5_DIGEST_LENGTH */
-#endif
-#ifndef OPENSSL_NO_MDC2
-# include &lt;openssl/mdc2.h&gt; /* uses MDC2_DIGEST_LENGTH */
-#endif
-#ifndef OPENSSL_NO_RMD160
-# include &lt;openssl/ripemd.h&gt; /* uses RIPEMD160_DIGEST_LENGTH */
+#ifndef FIPS_MODULE
+# ifndef OPENSSL_NO_MD2
+#  include &lt;openssl/md2.h&gt; /* uses MD2_DIGEST_LENGTH */
+# endif
+# ifndef OPENSSL_NO_MD4
+#  include &lt;openssl/md4.h&gt; /* uses MD4_DIGEST_LENGTH */
+# endif
+# ifndef OPENSSL_NO_MD5
+#  include &lt;openssl/md5.h&gt; /* uses MD5_DIGEST_LENGTH */
+# endif
+# ifndef OPENSSL_NO_MDC2
+#  include &lt;openssl/mdc2.h&gt; /* uses MDC2_DIGEST_LENGTH */
+# endif
+# ifndef OPENSSL_NO_RMD160
+#  include &lt;openssl/ripemd.h&gt; /* uses RIPEMD160_DIGEST_LENGTH */
+# endif
 #endif
 #include &lt;openssl/sha.h&gt; /* uses SHA???_DIGEST_LENGTH */
 #include &quot;crypto/rsa.h&quot;
diff --git a/include/crypto/dh.h b/include/crypto/dh.h
index 8613f9038e..f6be4ae006 100644
--- a/include/crypto/dh.h
+++ b/include/crypto/dh.h
@@ -14,7 +14,6 @@
 # include &lt;openssl/core.h&gt;
 # include &lt;openssl/params.h&gt;
 # include &lt;openssl/dh.h&gt;
-# include &lt;openssl/x509.h&gt;
 # include &quot;internal/ffc.h&quot;
 
 DH *ossl_dh_new_by_nid_ex(OSSL_LIB_CTX *libctx, int nid);
diff --git a/include/crypto/dsa.h b/include/crypto/dsa.h
index dad056bb28..eedbd8c7d1 100644
--- a/include/crypto/dsa.h
+++ b/include/crypto/dsa.h
@@ -13,7 +13,6 @@
 
 # include &lt;openssl/core.h&gt;
 # include &lt;openssl/dsa.h&gt;
-# include &lt;openssl/x509.h&gt;
 # include &quot;internal/ffc.h&quot;
 
 #define DSA_PARAMGEN_TYPE_FIPS_186_4   0   /* Use FIPS186-4 standard */
diff --git a/include/crypto/ec.h b/include/crypto/ec.h
index 77972c3650..62163b31ac 100644
--- a/include/crypto/ec.h
+++ b/include/crypto/ec.h
@@ -24,7 +24,6 @@ int evp_pkey_ctx_set_ec_param_enc_prov(EVP_PKEY_CTX *ctx, int param_enc);
 # ifndef OPENSSL_NO_EC
 #  include &lt;openssl/core.h&gt;
 #  include &lt;openssl/ec.h&gt;
-#  include &lt;openssl/x509.h&gt;
 #  include &quot;crypto/types.h&quot;
 
 /*-
diff --git a/include/crypto/ecx.h b/include/crypto/ecx.h
index 82671a8f4d..48b95fa5ba 100644
--- a/include/crypto/ecx.h
+++ b/include/crypto/ecx.h
@@ -20,7 +20,6 @@
 #  include &lt;openssl/core.h&gt;
 #  include &lt;openssl/e_os2.h&gt;
 #  include &lt;openssl/crypto.h&gt;
-#  include &lt;openssl/x509.h&gt;
 #  include &quot;internal/refcount.h&quot;
 #  include &quot;crypto/types.h&quot;
 
diff --git a/include/crypto/rsa.h b/include/crypto/rsa.h
index cc67e1f709..100e7ceb05 100644
--- a/include/crypto/rsa.h
+++ b/include/crypto/rsa.h
@@ -13,7 +13,6 @@
 
 # include &lt;openssl/core.h&gt;
 # include &lt;openssl/rsa.h&gt;
-# include &lt;openssl/x509.h&gt;
 # include &quot;crypto/types.h&quot;
 
 #define RSA_MIN_MODULUS_BITS    512
diff --git a/providers/common/include/prov/provider_util.h b/providers/common/include/prov/provider_util.h
index 1f6f4687ad..fa73e46506 100644
--- a/providers/common/include/prov/provider_util.h
+++ b/providers/common/include/prov/provider_util.h
@@ -8,7 +8,7 @@
  */
 
 #include &lt;openssl/provider.h&gt;
-#include &lt;openssl/engine.h&gt;
+#include &lt;openssl/types.h&gt;
 
 typedef struct {
     /*
diff --git a/providers/common/provider_util.c b/providers/common/provider_util.c
index 30fe7c6b21..662175c2f3 100644
--- a/providers/common/provider_util.c
+++ b/providers/common/provider_util.c
@@ -14,6 +14,9 @@
 #include &lt;openssl/core_names.h&gt;
 #include &lt;openssl/err.h&gt;
 #include &lt;openssl/proverr.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/engine.h&gt;
+#endif
 #include &quot;prov/provider_util.h&quot;
 #include &quot;internal/nelem.h&quot;
 
diff --git a/providers/fips-sources.checksums b/providers/fips-sources.checksums
index 37693cd562..3e01b0c295 100644
--- a/providers/fips-sources.checksums
+++ b/providers/fips-sources.checksums
@@ -122,13 +122,13 @@ eeef5722ad56bf1af2ff71681bcc8b8525bc7077e973c98cee920ce9bcc66c81  crypto/des/ecb
 70f4cf3485a38cd7d22aa3e965bfe950905f8efec1622e832592a6728498fd78  crypto/dh/dh_group_params.c
 7809cbfd5570db17dcb4bd8f0cf9c5f94337096d39da453d0624c08f071e809f  crypto/dh/dh_kdf.c
 c71b8691416a61c306ea0973ca22570a56d3e9e93618a3eb2fd7b9d9a789ca44  crypto/dh/dh_key.c
-100aec90d54161ea0f03c6e62b889283e80ef0f73c88d8ae5bc8ad6c17365da3  crypto/dh/dh_lib.c
+b0046b2c4e1d74ff4e93f2486a00f63728909b8a75cbdd29b9100e607f97995c  crypto/dh/dh_lib.c
 8300775d88db0a1aa26a77eb49d6c4f7252e7fee69e1440de4c40edadc9da044  crypto/dh/dh_local.h
 27d0ea795bb7f571ba37b7460eee63608b9089a95337491c0980b91135563e15  crypto/dsa/dsa_backend.c
 b9c5992089203123c3fae46e39bb4d05e19854087bca7a30ad1f82a3505deec7  crypto/dsa/dsa_check.c
 ae727bf6319eb57e682de35d75ea357921987953b3688365c710e7fba51c7c58  crypto/dsa/dsa_gen.c
 b1de1624e590dbf76f76953802ff162cc8de7c5e2eaba897313c866424d6902b  crypto/dsa/dsa_key.c
-c6b05c784a18e7b9f2d8dfcca8e93eb445b02c9e9eaa64087e00fb44f233962e  crypto/dsa/dsa_lib.c
+9e436a2e0867920c3a5ac58bc14300cad4ab2c4c8fe5e40b355dfd21bfdfe146  crypto/dsa/dsa_lib.c
 f4d52d3897219786c6046bf76abb2f174655c584caa50272bf5d281720df5022  crypto/dsa/dsa_local.h
 f88db9fd73a78e66967e56df442b55230f405b4cd804f31f8696324f0b702f15  crypto/dsa/dsa_ossl.c
 b57b648524bc7dd98f8e2737f4e87b5578c7921df59b1df4a03a34e23e977e8a  crypto/dsa/dsa_sign.c
@@ -161,12 +161,12 @@ f6447921a0031fa5beddedd298e82096fb3fdb189b712fab328b61f6beae0c23  crypto/ec/curv
 ae1637d89287c9d22a34bdc0d67f6e01262a2f8dcef9b61369dba8c334f5a80d  crypto/ec/ec2_oct.c
 6bbbf570ce31f5b579f7e03ec9f8a774663c7c1eb5e475bd31f8fee94a021ffc  crypto/ec/ec2_smpl.c
 69d64accd498583e65df2dc43730eee2922217a7bfefda2cd1a9da176e3d1dcd  crypto/ec/ec_asn1.c
-4ec7fe2efa0e55316ac4bb8507c7a37360339070c406c2623c38c5a541ac65d6  crypto/ec/ec_backend.c
+c07fa05c6885e59913e2ce345ff52ef9dfb0418842de3affa6163ad3e71f9c1b  crypto/ec/ec_backend.c
 86e2becf9b3870979e2abefa1bd318e1a31820d275e2b50e03b17fc287abb20a  crypto/ec/ec_check.c
 265f911b9d4aada326a2d52cd8a589b556935c8b641598dcd36c6f85d29ce655  crypto/ec/ec_curve.c
 8cfd0dcfb5acbf6105691a2d5e2826dba1ff3906707bc9dd6ff9bffcc306468f  crypto/ec/ec_cvt.c
-d0166f55170de91e37fd2848ff617b43fb429fc87c28c7879a2bc7c784ce921f  crypto/ec/ec_key.c
-7b34605e017eb81037344538f917c32d3ab85c744a819617e012bab73c27dd68  crypto/ec/ec_kmeth.c
+28726bc957ea821639b1023e5bff0e77ced61bae31f96c165e33aadfe0bc5c9a  crypto/ec/ec_key.c
+7e40fc646863e0675bbb90f075b809f61bdf0600d8095c8366858d9533ab7700  crypto/ec/ec_kmeth.c
 2db28a620fa62889c816dca25bb1153c99af2e8604beb3b1655495da96f2c965  crypto/ec/ec_lib.c
 a8a4690e42b4af60aad822aa8b16196df337906af53ea4db926707f7b596ff27  crypto/ec/ec_local.h
 fa901b996eb0e460359cd470843bdb03af7a77a2f1136c5e1d30daef70f3e4d2  crypto/ec/ec_mult.c
@@ -186,27 +186,27 @@ b4b7c683279454ba41438f50a015cb63ef056ccb9be0168918dfbae00313dc68  crypto/ec/ecp_
 22c44f561ab42d1bd7fd3a3c538ebaba375a704f98056b035e7949d73963c580  crypto/ec/ecx_key.c
 6618159105f23d5b2aa03d806d66f9c7a0b97298fe1e8ec7d503b066d627b31d  crypto/evp/asymcipher.c
 0e75a058dcbbb62cfe39fec6c4a85385dc1a8fce794e4278ce6cebb29763b82b  crypto/evp/dh_support.c
-c877405c475e7df094f3f09a3e632c8cb98b7939a96bc18fc2fec06abd2f3051  crypto/evp/digest.c
+847e039a249a1f9af42dfc6427de2ad4925f1116f86619dd420cf8cec9d3bbfe  crypto/evp/digest.c
 5e2c5d865029ae86855f15e162360d091f28ca0d4c67260700c90aa25faf308b  crypto/evp/ec_support.c
-323ea0f84844e7bac88079954c07c0af826c078605422ae41b6247d9bbfea5fb  crypto/evp/evp_enc.c
+bd8cdd250f64cc314133a1c3cdef8eba3de5a40f1a9ef1d26729c5361690a368  crypto/evp/evp_enc.c
 b6f77874575329b66f98359e52505d6f30f8ea1c2f20aacff54a9ef89fb3eece  crypto/evp/evp_fetch.c
-1fd35db4c01159b8b86434f896c1484c7a013ba5af5f7798d05193e383f7b01d  crypto/evp/evp_lib.c
+3998f2fa31d2e5de0051c28046dbd87f8ae9a3a23a73b7aee77618df382896b5  crypto/evp/evp_lib.c
 34574e474d3f5daf24981200cae9e24a427d165cd43d8fb738844fa9b0fc991f  crypto/evp/evp_local.h
-0da611ac7202866afee2f66797e8d9b80c08c4614b82a6a1f6d83931eef3e17c  crypto/evp/evp_rand.c
+e822c16fc4dc30f2c86e8598c721a9ddfe46d318ce78f4e8e883cdcf8b936221  crypto/evp/evp_rand.c
 2a128617ec0178e9eeacbe41d75a5530755f41ea524cd124607543cf73456a0c  crypto/evp/evp_utils.c
 befe4e1ec273973748a9fff49d8510873737ea04d86eac70c2e11bbb0d874ca1  crypto/evp/exchange.c
-6bcf946bc6aeb6a8350b17ab16759a9db03cfc025637a296de2999ca254a6317  crypto/evp/kdf_lib.c
+a3164e3247e2a38f4f9a20db463779b5260e4e6639ac8eec6e960b265fc8cce5  crypto/evp/kdf_lib.c
 1d72f5506984df1df8606e8c7045f041cf517223e2e1b50c4da8ba8bf1c6c186  crypto/evp/kdf_meth.c
 f88b3d178f0d5e7bcd250fd2b3d2fabb19f05f3ecc0627c100c5418e9fdd0ade  crypto/evp/kem.c
-8abe5c279753ab6ee8ad9672429b60c6db9f430741ca2b167998950e5efec468  crypto/evp/keymgmt_lib.c
-37c9b9f51863b01c9cd373360e110e53e77d410d70971be0fab8b75314fdd610  crypto/evp/keymgmt_meth.c
-39bce1fb6dab7892da1665276ce45645ded5f0206e29c2ce209d51a2b9f4a54d  crypto/evp/m_sigver.c
+df82657d18fb15d4da3218e33e7326248db509443304889b1dbee5810cbcb78b  crypto/evp/keymgmt_lib.c
+7b850a8f7e7c5018546541254cd33da479834c47273b5018fdcb8a9ccf77f522  crypto/evp/keymgmt_meth.c
+e1a052839b8b70dca20dbac1282d61abd1c415bf4fb6afb56b811e8770d8a2e1  crypto/evp/m_sigver.c
 f9988dfed6253c30b08a966496f188763671cb72a2fcb25455f65f8d270027cc  crypto/evp/mac_lib.c
 e7e8eb5683cd3fbd409df888020dc353b65ac291361829cc4131d5bc86c9fcb3  crypto/evp/mac_meth.c
-5baffd0e611a0cc84a39dacc2c12d72ce6d8b4c889e7c7d0c5564c7789c08a5f  crypto/evp/p_lib.c
-b7e9ce6e8a35e0fc5b4eb4c047cda1e811b757669dbfafa71e743d85e07817a4  crypto/evp/pmeth_check.c
-9d68dcfd474720779a236d760cb070fc56422b502e0bbdabe8721139cbd70cc6  crypto/evp/pmeth_gn.c
-00367193c23aeadb3a7f250f5cef17dcdc1413510be67e80eeea54020d803406  crypto/evp/pmeth_lib.c
+0b3714cb5ff9deb5e17081b8dc12922910de9b8693e644dd2ac67a53fe25c7ff  crypto/evp/p_lib.c
+c7323b477b512701e27b28c2e328068593755e2b7ad537e8c21406c4e7bef789  crypto/evp/pmeth_check.c
+bbce11755bcc5ba2ee8e9c1eb95905447136f614fdc2b0f74cf785fe81ead6a5  crypto/evp/pmeth_gn.c
+c95daaba3fe5389509d7c2c3d4b76c63a7183c14c52e5623be820931dfce39a8  crypto/evp/pmeth_lib.c
 c2158cf4f1d149889746665501035f38049dc1cdcea8c61cd377c0c3be6b8a43  crypto/evp/signature.c
 b06cb8fd4bd95aae1f66e1e145269c82169257f1a60ef0f78f80a3d4c5131fac  crypto/ex_data.c
 00ca3b72cd56308aabb2826b6a400c675526afa7efca052d39c74b2ac6d137d8  crypto/ffc/ffc_backend.c
@@ -239,7 +239,7 @@ a4e9f2e496bd9362b17a1b5989aa4682647cefcff6117f0607122a9e11a9dfd9  crypto/modes/a
 1611e73dc1e01b5c2201f51756a7405b7673aa0bb872e2957d1ec80c3530486f  crypto/modes/ccm128.c
 d8c2f256532a4b94db6d03aea5cb609cccc938069f644b2fc77c5015648d148d  crypto/modes/cfb128.c
 af1c034152d82b29cb7c938c8516cfd136b62bac0908c1d40eb50790d23b288c  crypto/modes/ctr128.c
-9168100d4a8ce4aecc757efefea4e68e1fe8d3469a1238681884f7eb9cc59b89  crypto/modes/gcm128.c
+6b96ab27237cb01a6a7e031abd71b5f14c08cfa13ad4c8e8f9f29cbe31f70a5b  crypto/modes/gcm128.c
 bdf25257b15eca206be4d950d2dd807ca5f058f91f54edbd7a0d312ed83eef8e  crypto/modes/ofb128.c
 e55a816c356b2d526bc6e40c8b81afa02576e4d44c7d7b6bbe444fb8b01aad41  crypto/modes/wrap128.c
 608a04f387be2a509b4d4ad414b7015ab833e56b85020e692e193160f36883a2  crypto/modes/xts128.c
@@ -261,11 +261,11 @@ d0af10d4091b2032aac1b7db80f8c2e14fa7176592716b25b9437ab6b53c0a89  crypto/provide
 5ba2e1c74ddcd0453d02e32612299d1eef18eff8493a7606c15d0dc3738ad1d9  crypto/provider_predefined.c
 5d16318d3a36b06145af74afa3523109768990a33457c81895c7ab8a830654f8  crypto/rand/rand_lib.c
 fd03b9bb2c23470fa40880ed3bf9847bb17d50592101a78c0ad7a0f121209788  crypto/rand/rand_local.h
-a6841319cb6e9970a3c3f8adb619086310e4b56d1f52448ef2e2caaeface4146  crypto/rsa/rsa_backend.c
+8b93871f1f0392704d29028b8c93281be62cf02d0f79f9831bdabcd7a378df5b  crypto/rsa/rsa_backend.c
 38a102cd1da1f6ca5a46e6a22f018237964336274385f5c70cbedcaa6997647e  crypto/rsa/rsa_chk.c
 e32cfa04221a2a3ea33f7bcb93ee51b84cbeba97e94c1fbf6e420b24f97fc9ce  crypto/rsa/rsa_crpt.c
 21794dcb6bfebcf9a14d4f8aa7fab8f745b595433b388b55f46ba6e615d90f98  crypto/rsa/rsa_gen.c
-20d8e6f066c1c3de599e4e1f3295418e28dde05fe7e664d1cb20f88e204eed06  crypto/rsa/rsa_lib.c
+74ed75d1d8e0844800504a137bfd81c3dbcb6c4bd58b5d5fe9d0a362092b6e88  crypto/rsa/rsa_lib.c
 a65e85be5269d8cb88e86b3413c978fa8994419a671092cbf104ff1a08fda23b  crypto/rsa/rsa_local.h
 cf0b75cd54b61b9b9a290ef18d0ddce9fb26a029a54eb3f720d9b25188440f00  crypto/rsa/rsa_mp_names.c
 5c60f6e05db82e13178d805deb1947b8eee4a905e6e77523d3b288da70a46bb5  crypto/rsa/rsa_none.c
@@ -274,7 +274,7 @@ a2fd2e4e31ec53d01a575ccaf03bad5a270412ff66804cf0b5fa40492b89181d  crypto/rsa/rsa
 be3f39c1fcb777d6c0122061f9ef735d10a6bee95d67fcc1ca6ae2a664022d2b  crypto/rsa/rsa_pk1.c
 174a42e156be48927fe6d6bf0d95575619b8e643a99761275bff933bc3449722  crypto/rsa/rsa_pss.c
 bf6d300b7e7e9e512a47c5bd1f8713806ae3033a140d83dfae4a16ad58d11170  crypto/rsa/rsa_schemes.c
-3f269305314a812a343d74c182bff0a747e465c686af31ccc82f9adfa8616836  crypto/rsa/rsa_sign.c
+f01af62704dbf9457e2669c3e7c1d4d740f0388faa49df93611b987a8aa2bf11  crypto/rsa/rsa_sign.c
 740c022caff3b2487c5838b581cdddcc7de2ceabb504aad72dc0dd70a67bf7cf  crypto/rsa/rsa_sp800_56b_check.c
 20e54cf2a8fd23ced0962c5f358cedd8ec0c398a87d33b34f1a4326d11e4892e  crypto/rsa/rsa_sp800_56b_gen.c
 1c1c2aeeb18bf1d69e8f134315b7e50d8f43d30eb1aa5bf42983eec9136a2fdc  crypto/rsa/rsa_x931.c
@@ -336,7 +336,6 @@ a41ae93a755e2ec89b3cb5b4932e2b508fdda92ace2e025a2650a6da0e9e972c  crypto/threads
 fd6c27cf7c6b5449b17f2b725f4203c4c10207f1973db09fd41571efe5de08fd  crypto/x86_64cpuid.pl
 d13560a5f8a66d7b956d54cd6bf24eade529d686992d243bfb312376a57b475e  e_os.h
 811d6a848c55328dfa97761aba74c785f971a874e14bf5efda5431893fde3bf0  include/crypto/aes_platform.h
-314b950cc99c28d22ea310f6bbb4d746cefc2a90071de1563917264d6d06ca6f  include/crypto/asn1.h
 8c6f308c1ca774e6127e325c3b80511dbcdc99631f032694d8db53a5c02364ee  include/crypto/asn1_dsa.h
 8ce1b35c6924555ef316c7c51d6c27656869e6da7f513f45b7a7051579e3e54d  include/crypto/bn.h
 1c46818354d42bd1b1c4e5fdae9e019814936e775fd8c918ca49959c2a6416df  include/crypto/bn_conf.h.in
@@ -344,22 +343,21 @@ d13560a5f8a66d7b956d54cd6bf24eade529d686992d243bfb312376a57b475e  e_os.h
 e69b2b20fb415e24b970941c84a62b752b5d0175bc68126e467f7cc970495504  include/crypto/cryptlib.h
 5ee1ea30382bef9869f29b6610665ca304f3b9cf3653746a2d02c64b1a24f103  include/crypto/ctype.h
 3036fb7a2e1f32e3e53e2bd1cf24acbf18705d75f9ce9de6d2945a6e7c3fb4e0  include/crypto/des_platform.h
-c7bef6ee3e29950650275470be540d182e1c6b9ccb30b45d97b3ad2911d14fca  include/crypto/dh.h
-c6d99cc3f9ce38c44220576835e18fbce854769c06bb4a8eaa47167e67e7b244  include/crypto/dsa.h
-e6c51d2758229195585e8164deae782d9b5d4f6992571ff70b41b3ee2c9f5c5d  include/crypto/ec.h
-33a436599b6ac6b30fce96f312054a2453b582c5a897b6d66cfcf0d83955c3fd  include/crypto/ecx.h
-1c44d15f1331be058b35dab92380f3f74c4f399eba7af3ed5402abba406acaf5  include/crypto/evp.h
+830da1513661794e979f7cca2bba1792224e3b3d20d4f10f6f5c6566d9b7e723  include/crypto/dh.h
+7ddd70f02371c7bd190414369d2bbe7c9c6d2de085dfe1e3eab0c4082f803ca1  include/crypto/dsa.h
+2ea47c059e84ce9d14cc31f4faf45f64d631de9e2937aa1d7a83de5571c63574  include/crypto/ec.h
+edbfae8720502a4708983b60eac72aa04f031059f197ada31627cb5e72812858  include/crypto/ecx.h
+c7bb494047191ae3990793e53348b8f8353aa54805443a8b78303cd66f384c61  include/crypto/evp.h
 bbe5e52d84e65449a13e42cd2d6adce59b8ed6e73d6950917aa77dc1f3f5dff6  include/crypto/lhash.h
 162812058c69f65a824906193057cd3edeabc22f51a4220aea7cb9064379a9b6  include/crypto/md32_common.h
 f12bfc145290444bcc7bf408874bded348e742443c145b8b5bc70ae558d96c31  include/crypto/modes.h
 763ec96091c828c16278873eb32665bfc70624dbd3809cb8043d19dc16e84d22  include/crypto/rand.h
 90930fc8788d6e04e57829346e0405293ac7a678c3cef23d0692c742e9586d09  include/crypto/rand_pool.h
-bb6676c9975fff5c4e8f7c2ff9fd5a1a9c784a0f3c1d1bf1d711c23d55e1da70  include/crypto/rsa.h
+bd5ce686c97a8a3a0e3d7ca1e4f16706fd51df5da9673169303a4428d62da233  include/crypto/rsa.h
 32f0149ab1d82fddbdfbbc44e3078b4a4cc6936d35187e0f8d02cc0bc19f2401  include/crypto/security_bits.h
 0f743762f646656b5480648c05632575fe8acc7506460c63e0fcdf42cf20c08a  include/crypto/sha.h
 7676b02824b2d68df6bddeb251e9b8a8fa2e35a95dad9a7ebeca53f9ab8d2dad  include/crypto/sparse_array.h
 5bfeea62d21b7cb43d9a819c5cd2800f02ea019687a8331abf313d615889ad37  include/crypto/types.h
-b0e2073dcf0e4f80f221f98d980f1d63c3effc6825c64c9a7b1038444eb70b49  include/crypto/x509.h
 a1778b610a244f49317a09e1e6c78b5fb68bc6d003ffdea0f6eefe5733ee5b5f  include/internal/bio.h
 92aacb3e49288f91b44f97e41933e88fe455706e1dd21a365683c2ab545db131  include/internal/constant_time.h
 28195bbbe81d831792f07485287fd3ac400e03f1f1733a19e3f7115c0f1828f6  include/internal/core.h
@@ -417,41 +415,28 @@ bc9ec2be442a4f49980ba2c63c8f0da701de1f6e23d7db35d781658f833dd7b9  include/openss
 cbbf74efc7fdb020f06840c856ad7fe97553944f4cc3c197fbb004de38158048  include/openssl/ecerr.h
 61c76ee3f12ed0e42503a56421ca00f1cb9a0f4caa5f9c4421c374bcd45917d7  include/openssl/encoder.h
 69dd983f45b8ccd551f084796519446552963a18c52b70470d978b597c81b2dc  include/openssl/encodererr.h
-171a780183dd91350d2f7abed7ded9ce80dfdec8afaab5adcd843514bdbc7a43  include/openssl/engine.h
-fb510978001ebea15eee4c4c6cbeebb126a66e11117e6f6d9b9fb4be5057b92c  include/openssl/engineerr.h
 0b8f934c1a2f9cff5f37a2ac52f79483d005d48ce85de1a0a8d7825fbc94a0c9  include/openssl/err.h.in
 f82bb2f5aa1c50e9842f9cb6a8e8acd880a579aa608aeecd193b114bc7563ab3  include/openssl/evp.h
 5bd1b5dcd14067a1fe490d49df911002793c0b4f0bd4492cd8f71cfed7bf9f2a  include/openssl/evperr.h
 5381d96fe867a4ee0ebc09b9e3a262a0d7a27edc5f91dccfb010c7d713cd0820  include/openssl/fips_names.h
 b1d41beba560a41383f899a361b786e04f889106fb5960ec831b0af7996c9783  include/openssl/fipskey.h.in
 47a088c98ad536ea99f2c6a9333e372507cb61b9bdffb930c586ed52f8f261eb  include/openssl/hmac.h
-d454024c7bd34dda6cbeffad51fd0d39740b19b41d59b1740447c34da9241588  include/openssl/http.h
 faab8accc9520269dd874126ae164a43526d5784e6280521c7ab3772c02b0a0c  include/openssl/kdf.h
 c6db6926e90c9efd530a7bdb018be8c62f2c2b3c2f7b90228e9f73b8437dd785  include/openssl/lhash.h.in
 fd5c049ac6c3498750fa8f8dcbf88b2a31c02fa62dfe43a33d7b490fb86f61c8  include/openssl/macros.h
-4ec92db58402e93d967bf7f69616e7d9b169aa337bfeb266b5f748ca6c9fb639  include/openssl/md4.h
-6e73e6ead21c841f2af694a4363680afb58b20fc51dd457964c2040b4d8b8816  include/openssl/md5.h
-bb1f2272e984100231add6a62a9a01126eecb447a2293b103b4a7f6bcd714789  include/openssl/mdc2.h
 9184207c562fd1fa7bd3a4f1fadcb984130561279818f0cdfcf3e9c55be8a7d1  include/openssl/modes.h
 7c71200e35f4cc1b4011a4bc14e521e4dc037b9b2d640a74bc30ef334b813de3  include/openssl/obj_mac.h
 157797b450215f973eb10be96a04e58048ab9c131ad29427e80d0e37e230ed98  include/openssl/objects.h
 d25537af264684dff033dd8ae62b0348f868fcfec4aa51fa8f07bcfa4bd807ad  include/openssl/objectserr.h
-b668680d98db6a6c8aebc747b7602cf52179614c684144d38c34c47c9131af40  include/openssl/ocsp.h.in
-d77660e0b2d89c4a2359a81c4a04066719420eb4295d8acf679501cd13bf0b1d  include/openssl/ocsperr.h
 fe6acd42c3e90db31aaafc2236a7d30ebfa53c4c07ea4d8265064c7fcb951970  include/openssl/opensslconf.h
 1bf52d136e94f727a96651c1f48ad040482f35dae152519ccd585efd410b92f0  include/openssl/opensslv.h.in
 767d9d7d5051c937a3ce8a268c702902fda93eeaa210a94dfde1f45c23277d20  include/openssl/param_build.h
 30085f4d1b4934bb25ffe7aa9a30859966318a1b4d4dcea937c426e90e6e1984  include/openssl/params.h
-180a49cae0dfdf7975466f922b1950a998736924926d7588b5592ba903813349  include/openssl/pem.h
-fb453de1abc5ec8410586593921a66757441ecbfc4273349ddc6257c503a2000  include/openssl/pemerr.h
-74305b1bd8575cd0ef6c86eb1edd89a9a144b84d39d7f6740b7ce8cdad6f9d9c  include/openssl/pkcs7.h.in
-8394828da6fd7a794777320c955d27069bfef694356c25c62b7a9eb47cd55832  include/openssl/pkcs7err.h
 097615b849375e2903967521f76c570512e5be47b8159fdbcd31e433f8a4cca7  include/openssl/prov_ssl.h
 90fb37a1a564b989afca658dae8c78b0ba72ac1f4d1ffc0c52eb93e74e144603  include/openssl/proverr.h
 b97e8ad49b38683817387596aefec0abd5f4d572643beef48be4f7acba26768d  include/openssl/provider.h
 7c9b5f479d9b22cfc8db0976dddfc2a1ee6e757b436e01a2b4d2744bcb6d81a5  include/openssl/rand.h
 e3545298f0cdf598a3419416ce20acd0119c0e88557a13d52c5b1a0117ee643e  include/openssl/randerr.h
-44246a82a6515c932a6ba834fbab8ee2a82b91db977367e8de07a8f529d2f045  include/openssl/ripemd.h
 c1015b77c444a3816d2ea7ad770f1c3b79a1e54887930af6dd662895701f3323  include/openssl/rsa.h
 2f339ba2f22b8faa406692289a6e51fdbbb04b03f85cf3ca849835e58211ad23  include/openssl/rsaerr.h
 6586f2187991731835353de0ffad0b6b57609b495e53d0f32644491ece629eb2  include/openssl/safestack.h.in
@@ -459,15 +444,8 @@ c7da25794eb70f0cbc2457f4cb87e8d04dc3512b509034ff1db7285961952963  include/openss
 2964274ab32b1ba8578a06b06663db2eda4317ae806369271d889176bb5a7d04  include/openssl/sha.h
 c169a015d7be52b7b99dd41c418a48d97e52ad21687c39c512a83a7c3f3ddb70  include/openssl/stack.h
 22d7584ad609e30e818b54dca1dfae8dea38913fffedd25cd540c550372fb9a6  include/openssl/symhacks.h
-12026c3aa4b14d9083999a7e5098bd4273a4f2004ff1d397d65710b3d4bc6e2b  include/openssl/trace.h
+97e10e7745f2589f3a19704b4f78d28d7118fbb353b33bd30325606cf15bdc89  include/openssl/trace.h
 873d2ec2054ec24c52df4abe830cb2b9666fe4e75cc62b4de0f50ef9d20c5812  include/openssl/types.h
-f37b0da67078c8c220c442499e02f92dfe240f6d77ec942f2a562a18f338284a  include/openssl/ui.h.in
-558433ae747ebf3d9a71d583b7a7ee8c5476f3bef38d97a1f88bdcace4c2f311  include/openssl/uierr.h
-509c97837d73abeac39b0e06a24a4ff5a83520f8df49d5af56ed3ed76ec4290f  include/openssl/x509.h.in
-37aa2d54d71575690e29055e2a453f1200a6023885ef787b6a50a34ba5f5c2b5  include/openssl/x509_vfy.h.in
-9e6409eddfa13a469c1da6c5b562825381da2eb4da3c08546aa1182a4ec54726  include/openssl/x509err.h
-8ddb7bd65c766317f6f20ff615e4d0ddc99bc4ee0d6ec149e3834b8d4fe11a05  include/openssl/x509v3.h.in
-f78e901b2260416773c6d7933de8771a03bbb2cc3073809f3c1715d4276789ff  include/openssl/x509v3err.h
 c0a9551efccf43f3dd748d4fd8ec897ddaabbc629c00ec1ad76ce983e1195a13  providers/common/bio_prov.c
 e7c39ef7b76668dae1470ce0edd7254da2937569762cebbf20e08fb97cb3324c  providers/common/capabilities.c
 f94b7435d4ec888ec30df1c611afa8b9eedbb59e905a2c7cb17cfc8c4b9b85b8  providers/common/der/der_digests_gen.c.in
@@ -493,7 +471,7 @@ ce605f32413b09d33ce5795de9498a08183895c3347f33344f9ae5d31c29ccac  providers/comm
 6c1fa3f229c6f049c3ac152c4c265f3eb056d94221b82df95a15400649690e93  providers/common/include/prov/der_wrap.h.in
 76087f04f4de6414c240f88807659fb2a04af914108f0c5f2515a4cb5482f655  providers/common/include/prov/proverr.h
 83a57505d88a6a9cc4f7781c9f7f4af07668e7923502dfd6c5960bb492c1d24e  providers/common/include/prov/provider_ctx.h
-7c4ea8ab097690f28755814192e6ddd78d023151edc83dc3d1e2feb3fbcba533  providers/common/include/prov/provider_util.h
+03fcfea9ed6e23d1df7ffd230af15f0f9b91a6aa635f77b9cbe52d5112168d09  providers/common/include/prov/provider_util.h
 e1ef8b2be828a54312d6561b37751a5b6e9d5ebdb6c3e63589728c3d8adca7dc  providers/common/include/prov/providercommon.h
 73d0e15963759fcb7c5c434bb214b50bc32f6066e90ac07fb53dad11c2fd1939  providers/common/include/prov/securitycheck.h
 737cc1228106e555e9bab24e3c2438982e04e05b0d5b9ee6995d71df16c49143  providers/common/provider_ctx.c
@@ -583,9 +561,9 @@ a388e52f059331a8636c6b73fc7cc03c8d51a585f2a8ae1a5e21bd967db9f9f5  providers/impl
 053a2be39a87f50b877ebdbbf799cf5faf8b2de33b04311d819d212ee1ea329b  providers/implementations/keymgmt/kdf_legacy_kmgmt.c
 bcb51fe05014ade575494b44c55b1a0b3dc404e31ff7acee40bb2f63a8f6712f  providers/implementations/keymgmt/mac_legacy_kmgmt.c
 464d6f9236351e7dc3b991f5bba142c7aabcf2db3c236367332a9dd0308ddfac  providers/implementations/keymgmt/rsa_kmgmt.c
-e25c8bfd205b0842ba8e7a0cbcf9f86b78c7d4d093655b8d45b23b8653d7358d  providers/implementations/macs/cmac_prov.c
-c774e2791484ea9a1ffed69958f9d05c139bbf53603a9621ae76c6e89c36e5b1  providers/implementations/macs/gmac_prov.c
-4d1d73b64f9fd1473a4b70c92fae2ad87aa30b6ec6d946d408deb251c0ef70c1  providers/implementations/macs/hmac_prov.c
+79da66d4b696388d7eab6b2126bccc88908915813d79c4305b8b4d545a500469  providers/implementations/macs/cmac_prov.c
+41464d1e640434bb3ff9998f093829d5e2c1963d68033dca7d31e5ab75365fb1  providers/implementations/macs/gmac_prov.c
+282c1065f18c87073529ed1bdc2c0b3a1967701728084de6632ddc72c671d209  providers/implementations/macs/hmac_prov.c
 aa7ba1d39ea4e3347294eb50b4dfcb895ef1a22bd6117d3b076a74e9ff11c242  providers/implementations/macs/kmac_prov.c
 bf30274dd6b528ae913984775bd8f29c6c48c0ef06d464d0f738217727b7aa5c  providers/implementations/rands/crngt.c
 f6c4b38dd1c22d562ef8b172218b688070336dc43550f40af01bb2e77eb3ea4d  providers/implementations/rands/drbg.c
@@ -600,4 +578,4 @@ f9eac5acc880756ab17c9e00b7707fa6bf882026cbca21ce67aadcf560352120  providers/impl
 762b49aa68fa7cd15c0496c35a23acb85df9588c8bb4ecb54438f86cc06ce13d  providers/implementations/signature/mac_legacy_sig.c
 ac8f4452ea236ef877d13bc787f53f117722025c9c74874c6d2cc541382a8953  providers/implementations/signature/rsa_sig.c
 737b9afe8f03f58797034ae906f982179677f5a9cf42965468f7126cf15e6694  ssl/record/tls_pad.c
-accefe92a493af8334bc3b5d4d2845eaa0278816c028c91d2b85bce8ead7f9fd  ssl/s3_cbc.c
+3f2e01a98d9e3fda6cc5cb4b44dd43f6cae4ec34994e8f734d11b1e643e58636  ssl/s3_cbc.c
diff --git a/providers/fips.checksum b/providers/fips.checksum
index 191d14b3e3..09e13bd14b 100644
--- a/providers/fips.checksum
+++ b/providers/fips.checksum
@@ -1 +1 @@
-b9b5778d372dcad1d32aa23b2f5920b42af8f41a70e349410c4ccb57e5ccb8b0  providers/fips-sources.checksums
+ac2360dcca0e5aac97a9275615ca82111479511fdd51b607a02e7fd52fa7ee7e  providers/fips-sources.checksums
diff --git a/providers/fips.module.sources b/providers/fips.module.sources
index 058db4a3c3..53c1fb947a 100644
--- a/providers/fips.module.sources
+++ b/providers/fips.module.sources
@@ -336,7 +336,6 @@ crypto/threads_win.c
 crypto/x86_64cpuid.pl
 e_os.h
 include/crypto/aes_platform.h
-include/crypto/asn1.h
 include/crypto/asn1_dsa.h
 include/crypto/bn.h
 include/crypto/bn_conf.h.in
@@ -359,7 +358,6 @@ include/crypto/security_bits.h
 include/crypto/sha.h
 include/crypto/sparse_array.h
 include/crypto/types.h
-include/crypto/x509.h
 include/internal/bio.h
 include/internal/constant_time.h
 include/internal/core.h
@@ -417,41 +415,28 @@ include/openssl/ec.h
 include/openssl/ecerr.h
 include/openssl/encoder.h
 include/openssl/encodererr.h
-include/openssl/engine.h
-include/openssl/engineerr.h
 include/openssl/err.h.in
 include/openssl/evp.h
 include/openssl/evperr.h
 include/openssl/fips_names.h
 include/openssl/fipskey.h.in
 include/openssl/hmac.h
-include/openssl/http.h
 include/openssl/kdf.h
 include/openssl/lhash.h.in
 include/openssl/macros.h
-include/openssl/md4.h
-include/openssl/md5.h
-include/openssl/mdc2.h
 include/openssl/modes.h
 include/openssl/obj_mac.h
 include/openssl/objects.h
 include/openssl/objectserr.h
-include/openssl/ocsp.h.in
-include/openssl/ocsperr.h
 include/openssl/opensslconf.h
 include/openssl/opensslv.h.in
 include/openssl/param_build.h
 include/openssl/params.h
-include/openssl/pem.h
-include/openssl/pemerr.h
-include/openssl/pkcs7.h.in
-include/openssl/pkcs7err.h
 include/openssl/prov_ssl.h
 include/openssl/proverr.h
 include/openssl/provider.h
 include/openssl/rand.h
 include/openssl/randerr.h
-include/openssl/ripemd.h
 include/openssl/rsa.h
 include/openssl/rsaerr.h
 include/openssl/safestack.h.in
@@ -461,13 +446,6 @@ include/openssl/stack.h
 include/openssl/symhacks.h
 include/openssl/trace.h
 include/openssl/types.h
-include/openssl/ui.h.in
-include/openssl/uierr.h
-include/openssl/x509.h.in
-include/openssl/x509_vfy.h.in
-include/openssl/x509err.h
-include/openssl/x509v3.h.in
-include/openssl/x509v3err.h
 providers/common/bio_prov.c
 providers/common/capabilities.c
 providers/common/der/der_digests_gen.c.in
diff --git a/providers/implementations/keymgmt/mac_legacy_kmgmt.c b/providers/implementations/keymgmt/mac_legacy_kmgmt.c
index e1e2609dfa..63553996bd 100644
--- a/providers/implementations/keymgmt/mac_legacy_kmgmt.c
+++ b/providers/implementations/keymgmt/mac_legacy_kmgmt.c
@@ -18,6 +18,9 @@
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/proverr.h&gt;
 #include &lt;openssl/param_build.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/engine.h&gt;
+#endif
 #include &quot;internal/param_build_set.h&quot;
 #include &quot;prov/implementations.h&quot;
 #include &quot;prov/providercommon.h&quot;
diff --git a/providers/implementations/macs/cmac_prov.c b/providers/implementations/macs/cmac_prov.c
index 2291276035..b44f13b5fa 100644
--- a/providers/implementations/macs/cmac_prov.c
+++ b/providers/implementations/macs/cmac_prov.c
@@ -16,7 +16,6 @@
 #include &lt;openssl/core_dispatch.h&gt;
 #include &lt;openssl/core_names.h&gt;
 #include &lt;openssl/params.h&gt;
-#include &lt;openssl/engine.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/cmac.h&gt;
 
@@ -111,7 +110,7 @@ static int cmac_setkey(struct cmac_data_st *macctx,
                        ossl_prov_cipher_cipher(&amp;macctx-&gt;cipher),
                        ossl_prov_cipher_engine(&amp;macctx-&gt;cipher));
     ossl_prov_cipher_reset(&amp;macctx-&gt;cipher);
-    return rv;    
+    return rv;
 }
 
 static int cmac_init(void *vmacctx, const unsigned char *key,
diff --git a/providers/implementations/macs/gmac_prov.c b/providers/implementations/macs/gmac_prov.c
index 29fb9f87df..89904fc89d 100644
--- a/providers/implementations/macs/gmac_prov.c
+++ b/providers/implementations/macs/gmac_prov.c
@@ -11,7 +11,6 @@
 #include &lt;openssl/core_dispatch.h&gt;
 #include &lt;openssl/core_names.h&gt;
 #include &lt;openssl/params.h&gt;
-#include &lt;openssl/engine.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/err.h&gt;
 #include &lt;openssl/proverr.h&gt;
diff --git a/providers/implementations/macs/hmac_prov.c b/providers/implementations/macs/hmac_prov.c
index 3a0679ce8f..78c4924a38 100644
--- a/providers/implementations/macs/hmac_prov.c
+++ b/providers/implementations/macs/hmac_prov.c
@@ -18,7 +18,6 @@
 #include &lt;openssl/core_dispatch.h&gt;
 #include &lt;openssl/core_names.h&gt;
 #include &lt;openssl/params.h&gt;
-#include &lt;openssl/engine.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/hmac.h&gt;
 
diff --git a/providers/implementations/signature/mac_legacy_sig.c b/providers/implementations/signature/mac_legacy_sig.c
index d9fd105289..06f79505ff 100644
--- a/providers/implementations/signature/mac_legacy_sig.c
+++ b/providers/implementations/signature/mac_legacy_sig.c
@@ -16,6 +16,9 @@
 #include &lt;openssl/core_names.h&gt;
 #include &lt;openssl/params.h&gt;
 #include &lt;openssl/err.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/engine.h&gt;
+#endif
 #include &quot;prov/implementations.h&quot;
 #include &quot;prov/provider_ctx.h&quot;
 #include &quot;prov/macsignature.h&quot;
diff --git a/ssl/s3_cbc.c b/ssl/s3_cbc.c
index b0e3496ba2..85f296b807 100644
--- a/ssl/s3_cbc.c
+++ b/ssl/s3_cbc.c
@@ -27,7 +27,9 @@
 #include &quot;internal/cryptlib.h&quot;
 
 #include &lt;openssl/evp.h&gt;
-#include &lt;openssl/md5.h&gt;
+#ifndef FIPS_MODULE
+# include &lt;openssl/md5.h&gt;
+#endif
 #include &lt;openssl/sha.h&gt;
 
 char ssl3_cbc_record_digest_supported(const EVP_MD_CTX *ctx);
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034865.html">[openssl]  master update
</A></li>
	<LI>Next message: <A HREF="034868.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34867">[ date ]</a>
              <a href="thread.html#34867">[ thread ]</a>
              <a href="subject.html#34867">[ subject ]</a>
              <a href="author.html#34867">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
