<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  OpenSSL_1_0_2-stable update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2018-April/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20OpenSSL_1_0_2-stable%20update&In-Reply-To=%3C1524801618.112386.28113.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019170.html">
   <LINK REL="Next"  HREF="019181.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  OpenSSL_1_0_2-stable update</H1>
    <B>Richard Levitte</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20OpenSSL_1_0_2-stable%20update&In-Reply-To=%3C1524801618.112386.28113.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  OpenSSL_1_0_2-stable update">levitte at openssl.org
       </A><BR>
    <I>Fri Apr 27 04:00:18 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="019170.html">[openssl-commits] [openssl]  OpenSSL_1_0_2-stable update
</A></li>
        <LI>Next message: <A HREF="019181.html">[openssl-commits] [openssl]  OpenSSL_1_0_2-stable update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19178">[ date ]</a>
              <a href="thread.html#19178">[ thread ]</a>
              <a href="subject.html#19178">[ subject ]</a>
              <a href="author.html#19178">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch OpenSSL_1_0_2-stable has been updated
       via  b10794b5309a42bd3ea30d824ce1068e5189e66f (commit)
       via  60ced074c48fa265b3eccf91a89dec374b4c7e49 (commit)
       via  76b8b6932d17414b460f72e15ba8050d609ce768 (commit)
      from  aadcf069828431819970421749da64b24b559490 (commit)


- Log -----------------------------------------------------------------
commit b10794b5309a42bd3ea30d824ce1068e5189e66f
Author: Cristian Stoica &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">cristian.stoica at nxp.com</A>&gt;
Date:   Wed Jun 29 17:45:59 2016 +0300

    s_server: fix warnings unused-but-set-variable (no-dh)
    
    This patch fixes the following two warnings when OpenSSL is built with no-dh option:
    
    s_server.c: In function 's_server_main':
    s_server.c:1105:25: warning: variable 'no_dhe' set but not used [-Wunused-but-set-variable]
         int no_tmp_rsa = 0, no_dhe = 0, no_ecdhe = 0, nocert = 0;
                             ^
    s_server.c:1101:11: warning: variable 'dhfile' set but not used [-Wunused-but-set-variable]
         char *dhfile = NULL;
               ^
    CLA: trivial
    Signed-off-by: Cristian Stoica &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">cristian.stoica at nxp.com</A>&gt;
    
    Reviewed-by: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/6087">https://github.com/openssl/openssl/pull/6087</A>)

commit 60ced074c48fa265b3eccf91a89dec374b4c7e49
Author: Cristian Stoica &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">cristian.stoica at nxp.com</A>&gt;
Date:   Wed Jun 29 18:34:33 2016 +0300

    fix warning unused-but-set-variable 'alg_k' (no-dh and no-ec)
    
    This patch fixes the following warning when OpenSSL is configured with
    no-dh and no-ec:
    
    ./Configure no-ec no-dh linux-x86_64
    
    ...
    s3_lib.c: In function 'ssl3_get_req_cert_type':
    s3_lib.c:4234:19: warning: variable 'alg_k' set but not used [-Wunused-but-set-variable]
         unsigned long alg_k;
    
    CLA: trivial
    Signed-off-by: Cristian Stoica &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">cristian.stoica at nxp.com</A>&gt;
    
    Reviewed-by: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/6087">https://github.com/openssl/openssl/pull/6087</A>)

commit 76b8b6932d17414b460f72e15ba8050d609ce768
Author: Cristian Stoica &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">cristian.stoica at nxp.com</A>&gt;
Date:   Wed Jun 29 18:30:58 2016 +0300

    fix warning unused-but-set-variable 'nostrict' (no-dh and no-ec)
    
    This patch fixes the following warning when OpenSSL is configured with
    no-dh and no-ec:
    
    ./Configure no-ec no-dh linux-x86_64
    
    ...
    s3_lib.c:4231:9: warning: variable 'nostrict' set but not used [-Wunused-but-set-variable]
         int nostrict = 1;
             ^
    
    CLA: trivial
    Signed-off-by: Cristian Stoica &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">cristian.stoica at nxp.com</A>&gt;
    
    Reviewed-by: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/6087">https://github.com/openssl/openssl/pull/6087</A>)

-----------------------------------------------------------------------

Summary of changes:
 apps/s_server.c | 21 ++++++++++++++++-----
 ssl/s3_lib.c    | 10 ++++++++++
 2 files changed, 26 insertions(+), 5 deletions(-)

diff --git a/apps/s_server.c b/apps/s_server.c
index f1ab691..9570f07 100644
--- a/apps/s_server.c
+++ b/apps/s_server.c
@@ -1087,11 +1087,14 @@ int MAIN(int argc, char *argv[])
     char *chCApath = NULL, *chCAfile = NULL;
     char *vfyCApath = NULL, *vfyCAfile = NULL;
     unsigned char *context = NULL;
+#ifndef OPENSSL_NO_DH
     char *dhfile = NULL;
+    int no_dhe = 0;
+#endif
     int badop = 0;
     int ret = 1;
     int build_chain = 0;
-    int no_tmp_rsa = 0, no_dhe = 0, no_ecdhe = 0, nocert = 0;
+    int no_tmp_rsa = 0, no_ecdhe = 0, nocert = 0;
     int state = 0;
     const SSL_METHOD *meth = NULL;
     int socket_type = SOCK_STREAM;
@@ -1239,11 +1242,15 @@ int MAIN(int argc, char *argv[])
             if (--argc &lt; 1)
                 goto bad;
             s_chain_file = *(++argv);
-        } else if (strcmp(*argv, &quot;-dhparam&quot;) == 0) {
+        }
+#ifndef OPENSSL_NO_DH
+        else if (strcmp(*argv, &quot;-dhparam&quot;) == 0) {
             if (--argc &lt; 1)
                 goto bad;
             dhfile = *(++argv);
-        } else if (strcmp(*argv, &quot;-dcertform&quot;) == 0) {
+        }
+#endif
+        else if (strcmp(*argv, &quot;-dcertform&quot;) == 0) {
             if (--argc &lt; 1)
                 goto bad;
             s_dcert_format = str2fmt(*(++argv));
@@ -1390,9 +1397,13 @@ int MAIN(int argc, char *argv[])
             verify_quiet = 1;
         } else if (strcmp(*argv, &quot;-no_tmp_rsa&quot;) == 0) {
             no_tmp_rsa = 1;
-        } else if (strcmp(*argv, &quot;-no_dhe&quot;) == 0) {
+        }
+#ifndef OPENSSL_NO_DH
+        else if (strcmp(*argv, &quot;-no_dhe&quot;) == 0) {
             no_dhe = 1;
-        } else if (strcmp(*argv, &quot;-no_ecdhe&quot;) == 0) {
+        }
+#endif
+        else if (strcmp(*argv, &quot;-no_ecdhe&quot;) == 0) {
             no_ecdhe = 1;
         } else if (strcmp(*argv, &quot;-no_resume_ephemeral&quot;) == 0) {
             no_resume_ephemeral = 1;
diff --git a/ssl/s3_lib.c b/ssl/s3_lib.c
index 7e27dae..633c954 100644
--- a/ssl/s3_lib.c
+++ b/ssl/s3_lib.c
@@ -4228,8 +4228,13 @@ int ssl3_get_req_cert_type(SSL *s, unsigned char *p)
 #ifndef OPENSSL_NO_ECDSA
     int have_ecdsa_sign = 0;
 #endif
+#if !defined(OPENSSL_NO_DH) || !defined(OPENSSL_NO_ECDH)
     int nostrict = 1;
+#endif
+#if !defined(OPENSSL_NO_GOST) || !defined(OPENSSL_NO_DH) || \
+    !defined(OPENSSL_NO_ECDH)
     unsigned long alg_k;
+#endif
 
     /* If we have custom certificate types set, use them */
     if (s-&gt;cert-&gt;ctypes) {
@@ -4238,8 +4243,10 @@ int ssl3_get_req_cert_type(SSL *s, unsigned char *p)
     }
     /* get configured sigalgs */
     siglen = tls12_get_psigalgs(s, 1, &amp;sig);
+#if !defined(OPENSSL_NO_DH) || !defined(OPENSSL_NO_ECDH)
     if (s-&gt;cert-&gt;cert_flags &amp; SSL_CERT_FLAGS_CHECK_TLS_STRICT)
         nostrict = 0;
+#endif
     for (i = 0; i &lt; siglen; i += 2, sig += 2) {
         switch (sig[1]) {
         case TLSEXT_signature_rsa:
@@ -4257,7 +4264,10 @@ int ssl3_get_req_cert_type(SSL *s, unsigned char *p)
         }
     }
 
+#if !defined(OPENSSL_NO_GOST) || !defined(OPENSSL_NO_DH) || \
+    !defined(OPENSSL_NO_ECDH)
     alg_k = s-&gt;s3-&gt;tmp.new_cipher-&gt;algorithm_mkey;
+#endif
 
 #ifndef OPENSSL_NO_GOST
     if (s-&gt;version &gt;= TLS1_VERSION) {
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019170.html">[openssl-commits] [openssl]  OpenSSL_1_0_2-stable update
</A></li>
	<LI>Next message: <A HREF="019181.html">[openssl-commits] [openssl]  OpenSSL_1_0_2-stable update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19178">[ date ]</a>
              <a href="thread.html#19178">[ thread ]</a>
              <a href="subject.html#19178">[ subject ]</a>
              <a href="author.html#19178">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
