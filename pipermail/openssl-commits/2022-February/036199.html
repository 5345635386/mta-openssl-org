<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2022-February/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1644177035.887579.326495.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036196.html">
   <LINK REL="Next"  HREF="036201.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl]  master update</H1>
    <B>Richard Levitte</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1644177035.887579.326495.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl]  master update">levitte at openssl.org
       </A><BR>
    <I>Sun Feb  6 19:50:35 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="036196.html">[openssl]  master update
</A></li>
        <LI>Next message (by thread): <A HREF="036201.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36199">[ date ]</a>
              <a href="thread.html#36199">[ thread ]</a>
              <a href="subject.html#36199">[ subject ]</a>
              <a href="author.html#36199">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  d5f9166bacfb3757dfd6117310ad54ab749b11f9 (commit)
      from  77f3936928068bee9d7e0c6939709ac179cb1059 (commit)


- Log -----------------------------------------------------------------
commit d5f9166bacfb3757dfd6117310ad54ab749b11f9
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Fri Feb 4 15:13:01 2022 +0100

    Move e_os.h to include/internal
    
    Including e_os.h with a path from a header file doesn't work well on
    certain exotic platform.  It simply fails to build.
    
    Since we don't seem to be able to stop ourselves, the better move is
    to move e_os.h to an include directory that's part of the inclusion
    path given to the compiler.
    
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/17641">https://github.com/openssl/openssl/pull/17641</A>)

-----------------------------------------------------------------------

Summary of changes:
 apps/include/apps.h                                  | 2 +-
 apps/s_client.c                                      | 2 +-
 crypto/asn1/ameth_lib.c                              | 2 +-
 crypto/asn1/asn1_gen.c                               | 2 +-
 crypto/bio/bio_local.h                               | 2 +-
 crypto/bio/bss_bio.c                                 | 2 +-
 crypto/cmp/cmp_client.c                              | 2 +-
 crypto/conf/conf_api.c                               | 2 +-
 crypto/conf/conf_def.c                               | 2 +-
 crypto/conf/conf_lib.c                               | 2 +-
 crypto/core_namemap.c                                | 2 +-
 crypto/cpuid.c                                       | 2 +-
 crypto/cryptlib.c                                    | 2 +-
 crypto/des/cfb_enc.c                                 | 2 +-
 crypto/dh/dh_group_params.c                          | 2 +-
 crypto/dh/dh_kdf.c                                   | 4 ++--
 crypto/dllmain.c                                     | 2 +-
 crypto/dso/dso_dlfcn.c                               | 2 +-
 crypto/dso/dso_win32.c                               | 2 +-
 crypto/ec/curve448/arch_32/f_impl32.c                | 2 +-
 crypto/ec/curve448/arch_64/f_impl64.c                | 2 +-
 crypto/ec/ec_backend.c                               | 2 +-
 crypto/ec/ec_lib.c                                   | 2 +-
 crypto/encode_decode/decoder_lib.c                   | 2 +-
 crypto/encode_decode/decoder_pkey.c                  | 2 +-
 crypto/encode_decode/encoder_lib.c                   | 2 +-
 crypto/encode_decode/encoder_pkey.c                  | 2 +-
 crypto/engine/eng_init.c                             | 2 +-
 crypto/engine/eng_lib.c                              | 2 +-
 crypto/engine/tb_asnmth.c                            | 2 +-
 crypto/err/err.c                                     | 2 +-
 crypto/evp/ctrl_params_translate.c                   | 2 +-
 crypto/evp/ec_support.c                              | 2 +-
 crypto/evp/evp_lib.c                                 | 2 +-
 crypto/evp/p_lib.c                                   | 2 +-
 crypto/ffc/ffc_dh.c                                  | 2 +-
 crypto/ffc/ffc_params.c                              | 2 +-
 crypto/getenv.c                                      | 2 +-
 crypto/http/http_client.c                            | 2 +-
 crypto/info.c                                        | 2 +-
 crypto/init.c                                        | 2 +-
 crypto/mem.c                                         | 2 +-
 crypto/mem_sec.c                                     | 2 +-
 crypto/o_dir.c                                       | 2 +-
 crypto/o_fopen.c                                     | 2 +-
 crypto/o_init.c                                      | 2 +-
 crypto/o_str.c                                       | 2 +-
 crypto/objects/o_names.c                             | 2 +-
 crypto/params_dup.c                                  | 2 +-
 crypto/property/property_parse.c                     | 2 +-
 crypto/rand/rand_deprecated.c                        | 2 +-
 crypto/rand/rand_lib.c                               | 2 +-
 crypto/rsa/rsa_backend.c                             | 2 +-
 crypto/store/store_lib.c                             | 2 +-
 crypto/store/store_result.c                          | 2 +-
 crypto/trace.c                                       | 2 +-
 crypto/ts/ts_rsp_sign.c                              | 2 +-
 crypto/ui/ui_openssl.c                               | 2 +-
 crypto/x509/by_dir.c                                 | 2 +-
 crypto/x509/v3_tlsf.c                                | 2 +-
 crypto/x509/v3_utl.c                                 | 2 +-
 engines/e_devcrypto.c                                | 2 +-
 engines/e_loader_attic.c                             | 2 +-
 include/internal/common.h                            | 2 +-
 e_os.h =&gt; include/internal/e_os.h                    | 0
 providers/common/capabilities.c                      | 2 +-
 providers/fips/self_test.c                           | 2 +-
 providers/implementations/ciphers/cipher_cts.c       | 2 +-
 providers/implementations/kdfs/hkdf.c                | 2 +-
 providers/implementations/kdfs/kbkdf.c               | 2 +-
 providers/implementations/kdfs/tls1_prf.c            | 2 +-
 providers/implementations/kdfs/x942kdf.c             | 2 +-
 providers/implementations/kem/rsa_kem.c              | 2 +-
 providers/implementations/keymgmt/dsa_kmgmt.c        | 2 +-
 providers/implementations/keymgmt/ec_kmgmt.c         | 2 +-
 providers/implementations/keymgmt/ecx_kmgmt.c        | 2 +-
 providers/implementations/keymgmt/mac_legacy_kmgmt.c | 2 +-
 providers/implementations/rands/drbg_ctr.c           | 2 +-
 providers/implementations/rands/seeding/rand_unix.c  | 2 +-
 providers/implementations/rands/seeding/rand_vms.c   | 2 +-
 providers/implementations/signature/rsa_sig.c        | 2 +-
 providers/implementations/storemgmt/file_store.c     | 2 +-
 ssl/d1_lib.c                                         | 2 +-
 ssl/ssl_init.c                                       | 2 +-
 ssl/ssl_lib.c                                        | 2 +-
 ssl/ssl_local.h                                      | 2 +-
 test/evp_extra_test.c                                | 2 +-
 test/evp_libctx_test.c                               | 2 +-
 test/evp_test.c                                      | 2 +-
 test/helpers/ssltestlib.c                            | 2 +-
 test/p_test.c                                        | 2 +-
 test/secmemtest.c                                    | 2 +-
 test/ssl_old_test.c                                  | 2 +-
 93 files changed, 93 insertions(+), 93 deletions(-)
 rename e_os.h =&gt; include/internal/e_os.h (100%)

diff --git a/apps/include/apps.h b/apps/include/apps.h
index b6dbe74fa9..28c2bbdad2 100644
--- a/apps/include/apps.h
+++ b/apps/include/apps.h
@@ -10,7 +10,7 @@
 #ifndef OSSL_APPS_H
 # define OSSL_APPS_H
 
-# include &quot;e_os.h&quot; /* struct timeval for DTLS */
+# include &quot;internal/e_os.h&quot; /* struct timeval for DTLS */
 # include &quot;internal/common.h&quot; /* for HAS_PREFIX */
 # include &quot;internal/nelem.h&quot;
 # include &quot;internal/sockets.h&quot; /* for openssl_fdset() */
diff --git a/apps/s_client.c b/apps/s_client.c
index 1d73e1b39e..06a58a8b51 100644
--- a/apps/s_client.c
+++ b/apps/s_client.c
@@ -8,7 +8,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;ctype.h&gt;
 #include &lt;stdio.h&gt;
 #include &lt;stdlib.h&gt;
diff --git a/crypto/asn1/ameth_lib.c b/crypto/asn1/ameth_lib.c
index 031a6c936a..9704492607 100644
--- a/crypto/asn1/ameth_lib.c
+++ b/crypto/asn1/ameth_lib.c
@@ -10,7 +10,7 @@
 /* We need to use some engine deprecated APIs */
 #define OPENSSL_SUPPRESS_DEPRECATED
 
-#include &quot;e_os.h&quot;               /* for strncasecmp */
+#include &quot;internal/e_os.h&quot;               /* for strncasecmp */
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;stdio.h&gt;
 #include &lt;openssl/asn1t.h&gt;
diff --git a/crypto/asn1/asn1_gen.c b/crypto/asn1/asn1_gen.c
index bb0dcb2e09..a112f7de9e 100644
--- a/crypto/asn1/asn1_gen.c
+++ b/crypto/asn1/asn1_gen.c
@@ -10,7 +10,7 @@
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;openssl/asn1.h&gt;
 #include &lt;openssl/x509v3.h&gt;
-#include &quot;e_os.h&quot; /* strncasecmp() */
+#include &quot;internal/e_os.h&quot; /* strncasecmp() */
 
 #define ASN1_GEN_FLAG           0x10000
 #define ASN1_GEN_FLAG_IMP       (ASN1_GEN_FLAG|1)
diff --git a/crypto/bio/bio_local.h b/crypto/bio/bio_local.h
index 749e8f810c..6ba0196ce6 100644
--- a/crypto/bio/bio_local.h
+++ b/crypto/bio/bio_local.h
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;internal/sockets.h&quot;
 
 /* BEGIN BIO_ADDRINFO/BIO_ADDR stuff. */
diff --git a/crypto/bio/bss_bio.c b/crypto/bio/bss_bio.c
index 92dd262309..aaac451314 100644
--- a/crypto/bio/bss_bio.c
+++ b/crypto/bio/bss_bio.c
@@ -15,7 +15,7 @@
  * See ssl/ssltest.c for some hints on how this can be used.
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;assert.h&gt;
 #include &lt;limits.h&gt;
 #include &lt;stdlib.h&gt;
diff --git a/crypto/cmp/cmp_client.c b/crypto/cmp/cmp_client.c
index 4a7a87ff74..0ca7f94a86 100644
--- a/crypto/cmp/cmp_client.c
+++ b/crypto/cmp/cmp_client.c
@@ -11,7 +11,7 @@
 
 #include &quot;cmp_local.h&quot;
 #include &quot;internal/cryptlib.h&quot;
-#include &quot;e_os.h&quot; /* ossl_sleep() */
+#include &quot;internal/e_os.h&quot; /* ossl_sleep() */
 
 /* explicit #includes not strictly needed since implied by the above: */
 #include &lt;openssl/bio.h&gt;
diff --git a/crypto/conf/conf_api.c b/crypto/conf/conf_api.c
index 7a4efe6dbb..37e66af78e 100644
--- a/crypto/conf/conf_api.c
+++ b/crypto/conf/conf_api.c
@@ -9,7 +9,7 @@
 
 /* Part of the code in here was originally in conf.c, which is now removed */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;stdlib.h&gt;
 #include &lt;string.h&gt;
diff --git a/crypto/conf/conf_def.c b/crypto/conf/conf_def.c
index 26764dad00..9d79a900c8 100644
--- a/crypto/conf/conf_def.c
+++ b/crypto/conf/conf_def.c
@@ -11,7 +11,7 @@
 
 #include &lt;stdio.h&gt;
 #include &lt;string.h&gt;
-#include &quot;e_os.h&quot; /* strcasecmp and struct stat */
+#include &quot;internal/e_os.h&quot; /* strcasecmp and struct stat */
 #ifdef __TANDEM
 # include &lt;sys/types.h&gt; /* needed for stat.h */
 # include &lt;sys/stat.h&gt; /* struct stat */
diff --git a/crypto/conf/conf_lib.c b/crypto/conf/conf_lib.c
index a236003525..fe08e0af5f 100644
--- a/crypto/conf/conf_lib.c
+++ b/crypto/conf/conf_lib.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;stdio.h&gt;
 #include &lt;string.h&gt;
 #include &quot;internal/conf.h&quot;
diff --git a/crypto/core_namemap.c b/crypto/core_namemap.c
index 6cb0ec5a06..f058e629f3 100644
--- a/crypto/core_namemap.c
+++ b/crypto/core_namemap.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;                /* strcasecmp */
+#include &quot;internal/e_os.h&quot;                /* strcasecmp */
 #include &quot;internal/namemap.h&quot;
 #include &lt;openssl/lhash.h&gt;
 #include &quot;crypto/lhash.h&quot;      /* ossl_lh_strcasehash */
diff --git a/crypto/cpuid.c b/crypto/cpuid.c
index 048689f410..75bd03bffe 100644
--- a/crypto/cpuid.c
+++ b/crypto/cpuid.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;crypto/cryptlib.h&quot;
 
 #if     defined(__i386)   || defined(__i386__)   || defined(_M_IX86) || \
diff --git a/crypto/cryptlib.c b/crypto/cryptlib.c
index 6e73b8352c..f78c2236e4 100644
--- a/crypto/cryptlib.c
+++ b/crypto/cryptlib.c
@@ -8,7 +8,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;crypto/cryptlib.h&quot;
 #include &lt;openssl/safestack.h&gt;
 
diff --git a/crypto/des/cfb_enc.c b/crypto/des/cfb_enc.c
index 30458d50a1..e8813755bf 100644
--- a/crypto/des/cfb_enc.c
+++ b/crypto/des/cfb_enc.c
@@ -13,7 +13,7 @@
  */
 #include &quot;internal/deprecated.h&quot;
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;des_local.h&quot;
 #include &lt;assert.h&gt;
 
diff --git a/crypto/dh/dh_group_params.c b/crypto/dh/dh_group_params.c
index c71f4053da..dec50caf66 100644
--- a/crypto/dh/dh_group_params.c
+++ b/crypto/dh/dh_group_params.c
@@ -23,7 +23,7 @@
 #include &lt;openssl/objects.h&gt;
 #include &quot;internal/nelem.h&quot;
 #include &quot;crypto/dh.h&quot;
-#include &quot;e_os.h&quot; /* strcasecmp */
+#include &quot;internal/e_os.h&quot; /* strcasecmp */
 
 static DH *dh_param_init(OSSL_LIB_CTX *libctx, const DH_NAMED_GROUP *group)
 {
diff --git a/crypto/dh/dh_kdf.c b/crypto/dh/dh_kdf.c
index 419e7711d3..eda3d3998a 100644
--- a/crypto/dh/dh_kdf.c
+++ b/crypto/dh/dh_kdf.c
@@ -13,8 +13,8 @@
  */
 #include &quot;internal/deprecated.h&quot;
 
-#include &quot;e_os.h&quot;
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;string.h&gt;
 #include &lt;openssl/core_names.h&gt;
 #include &lt;openssl/dh.h&gt;
diff --git a/crypto/dllmain.c b/crypto/dllmain.c
index 48c0cd3122..65d9be6767 100644
--- a/crypto/dllmain.c
+++ b/crypto/dllmain.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;crypto/cryptlib.h&quot;
 
 #if defined(_WIN32) || defined(__CYGWIN__)
diff --git a/crypto/dso/dso_dlfcn.c b/crypto/dso/dso_dlfcn.c
index 6a988cc727..982b117e70 100644
--- a/crypto/dso/dso_dlfcn.c
+++ b/crypto/dso/dso_dlfcn.c
@@ -17,7 +17,7 @@
 #endif
 
 #include &quot;dso_local.h&quot;
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 #ifdef DSO_DLFCN
 
diff --git a/crypto/dso/dso_win32.c b/crypto/dso/dso_win32.c
index 4d3059d438..08ad8f46b3 100644
--- a/crypto/dso/dso_win32.c
+++ b/crypto/dso/dso_win32.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;dso_local.h&quot;
 
 #if defined(DSO_WIN32)
diff --git a/crypto/ec/curve448/arch_32/f_impl32.c b/crypto/ec/curve448/arch_32/f_impl32.c
index 8714a51422..45d5587347 100644
--- a/crypto/ec/curve448/arch_32/f_impl32.c
+++ b/crypto/ec/curve448/arch_32/f_impl32.c
@@ -10,7 +10,7 @@
  * Originally written by Mike Hamburg
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;openssl/macros.h&gt;
 #include &quot;internal/numbers.h&quot;
 
diff --git a/crypto/ec/curve448/arch_64/f_impl64.c b/crypto/ec/curve448/arch_64/f_impl64.c
index 8f7a7dd391..10a9b065e5 100644
--- a/crypto/ec/curve448/arch_64/f_impl64.c
+++ b/crypto/ec/curve448/arch_64/f_impl64.c
@@ -10,7 +10,7 @@
  * Originally written by Mike Hamburg
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;openssl/macros.h&gt;
 #include &quot;internal/numbers.h&quot;
 
diff --git a/crypto/ec/ec_backend.c b/crypto/ec/ec_backend.c
index 2db1c1380e..d2fff0657d 100644
--- a/crypto/ec/ec_backend.c
+++ b/crypto/ec/ec_backend.c
@@ -24,7 +24,7 @@
 #include &quot;crypto/bn.h&quot;
 #include &quot;crypto/ec.h&quot;
 #include &quot;ec_local.h&quot;
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;internal/param_build_set.h&quot;
 
 /* Mapping between a flag and a name */
diff --git a/crypto/ec/ec_lib.c b/crypto/ec/ec_lib.c
index 2d85d4f23a..2aeab7e3b6 100644
--- a/crypto/ec/ec_lib.c
+++ b/crypto/ec/ec_lib.c
@@ -22,7 +22,7 @@
 #include &quot;crypto/ec.h&quot;
 #include &quot;internal/nelem.h&quot;
 #include &quot;ec_local.h&quot;
-#include &quot;e_os.h&quot; /* strcasecmp */
+#include &quot;internal/e_os.h&quot; /* strcasecmp */
 
 /* functions for EC_GROUP objects */
 
diff --git a/crypto/encode_decode/decoder_lib.c b/crypto/encode_decode/decoder_lib.c
index 10a38b6f82..9242cd2c6f 100644
--- a/crypto/encode_decode/decoder_lib.c
+++ b/crypto/encode_decode/decoder_lib.c
@@ -20,7 +20,7 @@
 #include &quot;internal/provider.h&quot;
 #include &quot;crypto/decoder.h&quot;
 #include &quot;encoder_local.h&quot;
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 struct decoder_process_data_st {
     OSSL_DECODER_CTX *ctx;
diff --git a/crypto/encode_decode/decoder_pkey.c b/crypto/encode_decode/decoder_pkey.c
index 475117a463..472abef311 100644
--- a/crypto/encode_decode/decoder_pkey.c
+++ b/crypto/encode_decode/decoder_pkey.c
@@ -18,7 +18,7 @@
 #include &quot;crypto/evp.h&quot;
 #include &quot;crypto/decoder.h&quot;
 #include &quot;encoder_local.h&quot;
-#include &quot;e_os.h&quot;                /* strcasecmp on Windows */
+#include &quot;internal/e_os.h&quot;                /* strcasecmp on Windows */
 
 int OSSL_DECODER_CTX_set_passphrase(OSSL_DECODER_CTX *ctx,
                                     const unsigned char *kstr,
diff --git a/crypto/encode_decode/encoder_lib.c b/crypto/encode_decode/encoder_lib.c
index 8d083bd6a6..52cc404097 100644
--- a/crypto/encode_decode/encoder_lib.c
+++ b/crypto/encode_decode/encoder_lib.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;                /* strcasecmp on Windows */
+#include &quot;internal/e_os.h&quot;                /* strcasecmp on Windows */
 #include &lt;openssl/core_names.h&gt;
 #include &lt;openssl/bio.h&gt;
 #include &lt;openssl/encoder.h&gt;
diff --git a/crypto/encode_decode/encoder_pkey.c b/crypto/encode_decode/encoder_pkey.c
index 109dfa80cd..ba29da6385 100644
--- a/crypto/encode_decode/encoder_pkey.c
+++ b/crypto/encode_decode/encoder_pkey.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;                /* strcasecmp on Windows */
+#include &quot;internal/e_os.h&quot;                /* strcasecmp on Windows */
 #include &lt;openssl/err.h&gt;
 #include &lt;openssl/ui.h&gt;
 #include &lt;openssl/params.h&gt;
diff --git a/crypto/engine/eng_init.c b/crypto/engine/eng_init.c
index c204eb1899..343a069fa0 100644
--- a/crypto/engine/eng_init.c
+++ b/crypto/engine/eng_init.c
@@ -10,7 +10,7 @@
 /* We need to use some engine deprecated APIs */
 #define OPENSSL_SUPPRESS_DEPRECATED
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;eng_local.h&quot;
 
 /*
diff --git a/crypto/engine/eng_lib.c b/crypto/engine/eng_lib.c
index 05c6a67c1e..813bcd6df6 100644
--- a/crypto/engine/eng_lib.c
+++ b/crypto/engine/eng_lib.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;eng_local.h&quot;
 #include &lt;openssl/rand.h&gt;
 #include &quot;internal/refcount.h&quot;
diff --git a/crypto/engine/tb_asnmth.c b/crypto/engine/tb_asnmth.c
index e3a5c82e99..bf424ff09e 100644
--- a/crypto/engine/tb_asnmth.c
+++ b/crypto/engine/tb_asnmth.c
@@ -10,7 +10,7 @@
 /* We need to use some engine deprecated APIs */
 #define OPENSSL_SUPPRESS_DEPRECATED
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;eng_local.h&quot;
 #include &lt;openssl/evp.h&gt;
 #include &quot;crypto/asn1.h&quot;
diff --git a/crypto/err/err.c b/crypto/err/err.c
index 63cf682382..04eaf43b72 100644
--- a/crypto/err/err.c
+++ b/crypto/err/err.c
@@ -23,7 +23,7 @@
 #include &quot;internal/thread_once.h&quot;
 #include &quot;crypto/ctype.h&quot;
 #include &quot;internal/constant_time.h&quot;
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;err_local.h&quot;
 
 /* Forward declaration in case it's not published because of configuration */
diff --git a/crypto/evp/ctrl_params_translate.c b/crypto/evp/ctrl_params_translate.c
index 2deb1d9b47..33e5e7f189 100644
--- a/crypto/evp/ctrl_params_translate.c
+++ b/crypto/evp/ctrl_params_translate.c
@@ -37,7 +37,7 @@
 #include &quot;crypto/dh.h&quot;
 #include &quot;crypto/ec.h&quot;
 
-#include &quot;e_os.h&quot;                /* strcasecmp() for Windows */
+#include &quot;internal/e_os.h&quot;                /* strcasecmp() for Windows */
 
 struct translation_ctx_st;       /* Forwarding */
 struct translation_st;           /* Forwarding */
diff --git a/crypto/evp/ec_support.c b/crypto/evp/ec_support.c
index 8550be65e7..979e861cff 100644
--- a/crypto/evp/ec_support.c
+++ b/crypto/evp/ec_support.c
@@ -10,7 +10,7 @@
 #include &lt;string.h&gt;
 #include &lt;openssl/ec.h&gt;
 #include &quot;crypto/ec.h&quot;
-#include &quot;e_os.h&quot; /* strcasecmp required by windows */
+#include &quot;internal/e_os.h&quot; /* strcasecmp required by windows */
 
 typedef struct ec_name2nid_st {
     const char *name;
diff --git a/crypto/evp/evp_lib.c b/crypto/evp/evp_lib.c
index 24092cfd5b..3d261c282f 100644
--- a/crypto/evp/evp_lib.c
+++ b/crypto/evp/evp_lib.c
@@ -15,7 +15,7 @@
 
 #include &lt;stdio.h&gt;
 #include &lt;string.h&gt;
-#include &quot;e_os.h&quot; /* strcasecmp */
+#include &quot;internal/e_os.h&quot; /* strcasecmp */
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/objects.h&gt;
diff --git a/crypto/evp/p_lib.c b/crypto/evp/p_lib.c
index 27138af564..be15f105b7 100644
--- a/crypto/evp/p_lib.c
+++ b/crypto/evp/p_lib.c
@@ -50,7 +50,7 @@
 #include &quot;internal/provider.h&quot;
 #include &quot;evp_local.h&quot;
 
-#include &quot;e_os.h&quot;                /* strcasecmp on Windows */
+#include &quot;internal/e_os.h&quot;                /* strcasecmp on Windows */
 
 static int pkey_set_type(EVP_PKEY *pkey, ENGINE *e, int type, const char *str,
                          int len, EVP_KEYMGMT *keymgmt);
diff --git a/crypto/ffc/ffc_dh.c b/crypto/ffc/ffc_dh.c
index e9f597c46c..cedf283533 100644
--- a/crypto/ffc/ffc_dh.c
+++ b/crypto/ffc/ffc_dh.c
@@ -10,7 +10,7 @@
 #include &quot;internal/ffc.h&quot;
 #include &quot;internal/nelem.h&quot;
 #include &quot;crypto/bn_dh.h&quot;
-#include &quot;e_os.h&quot; /* strcasecmp */
+#include &quot;internal/e_os.h&quot; /* strcasecmp */
 
 #ifndef OPENSSL_NO_DH
 
diff --git a/crypto/ffc/ffc_params.c b/crypto/ffc/ffc_params.c
index 6e025a06be..1078a7b845 100644
--- a/crypto/ffc/ffc_params.c
+++ b/crypto/ffc/ffc_params.c
@@ -12,7 +12,7 @@
 #include &quot;internal/ffc.h&quot;
 #include &quot;internal/param_build_set.h&quot;
 #include &quot;internal/nelem.h&quot;
-#include &quot;e_os.h&quot; /* strcasecmp */
+#include &quot;internal/e_os.h&quot; /* strcasecmp */
 
 #ifndef FIPS_MODULE
 # include &lt;openssl/asn1.h&gt; /* ossl_ffc_params_print */
diff --git a/crypto/getenv.c b/crypto/getenv.c
index e79b6cc161..b263d1b624 100644
--- a/crypto/getenv.c
+++ b/crypto/getenv.c
@@ -13,7 +13,7 @@
 
 #include &lt;stdlib.h&gt;
 #include &quot;internal/cryptlib.h&quot;
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 char *ossl_safe_getenv(const char *name)
 {
diff --git a/crypto/http/http_client.c b/crypto/http/http_client.c
index 14c2cbf2b5..d6345b4582 100644
--- a/crypto/http/http_client.c
+++ b/crypto/http/http_client.c
@@ -8,7 +8,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;stdio.h&gt;
 #include &lt;stdlib.h&gt;
 #include &quot;crypto/ctype.h&quot;
diff --git a/crypto/info.c b/crypto/info.c
index f3bef56b13..05edbc3fc8 100644
--- a/crypto/info.c
+++ b/crypto/info.c
@@ -12,7 +12,7 @@
 #include &quot;crypto/dso_conf.h&quot;
 #include &quot;internal/thread_once.h&quot;
 #include &quot;internal/cryptlib.h&quot;
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;buildinf.h&quot;
 
 #if defined(__arm__) || defined(__arm) || defined(__aarch64__)
diff --git a/crypto/init.c b/crypto/init.c
index 6a27d1a8e4..b7d7ad0ea3 100644
--- a/crypto/init.c
+++ b/crypto/init.c
@@ -10,7 +10,7 @@
 /* We need to use some engine deprecated APIs */
 #define OPENSSL_SUPPRESS_DEPRECATED
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;crypto/cryptlib.h&quot;
 #include &lt;openssl/err.h&gt;
 #include &quot;crypto/rand.h&quot;
diff --git a/crypto/mem.c b/crypto/mem.c
index 242d88470a..f76c48d886 100644
--- a/crypto/mem.c
+++ b/crypto/mem.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;internal/cryptlib.h&quot;
 #include &quot;crypto/cryptlib.h&quot;
 #include &lt;stdio.h&gt;
diff --git a/crypto/mem_sec.c b/crypto/mem_sec.c
index c2cc2cbf32..4806102805 100644
--- a/crypto/mem_sec.c
+++ b/crypto/mem_sec.c
@@ -15,7 +15,7 @@
  * For details on that implementation, see below (look for uppercase
  * &quot;SECURE HEAP IMPLEMENTATION&quot;).
  */
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;openssl/crypto.h&gt;
 
 #include &lt;string.h&gt;
diff --git a/crypto/o_dir.c b/crypto/o_dir.c
index 6857a2e17d..8772347930 100644
--- a/crypto/o_dir.c
+++ b/crypto/o_dir.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;errno.h&gt;
 
 /*
diff --git a/crypto/o_fopen.c b/crypto/o_fopen.c
index 8095fffbe0..f449c3ec1d 100644
--- a/crypto/o_fopen.c
+++ b/crypto/o_fopen.c
@@ -25,7 +25,7 @@
 #  endif
 # endif
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;internal/cryptlib.h&quot;
 
 #if !defined(OPENSSL_NO_STDIO)
diff --git a/crypto/o_init.c b/crypto/o_init.c
index a0b4256f78..30c19b81e8 100644
--- a/crypto/o_init.c
+++ b/crypto/o_init.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;openssl/err.h&gt;
 
 /*
diff --git a/crypto/o_str.c b/crypto/o_str.c
index d7aa665ad8..649a669d25 100644
--- a/crypto/o_str.c
+++ b/crypto/o_str.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;limits.h&gt;
 #include &lt;openssl/crypto.h&gt;
 #include &quot;internal/cryptlib.h&quot;
diff --git a/crypto/objects/o_names.c b/crypto/objects/o_names.c
index 92152eeb66..82fbc3bf96 100644
--- a/crypto/objects/o_names.c
+++ b/crypto/objects/o_names.c
@@ -19,7 +19,7 @@
 #include &quot;internal/thread_once.h&quot;
 #include &quot;crypto/lhash.h&quot;
 #include &quot;obj_local.h&quot;
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 /*
  * We define this wrapper for two reasons. Firstly, later versions of
diff --git a/crypto/params_dup.c b/crypto/params_dup.c
index 530bc530cc..3c3b18e620 100644
--- a/crypto/params_dup.c
+++ b/crypto/params_dup.c
@@ -11,7 +11,7 @@
 #include &lt;openssl/params.h&gt;
 #include &lt;openssl/param_build.h&gt;
 #include &quot;internal/param_build_set.h&quot;
-#include &quot;e_os.h&quot; /* strcasecmp */
+#include &quot;internal/e_os.h&quot; /* strcasecmp */
 
 #define OSSL_PARAM_ALLOCATED_END    127
 #define OSSL_PARAM_MERGE_LIST_MAX   128
diff --git a/crypto/property/property_parse.c b/crypto/property/property_parse.c
index dc35646be2..4b99ee1f39 100644
--- a/crypto/property/property_parse.c
+++ b/crypto/property/property_parse.c
@@ -17,7 +17,7 @@
 #include &quot;crypto/ctype.h&quot;
 #include &quot;internal/nelem.h&quot;
 #include &quot;property_local.h&quot;
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 DEFINE_STACK_OF(OSSL_PROPERTY_DEFINITION)
 
diff --git a/crypto/rand/rand_deprecated.c b/crypto/rand/rand_deprecated.c
index dd69f1beb7..a6bc2a99e3 100644
--- a/crypto/rand/rand_deprecated.c
+++ b/crypto/rand/rand_deprecated.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &lt;e_os.h&gt;
+#include &quot;internal/e_os.h&quot;
 #include &lt;openssl/macros.h&gt;
 #include &lt;openssl/rand.h&gt;
 
diff --git a/crypto/rand/rand_lib.c b/crypto/rand/rand_lib.c
index 30b6cb817f..4f36e84bd4 100644
--- a/crypto/rand/rand_lib.c
+++ b/crypto/rand/rand_lib.c
@@ -28,7 +28,7 @@
 # include &lt;openssl/engine.h&gt;
 # include &quot;crypto/rand_pool.h&quot;
 # include &quot;prov/seeding.h&quot;
-# include &quot;e_os.h&quot;
+# include &quot;internal/e_os.h&quot;
 
 # ifndef OPENSSL_NO_ENGINE
 /* non-NULL if default_RAND_meth is ENGINE-provided */
diff --git a/crypto/rsa/rsa_backend.c b/crypto/rsa/rsa_backend.c
index 4385dd0135..a0e1e14e4d 100644
--- a/crypto/rsa/rsa_backend.c
+++ b/crypto/rsa/rsa_backend.c
@@ -27,7 +27,7 @@
 #include &quot;crypto/rsa.h&quot;
 #include &quot;rsa_local.h&quot;
 
-#include &quot;e_os.h&quot;                /* strcasecmp for Windows() */
+#include &quot;internal/e_os.h&quot;                /* strcasecmp for Windows() */
 
 /*
  * The intention with the &quot;backend&quot; source file is to offer backend support
diff --git a/crypto/store/store_lib.c b/crypto/store/store_lib.c
index 4efa7eea03..81e0f70a19 100644
--- a/crypto/store/store_lib.c
+++ b/crypto/store/store_lib.c
@@ -14,7 +14,7 @@
 /* We need to use some STORE deprecated APIs */
 #define OPENSSL_SUPPRESS_DEPRECATED
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 #include &lt;openssl/crypto.h&gt;
 #include &lt;openssl/err.h&gt;
diff --git a/crypto/store/store_result.c b/crypto/store/store_result.c
index de00f4f562..567b9c99cd 100644
--- a/crypto/store/store_result.c
+++ b/crypto/store/store_result.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;string.h&gt;
 
 #include &lt;openssl/core.h&gt;
diff --git a/crypto/trace.c b/crypto/trace.c
index dc194acb52..a9a097f1a3 100644
--- a/crypto/trace.c
+++ b/crypto/trace.c
@@ -19,7 +19,7 @@
 #include &quot;internal/refcount.h&quot;
 #include &quot;crypto/cryptlib.h&quot;
 
-#include &quot;e_os.h&quot;                /* strcasecmp for Windows */
+#include &quot;internal/e_os.h&quot;                /* strcasecmp for Windows */
 
 #ifndef OPENSSL_NO_TRACE
 
diff --git a/crypto/ts/ts_rsp_sign.c b/crypto/ts/ts_rsp_sign.c
index cf3e5443de..99b2228a06 100644
--- a/crypto/ts/ts_rsp_sign.c
+++ b/crypto/ts/ts_rsp_sign.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/ts.h&gt;
diff --git a/crypto/ui/ui_openssl.c b/crypto/ui/ui_openssl.c
index 37b98910c7..fc5b12b03d 100644
--- a/crypto/ui/ui_openssl.c
+++ b/crypto/ui/ui_openssl.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;openssl/e_os2.h&gt;
 #include &lt;openssl/err.h&gt;
 #include &lt;openssl/ui.h&gt;
diff --git a/crypto/x509/by_dir.c b/crypto/x509/by_dir.c
index 258ad51852..599d5463bb 100644
--- a/crypto/x509/by_dir.c
+++ b/crypto/x509/by_dir.c
@@ -16,7 +16,7 @@
 # include &lt;sys/stat.h&gt;
 #endif
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;stdio.h&gt;
 #include &lt;time.h&gt;
diff --git a/crypto/x509/v3_tlsf.c b/crypto/x509/v3_tlsf.c
index 6a613d64e6..32ac300355 100644
--- a/crypto/x509/v3_tlsf.c
+++ b/crypto/x509/v3_tlsf.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;stdio.h&gt;
 #include &lt;openssl/asn1t.h&gt;
diff --git a/crypto/x509/v3_utl.c b/crypto/x509/v3_utl.c
index 72d4d3867d..0687ffabc9 100644
--- a/crypto/x509/v3_utl.c
+++ b/crypto/x509/v3_utl.c
@@ -9,7 +9,7 @@
 
 /* X509 v3 extension utilities */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;stdio.h&gt;
 #include &lt;string.h&gt;
diff --git a/engines/e_devcrypto.c b/engines/e_devcrypto.c
index adf53d8d91..abc2930fb0 100644
--- a/engines/e_devcrypto.c
+++ b/engines/e_devcrypto.c
@@ -10,7 +10,7 @@
 /* We need to use some deprecated APIs */
 #define OPENSSL_SUPPRESS_DEPRECATED
 
-#include &quot;../e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;string.h&gt;
 #include &lt;sys/types.h&gt;
 #include &lt;sys/stat.h&gt;
diff --git a/engines/e_loader_attic.c b/engines/e_loader_attic.c
index e2a5474c1c..be36c6e397 100644
--- a/engines/e_loader_attic.c
+++ b/engines/e_loader_attic.c
@@ -14,7 +14,7 @@
 /* We need to use some engine deprecated APIs */
 #define OPENSSL_SUPPRESS_DEPRECATED
 
-#include &quot;../e_os.h&quot; /* for stat and strncasecmp */
+#include &quot;internal/e_os.h&quot; /* for stat and strncasecmp */
 #include &lt;string.h&gt;
 #include &lt;sys/stat.h&gt;
 #include &lt;ctype.h&gt;
diff --git a/include/internal/common.h b/include/internal/common.h
index 44224f3ba8..f20b041ac0 100644
--- a/include/internal/common.h
+++ b/include/internal/common.h
@@ -13,7 +13,7 @@
 
 # include &lt;stdlib.h&gt;
 # include &lt;string.h&gt;
-# include &quot;../../e_os.h&quot; /* To get strncasecmp() on Windows */
+# include &quot;internal/e_os.h&quot; /* To get strncasecmp() on Windows */
 
 # include &quot;internal/nelem.h&quot;
 
diff --git a/e_os.h b/include/internal/e_os.h
similarity index 100%
rename from e_os.h
rename to include/internal/e_os.h
diff --git a/providers/common/capabilities.c b/providers/common/capabilities.c
index f6d95197f0..edf7c9f768 100644
--- a/providers/common/capabilities.c
+++ b/providers/common/capabilities.c
@@ -17,7 +17,7 @@
 #include &quot;internal/nelem.h&quot;
 #include &quot;internal/tlsgroups.h&quot;
 #include &quot;prov/providercommon.h&quot;
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 /* If neither ec or dh is available then we have no TLS-GROUP capabilities */
 #if !defined(OPENSSL_NO_EC) || !defined(OPENSSL_NO_DH)
diff --git a/providers/fips/self_test.c b/providers/fips/self_test.c
index e236bd421a..a41f49b887 100644
--- a/providers/fips/self_test.c
+++ b/providers/fips/self_test.c
@@ -15,7 +15,7 @@
 #include &lt;openssl/fipskey.h&gt;
 #include &lt;openssl/err.h&gt;
 #include &lt;openssl/proverr.h&gt;
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &quot;prov/providercommon.h&quot;
 
 /*
diff --git a/providers/implementations/ciphers/cipher_cts.c b/providers/implementations/ciphers/cipher_cts.c
index cb3372c646..aced2021f9 100644
--- a/providers/implementations/ciphers/cipher_cts.c
+++ b/providers/implementations/ciphers/cipher_cts.c
@@ -46,7 +46,7 @@
  *      Otherwise it is the same as CS2.
  */
 
-#include &quot;e_os.h&quot; /* strcasecmp */
+#include &quot;internal/e_os.h&quot; /* strcasecmp */
 #include &lt;openssl/core_names.h&gt;
 #include &quot;prov/ciphercommon.h&quot;
 #include &quot;internal/nelem.h&quot;
diff --git a/providers/implementations/kdfs/hkdf.c b/providers/implementations/kdfs/hkdf.c
index e014e32d5b..2238c321a7 100644
--- a/providers/implementations/kdfs/hkdf.c
+++ b/providers/implementations/kdfs/hkdf.c
@@ -29,7 +29,7 @@
 #include &quot;prov/providercommon.h&quot;
 #include &quot;prov/implementations.h&quot;
 #include &quot;prov/provider_util.h&quot;
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 #define HKDF_MAXBUF 2048
 
diff --git a/providers/implementations/kdfs/kbkdf.c b/providers/implementations/kdfs/kbkdf.c
index fb5c1c022e..7462eb6e94 100644
--- a/providers/implementations/kdfs/kbkdf.c
+++ b/providers/implementations/kdfs/kbkdf.c
@@ -44,7 +44,7 @@
 #include &quot;prov/provider_util.h&quot;
 #include &quot;prov/providercommon.h&quot;
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 #define ossl_min(a, b) ((a) &lt; (b)) ? (a) : (b)
 
diff --git a/providers/implementations/kdfs/tls1_prf.c b/providers/implementations/kdfs/tls1_prf.c
index 23436cf241..eba4da50e1 100644
--- a/providers/implementations/kdfs/tls1_prf.c
+++ b/providers/implementations/kdfs/tls1_prf.c
@@ -60,7 +60,7 @@
 #include &quot;prov/providercommon.h&quot;
 #include &quot;prov/implementations.h&quot;
 #include &quot;prov/provider_util.h&quot;
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 static OSSL_FUNC_kdf_newctx_fn kdf_tls1_prf_new;
 static OSSL_FUNC_kdf_dupctx_fn kdf_tls1_prf_dup;
diff --git a/providers/implementations/kdfs/x942kdf.c b/providers/implementations/kdfs/x942kdf.c
index 4fb71835a2..3bf65aa3cd 100644
--- a/providers/implementations/kdfs/x942kdf.c
+++ b/providers/implementations/kdfs/x942kdf.c
@@ -8,7 +8,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;openssl/core_names.h&gt;
 #include &lt;openssl/core_dispatch.h&gt;
 #include &lt;openssl/err.h&gt;
diff --git a/providers/implementations/kem/rsa_kem.c b/providers/implementations/kem/rsa_kem.c
index 313ab133b3..201c80e648 100644
--- a/providers/implementations/kem/rsa_kem.c
+++ b/providers/implementations/kem/rsa_kem.c
@@ -13,7 +13,7 @@
  */
 #include &quot;internal/deprecated.h&quot;
 
-#include &quot;e_os.h&quot;  /* strcasecmp */
+#include &quot;internal/e_os.h&quot;  /* strcasecmp */
 #include &lt;openssl/crypto.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/core_dispatch.h&gt;
diff --git a/providers/implementations/keymgmt/dsa_kmgmt.c b/providers/implementations/keymgmt/dsa_kmgmt.c
index cf6daa4715..3ddafbd4c1 100644
--- a/providers/implementations/keymgmt/dsa_kmgmt.c
+++ b/providers/implementations/keymgmt/dsa_kmgmt.c
@@ -13,7 +13,7 @@
  */
 #include &quot;internal/deprecated.h&quot;
 
-#include &quot;e_os.h&quot; /* strcasecmp */
+#include &quot;internal/e_os.h&quot; /* strcasecmp */
 #include &lt;openssl/core_dispatch.h&gt;
 #include &lt;openssl/core_names.h&gt;
 #include &lt;openssl/bn.h&gt;
diff --git a/providers/implementations/keymgmt/ec_kmgmt.c b/providers/implementations/keymgmt/ec_kmgmt.c
index dd66489bce..78dc69082f 100644
--- a/providers/implementations/keymgmt/ec_kmgmt.c
+++ b/providers/implementations/keymgmt/ec_kmgmt.c
@@ -13,7 +13,7 @@
  */
 #include &quot;internal/deprecated.h&quot;
 
-#include &quot;e_os.h&quot; /* strcasecmp */
+#include &quot;internal/e_os.h&quot; /* strcasecmp */
 #include &lt;string.h&gt;
 #include &lt;openssl/core_dispatch.h&gt;
 #include &lt;openssl/core_names.h&gt;
diff --git a/providers/implementations/keymgmt/ecx_kmgmt.c b/providers/implementations/keymgmt/ecx_kmgmt.c
index 42ae565429..9afcb6dc0a 100644
--- a/providers/implementations/keymgmt/ecx_kmgmt.c
+++ b/providers/implementations/keymgmt/ecx_kmgmt.c
@@ -10,7 +10,7 @@
 #include &lt;assert.h&gt;
 #include &lt;string.h&gt;
 /* For strcasecmp on Windows */
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;openssl/core_dispatch.h&gt;
 #include &lt;openssl/core_names.h&gt;
 #include &lt;openssl/params.h&gt;
diff --git a/providers/implementations/keymgmt/mac_legacy_kmgmt.c b/providers/implementations/keymgmt/mac_legacy_kmgmt.c
index b1c3880277..73af2071bf 100644
--- a/providers/implementations/keymgmt/mac_legacy_kmgmt.c
+++ b/providers/implementations/keymgmt/mac_legacy_kmgmt.c
@@ -26,7 +26,7 @@
 #include &quot;prov/providercommon.h&quot;
 #include &quot;prov/provider_ctx.h&quot;
 #include &quot;prov/macsignature.h&quot;
-#include &quot;e_os.h&quot; /* strcasecmp */
+#include &quot;internal/e_os.h&quot; /* strcasecmp */
 
 static OSSL_FUNC_keymgmt_new_fn mac_new;
 static OSSL_FUNC_keymgmt_free_fn mac_free;
diff --git a/providers/implementations/rands/drbg_ctr.c b/providers/implementations/rands/drbg_ctr.c
index dbe57b0d28..1384a43390 100644
--- a/providers/implementations/rands/drbg_ctr.c
+++ b/providers/implementations/rands/drbg_ctr.c
@@ -14,7 +14,7 @@
 #include &lt;openssl/rand.h&gt;
 #include &lt;openssl/aes.h&gt;
 #include &lt;openssl/proverr.h&gt;
-#include &quot;e_os.h&quot; /* strcasecmp */
+#include &quot;internal/e_os.h&quot; /* strcasecmp */
 #include &quot;crypto/modes.h&quot;
 #include &quot;internal/thread_once.h&quot;
 #include &quot;prov/implementations.h&quot;
diff --git a/providers/implementations/rands/seeding/rand_unix.c b/providers/implementations/rands/seeding/rand_unix.c
index f394927dae..6858d276cb 100644
--- a/providers/implementations/rands/seeding/rand_unix.c
+++ b/providers/implementations/rands/seeding/rand_unix.c
@@ -10,7 +10,7 @@
 #ifndef _GNU_SOURCE
 # define _GNU_SOURCE
 #endif
-#include &quot;../e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;stdio.h&gt;
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;openssl/rand.h&gt;
diff --git a/providers/implementations/rands/seeding/rand_vms.c b/providers/implementations/rands/seeding/rand_vms.c
index 30a97bf6e4..ed4f75855d 100644
--- a/providers/implementations/rands/seeding/rand_vms.c
+++ b/providers/implementations/rands/seeding/rand_vms.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 #define __NEW_STARLET 1         /* New starlet definitions since VMS 7.0 */
 #include &lt;unistd.h&gt;
diff --git a/providers/implementations/signature/rsa_sig.c b/providers/implementations/signature/rsa_sig.c
index 14741dee9d..f543bdb17a 100644
--- a/providers/implementations/signature/rsa_sig.c
+++ b/providers/implementations/signature/rsa_sig.c
@@ -13,7 +13,7 @@
  */
 #include &quot;internal/deprecated.h&quot;
 
-#include &quot;e_os.h&quot; /* strcasecmp */
+#include &quot;internal/e_os.h&quot; /* strcasecmp */
 #include &lt;string.h&gt;
 #include &lt;openssl/crypto.h&gt;
 #include &lt;openssl/core_dispatch.h&gt;
diff --git a/providers/implementations/storemgmt/file_store.c b/providers/implementations/storemgmt/file_store.c
index dc93f08b10..461b7e468d 100644
--- a/providers/implementations/storemgmt/file_store.c
+++ b/providers/implementations/storemgmt/file_store.c
@@ -9,7 +9,7 @@
 
 /* This file has quite some overlap with engines/e_loader_attic.c */
 
-#include &quot;e_os.h&quot;                /* To get strncasecmp() on Windows */
+#include &quot;internal/e_os.h&quot;                /* To get strncasecmp() on Windows */
 
 #include &lt;string.h&gt;
 #include &lt;sys/stat.h&gt;
diff --git a/ssl/d1_lib.c b/ssl/d1_lib.c
index 95a34093c9..baedf390f6 100644
--- a/ssl/d1_lib.c
+++ b/ssl/d1_lib.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;stdio.h&gt;
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/rand.h&gt;
diff --git a/ssl/ssl_init.c b/ssl/ssl_init.c
index e996a803e0..6a666ac0e7 100644
--- a/ssl/ssl_init.c
+++ b/ssl/ssl_init.c
@@ -7,7 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 #include &quot;internal/err.h&quot;
 #include &lt;openssl/crypto.h&gt;
diff --git a/ssl/ssl_lib.c b/ssl/ssl_lib.c
index cb7a52ab7e..9138cd659b 100644
--- a/ssl/ssl_lib.c
+++ b/ssl/ssl_lib.c
@@ -11,7 +11,7 @@
 
 #include &lt;stdio.h&gt;
 #include &quot;ssl_local.h&quot;
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/x509v3.h&gt;
 #include &lt;openssl/rand.h&gt;
diff --git a/ssl/ssl_local.h b/ssl/ssl_local.h
index 2c83505660..58a3e9e08a 100644
--- a/ssl/ssl_local.h
+++ b/ssl/ssl_local.h
@@ -12,7 +12,7 @@
 #ifndef OSSL_SSL_LOCAL_H
 # define OSSL_SSL_LOCAL_H
 
-# include &quot;e_os.h&quot;              /* struct timeval for DTLS */
+# include &quot;internal/e_os.h&quot;              /* struct timeval for DTLS */
 # include &lt;stdlib.h&gt;
 # include &lt;time.h&gt;
 # include &lt;errno.h&gt;
diff --git a/test/evp_extra_test.c b/test/evp_extra_test.c
index 05af89379f..caceb50fb6 100644
--- a/test/evp_extra_test.c
+++ b/test/evp_extra_test.c
@@ -35,7 +35,7 @@
 #include &quot;internal/nelem.h&quot;
 #include &quot;internal/sizes.h&quot;
 #include &quot;crypto/evp.h&quot;
-#include &quot;../e_os.h&quot; /* strcasecmp */
+#include &quot;internal/e_os.h&quot; /* strcasecmp */
 
 static OSSL_LIB_CTX *testctx = NULL;
 static char *testpropq = NULL;
diff --git a/test/evp_libctx_test.c b/test/evp_libctx_test.c
index e2663dc029..ada3bf01c8 100644
--- a/test/evp_libctx_test.c
+++ b/test/evp_libctx_test.c
@@ -33,7 +33,7 @@
 #include &quot;testutil.h&quot;
 #include &quot;internal/nelem.h&quot;
 #include &quot;crypto/bn_dh.h&quot;   /* _bignum_ffdhe2048_p */
-#include &quot;../e_os.h&quot;        /* strcasecmp */
+#include &quot;internal/e_os.h&quot;        /* strcasecmp */
 
 static OSSL_LIB_CTX *libctx = NULL;
 static OSSL_PROVIDER *nullprov = NULL;
diff --git a/test/evp_test.c b/test/evp_test.c
index 5e106c64f0..6c4e64c159 100644
--- a/test/evp_test.c
+++ b/test/evp_test.c
@@ -12,7 +12,7 @@
 #include &lt;string.h&gt;
 #include &lt;stdlib.h&gt;
 #include &lt;ctype.h&gt;
-#include &quot;../e_os.h&quot; /* strcasecmp and strncasecmp */
+#include &quot;internal/e_os.h&quot; /* strcasecmp and strncasecmp */
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/pem.h&gt;
 #include &lt;openssl/err.h&gt;
diff --git a/test/helpers/ssltestlib.c b/test/helpers/ssltestlib.c
index 795cff2660..7ece47edd6 100644
--- a/test/helpers/ssltestlib.c
+++ b/test/helpers/ssltestlib.c
@@ -12,7 +12,7 @@
 #include &quot;internal/nelem.h&quot;
 #include &quot;ssltestlib.h&quot;
 #include &quot;../testutil.h&quot;
-#include &quot;e_os.h&quot; /* for ossl_sleep() etc. */
+#include &quot;internal/e_os.h&quot; /* for ossl_sleep() etc. */
 
 #ifdef OPENSSL_SYS_UNIX
 # include &lt;unistd.h&gt;
diff --git a/test/p_test.c b/test/p_test.c
index 80f0784dd9..32a5e44117 100644
--- a/test/p_test.c
+++ b/test/p_test.c
@@ -26,7 +26,7 @@
 # define OSSL_provider_init PROVIDER_INIT_FUNCTION_NAME
 #endif
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 #include &lt;openssl/core.h&gt;
 #include &lt;openssl/core_dispatch.h&gt;
 #include &lt;openssl/err.h&gt;
diff --git a/test/secmemtest.c b/test/secmemtest.c
index d0f9ba2e99..2b0a163747 100644
--- a/test/secmemtest.c
+++ b/test/secmemtest.c
@@ -10,7 +10,7 @@
 #include &lt;openssl/crypto.h&gt;
 
 #include &quot;testutil.h&quot;
-#include &quot;../e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 static int test_sec_mem(void)
 {
diff --git a/test/ssl_old_test.c b/test/ssl_old_test.c
index e7ac6dfba4..1b1983b7c3 100644
--- a/test/ssl_old_test.c
+++ b/test/ssl_old_test.c
@@ -9,7 +9,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-#include &quot;e_os.h&quot;
+#include &quot;internal/e_os.h&quot;
 
 /* Or gethostname won't be declared properly on Linux and GNU platforms. */
 #ifndef _BSD_SOURCE
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="036196.html">[openssl]  master update
</A></li>
	<LI>Next message (by thread): <A HREF="036201.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36199">[ date ]</a>
              <a href="thread.html#36199">[ thread ]</a>
              <a href="subject.html#36199">[ subject ]</a>
              <a href="author.html#36199">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
