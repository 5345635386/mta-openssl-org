<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2016-June/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1465656477.504957.1221.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008042.html">
   <LINK REL="Next"  HREF="008080.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Kurt Roeckx</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1465656477.504957.1221.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">kurt at openssl.org
       </A><BR>
    <I>Sat Jun 11 14:47:57 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="008042.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="008080.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8072">[ date ]</a>
              <a href="thread.html#8072">[ thread ]</a>
              <a href="subject.html#8072">[ subject ]</a>
              <a href="author.html#8072">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  f3cf2251debba61b568416124736de1d5a7ddc8c (commit)
       via  0a3206539a41f48b24d107449779cdbf5104c1fc (commit)
       via  325cfa8531153641ca0ade876fd29ef482e973a8 (commit)
       via  4b68cb41d1c07ffd21a0fa5da811b1f0d45d7b16 (commit)
       via  8c918b7b9c93ba38790ffd1a83e23c3684e66f57 (commit)
       via  3892b95750b6aa5ed4328a287068f7cdfb9e55bc (commit)
      from  5000a6d1215ea7d6ed6179d0bcd44263f6e3c26b (commit)


- Log -----------------------------------------------------------------
commit f3cf2251debba61b568416124736de1d5a7ddc8c
Author: Kurt Roeckx &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">kurt at roeckx.be</A>&gt;
Date:   Mon Jun 6 22:50:25 2016 +0200

    Avoid creating illegal pointers
    
    Found by tis-interpreter
    
    Reviewed-by: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
    
    GH: #1179

commit 0a3206539a41f48b24d107449779cdbf5104c1fc
Author: Kurt Roeckx &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">kurt at roeckx.be</A>&gt;
Date:   Sun Jun 5 20:51:04 2016 +0200

    include stdlib for malloc() and free()
    
    Reviewed-by: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
    
    GH: #1174

commit 325cfa8531153641ca0ade876fd29ef482e973a8
Author: Kurt Roeckx &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">kurt at roeckx.be</A>&gt;
Date:   Sun Jun 5 20:48:08 2016 +0200

    Don't compare a just free()d pointer
    
    Found by tis-interpreter
    
    Reviewed-by: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
    
    GH: #1173

commit 4b68cb41d1c07ffd21a0fa5da811b1f0d45d7b16
Author: Kurt Roeckx &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">kurt at roeckx.be</A>&gt;
Date:   Sun Jun 5 14:13:33 2016 +0200

    Specify array sizes
    
    Reviewed-by: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
    
    GH: #1172

commit 8c918b7b9c93ba38790ffd1a83e23c3684e66f57
Author: Kurt Roeckx &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">kurt at roeckx.be</A>&gt;
Date:   Sat Jun 4 19:52:28 2016 +0200

    Avoid creating an illegal pointer.
    
    Found by tis-interpreter
    
    Reviewed-by: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
    
    GH: #1166

commit 3892b95750b6aa5ed4328a287068f7cdfb9e55bc
Author: Kurt Roeckx &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">kurt at roeckx.be</A>&gt;
Date:   Sat Jun 4 16:25:39 2016 +0200

    Avoid creating an illegal pointer
    
    Found by tis-interpreter
    
    Reviewed-by: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
    
    GH: #1164

-----------------------------------------------------------------------

Summary of changes:
 crypto/asn1/asn1_par.c  |  3 +--
 crypto/bn/bn_lib.c      | 12 +++++++-----
 crypto/ct/ct_locl.h     |  2 +-
 crypto/ct/ct_x509v3.c   |  2 +-
 crypto/x509/x_name.c    |  4 ++--
 crypto/x509v3/ext_dat.h |  4 ++--
 crypto/x509v3/v3_alt.c  |  2 +-
 crypto/x509v3/v3_ia5.c  |  2 +-
 fuzz/driver.c           |  1 +
 ssl/ssl_lib.c           |  2 +-
 10 files changed, 18 insertions(+), 16 deletions(-)

diff --git a/crypto/asn1/asn1_par.c b/crypto/asn1/asn1_par.c
index 51da014..1e17895 100644
--- a/crypto/asn1/asn1_par.c
+++ b/crypto/asn1/asn1_par.c
@@ -86,8 +86,7 @@ static int asn1_parse2(BIO *bp, const unsigned char **pp, long length,
     dump_indent = 6;            /* Because we know BIO_dump_indent() */
     p = *pp;
     tot = p + length;
-    op = p - 1;
-    while ((p &lt; tot) &amp;&amp; (op &lt; p)) {
+    while (length &gt; 0) {
         op = p;
         j = ASN1_get_object(&amp;p, &amp;len, &amp;tag, &amp;xclass, length);
         if (j &amp; 0x80) {
diff --git a/crypto/bn/bn_lib.c b/crypto/bn/bn_lib.c
index ccdefb3..90df3ee 100644
--- a/crypto/bn/bn_lib.c
+++ b/crypto/bn/bn_lib.c
@@ -565,9 +565,9 @@ BIGNUM *BN_lebin2bn(const unsigned char *s, int len, BIGNUM *ret)
     if (ret == NULL)
         return (NULL);
     bn_check_top(ret);
-    s += len - 1;
+    s += len;
     /* Skip trailing zeroes. */
-    for ( ; len &gt; 0 &amp;&amp; *s == 0; s--, len--)
+    for ( ; len &gt; 0 &amp;&amp; s[-1] == 0; s--, len--)
         continue;
     n = len;
     if (n == 0) {
@@ -584,7 +584,8 @@ BIGNUM *BN_lebin2bn(const unsigned char *s, int len, BIGNUM *ret)
     ret-&gt;neg = 0;
     l = 0;
     while (n--) {
-        l = (l &lt;&lt; 8L) | *(s--);
+        s--;
+        l = (l &lt;&lt; 8L) | *s;
         if (m-- == 0) {
             ret-&gt;d[--i] = l;
             l = 0;
@@ -610,10 +611,11 @@ int BN_bn2lebinpad(const BIGNUM *a, unsigned char *to, int tolen)
     /* Add trailing zeroes if necessary */
     if (tolen &gt; i)
         memset(to + i, 0, tolen - i);
-    to += i - 1;
+    to += i;
     while (i--) {
         l = a-&gt;d[i / BN_BYTES];
-        *(to--) = (unsigned char)(l &gt;&gt; (8 * (i % BN_BYTES))) &amp; 0xff;
+        to--;
+        *to = (unsigned char)(l &gt;&gt; (8 * (i % BN_BYTES))) &amp; 0xff;
     }
     return tolen;
 }
diff --git a/crypto/ct/ct_locl.h b/crypto/ct/ct_locl.h
index e3ef4b7..1180455 100644
--- a/crypto/ct/ct_locl.h
+++ b/crypto/ct/ct_locl.h
@@ -168,4 +168,4 @@ __owur int SCT_signature_is_complete(const SCT *sct);
 /*
  * Handlers for Certificate Transparency X509v3/OCSP extensions
  */
-extern const X509V3_EXT_METHOD v3_ct_scts[];
+extern const X509V3_EXT_METHOD v3_ct_scts[3];
diff --git a/crypto/ct/ct_x509v3.c b/crypto/ct/ct_x509v3.c
index 4298e1e..805ada0 100644
--- a/crypto/ct/ct_x509v3.c
+++ b/crypto/ct/ct_x509v3.c
@@ -31,7 +31,7 @@ static int i2r_SCT_LIST(X509V3_EXT_METHOD *method, STACK_OF(SCT) *sct_list,
 }
 
 /* Handlers for X509v3/OCSP Certificate Transparency extensions */
-const X509V3_EXT_METHOD v3_ct_scts[] = {
+const X509V3_EXT_METHOD v3_ct_scts[3] = {
     /* X509v3 extension in certificates that contains SCTs */
     { NID_ct_precert_scts, 0, NULL,
     NULL, (X509V3_EXT_FREE)SCT_LIST_free,
diff --git a/crypto/x509/x_name.c b/crypto/x509/x_name.c
index f0b35fb..5c624cb 100644
--- a/crypto/x509/x_name.c
+++ b/crypto/x509/x_name.c
@@ -396,10 +396,10 @@ static int asn1_string_canon(ASN1_STRING *out, ASN1_STRING *in)
         len--;
     }
 
-    to = from + len - 1;
+    to = from + len;
 
     /* Ignore trailing spaces */
-    while ((len &gt; 0) &amp;&amp; !(*to &amp; 0x80) &amp;&amp; isspace(*to)) {
+    while ((len &gt; 0) &amp;&amp; !(to[-1] &amp; 0x80) &amp;&amp; isspace(to[-1])) {
         to--;
         len--;
     }
diff --git a/crypto/x509v3/ext_dat.h b/crypto/x509v3/ext_dat.h
index 332cb87..c9ede96 100644
--- a/crypto/x509v3/ext_dat.h
+++ b/crypto/x509v3/ext_dat.h
@@ -11,7 +11,7 @@ int name_cmp(const char *name, const char *cmp);
 
 extern const X509V3_EXT_METHOD v3_bcons, v3_nscert, v3_key_usage, v3_ext_ku;
 extern const X509V3_EXT_METHOD v3_pkey_usage_period, v3_sxnet, v3_info, v3_sinfo;
-extern const X509V3_EXT_METHOD v3_ns_ia5_list[], v3_alt[], v3_skey_id, v3_akey_id;
+extern const X509V3_EXT_METHOD v3_ns_ia5_list[8], v3_alt[3], v3_skey_id, v3_akey_id;
 extern const X509V3_EXT_METHOD v3_crl_num, v3_crl_reason, v3_crl_invdate;
 extern const X509V3_EXT_METHOD v3_delta_crl, v3_cpols, v3_crld, v3_freshest_crl;
 extern const X509V3_EXT_METHOD v3_ocsp_nonce, v3_ocsp_accresp, v3_ocsp_acutoff;
@@ -20,5 +20,5 @@ extern const X509V3_EXT_METHOD v3_crl_hold, v3_pci;
 extern const X509V3_EXT_METHOD v3_policy_mappings, v3_policy_constraints;
 extern const X509V3_EXT_METHOD v3_name_constraints, v3_inhibit_anyp, v3_idp;
 extern const X509V3_EXT_METHOD v3_addr, v3_asid;
-extern const X509V3_EXT_METHOD v3_ct_scts[];
+extern const X509V3_EXT_METHOD v3_ct_scts[3];
 extern const X509V3_EXT_METHOD v3_tls_feature;
diff --git a/crypto/x509v3/v3_alt.c b/crypto/x509v3/v3_alt.c
index 05dfe36..7778029 100644
--- a/crypto/x509v3/v3_alt.c
+++ b/crypto/x509v3/v3_alt.c
@@ -24,7 +24,7 @@ static int copy_issuer(X509V3_CTX *ctx, GENERAL_NAMES *gens);
 static int do_othername(GENERAL_NAME *gen, char *value, X509V3_CTX *ctx);
 static int do_dirname(GENERAL_NAME *gen, char *value, X509V3_CTX *ctx);
 
-const X509V3_EXT_METHOD v3_alt[] = {
+const X509V3_EXT_METHOD v3_alt[3] = {
     {NID_subject_alt_name, 0, ASN1_ITEM_ref(GENERAL_NAMES),
      0, 0, 0, 0,
      0, 0,
diff --git a/crypto/x509v3/v3_ia5.c b/crypto/x509v3/v3_ia5.c
index 5e230df..c1170d4 100644
--- a/crypto/x509v3/v3_ia5.c
+++ b/crypto/x509v3/v3_ia5.c
@@ -14,7 +14,7 @@
 #include &lt;openssl/x509v3.h&gt;
 #include &quot;ext_dat.h&quot;
 
-const X509V3_EXT_METHOD v3_ns_ia5_list[] = {
+const X509V3_EXT_METHOD v3_ns_ia5_list[8] = {
     EXT_IA5STRING(NID_netscape_base_url),
     EXT_IA5STRING(NID_netscape_revocation_url),
     EXT_IA5STRING(NID_netscape_ca_revocation_url),
diff --git a/fuzz/driver.c b/fuzz/driver.c
index de51574..c530fed 100644
--- a/fuzz/driver.c
+++ b/fuzz/driver.c
@@ -9,6 +9,7 @@
  */
 #include &lt;stdint.h&gt;
 #include &lt;unistd.h&gt;
+#include &lt;stdlib.h&gt;
 #include &lt;openssl/opensslconf.h&gt;
 #include &quot;fuzzer.h&quot;
 
diff --git a/ssl/ssl_lib.c b/ssl/ssl_lib.c
index d4b8335..359260e 100644
--- a/ssl/ssl_lib.c
+++ b/ssl/ssl_lib.c
@@ -948,9 +948,9 @@ void SSL_free(SSL *s)
         BIO_free(s-&gt;bbio);
         s-&gt;bbio = NULL;
     }
-    BIO_free_all(s-&gt;rbio);
     if (s-&gt;wbio != s-&gt;rbio)
         BIO_free_all(s-&gt;wbio);
+    BIO_free_all(s-&gt;rbio);
 
     BUF_MEM_free(s-&gt;init_buf);
 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008042.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="008080.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8072">[ date ]</a>
              <a href="thread.html#8072">[ thread ]</a>
              <a href="subject.html#8072">[ subject ]</a>
              <a href="author.html#8072">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
