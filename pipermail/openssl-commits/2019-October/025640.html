<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2019-October/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1571140074.575291.18800.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025630.html">
   <LINK REL="Next"  HREF="025642.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl]  master update</H1>
    <B>tmraz at fedoraproject.org</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1571140074.575291.18800.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl]  master update">tmraz at fedoraproject.org
       </A><BR>
    <I>Tue Oct 15 11:47:54 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="025630.html">[openssl]  master update
</A></li>
        <LI>Next message: <A HREF="025642.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25640">[ date ]</a>
              <a href="thread.html#25640">[ thread ]</a>
              <a href="subject.html#25640">[ subject ]</a>
              <a href="author.html#25640">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  a397aca43598ef20c84e69f6d6e5d95652aa0325 (commit)
      from  a9b5929d5686b4beef232e0f679dbae6a059f70a (commit)


- Log -----------------------------------------------------------------
commit a397aca43598ef20c84e69f6d6e5d95652aa0325
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at akamai.com</A>&gt;
Date:   Thu Oct 3 22:28:40 2019 -0400

    Refactor many common flags into openssl.pod
    
    Options moved: -rand, -writerand, -CApath, -CAfile, -no-CApath, -no-CAfile
    Added rand to dgst and srp manpages (they were missing them).
    New sections in openssl.pod: Random State Options, Trusted Certificate
    Options.
    Cleanup and add comments to find-doc-nits
    Remove &quot;.in&quot; file support; unless giving specific arguments, this
    only runs after configuration
    
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tmraz at fedoraproject.org</A>&gt;
    Reviewed-by: Dmitry Belyavskiy &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">beldmit at gmail.com</A>&gt;
    Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/10118">https://github.com/openssl/openssl/pull/10118</A>)

-----------------------------------------------------------------------

Summary of changes:
 doc/man1/openssl-ca.pod       |  12 +---
 doc/man1/openssl-cms.pod      |  31 ++-------
 doc/man1/openssl-crl.pod      |  14 ++--
 doc/man1/openssl-dgst.pod     |  13 +---
 doc/man1/openssl-dhparam.pod  |  12 +---
 doc/man1/openssl-dsaparam.pod |  12 +---
 doc/man1/openssl-ecparam.pod  |  12 +---
 doc/man1/openssl-enc.pod      |  12 +---
 doc/man1/openssl-gendsa.pod   |  12 +---
 doc/man1/openssl-genrsa.pod   |  12 +---
 doc/man1/openssl-ocsp.pod     |  13 +---
 doc/man1/openssl-passwd.pod   |  12 +---
 doc/man1/openssl-pkcs12.pod   |  30 ++-------
 doc/man1/openssl-pkcs8.pod    |  12 +---
 doc/man1/openssl-pkeyutl.pod  |  12 +---
 doc/man1/openssl-rand.pod     |  18 +-----
 doc/man1/openssl-req.pod      |  12 +---
 doc/man1/openssl-rsautl.pod   |  12 +---
 doc/man1/openssl-s_client.pod |  31 ++-------
 doc/man1/openssl-s_server.pod |  33 ++--------
 doc/man1/openssl-s_time.pod   |  13 +---
 doc/man1/openssl-smime.pod    |  31 ++-------
 doc/man1/openssl-speed.pod    |  12 +---
 doc/man1/openssl-srp.pod      |   6 ++
 doc/man1/openssl-ts.pod       |  27 ++------
 doc/man1/openssl-verify.pod   |  21 +-----
 doc/man1/openssl-x509.pod     |  12 +---
 doc/man1/openssl.pod          |  75 +++++++++++++++++++++
 doc/man1/tsget.pod            |   4 +-
 util/find-doc-nits            | 147 +++++++++++++++++++++---------------------
 30 files changed, 225 insertions(+), 450 deletions(-)

diff --git a/doc/man1/openssl-ca.pod b/doc/man1/openssl-ca.pod
index e51e5dda6f..5ff5fd954c 100644
--- a/doc/man1/openssl-ca.pod
+++ b/doc/man1/openssl-ca.pod
@@ -294,17 +294,9 @@ C&lt;/DC=org/DC=OpenSSL/DC=users/UID=123456+CN=John Doe&gt;
 
 If B&lt;-multi-rdn&gt; is not used then the UID value is C&lt;123456+CN=John Doe&gt;.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-sm2-id&gt; I&lt;string&gt;
 
diff --git a/doc/man1/openssl-cms.pod b/doc/man1/openssl-cms.pod
index 507490498c..54620fef32 100644
--- a/doc/man1/openssl-cms.pod
+++ b/doc/man1/openssl-cms.pod
@@ -285,24 +285,9 @@ structure is being checked.
 For the B&lt;-cmsout&gt; operation print out all fields of the CMS structure. This
 is mainly useful for testing purposes.
 
-=item B&lt;-CAfile&gt; I&lt;file&gt;
+=item B&lt;-CAfile&gt; I&lt;file&gt;, B&lt;-no-CAfile&gt;, B&lt;-CApath&gt; I&lt;dir&gt;, B&lt;-no-CApath&gt;
 
-A file containing trusted CA certificates, only used with B&lt;-verify&gt;.
-
-=item B&lt;-CApath&gt; I&lt;dir&gt;
-
-A directory containing trusted CA certificates, only used with
-B&lt;-verify&gt;. This directory must be a standard certificate directory: that
-is a hash of each subject name (using C&lt;x509 -hash&gt;) should be linked
-to each certificate.
-
-=item B&lt;-no-CAfile&gt;
-
-Do not load the trusted CA certificates from the default file location
-
-=item B&lt;-no-CApath&gt;
-
-Do not load the trusted CA certificates from the default directory location
+See L&lt;openssl(1)/Trusted Certificate Options&gt; for more information.
 
 =item B&lt;-md&gt; I&lt;digest&gt;
 
@@ -476,17 +461,9 @@ or to modify default parameters for ECDH.
 The private key password source. For more information about the format of B&lt;arg&gt;
 see L&lt;openssl(1)/Pass Phrase Options&gt;.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
-
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item I&lt;cert.pem&gt; ...
 
diff --git a/doc/man1/openssl-crl.pod b/doc/man1/openssl-crl.pod
index fa29d4b0c4..9e5f6ca7c0 100644
--- a/doc/man1/openssl-crl.pod
+++ b/doc/man1/openssl-crl.pod
@@ -21,6 +21,8 @@ B&lt;openssl&gt; B&lt;crl&gt;
 [B&lt;-nextupdate&gt;]
 [B&lt;-CAfile&gt; I&lt;file&gt;]
 [B&lt;-CApath&gt; I&lt;dir&gt;]
+[B&lt;-no-CAfile&gt;]
+[B&lt;-no-CApath&gt;]
 
 =for openssl ifdef hash_old
 
@@ -92,17 +94,9 @@ Output the lastUpdate field.
 
 Output the nextUpdate field.
 
-=item B&lt;-CAfile&gt; I&lt;file&gt;
+=item B&lt;-CAfile&gt; I&lt;file&gt;, B&lt;-no-CAfile&gt;, B&lt;-CApath&gt; I&lt;dir&gt;, B&lt;-no-CApath&gt;
 
-Verify the signature on a CRL by looking up the issuing certificate in
-I&lt;file&gt;.
-
-=item B&lt;-CApath&gt; I&lt;dir&gt;
-
-Verify the signature on a CRL by looking up the issuing certificate in
-I&lt;dir&gt;. This directory must be a standard certificate directory: that
-is a hash of each subject name (using the L&lt;openssl-x509(1)&gt; B&lt;-hash&gt; option)
-should be linked to each certificate.
+See L&lt;openssl(1)/Trusted Certificate Options&gt; for more information.
 
 =back
 
diff --git a/doc/man1/openssl-dgst.pod b/doc/man1/openssl-dgst.pod
index b2da9229cf..7859d75da7 100644
--- a/doc/man1/openssl-dgst.pod
+++ b/doc/man1/openssl-dgst.pod
@@ -25,6 +25,7 @@ B&lt;openssl&gt; B&lt;dgst&gt;|I&lt;digest&gt;
 [B&lt;-hmac&gt; I&lt;key&gt;]
 [B&lt;-fips-fingerprint&gt;]
 [B&lt;-rand&gt; I&lt;files&gt;]
+[B&lt;-writerand&gt; I&lt;file&gt;]
 [B&lt;-engine&gt; I&lt;id&gt;]
 [B&lt;-engine_impl&gt;]
 [I&lt;file&gt; ...]
@@ -158,17 +159,9 @@ for example exactly 32 chars for gost-mac.
 The L&lt;openssl-mac(1)&gt; command should be preferred to using this command line
 option.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-fips-fingerprint&gt;
 
diff --git a/doc/man1/openssl-dhparam.pod b/doc/man1/openssl-dhparam.pod
index c7929e8126..a28d1b81f8 100644
--- a/doc/man1/openssl-dhparam.pod
+++ b/doc/man1/openssl-dhparam.pod
@@ -86,17 +86,9 @@ input file is ignored and parameters are generated instead. If not
 present but I&lt;numbits&gt; is present, parameters are generated with the
 default generator 2.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item I&lt;numbits&gt;
 
diff --git a/doc/man1/openssl-dsaparam.pod b/doc/man1/openssl-dsaparam.pod
index cc5570f333..5c145ef1fb 100644
--- a/doc/man1/openssl-dsaparam.pod
+++ b/doc/man1/openssl-dsaparam.pod
@@ -76,17 +76,9 @@ be loaded by calling the get_dsaXXX() function.
 This option will generate a DSA either using the specified or generated
 parameters.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-engine&gt; I&lt;id&gt;
 
diff --git a/doc/man1/openssl-ecparam.pod b/doc/man1/openssl-ecparam.pod
index e52d1833e1..09c6927320 100644
--- a/doc/man1/openssl-ecparam.pod
+++ b/doc/man1/openssl-ecparam.pod
@@ -124,17 +124,9 @@ is included in the ECParameters structure (see RFC 3279).
 
 This option will generate an EC private key using the specified parameters.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-engine&gt; I&lt;id&gt;
 
diff --git a/doc/man1/openssl-enc.pod b/doc/man1/openssl-enc.pod
index 99486ee152..592e4f5764 100644
--- a/doc/man1/openssl-enc.pod
+++ b/doc/man1/openssl-enc.pod
@@ -185,17 +185,9 @@ or zlib-dynamic option.
 
 Use NULL cipher (no encryption or decryption of input).
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =back
 
diff --git a/doc/man1/openssl-gendsa.pod b/doc/man1/openssl-gendsa.pod
index 62fc25089e..451a3c4835 100644
--- a/doc/man1/openssl-gendsa.pod
+++ b/doc/man1/openssl-gendsa.pod
@@ -53,17 +53,9 @@ These options encrypt the private key with specified
 cipher before outputting it. A pass phrase is prompted for.
 If none of these options is specified no encryption is used.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-engine&gt; I&lt;id&gt;
 
diff --git a/doc/man1/openssl-genrsa.pod b/doc/man1/openssl-genrsa.pod
index 2b3c5c303f..d04c8eeb19 100644
--- a/doc/man1/openssl-genrsa.pod
+++ b/doc/man1/openssl-genrsa.pod
@@ -65,17 +65,9 @@ for if it is not supplied via the B&lt;-passout&gt; argument.
 
 The public exponent to use, either 65537 or 3. The default is 65537.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-engine&gt; I&lt;id&gt;
 
diff --git a/doc/man1/openssl-ocsp.pod b/doc/man1/openssl-ocsp.pod
index 5e75e6af53..6fc077506f 100644
--- a/doc/man1/openssl-ocsp.pod
+++ b/doc/man1/openssl-ocsp.pod
@@ -207,18 +207,9 @@ each child is willing to wait for the client's OCSP response.
 This option is available on POSIX systems (that support the fork() and other
 required unix system-calls).
 
-=item B&lt;-CAfile&gt; I&lt;file&gt;, B&lt;-CApath&gt; I&lt;pathname&gt;
+=item B&lt;-CAfile&gt; I&lt;file&gt;, B&lt;-no-CAfile&gt;, B&lt;-CApath&gt; I&lt;dir&gt;, B&lt;-no-CApath&gt;
 
-File or pathname containing trusted CA certificates. These are used to verify
-the signature on the OCSP response.
-
-=item B&lt;-no-CAfile&gt;
-
-Do not load the trusted CA certificates from the default file location
-
-=item B&lt;-no-CApath&gt;
-
-Do not load the trusted CA certificates from the default directory location
+See L&lt;openssl(1)/Trusted Certificate Options&gt; for more information.
 
 =item B&lt;-attime&gt;, B&lt;-check_ss_sig&gt;, B&lt;-crl_check&gt;, B&lt;-crl_check_all&gt;,
 B&lt;-explicit_policy&gt;, B&lt;-extended_crl&gt;, B&lt;-ignore_critical&gt;, B&lt;-inhibit_any&gt;,
diff --git a/doc/man1/openssl-passwd.pod b/doc/man1/openssl-passwd.pod
index c1daac17ab..e7502ae332 100644
--- a/doc/man1/openssl-passwd.pod
+++ b/doc/man1/openssl-passwd.pod
@@ -93,17 +93,9 @@ Don't output warnings when passwords given at the command line are truncated.
 In the output list, prepend the cleartext password and a TAB character
 to each password hash.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =back
 
diff --git a/doc/man1/openssl-pkcs12.pod b/doc/man1/openssl-pkcs12.pod
index 412438285f..5742549891 100644
--- a/doc/man1/openssl-pkcs12.pod
+++ b/doc/man1/openssl-pkcs12.pod
@@ -263,35 +263,13 @@ to be needed to use MAC iterations counts but they are now used by default.
 
 Don't attempt to provide the MAC integrity.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
-=item B&lt;-writerand&gt; I&lt;file&gt;
+=item B&lt;-CAfile&gt; I&lt;file&gt;, B&lt;-no-CAfile&gt;, B&lt;-CApath&gt; I&lt;dir&gt;, B&lt;-no-CApath&gt;
 
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
-
-=item B&lt;-CAfile&gt; I&lt;file&gt;
-
-CA storage as a file.
-
-=item B&lt;-CApath&gt; I&lt;dir&gt;
-
-CA storage as a directory. This directory must be a standard certificate
-directory: that is a hash of each subject name (using C&lt;openssl x509 -hash&gt;)
-should be linked to each certificate.
-
-=item B&lt;-no-CAfile&gt;
-
-Do not load the trusted CA certificates from the default file location.
-
-=item B&lt;-no-CApath&gt;
-
-Do not load the trusted CA certificates from the default directory location.
+See L&lt;openssl(1)/Trusted Certificate Options&gt; for more information.
 
 =item B&lt;-CSP&gt; I&lt;name&gt;
 
diff --git a/doc/man1/openssl-pkcs8.pod b/doc/man1/openssl-pkcs8.pod
index 01c13487b6..e3d779a165 100644
--- a/doc/man1/openssl-pkcs8.pod
+++ b/doc/man1/openssl-pkcs8.pod
@@ -101,17 +101,9 @@ This option does not encrypt private keys at all and should only be used
 when absolutely necessary. Certain software such as some versions of Java
 code signing software used unencrypted private keys.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-v2&gt; I&lt;alg&gt;
 
diff --git a/doc/man1/openssl-pkeyutl.pod b/doc/man1/openssl-pkeyutl.pod
index 6ad2306421..58c90436b8 100644
--- a/doc/man1/openssl-pkeyutl.pod
+++ b/doc/man1/openssl-pkeyutl.pod
@@ -177,17 +177,9 @@ hex dump the output data.
 Parse the ASN.1 output data, this is useful when combined with the
 B&lt;-verifyrecover&gt; option when an ASN1 structure is signed.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-engine&gt; I&lt;id&gt;
 
diff --git a/doc/man1/openssl-rand.pod b/doc/man1/openssl-rand.pod
index f63859e304..c32b10242e 100644
--- a/doc/man1/openssl-rand.pod
+++ b/doc/man1/openssl-rand.pod
@@ -20,11 +20,7 @@ I&lt;num&gt;
 =head1 DESCRIPTION
 
 This command outputs I&lt;num&gt; pseudo-random bytes after seeding
-the random number generator once.  As in other B&lt;openssl&gt; command
-line tools, PRNG seeding uses the file F&lt;$HOME/.rnd&gt; or F&lt;.rnd&gt;
-in addition to the files given in the B&lt;-rand&gt; option.  A new
-F&lt;$HOME/.rnd&gt; or F&lt;.rnd&gt; file will be written back if enough
-seeding was obtained from these sources.
+the random number generator once.
 
 =head1 OPTIONS
 
@@ -38,17 +34,9 @@ Print out a usage message.
 
 Write to I&lt;file&gt; instead of standard output.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-base64&gt;
 
diff --git a/doc/man1/openssl-req.pod b/doc/man1/openssl-req.pod
index 13f6257492..b84a4c92ab 100644
--- a/doc/man1/openssl-req.pod
+++ b/doc/man1/openssl-req.pod
@@ -137,17 +137,9 @@ in the configuration file and any requested extensions.
 If the B&lt;-key&gt; option is not used it will generate a new RSA private
 key using information specified in the configuration file.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-newkey&gt; I&lt;arg&gt;
 
diff --git a/doc/man1/openssl-rsautl.pod b/doc/man1/openssl-rsautl.pod
index 508237364c..0b5fc73830 100644
--- a/doc/man1/openssl-rsautl.pod
+++ b/doc/man1/openssl-rsautl.pod
@@ -84,17 +84,9 @@ Encrypt the input data using an RSA public key.
 
 Decrypt the input data using an RSA private key.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-pkcs&gt;, B&lt;-oaep&gt;, B&lt;-ssl&gt;, B&lt;-raw&gt;
 
diff --git a/doc/man1/openssl-s_client.pod b/doc/man1/openssl-s_client.pod
index b7021cdf9a..0bb8781947 100644
--- a/doc/man1/openssl-s_client.pod
+++ b/doc/man1/openssl-s_client.pod
@@ -306,16 +306,9 @@ I&lt;option&gt; argument can be a single option or multiple options separated by
 commas.  Alternatively the B&lt;-nameopt&gt; switch may be used more than once to
 set multiple options. See the L&lt;openssl-x509(1)&gt; manual page for details.
 
-=item B&lt;-CApath&gt; I&lt;directory&gt;
+=item B&lt;-CAfile&gt; I&lt;file&gt;, B&lt;-no-CAfile&gt;, B&lt;-CApath&gt; I&lt;dir&gt;, B&lt;-no-CApath&gt;
 
-The directory to use for server certificate verification. This directory
-must be in &quot;hash format&quot;, see L&lt;openssl-verify(1)&gt; for more information.
-These are also used when building the client certificate chain.
-
-=item B&lt;-CAfile&gt; I&lt;file&gt;
-
-A file containing trusted certificates to use during server authentication
-and to use when attempting to build the client certificate chain.
+See L&lt;openssl(1)/Trusted Certificate Options&gt; for more information.
 
 =item B&lt;-chainCApath&gt; I&lt;directory&gt;
 
@@ -328,14 +321,6 @@ information.
 A file containing trusted certificates to use when attempting to build the
 client certificate chain.
 
-=item B&lt;-no-CAfile&gt;
-
-Do not load the trusted CA certificates from the default file location
-
-=item B&lt;-no-CApath&gt;
-
-Do not load the trusted CA certificates from the default directory location
-
 =item B&lt;-requestCAfile&gt; I&lt;file&gt;
 
 A file containing a list of certificates whose subject names will be sent
@@ -674,17 +659,9 @@ to attempt to obtain a functional reference to the specified engine,
 thus initialising it if needed. The engine will then be set as the default
 for all available algorithms.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
-
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-serverinfo&gt; I&lt;types&gt;
 
diff --git a/doc/man1/openssl-s_server.pod b/doc/man1/openssl-s_server.pod
index d035f5e4fd..5cbfeb0f5e 100644
--- a/doc/man1/openssl-s_server.pod
+++ b/doc/man1/openssl-s_server.pod
@@ -370,18 +370,9 @@ File to send output of B&lt;-msg&gt; or B&lt;-trace&gt; to, default standard output.
 
 Prints the SSL session states.
 
-=item B&lt;-CAfile&gt; I&lt;infile&gt;
+=item B&lt;-CAfile&gt; I&lt;file&gt;, B&lt;-no-CAfile&gt;, B&lt;-CApath&gt; I&lt;dir&gt;, B&lt;-no-CApath&gt;
 
-A file containing trusted certificates to use during client authentication
-and to use when attempting to build the server certificate chain. The list
-is also used in the list of acceptable client CAs passed to the client when
-a certificate is requested.
-
-=item B&lt;-CApath&gt; I&lt;dir&gt;
-
-The directory to use for client certificate verification. This directory
-must be in &quot;hash format&quot;, see L&lt;openssl-verify(1)&gt; for more information.
-These are also used when building the server certificate chain.
+See L&lt;openssl(1)/Trusted Certificate Options&gt; for more information.
 
 =item B&lt;-chainCApath&gt; I&lt;dir&gt;
 
@@ -394,14 +385,6 @@ information.
 A file containing trusted certificates to use when attempting to build the
 server certificate chain.
 
-=item B&lt;-no-CAfile&gt;
-
-Do not load the trusted CA certificates from the default file location.
-
-=item B&lt;-no-CApath&gt;
-
-Do not load the trusted CA certificates from the default directory location.
-
 =item B&lt;-nocert&gt;
 
 If this option is set then no certificate is used. This restricts the
@@ -446,17 +429,9 @@ for testing any SSL/TLS code (eg. proxies) that wish to deal with multiple
 servers, when each of which might be generating a unique range of session
 IDs (eg. with a certain prefix).
 
-=item B&lt;-rand&gt; I&lt;files&gt;
-
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-verify_return_error&gt;
 
diff --git a/doc/man1/openssl-s_time.pod b/doc/man1/openssl-s_time.pod
index 4af9e84a60..f5126dae54 100644
--- a/doc/man1/openssl-s_time.pod
+++ b/doc/man1/openssl-s_time.pod
@@ -91,18 +91,9 @@ The directory to use for server certificate verification. This directory
 must be in &quot;hash format&quot;, see L&lt;openssl-verify(1)&gt; for more information.
 These are also used when building the client certificate chain.
 
-=item B&lt;-CAfile&gt; I&lt;file&gt;
+=item B&lt;-CAfile&gt; I&lt;file&gt;, B&lt;-no-CAfile&gt;, B&lt;-CApath&gt; I&lt;dir&gt;, B&lt;-no-CApath&gt;
 
-A file containing trusted certificates to use during server authentication
-and to use when attempting to build the client certificate chain.
-
-=item B&lt;-no-CAfile&gt;
-
-Do not load the trusted CA certificates from the default file location
-
-=item B&lt;-no-CApath&gt;
-
-Do not load the trusted CA certificates from the default directory location
+See L&lt;openssl(1)/Trusted Certificate Options&gt; for more information.
 
 =item B&lt;-new&gt;
 
diff --git a/doc/man1/openssl-smime.pod b/doc/man1/openssl-smime.pod
index b8cb7cd635..ac377160a3 100644
--- a/doc/man1/openssl-smime.pod
+++ b/doc/man1/openssl-smime.pod
@@ -179,24 +179,9 @@ message if encrypting or signing. If decrypting or verifying it strips
 off text headers: if the decrypted or verified message is not of MIME
 type text/plain then an error occurs.
 
-=item B&lt;-CAfile&gt; I&lt;file&gt;
+=item B&lt;-CAfile&gt; I&lt;file&gt;, B&lt;-no-CAfile&gt;, B&lt;-CApath&gt; I&lt;dir&gt;, B&lt;-no-CApath&gt;
 
-A file containing trusted CA certificates, only used with B&lt;-verify&gt;.
-
-=item B&lt;-CApath&gt; I&lt;dir&gt;
-
-A directory containing trusted CA certificates, only used with
-B&lt;-verify&gt;. This directory must be a standard certificate directory: that
-is a hash of each subject name (using C&lt;openssl x509 -hash&gt;) should be linked
-to each certificate.
-
-=item B&lt;-no-CAfile&gt;
-
-Do not load the trusted CA certificates from the default file location.
-
-=item B&lt;-no-CApath&gt;
-
-Do not load the trusted CA certificates from the default directory location.
+See L&lt;openssl(1)/Trusted Certificate Options&gt; for more information.
 
 =item B&lt;-md&gt; I&lt;digest&gt;
 
@@ -298,17 +283,9 @@ specified, the argument is given to the engine as a key identifier.
 The private key password source. For more information about the format of I&lt;arg&gt;
 see L&lt;openssl(1)/Pass Phrase Options&gt;.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
-
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-to&gt;, B&lt;-from&gt;, B&lt;-subject&gt;
 
diff --git a/doc/man1/openssl-speed.pod b/doc/man1/openssl-speed.pod
index d227b0235c..e818bf6666 100644
--- a/doc/man1/openssl-speed.pod
+++ b/doc/man1/openssl-speed.pod
@@ -71,17 +71,9 @@ C&lt;openssl speed -cmac aes128&gt;.
 
 Time the decryption instead of encryption. Affects only the EVP testing.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-primes&gt; I&lt;num&gt;
 
diff --git a/doc/man1/openssl-srp.pod b/doc/man1/openssl-srp.pod
index 9096499750..65443c25cf 100644
--- a/doc/man1/openssl-srp.pod
+++ b/doc/man1/openssl-srp.pod
@@ -20,6 +20,8 @@ B&lt;openssl srp&gt;
 [B&lt;-userinfo&gt; I&lt;text&gt;]
 [B&lt;-passin&gt; I&lt;arg&gt;]
 [B&lt;-passout&gt; I&lt;arg&gt;]
+[B&lt;-rand&gt; I&lt;files&gt;]
+[B&lt;-writerand&gt; I&lt;file&gt;]
 [I&lt;user&gt; ...]
 
 =for openssl ifdef engine
@@ -69,6 +71,10 @@ The password source for the input and output file.
 For more information about the format of B&lt;arg&gt;
 see L&lt;openssl(1)/Pass Phrase Options&gt;.
 
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
+
+See L&lt;openssl(1)/Random State Options&gt; for more information.
+
 =back
 
 =head1 COPYRIGHT
diff --git a/doc/man1/openssl-ts.pod b/doc/man1/openssl-ts.pod
index 1f7a0b7341..fc46421745 100644
--- a/doc/man1/openssl-ts.pod
+++ b/doc/man1/openssl-ts.pod
@@ -134,17 +134,9 @@ request with the following options:
 
 =over 4
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-config&gt; I&lt;configfile&gt;
 
@@ -358,20 +350,9 @@ This flag can be used together with the B&lt;-in&gt; option and indicates
 that the input is a DER encoded timestamp token (ContentInfo) instead
 of a timestamp response (TimeStampResp). (Optional)
 
-=item B&lt;-CApath&gt; I&lt;trusted_cert_path&gt;
-
-The name of the directory containing the trusted CA certificates of the
-client. See the similar option of L&lt;openssl-verify(1)&gt; for additional
-details. Either this option or B&lt;-CAfile&gt; must be specified. (Optional)
+=item B&lt;-CAfile&gt; I&lt;file&gt;, B&lt;-CApath&gt; I&lt;dir&gt;
 
-
-=item B&lt;-CAfile&gt; I&lt;trusted_certs.pem&gt;
-
-The name of the file containing a set of trusted self-signed CA
-certificates in PEM format. See the similar option of
-L&lt;openssl-verify(1)&gt; for additional details. Either this option
-or B&lt;-CApath&gt; must be specified.
-(Optional)
+See L&lt;openssl(1)/Trusted Certificate Options&gt; for more information.
 
 =item B&lt;-untrusted&gt; I&lt;cert_file.pem&gt;
 
diff --git a/doc/man1/openssl-verify.pod b/doc/man1/openssl-verify.pod
index 63277949e1..abaa0755f2 100644
--- a/doc/man1/openssl-verify.pod
+++ b/doc/man1/openssl-verify.pod
@@ -68,26 +68,9 @@ This command verifies certificate chains.
 
 Print out a usage message.
 
-=item B&lt;-CAfile&gt; I&lt;file&gt;
+=item B&lt;-CAfile&gt; I&lt;file&gt;, B&lt;-no-CAfile&gt;, B&lt;-CApath&gt; I&lt;dir&gt;, B&lt;-no-CApath&gt;
 
-A I&lt;file&gt; of trusted certificates.
-The file should contain one or more certificates in PEM format.
-
-=item B&lt;-CApath&gt; I&lt;directory&gt;
-
-A directory of trusted certificates. The certificates should have names
-of the form: F&lt;I&lt;hash&gt;.0&gt; or have symbolic links to them of this form
-(I&lt;hash&gt; is the hashed certificate subject name: see the L&lt;openssl-x509(1)&gt;
-B&lt;-hash&gt; option). Under Unix, L&lt;openssl-rehash(1)&gt; will automatically create
-symbolic links to a directory of certificates.
-
-=item B&lt;-no-CAfile&gt;
-
-Do not load the trusted CA certificates from the default file location.
-
-=item B&lt;-no-CApath&gt;
-
-Do not load the trusted CA certificates from the default directory location.
+See L&lt;openssl(1)/Trusted Certificate Options&gt; for more information.
 
 =item B&lt;-allow_proxy_certs&gt;
 
diff --git a/doc/man1/openssl-x509.pod b/doc/man1/openssl-x509.pod
index 731cb61344..4e13d2d881 100644
--- a/doc/man1/openssl-x509.pod
+++ b/doc/man1/openssl-x509.pod
@@ -122,17 +122,9 @@ Any digest supported by the L&lt;openssl-dgst(1)&gt; command can be used.
 If not specified then SHA1 is used with B&lt;-fingerprint&gt; or
 the default digest for the signing algorithm is used, typically SHA256.
 
-=item B&lt;-rand&gt; I&lt;files&gt;
+=item B&lt;-rand&gt; I&lt;files&gt;, B&lt;-writerand&gt; I&lt;file&gt;
 
-The files containing random data used to seed the random number generator.
-Multiple files can be specified separated by an OS-dependent character.
-The separator is B&lt;;&gt; for MS-Windows, B&lt;,&gt; for OpenVMS, and B&lt;:&gt; for
-all others.
-
-=item B&lt;-writerand&gt; I&lt;file&gt;
-
-Writes random data to the specified I&lt;file&gt; upon exit.
-This can be used with a subsequent B&lt;-rand&gt; flag.
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-engine&gt; I&lt;id&gt;
 
diff --git a/doc/man1/openssl.pod b/doc/man1/openssl.pod
index 00800d8c0b..fe037c5243 100644
--- a/doc/man1/openssl.pod
+++ b/doc/man1/openssl.pod
@@ -505,6 +505,14 @@ This section describes some common options with common behavior.
 =item B&lt;-help&gt;
 
 Provides a terse summary of all options.
+If an option takes an argument, the &quot;type&quot; of argument is also given.
+
+=item B&lt;--&gt;
+
+This terminates the list of options. It is mostly useful if any filename
+parameters start with a minus sign:
+
+ openssl verify [flags...] -- -cert1.pem...
 
 =back
 
@@ -554,6 +562,73 @@ Read the password from standard input.
 
 =back
 
+=head2 Trusted Certificate Options
+
+Part of validating a certificate includes verifying that the chain of CA's
+can be traced up to an existing trusted root.  The following options specify
+how to list the trusted roots, also known as trust anchors.  A collection
+of trusted roots is called a I&lt;trust store&gt;.
+
+Note that OpenSSL does not provide a default set of trust anchors.  Many
+Linux distributions include a system default and configure OpenSSL to point
+to that.  Mozilla maintains an influential trust store that can be found at
+L&lt;<A HREF="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/">https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/</A>&gt;.
+
+=over 4
+
+=item B&lt;-CAfile&gt; I&lt;file&gt;
+
+Load the specified file which contains one or more PEM-format certificates
+of CA's that are trusted.
+
+=item B&lt;-no-CAfile&gt;
+
+Do not load the default file of trusted certificates.
+
+=item B&lt;-CApath&gt; I&lt;dir&gt;
+
+Use the specified directory as a list of trust certificates. That is,
+files should be named with the hash of the X.509 SubjectName of each
+certificate. This is so that the library can extract the IssuerName,
+hash it, and directly lookup the file to get the issuer certificate.
+See L&lt;openssl-rehash(1)&gt; for information on creating this type of directory.
+
+=item B&lt;-no-CApath&gt;
+
+Do not use the default directory of trusted certificates.
+
+=back
+
+=head2 Random State Options
+
+Prior to OpenSSL 3.0, it was common for applications to store information
+about the state of the random-number generator in a file that was loaded
+at startup and rewritten upon exit. On modern operating systems, this is
+generally no longer necessary as OpenSSL will seed itself from the
+appropriate CPU flags, device files, and so on. These flags are still
+supported for special platforms or circumstances that might require them.
+
+It is generally an error to use the same seed file more than once and
+every use of B&lt;-rand&gt; should be paired with B&lt;-writerand&gt;.
+
+=over 4
+
+=item B&lt;-rand&gt; I&lt;files&gt;
+
+A file or files containing random data used to seed the random number
+generator.
+Multiple files can be specified separated by an OS-dependent character.
+The separator is C&lt;;&gt; for MS-Windows, C&lt;,&gt; for OpenVMS, and C&lt;:&gt; for
+all others. Another way to specify multiple files is to repeat this flag
+with different filenames.
+
+=item B&lt;-writerand&gt; I&lt;file&gt;
+
+Writes the seed data to the specified I&lt;file&gt; upon exit.
+This file can be used in a subsequent command invocation.
+
+=back
+
 =head1 ENVIRONMENT
 
 =over 4
diff --git a/doc/man1/tsget.pod b/doc/man1/tsget.pod
index d006198c67..6e013b9e68 100644
--- a/doc/man1/tsget.pod
+++ b/doc/man1/tsget.pod
@@ -113,9 +113,7 @@ option B&lt;-C&gt; or option B&lt;-P&gt; must be given in case of HTTPS. (Optional)
 
 =item B&lt;-r&gt; I&lt;files&gt;
 
-The files containing random data for seeding the random number
-generator. Multiple files can be specified, the separator is B&lt;;&gt; for
-MS-Windows, B&lt;,&gt; for VMS and B&lt;:&gt; for all other platforms. (Optional)
+See L&lt;openssl(1)/Random State Options&gt; for more information.
 
 =item B&lt;-g&gt; I&lt;EGD_socket&gt;
 
diff --git a/util/find-doc-nits b/util/find-doc-nits
index 576eac2cb7..f1841d8a8a 100755
--- a/util/find-doc-nits
+++ b/util/find-doc-nits
@@ -10,6 +10,7 @@
 require 5.10.0;
 use warnings;
 use strict;
+
 use Pod::Checker;
 use File::Find;
 use File::Basename;
@@ -18,7 +19,8 @@ use Getopt::Std;
 use lib catdir(dirname($0), &quot;perl&quot;);
 use OpenSSL::Util::Pod;
 
-my $debug = 0;                  # Set to 1 for debug output
+# Set to 1 for debug output
+my $debug = 0;
 
 # Options.
 our($opt_d);
@@ -71,12 +73,14 @@ my $OUT;
 my %public;
 my $status = 0;
 
-my %mandatory_sections =
-    ( '*'    =&gt; [ 'NAME', 'DESCRIPTION', 'COPYRIGHT' ],
-      1      =&gt; [ 'SYNOPSIS', 'OPTIONS' ],
-      3      =&gt; [ 'SYNOPSIS', 'RETURN VALUES' ],
-      5      =&gt; [ ],
-      7      =&gt; [ ] );
+my %mandatory_sections = (
+    '*' =&gt; [ 'NAME', 'DESCRIPTION', 'COPYRIGHT' ],
+    1   =&gt; [ 'SYNOPSIS', 'OPTIONS' ],
+    3   =&gt; [ 'SYNOPSIS', 'RETURN VALUES' ],
+    5   =&gt; [ ],
+    7   =&gt; [ ]
+);
+
 
 # Print error message, set $status.
 sub err {
@@ -116,10 +120,9 @@ sub name_synopsis {
         $names{$n} = 1;
         $foundfilename++ if $n eq $simplename;
         $foundfilenames{$n} = 1
-            if ((-f &quot;$dirname/$n.pod.in&quot; || -f &quot;$dirname/$n.pod&quot;)
-                &amp;&amp; $n ne $simplename);
+            if -f &quot;$dirname/$n.pod&quot; &amp;&amp; $n ne $simplename;
     }
-    err($id, &quot;the following exist as other .pod or .pod.in files:&quot;,
+    err($id, &quot;the following exist as other .pod files:&quot;,
          sort keys %foundfilenames)
         if %foundfilenames;
     err($id, &quot;$simplename (filename) missing from NAME section&quot;)
@@ -256,10 +259,9 @@ my $option_re =
 
 # Helper function to check if a given $thing is properly marked up
 # option.  It returns one of these values:
-#
-# undef         if it's not an option
-# &quot;&quot;            if it's a malformed option
-# $unwrapped    the option with the outermost B&lt;&gt; wrapping removed.
+#     undef         if it's not an option
+#     &quot;&quot;            if it's a malformed option
+#     $unwrapped    the option with the outermost B&lt;&gt; wrapping removed.
 sub normalise_option {
     my $id = shift;
     my $filename = shift;
@@ -342,7 +344,6 @@ my $symbol_re = qr/[[:alpha:]_][_[:alnum:]]*?/;
 # Checks of function name (man3) formatting.  The man3 checks are
 # easier than the man1 checks, we only check the names followed by (),
 # and only the names that have POD markup.
-
 sub functionname_check {
     my $id = shift;
     my $filename = shift;
@@ -407,6 +408,7 @@ my %preferred_words = (
     'zeroes'        =&gt; 'zeros'
 );
 
+# Search manpage for words that have a different preferred use.
 sub wording {
     my $id = shift;
     my $contents = shift;
@@ -422,6 +424,7 @@ sub wording {
         if $contents =~ /\bepoch\b/;
 }
 
+# Perform all sorts of nit/error checks on a manpage
 sub check {
     my $filename = shift;
     my $dirname = basename(dirname($filename));
@@ -515,15 +518,13 @@ sub check {
     my $section = 3;
     $section = $1 if $dirname =~ /man([1-9])/;
 
-    foreach ((@{$mandatory_sections{'*'}}, @{$mandatory_sections{$section}})) {
-        # Skip &quot;return values&quot; if not -s
+    foreach ( (@{$mandatory_sections{'*'}}, @{$mandatory_sections{$section}}) ) {
         err($id, &quot;missing $_ head1 section&quot;)
             if $contents !~ /^=head1\s+${_}\s*$/m;
     }
 }
 
-my %dups;
-
+# Parse libcrypto.num, etc., and return sorted list of what's there.
 sub parsenum {
     my $file = shift;
     my @apis;
@@ -545,12 +546,15 @@ sub parsenum {
     return sort @apis;
 }
 
+# Parse all the manpages, getting return map of what they document
+# (by looking at their NAME sections).
 sub getdocced
 {
     my $dir = shift;
     my %return;
+    my %dups;
 
-    foreach my $pod ( glob(&quot;$dir/*.pod&quot;), glob(&quot;$dir/*.pod.in&quot;) ) {
+    foreach my $pod ( glob(&quot;$dir/*.pod&quot;) ) {
         my %podinfo = extract_pod_info($pod);
         foreach my $n ( @{$podinfo{names}} ) {
             $return{$n} = $pod;
@@ -563,8 +567,14 @@ sub getdocced
     return %return;
 }
 
+# Map of documented functions; function =&gt; manpage
 my %docced;
+# Map of links in each POD file; filename =&gt; [ &quot;foo(1)&quot;, &quot;bar(3)&quot;, ... ]
+my %link_map = ();
+# Map of names in each POD file; &quot;name(s)&quot; =&gt; filename
+my %name_map = ();
 
+# Load file of symbol names that we know aren't documented.
 sub loadmissing($)
 {
     my $missingfile = shift;
@@ -582,14 +592,16 @@ sub loadmissing($)
     return @missing;
 }
 
+# Check for undocumented macros; ignore those in the &quot;missing&quot; file
+# and do simple check for #define in our header files.
 sub checkmacros {
     my $count = 0;
     my %seen;
     my @missing;
 
-    if ($opt_o) {
+    if ( $opt_o ) {
         @missing = loadmissing('util/missingmacro111.txt');
-    } elsif ($opt_v) {
+    } elsif ( $opt_v ) {
         @missing = loadmissing('util/missingmacro.txt');
     }
 
@@ -623,6 +635,8 @@ sub checkmacros {
         if $count &gt; 0;
 }
 
+# Find out what is undocumented (filtering out the known missing ones)
+# and display them.
 sub printem {
     my $libname = shift;
     my $numfile = shift;
@@ -630,7 +644,7 @@ sub printem {
     my $count = 0;
     my %seen;
 
-    my @missing = loadmissing($missingfile) if ($opt_v);
+    my @missing = loadmissing($missingfile) if ( $opt_v );
 
     foreach my $func ( parsenum($numfile) ) {
         next if $docced{$func} || defined $seen{$func};
@@ -650,19 +664,12 @@ sub printem {
         if $count &gt; 0;
 }
 
-
-# Collection of links in each POD file.
-# filename =&gt; [ &quot;foo(1)&quot;, &quot;bar(3)&quot;, ... ]
-my %link_collection = ();
-# Collection of names in each POD file.
-# &quot;name(s)&quot; =&gt; filename
-my %name_collection = ();
-
+# Collect all the names in a manpage.
 sub collectnames {
     my $filename = shift;
     $filename =~ m|man(\d)/|;
     my $section = $1;
-    my $simplename = basename(basename($filename, &quot;.in&quot;), &quot;.pod&quot;);
+    my $simplename = basename($filename, &quot;.pod&quot;);
     my $id = &quot;${filename}:1:&quot;;
 
     my $contents = '';
@@ -675,7 +682,7 @@ sub collectnames {
 
     $contents =~ /=head1 NAME([^=]*)=head1 /ms;
     my $tmp = $1;
-    unless (defined $tmp) {
+    unless ( defined $tmp ) {
         err($id, &quot;weird name section&quot;);
         return;
     }
@@ -686,32 +693,32 @@ sub collectnames {
         map { s|/|-|g; $_ }              # Treat slash as dash
         map { s/^\s+//g; s/\s+$//g; $_ } # Trim prefix and suffix blanks
         split(/,/, $tmp);
-    unless (grep { $simplename eq $_ } @names) {
+    unless ( grep { $simplename eq $_ } @names ) {
         err($id, &quot;missing $simplename&quot;);
         push @names, $simplename;
     }
     foreach my $name (@names) {
         next if $name eq &quot;&quot;;
-        if ($name =~ /\s/) {
+        if ( $name =~ /\s/ ) {
             err($id, &quot;'$name' contains white space&quot;)
         }
         my $name_sec = &quot;$name($section)&quot;;
-        if (! exists $name_collection{$name_sec}) {
-            $name_collection{$name_sec} = $filename;
-        } elsif ($filename eq $name_collection{$name_sec}) {
+        if ( !exists $name_map{$name_sec} ) {
+            $name_map{$name_sec} = $filename;
+        } elsif ( $filename eq $name_map{$name_sec} ) {
             err($id, &quot;$name_sec repeated in NAME section of&quot;,
-                 $name_collection{$name_sec});
+                 $name_map{$name_sec});
         } else {
             err($id, &quot;$name_sec also in NAME section of&quot;,
-                 $name_collection{$name_sec});
+                 $name_map{$name_sec});
         }
     }
 
     my @foreign_names =
         map { map { s/\s+//g; $_ } split(/,/, $_) }
         $contents =~ /=for\s+comment\s+foreign\s+manuals:\s*(.*)\n\n/;
-    foreach (@foreign_names) {
-        $name_collection{$_} = undef; # It still exists!
+    foreach ( @foreign_names ) {
+        $name_map{$_} = undef; # It still exists!
     }
 
     my @links = $contents =~ /L&lt;
@@ -723,14 +730,15 @@ sub collectnames {
                               # a one digit section number
                               ([^\/&gt;\(]+\(\d\))
                              /gx;
-    $link_collection{$filename} = [ @links ];
+    $link_map{$filename} = [ @links ];
 }
 
+# Look for L&lt;&gt; (&quot;link&quot;) references that point to files that do not exist.
 sub checklinks {
-    foreach my $filename (sort keys %link_collection) {
-        foreach my $link (@{$link_collection{$filename}}) {
+    foreach my $filename (sort keys %link_map) {
+        foreach my $link (@{$link_map{$filename}}) {
             err(&quot;${filename}:1:&quot;, &quot;reference to non-existing $link&quot;)
-                unless exists $name_collection{$link};
+                unless exists $name_map{$link};
         }
     }
 }
@@ -748,7 +756,8 @@ sub publicize {
     }
 }
 
-# Cipher/digests to skip if not documented
+# Cipher/digests to skip if they show up as &quot;not implemented&quot;
+# because they are, via the &quot;-*&quot; construct.
 my %skips = (
     'aes128' =&gt; 1,
     'aes192' =&gt; 1,
@@ -766,6 +775,7 @@ my %skips = (
     'digest' =&gt; 1,
 );
 
+# Check the flags of a command and see if everything is in the manpage
 sub checkflags {
     my $cmd = shift;
     my $doc = shift;
@@ -803,30 +813,27 @@ sub checkflags {
     close CFH;
 
     # See what's in the command not the manpage.
-    my @undocced = ();
-    foreach my $k ( keys %cmdopts ) {
-        push @undocced, $k unless $docopts{$k};
-    }
-    if ( scalar @undocced &gt; 0 ) {
-        foreach ( @undocced ) {
-            next if /-/; # Skip the -- end-of-flags marker
-            err(&quot;$doc: undocumented option -$_&quot;);
-        }
+    my @undocced = sort grep { !defined $docopts{$_} } keys %cmdopts;
+    foreach ( @undocced ) {
+        next if /-/; # Skip the -- end-of-flags marker
+        err(&quot;$doc: undocumented option -$_&quot;);
     }
 
     # See what's in the command not the manpage.
-    my @unimpl = ();
-    foreach my $k ( keys %docopts ) {
-        push @unimpl, $k unless $cmdopts{$k};
-    }
-    if ( scalar @unimpl &gt; 0 ) {
-        foreach ( @unimpl ) {
-            next if defined $skips{$_} || defined $localskips{$_};
-            err(&quot;$cmd documented but not implemented -$_&quot;);
-        }
+    my @unimpl = sort grep { !defined $cmdopts{$_} } keys %docopts;
+    foreach ( @unimpl ) {
+        next if defined $skips{$_} || defined $localskips{$_};
+        err(&quot;$cmd documented but not implemented -$_&quot;);
     }
 }
 
+##
+##  MAIN()
+##  Do the work requested by the various getopt flags.
+##  The flags are parsed in alphabetical order, just because we have
+##  to have *some way* of listing them.
+##
+
 if ( $opt_c ) {
     my @commands = ();
 
@@ -865,8 +872,7 @@ if ( $opt_c ) {
 }
 
 if ( $opt_l ) {
-    foreach (@ARGV ? @ARGV : (glob('doc/*/*.pod'), glob('doc/*/*.pod.in'),
-                              glob('doc/internal/*/*.pod'))) {
+    foreach ( @ARGV ? @ARGV : glob('doc/*/*.pod doc/internal/*/*.pod') ) {
         collectnames($_);
     }
     checklinks();
@@ -874,10 +880,7 @@ if ( $opt_l ) {
 
 if ( $opt_n ) {
     publicize();
-    foreach (@ARGV ? @ARGV : (glob('doc/*/*.pod'), glob('doc/*/*.pod.in'))) {
-        check($_);
-    }
-    foreach (@ARGV ? @ARGV : glob('doc/internal/*/*.pod')) {
+    foreach ( @ARGV ? @ARGV : glob('doc/*/*.pod doc/internal/*/*.pod') ) {
         check($_);
     }
 
@@ -895,7 +898,7 @@ if ( $opt_u || $opt_v) {
     foreach ( keys %temp ) {
         $docced{$_} = $temp{$_};
     }
-    if ($opt_o) {
+    if ( $opt_o ) {
         printem('crypto', 'util/libcrypto.num', 'util/missingcrypto111.txt');
         printem('ssl', 'util/libssl.num', 'util/missingssl111.txt');
     } else {
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025630.html">[openssl]  master update
</A></li>
	<LI>Next message: <A HREF="025642.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25640">[ date ]</a>
              <a href="thread.html#25640">[ thread ]</a>
              <a href="subject.html#25640">[ subject ]</a>
              <a href="author.html#25640">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
