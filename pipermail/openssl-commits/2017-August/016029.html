<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2017-August/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1503301835.305974.24441.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016028.html">
   <LINK REL="Next"  HREF="016030.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Matt Caswell</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1503301835.305974.24441.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">matt at openssl.org
       </A><BR>
    <I>Mon Aug 21 07:50:35 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="016028.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="016030.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16029">[ date ]</a>
              <a href="thread.html#16029">[ thread ]</a>
              <a href="subject.html#16029">[ subject ]</a>
              <a href="author.html#16029">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  888098304b0a77aee2d5ca5951ee5fccfeb6b1c2 (commit)
       via  638c2dd0ab504e22af08e4d56b43959a8be2382e (commit)
       via  42d7d7dd6a9ea5d610856b7ccec1767ba93ed30c (commit)
       via  24664a3bf56c9372d4b358c1c90cacaba8fb4c14 (commit)
       via  fb7621cb4bea395566b8c1d301f1b2978abdfde5 (commit)
       via  e40ada04f45927eccf166adb067ee0ec795cefd4 (commit)
       via  7d248ee0aed6bf364b96fd100835b15ccfede309 (commit)
       via  8f9ee7a33f4e8a52642335673f2cdc57ecdd38cc (commit)
       via  de61c03cc7ac52e45d50504e8cf1dda2f5230b28 (commit)
       via  64d9844ab6b6fb97ca270e236741f7dd61c1940b (commit)
       via  437e5050d585ede90301ddeee1532e22064e63eb (commit)
       via  86f31dd9cc81d1c2429846ab663ecd8a29333e3b (commit)
       via  297c1149f6b8b0f9ade5f2bf12e148056ef77734 (commit)
      from  045fe7313a672630881df277321052442bfaca73 (commit)


- Log -----------------------------------------------------------------
commit 888098304b0a77aee2d5ca5951ee5fccfeb6b1c2
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Aug 2 15:29:31 2017 +0100

    More updates following review feedback
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3740">https://github.com/openssl/openssl/pull/3740</A>)

commit 638c2dd0ab504e22af08e4d56b43959a8be2382e
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Mon Jul 3 11:47:10 2017 +0100

    Updates following feedback on OPENSSL_assert() removal
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3740">https://github.com/openssl/openssl/pull/3740</A>)

commit 42d7d7dd6a9ea5d610856b7ccec1767ba93ed30c
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Jun 21 15:56:56 2017 +0100

    Remove OPENSSL_assert() from crypto/x509v3
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3740">https://github.com/openssl/openssl/pull/3740</A>)

commit 24664a3bf56c9372d4b358c1c90cacaba8fb4c14
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Jun 21 15:56:36 2017 +0100

    Remove OPENSSL_assert() from crypto/x509
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3740">https://github.com/openssl/openssl/pull/3740</A>)

commit fb7621cb4bea395566b8c1d301f1b2978abdfde5
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Jun 21 15:56:12 2017 +0100

    Remove OPENSSL_assert() from crypto/threads_none.c
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3740">https://github.com/openssl/openssl/pull/3740</A>)

commit e40ada04f45927eccf166adb067ee0ec795cefd4
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Jun 21 15:55:56 2017 +0100

    Remove OPENSSL_assert() from crypto/pem
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3740">https://github.com/openssl/openssl/pull/3740</A>)

commit 7d248ee0aed6bf364b96fd100835b15ccfede309
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Jun 21 15:55:38 2017 +0100

    Remove OPENSSL_assert() from crypto/kdf
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3740">https://github.com/openssl/openssl/pull/3740</A>)

commit 8f9ee7a33f4e8a52642335673f2cdc57ecdd38cc
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Jun 21 15:55:20 2017 +0100

    Remove OPENSSL_assert() from crypto/hmac
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3740">https://github.com/openssl/openssl/pull/3740</A>)

commit de61c03cc7ac52e45d50504e8cf1dda2f5230b28
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Jun 21 15:54:45 2017 +0100

    Remove OPENSSL_assert() from crypto/ec
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3740">https://github.com/openssl/openssl/pull/3740</A>)

commit 64d9844ab6b6fb97ca270e236741f7dd61c1940b
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Jun 21 15:54:25 2017 +0100

    Remove OPENSSL_assert() from conf_api.c
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3740">https://github.com/openssl/openssl/pull/3740</A>)

commit 437e5050d585ede90301ddeee1532e22064e63eb
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Jun 21 15:52:52 2017 +0100

    Remove OPENSSL_assert() usage from crypto/bn
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3740">https://github.com/openssl/openssl/pull/3740</A>)

commit 86f31dd9cc81d1c2429846ab663ecd8a29333e3b
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Jun 21 15:52:11 2017 +0100

    Remove OPENSSL_assert() from various crypto/bio files
    
    bss_dgram.c is deferred until later due to ongoing discussions.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3740">https://github.com/openssl/openssl/pull/3740</A>)

commit 297c1149f6b8b0f9ade5f2bf12e148056ef77734
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Jun 21 15:51:27 2017 +0100

    Remove OPENSSL_assert() from crypto/asn1/bio_asn1.c
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3740">https://github.com/openssl/openssl/pull/3740</A>)

-----------------------------------------------------------------------

Summary of changes:
 crypto/asn1/bio_asn1.c  |  4 ++-
 crypto/bio/b_addr.c     | 10 +++---
 crypto/bio/b_print.c    | 11 ++++---
 crypto/bio/b_sock.c     | 15 ++++-----
 crypto/bn/bn_lcl.h      | 10 +++---
 crypto/bn/bn_nist.c     |  2 +-
 crypto/conf/conf_api.c  |  3 +-
 crypto/ec/ec_key.c      |  1 -
 crypto/ec/ec_lib.c      |  1 -
 crypto/hmac/hmac.c      |  3 +-
 crypto/kdf/tls1_prf.c   |  3 +-
 crypto/pem/pem_info.c   | 13 +++++---
 crypto/pem/pem_lib.c    | 13 +++++---
 crypto/threads_none.c   |  9 ++++--
 crypto/x509/x509_vfy.c  | 31 +++++++++++++++---
 crypto/x509/x_x509.c    |  2 --
 crypto/x509v3/v3_addr.c | 30 ++++++++++-------
 crypto/x509v3/v3_asid.c | 86 ++++++++++++++++++++++++++++++++-----------------
 18 files changed, 159 insertions(+), 88 deletions(-)

diff --git a/crypto/asn1/bio_asn1.c b/crypto/asn1/bio_asn1.c
index 31fd725..e28ab27 100644
--- a/crypto/asn1/bio_asn1.c
+++ b/crypto/asn1/bio_asn1.c
@@ -16,6 +16,7 @@
 #include &lt;string.h&gt;
 #include &lt;internal/bio.h&gt;
 #include &lt;openssl/asn1.h&gt;
+#include &quot;internal/cryptlib.h&quot;
 
 /* Must be large enough for biggest tag+length */
 #define DEFAULT_ASN1_BUF_SIZE 20
@@ -181,7 +182,8 @@ static int asn1_bio_write(BIO *b, const char *in, int inl)
 
         case ASN1_STATE_HEADER:
             ctx-&gt;buflen = ASN1_object_size(0, inl, ctx-&gt;asn1_tag) - inl;
-            OPENSSL_assert(ctx-&gt;buflen &lt;= ctx-&gt;bufsize);
+            if (!ossl_assert(ctx-&gt;buflen &lt;= ctx-&gt;bufsize))
+                return 0;
             p = ctx-&gt;buf;
             ASN1_put_object(&amp;p, 0, inl, ctx-&gt;asn1_tag, ctx-&gt;asn1_class);
             ctx-&gt;copylen = inl;
diff --git a/crypto/bio/b_addr.c b/crypto/bio/b_addr.c
index b8e1f96..d0b2428 100644
--- a/crypto/bio/b_addr.c
+++ b/crypto/bio/b_addr.c
@@ -7,6 +7,7 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
+#include &lt;assert.h&gt;
 #include &lt;string.h&gt;
 
 #include &quot;bio_lcl.h&quot;
@@ -565,8 +566,6 @@ static int addrinfo_wrap(int family, int socktype,
                          unsigned short port,
                          BIO_ADDRINFO **bai)
 {
-    OPENSSL_assert(bai != NULL);
-
     *bai = OPENSSL_zalloc(sizeof(**bai));
     if (*bai == NULL)
         return 0;
@@ -760,8 +759,11 @@ int BIO_lookup_ex(const char *host, const char *service, int lookup_type,
                 he_fallback_address = INADDR_ANY;
                 break;
             default:
-                OPENSSL_assert((&quot;We forgot to handle a lookup type!&quot; == 0));
-                break;
+                /* We forgot to handle a lookup type! */
+                assert(&quot;We forgot to handle a lookup type!&quot; == NULL);
+                BIOerr(BIO_F_BIO_LOOKUP_EX, ERR_R_INTERNAL_ERROR);
+                ret = 0;
+                goto err;
             }
         } else {
             he = gethostbyname(host);
diff --git a/crypto/bio/b_print.c b/crypto/bio/b_print.c
index a7741f0..ebb6845 100644
--- a/crypto/bio/b_print.c
+++ b/crypto/bio/b_print.c
@@ -805,11 +805,13 @@ static int
 doapr_outch(char **sbuffer,
             char **buffer, size_t *currlen, size_t *maxlen, int c)
 {
-    /* If we haven't at least one buffer, someone has doe a big booboo */
-    OPENSSL_assert(*sbuffer != NULL || buffer != NULL);
+    /* If we haven't at least one buffer, someone has done a big booboo */
+    if (!ossl_assert(*sbuffer != NULL || buffer != NULL))
+        return 0;
 
     /* |currlen| must always be &lt;= |*maxlen| */
-    OPENSSL_assert(*currlen &lt;= *maxlen);
+    if (!ossl_assert(*currlen &lt;= *maxlen))
+        return 0;
 
     if (buffer &amp;&amp; *currlen == *maxlen) {
         if (*maxlen &gt; INT_MAX - BUFFER_INC)
@@ -821,7 +823,8 @@ doapr_outch(char **sbuffer,
             if (*buffer == NULL)
                 return 0;
             if (*currlen &gt; 0) {
-                OPENSSL_assert(*sbuffer != NULL);
+                if (!ossl_assert(*sbuffer != NULL))
+                    return 0;
                 memcpy(*buffer, *sbuffer, *currlen);
             }
             *sbuffer = NULL;
diff --git a/crypto/bio/b_sock.c b/crypto/bio/b_sock.c
index 97dcc70..6533962 100644
--- a/crypto/bio/b_sock.c
+++ b/crypto/bio/b_sock.c
@@ -43,14 +43,13 @@ int BIO_get_host_ip(const char *str, unsigned char *ip)
         if (BIO_ADDRINFO_family(res) != AF_INET) {
             BIOerr(BIO_F_BIO_GET_HOST_IP,
                    BIO_R_GETHOSTBYNAME_ADDR_IS_NOT_AF_INET);
-        } else {
-            BIO_ADDR_rawaddress(BIO_ADDRINFO_address(res), NULL, &amp;l);
-            /* Because only AF_INET addresses will reach this far,
-               we can assert that l should be 4 */
-            OPENSSL_assert(l == 4);
-
-            BIO_ADDR_rawaddress(BIO_ADDRINFO_address(res), ip, &amp;l);
-            ret = 1;
+        } else if (BIO_ADDR_rawaddress(BIO_ADDRINFO_address(res), NULL, &amp;l)) {
+            /*
+             * Because only AF_INET addresses will reach this far, we can assert
+             * that l should be 4
+             */
+            if (ossl_assert(l == 4))
+                ret = BIO_ADDR_rawaddress(BIO_ADDRINFO_address(res), ip, &amp;l);
         }
         BIO_ADDRINFO_free(res);
     } else {
diff --git a/crypto/bn/bn_lcl.h b/crypto/bn/bn_lcl.h
index 7828232..9171879 100644
--- a/crypto/bn/bn_lcl.h
+++ b/crypto/bn/bn_lcl.h
@@ -145,7 +145,7 @@ extern &quot;C&quot; {
  */
 
 # ifdef BN_DEBUG
-
+#  include &lt;assert.h&gt;
 #  ifdef BN_DEBUG_RAND
 #   define bn_pollute(a) \
         do { \
@@ -169,8 +169,8 @@ extern &quot;C&quot; {
         do { \
                 const BIGNUM *_bnum2 = (a); \
                 if (_bnum2 != NULL) { \
-                        OPENSSL_assert(((_bnum2-&gt;top == 0) &amp;&amp; !_bnum2-&gt;neg) || \
-                                (_bnum2-&gt;top &amp;&amp; (_bnum2-&gt;d[_bnum2-&gt;top - 1] != 0))); \
+                        assert(((_bnum2-&gt;top == 0) &amp;&amp; !_bnum2-&gt;neg) || \
+                               (_bnum2-&gt;top &amp;&amp; (_bnum2-&gt;d[_bnum2-&gt;top - 1] != 0))); \
                         bn_pollute(_bnum2); \
                 } \
         } while(0)
@@ -181,8 +181,8 @@ extern &quot;C&quot; {
 #  define bn_wcheck_size(bn, words) \
         do { \
                 const BIGNUM *_bnum2 = (bn); \
-                OPENSSL_assert((words) &lt;= (_bnum2)-&gt;dmax &amp;&amp; \
-                        (words) &gt;= (_bnum2)-&gt;top); \
+                assert((words) &lt;= (_bnum2)-&gt;dmax &amp;&amp; \
+                       (words) &gt;= (_bnum2)-&gt;top); \
                 /* avoid unused variable warning with NDEBUG */ \
                 (void)(_bnum2); \
         } while(0)
diff --git a/crypto/bn/bn_nist.c b/crypto/bn/bn_nist.c
index 53598f9..fcc2b77 100644
--- a/crypto/bn/bn_nist.c
+++ b/crypto/bn/bn_nist.c
@@ -254,7 +254,7 @@ static void nist_cp_bn_0(BN_ULONG *dst, const BN_ULONG *src, int top, int max)
     int i;
 
 #ifdef BN_DEBUG
-    OPENSSL_assert(top &lt;= max);
+    assert(top &lt;= max);
 #endif
     for (i = 0; i &lt; top; i++)
         dst[i] = src[i];
diff --git a/crypto/conf/conf_api.c b/crypto/conf/conf_api.c
index 5535416..6026dca 100644
--- a/crypto/conf/conf_api.c
+++ b/crypto/conf/conf_api.c
@@ -204,7 +204,8 @@ CONF_VALUE *_CONF_new_section(CONF *conf, const char *section)
     v-&gt;value = (char *)sk;
 
     vv = lh_CONF_VALUE_insert(conf-&gt;data, v);
-    OPENSSL_assert(vv == NULL);
+    if (vv != NULL)
+        goto err;
     return v;
 
  err:
diff --git a/crypto/ec/ec_key.c b/crypto/ec/ec_key.c
index 4098be6..6aa204e 100644
--- a/crypto/ec/ec_key.c
+++ b/crypto/ec/ec_key.c
@@ -191,7 +191,6 @@ int EC_KEY_generate_key(EC_KEY *eckey)
 
 int ossl_ec_key_gen(EC_KEY *eckey)
 {
-    OPENSSL_assert(eckey-&gt;group-&gt;meth-&gt;keygen != NULL);
     return eckey-&gt;group-&gt;meth-&gt;keygen(eckey);
 }
 
diff --git a/crypto/ec/ec_lib.c b/crypto/ec/ec_lib.c
index 47318d6..6ccf6f1 100644
--- a/crypto/ec/ec_lib.c
+++ b/crypto/ec/ec_lib.c
@@ -330,7 +330,6 @@ const BIGNUM *EC_GROUP_get0_order(const EC_GROUP *group)
 
 int EC_GROUP_order_bits(const EC_GROUP *group)
 {
-    OPENSSL_assert(group-&gt;meth-&gt;group_order_bits != NULL);
     return group-&gt;meth-&gt;group_order_bits(group);
 }
 
diff --git a/crypto/hmac/hmac.c b/crypto/hmac/hmac.c
index 3952dd5..156725e 100644
--- a/crypto/hmac/hmac.c
+++ b/crypto/hmac/hmac.c
@@ -37,7 +37,8 @@ int HMAC_Init_ex(HMAC_CTX *ctx, const void *key, int len,
     if (key != NULL) {
         reset = 1;
         j = EVP_MD_block_size(md);
-        OPENSSL_assert(j &lt;= (int)sizeof(ctx-&gt;key));
+        if (!ossl_assert(j &lt;= (int)sizeof(ctx-&gt;key)))
+            goto err;
         if (j &lt; len) {
             if (!EVP_DigestInit_ex(ctx-&gt;md_ctx, md, impl))
                 goto err;
diff --git a/crypto/kdf/tls1_prf.c b/crypto/kdf/tls1_prf.c
index 063ea03..339e10c 100644
--- a/crypto/kdf/tls1_prf.c
+++ b/crypto/kdf/tls1_prf.c
@@ -184,7 +184,8 @@ static int tls1_prf_P_hash(const EVP_MD *md,
     int ret = 0;
 
     chunk = EVP_MD_size(md);
-    OPENSSL_assert(chunk &gt;= 0);
+    if (!ossl_assert(chunk &gt; 0))
+        goto err;
 
     ctx = EVP_MD_CTX_new();
     ctx_tmp = EVP_MD_CTX_new();
diff --git a/crypto/pem/pem_info.c b/crypto/pem/pem_info.c
index dd493c8..017dd0f 100644
--- a/crypto/pem/pem_info.c
+++ b/crypto/pem/pem_info.c
@@ -256,7 +256,13 @@ int PEM_X509_INFO_write_bio(BIO *bp, X509_INFO *xi, EVP_CIPHER *enc,
 
     if (enc != NULL) {
         objstr = OBJ_nid2sn(EVP_CIPHER_nid(enc));
-        if (objstr == NULL) {
+        if (objstr == NULL
+                   /*
+                    * Check &quot;Proc-Type: 4,Encrypted\nDEK-Info: objstr,hex-iv\n&quot;
+                    * fits into buf
+                    */
+                || (strlen(objstr) + 23 + 2 * EVP_CIPHER_iv_length(enc) + 13)
+                   &gt; sizeof(buf)) {
             PEMerr(PEM_F_PEM_X509_INFO_WRITE_BIO, PEM_R_UNSUPPORTED_CIPHER);
             goto err;
         }
@@ -291,10 +297,7 @@ int PEM_X509_INFO_write_bio(BIO *bp, X509_INFO *xi, EVP_CIPHER *enc,
                 goto err;
             }
 
-            /* create the right magic header stuff */
-            OPENSSL_assert(strlen(objstr) + 23
-                           + 2 * EVP_CIPHER_iv_length(enc) + 13 &lt;=
-                           sizeof buf);
+            /* Create the right magic header stuff */ 
             buf[0] = '\0';
             PEM_proc_type(buf, PEM_TYPE_ENCRYPTED);
             PEM_dek_info(buf, objstr, EVP_CIPHER_iv_length(enc),
diff --git a/crypto/pem/pem_lib.c b/crypto/pem/pem_lib.c
index 76e0698..309545b 100644
--- a/crypto/pem/pem_lib.c
+++ b/crypto/pem/pem_lib.c
@@ -324,7 +324,14 @@ int PEM_ASN1_write_bio(i2d_of_void *i2d, const char *name, BIO *bp,
 
     if (enc != NULL) {
         objstr = OBJ_nid2sn(EVP_CIPHER_nid(enc));
-        if (objstr == NULL || EVP_CIPHER_iv_length(enc) == 0) {
+        if (objstr == NULL || EVP_CIPHER_iv_length(enc) == 0
+                || EVP_CIPHER_iv_length(enc) &gt; (int)sizeof(iv)
+                   /*
+                    * Check &quot;Proc-Type: 4,Encrypted\nDEK-Info: objstr,hex-iv\n&quot;
+                    * fits into buf
+                    */
+                || (strlen(objstr) + 23 + 2 * EVP_CIPHER_iv_length(enc) + 13)
+                   &gt; sizeof(buf)) {
             PEMerr(PEM_F_PEM_ASN1_WRITE_BIO, PEM_R_UNSUPPORTED_CIPHER);
             goto err;
         }
@@ -361,7 +368,6 @@ int PEM_ASN1_write_bio(i2d_of_void *i2d, const char *name, BIO *bp,
 #endif
             kstr = (unsigned char *)buf;
         }
-        OPENSSL_assert(EVP_CIPHER_iv_length(enc) &lt;= (int)sizeof(iv));
         if (RAND_bytes(iv, EVP_CIPHER_iv_length(enc)) &lt;= 0) /* Generate a salt */
             goto err;
         /*
@@ -374,9 +380,6 @@ int PEM_ASN1_write_bio(i2d_of_void *i2d, const char *name, BIO *bp,
         if (kstr == (unsigned char *)buf)
             OPENSSL_cleanse(buf, PEM_BUFSIZE);
 
-        OPENSSL_assert(strlen(objstr) + 23 + 2 * EVP_CIPHER_iv_length(enc) + 13
-                       &lt;= sizeof buf);
-
         buf[0] = '\0';
         PEM_proc_type(buf, PEM_TYPE_ENCRYPTED);
         PEM_dek_info(buf, objstr, EVP_CIPHER_iv_length(enc), (char *)iv);
diff --git a/crypto/threads_none.c b/crypto/threads_none.c
index f7e5359..ffad757 100644
--- a/crypto/threads_none.c
+++ b/crypto/threads_none.c
@@ -25,19 +25,22 @@ CRYPTO_RWLOCK *CRYPTO_THREAD_lock_new(void)
 
 int CRYPTO_THREAD_read_lock(CRYPTO_RWLOCK *lock)
 {
-    OPENSSL_assert(*(unsigned int *)lock == 1);
+    if (!ossl_assert(*(unsigned int *)lock == 1))
+        return 0;
     return 1;
 }
 
 int CRYPTO_THREAD_write_lock(CRYPTO_RWLOCK *lock)
 {
-    OPENSSL_assert(*(unsigned int *)lock == 1);
+    if (!ossl_assert(*(unsigned int *)lock == 1))
+        return 0;
     return 1;
 }
 
 int CRYPTO_THREAD_unlock(CRYPTO_RWLOCK *lock)
 {
-    OPENSSL_assert(*(unsigned int *)lock == 1);
+    if (!ossl_assert(*(unsigned int *)lock == 1))
+        return 0;
     return 1;
 }
 
diff --git a/crypto/x509/x509_vfy.c b/crypto/x509/x509_vfy.c
index 70ce606..af96418 100644
--- a/crypto/x509/x509_vfy.c
+++ b/crypto/x509/x509_vfy.c
@@ -2843,7 +2843,11 @@ static int build_chain(X509_STORE_CTX *ctx)
     int i;
 
     /* Our chain starts with a single untrusted element. */
-    OPENSSL_assert(num == 1 &amp;&amp; ctx-&gt;num_untrusted == num);
+    if (!ossl_assert(num == 1 &amp;&amp; ctx-&gt;num_untrusted == num))  {
+        X509err(X509_F_BUILD_CHAIN, ERR_R_INTERNAL_ERROR);
+        ctx-&gt;error = X509_V_ERR_UNSPECIFIED;
+        return 0;
+    }
 
 #define S_DOUNTRUSTED      (1 &lt;&lt; 0)     /* Search untrusted chain */
 #define S_DOTRUSTED        (1 &lt;&lt; 1)     /* Search trusted store */
@@ -2980,7 +2984,14 @@ static int build_chain(X509_STORE_CTX *ctx)
                  * certificate among the ones from the trust store.
                  */
                 if ((search &amp; S_DOALTERNATE) != 0) {
-                    OPENSSL_assert(num &gt; i &amp;&amp; i &gt; 0 &amp;&amp; ss == 0);
+                    if (!ossl_assert(num &gt; i &amp;&amp; i &gt; 0 &amp;&amp; ss == 0)) {
+                        X509err(X509_F_BUILD_CHAIN, ERR_R_INTERNAL_ERROR);
+                        X509_free(xtmp);
+                        trust = X509_TRUST_REJECTED;
+                        ctx-&gt;error = X509_V_ERR_UNSPECIFIED;
+                        search = 0;
+                        continue;
+                    }
                     search &amp;= ~S_DOALTERNATE;
                     for (; num &gt; i; --num)
                         X509_free(sk_X509_pop(ctx-&gt;chain));
@@ -3043,7 +3054,13 @@ static int build_chain(X509_STORE_CTX *ctx)
                  * certificate with ctx-&gt;num_untrusted &lt;= num.
                  */
                 if (ok) {
-                    OPENSSL_assert(ctx-&gt;num_untrusted &lt;= num);
+                    if (!ossl_assert(ctx-&gt;num_untrusted &lt;= num)) {
+                        X509err(X509_F_BUILD_CHAIN, ERR_R_INTERNAL_ERROR);
+                        trust = X509_TRUST_REJECTED;
+                        ctx-&gt;error = X509_V_ERR_UNSPECIFIED;
+                        search = 0;
+                        continue;
+                    }
                     search &amp;= ~S_DOUNTRUSTED;
                     switch (trust = check_trust(ctx, num)) {
                     case X509_TRUST_TRUSTED:
@@ -3082,7 +3099,13 @@ static int build_chain(X509_STORE_CTX *ctx)
          */
         if ((search &amp; S_DOUNTRUSTED) != 0) {
             num = sk_X509_num(ctx-&gt;chain);
-            OPENSSL_assert(num == ctx-&gt;num_untrusted);
+            if (!ossl_assert(num == ctx-&gt;num_untrusted)) {
+                X509err(X509_F_BUILD_CHAIN, ERR_R_INTERNAL_ERROR);
+                trust = X509_TRUST_REJECTED;
+                ctx-&gt;error = X509_V_ERR_UNSPECIFIED;
+                search = 0;
+                continue;
+            }
             x = sk_X509_value(ctx-&gt;chain, num-1);
 
             /*
diff --git a/crypto/x509/x_x509.c b/crypto/x509/x_x509.c
index 6783fd8..f83ebed 100644
--- a/crypto/x509/x_x509.c
+++ b/crypto/x509/x_x509.c
@@ -145,8 +145,6 @@ static int i2d_x509_aux_internal(X509 *a, unsigned char **pp)
     int length, tmplen;
     unsigned char *start = pp != NULL ? *pp : NULL;
 
-    OPENSSL_assert(pp == NULL || *pp != NULL);
-
     /*
      * This might perturb *pp on error, but fixing that belongs in i2d_X509()
      * not here.  It should be that if a == NULL length is zero, but we check
diff --git a/crypto/x509v3/v3_addr.c b/crypto/x509v3/v3_addr.c
index ef1d775..f4e1298 100644
--- a/crypto/x509v3/v3_addr.c
+++ b/crypto/x509v3/v3_addr.c
@@ -340,7 +340,8 @@ static int range_should_be_prefix(const unsigned char *min,
     unsigned char mask;
     int i, j;
 
-    OPENSSL_assert(memcmp(min, max, length) &lt;= 0);
+    if (memcmp(min, max, length) &lt;= 0)
+        return -1;
     for (i = 0; i &lt; length &amp;&amp; min[i] == max[i]; i++) ;
     for (j = length - 1; j &gt;= 0 &amp;&amp; min[j] == 0x00 &amp;&amp; max[j] == 0xFF; j--) ;
     if (i &lt; j)
@@ -429,7 +430,6 @@ static int make_addressRange(IPAddressOrRange **result,
     if ((aor = IPAddressOrRange_new()) == NULL)
         return 0;
     aor-&gt;type = IPAddressOrRange_addressRange;
-    OPENSSL_assert(aor-&gt;u.addressRange == NULL);
     if ((aor-&gt;u.addressRange = IPAddressRange_new()) == NULL)
         goto err;
     if (aor-&gt;u.addressRange-&gt;min == NULL &amp;&amp;
@@ -496,7 +496,6 @@ static IPAddressFamily *make_IPAddressFamily(IPAddrBlocks *addr,
 
     for (i = 0; i &lt; sk_IPAddressFamily_num(addr); i++) {
         f = sk_IPAddressFamily_value(addr, i);
-        OPENSSL_assert(f-&gt;addressFamily-&gt;data != NULL);
         if (f-&gt;addressFamily-&gt;length == keylen &amp;&amp;
             !memcmp(f-&gt;addressFamily-&gt;data, key, keylen))
             return f;
@@ -875,7 +874,8 @@ int X509v3_addr_canonize(IPAddrBlocks *addr)
     }
     (void)sk_IPAddressFamily_set_cmp_func(addr, IPAddressFamily_cmp);
     sk_IPAddressFamily_sort(addr);
-    OPENSSL_assert(X509v3_addr_is_canonical(addr));
+    if (!ossl_assert(X509v3_addr_is_canonical(addr)))
+        return 0;
     return 1;
 }
 
@@ -1180,9 +1180,13 @@ static int addr_validate_path_internal(X509_STORE_CTX *ctx,
     int i, j, ret = 1;
     X509 *x;
 
-    OPENSSL_assert(chain != NULL &amp;&amp; sk_X509_num(chain) &gt; 0);
-    OPENSSL_assert(ctx != NULL || ext != NULL);
-    OPENSSL_assert(ctx == NULL || ctx-&gt;verify_cb != NULL);
+    if (!ossl_assert(chain != NULL &amp;&amp; sk_X509_num(chain) &gt; 0)
+            || !ossl_assert(ctx != NULL || ext != NULL)
+            || !ossl_assert(ctx == NULL || ctx-&gt;verify_cb != NULL)) {
+        if (ctx != NULL)
+            ctx-&gt;error = X509_V_ERR_UNSPECIFIED;
+        return 0;
+    }
 
     /*
      * Figure out where to start.  If we don't have an extension to
@@ -1195,7 +1199,6 @@ static int addr_validate_path_internal(X509_STORE_CTX *ctx,
     } else {
         i = 0;
         x = sk_X509_value(chain, i);
-        OPENSSL_assert(x != NULL);
         if ((ext = x-&gt;rfc3779_addr) == NULL)
             goto done;
     }
@@ -1205,7 +1208,8 @@ static int addr_validate_path_internal(X509_STORE_CTX *ctx,
     if ((child = sk_IPAddressFamily_dup(ext)) == NULL) {
         X509V3err(X509V3_F_ADDR_VALIDATE_PATH_INTERNAL,
                   ERR_R_MALLOC_FAILURE);
-        ctx-&gt;error = X509_V_ERR_OUT_OF_MEM;
+        if (ctx != NULL)
+            ctx-&gt;error = X509_V_ERR_OUT_OF_MEM;
         ret = 0;
         goto done;
     }
@@ -1216,7 +1220,6 @@ static int addr_validate_path_internal(X509_STORE_CTX *ctx,
      */
     for (i++; i &lt; sk_X509_num(chain); i++) {
         x = sk_X509_value(chain, i);
-        OPENSSL_assert(x != NULL);
         if (!X509v3_addr_is_canonical(x-&gt;rfc3779_addr))
             validation_err(X509_V_ERR_INVALID_EXTENSION);
         if (x-&gt;rfc3779_addr == NULL) {
@@ -1260,7 +1263,6 @@ static int addr_validate_path_internal(X509_STORE_CTX *ctx,
     /*
      * Trust anchor can't inherit.
      */
-    OPENSSL_assert(x != NULL);
     if (x-&gt;rfc3779_addr != NULL) {
         for (j = 0; j &lt; sk_IPAddressFamily_num(x-&gt;rfc3779_addr); j++) {
             IPAddressFamily *fp =
@@ -1283,6 +1285,12 @@ static int addr_validate_path_internal(X509_STORE_CTX *ctx,
  */
 int X509v3_addr_validate_path(X509_STORE_CTX *ctx)
 {
+    if (ctx-&gt;chain == NULL
+            || sk_X509_num(ctx-&gt;chain) == 0
+            || ctx-&gt;verify_cb == NULL) {
+        ctx-&gt;error = X509_V_ERR_UNSPECIFIED;
+        return 0;
+    }
     return addr_validate_path_internal(ctx, ctx-&gt;chain, NULL);
 }
 
diff --git a/crypto/x509v3/v3_asid.c b/crypto/x509v3/v3_asid.c
index af4fcf4..6bc4afd 100644
--- a/crypto/x509v3/v3_asid.c
+++ b/crypto/x509v3/v3_asid.c
@@ -11,6 +11,7 @@
  * Implementation of RFC 3779 section 3.2.
  */
 
+#include &lt;assert.h&gt;
 #include &lt;stdio.h&gt;
 #include &lt;string.h&gt;
 #include &quot;internal/cryptlib.h&quot;
@@ -123,13 +124,13 @@ static int ASIdOrRange_cmp(const ASIdOrRange *const *a_,
 {
     const ASIdOrRange *a = *a_, *b = *b_;
 
-    OPENSSL_assert((a-&gt;type == ASIdOrRange_id &amp;&amp; a-&gt;u.id != NULL) ||
-                   (a-&gt;type == ASIdOrRange_range &amp;&amp; a-&gt;u.range != NULL &amp;&amp;
-                    a-&gt;u.range-&gt;min != NULL &amp;&amp; a-&gt;u.range-&gt;max != NULL));
+    assert((a-&gt;type == ASIdOrRange_id &amp;&amp; a-&gt;u.id != NULL) ||
+           (a-&gt;type == ASIdOrRange_range &amp;&amp; a-&gt;u.range != NULL &amp;&amp;
+            a-&gt;u.range-&gt;min != NULL &amp;&amp; a-&gt;u.range-&gt;max != NULL));
 
-    OPENSSL_assert((b-&gt;type == ASIdOrRange_id &amp;&amp; b-&gt;u.id != NULL) ||
-                   (b-&gt;type == ASIdOrRange_range &amp;&amp; b-&gt;u.range != NULL &amp;&amp;
-                    b-&gt;u.range-&gt;min != NULL &amp;&amp; b-&gt;u.range-&gt;max != NULL));
+    assert((b-&gt;type == ASIdOrRange_id &amp;&amp; b-&gt;u.id != NULL) ||
+           (b-&gt;type == ASIdOrRange_range &amp;&amp; b-&gt;u.range != NULL &amp;&amp;
+            b-&gt;u.range-&gt;min != NULL &amp;&amp; b-&gt;u.range-&gt;max != NULL));
 
     if (a-&gt;type == ASIdOrRange_id &amp;&amp; b-&gt;type == ASIdOrRange_id)
         return ASN1_INTEGER_cmp(a-&gt;u.id, b-&gt;u.id);
@@ -167,7 +168,6 @@ int X509v3_asid_add_inherit(ASIdentifiers *asid, int which)
     if (*choice == NULL) {
         if ((*choice = ASIdentifierChoice_new()) == NULL)
             return 0;
-        OPENSSL_assert((*choice)-&gt;u.inherit == NULL);
         if (((*choice)-&gt;u.inherit = ASN1_NULL_new()) == NULL)
             return 0;
         (*choice)-&gt;type = ASIdentifierChoice_inherit;
@@ -200,7 +200,6 @@ int X509v3_asid_add_id_or_range(ASIdentifiers *asid,
     if (*choice == NULL) {
         if ((*choice = ASIdentifierChoice_new()) == NULL)
             return 0;
-        OPENSSL_assert((*choice)-&gt;u.asIdsOrRanges == NULL);
         (*choice)-&gt;u.asIdsOrRanges = sk_ASIdOrRange_new(ASIdOrRange_cmp);
         if ((*choice)-&gt;u.asIdsOrRanges == NULL)
             return 0;
@@ -232,20 +231,23 @@ int X509v3_asid_add_id_or_range(ASIdentifiers *asid,
 /*
  * Extract min and max values from an ASIdOrRange.
  */
-static void extract_min_max(ASIdOrRange *aor,
-                            ASN1_INTEGER **min, ASN1_INTEGER **max)
+static int extract_min_max(ASIdOrRange *aor,
+                           ASN1_INTEGER **min, ASN1_INTEGER **max)
 {
-    OPENSSL_assert(aor != NULL &amp;&amp; min != NULL &amp;&amp; max != NULL);
+    if (!ossl_assert(aor != NULL))
+        return 0;
     switch (aor-&gt;type) {
     case ASIdOrRange_id:
         *min = aor-&gt;u.id;
         *max = aor-&gt;u.id;
-        return;
+        return 1;
     case ASIdOrRange_range:
         *min = aor-&gt;u.range-&gt;min;
         *max = aor-&gt;u.range-&gt;max;
-        return;
+        return 1;
     }
+
+    return 0;
 }
 
 /*
@@ -279,8 +281,9 @@ static int ASIdentifierChoice_is_canonical(ASIdentifierChoice *choice)
         ASN1_INTEGER *a_min = NULL, *a_max = NULL, *b_min = NULL, *b_max =
             NULL;
 
-        extract_min_max(a, &amp;a_min, &amp;a_max);
-        extract_min_max(b, &amp;b_min, &amp;b_max);
+        if (!extract_min_max(a, &amp;a_min, &amp;a_max)
+                || !extract_min_max(b, &amp;b_min, &amp;b_max))
+            goto done;
 
         /*
          * Punt misordered list, overlapping start, or inverted range.
@@ -318,8 +321,8 @@ static int ASIdentifierChoice_is_canonical(ASIdentifierChoice *choice)
         ASIdOrRange *a = sk_ASIdOrRange_value(choice-&gt;u.asIdsOrRanges, i);
         ASN1_INTEGER *a_min, *a_max;
         if (a != NULL &amp;&amp; a-&gt;type == ASIdOrRange_range) {
-            extract_min_max(a, &amp;a_min, &amp;a_max);
-            if (ASN1_INTEGER_cmp(a_min, a_max) &gt; 0)
+            if (!extract_min_max(a, &amp;a_min, &amp;a_max)
+                    || ASN1_INTEGER_cmp(a_min, a_max) &gt; 0)
                 goto done;
         }
     }
@@ -382,13 +385,15 @@ static int ASIdentifierChoice_canonize(ASIdentifierChoice *choice)
         ASN1_INTEGER *a_min = NULL, *a_max = NULL, *b_min = NULL, *b_max =
             NULL;
 
-        extract_min_max(a, &amp;a_min, &amp;a_max);
-        extract_min_max(b, &amp;b_min, &amp;b_max);
+        if (!extract_min_max(a, &amp;a_min, &amp;a_max)
+                || !extract_min_max(b, &amp;b_min, &amp;b_max))
+            goto done;
 
         /*
          * Make sure we're properly sorted (paranoia).
          */
-        OPENSSL_assert(ASN1_INTEGER_cmp(a_min, b_min) &lt;= 0);
+        if (!ossl_assert(ASN1_INTEGER_cmp(a_min, b_min) &lt;= 0))
+            goto done;
 
         /*
          * Punt inverted ranges.
@@ -464,13 +469,15 @@ static int ASIdentifierChoice_canonize(ASIdentifierChoice *choice)
         ASIdOrRange *a = sk_ASIdOrRange_value(choice-&gt;u.asIdsOrRanges, i);
         ASN1_INTEGER *a_min, *a_max;
         if (a != NULL &amp;&amp; a-&gt;type == ASIdOrRange_range) {
-            extract_min_max(a, &amp;a_min, &amp;a_max);
-            if (ASN1_INTEGER_cmp(a_min, a_max) &gt; 0)
+            if (!extract_min_max(a, &amp;a_min, &amp;a_max)
+                    || ASN1_INTEGER_cmp(a_min, a_max) &gt; 0)
                 goto done;
         }
     }
 
-    OPENSSL_assert(ASIdentifierChoice_is_canonical(choice)); /* Paranoia */
+    /* Paranoia */
+    if (!ossl_assert(ASIdentifierChoice_is_canonical(choice)))
+        goto done;
 
     ret = 1;
 
@@ -655,7 +662,8 @@ static int asid_contains(ASIdOrRanges *parent, ASIdOrRanges *child)
 
     p = 0;
     for (c = 0; c &lt; sk_ASIdOrRange_num(child); c++) {
-        extract_min_max(sk_ASIdOrRange_value(child, c), &amp;c_min, &amp;c_max);
+        if (!extract_min_max(sk_ASIdOrRange_value(child, c), &amp;c_min, &amp;c_max))
+            return 0;
         for (;; p++) {
             if (p &gt;= sk_ASIdOrRange_num(parent))
                 return 0;
@@ -715,9 +723,14 @@ static int asid_validate_path_internal(X509_STORE_CTX *ctx,
     int i, ret = 1, inherit_as = 0, inherit_rdi = 0;
     X509 *x;
 
-    OPENSSL_assert(chain != NULL &amp;&amp; sk_X509_num(chain) &gt; 0);
-    OPENSSL_assert(ctx != NULL || ext != NULL);
-    OPENSSL_assert(ctx == NULL || ctx-&gt;verify_cb != NULL);
+    if (!ossl_assert(chain != NULL &amp;&amp; sk_X509_num(chain) &gt; 0)
+            || !ossl_assert(ctx != NULL || ext != NULL)
+            || !ossl_assert(ctx == NULL || ctx-&gt;verify_cb != NULL)) {
+        if (ctx != NULL)
+            ctx-&gt;error = X509_V_ERR_UNSPECIFIED;
+        return 0;
+    }
+
 
     /*
      * Figure out where to start.  If we don't have an extension to
@@ -730,7 +743,6 @@ static int asid_validate_path_internal(X509_STORE_CTX *ctx,
     } else {
         i = 0;
         x = sk_X509_value(chain, i);
-        OPENSSL_assert(x != NULL);
         if ((ext = x-&gt;rfc3779_asid) == NULL)
             goto done;
     }
@@ -763,7 +775,11 @@ static int asid_validate_path_internal(X509_STORE_CTX *ctx,
      */
     for (i++; i &lt; sk_X509_num(chain); i++) {
         x = sk_X509_value(chain, i);
-        OPENSSL_assert(x != NULL);
+        if (!ossl_assert(x != NULL)) {
+            if (ctx != NULL)
+                ctx-&gt;error = X509_V_ERR_UNSPECIFIED;
+            return 0;
+        }
         if (x-&gt;rfc3779_asid == NULL) {
             if (child_as != NULL || child_rdi != NULL)
                 validation_err(X509_V_ERR_UNNESTED_RESOURCE);
@@ -809,7 +825,11 @@ static int asid_validate_path_internal(X509_STORE_CTX *ctx,
     /*
      * Trust anchor can't inherit.
      */
-    OPENSSL_assert(x != NULL);
+    if (!ossl_assert(x != NULL)) {
+        if (ctx != NULL)
+            ctx-&gt;error = X509_V_ERR_UNSPECIFIED;
+        return 0;
+    }
     if (x-&gt;rfc3779_asid != NULL) {
         if (x-&gt;rfc3779_asid-&gt;asnum != NULL &amp;&amp;
             x-&gt;rfc3779_asid-&gt;asnum-&gt;type == ASIdentifierChoice_inherit)
@@ -830,6 +850,12 @@ static int asid_validate_path_internal(X509_STORE_CTX *ctx,
  */
 int X509v3_asid_validate_path(X509_STORE_CTX *ctx)
 {
+    if (ctx-&gt;chain == NULL
+            || sk_X509_num(ctx-&gt;chain) == 0
+            || ctx-&gt;verify_cb == NULL) {
+        ctx-&gt;error = X509_V_ERR_UNSPECIFIED;
+        return 0;
+    }
     return asid_validate_path_internal(ctx, ctx-&gt;chain, NULL);
 }
 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016028.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="016030.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16029">[ date ]</a>
              <a href="thread.html#16029">[ thread ]</a>
              <a href="subject.html#16029">[ subject ]</a>
              <a href="author.html#16029">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
