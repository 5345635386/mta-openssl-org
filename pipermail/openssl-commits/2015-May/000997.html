<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2015-May/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1430488946.882250.20908.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000996.html">
   <LINK REL="Next"  HREF="000998.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Rich Salz</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1430488946.882250.20908.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">rsalz at openssl.org
       </A><BR>
    <I>Fri May  1 14:02:26 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="000996.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="000998.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#997">[ date ]</a>
              <a href="thread.html#997">[ thread ]</a>
              <a href="subject.html#997">[ subject ]</a>
              <a href="author.html#997">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  b548a1f11c06ccdfa4f52a539912d22d77ee309e (commit)
      from  33fbca83dcd05b77f807fab205c4523b8cfe85b5 (commit)


- Log -----------------------------------------------------------------
commit b548a1f11c06ccdfa4f52a539912d22d77ee309e
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
Date:   Fri May 1 10:02:07 2015 -0400

    free null cleanup finale
    
    Don't check for NULL before calling OPENSSL_free
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;

-----------------------------------------------------------------------

Summary of changes:
 apps/apps.c                      |  8 ++---
 apps/asn1pars.c                  |  8 ++---
 apps/ca.c                        | 12 +++----
 apps/cms.c                       | 12 +++----
 apps/dgst.c                      |  3 +-
 apps/dsa.c                       |  6 ++--
 apps/ec.c                        |  6 ++--
 apps/ecparam.c                   |  3 +-
 apps/enc.c                       |  9 ++---
 apps/engine.c                    | 12 +++----
 apps/gendsa.c                    |  3 +-
 apps/genpkey.c                   |  3 +-
 apps/genrsa.c                    |  3 +-
 apps/ocsp.c                      | 19 ++++------
 apps/openssl.c                   |  9 ++---
 apps/passwd.c                    |  6 ++--
 apps/pkcs12.c                    |  6 ++--
 apps/pkcs8.c                     |  6 ++--
 apps/pkey.c                      |  6 ++--
 apps/pkeyutl.c                   | 14 +++-----
 apps/req.c                       |  9 ++---
 apps/rsa.c                       |  6 ++--
 apps/rsautl.c                    |  9 ++---
 apps/s_client.c                  | 10 ++----
 apps/s_server.c                  | 10 ++----
 apps/s_socket.c                  |  3 +-
 apps/smime.c                     |  3 +-
 apps/speed.c                     |  6 ++--
 apps/spkac.c                     |  3 +-
 apps/srp.c                       | 37 +++++++------------
 apps/x509.c                      |  6 ++--
 crypto/asn1/a_bitstr.c           |  3 +-
 crypto/asn1/a_enum.c             |  3 +-
 crypto/asn1/a_gentm.c            |  3 +-
 crypto/asn1/a_int.c              |  9 ++---
 crypto/asn1/a_mbstr.c            |  8 ++---
 crypto/asn1/a_object.c           | 12 +++----
 crypto/asn1/a_sign.c             |  6 ++--
 crypto/asn1/a_utctm.c            |  3 +-
 crypto/asn1/ameth_lib.c          |  6 ++--
 crypto/asn1/asn1_gen.c           |  9 ++---
 crypto/asn1/asn1_lib.c           |  5 ++-
 crypto/asn1/asn_mime.c           | 30 ++++++----------
 crypto/asn1/asn_pack.c           |  6 ++--
 crypto/asn1/bio_asn1.c           |  3 +-
 crypto/asn1/bio_ndef.c           |  6 ++--
 crypto/asn1/f_enum.c             |  3 +-
 crypto/asn1/f_int.c              |  3 +-
 crypto/asn1/f_string.c           |  3 +-
 crypto/asn1/t_x509.c             |  6 ++--
 crypto/asn1/tasn_dec.c           |  5 ++-
 crypto/asn1/tasn_prn.c           |  3 +-
 crypto/asn1/tasn_scn.c           |  3 +-
 crypto/asn1/tasn_utl.c           |  6 ++--
 crypto/asn1/x_info.c             |  3 +-
 crypto/asn1/x_pkey.c             |  2 +-
 crypto/asn1/x_pubkey.c           |  3 +-
 crypto/asn1/x_x509.c             |  7 ++--
 crypto/bio/b_sock.c              |  3 +-
 crypto/bio/bf_buff.c             |  9 ++---
 crypto/bio/bf_lbuf.c             |  3 +-
 crypto/bio/bf_nbio.c             |  3 +-
 crypto/bio/bss_acpt.c            |  9 ++---
 crypto/bio/bss_bio.c             | 11 ++----
 crypto/bio/bss_conn.c            | 21 ++++-------
 crypto/bio/bss_dgram.c           |  9 ++---
 crypto/bn/bn_exp.c               |  3 +-
 crypto/bn/bn_gf2m.c              | 15 +++-----
 crypto/bn/bn_intern.c            | 14 +++-----
 crypto/bn/bn_lib.c               |  5 ++-
 crypto/bn/bn_print.c             | 13 +++----
 crypto/bn/bn_rand.c              |  3 +-
 crypto/cms/cms_env.c             |  9 +++--
 crypto/cms/cms_ess.c             |  3 +-
 crypto/cms/cms_kari.c            |  5 ++-
 crypto/cms/cms_pwri.c            |  2 +-
 crypto/cms/cms_sd.c              |  3 +-
 crypto/comp/c_zlib.c             | 15 +++-----
 crypto/conf/conf_api.c           |  3 +-
 crypto/conf/conf_def.c           | 18 ++++------
 crypto/conf/conf_mod.c           |  6 ++--
 crypto/dh/dh_ameth.c             | 17 ++++-----
 crypto/dh/dh_kdf.c               |  3 +-
 crypto/dh/dh_lib.c               |  3 +-
 crypto/dh/dh_pmeth.c             |  6 ++--
 crypto/dsa/dsa_ameth.c           | 12 +++----
 crypto/dsa/dsa_gen.c             |  3 +-
 crypto/dsa/dsa_pmeth.c           |  3 +-
 crypto/dso/dso_dl.c              |  3 +-
 crypto/dso/dso_dlfcn.c           |  3 +-
 crypto/dso/dso_lib.c             | 10 ++----
 crypto/dso/dso_vms.c             |  6 ++--
 crypto/dso/dso_win32.c           |  6 ++--
 crypto/ec/ec_ameth.c             |  6 ++--
 crypto/ec/ec_asn1.c              | 15 +++-----
 crypto/ec/ec_lib.c               | 14 +++-----
 crypto/ec/ec_mult.c              | 10 ++----
 crypto/ec/ec_pmeth.c             |  6 ++--
 crypto/ec/eck_prn.c              |  3 +-
 crypto/ec/ecp_nistp224.c         |  9 ++---
 crypto/ec/ecp_nistp256.c         |  9 ++---
 crypto/ec/ecp_nistp521.c         |  9 ++---
 crypto/ec/ecp_nistz256.c         | 22 ++++--------
 crypto/ecdh/ech_ossl.c           |  3 +-
 crypto/engine/eng_cryptodev.c    |  8 ++---
 crypto/engine/eng_dyn.c          | 19 ++++------
 crypto/err/err.c                 |  3 +-
 crypto/evp/evp_enc.c             |  6 ++--
 crypto/ex_data.c                 |  9 ++---
 crypto/mem.c                     |  3 +-
 crypto/objects/obj_dat.c         |  9 ++---
 crypto/objects/obj_lib.c         | 12 +++----
 crypto/ocsp/ocsp_ext.c           |  3 +-
 crypto/ocsp/ocsp_ht.c            |  3 +-
 crypto/ocsp/ocsp_lib.c           | 12 +++----
 crypto/pem/pem_info.c            | 18 ++++------
 crypto/pem/pem_seal.c            |  6 ++--
 crypto/pem/pem_sign.c            |  3 +-
 crypto/pem/pvkfmt.c              |  5 ++-
 crypto/pkcs7/pk7_doit.c          |  8 ++---
 crypto/rsa/rsa_ameth.c           |  3 +-
 crypto/rsa/rsa_oaep.c            |  6 ++--
 crypto/rsa/rsa_pk1.c             |  3 +-
 crypto/rsa/rsa_pmeth.c           | 12 +++----
 crypto/rsa/rsa_pss.c             |  6 ++--
 crypto/stack/stack.c             |  6 ++--
 crypto/store/str_mem.c           |  3 +-
 crypto/threads/th-lock.c         |  6 ++--
 crypto/txt_db/txt_db.c           | 18 ++++------
 crypto/ui/ui_lib.c               | 12 +++----
 crypto/x509/by_dir.c             |  3 +-
 crypto/x509/x509_vpm.c           | 26 +++++---------
 crypto/x509/x509spki.c           |  6 ++--
 crypto/x509/x_name.c             |  9 ++---
 crypto/x509v3/v3_conf.c          |  6 ++--
 crypto/x509v3/v3_prn.c           |  3 +-
 crypto/x509v3/v3_scts.c          |  3 +-
 crypto/x509v3/v3_utl.c           | 24 +++++--------
 demos/b64.c                      |  6 ++--
 demos/engines/zencod/hw_zencod.c |  9 ++---
 engines/ccgost/gost_ameth.c      |  4 +--
 engines/ccgost/gost_ctl.c        | 16 ++++-----
 engines/ccgost/gost_pmeth.c      |  4 +--
 engines/e_4758cca.c              |  9 ++---
 engines/e_aep.c                  |  3 +-
 engines/e_atalla.c               |  3 +-
 engines/e_capi.c                 | 48 +++++++++----------------
 engines/e_chil.c                 |  3 +-
 engines/e_cswift.c               | 18 ++++------
 engines/e_nuron.c                |  3 +-
 engines/e_ubsec.c                |  3 +-
 ssl/bio_ssl.c                    |  3 +-
 ssl/d1_both.c                    |  9 ++---
 ssl/record/rec_layer_d1.c        | 21 ++++-------
 ssl/record/ssl3_buffer.c         | 15 +++-----
 ssl/record/ssl3_record.c         |  3 +-
 ssl/s3_clnt.c                    | 36 +++++++------------
 ssl/s3_lib.c                     | 23 +++++-------
 ssl/s3_srvr.c                    | 15 +++-----
 ssl/ssl_asn1.c                   |  6 ++--
 ssl/ssl_ciph.c                   |  2 +-
 ssl/ssl_conf.c                   | 12 +++----
 ssl/ssl_lib.c                    | 18 ++++------
 ssl/ssl_sess.c                   |  7 ++--
 ssl/t1_enc.c                     |  6 ++--
 ssl/t1_ext.c                     |  3 +-
 ssl/t1_lib.c                     | 78 ++++++++++++++--------------------------
 test/dhtest.c                    |  6 ++--
 test/ecdhtest.c                  |  9 ++---
 test/ecdsatest.c                 |  9 ++---
 test/evp_extra_test.c            |  4 +--
 test/evp_test.c                  | 31 ++++++----------
 test/ssltest.c                   | 13 +++----
 173 files changed, 509 insertions(+), 1012 deletions(-)

diff --git a/apps/apps.c b/apps/apps.c
index d68594a..46cc5a0 100644
--- a/apps/apps.c
+++ b/apps/apps.c
@@ -2165,9 +2165,7 @@ void jpake_client_auth(BIO *out, BIO *conn, const char *secret)
 
     BIO_puts(out, &quot;JPAKE authentication succeeded, setting PSK\n&quot;);
 
-    if (psk_key)
-        OPENSSL_free(psk_key);
-
+    OPENSSL_free(psk_key);
     psk_key = BN_bn2hex(JPAKE_get_shared_key(ctx));
 
     BIO_pop(bconn);
@@ -2197,9 +2195,7 @@ void jpake_server_auth(BIO *out, BIO *conn, const char *secret)
 
     BIO_puts(out, &quot;JPAKE authentication succeeded, setting PSK\n&quot;);
 
-    if (psk_key)
-        OPENSSL_free(psk_key);
-
+    OPENSSL_free(psk_key);
     psk_key = BN_bn2hex(JPAKE_get_shared_key(ctx));
 
     BIO_pop(bconn);
diff --git a/apps/asn1pars.c b/apps/asn1pars.c
index 7e1dfb7..01a50f4 100644
--- a/apps/asn1pars.c
+++ b/apps/asn1pars.c
@@ -321,11 +321,9 @@ int asn1parse_main(int argc, char **argv)
         ERR_print_errors(bio_err);
     if (buf != NULL)
         BUF_MEM_free(buf);
-    if (name != NULL)
-        OPENSSL_free(name);
-    if (header != NULL)
-        OPENSSL_free(header);
-    if (strictpem &amp;&amp; str != NULL)
+    OPENSSL_free(name);
+    OPENSSL_free(header);
+    if (strictpem)
         OPENSSL_free(str);
     ASN1_TYPE_free(at);
     if (osk != NULL)
diff --git a/apps/ca.c b/apps/ca.c
index b703b42..ad6b000 100644
--- a/apps/ca.c
+++ b/apps/ca.c
@@ -2271,8 +2271,7 @@ static int do_revoke(X509 *x509, CA_DB *db, int type, char *value)
     ok = 1;
  end:
     for (i = 0; i &lt; DB_NUMBER; i++) {
-        if (row[i] != NULL)
-            OPENSSL_free(row[i]);
+        OPENSSL_free(row[i]);
     }
     return (ok);
 }
@@ -2339,8 +2338,7 @@ static int get_certificate_status(const char *serial, CA_DB *db)
     }
  end:
     for (i = 0; i &lt; DB_NUMBER; i++) {
-        if (row[i] != NULL)
-            OPENSSL_free(row[i]);
+        OPENSSL_free(row[i]);
     }
     return (ok);
 }
@@ -2564,8 +2562,7 @@ int make_revoked(X509_REVOKED *rev, const char *str)
 
  end:
 
-    if (tmp)
-        OPENSSL_free(tmp);
+    OPENSSL_free(tmp);
     ASN1_OBJECT_free(hold);
     ASN1_GENERALIZEDTIME_free(comp_time);
     ASN1_ENUMERATED_free(rtmp);
@@ -2719,8 +2716,7 @@ int unpack_revinfo(ASN1_TIME **prevtm, int *preason, ASN1_OBJECT **phold,
 
  end:
 
-    if (tmp)
-        OPENSSL_free(tmp);
+    OPENSSL_free(tmp);
     ASN1_GENERALIZEDTIME_free(comp_time);
 
     return ret;
diff --git a/apps/cms.c b/apps/cms.c
index 907b108..25e3ad6 100644
--- a/apps/cms.c
+++ b/apps/cms.c
@@ -1121,12 +1121,9 @@ int cms_main(int argc, char **argv)
         sk_OPENSSL_STRING_free(sksigners);
     if (skkeys)
         sk_OPENSSL_STRING_free(skkeys);
-    if (secret_key)
-        OPENSSL_free(secret_key);
-    if (secret_keyid)
-        OPENSSL_free(secret_keyid);
-    if (pwri_tmp)
-        OPENSSL_free(pwri_tmp);
+    OPENSSL_free(secret_key);
+    OPENSSL_free(secret_keyid);
+    OPENSSL_free(pwri_tmp);
     ASN1_OBJECT_free(econtent_type);
     if (rr)
         CMS_ReceiptRequest_free(rr);
@@ -1152,8 +1149,7 @@ int cms_main(int argc, char **argv)
     BIO_free(in);
     BIO_free(indata);
     BIO_free_all(out);
-    if (passin)
-        OPENSSL_free(passin);
+    OPENSSL_free(passin);
     return (ret);
 }
 
diff --git a/apps/dgst.c b/apps/dgst.c
index 69211d3..a679cb9 100644
--- a/apps/dgst.c
+++ b/apps/dgst.c
@@ -451,8 +451,7 @@ int dgst_main(int argc, char **argv)
         sk_OPENSSL_STRING_free(sigopts);
     if (macopts)
         sk_OPENSSL_STRING_free(macopts);
-    if (sigbuf)
-        OPENSSL_free(sigbuf);
+    OPENSSL_free(sigbuf);
     BIO_free(bmd);
     return (ret);
 }
diff --git a/apps/dsa.c b/apps/dsa.c
index c23ed5d..d864c75 100644
--- a/apps/dsa.c
+++ b/apps/dsa.c
@@ -275,10 +275,8 @@ int dsa_main(int argc, char **argv)
  end:
     BIO_free_all(out);
     DSA_free(dsa);
-    if (passin)
-        OPENSSL_free(passin);
-    if (passout)
-        OPENSSL_free(passout);
+    OPENSSL_free(passin);
+    OPENSSL_free(passout);
     return (ret);
 }
 #else                           /* !OPENSSL_NO_DSA */
diff --git a/apps/ec.c b/apps/ec.c
index 471de47..c56150c 100644
--- a/apps/ec.c
+++ b/apps/ec.c
@@ -271,10 +271,8 @@ int ec_main(int argc, char **argv)
     BIO_free(in);
     BIO_free_all(out);
     EC_KEY_free(eckey);
-    if (passin)
-        OPENSSL_free(passin);
-    if (passout)
-        OPENSSL_free(passout);
+    OPENSSL_free(passin);
+    OPENSSL_free(passout);
     return (ret);
 }
 #else                           /* !OPENSSL_NO_EC */
diff --git a/apps/ecparam.c b/apps/ecparam.c
index 082df26..dd0e8f5 100644
--- a/apps/ecparam.c
+++ b/apps/ecparam.c
@@ -489,8 +489,7 @@ int ecparam_main(int argc, char **argv)
     BN_free(ec_gen);
     BN_free(ec_order);
     BN_free(ec_cofactor);
-    if (buffer)
-        OPENSSL_free(buffer);
+    OPENSSL_free(buffer);
     BIO_free(in);
     BIO_free_all(out);
     EC_GROUP_free(group);
diff --git a/apps/enc.c b/apps/enc.c
index 83067b8..8b892cf 100644
--- a/apps/enc.c
+++ b/apps/enc.c
@@ -564,10 +564,8 @@ int enc_main(int argc, char **argv)
     }
  end:
     ERR_print_errors(bio_err);
-    if (strbuf != NULL)
-        OPENSSL_free(strbuf);
-    if (buff != NULL)
-        OPENSSL_free(buff);
+    OPENSSL_free(strbuf);
+    OPENSSL_free(buff);
     BIO_free(in);
     BIO_free_all(out);
     BIO_free(benc);
@@ -575,8 +573,7 @@ int enc_main(int argc, char **argv)
 #ifdef ZLIB
     BIO_free(bzl);
 #endif
-    if (pass)
-        OPENSSL_free(pass);
+    OPENSSL_free(pass);
     return (ret);
 }
 
diff --git a/apps/engine.c b/apps/engine.c
index 448802b..c7c0aaf 100644
--- a/apps/engine.c
+++ b/apps/engine.c
@@ -252,10 +252,8 @@ static int util_verbose(ENGINE *e, int verbose, BIO *out, const char *indent)
         }
         OPENSSL_free(name);
         name = NULL;
-        if (desc) {
-            OPENSSL_free(desc);
-            desc = NULL;
-        }
+        OPENSSL_free(desc);
+        desc = NULL;
         /* Move to the next command */
         num = ENGINE_ctrl(e, ENGINE_CTRL_GET_NEXT_CMD_TYPE, num, NULL, NULL);
     } while (num &gt; 0);
@@ -265,10 +263,8 @@ static int util_verbose(ENGINE *e, int verbose, BIO *out, const char *indent)
  err:
     if (cmds)
         sk_OPENSSL_STRING_pop_free(cmds, identity);
-    if (name)
-        OPENSSL_free(name);
-    if (desc)
-        OPENSSL_free(desc);
+    OPENSSL_free(name);
+    OPENSSL_free(desc);
     return ret;
 }
 
diff --git a/apps/gendsa.c b/apps/gendsa.c
index 21988a0..75bd802 100644
--- a/apps/gendsa.c
+++ b/apps/gendsa.c
@@ -182,8 +182,7 @@ int gendsa_main(int argc, char **argv)
     BIO_free(in);
     BIO_free_all(out);
     DSA_free(dsa);
-    if (passout)
-        OPENSSL_free(passout);
+    OPENSSL_free(passout);
     return (ret);
 }
 #else                           /* !OPENSSL_NO_DSA */
diff --git a/apps/genpkey.c b/apps/genpkey.c
index ae68e7a..de14bd3 100644
--- a/apps/genpkey.c
+++ b/apps/genpkey.c
@@ -235,8 +235,7 @@ int genpkey_main(int argc, char **argv)
     EVP_PKEY_CTX_free(ctx);
     BIO_free_all(out);
     BIO_free(in);
-    if (pass)
-        OPENSSL_free(pass);
+    OPENSSL_free(pass);
 
     return ret;
 }
diff --git a/apps/genrsa.c b/apps/genrsa.c
index a3c00d8..a5ab658 100644
--- a/apps/genrsa.c
+++ b/apps/genrsa.c
@@ -218,8 +218,7 @@ int genrsa_main(int argc, char **argv)
     BN_GENCB_free(cb);
     RSA_free(rsa);
     BIO_free_all(out);
-    if (passout)
-        OPENSSL_free(passout);
+    OPENSSL_free(passout);
     if (ret != 0)
         ERR_print_errors(bio_err);
     return (ret);
diff --git a/apps/ocsp.c b/apps/ocsp.c
index 20dc1ae..d4ea019 100644
--- a/apps/ocsp.c
+++ b/apps/ocsp.c
@@ -271,12 +271,9 @@ int ocsp_main(int argc, char **argv)
             req_timeout = atoi(opt_arg());
             break;
         case OPT_URL:
-            if (thost)
-                OPENSSL_free(thost);
-            if (tport)
-                OPENSSL_free(tport);
-            if (tpath)
-                OPENSSL_free(tpath);
+            OPENSSL_free(thost);
+            OPENSSL_free(tport);
+            OPENSSL_free(tpath);
             if (!OCSP_parse_url(opt_arg(), &amp;host, &amp;port, &amp;path, &amp;use_ssl)) {
                 BIO_printf(bio_err, &quot;%s Error parsing URL\n&quot;, prog);
                 goto end;
@@ -753,13 +750,9 @@ int ocsp_main(int argc, char **argv)
     sk_X509_pop_free(sign_other, X509_free);
     sk_X509_pop_free(verify_other, X509_free);
     sk_CONF_VALUE_pop_free(headers, X509V3_conf_free);
-
-    if (thost)
-        OPENSSL_free(thost);
-    if (tport)
-        OPENSSL_free(tport);
-    if (tpath)
-        OPENSSL_free(tpath);
+    OPENSSL_free(thost);
+    OPENSSL_free(tport);
+    OPENSSL_free(tpath);
 
     return (ret);
 }
diff --git a/apps/openssl.c b/apps/openssl.c
index f6013f7..c6b048a 100644
--- a/apps/openssl.c
+++ b/apps/openssl.c
@@ -509,18 +509,15 @@ int main(int argc, char *argv[])
     }
     ret = 1;
  end:
-    if (copied_argv)
-        OPENSSL_free(copied_argv);
-    if (to_free)
-        OPENSSL_free(to_free);
+    OPENSSL_free(copied_argv);
+    OPENSSL_free(to_free);
     if (config != NULL) {
         NCONF_free(config);
         config = NULL;
     }
     if (prog != NULL)
         lh_FUNCTION_free(prog);
-    if (arg.argv != NULL)
-        OPENSSL_free(arg.argv);
+    OPENSSL_free(arg.argv);
 
     BIO_free(bio_in);
     BIO_free_all(bio_out);
diff --git a/apps/passwd.c b/apps/passwd.c
index c529792..8dd8542 100644
--- a/apps/passwd.c
+++ b/apps/passwd.c
@@ -284,10 +284,8 @@ int passwd_main(int argc, char **argv)
 
  end:
     ERR_print_errors(bio_err);
-    if (salt_malloc)
-        OPENSSL_free(salt_malloc);
-    if (passwd_malloc)
-        OPENSSL_free(passwd_malloc);
+    OPENSSL_free(salt_malloc);
+    OPENSSL_free(passwd_malloc);
     BIO_free(in);
     return (ret);
 }
diff --git a/apps/pkcs12.c b/apps/pkcs12.c
index b4b3730..4c62392 100644
--- a/apps/pkcs12.c
+++ b/apps/pkcs12.c
@@ -556,10 +556,8 @@ int pkcs12_main(int argc, char **argv)
     BIO_free_all(out);
     if (canames)
         sk_OPENSSL_STRING_free(canames);
-    if (passin)
-        OPENSSL_free(passin);
-    if (passout)
-        OPENSSL_free(passout);
+    OPENSSL_free(passin);
+    OPENSSL_free(passout);
     return (ret);
 }
 
diff --git a/apps/pkcs8.c b/apps/pkcs8.c
index 105c1cb..07ebf3b 100644
--- a/apps/pkcs8.c
+++ b/apps/pkcs8.c
@@ -343,10 +343,8 @@ int pkcs8_main(int argc, char **argv)
     EVP_PKEY_free(pkey);
     BIO_free_all(out);
     BIO_free(in);
-    if (passin)
-        OPENSSL_free(passin);
-    if (passout)
-        OPENSSL_free(passout);
+    OPENSSL_free(passin);
+    OPENSSL_free(passout);
 
     return ret;
 }
diff --git a/apps/pkey.c b/apps/pkey.c
index 716d6d0..f0930a7 100644
--- a/apps/pkey.c
+++ b/apps/pkey.c
@@ -208,10 +208,8 @@ int pkey_main(int argc, char **argv)
     EVP_PKEY_free(pkey);
     BIO_free_all(out);
     BIO_free(in);
-    if (passin)
-        OPENSSL_free(passin);
-    if (passout)
-        OPENSSL_free(passout);
+    OPENSSL_free(passin);
+    OPENSSL_free(passout);
 
     return ret;
 }
diff --git a/apps/pkeyutl.c b/apps/pkeyutl.c
index 3afe0eb..87e4950 100644
--- a/apps/pkeyutl.c
+++ b/apps/pkeyutl.c
@@ -322,12 +322,9 @@ int pkeyutl_main(int argc, char **argv)
     EVP_PKEY_CTX_free(ctx);
     BIO_free(in);
     BIO_free_all(out);
-    if (buf_in)
-        OPENSSL_free(buf_in);
-    if (buf_out)
-        OPENSSL_free(buf_out);
-    if (sig)
-        OPENSSL_free(sig);
+    OPENSSL_free(buf_in);
+    OPENSSL_free(buf_out);
+    OPENSSL_free(sig);
     return ret;
 }
 
@@ -413,10 +410,7 @@ static EVP_PKEY_CTX *init_ctx(int *pkeysize,
     }
 
  end:
-
-    if (passin)
-        OPENSSL_free(passin);
-
+    OPENSSL_free(passin);
     return ctx;
 
 }
diff --git a/apps/req.c b/apps/req.c
index 0502a64..4ff3b24 100644
--- a/apps/req.c
+++ b/apps/req.c
@@ -886,15 +886,12 @@ int req_main(int argc, char **argv)
     if (gen_eng)
         ENGINE_free(gen_eng);
 #endif
-    if (keyalgstr)
-        OPENSSL_free(keyalgstr);
+    OPENSSL_free(keyalgstr);
     X509_REQ_free(req);
     X509_free(x509ss);
     ASN1_INTEGER_free(serial);
-    if (passargin &amp;&amp; passin)
-        OPENSSL_free(passin);
-    if (passargout &amp;&amp; passout)
-        OPENSSL_free(passout);
+    OPENSSL_free(passin);
+    OPENSSL_free(passout);
     OBJ_cleanup();
     return (ret);
 }
diff --git a/apps/rsa.c b/apps/rsa.c
index 0a8e198..858699b 100644
--- a/apps/rsa.c
+++ b/apps/rsa.c
@@ -388,10 +388,8 @@ int rsa_main(int argc, char **argv)
  end:
     BIO_free_all(out);
     RSA_free(rsa);
-    if (passin)
-        OPENSSL_free(passin);
-    if (passout)
-        OPENSSL_free(passout);
+    OPENSSL_free(passin);
+    OPENSSL_free(passout);
     return (ret);
 }
 #else                           /* !OPENSSL_NO_RSA */
diff --git a/apps/rsautl.c b/apps/rsautl.c
index f138293..0ef6105 100644
--- a/apps/rsautl.c
+++ b/apps/rsautl.c
@@ -315,12 +315,9 @@ int rsautl_main(int argc, char **argv)
     RSA_free(rsa);
     BIO_free(in);
     BIO_free_all(out);
-    if (rsa_in)
-        OPENSSL_free(rsa_in);
-    if (rsa_out)
-        OPENSSL_free(rsa_out);
-    if (passin)
-        OPENSSL_free(passin);
+    OPENSSL_free(rsa_in);
+    OPENSSL_free(rsa_out);
+    OPENSSL_free(passin);
     return ret;
 }
 
diff --git a/apps/s_client.c b/apps/s_client.c
index 8d8340d..a24d2f3 100644
--- a/apps/s_client.c
+++ b/apps/s_client.c
@@ -1985,24 +1985,18 @@ int s_client_main(int argc, char **argv)
         SSL_free(con);
     }
 #if !defined(OPENSSL_NO_TLSEXT) &amp;&amp; !defined(OPENSSL_NO_NEXTPROTONEG)
-    if (next_proto.data)
-        OPENSSL_free(next_proto.data);
+    OPENSSL_free(next_proto.data);
 #endif
     SSL_CTX_free(ctx);
     X509_free(cert);
     sk_X509_CRL_pop_free(crls, X509_CRL_free);
     EVP_PKEY_free(key);
     sk_X509_pop_free(chain, X509_free);
-    if (pass)
-        OPENSSL_free(pass);
+    OPENSSL_free(pass);
     X509_VERIFY_PARAM_free(vpm);
     ssl_excert_free(exc);
     sk_OPENSSL_STRING_free(ssl_args);
     SSL_CONF_CTX_free(cctx);
-#ifndef OPENSSL_NO_JPAKE
-    if (jpake_secret &amp;&amp; psk_key)
-        OPENSSL_free(psk_key);
-#endif
     OPENSSL_clear_free(cbuf, BUFSIZZ);
     OPENSSL_clear_free(sbuf, BUFSIZZ);
     OPENSSL_clear_free(mbuf, BUFSIZZ);
diff --git a/apps/s_server.c b/apps/s_server.c
index a616b64..5fb275d 100644
--- a/apps/s_server.c
+++ b/apps/s_server.c
@@ -1956,10 +1956,6 @@ int s_server_main(int argc, char *argv[])
     ssl_excert_free(exc);
     sk_OPENSSL_STRING_free(ssl_args);
     SSL_CONF_CTX_free(cctx);
-#ifndef OPENSSL_NO_JPAKE
-    if (jpake_secret &amp;&amp; psk_key)
-        OPENSSL_free(psk_key);
-#endif
     BIO_free(bio_s_out);
     bio_s_out = NULL;
     BIO_free(bio_s_msg);
@@ -2931,8 +2927,7 @@ static int www_body(char *hostname, int s, int stype, unsigned char *context)
  err:
     if (ret &gt;= 0)
         BIO_printf(bio_s_out, &quot;ACCEPT\n&quot;);
-    if (buf != NULL)
-        OPENSSL_free(buf);
+    OPENSSL_free(buf);
     BIO_free_all(io);
     return (ret);
 }
@@ -3065,8 +3060,7 @@ static int rev_body(char *hostname, int s, int stype, unsigned char *context)
 
  err:
 
-    if (buf != NULL)
-        OPENSSL_free(buf);
+    OPENSSL_free(buf);
     BIO_free_all(io);
     return (ret);
 }
diff --git a/apps/s_socket.c b/apps/s_socket.c
index caa5b61..29240e8 100644
--- a/apps/s_socket.c
+++ b/apps/s_socket.c
@@ -354,8 +354,7 @@ int do_server(int port, int type, int *ret,
         } else
             sock = accept_socket;
         i = (*cb) (name, sock, type, context);
-        if (name != NULL)
-            OPENSSL_free(name);
+        OPENSSL_free(name);
         if (type == SOCK_STREAM)
             SHUTDOWN2(sock);
         if (naccept != -1)
diff --git a/apps/smime.c b/apps/smime.c
index 0fda865..8b8520b 100644
--- a/apps/smime.c
+++ b/apps/smime.c
@@ -664,8 +664,7 @@ int smime_main(int argc, char **argv)
     BIO_free(in);
     BIO_free(indata);
     BIO_free_all(out);
-    if (passin)
-        OPENSSL_free(passin);
+    OPENSSL_free(passin);
     return (ret);
 }
 
diff --git a/apps/speed.c b/apps/speed.c
index 08ab9c5..a5bd265 100644
--- a/apps/speed.c
+++ b/apps/speed.c
@@ -2529,8 +2529,6 @@ static void multiblock_speed(const EVP_CIPHER *evp_cipher)
         fprintf(stdout, &quot;\n&quot;);
     }
 
-    if (inp)
-        OPENSSL_free(inp);
-    if (out)
-        OPENSSL_free(out);
+    OPENSSL_free(inp);
+    OPENSSL_free(out);
 }
diff --git a/apps/spkac.c b/apps/spkac.c
index 7ceff9f..abae0e1 100644
--- a/apps/spkac.c
+++ b/apps/spkac.c
@@ -240,7 +240,6 @@ int spkac_main(int argc, char **argv)
     BIO_free(in);
     BIO_free_all(out);
     EVP_PKEY_free(pkey);
-    if (passin)
-        OPENSSL_free(passin);
+    OPENSSL_free(passin);
     return (ret);
 }
diff --git a/apps/srp.c b/apps/srp.c
index b984c14..960ca82 100644
--- a/apps/srp.c
+++ b/apps/srp.c
@@ -384,10 +384,8 @@ int srp_main(int argc, char **argv)
                            errorline, configfile);
             goto end;
         }
-        if (tofree) {
-            OPENSSL_free(tofree);
-            tofree = NULL;
-        }
+        OPENSSL_free(tofree);
+        tofree = NULL;
 
         /* Lets get the config section we are using */
         if (section == NULL) {
@@ -519,26 +517,16 @@ int srp_main(int argc, char **argv)
                 row[DB_srpgN] = BUF_strdup(gNid);
 
                 if (!row[DB_srpid] || !row[DB_srpgN] || !row[DB_srptype]
-                    || !row[DB_srpverifier] || !row[DB_srpsalt] || (userinfo
-                                                                    &amp;&amp;
-                                                                    (!(row
-                                                                       [DB_srpinfo]
-                                                                       =
-                                                                       BUF_strdup
-                                                                       (userinfo))))
+                    || !row[DB_srpverifier] || !row[DB_srpsalt]
+                    || (userinfo &amp;&amp;
+                         (!(row [DB_srpinfo] = BUF_strdup (userinfo))))
                     || !update_index(db, row)) {
-                    if (row[DB_srpid])
-                        OPENSSL_free(row[DB_srpid]);
-                    if (row[DB_srpgN])
-                        OPENSSL_free(row[DB_srpgN]);
-                    if (row[DB_srpinfo])
-                        OPENSSL_free(row[DB_srpinfo]);
-                    if (row[DB_srptype])
-                        OPENSSL_free(row[DB_srptype]);
-                    if (row[DB_srpverifier])
-                        OPENSSL_free(row[DB_srpverifier]);
-                    if (row[DB_srpsalt])
-                        OPENSSL_free(row[DB_srpsalt]);
+                    OPENSSL_free(row[DB_srpid]);
+                    OPENSSL_free(row[DB_srpgN]);
+                    OPENSSL_free(row[DB_srpinfo]);
+                    OPENSSL_free(row[DB_srptype]);
+                    OPENSSL_free(row[DB_srpverifier]);
+                    OPENSSL_free(row[DB_srpsalt]);
                     goto end;
                 }
                 doupdatedb = 1;
@@ -676,8 +664,7 @@ int srp_main(int argc, char **argv)
 
     if (verbose)
         BIO_printf(bio_err, &quot;SRP terminating with code %d.\n&quot;, ret);
-    if (tofree)
-        OPENSSL_free(tofree);
+    OPENSSL_free(tofree);
     if (ret)
         ERR_print_errors(bio_err);
     if (randfile)
diff --git a/apps/x509.c b/apps/x509.c
index 5418cce..31ae38a 100644
--- a/apps/x509.c
+++ b/apps/x509.c
@@ -955,8 +955,7 @@ int x509_main(int argc, char **argv)
     ASN1_INTEGER_free(sno);
     sk_ASN1_OBJECT_pop_free(trust, ASN1_OBJECT_free);
     sk_ASN1_OBJECT_pop_free(reject, ASN1_OBJECT_free);
-    if (passin)
-        OPENSSL_free(passin);
+    OPENSSL_free(passin);
     return (ret);
 }
 
@@ -996,8 +995,7 @@ static ASN1_INTEGER *x509_load_serial(char *CAfile, char *serialfile,
         goto end;
 
  end:
-    if (buf)
-        OPENSSL_free(buf);
+    OPENSSL_free(buf);
     BN_free(serial);
     return bs;
 }
diff --git a/crypto/asn1/a_bitstr.c b/crypto/asn1/a_bitstr.c
index ba243f1..60b6e6d 100644
--- a/crypto/asn1/a_bitstr.c
+++ b/crypto/asn1/a_bitstr.c
@@ -168,8 +168,7 @@ ASN1_BIT_STRING *c2i_ASN1_BIT_STRING(ASN1_BIT_STRING **a,
         s = NULL;
 
     ret-&gt;length = (int)len;
-    if (ret-&gt;data != NULL)
-        OPENSSL_free(ret-&gt;data);
+    OPENSSL_free(ret-&gt;data);
     ret-&gt;data = s;
     ret-&gt;type = V_ASN1_BIT_STRING;
     if (a != NULL)
diff --git a/crypto/asn1/a_enum.c b/crypto/asn1/a_enum.c
index 54d6542..4abd80c 100644
--- a/crypto/asn1/a_enum.c
+++ b/crypto/asn1/a_enum.c
@@ -75,8 +75,7 @@ int ASN1_ENUMERATED_set(ASN1_ENUMERATED *a, long v)
 
     a-&gt;type = V_ASN1_ENUMERATED;
     if (a-&gt;length &lt; (int)(sizeof(long) + 1)) {
-        if (a-&gt;data != NULL)
-            OPENSSL_free(a-&gt;data);
+        OPENSSL_free(a-&gt;data);
         if ((a-&gt;data = OPENSSL_malloc(sizeof(long) + 1)) != NULL)
             memset((char *)a-&gt;data, 0, sizeof(long) + 1);
     }
diff --git a/crypto/asn1/a_gentm.c b/crypto/asn1/a_gentm.c
index 0e9149a..324496e 100644
--- a/crypto/asn1/a_gentm.c
+++ b/crypto/asn1/a_gentm.c
@@ -243,8 +243,7 @@ ASN1_GENERALIZEDTIME *ASN1_GENERALIZEDTIME_adj(ASN1_GENERALIZEDTIME *s,
             ASN1err(ASN1_F_ASN1_GENERALIZEDTIME_ADJ, ERR_R_MALLOC_FAILURE);
             return (NULL);
         }
-        if (s-&gt;data != NULL)
-            OPENSSL_free(s-&gt;data);
+        OPENSSL_free(s-&gt;data);
         s-&gt;data = (unsigned char *)p;
     }
 
diff --git a/crypto/asn1/a_int.c b/crypto/asn1/a_int.c
index b5246a6..68a312b 100644
--- a/crypto/asn1/a_int.c
+++ b/crypto/asn1/a_int.c
@@ -258,8 +258,7 @@ ASN1_INTEGER *c2i_ASN1_INTEGER(ASN1_INTEGER **a, const unsigned char **pp,
         memcpy(s, p, (int)len);
     }
 
-    if (ret-&gt;data != NULL)
-        OPENSSL_free(ret-&gt;data);
+    OPENSSL_free(ret-&gt;data);
     ret-&gt;data = s;
     ret-&gt;length = (int)len;
     if (a != NULL)
@@ -327,8 +326,7 @@ ASN1_INTEGER *d2i_ASN1_UINTEGER(ASN1_INTEGER **a, const unsigned char **pp,
         p += len;
     }
 
-    if (ret-&gt;data != NULL)
-        OPENSSL_free(ret-&gt;data);
+    OPENSSL_free(ret-&gt;data);
     ret-&gt;data = s;
     ret-&gt;length = (int)len;
     if (a != NULL)
@@ -349,8 +347,7 @@ int ASN1_INTEGER_set(ASN1_INTEGER *a, long v)
     unsigned char buf[sizeof(long) + 1];
 
     if (a-&gt;length &lt; (int)(sizeof(long) + 1)) {
-        if (a-&gt;data != NULL)
-            OPENSSL_free(a-&gt;data);
+        OPENSSL_free(a-&gt;data);
         if ((a-&gt;data = OPENSSL_malloc(sizeof(long) + 1)) != NULL)
             memset((char *)a-&gt;data, 0, sizeof(long) + 1);
     }
diff --git a/crypto/asn1/a_mbstr.c b/crypto/asn1/a_mbstr.c
index 6935efe..2ff496b 100644
--- a/crypto/asn1/a_mbstr.c
+++ b/crypto/asn1/a_mbstr.c
@@ -190,11 +190,9 @@ int ASN1_mbstring_ncopy(ASN1_STRING **out, const unsigned char *in, int len,
     if (*out) {
         free_out = 0;
         dest = *out;
-        if (dest-&gt;data) {
-            dest-&gt;length = 0;
-            OPENSSL_free(dest-&gt;data);
-            dest-&gt;data = NULL;
-        }
+        OPENSSL_free(dest-&gt;data);
+        dest-&gt;data = NULL;
+        dest-&gt;length = 0;
         dest-&gt;type = str_type;
     } else {
         free_out = 1;
diff --git a/crypto/asn1/a_object.c b/crypto/asn1/a_object.c
index 1e76122..809e9a4 100644
--- a/crypto/asn1/a_object.c
+++ b/crypto/asn1/a_object.c
@@ -313,8 +313,7 @@ ASN1_OBJECT *c2i_ASN1_OBJECT(ASN1_OBJECT **a, const unsigned char **pp,
     /* once detached we can change it */
     if ((data == NULL) || (ret-&gt;length &lt; length)) {
         ret-&gt;length = 0;
-        if (data != NULL)
-            OPENSSL_free(data);
+        OPENSSL_free(data);
         data = OPENSSL_malloc(length);
         if (data == NULL) {
             i = ERR_R_MALLOC_FAILURE;
@@ -368,16 +367,13 @@ void ASN1_OBJECT_free(ASN1_OBJECT *a)
 #ifndef CONST_STRICT            /* disable purely for compile-time strict
                                  * const checking. Doing this on a &quot;real&quot;
                                  * compile will cause memory leaks */
-        if (a-&gt;sn != NULL)
-            OPENSSL_free((void *)a-&gt;sn);
-        if (a-&gt;ln != NULL)
-            OPENSSL_free((void *)a-&gt;ln);
+        OPENSSL_free((void*)a-&gt;sn);
+        OPENSSL_free((void*)a-&gt;ln);
 #endif
         a-&gt;sn = a-&gt;ln = NULL;
     }
     if (a-&gt;flags &amp; ASN1_OBJECT_FLAG_DYNAMIC_DATA) {
-        if (a-&gt;data != NULL)
-            OPENSSL_free((void *)a-&gt;data);
+        OPENSSL_free((void*)a-&gt;data);
         a-&gt;data = NULL;
         a-&gt;length = 0;
     }
diff --git a/crypto/asn1/a_sign.c b/crypto/asn1/a_sign.c
index fb7536d..e189958 100644
--- a/crypto/asn1/a_sign.c
+++ b/crypto/asn1/a_sign.c
@@ -190,8 +190,7 @@ int ASN1_sign(i2d_of_void *i2d, X509_ALGOR *algor1, X509_ALGOR *algor2,
         ASN1err(ASN1_F_ASN1_SIGN, ERR_R_EVP_LIB);
         goto err;
     }
-    if (signature-&gt;data != NULL)
-        OPENSSL_free(signature-&gt;data);
+    OPENSSL_free(signature-&gt;data);
     signature-&gt;data = buf_out;
     buf_out = NULL;
     signature-&gt;length = outl;
@@ -300,8 +299,7 @@ int ASN1_item_sign_ctx(const ASN1_ITEM *it,
         ASN1err(ASN1_F_ASN1_ITEM_SIGN_CTX, ERR_R_EVP_LIB);
         goto err;
     }
-    if (signature-&gt;data != NULL)
-        OPENSSL_free(signature-&gt;data);
+    OPENSSL_free(signature-&gt;data);
     signature-&gt;data = buf_out;
     buf_out = NULL;
     signature-&gt;length = outl;
diff --git a/crypto/asn1/a_utctm.c b/crypto/asn1/a_utctm.c
index 0e2f1b0..5fd1a6a 100644
--- a/crypto/asn1/a_utctm.c
+++ b/crypto/asn1/a_utctm.c
@@ -218,8 +218,7 @@ ASN1_UTCTIME *ASN1_UTCTIME_adj(ASN1_UTCTIME *s, time_t t,
             ASN1err(ASN1_F_ASN1_UTCTIME_ADJ, ERR_R_MALLOC_FAILURE);
             goto err;
         }
-        if (s-&gt;data != NULL)
-            OPENSSL_free(s-&gt;data);
+        OPENSSL_free(s-&gt;data);
         s-&gt;data = (unsigned char *)p;
     }
 
diff --git a/crypto/asn1/ameth_lib.c b/crypto/asn1/ameth_lib.c
index 5c7d6bb..718aa52 100644
--- a/crypto/asn1/ameth_lib.c
+++ b/crypto/asn1/ameth_lib.c
@@ -384,10 +384,8 @@ void EVP_PKEY_asn1_copy(EVP_PKEY_ASN1_METHOD *dst,
 void EVP_PKEY_asn1_free(EVP_PKEY_ASN1_METHOD *ameth)
 {
     if (ameth &amp;&amp; (ameth-&gt;pkey_flags &amp; ASN1_PKEY_DYNAMIC)) {
-        if (ameth-&gt;pem_str)
-            OPENSSL_free(ameth-&gt;pem_str);
-        if (ameth-&gt;info)
-            OPENSSL_free(ameth-&gt;info);
+        OPENSSL_free(ameth-&gt;pem_str);
+        OPENSSL_free(ameth-&gt;info);
         OPENSSL_free(ameth);
     }
 }
diff --git a/crypto/asn1/asn1_gen.c b/crypto/asn1/asn1_gen.c
index 3e066bc..6756c67 100644
--- a/crypto/asn1/asn1_gen.c
+++ b/crypto/asn1/asn1_gen.c
@@ -280,10 +280,8 @@ static ASN1_TYPE *generate_v3(char *str, X509V3_CTX *cnf, int depth,
     ret = d2i_ASN1_TYPE(NULL, &amp;cp, len);
 
  err:
-    if (orig_der)
-        OPENSSL_free(orig_der);
-    if (new_der)
-        OPENSSL_free(new_der);
+    OPENSSL_free(orig_der);
+    OPENSSL_free(new_der);
 
     return ret;
 
@@ -510,8 +508,7 @@ static ASN1_TYPE *asn1_multi(int utype, const char *section, X509V3_CTX *cnf,
 
  bad:
 
-    if (der)
-        OPENSSL_free(der);
+    OPENSSL_free(der);
 
     sk_ASN1_TYPE_pop_free(sk, ASN1_TYPE_free);
     if (sect)
diff --git a/crypto/asn1/asn1_lib.c b/crypto/asn1/asn1_lib.c
index a892d7f..e1e509b 100644
--- a/crypto/asn1/asn1_lib.c
+++ b/crypto/asn1/asn1_lib.c
@@ -335,8 +335,7 @@ int ASN1_STRING_set(ASN1_STRING *str, const void *_data, int len)
 
 void ASN1_STRING_set0(ASN1_STRING *str, void *data, int len)
 {
-    if (str-&gt;data)
-        OPENSSL_free(str-&gt;data);
+    OPENSSL_free(str-&gt;data);
     str-&gt;data = data;
     str-&gt;length = len;
 }
@@ -366,7 +365,7 @@ void ASN1_STRING_free(ASN1_STRING *a)
 {
     if (a == NULL)
         return;
-    if (a-&gt;data &amp;&amp; !(a-&gt;flags &amp; ASN1_STRING_FLAG_NDEF))
+    if (!(a-&gt;flags &amp; ASN1_STRING_FLAG_NDEF))
         OPENSSL_free(a-&gt;data);
     OPENSSL_free(a);
 }
diff --git a/crypto/asn1/asn_mime.c b/crypto/asn1/asn_mime.c
index 9b397ae..e8411a8 100644
--- a/crypto/asn1/asn_mime.c
+++ b/crypto/asn1/asn_mime.c
@@ -854,12 +854,9 @@ static MIME_HEADER *mime_hdr_new(char *name, char *value)
     return mhdr;
 
  err:
-    if (tmpname != NULL)
-        OPENSSL_free(tmpname);
-    if (tmpval != NULL)
-        OPENSSL_free(tmpval);
-    if (mhdr != NULL)
-        OPENSSL_free(mhdr);
+    OPENSSL_free(tmpname);
+    OPENSSL_free(tmpval);
+    OPENSSL_free(mhdr);
     return NULL;
 }
 
@@ -895,12 +892,9 @@ static int mime_hdr_addparam(MIME_HEADER *mhdr, char *name, char *value)
         goto err;
     return 1;
  err:
-    if (tmpname != NULL)
-        OPENSSL_free(tmpname);
-    if (tmpval != NULL)
-        OPENSSL_free(tmpval);
-    if (mparam != NULL)
-        OPENSSL_free(mparam);
+    OPENSSL_free(tmpname);
+    OPENSSL_free(tmpval);
+    OPENSSL_free(mparam);
     return 0;
 }
 
@@ -947,10 +941,8 @@ static MIME_PARAM *mime_param_find(MIME_HEADER *hdr, char *name)
 
 static void mime_hdr_free(MIME_HEADER *hdr)
 {
-    if (hdr-&gt;name)
-        OPENSSL_free(hdr-&gt;name);
-    if (hdr-&gt;value)
-        OPENSSL_free(hdr-&gt;value);
+    OPENSSL_free(hdr-&gt;name);
+    OPENSSL_free(hdr-&gt;value);
     if (hdr-&gt;params)
         sk_MIME_PARAM_pop_free(hdr-&gt;params, mime_param_free);
     OPENSSL_free(hdr);
@@ -958,10 +950,8 @@ static void mime_hdr_free(MIME_HEADER *hdr)
 
 static void mime_param_free(MIME_PARAM *param)
 {
-    if (param-&gt;param_name)
-        OPENSSL_free(param-&gt;param_name);
-    if (param-&gt;param_value)
-        OPENSSL_free(param-&gt;param_value);
+    OPENSSL_free(param-&gt;param_name);
+    OPENSSL_free(param-&gt;param_value);
     OPENSSL_free(param);
 }
 
diff --git a/crypto/asn1/asn_pack.c b/crypto/asn1/asn_pack.c
index 8d0f0b0..e358a86 100644
--- a/crypto/asn1/asn_pack.c
+++ b/crypto/asn1/asn_pack.c
@@ -77,10 +77,8 @@ ASN1_STRING *ASN1_item_pack(void *obj, const ASN1_ITEM *it, ASN1_STRING **oct)
     } else
         octmp = *oct;
 
-    if (octmp-&gt;data) {
-        OPENSSL_free(octmp-&gt;data);
-        octmp-&gt;data = NULL;
-    }
+    OPENSSL_free(octmp-&gt;data);
+    octmp-&gt;data = NULL;
 
     if (!(octmp-&gt;length = ASN1_item_i2d(obj, &amp;octmp-&gt;data, it))) {
         ASN1err(ASN1_F_ASN1_ITEM_PACK, ASN1_R_ENCODE_ERROR);
diff --git a/crypto/asn1/bio_asn1.c b/crypto/asn1/bio_asn1.c
index d4be23c..ba39069 100644
--- a/crypto/asn1/bio_asn1.c
+++ b/crypto/asn1/bio_asn1.c
@@ -183,8 +183,7 @@ static int asn1_bio_free(BIO *b)
 
     if (ctx == NULL)
         return 0;
-    if (ctx-&gt;buf)
-        OPENSSL_free(ctx-&gt;buf);
+    OPENSSL_free(ctx-&gt;buf);
     OPENSSL_free(ctx);
     b-&gt;init = 0;
     b-&gt;ptr = NULL;
diff --git a/crypto/asn1/bio_ndef.c b/crypto/asn1/bio_ndef.c
index 99ab5f6..de517f2 100644
--- a/crypto/asn1/bio_ndef.c
+++ b/crypto/asn1/bio_ndef.c
@@ -143,8 +143,7 @@ BIO *BIO_new_NDEF(BIO *out, ASN1_VALUE *val, const ASN1_ITEM *it)
 
  err:
     BIO_free(asn_bio);
-    if (ndef_aux)
-        OPENSSL_free(ndef_aux);
+    OPENSSL_free(ndef_aux);
     return NULL;
 }
 
@@ -186,8 +185,7 @@ static int ndef_prefix_free(BIO *b, unsigned char **pbuf, int *plen,
 
     ndef_aux = *(NDEF_SUPPORT **)parg;
 
-    if (ndef_aux-&gt;derbuf)
-        OPENSSL_free(ndef_aux-&gt;derbuf);
+    OPENSSL_free(ndef_aux-&gt;derbuf);
 
     ndef_aux-&gt;derbuf = NULL;
     *pbuf = NULL;
diff --git a/crypto/asn1/f_enum.c b/crypto/asn1/f_enum.c
index 2ec99a5..338a02e 100644
--- a/crypto/asn1/f_enum.c
+++ b/crypto/asn1/f_enum.c
@@ -154,8 +154,7 @@ int a2i_ASN1_ENUMERATED(BIO *bp, ASN1_ENUMERATED *bs, char *buf, int size)
             sp = OPENSSL_realloc(s, (unsigned int)num + i * 2);
             if (sp == NULL) {
                 ASN1err(ASN1_F_A2I_ASN1_ENUMERATED, ERR_R_MALLOC_FAILURE);
-                if (s != NULL)
-                    OPENSSL_free(s);
+                OPENSSL_free(s);
                 goto err;
             }
             s = sp;
diff --git a/crypto/asn1/f_int.c b/crypto/asn1/f_int.c
index f74252c..5a2d18b 100644
--- a/crypto/asn1/f_int.c
+++ b/crypto/asn1/f_int.c
@@ -168,8 +168,7 @@ int a2i_ASN1_INTEGER(BIO *bp, ASN1_INTEGER *bs, char *buf, int size)
             sp = OPENSSL_realloc_clean(s, slen, num + i * 2);
             if (sp == NULL) {
                 ASN1err(ASN1_F_A2I_ASN1_INTEGER, ERR_R_MALLOC_FAILURE);
-                if (s != NULL)
-                    OPENSSL_free(s);
+                OPENSSL_free(s);
                 goto err;
             }
             s = sp;
diff --git a/crypto/asn1/f_string.c b/crypto/asn1/f_string.c
index 53f8cf3..e9dcee8 100644
--- a/crypto/asn1/f_string.c
+++ b/crypto/asn1/f_string.c
@@ -160,8 +160,7 @@ int a2i_ASN1_STRING(BIO *bp, ASN1_STRING *bs, char *buf, int size)
             sp = OPENSSL_realloc(s, (unsigned int)num + i * 2);
             if (sp == NULL) {
                 ASN1err(ASN1_F_A2I_ASN1_STRING, ERR_R_MALLOC_FAILURE);
-                if (s != NULL)
-                    OPENSSL_free(s);
+                OPENSSL_free(s);
                 goto err;
             }
             s = sp;
diff --git a/crypto/asn1/t_x509.c b/crypto/asn1/t_x509.c
index da73b6d..c32f28e 100644
--- a/crypto/asn1/t_x509.c
+++ b/crypto/asn1/t_x509.c
@@ -249,8 +249,7 @@ int X509_print_ex(BIO *bp, X509 *x, unsigned long nmflags,
     }
     ret = 1;
  err:
-    if (m != NULL)
-        OPENSSL_free(m);
+    OPENSSL_free(m);
     return (ret);
 }
 
@@ -299,8 +298,7 @@ int X509_ocspid_print(BIO *bp, X509 *x)
 
     return (1);
  err:
-    if (der != NULL)
-        OPENSSL_free(der);
+    OPENSSL_free(der);
     return (0);
 }
 
diff --git a/crypto/asn1/tasn_dec.c b/crypto/asn1/tasn_dec.c
index ef19fcd..c5caff7 100644
--- a/crypto/asn1/tasn_dec.c
+++ b/crypto/asn1/tasn_dec.c
@@ -765,7 +765,7 @@ static int asn1_d2i_ex_primitive(ASN1_VALUE **pval,
     *in = p;
     ret = 1;
  err:
-    if (free_cont &amp;&amp; buf.data)
+    if (free_cont)
         OPENSSL_free(buf.data);
     return ret;
 }
@@ -882,8 +882,7 @@ static int asn1_ex_c2i(ASN1_VALUE **pval, const unsigned char *cont, int len,
         }
         /* If we've already allocated a buffer use it */
         if (*free_cont) {
-            if (stmp-&gt;data)
-                OPENSSL_free(stmp-&gt;data);
+            OPENSSL_free(stmp-&gt;data);
             stmp-&gt;data = (unsigned char *)cont; /* UGLY CAST! RL */
             stmp-&gt;length = len;
             *free_cont = 0;
diff --git a/crypto/asn1/tasn_prn.c b/crypto/asn1/tasn_prn.c
index 10974eb..76d584b 100644
--- a/crypto/asn1/tasn_prn.c
+++ b/crypto/asn1/tasn_prn.c
@@ -100,8 +100,7 @@ ASN1_PCTX *ASN1_PCTX_new(void)
 
 void ASN1_PCTX_free(ASN1_PCTX *p)
 {
-    if (p)
-        OPENSSL_free(p);
+    OPENSSL_free(p);
 }
 
 unsigned long ASN1_PCTX_get_flags(ASN1_PCTX *p)
diff --git a/crypto/asn1/tasn_scn.c b/crypto/asn1/tasn_scn.c
index 8305405..cedea9c 100644
--- a/crypto/asn1/tasn_scn.c
+++ b/crypto/asn1/tasn_scn.c
@@ -86,8 +86,7 @@ ASN1_SCTX *ASN1_SCTX_new(int (*scan_cb) (ASN1_SCTX *ctx))
 
 void ASN1_SCTX_free(ASN1_SCTX *p)
 {
-    if (p)
-        OPENSSL_free(p);
+    OPENSSL_free(p);
 }
 
 const ASN1_ITEM *ASN1_SCTX_get_item(ASN1_SCTX *p)
diff --git a/crypto/asn1/tasn_utl.c b/crypto/asn1/tasn_utl.c
index 17318ea..76e9605 100644
--- a/crypto/asn1/tasn_utl.c
+++ b/crypto/asn1/tasn_utl.c
@@ -154,8 +154,7 @@ void asn1_enc_free(ASN1_VALUE **pval, const ASN1_ITEM *it)
     ASN1_ENCODING *enc;
     enc = asn1_get_enc_ptr(pval, it);
     if (enc) {
-        if (enc-&gt;enc)
-            OPENSSL_free(enc-&gt;enc);
+        OPENSSL_free(enc-&gt;enc);
         enc-&gt;enc = NULL;
         enc-&gt;len = 0;
         enc-&gt;modified = 1;
@@ -170,8 +169,7 @@ int asn1_enc_save(ASN1_VALUE **pval, const unsigned char *in, int inlen,
     if (!enc)
         return 1;
 
-    if (enc-&gt;enc)
-        OPENSSL_free(enc-&gt;enc);
+    OPENSSL_free(enc-&gt;enc);
     enc-&gt;enc = OPENSSL_malloc(inlen);
     if (!enc-&gt;enc)
         return 0;
diff --git a/crypto/asn1/x_info.c b/crypto/asn1/x_info.c
index 4783fc4..5b927ef 100644
--- a/crypto/asn1/x_info.c
+++ b/crypto/asn1/x_info.c
@@ -106,7 +106,6 @@ void X509_INFO_free(X509_INFO *x)
     X509_free(x-&gt;x509);
     X509_CRL_free(x-&gt;crl);
     X509_PKEY_free(x-&gt;x_pkey);
-    if (x-&gt;enc_data != NULL)
-        OPENSSL_free(x-&gt;enc_data);
+    OPENSSL_free(x-&gt;enc_data);
     OPENSSL_free(x);
 }
diff --git a/crypto/asn1/x_pkey.c b/crypto/asn1/x_pkey.c
index fc5de8a..59e002b 100644
--- a/crypto/asn1/x_pkey.c
+++ b/crypto/asn1/x_pkey.c
@@ -113,7 +113,7 @@ void X509_PKEY_free(X509_PKEY *x)
     X509_ALGOR_free(x-&gt;enc_algor);
     ASN1_OCTET_STRING_free(x-&gt;enc_pkey);
     EVP_PKEY_free(x-&gt;dec_pkey);
-    if ((x-&gt;key_data != NULL) &amp;&amp; (x-&gt;key_free))
+    if (x-&gt;key_free)
         OPENSSL_free(x-&gt;key_data);
     OPENSSL_free(x);
 }
diff --git a/crypto/asn1/x_pubkey.c b/crypto/asn1/x_pubkey.c
index 158c240..2605f07 100644
--- a/crypto/asn1/x_pubkey.c
+++ b/crypto/asn1/x_pubkey.c
@@ -340,8 +340,7 @@ int X509_PUBKEY_set0_param(X509_PUBKEY *pub, ASN1_OBJECT *aobj,
     if (!X509_ALGOR_set0(pub-&gt;algor, aobj, ptype, pval))
         return 0;
     if (penc) {
-        if (pub-&gt;public_key-&gt;data)
-            OPENSSL_free(pub-&gt;public_key-&gt;data);
+        OPENSSL_free(pub-&gt;public_key-&gt;data);
         pub-&gt;public_key-&gt;data = penc;
         pub-&gt;public_key-&gt;length = penclen;
         /* Set number of unused bits to zero */
diff --git a/crypto/asn1/x_x509.c b/crypto/asn1/x_x509.c
index 08bb4bd..1b353af 100644
--- a/crypto/asn1/x_x509.c
+++ b/crypto/asn1/x_x509.c
@@ -103,8 +103,7 @@ static int x509_cb(int operation, ASN1_VALUE **pval, const ASN1_ITEM *it,
         break;
 
     case ASN1_OP_D2I_POST:
-        if (ret-&gt;name != NULL)
-            OPENSSL_free(ret-&gt;name);
+        OPENSSL_free(ret-&gt;name);
         ret-&gt;name = X509_NAME_oneline(ret-&gt;cert_info-&gt;subject, NULL, 0);
         break;
 
@@ -119,9 +118,7 @@ static int x509_cb(int operation, ASN1_VALUE **pval, const ASN1_ITEM *it,
         NAME_CONSTRAINTS_free(ret-&gt;nc);
         sk_IPAddressFamily_pop_free(ret-&gt;rfc3779_addr, IPAddressFamily_free);
         ASIdentifiers_free(ret-&gt;rfc3779_asid);
-
-        if (ret-&gt;name != NULL)
-            OPENSSL_free(ret-&gt;name);
+        OPENSSL_free(ret-&gt;name);
         break;
 
     }
diff --git a/crypto/bio/b_sock.c b/crypto/bio/b_sock.c
index a4fded5..39499de 100644
--- a/crypto/bio/b_sock.c
+++ b/crypto/bio/b_sock.c
@@ -572,8 +572,7 @@ int BIO_get_accept_socket(char *host, int bind_mode)
     }
     ret = 1;
  err:
-    if (str != NULL)
-        OPENSSL_free(str);
+    OPENSSL_free(str);
     if ((ret == 0) &amp;&amp; (s != INVALID_SOCKET)) {
         closesocket(s);
         s = INVALID_SOCKET;
diff --git a/crypto/bio/bf_buff.c b/crypto/bio/bf_buff.c
index d82385a..53a1204 100644
--- a/crypto/bio/bf_buff.c
+++ b/crypto/bio/bf_buff.c
@@ -127,10 +127,8 @@ static int buffer_free(BIO *a)
     if (a == NULL)
         return (0);
     b = (BIO_F_BUFFER_CTX *)a-&gt;ptr;
-    if (b-&gt;ibuf != NULL)
-        OPENSSL_free(b-&gt;ibuf);
-    if (b-&gt;obuf != NULL)
-        OPENSSL_free(b-&gt;obuf);
+    OPENSSL_free(b-&gt;ibuf);
+    OPENSSL_free(b-&gt;obuf);
     OPENSSL_free(a-&gt;ptr);
     a-&gt;ptr = NULL;
     a-&gt;init = 0;
@@ -339,8 +337,7 @@ static long buffer_ctrl(BIO *b, int cmd, long num, void *ptr)
             p1 = OPENSSL_malloc((int)num);
             if (p1 == NULL)
                 goto malloc_error;
-            if (ctx-&gt;ibuf != NULL)
-                OPENSSL_free(ctx-&gt;ibuf);
+            OPENSSL_free(ctx-&gt;ibuf);
             ctx-&gt;ibuf = p1;
         }
         ctx-&gt;ibuf_off = 0;
diff --git a/crypto/bio/bf_lbuf.c b/crypto/bio/bf_lbuf.c
index ef12820..d7906b4 100644
--- a/crypto/bio/bf_lbuf.c
+++ b/crypto/bio/bf_lbuf.c
@@ -128,8 +128,7 @@ static int linebuffer_free(BIO *a)
     if (a == NULL)
         return (0);
     b = (BIO_LINEBUFFER_CTX *)a-&gt;ptr;
-    if (b-&gt;obuf != NULL)
-        OPENSSL_free(b-&gt;obuf);
+    OPENSSL_free(b-&gt;obuf);
     OPENSSL_free(a-&gt;ptr);
     a-&gt;ptr = NULL;
     a-&gt;init = 0;
diff --git a/crypto/bio/bf_nbio.c b/crypto/bio/bf_nbio.c
index df547a1..9b9c0c0 100644
--- a/crypto/bio/bf_nbio.c
+++ b/crypto/bio/bf_nbio.c
@@ -116,8 +116,7 @@ static int nbiof_free(BIO *a)
 {
     if (a == NULL)
         return (0);
-    if (a-&gt;ptr != NULL)
-        OPENSSL_free(a-&gt;ptr);
+    OPENSSL_free(a-&gt;ptr);
     a-&gt;ptr = NULL;
     a-&gt;init = 0;
     a-&gt;flags = 0;
diff --git a/crypto/bio/bss_acpt.c b/crypto/bio/bss_acpt.c
index d6f6678..6793fe1 100644
--- a/crypto/bio/bss_acpt.c
+++ b/crypto/bio/bss_acpt.c
@@ -151,10 +151,8 @@ static void BIO_ACCEPT_free(BIO_ACCEPT *a)
     if (a == NULL)
         return;
 
-    if (a-&gt;param_addr != NULL)
-        OPENSSL_free(a-&gt;param_addr);
-    if (a-&gt;addr != NULL)
-        OPENSSL_free(a-&gt;addr);
+    OPENSSL_free(a-&gt;param_addr);
+    OPENSSL_free(a-&gt;addr);
     BIO_free(a-&gt;bio_chain);
     OPENSSL_free(a);
 }
@@ -353,8 +351,7 @@ static long acpt_ctrl(BIO *b, int cmd, long num, void *ptr)
         if (ptr != NULL) {
             if (num == 0) {
                 b-&gt;init = 1;
-                if (data-&gt;param_addr != NULL)
-                    OPENSSL_free(data-&gt;param_addr);
+                OPENSSL_free(data-&gt;param_addr);
                 data-&gt;param_addr = BUF_strdup(ptr);
             } else if (num == 1) {
                 data-&gt;accept_nbio = (ptr != NULL);
diff --git a/crypto/bio/bss_bio.c b/crypto/bio/bss_bio.c
index c6bb3d6..c9b8e7f 100644
--- a/crypto/bio/bss_bio.c
+++ b/crypto/bio/bss_bio.c
@@ -170,10 +170,7 @@ static int bio_free(BIO *bio)
     if (b-&gt;peer)
         bio_destroy_pair(bio);
 
-    if (b-&gt;buf != NULL) {
-        OPENSSL_free(b-&gt;buf);
-    }
-
+    OPENSSL_free(b-&gt;buf);
     OPENSSL_free(b);
 
     return 1;
@@ -507,10 +504,8 @@ static long bio_ctrl(BIO *bio, int cmd, long num, void *ptr)
             size_t new_size = num;
 
             if (b-&gt;size != new_size) {
-                if (b-&gt;buf) {
-                    OPENSSL_free(b-&gt;buf);
-                    b-&gt;buf = NULL;
-                }
+                OPENSSL_free(b-&gt;buf);
+                b-&gt;buf = NULL;
                 b-&gt;size = new_size;
             }
             ret = 1;
diff --git a/crypto/bio/bss_conn.c b/crypto/bio/bss_conn.c
index e44bb32..0b82082 100644
--- a/crypto/bio/bss_conn.c
+++ b/crypto/bio/bss_conn.c
@@ -148,8 +148,7 @@ static int conn_state(BIO *b, BIO_CONNECT *c)
                             *q = '\0';
                             break;
                         }
-                    if (c-&gt;param_port != NULL)
-                        OPENSSL_free(c-&gt;param_port);
+                    OPENSSL_free(c-&gt;param_port);
                     c-&gt;param_port = BUF_strdup(p);
                 }
             }
@@ -308,10 +307,8 @@ void BIO_CONNECT_free(BIO_CONNECT *a)
     if (a == NULL)
         return;
 
-    if (a-&gt;param_hostname != NULL)
-        OPENSSL_free(a-&gt;param_hostname);
-    if (a-&gt;param_port != NULL)
-        OPENSSL_free(a-&gt;param_port);
+    OPENSSL_free(a-&gt;param_hostname);
+    OPENSSL_free(a-&gt;param_port);
     OPENSSL_free(a);
 }
 
@@ -455,12 +452,10 @@ static long conn_ctrl(BIO *b, int cmd, long num, void *ptr)
         if (ptr != NULL) {
             b-&gt;init = 1;
             if (num == 0) {
-                if (data-&gt;param_hostname != NULL)
-                    OPENSSL_free(data-&gt;param_hostname);
+                OPENSSL_free(data-&gt;param_hostname);
                 data-&gt;param_hostname = BUF_strdup(ptr);
             } else if (num == 1) {
-                if (data-&gt;param_port != NULL)
-                    OPENSSL_free(data-&gt;param_port);
+                OPENSSL_free(data-&gt;param_port);
                 data-&gt;param_port = BUF_strdup(ptr);
             } else if (num == 2) {
                 char buf[16];
@@ -468,16 +463,14 @@ static long conn_ctrl(BIO *b, int cmd, long num, void *ptr)
 
                 BIO_snprintf(buf, sizeof buf, &quot;%d.%d.%d.%d&quot;,
                              p[0], p[1], p[2], p[3]);
-                if (data-&gt;param_hostname != NULL)
-                    OPENSSL_free(data-&gt;param_hostname);
+                OPENSSL_free(data-&gt;param_hostname);
                 data-&gt;param_hostname = BUF_strdup(buf);
                 memcpy(&amp;(data-&gt;ip[0]), ptr, 4);
             } else if (num == 3) {
                 char buf[DECIMAL_SIZE(int) + 1];
 
                 BIO_snprintf(buf, sizeof buf, &quot;%d&quot;, *(int *)ptr);
-                if (data-&gt;param_port != NULL)
-                    OPENSSL_free(data-&gt;param_port);
+                OPENSSL_free(data-&gt;param_port);
                 data-&gt;param_port = BUF_strdup(buf);
                 data-&gt;port = *(int *)ptr;
             }
diff --git a/crypto/bio/bss_dgram.c b/crypto/bio/bss_dgram.c
index 4fa6279..406d46b 100644
--- a/crypto/bio/bss_dgram.c
+++ b/crypto/bio/bss_dgram.c
@@ -245,8 +245,7 @@ static int dgram_free(BIO *a)
         return 0;
 
     data = (bio_dgram_data *)a-&gt;ptr;
-    if (data != NULL)
-        OPENSSL_free(data);
+    OPENSSL_free(data);
 
     return (1);
 }
@@ -1110,8 +1109,7 @@ static int dgram_sctp_free(BIO *a)
 
     data = (bio_dgram_sctp_data *) a-&gt;ptr;
     if (data != NULL) {
-        if (data-&gt;saved_message.data != NULL)
-            OPENSSL_free(data-&gt;saved_message.data);
+        OPENSSL_free(data-&gt;saved_message.data);
         OPENSSL_free(data);
     }
 
@@ -1413,8 +1411,7 @@ static int dgram_sctp_write(BIO *b, const char *in, int inl)
             BIOerr(BIO_F_DGRAM_SCTP_WRITE, ERR_R_MALLOC_FAILURE);
             return -1;
         }
-        if (data-&gt;saved_message.data)
-            OPENSSL_free(data-&gt;saved_message.data);
+        OPENSSL_free(data-&gt;saved_message.data);
         data-&gt;saved_message.data = tmp;
         memcpy(data-&gt;saved_message.data, in, inl);
         data-&gt;saved_message.length = inl;
diff --git a/crypto/bn/bn_exp.c b/crypto/bn/bn_exp.c
index 28c3693..17aa2ba 100644
--- a/crypto/bn/bn_exp.c
+++ b/crypto/bn/bn_exp.c
@@ -1131,8 +1131,7 @@ int BN_mod_exp_mont_consttime(BIGNUM *rr, const BIGNUM *a, const BIGNUM *p,
         BN_MONT_CTX_free(mont);
     if (powerbuf != NULL) {
         OPENSSL_cleanse(powerbuf, powerbufLen);
-        if (powerbufFree)
-            OPENSSL_free(powerbufFree);
+        OPENSSL_free(powerbufFree);
     }
     BN_CTX_end(ctx);
     return (ret);
diff --git a/crypto/bn/bn_gf2m.c b/crypto/bn/bn_gf2m.c
index fc7ad24..7c0d4af 100644
--- a/crypto/bn/bn_gf2m.c
+++ b/crypto/bn/bn_gf2m.c
@@ -561,8 +561,7 @@ int BN_GF2m_mod_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
     ret = BN_GF2m_mod_mul_arr(r, a, b, arr, ctx);
     bn_check_top(r);
  err:
-    if (arr)
-        OPENSSL_free(arr);
+    OPENSSL_free(arr);
     return ret;
 }
 
@@ -620,8 +619,7 @@ int BN_GF2m_mod_sqr(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
     ret = BN_GF2m_mod_sqr_arr(r, a, arr, ctx);
     bn_check_top(r);
  err:
-    if (arr)
-        OPENSSL_free(arr);
+    OPENSSL_free(arr);
     return ret;
 }
 
@@ -1037,8 +1035,7 @@ int BN_GF2m_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
     ret = BN_GF2m_mod_exp_arr(r, a, b, arr, ctx);
     bn_check_top(r);
  err:
-    if (arr)
-        OPENSSL_free(arr);
+    OPENSSL_free(arr);
     return ret;
 }
 
@@ -1097,8 +1094,7 @@ int BN_GF2m_mod_sqrt(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
     ret = BN_GF2m_mod_sqrt_arr(r, a, arr, ctx);
     bn_check_top(r);
  err:
-    if (arr)
-        OPENSSL_free(arr);
+    OPENSSL_free(arr);
     return ret;
 }
 
@@ -1228,8 +1224,7 @@ int BN_GF2m_mod_solve_quad(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
     ret = BN_GF2m_mod_solve_quad_arr(r, a, arr, ctx);
     bn_check_top(r);
  err:
-    if (arr)
-        OPENSSL_free(arr);
+    OPENSSL_free(arr);
     return ret;
 }
 
diff --git a/crypto/bn/bn_intern.c b/crypto/bn/bn_intern.c
index 32ad505..139d11b 100644
--- a/crypto/bn/bn_intern.c
+++ b/crypto/bn/bn_intern.c
@@ -67,7 +67,6 @@
 signed char *bn_compute_wNAF(const BIGNUM *scalar, int w, size_t *ret_len)
 {
     int window_val;
-    int ok = 0;
     signed char *r = NULL;
     int sign = 1;
     int bit, next_bit, mask;
@@ -176,17 +175,12 @@ signed char *bn_compute_wNAF(const BIGNUM *scalar, int w, size_t *ret_len)
         BNerr(BN_F_BN_COMPUTE_WNAF, ERR_R_INTERNAL_ERROR);
         goto err;
     }
-    len = j;
-    ok = 1;
+    *ret_len = j;
+    return r;
 
  err:
-    if (!ok) {
-        OPENSSL_free(r);
-        r = NULL;
-    }
-    if (ok)
-        *ret_len = len;
-    return r;
+    OPENSSL_free(r);
+    return NULL;
 }
 
 int bn_get_top(const BIGNUM *a)
diff --git a/crypto/bn/bn_lib.c b/crypto/bn/bn_lib.c
index 2c5e2b2..3e9ea8e 100644
--- a/crypto/bn/bn_lib.c
+++ b/crypto/bn/bn_lib.c
@@ -246,7 +246,7 @@ void BN_free(BIGNUM *a)
     if (a == NULL)
         return;
     bn_check_top(a);
-    if ((a-&gt;d != NULL) &amp;&amp; !(BN_get_flags(a, BN_FLG_STATIC_DATA)))
+    if (!BN_get_flags(a, BN_FLG_STATIC_DATA))
         OPENSSL_free(a-&gt;d);
     if (a-&gt;flags &amp; BN_FLG_MALLOCED)
         OPENSSL_free(a);
@@ -378,8 +378,7 @@ BIGNUM *bn_expand2(BIGNUM *b, int words)
         BN_ULONG *a = bn_expand_internal(b, words);
         if (!a)
             return NULL;
-        if (b-&gt;d)
-            OPENSSL_free(b-&gt;d);
+        OPENSSL_free(b-&gt;d);
         b-&gt;d = a;
         b-&gt;dmax = words;
     }
diff --git a/crypto/bn/bn_print.c b/crypto/bn/bn_print.c
index 8b59e78..1ef5a87 100644
--- a/crypto/bn/bn_print.c
+++ b/crypto/bn/bn_print.c
@@ -156,15 +156,12 @@ char *BN_bn2dec(const BIGNUM *a)
     }
     ok = 1;
  err:
-    if (bn_data != NULL)
-        OPENSSL_free(bn_data);
+    OPENSSL_free(bn_data);
     BN_free(t);
-    if (!ok &amp;&amp; buf) {
-        OPENSSL_free(buf);
-        buf = NULL;
-    }
-
-    return (buf);
+    if (ok)
+        return buf;
+    OPENSSL_free(buf);
+    return NULL;
 }
 
 int BN_hex2bn(BIGNUM **bn, const char *a)
diff --git a/crypto/bn/bn_rand.c b/crypto/bn/bn_rand.c
index 4681154..ed3c3c5 100644
--- a/crypto/bn/bn_rand.c
+++ b/crypto/bn/bn_rand.c
@@ -351,7 +351,6 @@ int BN_generate_dsa_nonce(BIGNUM *out, const BIGNUM *range,
     ret = 1;
 
  err:
-    if (k_bytes)
-        OPENSSL_free(k_bytes);
+    OPENSSL_free(k_bytes);
     return ret;
 }
diff --git a/crypto/cms/cms_env.c b/crypto/cms/cms_env.c
index d146f84..e8274be 100644
--- a/crypto/cms/cms_env.c
+++ b/crypto/cms/cms_env.c
@@ -404,8 +404,7 @@ static int cms_RecipientInfo_ktri_encrypt(CMS_ContentInfo *cms,
         EVP_PKEY_CTX_free(pctx);
         ktri-&gt;pctx = NULL;
     }
-    if (ek)
-        OPENSSL_free(ek);
+    OPENSSL_free(ek);
     return ret;
 
 }
@@ -472,7 +471,7 @@ static int cms_RecipientInfo_ktri_decrypt(CMS_ContentInfo *cms,
  err:
     EVP_PKEY_CTX_free(ktri-&gt;pctx);
     ktri-&gt;pctx = NULL;
-    if (!ret &amp;&amp; ek)
+    if (!ret)
         OPENSSL_free(ek);
 
     return ret;
@@ -712,7 +711,7 @@ static int cms_RecipientInfo_kekri_encrypt(CMS_ContentInfo *cms,
 
  err:
 
-    if (!r &amp;&amp; wkey)
+    if (!r)
         OPENSSL_free(wkey);
     OPENSSL_cleanse(&amp;actx, sizeof(actx));
 
@@ -785,7 +784,7 @@ static int cms_RecipientInfo_kekri_decrypt(CMS_ContentInfo *cms,
 
  err:
 
-    if (!r &amp;&amp; ukey)
+    if (!r)
         OPENSSL_free(ukey);
     OPENSSL_cleanse(&amp;actx, sizeof(actx));
 
diff --git a/crypto/cms/cms_ess.c b/crypto/cms/cms_ess.c
index 6d5fa90..21f41f6 100644
--- a/crypto/cms/cms_ess.c
+++ b/crypto/cms/cms_ess.c
@@ -154,8 +154,7 @@ int CMS_add1_ReceiptRequest(CMS_SignerInfo *si, CMS_ReceiptRequest *rr)
     if (!r)
         CMSerr(CMS_F_CMS_ADD1_RECEIPTREQUEST, ERR_R_MALLOC_FAILURE);
 
-    if (rrder)
-        OPENSSL_free(rrder);
+    OPENSSL_free(rrder);
 
     return r;
 
diff --git a/crypto/cms/cms_kari.c b/crypto/cms/cms_kari.c
index 17b62dd..ea7fb5b 100644
--- a/crypto/cms/cms_kari.c
+++ b/crypto/cms/cms_kari.c
@@ -268,7 +268,7 @@ static int cms_kek_cipher(unsigned char **pout, size_t *poutlen,
 
  err:
     OPENSSL_cleanse(kek, keklen);
-    if (!rv &amp;&amp; out)
+    if (!rv)
         OPENSSL_free(out);
     EVP_CIPHER_CTX_cleanup(&amp;kari-&gt;ctx);
     EVP_PKEY_CTX_free(kari-&gt;pctx);
@@ -300,8 +300,7 @@ int CMS_RecipientInfo_kari_decrypt(CMS_ContentInfo *cms,
     cek = NULL;
     rv = 1;
  err:
-    if (cek)
-        OPENSSL_free(cek);
+    OPENSSL_free(cek);
     return rv;
 }
 
diff --git a/crypto/cms/cms_pwri.c b/crypto/cms/cms_pwri.c
index 6416502..1d505e9 100644
--- a/crypto/cms/cms_pwri.c
+++ b/crypto/cms/cms_pwri.c
@@ -420,7 +420,7 @@ int cms_RecipientInfo_pwri_crypt(CMS_ContentInfo *cms, CMS_RecipientInfo *ri,
 
     EVP_CIPHER_CTX_cleanup(&amp;kekctx);
 
-    if (!r &amp;&amp; key)
+    if (!r)
         OPENSSL_free(key);
     X509_ALGOR_free(kekalg);
 
diff --git a/crypto/cms/cms_sd.c b/crypto/cms/cms_sd.c
index 31398ac..7fb4385 100644
--- a/crypto/cms/cms_sd.c
+++ b/crypto/cms/cms_sd.c
@@ -728,8 +728,7 @@ int CMS_SignerInfo_sign(CMS_SignerInfo *si)
     return 1;
 
  err:
-    if (abuf)
-        OPENSSL_free(abuf);
+    OPENSSL_free(abuf);
     EVP_MD_CTX_cleanup(mctx);
     return 0;
 
diff --git a/crypto/comp/c_zlib.c b/crypto/comp/c_zlib.c
index aa03f8f..4508e7f 100644
--- a/crypto/comp/c_zlib.c
+++ b/crypto/comp/c_zlib.c
@@ -151,8 +151,7 @@ static int zlib_stateful_init(COMP_CTX *ctx)
     CRYPTO_set_ex_data(&amp;ctx-&gt;ex_data, zlib_stateful_ex_idx, state);
     return 1;
  err:
-    if (state)
-        OPENSSL_free(state);
+    OPENSSL_free(state);
     return 0;
 }
 
@@ -606,18 +605,14 @@ static long bio_zlib_ctrl(BIO *b, int cmd, long num, void *ptr)
         }
 
         if (ibs != -1) {
-            if (ctx-&gt;ibuf) {
-                OPENSSL_free(ctx-&gt;ibuf);
-                ctx-&gt;ibuf = NULL;
-            }
+            OPENSSL_free(ctx-&gt;ibuf);
+            ctx-&gt;ibuf = NULL;
             ctx-&gt;ibufsize = ibs;
         }
 
         if (obs != -1) {
-            if (ctx-&gt;obuf) {
-                OPENSSL_free(ctx-&gt;obuf);
-                ctx-&gt;obuf = NULL;
-            }
+            OPENSSL_free(ctx-&gt;obuf);
+            ctx-&gt;obuf = NULL;
             ctx-&gt;obufsize = obs;
         }
         ret = 1;
diff --git a/crypto/conf/conf_api.c b/crypto/conf/conf_api.c
index cba2de1..b41564b 100644
--- a/crypto/conf/conf_api.c
+++ b/crypto/conf/conf_api.c
@@ -273,8 +273,7 @@ CONF_VALUE *_CONF_new_section(CONF *conf, const char *section)
     if (!ok) {
         if (sk != NULL)
             sk_CONF_VALUE_free(sk);
-        if (v != NULL)
-            OPENSSL_free(v);
+        OPENSSL_free(v);
         v = NULL;
     }
     return (v);
diff --git a/crypto/conf/conf_def.c b/crypto/conf/conf_def.c
index ef3fef4..bd2e8c0 100644
--- a/crypto/conf/conf_def.c
+++ b/crypto/conf/conf_def.c
@@ -393,14 +393,12 @@ static int def_load_bio(CONF *conf, BIO *in, long *line)
     }
     if (buff != NULL)
         BUF_MEM_free(buff);
-    if (section != NULL)
-        OPENSSL_free(section);
+    OPENSSL_free(section);
     return (1);
  err:
     if (buff != NULL)
         BUF_MEM_free(buff);
-    if (section != NULL)
-        OPENSSL_free(section);
+    OPENSSL_free(section);
     if (line != NULL)
         *line = eline;
     BIO_snprintf(btmp, sizeof btmp, &quot;%ld&quot;, eline);
@@ -410,12 +408,9 @@ static int def_load_bio(CONF *conf, BIO *in, long *line)
         conf-&gt;data = NULL;
     }
     if (v != NULL) {
-        if (v-&gt;name != NULL)
-            OPENSSL_free(v-&gt;name);
-        if (v-&gt;value != NULL)
-            OPENSSL_free(v-&gt;value);
-        if (v != NULL)
-            OPENSSL_free(v);
+        OPENSSL_free(v-&gt;name);
+        OPENSSL_free(v-&gt;value);
+        OPENSSL_free(v);
     }
     return (0);
 }
@@ -595,8 +590,7 @@ static int str_copy(CONF *conf, char *section, char **pto, char *from)
             buf-&gt;data[to++] = *(from++);
     }
     buf-&gt;data[to] = '\0';
-    if (*pto != NULL)
-        OPENSSL_free(*pto);
+    OPENSSL_free(*pto);
     *pto = buf-&gt;data;
     OPENSSL_free(buf);
     return (1);
diff --git a/crypto/conf/conf_mod.c b/crypto/conf/conf_mod.c
index 9acfca4..ce2b177 100644
--- a/crypto/conf/conf_mod.c
+++ b/crypto/conf/conf_mod.c
@@ -383,10 +383,8 @@ static int module_init(CONF_MODULE *pmod, char *name, char *value,
 
  memerr:
     if (imod) {
-        if (imod-&gt;name)
-            OPENSSL_free(imod-&gt;name);
-        if (imod-&gt;value)
-            OPENSSL_free(imod-&gt;value);
+        OPENSSL_free(imod-&gt;name);
+        OPENSSL_free(imod-&gt;value);
         OPENSSL_free(imod);
     }
 
diff --git a/crypto/dh/dh_ameth.c b/crypto/dh/dh_ameth.c
index 6a4223c..c9374b7 100644
--- a/crypto/dh/dh_ameth.c
+++ b/crypto/dh/dh_ameth.c
@@ -187,8 +187,7 @@ static int dh_pub_encode(X509_PUBKEY *pk, const EVP_PKEY *pkey)
         return 1;
 
  err:
-    if (penc)
-        OPENSSL_free(penc);
+    OPENSSL_free(penc);
     ASN1_STRING_free(str);
 
     return 0;
@@ -292,8 +291,7 @@ static int dh_priv_encode(PKCS8_PRIV_KEY_INFO *p8, const EVP_PKEY *pkey)
     return 1;
 
  err:
-    if (dp != NULL)
-        OPENSSL_free(dp);
+    OPENSSL_free(dp);
     ASN1_STRING_free(params);
     ASN1_STRING_clear_free(prkey);
     return 0;
@@ -422,8 +420,7 @@ static int do_dh_print(BIO *bp, const DH *x, int indent,
  err:
         DHerr(DH_F_DO_DH_PRINT, reason);
     }
-    if (m != NULL)
-        OPENSSL_free(m);
+    OPENSSL_free(m);
     return (ret);
 }
 
@@ -481,11 +478,9 @@ static int int_dh_param_copy(DH *to, const DH *from, int is_x942)
             return 0;
         if (!int_dh_bn_cpy(&amp;to-&gt;j, from-&gt;j))
             return 0;
-        if (to-&gt;seed) {
-            OPENSSL_free(to-&gt;seed);
-            to-&gt;seed = NULL;
-            to-&gt;seedlen = 0;
-        }
+        OPENSSL_free(to-&gt;seed);
+        to-&gt;seed = NULL;
+        to-&gt;seedlen = 0;
         if (from-&gt;seed) {
             to-&gt;seed = BUF_memdup(from-&gt;seed, from-&gt;seedlen);
             if (!to-&gt;seed)
diff --git a/crypto/dh/dh_kdf.c b/crypto/dh/dh_kdf.c
index a882cb2..b812d82 100644
--- a/crypto/dh/dh_kdf.c
+++ b/crypto/dh/dh_kdf.c
@@ -180,8 +180,7 @@ int DH_KDF_X9_42(unsigned char *out, size_t outlen,
     }
     rv = 1;
  err:
-    if (der)
-        OPENSSL_free(der);
+    OPENSSL_free(der);
     EVP_MD_CTX_cleanup(&amp;mctx);
     return rv;
 }
diff --git a/crypto/dh/dh_lib.c b/crypto/dh/dh_lib.c
index 74bad4d..10e98c6 100644
--- a/crypto/dh/dh_lib.c
+++ b/crypto/dh/dh_lib.c
@@ -198,8 +198,7 @@ void DH_free(DH *r)
     BN_clear_free(r-&gt;g);
     BN_clear_free(r-&gt;q);
     BN_clear_free(r-&gt;j);
-    if (r-&gt;seed)
-        OPENSSL_free(r-&gt;seed);
+    OPENSSL_free(r-&gt;seed);
     BN_clear_free(r-&gt;counter);
     BN_clear_free(r-&gt;pub_key);
     BN_clear_free(r-&gt;priv_key);
diff --git a/crypto/dh/dh_pmeth.c b/crypto/dh/dh_pmeth.c
index 069b855..be44c0b 100644
--- a/crypto/dh/dh_pmeth.c
+++ b/crypto/dh/dh_pmeth.c
@@ -153,8 +153,7 @@ static void pkey_dh_cleanup(EVP_PKEY_CTX *ctx)
 {
     DH_PKEY_CTX *dctx = ctx-&gt;data;
     if (dctx) {
-        if (dctx-&gt;kdf_ukm)
-            OPENSSL_free(dctx-&gt;kdf_ukm);
+        OPENSSL_free(dctx-&gt;kdf_ukm);
         ASN1_OBJECT_free(dctx-&gt;kdf_oid);
         OPENSSL_free(dctx);
     }
@@ -230,8 +229,7 @@ static int pkey_dh_ctrl(EVP_PKEY_CTX *ctx, int type, int p1, void *p2)
         return 1;
 
     case EVP_PKEY_CTRL_DH_KDF_UKM:
-        if (dctx-&gt;kdf_ukm)
-            OPENSSL_free(dctx-&gt;kdf_ukm);
+        OPENSSL_free(dctx-&gt;kdf_ukm);
         dctx-&gt;kdf_ukm = p2;
         if (p2)
             dctx-&gt;kdf_ukmlen = p1;
diff --git a/crypto/dsa/dsa_ameth.c b/crypto/dsa/dsa_ameth.c
index e26ca84..e5009ec 100644
--- a/crypto/dsa/dsa_ameth.c
+++ b/crypto/dsa/dsa_ameth.c
@@ -169,8 +169,7 @@ static int dsa_pub_encode(X509_PUBKEY *pk, const EVP_PKEY *pkey)
         return 1;
 
  err:
-    if (penc)
-        OPENSSL_free(penc);
+    OPENSSL_free(penc);
     ASN1_STRING_free(str);
 
     return 0;
@@ -329,8 +328,7 @@ static int dsa_priv_encode(PKCS8_PRIV_KEY_INFO *p8, const EVP_PKEY *pkey)
     return 1;
 
  err:
-    if (dp != NULL)
-        OPENSSL_free(dp);
+    OPENSSL_free(dp);
     ASN1_STRING_free(params);
     ASN1_STRING_clear_free(prkey);
     return 0;
@@ -471,8 +469,7 @@ static int do_dsa_print(BIO *bp, const DSA *x, int off, int ptype)
         goto err;
     ret = 1;
  err:
-    if (m != NULL)
-        OPENSSL_free(m);
+    OPENSSL_free(m);
     return (ret);
 }
 
@@ -562,8 +559,7 @@ static int dsa_sig_print(BIO *bp, const X509_ALGOR *sigalg,
             goto err;
         rv = 1;
  err:
-        if (m)
-            OPENSSL_free(m);
+        OPENSSL_free(m);
         DSA_SIG_free(dsa_sig);
         return rv;
     }
diff --git a/crypto/dsa/dsa_gen.c b/crypto/dsa/dsa_gen.c
index 1827de8..59946f6 100644
--- a/crypto/dsa/dsa_gen.c
+++ b/crypto/dsa/dsa_gen.c
@@ -644,8 +644,7 @@ int dsa_builtin_paramgen2(DSA *ret, size_t L, size_t N,
         if (h_ret != NULL)
             *h_ret = h;
     }
-    if (seed)
-        OPENSSL_free(seed);
+    OPENSSL_free(seed);
     if (seed_out != seed_tmp)
         OPENSSL_free(seed_tmp);
     if (ctx)
diff --git a/crypto/dsa/dsa_pmeth.c b/crypto/dsa/dsa_pmeth.c
index c119209..7aa1054 100644
--- a/crypto/dsa/dsa_pmeth.c
+++ b/crypto/dsa/dsa_pmeth.c
@@ -113,8 +113,7 @@ static int pkey_dsa_copy(EVP_PKEY_CTX *dst, EVP_PKEY_CTX *src)
 static void pkey_dsa_cleanup(EVP_PKEY_CTX *ctx)
 {
     DSA_PKEY_CTX *dctx = ctx-&gt;data;
-    if (dctx)
-        OPENSSL_free(dctx);
+    OPENSSL_free(dctx);
 }
 
 static int pkey_dsa_sign(EVP_PKEY_CTX *ctx, unsigned char *sig,
diff --git a/crypto/dso/dso_dl.c b/crypto/dso/dso_dl.c
index 989d4d9..5d5ede0 100644
--- a/crypto/dso/dso_dl.c
+++ b/crypto/dso/dso_dl.c
@@ -143,8 +143,7 @@ static int dl_load(DSO *dso)
     return (1);
  err:
     /* Cleanup! */
-    if (filename != NULL)
-        OPENSSL_free(filename);
+    OPENSSL_free(filename);
     if (ptr != NULL)
         shl_unload(ptr);
     return (0);
diff --git a/crypto/dso/dso_dlfcn.c b/crypto/dso/dso_dlfcn.c
index 8ebb2b5..92d951f 100644
--- a/crypto/dso/dso_dlfcn.c
+++ b/crypto/dso/dso_dlfcn.c
@@ -182,8 +182,7 @@ static int dlfcn_load(DSO *dso)
     return (1);
  err:
     /* Cleanup! */
-    if (filename != NULL)
-        OPENSSL_free(filename);
+    OPENSSL_free(filename);
     if (ptr != NULL)
         dlclose(ptr);
     return (0);
diff --git a/crypto/dso/dso_lib.c b/crypto/dso/dso_lib.c
index c1d6d25..a33a8a8 100644
--- a/crypto/dso/dso_lib.c
+++ b/crypto/dso/dso_lib.c
@@ -162,11 +162,8 @@ int DSO_free(DSO *dso)
     }
 
     sk_void_free(dso-&gt;meth_data);
-    if (dso-&gt;filename != NULL)
-        OPENSSL_free(dso-&gt;filename);
-    if (dso-&gt;loaded_filename != NULL)
-        OPENSSL_free(dso-&gt;loaded_filename);
-
+    OPENSSL_free(dso-&gt;filename);
+    OPENSSL_free(dso-&gt;loaded_filename);
     OPENSSL_free(dso);
     return (1);
 }
@@ -360,8 +357,7 @@ int DSO_set_filename(DSO *dso, const char *filename)
         return (0);
     }
     BUF_strlcpy(copied, filename, strlen(filename) + 1);
-    if (dso-&gt;filename)
-        OPENSSL_free(dso-&gt;filename);
+    OPENSSL_free(dso-&gt;filename);
     dso-&gt;filename = copied;
     return (1);
 }
diff --git a/crypto/dso/dso_vms.c b/crypto/dso/dso_vms.c
index 79bbd97..821e238 100644
--- a/crypto/dso/dso_vms.c
+++ b/crypto/dso/dso_vms.c
@@ -267,10 +267,8 @@ static int vms_load(DSO *dso)
     return (1);
  err:
     /* Cleanup! */
-    if (p != NULL)
-        OPENSSL_free(p);
-    if (filename != NULL)
-        OPENSSL_free(filename);
+    OPENSSL_free(p);
+    OPENSSL_free(filename);
     return (0);
 }
 
diff --git a/crypto/dso/dso_win32.c b/crypto/dso/dso_win32.c
index 2499fc1..144d8e6 100644
--- a/crypto/dso/dso_win32.c
+++ b/crypto/dso/dso_win32.c
@@ -183,10 +183,8 @@ static int win32_load(DSO *dso)
     return (1);
  err:
     /* Cleanup ! */
-    if (filename != NULL)
-        OPENSSL_free(filename);
-    if (p != NULL)
-        OPENSSL_free(p);
+    OPENSSL_free(filename);
+    OPENSSL_free(p);
     if (h != NULL)
         FreeLibrary(h);
     return (0);
diff --git a/crypto/ec/ec_ameth.c b/crypto/ec/ec_ameth.c
index 0554c20..1cc4d40 100644
--- a/crypto/ec/ec_ameth.c
+++ b/crypto/ec/ec_ameth.c
@@ -132,8 +132,7 @@ static int eckey_pub_encode(X509_PUBKEY *pk, const EVP_PKEY *pkey)
         ASN1_OBJECT_free(pval);
     else
         ASN1_STRING_free(pval);
-    if (penc)
-        OPENSSL_free(penc);
+    OPENSSL_free(penc);
     return 0;
 }
 
@@ -503,8 +502,7 @@ static int do_EC_KEY_print(BIO *bp, const EC_KEY *x, int off, int ktype)
     BN_free(pub_key);
     BN_free(order);
     BN_CTX_free(ctx);
-    if (buffer != NULL)
-        OPENSSL_free(buffer);
+    OPENSSL_free(buffer);
     return (ret);
 }
 
diff --git a/crypto/ec/ec_asn1.c b/crypto/ec/ec_asn1.c
index 5976a2f..c86f22e 100644
--- a/crypto/ec/ec_asn1.c
+++ b/crypto/ec/ec_asn1.c
@@ -525,10 +525,8 @@ static int ec_asn1_group2curve(const EC_GROUP *group, X9_62_CURVE *curve)
     ok = 1;
 
  err:
-    if (buffer_1)
-        OPENSSL_free(buffer_1);
-    if (buffer_2)
-        OPENSSL_free(buffer_2);
+    OPENSSL_free(buffer_1);
+    OPENSSL_free(buffer_2);
     BN_free(tmp_1);
     BN_free(tmp_2);
     return (ok);
@@ -628,8 +626,7 @@ static ECPARAMETERS *ec_asn1_group2parameters(const EC_GROUP *group,
     if (!param)
         ECPARAMETERS_free(ret);
     BN_free(tmp);
-    if (buffer)
-        OPENSSL_free(buffer);
+    OPENSSL_free(buffer);
     return NULL;
 }
 
@@ -840,8 +837,7 @@ static EC_GROUP *ec_asn1_parameters2group(const ECPARAMETERS *params)
 
     /* extract seed (optional) */
     if (params-&gt;curve-&gt;seed != NULL) {
-        if (ret-&gt;seed != NULL)
-            OPENSSL_free(ret-&gt;seed);
+        OPENSSL_free(ret-&gt;seed);
         if (!(ret-&gt;seed = OPENSSL_malloc(params-&gt;curve-&gt;seed-&gt;length))) {
             ECerr(EC_F_EC_ASN1_PARAMETERS2GROUP, ERR_R_MALLOC_FAILURE);
             goto err;
@@ -1193,8 +1189,7 @@ int i2d_ECPrivateKey(EC_KEY *a, unsigned char **out)
     }
     ok = 1;
  err:
-    if (buffer)
-        OPENSSL_free(buffer);
+    OPENSSL_free(buffer);
     if (priv_key)
         EC_PRIVATEKEY_free(priv_key);
     return (ok ? ret : 0);
diff --git a/crypto/ec/ec_lib.c b/crypto/ec/ec_lib.c
index 1f51f74..02de91d 100644
--- a/crypto/ec/ec_lib.c
+++ b/crypto/ec/ec_lib.c
@@ -232,8 +232,7 @@ int EC_GROUP_copy(EC_GROUP *dest, const EC_GROUP *src)
     dest-&gt;asn1_form = src-&gt;asn1_form;
 
     if (src-&gt;seed) {
-        if (dest-&gt;seed)
-            OPENSSL_free(dest-&gt;seed);
+        OPENSSL_free(dest-&gt;seed);
         dest-&gt;seed = OPENSSL_malloc(src-&gt;seed_len);
         if (dest-&gt;seed == NULL)
             return 0;
@@ -241,8 +240,7 @@ int EC_GROUP_copy(EC_GROUP *dest, const EC_GROUP *src)
             return 0;
         dest-&gt;seed_len = src-&gt;seed_len;
     } else {
-        if (dest-&gt;seed)
-            OPENSSL_free(dest-&gt;seed);
+        OPENSSL_free(dest-&gt;seed);
         dest-&gt;seed = NULL;
         dest-&gt;seed_len = 0;
     }
@@ -382,11 +380,9 @@ point_conversion_form_t EC_GROUP_get_point_conversion_form(const EC_GROUP
 
 size_t EC_GROUP_set_seed(EC_GROUP *group, const unsigned char *p, size_t len)
 {
-    if (group-&gt;seed) {
-        OPENSSL_free(group-&gt;seed);
-        group-&gt;seed = NULL;
-        group-&gt;seed_len = 0;
-    }
+    OPENSSL_free(group-&gt;seed);
+    group-&gt;seed = NULL;
+    group-&gt;seed_len = 0;
 
     if (!len || !p)
         return 1;
diff --git a/crypto/ec/ec_mult.c b/crypto/ec/ec_mult.c
index b4723fb..115bc42 100644
--- a/crypto/ec/ec_mult.c
+++ b/crypto/ec/ec_mult.c
@@ -555,10 +555,8 @@ int ec_wNAF_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *scalar,
  err:
     BN_CTX_free(new_ctx);
     EC_POINT_free(tmp);
-    if (wsize != NULL)
-        OPENSSL_free(wsize);
-    if (wNAF_len != NULL)
-        OPENSSL_free(wNAF_len);
+    OPENSSL_free(wsize);
+    OPENSSL_free(wNAF_len);
     if (wNAF != NULL) {
         signed char **w;
 
@@ -573,9 +571,7 @@ int ec_wNAF_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *scalar,
 
         OPENSSL_free(val);
     }
-    if (val_sub != NULL) {
-        OPENSSL_free(val_sub);
-    }
+    OPENSSL_free(val_sub);
     return ret;
 }
 
diff --git a/crypto/ec/ec_pmeth.c b/crypto/ec/ec_pmeth.c
index 5b3d197..ec27e23 100644
--- a/crypto/ec/ec_pmeth.c
+++ b/crypto/ec/ec_pmeth.c
@@ -148,8 +148,7 @@ static void pkey_ec_cleanup(EVP_PKEY_CTX *ctx)
     if (dctx) {
         EC_GROUP_free(dctx-&gt;gen_group);
         EC_KEY_free(dctx-&gt;co_key);
-        if (dctx-&gt;kdf_ukm)
-            OPENSSL_free(dctx-&gt;kdf_ukm);
+        OPENSSL_free(dctx-&gt;kdf_ukm);
         OPENSSL_free(dctx);
     }
 }
@@ -359,8 +358,7 @@ static int pkey_ec_ctrl(EVP_PKEY_CTX *ctx, int type, int p1, void *p2)
         return 1;
 
     case EVP_PKEY_CTRL_EC_KDF_UKM:
-        if (dctx-&gt;kdf_ukm)
-            OPENSSL_free(dctx-&gt;kdf_ukm);
+        OPENSSL_free(dctx-&gt;kdf_ukm);
         dctx-&gt;kdf_ukm = p2;
         if (p2)
             dctx-&gt;kdf_ukmlen = p1;
diff --git a/crypto/ec/eck_prn.c b/crypto/ec/eck_prn.c
index 6eb5291..7cdc485 100644
--- a/crypto/ec/eck_prn.c
+++ b/crypto/ec/eck_prn.c
@@ -325,8 +325,7 @@ int ECPKParameters_print(BIO *bp, const EC_GROUP *x, int off)
     BN_free(order);
     BN_free(cofactor);
     BN_CTX_free(ctx);
-    if (buffer != NULL)
-        OPENSSL_free(buffer);
+    OPENSSL_free(buffer);
     return (ret);
 }
 
diff --git a/crypto/ec/ecp_nistp224.c b/crypto/ec/ecp_nistp224.c
index fdcf450..60a8d50 100644
--- a/crypto/ec/ecp_nistp224.c
+++ b/crypto/ec/ecp_nistp224.c
@@ -1573,12 +1573,9 @@ int ec_GFp_nistp224_points_mul(const EC_GROUP *group, EC_POINT *r,
     BN_CTX_end(ctx);
     EC_POINT_free(generator);
     BN_CTX_free(new_ctx);
-    if (secrets != NULL)
-        OPENSSL_free(secrets);
-    if (pre_comp != NULL)
-        OPENSSL_free(pre_comp);
-    if (tmp_felems != NULL)
-        OPENSSL_free(tmp_felems);
+    OPENSSL_free(secrets);
+    OPENSSL_free(pre_comp);
+    OPENSSL_free(tmp_felems);
     return ret;
 }
 
diff --git a/crypto/ec/ecp_nistp256.c b/crypto/ec/ecp_nistp256.c
index d03bf15..c9f073b 100644
--- a/crypto/ec/ecp_nistp256.c
+++ b/crypto/ec/ecp_nistp256.c
@@ -2193,12 +2193,9 @@ int ec_GFp_nistp256_points_mul(const EC_GROUP *group, EC_POINT *r,
     BN_CTX_end(ctx);
     EC_POINT_free(generator);
     BN_CTX_free(new_ctx);
-    if (secrets != NULL)
-        OPENSSL_free(secrets);
-    if (pre_comp != NULL)
-        OPENSSL_free(pre_comp);
-    if (tmp_smallfelems != NULL)
-        OPENSSL_free(tmp_smallfelems);
+    OPENSSL_free(secrets);
+    OPENSSL_free(pre_comp);
+    OPENSSL_free(tmp_smallfelems);
     return ret;
 }
 
diff --git a/crypto/ec/ecp_nistp521.c b/crypto/ec/ecp_nistp521.c
index 1069214..bdfd576 100644
--- a/crypto/ec/ecp_nistp521.c
+++ b/crypto/ec/ecp_nistp521.c
@@ -2021,12 +2021,9 @@ int ec_GFp_nistp521_points_mul(const EC_GROUP *group, EC_POINT *r,
     BN_CTX_end(ctx);
     EC_POINT_free(generator);
     BN_CTX_free(new_ctx);
-    if (secrets != NULL)
-        OPENSSL_free(secrets);
-    if (pre_comp != NULL)
-        OPENSSL_free(pre_comp);
-    if (tmp_felems != NULL)
-        OPENSSL_free(tmp_felems);
+    OPENSSL_free(secrets);
+    OPENSSL_free(pre_comp);
+    OPENSSL_free(tmp_felems);
     return ret;
 }
 
diff --git a/crypto/ec/ecp_nistz256.c b/crypto/ec/ecp_nistz256.c
index ae1fcdd..e73d26c 100644
--- a/crypto/ec/ecp_nistz256.c
+++ b/crypto/ec/ecp_nistz256.c
@@ -721,12 +721,9 @@ __owur static int ecp_nistz256_windowed_mul(const EC_GROUP *group,
 
     ret = 1;
  err:
-    if (table_storage)
-        OPENSSL_free(table_storage);
-    if (p_str)
-        OPENSSL_free(p_str);
-    if (scalars)
-        OPENSSL_free(scalars);
+    OPENSSL_free(table_storage);
+    OPENSSL_free(p_str);
+    OPENSSL_free(scalars);
     return ret;
 }
 
@@ -889,8 +886,7 @@ __owur static int ecp_nistz256_mult_precompute(EC_GROUP *group, BN_CTX *ctx)
     BN_CTX_free(new_ctx);
 
     ecp_nistz256_pre_comp_free(pre_comp);
-    if (precomp_storage)
-        OPENSSL_free(precomp_storage);
+    OPENSSL_free(precomp_storage);
     EC_POINT_free(P);
     EC_POINT_free(T);
     return ret;
@@ -1356,10 +1352,8 @@ err:
     if (ctx)
         BN_CTX_end(ctx);
     BN_CTX_free(new_ctx);
-    if (new_points)
-        OPENSSL_free(new_points);
-    if (new_scalars)
-        OPENSSL_free(new_scalars);
+    OPENSSL_free(new_points);
+    OPENSSL_free(new_scalars);
     return ret;
 }
 
@@ -1451,9 +1445,7 @@ static void ecp_nistz256_pre_comp_free(void *pre_)
     if (i &gt; 0)
         return;
 
-    if (pre-&gt;precomp_storage)
-        OPENSSL_free(pre-&gt;precomp_storage);
-
+    OPENSSL_free(pre-&gt;precomp_storage);
     OPENSSL_free(pre);
 }
 
diff --git a/crypto/ecdh/ech_ossl.c b/crypto/ecdh/ech_ossl.c
index 6297706..ad3482f 100644
--- a/crypto/ecdh/ech_ossl.c
+++ b/crypto/ecdh/ech_ossl.c
@@ -206,7 +206,6 @@ static int ecdh_compute_key(void *out, size_t outlen, const EC_POINT *pub_key,
     if (ctx)
         BN_CTX_end(ctx);
     BN_CTX_free(ctx);
-    if (buf)
-        OPENSSL_free(buf);
+    OPENSSL_free(buf);
     return (ret);
 }
diff --git a/crypto/engine/eng_cryptodev.c b/crypto/engine/eng_cryptodev.c
index a3be0d7..d801ae8 100644
--- a/crypto/engine/eng_cryptodev.c
+++ b/crypto/engine/eng_cryptodev.c
@@ -889,11 +889,9 @@ static int cryptodev_digest_cleanup(EVP_MD_CTX *ctx)
         return (0);
     }
 
-    if (state-&gt;mac_data) {
-        OPENSSL_free(state-&gt;mac_data);
-        state-&gt;mac_data = NULL;
-        state-&gt;mac_len = 0;
-    }
+    OPENSSL_free(state-&gt;mac_data);
+    state-&gt;mac_data = NULL;
+    state-&gt;mac_len = 0;
 
     if (ioctl(state-&gt;d_fd, CIOCFSESSION, &amp;sess-&gt;ses) &lt; 0) {
         printf(&quot;cryptodev_digest_cleanup: failed to close session\n&quot;);
diff --git a/crypto/engine/eng_dyn.c b/crypto/engine/eng_dyn.c
index 31ec324..7dd3659 100644
--- a/crypto/engine/eng_dyn.c
+++ b/crypto/engine/eng_dyn.c
@@ -136,11 +136,11 @@ struct st_dynamic_data_ctx {
      */
     dynamic_bind_engine bind_engine;
     /* The default name/path for loading the shared library */
-    const char *DYNAMIC_LIBNAME;
+    char *DYNAMIC_LIBNAME;
     /* Whether to continue loading on a version check failure */
     int no_vcheck;
     /* If non-NULL, stipulates the 'id' of the ENGINE to be loaded */
-    const char *engine_id;
+    char *engine_id;
     /*
      * If non-zero, a successfully loaded ENGINE should be added to the
      * internal ENGINE list. If 2, the add must succeed or the entire load
@@ -188,10 +188,8 @@ static void dynamic_data_ctx_free_func(void *parent, void *ptr,
         dynamic_data_ctx *ctx = (dynamic_data_ctx *)ptr;
         if (ctx-&gt;dynamic_dso)
             DSO_free(ctx-&gt;dynamic_dso);
-        if (ctx-&gt;DYNAMIC_LIBNAME)
-            OPENSSL_free((void *)ctx-&gt;DYNAMIC_LIBNAME);
-        if (ctx-&gt;engine_id)
-            OPENSSL_free((void *)ctx-&gt;engine_id);
+        OPENSSL_free(ctx-&gt;DYNAMIC_LIBNAME);
+        OPENSSL_free(ctx-&gt;engine_id);
         if (ctx-&gt;dirs)
             sk_OPENSSL_STRING_pop_free(ctx-&gt;dirs, int_free_str);
         OPENSSL_free(ctx);
@@ -243,8 +241,7 @@ static int dynamic_set_data_ctx(ENGINE *e, dynamic_data_ctx **ctx)
      * If we lost the race to set the context, c is non-NULL and *ctx is the
      * context of the thread that won.
      */
-    if (c)
-        OPENSSL_free(c);
+    OPENSSL_free(c);
     return 1;
 }
 
@@ -363,8 +360,7 @@ static int dynamic_ctrl(ENGINE *e, int cmd, long i, void *p, void (*f) (void))
         /* a NULL 'p' or a string of zero-length is the same thing */
         if (p &amp;&amp; (strlen((const char *)p) &lt; 1))
             p = NULL;
-        if (ctx-&gt;DYNAMIC_LIBNAME)
-            OPENSSL_free((void *)ctx-&gt;DYNAMIC_LIBNAME);
+        OPENSSL_free(ctx-&gt;DYNAMIC_LIBNAME);
         if (p)
             ctx-&gt;DYNAMIC_LIBNAME = BUF_strdup(p);
         else
@@ -377,8 +373,7 @@ static int dynamic_ctrl(ENGINE *e, int cmd, long i, void *p, void (*f) (void))
         /* a NULL 'p' or a string of zero-length is the same thing */
         if (p &amp;&amp; (strlen((const char *)p) &lt; 1))
             p = NULL;
-        if (ctx-&gt;engine_id)
-            OPENSSL_free((void *)ctx-&gt;engine_id);
+        OPENSSL_free(ctx-&gt;engine_id);
         if (p)
             ctx-&gt;engine_id = BUF_strdup(p);
         else
diff --git a/crypto/err/err.c b/crypto/err/err.c
index ec7da22..9d58f38 100644
--- a/crypto/err/err.c
+++ b/crypto/err/err.c
@@ -478,8 +478,7 @@ static void build_SYS_str_reasons(void)
 
 #define err_clear_data(p,i) \
         do { \
-        if (((p)-&gt;err_data[i] != NULL) &amp;&amp; \
-                (p)-&gt;err_data_flags[i] &amp; ERR_TXT_MALLOCED) \
+        if ((p)-&gt;err_data_flags[i] &amp; ERR_TXT_MALLOCED) \
                 {  \
                 OPENSSL_free((p)-&gt;err_data[i]); \
                 (p)-&gt;err_data[i]=NULL; \
diff --git a/crypto/evp/evp_enc.c b/crypto/evp/evp_enc.c
index 3468b6b..c2387b9 100644
--- a/crypto/evp/evp_enc.c
+++ b/crypto/evp/evp_enc.c
@@ -523,8 +523,7 @@ int EVP_DecryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
 void EVP_CIPHER_CTX_free(EVP_CIPHER_CTX *ctx)
 {
     EVP_CIPHER_CTX_cleanup(ctx);
-    if (ctx)
-        OPENSSL_free(ctx);
+    OPENSSL_free(ctx);
 }
 
 int EVP_CIPHER_CTX_cleanup(EVP_CIPHER_CTX *c)
@@ -538,8 +537,7 @@ int EVP_CIPHER_CTX_cleanup(EVP_CIPHER_CTX *c)
         if (c-&gt;cipher_data)
             OPENSSL_cleanse(c-&gt;cipher_data, c-&gt;cipher-&gt;ctx_size);
     }
-    if (c-&gt;cipher_data)
-        OPENSSL_free(c-&gt;cipher_data);
+    OPENSSL_free(c-&gt;cipher_data);
 #ifndef OPENSSL_NO_ENGINE
     if (c-&gt;engine)
         /*
diff --git a/crypto/ex_data.c b/crypto/ex_data.c
index 6a567c9..66070f6 100644
--- a/crypto/ex_data.c
+++ b/crypto/ex_data.c
@@ -444,8 +444,7 @@ static int int_new_ex_data(int class_index, void *obj, CRYPTO_EX_DATA *ad)
                                  storage[i]-&gt;argl, storage[i]-&gt;argp);
         }
     }
-    if (storage)
-        OPENSSL_free(storage);
+    OPENSSL_free(storage);
     return 1;
 }
 
@@ -487,8 +486,7 @@ static int int_dup_ex_data(int class_index, CRYPTO_EX_DATA *to,
                                  storage[i]-&gt;argl, storage[i]-&gt;argp);
         CRYPTO_set_ex_data(to, i, ptr);
     }
-    if (storage)
-        OPENSSL_free(storage);
+    OPENSSL_free(storage);
     return 1;
 }
 
@@ -525,8 +523,7 @@ static void int_free_ex_data(int class_index, void *obj, CRYPTO_EX_DATA *ad)
                                   storage[i]-&gt;argl, storage[i]-&gt;argp);
         }
     }
-    if (storage)
-        OPENSSL_free(storage);
+    OPENSSL_free(storage);
     if (ad-&gt;sk) {
         sk_void_free(ad-&gt;sk);
         ad-&gt;sk = NULL;
diff --git a/crypto/mem.c b/crypto/mem.c
index 6176b38..14f67a4 100644
--- a/crypto/mem.c
+++ b/crypto/mem.c
@@ -453,8 +453,7 @@ void CRYPTO_clear_free(void *str, size_t num)
 
 void *CRYPTO_remalloc(void *a, int num, const char *file, int line)
 {
-    if (a != NULL)
-        OPENSSL_free(a);
+    OPENSSL_free(a);
     a = OPENSSL_malloc(num);
     return (a);
 }
diff --git a/crypto/objects/obj_dat.c b/crypto/objects/obj_dat.c
index 46c4f87..bca3ded 100644
--- a/crypto/objects/obj_dat.c
+++ b/crypto/objects/obj_dat.c
@@ -276,8 +276,7 @@ int OBJ_add_object(const ASN1_OBJECT *obj)
             ao[i]-&gt;obj = o;
             aop = lh_ADDED_OBJ_insert(added, ao[i]);
             /* memory leak, buit should not normally matter */
-            if (aop != NULL)
-                OPENSSL_free(aop);
+            OPENSSL_free(aop);
         }
     }
     o-&gt;flags &amp;=
@@ -289,10 +288,8 @@ int OBJ_add_object(const ASN1_OBJECT *obj)
     OBJerr(OBJ_F_OBJ_ADD_OBJECT, ERR_R_MALLOC_FAILURE);
  err:
     for (i = ADDED_DATA; i &lt;= ADDED_NID; i++)
-        if (ao[i] != NULL)
-            OPENSSL_free(ao[i]);
-    if (o != NULL)
-        OPENSSL_free(o);
+        OPENSSL_free(ao[i]);
+    OPENSSL_free(o);
     return (NID_undef);
 }
 
diff --git a/crypto/objects/obj_lib.c b/crypto/objects/obj_lib.c
index 0bcb5df..58e9a92 100644
--- a/crypto/objects/obj_lib.c
+++ b/crypto/objects/obj_lib.c
@@ -114,14 +114,10 @@ ASN1_OBJECT *OBJ_dup(const ASN1_OBJECT *o)
     return (r);
  err:
     OBJerr(OBJ_F_OBJ_DUP, ERR_R_MALLOC_FAILURE);
-    if (ln != NULL)
-        OPENSSL_free(ln);
-    if (sn != NULL)
-        OPENSSL_free(sn);
-    if (data != NULL)
-        OPENSSL_free(data);
-    if (r != NULL)
-        OPENSSL_free(r);
+    OPENSSL_free(ln);
+    OPENSSL_free(sn);
+    OPENSSL_free(data);
+    OPENSSL_free(r);
     return (NULL);
 }
 
diff --git a/crypto/ocsp/ocsp_ext.c b/crypto/ocsp/ocsp_ext.c
index 520b55a..91eac9b 100644
--- a/crypto/ocsp/ocsp_ext.c
+++ b/crypto/ocsp/ocsp_ext.c
@@ -326,8 +326,7 @@ static int ocsp_add1_nonce(STACK_OF(X509_EXTENSION) **exts,
         goto err;
     ret = 1;
  err:
-    if (os.data)
-        OPENSSL_free(os.data);
+    OPENSSL_free(os.data);
     return ret;
 }
 
diff --git a/crypto/ocsp/ocsp_ht.c b/crypto/ocsp/ocsp_ht.c
index 266b43b..aa10c03 100644
--- a/crypto/ocsp/ocsp_ht.c
+++ b/crypto/ocsp/ocsp_ht.c
@@ -139,8 +139,7 @@ void OCSP_REQ_CTX_free(OCSP_REQ_CTX *rctx)
     if (!rctx)
         return;
     BIO_free(rctx-&gt;mem);
-    if (rctx-&gt;iobuf)
-        OPENSSL_free(rctx-&gt;iobuf);
+    OPENSSL_free(rctx-&gt;iobuf);
     OPENSSL_free(rctx);
 }
 
diff --git a/crypto/ocsp/ocsp_lib.c b/crypto/ocsp/ocsp_lib.c
index 34df9ac..ac64b65 100644
--- a/crypto/ocsp/ocsp_lib.c
+++ b/crypto/ocsp/ocsp_lib.c
@@ -273,14 +273,10 @@ int OCSP_parse_url(const char *url, char **phost, char **pport, char **ppath,
     OCSPerr(OCSP_F_OCSP_PARSE_URL, OCSP_R_ERROR_PARSING_URL);
 
  err:
-    if (buf)
-        OPENSSL_free(buf);
-    if (*ppath)
-        OPENSSL_free(*ppath);
-    if (*pport)
-        OPENSSL_free(*pport);
-    if (*phost)
-        OPENSSL_free(*phost);
+    OPENSSL_free(buf);
+    OPENSSL_free(*ppath);
+    OPENSSL_free(*pport);
+    OPENSSL_free(*phost);
     return 0;
 
 }
diff --git a/crypto/pem/pem_info.c b/crypto/pem/pem_info.c
index 0e7338b..29670ed 100644
--- a/crypto/pem/pem_info.c
+++ b/crypto/pem/pem_info.c
@@ -253,14 +253,11 @@ STACK_OF(X509_INFO) *PEM_X509_INFO_read_bio(BIO *bp, STACK_OF(X509_INFO) *sk,
         } else {
             /* unknown */
         }
-        if (name != NULL)
-            OPENSSL_free(name);
-        if (header != NULL)
-            OPENSSL_free(header);
-        if (data != NULL)
-            OPENSSL_free(data);
+        OPENSSL_free(name);
         name = NULL;
+        OPENSSL_free(header);
         header = NULL;
+        OPENSSL_free(data);
         data = NULL;
     }
 
@@ -287,12 +284,9 @@ STACK_OF(X509_INFO) *PEM_X509_INFO_read_bio(BIO *bp, STACK_OF(X509_INFO) *sk,
         ret = NULL;
     }
 
-    if (name != NULL)
-        OPENSSL_free(name);
-    if (header != NULL)
-        OPENSSL_free(header);
-    if (data != NULL)
-        OPENSSL_free(data);
+    OPENSSL_free(name);
+    OPENSSL_free(header);
+    OPENSSL_free(data);
     return (ret);
 }
 
diff --git a/crypto/pem/pem_seal.c b/crypto/pem/pem_seal.c
index 374273d..a3812b8 100644
--- a/crypto/pem/pem_seal.c
+++ b/crypto/pem/pem_seal.c
@@ -112,8 +112,7 @@ int PEM_SealInit(PEM_ENCODE_SEAL_CTX *ctx, EVP_CIPHER *type, EVP_MD *md_type,
 
     ret = npubk;
  err:
-    if (s != NULL)
-        OPENSSL_free(s);
+    OPENSSL_free(s);
     OPENSSL_cleanse(key, EVP_MAX_KEY_LENGTH);
     return (ret);
 }
@@ -181,8 +180,7 @@ int PEM_SealFinal(PEM_ENCODE_SEAL_CTX *ctx, unsigned char *sig, int *sigl,
  err:
     EVP_MD_CTX_cleanup(&amp;ctx-&gt;md);
     EVP_CIPHER_CTX_cleanup(&amp;ctx-&gt;cipher);
-    if (s != NULL)
-        OPENSSL_free(s);
+    OPENSSL_free(s);
     return (ret);
 }
 #else                           /* !OPENSSL_NO_RSA */
diff --git a/crypto/pem/pem_sign.c b/crypto/pem/pem_sign.c
index 87cc727..e16be4a 100644
--- a/crypto/pem/pem_sign.c
+++ b/crypto/pem/pem_sign.c
@@ -95,7 +95,6 @@ int PEM_SignFinal(EVP_MD_CTX *ctx, unsigned char *sigret,
     ret = 1;
  err:
     /* ctx has been zeroed by EVP_SignFinal() */
-    if (m != NULL)
-        OPENSSL_free(m);
+    OPENSSL_free(m);
     return (ret);
 }
diff --git a/crypto/pem/pvkfmt.c b/crypto/pem/pvkfmt.c
index b44912b..9e9c948 100644
--- a/crypto/pem/pvkfmt.c
+++ b/crypto/pem/pvkfmt.c
@@ -285,8 +285,7 @@ static EVP_PKEY *do_b2i_bio(BIO *in, int ispub)
         ret = b2i_rsa(&amp;p, length, bitlen, ispub);
 
  err:
-    if (buf)
-        OPENSSL_free(buf);
+    OPENSSL_free(buf);
     return ret;
 }
 
@@ -737,7 +736,7 @@ static EVP_PKEY *do_PVK_body(const unsigned char **in,
     ret = b2i_PrivateKey(&amp;p, keylen);
  err:
     EVP_CIPHER_CTX_cleanup(&amp;cctx);
-    if (enctmp &amp;&amp; saltlen)
+    if (saltlen)
         OPENSSL_free(enctmp);
     return ret;
 }
diff --git a/crypto/pkcs7/pk7_doit.c b/crypto/pkcs7/pk7_doit.c
index 4bc06b9..e5ad95f 100644
--- a/crypto/pkcs7/pk7_doit.c
+++ b/crypto/pkcs7/pk7_doit.c
@@ -181,8 +181,7 @@ static int pkcs7_encode_rinfo(PKCS7_RECIP_INFO *ri,
  err:
     EVP_PKEY_free(pkey);
     EVP_PKEY_CTX_free(pctx);
-    if (ek)
-        OPENSSL_free(ek);
+    OPENSSL_free(ek);
     return ret;
 
 }
@@ -235,7 +234,7 @@ static int pkcs7_decrypt_rinfo(unsigned char **pek, int *peklen,
 
  err:
     EVP_PKEY_CTX_free(pctx);
-    if (!ret &amp;&amp; ek)
+    if (!ret)
         OPENSSL_free(ek);
 
     return ret;
@@ -890,8 +889,7 @@ int PKCS7_SIGNER_INFO_sign(PKCS7_SIGNER_INFO *si)
     return 1;
 
  err:
-    if (abuf)
-        OPENSSL_free(abuf);
+    OPENSSL_free(abuf);
     EVP_MD_CTX_cleanup(&amp;mctx);
     return 0;
 
diff --git a/crypto/rsa/rsa_ameth.c b/crypto/rsa/rsa_ameth.c
index 38b850a..9313c93 100644
--- a/crypto/rsa/rsa_ameth.c
+++ b/crypto/rsa/rsa_ameth.c
@@ -251,8 +251,7 @@ static int do_rsa_print(BIO *bp, const RSA *x, int off, int priv)
     }
     ret = 1;
  err:
-    if (m != NULL)
-        OPENSSL_free(m);
+    OPENSSL_free(m);
     return (ret);
 }
 
diff --git a/crypto/rsa/rsa_oaep.c b/crypto/rsa/rsa_oaep.c
index ab8f9ec..d988d6c 100644
--- a/crypto/rsa/rsa_oaep.c
+++ b/crypto/rsa/rsa_oaep.c
@@ -232,10 +232,8 @@ int RSA_padding_check_PKCS1_OAEP_mgf1(unsigned char *to, int tlen,
     RSAerr(RSA_F_RSA_PADDING_CHECK_PKCS1_OAEP_MGF1,
            RSA_R_OAEP_DECODING_ERROR);
  cleanup:
-    if (db != NULL)
-        OPENSSL_free(db);
-    if (em != NULL)
-        OPENSSL_free(em);
+    OPENSSL_free(db);
+    OPENSSL_free(em);
     return mlen;
 }
 
diff --git a/crypto/rsa/rsa_pk1.c b/crypto/rsa/rsa_pk1.c
index efa1fd3..1bda998 100644
--- a/crypto/rsa/rsa_pk1.c
+++ b/crypto/rsa/rsa_pk1.c
@@ -266,8 +266,7 @@ int RSA_padding_check_PKCS1_type_2(unsigned char *to, int tlen,
     memcpy(to, em + msg_index, mlen);
 
  err:
-    if (em != NULL)
-        OPENSSL_free(em);
+    OPENSSL_free(em);
     if (mlen == -1)
         RSAerr(RSA_F_RSA_PADDING_CHECK_PKCS1_TYPE_2,
                RSA_R_PKCS_DECODING_ERROR);
diff --git a/crypto/rsa/rsa_pmeth.c b/crypto/rsa/rsa_pmeth.c
index 866dd16..94dc408 100644
--- a/crypto/rsa/rsa_pmeth.c
+++ b/crypto/rsa/rsa_pmeth.c
@@ -136,8 +136,7 @@ static int pkey_rsa_copy(EVP_PKEY_CTX *dst, EVP_PKEY_CTX *src)
     dctx-&gt;md = sctx-&gt;md;
     dctx-&gt;mgf1md = sctx-&gt;mgf1md;
     if (sctx-&gt;oaep_label) {
-        if (dctx-&gt;oaep_label)
-            OPENSSL_free(dctx-&gt;oaep_label);
+        OPENSSL_free(dctx-&gt;oaep_label);
         dctx-&gt;oaep_label = BUF_memdup(sctx-&gt;oaep_label, sctx-&gt;oaep_labellen);
         if (!dctx-&gt;oaep_label)
             return 0;
@@ -161,10 +160,8 @@ static void pkey_rsa_cleanup(EVP_PKEY_CTX *ctx)
     RSA_PKEY_CTX *rctx = ctx-&gt;data;
     if (rctx) {
         BN_free(rctx-&gt;pub_exp);
-        if (rctx-&gt;tbuf)
-            OPENSSL_free(rctx-&gt;tbuf);
-        if (rctx-&gt;oaep_label)
-            OPENSSL_free(rctx-&gt;oaep_label);
+        OPENSSL_free(rctx-&gt;tbuf);
+        OPENSSL_free(rctx-&gt;oaep_label);
         OPENSSL_free(rctx);
     }
 }
@@ -514,8 +511,7 @@ static int pkey_rsa_ctrl(EVP_PKEY_CTX *ctx, int type, int p1, void *p2)
             RSAerr(RSA_F_PKEY_RSA_CTRL, RSA_R_INVALID_PADDING_MODE);
             return -2;
         }
-        if (rctx-&gt;oaep_label)
-            OPENSSL_free(rctx-&gt;oaep_label);
+        OPENSSL_free(rctx-&gt;oaep_label);
         if (p2 &amp;&amp; p1 &gt; 0) {
             rctx-&gt;oaep_label = p2;
             rctx-&gt;oaep_labellen = p1;
diff --git a/crypto/rsa/rsa_pss.c b/crypto/rsa/rsa_pss.c
index 318f5b8..b5055de 100644
--- a/crypto/rsa/rsa_pss.c
+++ b/crypto/rsa/rsa_pss.c
@@ -170,8 +170,7 @@ int RSA_verify_PKCS1_PSS_mgf1(RSA *rsa, const unsigned char *mHash,
         ret = 1;
 
  err:
-    if (DB)
-        OPENSSL_free(DB);
+    OPENSSL_free(DB);
     EVP_MD_CTX_cleanup(&amp;ctx);
 
     return ret;
@@ -279,8 +278,7 @@ int RSA_padding_add_PKCS1_PSS_mgf1(RSA *rsa, unsigned char *EM,
     ret = 1;
 
  err:
-    if (salt)
-        OPENSSL_free(salt);
+    OPENSSL_free(salt);
 
     return ret;
 
diff --git a/crypto/stack/stack.c b/crypto/stack/stack.c
index d4ac91e..7611631 100644
--- a/crypto/stack/stack.c
+++ b/crypto/stack/stack.c
@@ -167,8 +167,7 @@ _STACK *sk_new(int (*c) (const void *, const void *))
     ret-&gt;sorted = 0;
     return (ret);
  err:
-    if (ret)
-        OPENSSL_free(ret);
+    OPENSSL_free(ret);
     return (NULL);
 }
 
@@ -318,8 +317,7 @@ void sk_free(_STACK *st)
 {
     if (st == NULL)
         return;
-    if (st-&gt;data != NULL)
-        OPENSSL_free(st-&gt;data);
+    OPENSSL_free(st-&gt;data);
     OPENSSL_free(st);
 }
 
diff --git a/crypto/store/str_mem.c b/crypto/store/str_mem.c
index f949b34..8687100 100644
--- a/crypto/store/str_mem.c
+++ b/crypto/store/str_mem.c
@@ -348,8 +348,7 @@ static int mem_list_end(STORE *s, void *handle)
     }
     if (context &amp;&amp; context-&gt;search_attributes)
         sk_STORE_ATTR_INFO_free(context-&gt;search_attributes);
-    if (context)
-        OPENSSL_free(context);
+    OPENSSL_free(context);
     return 1;
 }
 
diff --git a/crypto/threads/th-lock.c b/crypto/threads/th-lock.c
index 6732dd7..e74474a 100644
--- a/crypto/threads/th-lock.c
+++ b/crypto/threads/th-lock.c
@@ -318,10 +318,8 @@ void CRYPTO_thread_setup(void)
     lock_count = OPENSSL_malloc(CRYPTO_num_locks() * sizeof(long));
     if (!lock_cs || !lock_count) {
         /* Nothing we can do about this...void function! */
-        if (lock_cs)
-            OPENSSL_free(lock_cs);
-        if (lock_count)
-            OPENSSL_free(lock_count);
+        OPENSSL_free(lock_cs);
+        OPENSSL_free(lock_count);
         return;
     }
     for (i = 0; i &lt; CRYPTO_num_locks(); i++) {
diff --git a/crypto/txt_db/txt_db.c b/crypto/txt_db/txt_db.c
index 7f0548f..029d0bb 100644
--- a/crypto/txt_db/txt_db.c
+++ b/crypto/txt_db/txt_db.c
@@ -184,12 +184,9 @@ TXT_DB *TXT_DB_read(BIO *in, int num)
         if (ret != NULL) {
             if (ret-&gt;data != NULL)
                 sk_OPENSSL_PSTRING_free(ret-&gt;data);
-            if (ret-&gt;index != NULL)
-                OPENSSL_free(ret-&gt;index);
-            if (ret-&gt;qual != NULL)
-                OPENSSL_free(ret-&gt;qual);
-            if (ret != NULL)
-                OPENSSL_free(ret);
+            OPENSSL_free(ret-&gt;index);
+            OPENSSL_free(ret-&gt;qual);
+            OPENSSL_free(ret);
         }
         return (NULL);
     } else
@@ -350,8 +347,7 @@ void TXT_DB_free(TXT_DB *db)
                 lh_OPENSSL_STRING_free(db-&gt;index[i]);
         OPENSSL_free(db-&gt;index);
     }
-    if (db-&gt;qual != NULL)
-        OPENSSL_free(db-&gt;qual);
+    OPENSSL_free(db-&gt;qual);
     if (db-&gt;data != NULL) {
         for (i = sk_OPENSSL_PSTRING_num(db-&gt;data) - 1; i &gt;= 0; i--) {
             /*
@@ -362,12 +358,10 @@ void TXT_DB_free(TXT_DB *db)
             max = p[db-&gt;num_fields]; /* last address */
             if (max == NULL) {  /* new row */
                 for (n = 0; n &lt; db-&gt;num_fields; n++)
-                    if (p[n] != NULL)
-                        OPENSSL_free(p[n]);
+                    OPENSSL_free(p[n]);
             } else {
                 for (n = 0; n &lt; db-&gt;num_fields; n++) {
-                    if (((p[n] &lt; (char *)p) || (p[n] &gt; max))
-                        &amp;&amp; (p[n] != NULL))
+                    if (((p[n] &lt; (char *)p) || (p[n] &gt; max)))
                         OPENSSL_free(p[n]);
                 }
             }
diff --git a/crypto/ui/ui_lib.c b/crypto/ui/ui_lib.c
index d2732f5..26afbd2 100644
--- a/crypto/ui/ui_lib.c
+++ b/crypto/ui/ui_lib.c
@@ -335,14 +335,10 @@ int UI_dup_input_boolean(UI *ui, const char *prompt, const char *action_desc,
                                     ok_chars_copy, cancel_chars_copy, 1,
                                     UIT_BOOLEAN, flags, result_buf);
  err:
-    if (prompt_copy)
-        OPENSSL_free(prompt_copy);
-    if (action_desc_copy)
-        OPENSSL_free(action_desc_copy);
-    if (ok_chars_copy)
-        OPENSSL_free(ok_chars_copy);
-    if (cancel_chars_copy)
-        OPENSSL_free(cancel_chars_copy);
+    OPENSSL_free(prompt_copy);
+    OPENSSL_free(action_desc_copy);
+    OPENSSL_free(ok_chars_copy);
+    OPENSSL_free(cancel_chars_copy);
     return -1;
 }
 
diff --git a/crypto/x509/by_dir.c b/crypto/x509/by_dir.c
index b30fa30..31b3c3c 100644
--- a/crypto/x509/by_dir.c
+++ b/crypto/x509/by_dir.c
@@ -176,8 +176,7 @@ static int by_dir_hash_cmp(const BY_DIR_HASH *const *a,
 
 static void by_dir_entry_free(BY_DIR_ENTRY *ent)
 {
-    if (ent-&gt;dir)
-        OPENSSL_free(ent-&gt;dir);
+    OPENSSL_free(ent-&gt;dir);
     if (ent-&gt;hashes)
         sk_BY_DIR_HASH_pop_free(ent-&gt;hashes, by_dir_hash_free);
     OPENSSL_free(ent);
diff --git a/crypto/x509/x509_vpm.c b/crypto/x509/x509_vpm.c
index 57c2606..b0d9c4d 100644
--- a/crypto/x509/x509_vpm.c
+++ b/crypto/x509/x509_vpm.c
@@ -149,19 +149,13 @@ static void x509_verify_param_zero(X509_VERIFY_PARAM *param)
     paramid = param-&gt;id;
     string_stack_free(paramid-&gt;hosts);
     paramid-&gt;hosts = NULL;
-    if (paramid-&gt;peername)
-        OPENSSL_free(paramid-&gt;peername);
-    if (paramid-&gt;email) {
-        OPENSSL_free(paramid-&gt;email);
-        paramid-&gt;email = NULL;
-        paramid-&gt;emaillen = 0;
-    }
-    if (paramid-&gt;ip) {
-        OPENSSL_free(paramid-&gt;ip);
-        paramid-&gt;ip = NULL;
-        paramid-&gt;iplen = 0;
-    }
-
+    OPENSSL_free(paramid-&gt;peername);
+    OPENSSL_free(paramid-&gt;email);
+    paramid-&gt;email = NULL;
+    paramid-&gt;emaillen = 0;
+    OPENSSL_free(paramid-&gt;ip);
+    paramid-&gt;ip = NULL;
+    paramid-&gt;iplen = 0;
 }
 
 X509_VERIFY_PARAM *X509_VERIFY_PARAM_new(void)
@@ -346,8 +340,7 @@ static int int_x509_param_set1(char **pdest, size_t *pdestlen,
         tmp = NULL;
         srclen = 0;
     }
-    if (*pdest)
-        OPENSSL_free(*pdest);
+    OPENSSL_free(*pdest);
     *pdest = tmp;
     if (pdestlen)
         *pdestlen = srclen;
@@ -356,8 +349,7 @@ static int int_x509_param_set1(char **pdest, size_t *pdestlen,
 
 int X509_VERIFY_PARAM_set1_name(X509_VERIFY_PARAM *param, const char *name)
 {
-    if (param-&gt;name)
-        OPENSSL_free(param-&gt;name);
+    OPENSSL_free(param-&gt;name);
     param-&gt;name = BUF_strdup(name);
     if (param-&gt;name)
         return 1;
diff --git a/crypto/x509/x509spki.c b/crypto/x509/x509spki.c
index 347ab4c..fb46d4e 100644
--- a/crypto/x509/x509spki.c
+++ b/crypto/x509/x509spki.c
@@ -113,10 +113,8 @@ char *NETSCAPE_SPKI_b64_encode(NETSCAPE_SPKI *spki)
     b64_str = OPENSSL_malloc(der_len * 2);
     if (!der_spki || !b64_str) {
         X509err(X509_F_NETSCAPE_SPKI_B64_ENCODE, ERR_R_MALLOC_FAILURE);
-        if (der_spki != NULL)
-            OPENSSL_free(der_spki);
-        if (b64_str != NULL)
-            OPENSSL_free(b64_str);
+        OPENSSL_free(der_spki);
+        OPENSSL_free(b64_str);
         return NULL;
     }
     p = der_spki;
diff --git a/crypto/x509/x_name.c b/crypto/x509/x_name.c
index cdc4c97..cab7171 100644
--- a/crypto/x509/x_name.c
+++ b/crypto/x509/x_name.c
@@ -166,8 +166,7 @@ static void x509_name_ex_free(ASN1_VALUE **pval, const ASN1_ITEM *it)
 
     BUF_MEM_free(a-&gt;bytes);
     sk_X509_NAME_ENTRY_pop_free(a-&gt;entries, X509_NAME_ENTRY_free);
-    if (a-&gt;canon_enc)
-        OPENSSL_free(a-&gt;canon_enc);
+    OPENSSL_free(a-&gt;canon_enc);
     OPENSSL_free(a);
     *pval = NULL;
 }
@@ -343,10 +342,8 @@ static int x509_name_canon(X509_NAME *a)
     X509_NAME_ENTRY *entry, *tmpentry = NULL;
     int i, set = -1, ret = 0;
 
-    if (a-&gt;canon_enc) {
-        OPENSSL_free(a-&gt;canon_enc);
-        a-&gt;canon_enc = NULL;
-    }
+    OPENSSL_free(a-&gt;canon_enc);
+    a-&gt;canon_enc = NULL;
     /* Special case: empty X509_NAME =&gt; null encoding */
     if (sk_X509_NAME_ENTRY_num(a-&gt;entries) == 0) {
         a-&gt;canon_enclen = 0;
diff --git a/crypto/x509v3/v3_conf.c b/crypto/x509v3/v3_conf.c
index eb9cfea..0997d59 100644
--- a/crypto/x509v3/v3_conf.c
+++ b/crypto/x509v3/v3_conf.c
@@ -210,8 +210,7 @@ static X509_EXTENSION *do_ext_i2d(const X509V3_EXT_METHOD *method,
 
  merr:
     X509V3err(X509V3_F_DO_EXT_I2D, ERR_R_MALLOC_FAILURE);
-    if (ext_der != NULL)
-        OPENSSL_free(ext_der);
+    OPENSSL_free(ext_der);
     ASN1_OCTET_STRING_free(ext_oct);
     return NULL;
 
@@ -305,8 +304,7 @@ static X509_EXTENSION *v3_generic_extension(const char *ext, char *value,
  err:
     ASN1_OBJECT_free(obj);
     ASN1_OCTET_STRING_free(oct);
-    if (ext_der)
-        OPENSSL_free(ext_der);
+    OPENSSL_free(ext_der);
     return extension;
 
 }
diff --git a/crypto/x509v3/v3_prn.c b/crypto/x509v3/v3_prn.c
index 9d093a3..633daca 100644
--- a/crypto/x509v3/v3_prn.c
+++ b/crypto/x509v3/v3_prn.c
@@ -176,8 +176,7 @@ int X509V3_EXT_print(BIO *out, X509_EXTENSION *ext, unsigned long flag,
 
  err:
     sk_CONF_VALUE_pop_free(nval, X509V3_conf_free);
-    if (value)
-        OPENSSL_free(value);
+    OPENSSL_free(value);
     if (method-&gt;it)
         ASN1_item_free(ext_str, ASN1_ITEM_ptr(method-&gt;it));
     else
diff --git a/crypto/x509v3/v3_scts.c b/crypto/x509v3/v3_scts.c
index ecfc68d..2bbc056 100644
--- a/crypto/x509v3/v3_scts.c
+++ b/crypto/x509v3/v3_scts.c
@@ -163,8 +163,7 @@ static void SCT_free(SCT *sct)
 {
     if (!sct)
         return;
-    if (sct-&gt;sct)
-        OPENSSL_free(sct-&gt;sct);
+    OPENSSL_free(sct-&gt;sct);
     OPENSSL_free(sct);
 }
 
diff --git a/crypto/x509v3/v3_utl.c b/crypto/x509v3/v3_utl.c
index 5de60ce..7142208 100644
--- a/crypto/x509v3/v3_utl.c
+++ b/crypto/x509v3/v3_utl.c
@@ -100,12 +100,9 @@ int X509V3_add_value(const char *name, const char *value,
     return 1;
  err:
     X509V3err(X509V3_F_X509V3_ADD_VALUE, ERR_R_MALLOC_FAILURE);
-    if (vtmp)
-        OPENSSL_free(vtmp);
-    if (tname)
-        OPENSSL_free(tname);
-    if (tvalue)
-        OPENSSL_free(tvalue);
+    OPENSSL_free(vtmp);
+    OPENSSL_free(tname);
+    OPENSSL_free(tvalue);
     return 0;
 }
 
@@ -121,12 +118,9 @@ void X509V3_conf_free(CONF_VALUE *conf)
 {
     if (!conf)
         return;
-    if (conf-&gt;name)
-        OPENSSL_free(conf-&gt;name);
-    if (conf-&gt;value)
-        OPENSSL_free(conf-&gt;value);
-    if (conf-&gt;section)
-        OPENSSL_free(conf-&gt;section);
+    OPENSSL_free(conf-&gt;name);
+    OPENSSL_free(conf-&gt;value);
+    OPENSSL_free(conf-&gt;section);
     OPENSSL_free(conf);
 }
 
@@ -472,8 +466,7 @@ unsigned char *string_to_hex(const char *str, long *len)
     return hexbuf;
 
  err:
-    if (hexbuf)
-        OPENSSL_free(hexbuf);
+    OPENSSL_free(hexbuf);
     X509V3err(X509V3_F_STRING_TO_HEX, ERR_R_MALLOC_FAILURE);
     return NULL;
 
@@ -1108,8 +1101,7 @@ ASN1_OCTET_STRING *a2i_IPADDRESS_NC(const char *ipasc)
     return ret;
 
  err:
-    if (iptmp)
-        OPENSSL_free(iptmp);
+    OPENSSL_free(iptmp);
     ASN1_OCTET_STRING_free(ret);
     return NULL;
 }
diff --git a/demos/b64.c b/demos/b64.c
index 2fa4e98..c01107f 100644
--- a/demos/b64.c
+++ b/demos/b64.c
@@ -239,10 +239,8 @@ char **argv;
         BIO_printf(bio_err, &quot;bytes written:%8ld\n&quot;, BIO_number_written(out));
     }
  end:
-    if (strbuf != NULL)
-        OPENSSL_free(strbuf);
-    if (buff != NULL)
-        OPENSSL_free(buff);
+    OPENSSL_free(strbuf);
+    OPENSSL_free(buff);
     BIO_free(in);
     BIO_free(out);
     BIO_free(benc);
diff --git a/demos/engines/zencod/hw_zencod.c b/demos/engines/zencod/hw_zencod.c
index d675ace..0b72217 100644
--- a/demos/engines/zencod/hw_zencod.c
+++ b/demos/engines/zencod/hw_zencod.c
@@ -1548,12 +1548,9 @@ static int engine_md_cleanup(EVP_MD_CTX *ctx)
 
     ZEN_MD_DATA *zen_md_data = (ZEN_MD_DATA *)ctx-&gt;md_data;
 
-    if (zen_md_data-&gt;HashBuffer != NULL) {
-        OPENSSL_free(zen_md_data-&gt;HashBuffer);
-        zen_md_data-&gt;HashBufferSize = 0;
-        ctx-&gt;md_data = NULL;
-    }
-
+    OPENSSL_free(zen_md_data-&gt;HashBuffer);
+    zen_md_data-&gt;HashBufferSize = 0;
+    ctx-&gt;md_data = NULL;
     return 1;
 }
 
diff --git a/engines/ccgost/gost_ameth.c b/engines/ccgost/gost_ameth.c
index 0b694f5..b6c47f0 100644
--- a/engines/ccgost/gost_ameth.c
+++ b/engines/ccgost/gost_ameth.c
@@ -848,9 +848,7 @@ static int pkey_bits_gost(const EVP_PKEY *pk)
 /* ---------------------- ASN1 METHOD for GOST MAC  -------------------*/
 static void mackey_free_gost(EVP_PKEY *pk)
 {
-    if (pk-&gt;pkey.ptr) {
-        OPENSSL_free(pk-&gt;pkey.ptr);
-    }
+    OPENSSL_free(pk-&gt;pkey.ptr);
 }
 
 static int mac_ctrl_gost(EVP_PKEY *pkey, int op, long arg1, void *arg2)
diff --git a/engines/ccgost/gost_ctl.c b/engines/ccgost/gost_ctl.c
index 6c93c45..31b95a0 100644
--- a/engines/ccgost/gost_ctl.c
+++ b/engines/ccgost/gost_ctl.c
@@ -38,11 +38,11 @@ const ENGINE_CMD_DEFN gost_cmds[] = {
 void gost_param_free()
 {
     int i;
-    for (i = 0; i &lt;= GOST_PARAM_MAX; i++)
-        if (gost_params[i] != NULL) {
-            OPENSSL_free(gost_params[i]);
-            gost_params[i] = NULL;
-        }
+
+    for (i = 0; i &lt;= GOST_PARAM_MAX; i++) {
+        OPENSSL_free(gost_params[i]);
+        gost_params[i] = NULL;
+    }
 
 }
 
@@ -66,8 +66,7 @@ const char *get_gost_engine_param(int param)
     }
     tmp = getenv(gost_envnames[param]);
     if (tmp) {
-        if (gost_params[param])
-            OPENSSL_free(gost_params[param]);
+        OPENSSL_free(gost_params[param]);
         gost_params[param] = BUF_strdup(tmp);
         return gost_params[param];
     }
@@ -85,8 +84,7 @@ int gost_set_default_param(int param, const char *value)
      */
     if (!tmp)
         tmp = value;
-    if (gost_params[param])
-        OPENSSL_free(gost_params[param]);
+    OPENSSL_free(gost_params[param]);
     gost_params[param] = BUF_strdup(tmp);
 
     return 1;
diff --git a/engines/ccgost/gost_pmeth.c b/engines/ccgost/gost_pmeth.c
index 673b538..416f0f9 100644
--- a/engines/ccgost/gost_pmeth.c
+++ b/engines/ccgost/gost_pmeth.c
@@ -66,8 +66,8 @@ static int pkey_gost_copy(EVP_PKEY_CTX *dst, EVP_PKEY_CTX *src)
 static void pkey_gost_cleanup(EVP_PKEY_CTX *ctx)
 {
     struct gost_pmeth_data *data = EVP_PKEY_CTX_get_data(ctx);
-    if (data-&gt;shared_ukm)
-        OPENSSL_free(data-&gt;shared_ukm);
+
+    OPENSSL_free(data-&gt;shared_ukm);
     OPENSSL_free(data);
 }
 
diff --git a/engines/e_4758cca.c b/engines/e_4758cca.c
index b605a79..9c98129 100644
--- a/engines/e_4758cca.c
+++ b/engines/e_4758cca.c
@@ -474,8 +474,7 @@ static EVP_PKEY *ibm_4758_load_privkey(ENGINE *e, const char *key_id,
 
     return res;
  err:
-    if (keyToken)
-        OPENSSL_free(keyToken);
+    OPENSSL_free(keyToken);
     return NULL;
 }
 
@@ -544,8 +543,7 @@ static EVP_PKEY *ibm_4758_load_pubkey(ENGINE *e, const char *key_id,
 
     return res;
  err:
-    if (keyToken)
-        OPENSSL_free(keyToken);
+    OPENSSL_free(keyToken);
     return NULL;
 }
 
@@ -924,8 +922,7 @@ static int cca_get_random_bytes(unsigned char *buf, int num)
 static void cca_ex_free(void *obj, void *item, CRYPTO_EX_DATA *ad, int idx,
                         long argl, void *argp)
 {
-    if (item)
-        OPENSSL_free(item);
+    OPENSSL_free(item);
 }
 #  endif
 
diff --git a/engines/e_aep.c b/engines/e_aep.c
index 93a4be7..c86b34a 100644
--- a/engines/e_aep.c
+++ b/engines/e_aep.c
@@ -403,8 +403,7 @@ static const char *get_AEP_LIBNAME(void)
 
 static void free_AEP_LIBNAME(void)
 {
-    if (AEP_LIBNAME)
-        OPENSSL_free((void *)AEP_LIBNAME);
+    OPENSSL_free(AEP_LIBNAME);
     AEP_LIBNAME = NULL;
 }
 
diff --git a/engines/e_atalla.c b/engines/e_atalla.c
index 6a324e6..e9a6134 100644
--- a/engines/e_atalla.c
+++ b/engines/e_atalla.c
@@ -324,8 +324,7 @@ static const char *get_ATALLA_LIBNAME(void)
 
 static void free_ATALLA_LIBNAME(void)
 {
-    if (ATALLA_LIBNAME)
-        OPENSSL_free((void *)ATALLA_LIBNAME);
+    OPENSSL_free(ATALLA_LIBNAME);
     ATALLA_LIBNAME = NULL;
 }
 
diff --git a/engines/e_capi.c b/engines/e_capi.c
index 2373d69..89e6d1d 100644
--- a/engines/e_capi.c
+++ b/engines/e_capi.c
@@ -360,8 +360,7 @@ static int capi_ctrl(ENGINE *e, int cmd, long i, void *p, void (*f) (void))
         break;
 
     case CAPI_CMD_STORE_NAME:
-        if (ctx-&gt;storename)
-            OPENSSL_free(ctx-&gt;storename);
+        OPENSSL_free(ctx-&gt;storename);
         ctx-&gt;storename = BUF_strdup(p);
         CAPI_trace(ctx, &quot;Setting store name to %s\n&quot;, p);
         break;
@@ -751,8 +750,7 @@ static EVP_PKEY *capi_get_pkey(ENGINE *eng, CAPI_KEY * key)
     }
 
  err:
-    if (pubkey)
-        OPENSSL_free(pubkey);
+    OPENSSL_free(pubkey);
     if (!ret) {
         RSA_free(rkey);
         DSA_free(dkey);
@@ -1232,8 +1230,7 @@ static int capi_list_containers(CAPI_CTX * ctx, BIO *out)
     ret = 0;
 
  done:
-    if (cname)
-        OPENSSL_free(cname);
+    OPENSSL_free(cname);
     CryptReleaseContext(hprov, 0);
 
     return ret;
@@ -1282,10 +1279,8 @@ static void capi_dump_prov_info(CAPI_CTX * ctx, BIO *out,
     BIO_printf(out, &quot;    Container Name: %s, Key Type %d\n&quot;, contname,
                pinfo-&gt;dwKeySpec);
  err:
-    if (provname)
-        OPENSSL_free(provname);
-    if (contname)
-        OPENSSL_free(contname);
+    OPENSSL_free(provname);
+    OPENSSL_free(contname);
 }
 
 char *capi_cert_get_fname(CAPI_CTX * ctx, PCCERT_CONTEXT cert)
@@ -1346,8 +1341,7 @@ void capi_dump_cert(CAPI_CTX * ctx, BIO *out, PCCERT_CONTEXT cert)
         CRYPT_KEY_PROV_INFO *pinfo;
         pinfo = capi_get_prov_info(ctx, cert);
         capi_dump_prov_info(ctx, out, pinfo);
-        if (pinfo)
-            OPENSSL_free(pinfo);
+        OPENSSL_free(pinfo);
     }
 
     if (flags &amp; CAPI_DMP_PEM)
@@ -1462,10 +1456,8 @@ static CAPI_KEY *capi_get_key(CAPI_CTX * ctx, const TCHAR *contname,
 
         CAPI_trace(ctx, &quot;capi_get_key, contname=%s, provname=%s, type=%d\n&quot;,
                    _contname, _provname, ptype);
-        if (_provname)
-            OPENSSL_free(_provname);
-        if (_contname)
-            OPENSSL_free(_contname);
+        OPENSSL_free(_provname);
+        OPENSSL_free(_contname);
     }
     if (ctx-&gt;store_flags &amp; CERT_SYSTEM_STORE_LOCAL_MACHINE)
         dwFlags = CRYPT_MACHINE_KEYSET;
@@ -1511,12 +1503,9 @@ static CAPI_KEY *capi_get_cert_key(CAPI_CTX * ctx, PCCERT_CONTEXT cert)
     }
 
  err:
-    if (pinfo)
-        OPENSSL_free(pinfo);
-    if (provname)
-        OPENSSL_free(provname);
-    if (contname)
-        OPENSSL_free(contname);
+    OPENSSL_free(pinfo);
+    OPENSSL_free(provname);
+    OPENSSL_free(contname);
     return key;
 }
 
@@ -1610,14 +1599,10 @@ static void capi_ctx_free(CAPI_CTX * ctx)
     CAPI_trace(ctx, &quot;Calling capi_ctx_free with %lx\n&quot;, ctx);
     if (!ctx)
         return;
-    if (ctx-&gt;cspname)
-        OPENSSL_free(ctx-&gt;cspname);
-    if (ctx-&gt;debug_file)
-        OPENSSL_free(ctx-&gt;debug_file);
-    if (ctx-&gt;storename)
-        OPENSSL_free(ctx-&gt;storename);
-    if (ctx-&gt;ssl_client_store)
-        OPENSSL_free(ctx-&gt;ssl_client_store);
+    OPENSSL_free(ctx-&gt;cspname);
+    OPENSSL_free(ctx-&gt;debug_file);
+    OPENSSL_free(ctx-&gt;storename);
+    OPENSSL_free(ctx-&gt;ssl_client_store);
     OPENSSL_free(ctx);
 }
 
@@ -1647,8 +1632,7 @@ static int capi_ctx_set_provname(CAPI_CTX * ctx, LPSTR pname, DWORD type,
         }
         CryptReleaseContext(hprov, 0);
     }
-    if (ctx-&gt;cspname)
-        OPENSSL_free(ctx-&gt;cspname);
+    OPENSSL_free(ctx-&gt;cspname);
     ctx-&gt;cspname = BUF_strdup(pname);
     ctx-&gt;csptype = type;
     return 1;
diff --git a/engines/e_chil.c b/engines/e_chil.c
index 68c9145..3535214 100644
--- a/engines/e_chil.c
+++ b/engines/e_chil.c
@@ -462,8 +462,7 @@ static HWCryptoHook_ModExpCRT_t *p_hwcrhk_ModExpCRT = NULL;
 static const char *HWCRHK_LIBNAME = NULL;
 static void free_HWCRHK_LIBNAME(void)
 {
-    if (HWCRHK_LIBNAME)
-        OPENSSL_free((void *)HWCRHK_LIBNAME);
+    OPENSSL_free(HWCRHK_LIBNAME);
     HWCRHK_LIBNAME = NULL;
 }
 
diff --git a/engines/e_cswift.c b/engines/e_cswift.c
index 848d10f..0b4bfc5 100644
--- a/engines/e_cswift.c
+++ b/engines/e_cswift.c
@@ -338,8 +338,7 @@ static const char *get_CSWIFT_LIBNAME(void)
 
 static void free_CSWIFT_LIBNAME(void)
 {
-    if (CSWIFT_LIBNAME)
-        OPENSSL_free((void *)CSWIFT_LIBNAME);
+    OPENSSL_free(CSWIFT_LIBNAME);
     CSWIFT_LIBNAME = NULL;
 }
 
@@ -707,16 +706,11 @@ static int cswift_mod_exp_crt(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
     BN_bin2bn((unsigned char *)result-&gt;d, res.nbytes, r);
     to_return = 1;
  err:
-    if (sw_param.up.crt.p.value)
-        OPENSSL_free(sw_param.up.crt.p.value);
-    if (sw_param.up.crt.q.value)
-        OPENSSL_free(sw_param.up.crt.q.value);
-    if (sw_param.up.crt.dmp1.value)
-        OPENSSL_free(sw_param.up.crt.dmp1.value);
-    if (sw_param.up.crt.dmq1.value)
-        OPENSSL_free(sw_param.up.crt.dmq1.value);
-    if (sw_param.up.crt.iqmp.value)
-        OPENSSL_free(sw_param.up.crt.iqmp.value);
+    OPENSSL_free(sw_param.up.crt.p.value);
+    OPENSSL_free(sw_param.up.crt.q.value);
+    OPENSSL_free(sw_param.up.crt.dmp1.value);
+    OPENSSL_free(sw_param.up.crt.dmq1.value);
+    OPENSSL_free(sw_param.up.crt.iqmp.value);
     BN_free(result);
     BN_free(argument);
     if (acquired)
diff --git a/engines/e_nuron.c b/engines/e_nuron.c
index 3437f36..01229b0 100644
--- a/engines/e_nuron.c
+++ b/engines/e_nuron.c
@@ -90,8 +90,7 @@ static const char *get_NURON_LIBNAME(void)
 
 static void free_NURON_LIBNAME(void)
 {
-    if (NURON_LIBNAME)
-        OPENSSL_free((void *)NURON_LIBNAME);
+    OPENSSL_free(NURON_LIBNAME);
     NURON_LIBNAME = NULL;
 }
 
diff --git a/engines/e_ubsec.c b/engines/e_ubsec.c
index 9e2662e..c7eb892 100644
--- a/engines/e_ubsec.c
+++ b/engines/e_ubsec.c
@@ -339,8 +339,7 @@ static const char *get_UBSEC_LIBNAME(void)
 
 static void free_UBSEC_LIBNAME(void)
 {
-    if (UBSEC_LIBNAME)
-        OPENSSL_free((void *)UBSEC_LIBNAME);
+    OPENSSL_free(UBSEC_LIBNAME);
     UBSEC_LIBNAME = NULL;
 }
 
diff --git a/ssl/bio_ssl.c b/ssl/bio_ssl.c
index da98ea0..284d3ad 100644
--- a/ssl/bio_ssl.c
+++ b/ssl/bio_ssl.c
@@ -130,8 +130,7 @@ static int ssl_free(BIO *a)
         a-&gt;init = 0;
         a-&gt;flags = 0;
     }
-    if (a-&gt;ptr != NULL)
-        OPENSSL_free(a-&gt;ptr);
+    OPENSSL_free(a-&gt;ptr);
     return (1);
 }
 
diff --git a/ssl/d1_both.c b/ssl/d1_both.c
index 2a76474..7b7f876 100644
--- a/ssl/d1_both.c
+++ b/ssl/d1_both.c
@@ -189,8 +189,7 @@ static hm_fragment *dtls1_hm_fragment_new(unsigned long frag_len,
     if (reassembly) {
         bitmask = OPENSSL_malloc(RSMBLY_BITMASK_SIZE(frag_len));
         if (bitmask == NULL) {
-            if (buf != NULL)
-                OPENSSL_free(buf);
+            OPENSSL_free(buf);
             OPENSSL_free(frag);
             return NULL;
         }
@@ -211,10 +210,8 @@ void dtls1_hm_fragment_free(hm_fragment *frag)
         EVP_MD_CTX_destroy(frag-&gt;msg_header.
                            saved_retransmit_state.write_hash);
     }
-    if (frag-&gt;fragment)
-        OPENSSL_free(frag-&gt;fragment);
-    if (frag-&gt;reassembly)
-        OPENSSL_free(frag-&gt;reassembly);
+    OPENSSL_free(frag-&gt;fragment);
+    OPENSSL_free(frag-&gt;reassembly);
     OPENSSL_free(frag);
 }
 
diff --git a/ssl/record/rec_layer_d1.c b/ssl/record/rec_layer_d1.c
index 3183bcf..a78f150 100644
--- a/ssl/record/rec_layer_d1.c
+++ b/ssl/record/rec_layer_d1.c
@@ -177,27 +177,21 @@ void DTLS_RECORD_LAYER_clear(RECORD_LAYER *rl)
     
     while ((item = pqueue_pop(d-&gt;unprocessed_rcds.q)) != NULL) {
         rdata = (DTLS1_RECORD_DATA *)item-&gt;data;
-        if (rdata-&gt;rbuf.buf) {
-            OPENSSL_free(rdata-&gt;rbuf.buf);
-        }
+        OPENSSL_free(rdata-&gt;rbuf.buf);
         OPENSSL_free(item-&gt;data);
         pitem_free(item);
     }
 
     while ((item = pqueue_pop(d-&gt;processed_rcds.q)) != NULL) {
         rdata = (DTLS1_RECORD_DATA *)item-&gt;data;
-        if (rdata-&gt;rbuf.buf) {
-            OPENSSL_free(rdata-&gt;rbuf.buf);
-        }
+        OPENSSL_free(rdata-&gt;rbuf.buf);
         OPENSSL_free(item-&gt;data);
         pitem_free(item);
     }
 
     while ((item = pqueue_pop(d-&gt;buffered_app_data.q)) != NULL) {
         rdata = (DTLS1_RECORD_DATA *)item-&gt;data;
-        if (rdata-&gt;rbuf.buf) {
-            OPENSSL_free(rdata-&gt;rbuf.buf);
-        }
+        OPENSSL_free(rdata-&gt;rbuf.buf);
         OPENSSL_free(item-&gt;data);
         pitem_free(item);
     }
@@ -271,8 +265,7 @@ int dtls1_buffer_record(SSL *s, record_pqueue *queue, unsigned char *priority)
     rdata = OPENSSL_malloc(sizeof(DTLS1_RECORD_DATA));
     item = pitem_new(priority, rdata);
     if (rdata == NULL || item == NULL) {
-        if (rdata != NULL)
-            OPENSSL_free(rdata);
+        OPENSSL_free(rdata);
         if (item != NULL)
             pitem_free(item);
 
@@ -304,8 +297,7 @@ int dtls1_buffer_record(SSL *s, record_pqueue *queue, unsigned char *priority)
 
     if (!ssl3_setup_buffers(s)) {
         SSLerr(SSL_F_DTLS1_BUFFER_RECORD, ERR_R_INTERNAL_ERROR);
-        if (rdata-&gt;rbuf.buf != NULL)
-            OPENSSL_free(rdata-&gt;rbuf.buf);
+        OPENSSL_free(rdata-&gt;rbuf.buf);
         OPENSSL_free(rdata);
         pitem_free(item);
         return (-1);
@@ -314,8 +306,7 @@ int dtls1_buffer_record(SSL *s, record_pqueue *queue, unsigned char *priority)
     /* insert should not fail, since duplicates are dropped */
     if (pqueue_insert(queue-&gt;q, item) == NULL) {
         SSLerr(SSL_F_DTLS1_BUFFER_RECORD, ERR_R_INTERNAL_ERROR);
-        if (rdata-&gt;rbuf.buf != NULL)
-            OPENSSL_free(rdata-&gt;rbuf.buf);
+        OPENSSL_free(rdata-&gt;rbuf.buf);
         OPENSSL_free(rdata);
         pitem_free(item);
         return (-1);
diff --git a/ssl/record/ssl3_buffer.c b/ssl/record/ssl3_buffer.c
index 732420e..5a8d34c 100644
--- a/ssl/record/ssl3_buffer.c
+++ b/ssl/record/ssl3_buffer.c
@@ -122,8 +122,7 @@ void SSL3_BUFFER_set_data(SSL3_BUFFER *b, const unsigned char *d, int n)
 
 void SSL3_BUFFER_release(SSL3_BUFFER *b)
 {
-    if (b-&gt;buf != NULL)
-        OPENSSL_free(b-&gt;buf);
+    OPENSSL_free(b-&gt;buf);
     b-&gt;buf = NULL;
 }
 
@@ -224,10 +223,8 @@ int ssl3_release_write_buffer(SSL *s)
 
     wb = RECORD_LAYER_get_wbuf(&amp;s-&gt;rlayer);
 
-    if (wb-&gt;buf != NULL) {
-        OPENSSL_free(wb-&gt;buf);
-        wb-&gt;buf = NULL;
-    }
+    OPENSSL_free(wb-&gt;buf);
+    wb-&gt;buf = NULL;
     return 1;
 }
 
@@ -236,9 +233,7 @@ int ssl3_release_read_buffer(SSL *s)
     SSL3_BUFFER *b;
 
     b = RECORD_LAYER_get_rbuf(&amp;s-&gt;rlayer);
-    if (b-&gt;buf != NULL) {
-        OPENSSL_free(b-&gt;buf);
-        b-&gt;buf = NULL;
-    }
+    OPENSSL_free(b-&gt;buf);
+    b-&gt;buf = NULL;
     return 1;
 }
diff --git a/ssl/record/ssl3_record.c b/ssl/record/ssl3_record.c
index 33d0b30..1e6f88e 100644
--- a/ssl/record/ssl3_record.c
+++ b/ssl/record/ssl3_record.c
@@ -139,8 +139,7 @@ void SSL3_RECORD_clear(SSL3_RECORD *r)
 
 void SSL3_RECORD_release(SSL3_RECORD *r)
 {
-    if (r-&gt;comp != NULL)
-        OPENSSL_free(r-&gt;comp);
+    OPENSSL_free(r-&gt;comp);
     r-&gt;comp = NULL;
 }
 
diff --git a/ssl/s3_clnt.c b/ssl/s3_clnt.c
index 71756cd..52ddec1 100644
--- a/ssl/s3_clnt.c
+++ b/ssl/s3_clnt.c
@@ -1401,8 +1401,7 @@ int ssl3_get_key_exchange(SSL *s)
          */
         if (alg_k &amp; SSL_kPSK) {
             s-&gt;session-&gt;sess_cert = ssl_sess_cert_new();
-            if (s-&gt;ctx-&gt;psk_identity_hint)
-                OPENSSL_free(s-&gt;ctx-&gt;psk_identity_hint);
+            OPENSSL_free(s-&gt;ctx-&gt;psk_identity_hint);
             s-&gt;ctx-&gt;psk_identity_hint = NULL;
         }
 #endif
@@ -1471,8 +1470,7 @@ int ssl3_get_key_exchange(SSL *s)
          */
         memcpy(tmp_id_hint, p, i);
         memset(tmp_id_hint + i, 0, PSK_MAX_IDENTITY_LEN + 1 - i);
-        if (s-&gt;ctx-&gt;psk_identity_hint != NULL)
-            OPENSSL_free(s-&gt;ctx-&gt;psk_identity_hint);
+        OPENSSL_free(s-&gt;ctx-&gt;psk_identity_hint);
         s-&gt;ctx-&gt;psk_identity_hint = BUF_strdup(tmp_id_hint);
         if (s-&gt;ctx-&gt;psk_identity_hint == NULL) {
             al = SSL_AD_HANDSHAKE_FAILURE;
@@ -2054,10 +2052,8 @@ int ssl3_get_certificate_request(SSL *s)
 
     /* get the certificate types */
     ctype_num = *(p++);
-    if (s-&gt;cert-&gt;ctypes) {
-        OPENSSL_free(s-&gt;cert-&gt;ctypes);
-        s-&gt;cert-&gt;ctypes = NULL;
-    }
+    OPENSSL_free(s-&gt;cert-&gt;ctypes);
+    s-&gt;cert-&gt;ctypes = NULL;
     if (ctype_num &gt; SSL3_CT_NUMBER) {
         /* If we exceed static buffer copy all to cert structure */
         s-&gt;cert-&gt;ctypes = OPENSSL_malloc(ctype_num);
@@ -2193,10 +2189,8 @@ int ssl3_get_new_session_ticket(SSL *s)
         SSLerr(SSL_F_SSL3_GET_NEW_SESSION_TICKET, SSL_R_LENGTH_MISMATCH);
         goto f_err;
     }
-    if (s-&gt;session-&gt;tlsext_tick) {
-        OPENSSL_free(s-&gt;session-&gt;tlsext_tick);
-        s-&gt;session-&gt;tlsext_ticklen = 0;
-    }
+    OPENSSL_free(s-&gt;session-&gt;tlsext_tick);
+    s-&gt;session-&gt;tlsext_ticklen = 0;
     s-&gt;session-&gt;tlsext_tick = OPENSSL_malloc(ticklen);
     if (!s-&gt;session-&gt;tlsext_tick) {
         SSLerr(SSL_F_SSL3_GET_NEW_SESSION_TICKET, ERR_R_MALLOC_FAILURE);
@@ -2257,8 +2251,7 @@ int ssl3_get_cert_status(SSL *s)
         SSLerr(SSL_F_SSL3_GET_CERT_STATUS, SSL_R_LENGTH_MISMATCH);
         goto f_err;
     }
-    if (s-&gt;tlsext_ocsp_resp)
-        OPENSSL_free(s-&gt;tlsext_ocsp_resp);
+    OPENSSL_free(s-&gt;tlsext_ocsp_resp);
     s-&gt;tlsext_ocsp_resp = BUF_memdup(p, resplen);
     if (!s-&gt;tlsext_ocsp_resp) {
         al = SSL_AD_INTERNAL_ERROR;
@@ -2786,8 +2779,7 @@ int ssl3_send_client_key_exchange(SSL *s)
 
             /* Free allocated memory */
             BN_CTX_free(bn_ctx);
-            if (encodedPoint != NULL)
-                OPENSSL_free(encodedPoint);
+            OPENSSL_free(encodedPoint);
             EC_KEY_free(clnt_ecdh);
             EVP_PKEY_free(srvr_pub_pkey);
         }
@@ -2919,8 +2911,7 @@ int ssl3_send_client_key_exchange(SSL *s)
                        ERR_R_INTERNAL_ERROR);
                 goto err;
             }
-            if (s-&gt;session-&gt;srp_username != NULL)
-                OPENSSL_free(s-&gt;session-&gt;srp_username);
+            OPENSSL_free(s-&gt;session-&gt;srp_username);
             s-&gt;session-&gt;srp_username = BUF_strdup(s-&gt;srp_ctx.login);
             if (s-&gt;session-&gt;srp_username == NULL) {
                 SSLerr(SSL_F_SSL3_SEND_CLIENT_KEY_EXCHANGE,
@@ -2985,8 +2976,7 @@ int ssl3_send_client_key_exchange(SSL *s)
             t += psk_len;
             s2n(psk_len, t);
 
-            if (s-&gt;session-&gt;psk_identity_hint != NULL)
-                OPENSSL_free(s-&gt;session-&gt;psk_identity_hint);
+            OPENSSL_free(s-&gt;session-&gt;psk_identity_hint);
             s-&gt;session-&gt;psk_identity_hint =
                 BUF_strdup(s-&gt;ctx-&gt;psk_identity_hint);
             if (s-&gt;ctx-&gt;psk_identity_hint != NULL
@@ -2996,8 +2986,7 @@ int ssl3_send_client_key_exchange(SSL *s)
                 goto psk_err;
             }
 
-            if (s-&gt;session-&gt;psk_identity != NULL)
-                OPENSSL_free(s-&gt;session-&gt;psk_identity);
+            OPENSSL_free(s-&gt;session-&gt;psk_identity);
             s-&gt;session-&gt;psk_identity = BUF_strdup(identity);
             if (s-&gt;session-&gt;psk_identity == NULL) {
                 SSLerr(SSL_F_SSL3_SEND_CLIENT_KEY_EXCHANGE,
@@ -3090,8 +3079,7 @@ int ssl3_send_client_key_exchange(SSL *s)
     s-&gt;cert-&gt;pms = NULL;
 #ifndef OPENSSL_NO_EC
     BN_CTX_free(bn_ctx);
-    if (encodedPoint != NULL)
-        OPENSSL_free(encodedPoint);
+    OPENSSL_free(encodedPoint);
     EC_KEY_free(clnt_ecdh);
     EVP_PKEY_free(srvr_pub_pkey);
 #endif
diff --git a/ssl/s3_lib.c b/ssl/s3_lib.c
index 190d0f1..16a60c6 100644
--- a/ssl/s3_lib.c
+++ b/ssl/s3_lib.c
@@ -3187,11 +3187,9 @@ void ssl3_clear(SSL *s)
     s-&gt;version = SSL3_VERSION;
 
 #if !defined(OPENSSL_NO_TLSEXT) &amp;&amp; !defined(OPENSSL_NO_NEXTPROTONEG)
-    if (s-&gt;next_proto_negotiated) {
-        OPENSSL_free(s-&gt;next_proto_negotiated);
-        s-&gt;next_proto_negotiated = NULL;
-        s-&gt;next_proto_negotiated_len = 0;
-    }
+    OPENSSL_free(s-&gt;next_proto_negotiated);
+    s-&gt;next_proto_negotiated = NULL;
+    s-&gt;next_proto_negotiated_len = 0;
 #endif
 }
 
@@ -3331,8 +3329,7 @@ long ssl3_ctrl(SSL *s, int cmd, long larg, void *parg)
 #ifndef OPENSSL_NO_TLSEXT
     case SSL_CTRL_SET_TLSEXT_HOSTNAME:
         if (larg == TLSEXT_NAMETYPE_host_name) {
-            if (s-&gt;tlsext_hostname != NULL)
-                OPENSSL_free(s-&gt;tlsext_hostname);
+            OPENSSL_free(s-&gt;tlsext_hostname);
             s-&gt;tlsext_hostname = NULL;
 
             ret = 1;
@@ -3386,8 +3383,7 @@ long ssl3_ctrl(SSL *s, int cmd, long larg, void *parg)
         return s-&gt;tlsext_ocsp_resplen;
 
     case SSL_CTRL_SET_TLSEXT_STATUS_REQ_OCSP_RESP:
-        if (s-&gt;tlsext_ocsp_resp)
-            OPENSSL_free(s-&gt;tlsext_ocsp_resp);
+        OPENSSL_free(s-&gt;tlsext_ocsp_resp);
         s-&gt;tlsext_ocsp_resp = parg;
         s-&gt;tlsext_ocsp_resplen = larg;
         ret = 1;
@@ -3833,8 +3829,7 @@ long ssl3_ctx_ctrl(SSL_CTX *ctx, int cmd, long larg, void *parg)
 # ifndef OPENSSL_NO_SRP
     case SSL_CTRL_SET_TLS_EXT_SRP_USERNAME:
         ctx-&gt;srp_ctx.srp_Mask |= SSL_kSRP;
-        if (ctx-&gt;srp_ctx.login != NULL)
-            OPENSSL_free(ctx-&gt;srp_ctx.login);
+        OPENSSL_free(ctx-&gt;srp_ctx.login);
         ctx-&gt;srp_ctx.login = NULL;
         if (parg == NULL)
             break;
@@ -4281,10 +4276,8 @@ int ssl3_get_req_cert_type(SSL *s, unsigned char *p)
 
 static int ssl3_set_req_cert_type(CERT *c, const unsigned char *p, size_t len)
 {
-    if (c-&gt;ctypes) {
-        OPENSSL_free(c-&gt;ctypes);
-        c-&gt;ctypes = NULL;
-    }
+    OPENSSL_free(c-&gt;ctypes);
+    c-&gt;ctypes = NULL;
     if (!p || !len)
         return 1;
     if (len &gt; 0xff)
diff --git a/ssl/s3_srvr.c b/ssl/s3_srvr.c
index 77420a1..3e5c57a 100644
--- a/ssl/s3_srvr.c
+++ b/ssl/s3_srvr.c
@@ -2019,8 +2019,7 @@ int ssl3_send_server_key_exchange(SSL *s)
     ssl3_send_alert(s, SSL3_AL_FATAL, al);
  err:
 #ifndef OPENSSL_NO_EC
-    if (encodedPoint != NULL)
-        OPENSSL_free(encodedPoint);
+    OPENSSL_free(encodedPoint);
     BN_CTX_free(bn_ctx);
 #endif
     EVP_MD_CTX_cleanup(&amp;md_ctx);
@@ -2763,16 +2762,14 @@ int ssl3_get_client_key_exchange(SSL *s)
         t += psk_len;
         s2n(psk_len, t);
 
-        if (s-&gt;session-&gt;psk_identity != NULL)
-            OPENSSL_free(s-&gt;session-&gt;psk_identity);
+        OPENSSL_free(s-&gt;session-&gt;psk_identity);
         s-&gt;session-&gt;psk_identity = BUF_strdup((char *)p);
         if (s-&gt;session-&gt;psk_identity == NULL) {
             SSLerr(SSL_F_SSL3_GET_CLIENT_KEY_EXCHANGE, ERR_R_MALLOC_FAILURE);
             goto psk_err;
         }
 
-        if (s-&gt;session-&gt;psk_identity_hint != NULL)
-            OPENSSL_free(s-&gt;session-&gt;psk_identity_hint);
+        OPENSSL_free(s-&gt;session-&gt;psk_identity_hint);
         s-&gt;session-&gt;psk_identity_hint = BUF_strdup(s-&gt;ctx-&gt;psk_identity_hint);
         if (s-&gt;ctx-&gt;psk_identity_hint != NULL &amp;&amp;
             s-&gt;session-&gt;psk_identity_hint == NULL) {
@@ -2821,8 +2818,7 @@ int ssl3_get_client_key_exchange(SSL *s)
                    SSL_R_BAD_SRP_PARAMETERS);
             goto f_err;
         }
-        if (s-&gt;session-&gt;srp_username != NULL)
-            OPENSSL_free(s-&gt;session-&gt;srp_username);
+        OPENSSL_free(s-&gt;session-&gt;srp_username);
         s-&gt;session-&gt;srp_username = BUF_strdup(s-&gt;srp_ctx.login);
         if (s-&gt;session-&gt;srp_username == NULL) {
             SSLerr(SSL_F_SSL3_GET_CLIENT_KEY_EXCHANGE, ERR_R_MALLOC_FAILURE);
@@ -3473,8 +3469,7 @@ int ssl3_send_newsession_ticket(SSL *s)
     /* SSL3_ST_SW_SESSION_TICKET_B */
     return ssl_do_write(s);
  err:
-    if (senc)
-        OPENSSL_free(senc);
+    OPENSSL_free(senc);
     EVP_CIPHER_CTX_cleanup(&amp;ctx);
     HMAC_CTX_cleanup(&amp;hctx);
     return -1;
diff --git a/ssl/ssl_asn1.c b/ssl/ssl_asn1.c
index b6e7849..2a07a9b 100644
--- a/ssl/ssl_asn1.c
+++ b/ssl/ssl_asn1.c
@@ -285,10 +285,8 @@ int i2d_SSL_SESSION(SSL_SESSION *in, unsigned char **pp)
 
 static int ssl_session_strndup(char **pdst, ASN1_OCTET_STRING *src)
 {
-    if (*pdst) {
-        OPENSSL_free(*pdst);
-        *pdst = NULL;
-    }
+    OPENSSL_free(*pdst);
+    *pdst = NULL;
     if (src == NULL)
         return 1;
     *pdst = BUF_strndup((char *)src-&gt;data, src-&gt;length);
diff --git a/ssl/ssl_ciph.c b/ssl/ssl_ciph.c
index 14decbc..41af4f6 100644
--- a/ssl/ssl_ciph.c
+++ b/ssl/ssl_ciph.c
@@ -1560,7 +1560,7 @@ STACK_OF(SSL_CIPHER) *ssl_create_cipher_list(const SSL_METHOD *ssl_method, STACK
     if (ok &amp;&amp; (strlen(rule_p) &gt; 0))
         ok = ssl_cipher_process_rulestr(rule_p, &amp;head, &amp;tail, ca_list, c);
 
-    OPENSSL_free((void *)ca_list); /* Not needed anymore */
+    OPENSSL_free(ca_list); /* Not needed anymore */
 
     if (!ok) {                  /* Rule processing failure */
         OPENSSL_free(co_list);
diff --git a/ssl/ssl_conf.c b/ssl/ssl_conf.c
index 97b4fb9..5a19a75 100644
--- a/ssl/ssl_conf.c
+++ b/ssl/ssl_conf.c
@@ -380,8 +380,7 @@ static int cmd_Certificate(SSL_CONF_CTX *cctx, const char *value)
     }
     if (rv &gt; 0 &amp;&amp; c &amp;&amp; cctx-&gt;flags &amp; SSL_CONF_FLAG_REQUIRE_PRIVATE) {
         char **pfilename = &amp;cctx-&gt;cert_filename[c-&gt;key - c-&gt;pkeys];
-        if (*pfilename)
-            OPENSSL_free(*pfilename);
+        OPENSSL_free(*pfilename);
         *pfilename = BUF_strdup(value);
         if (!*pfilename)
             rv = 0;
@@ -659,11 +658,9 @@ void SSL_CONF_CTX_free(SSL_CONF_CTX *cctx)
     if (cctx) {
         size_t i;
         for (i = 0; i &lt; SSL_PKEY_NUM; i++) {
-            if (cctx-&gt;cert_filename[i])
-                OPENSSL_free(cctx-&gt;cert_filename[i]);
+            OPENSSL_free(cctx-&gt;cert_filename[i]);
         }
-        if (cctx-&gt;prefix)
-            OPENSSL_free(cctx-&gt;prefix);
+        OPENSSL_free(cctx-&gt;prefix);
         OPENSSL_free(cctx);
     }
 }
@@ -688,8 +685,7 @@ int SSL_CONF_CTX_set1_prefix(SSL_CONF_CTX *cctx, const char *pre)
         if (tmp == NULL)
             return 0;
     }
-    if (cctx-&gt;prefix)
-        OPENSSL_free(cctx-&gt;prefix);
+    OPENSSL_free(cctx-&gt;prefix);
     cctx-&gt;prefix = tmp;
     if (tmp)
         cctx-&gt;prefixlen = strlen(tmp);
diff --git a/ssl/ssl_lib.c b/ssl/ssl_lib.c
index 7319cd8..5b56ac7 100644
--- a/ssl/ssl_lib.c
+++ b/ssl/ssl_lib.c
@@ -570,22 +570,17 @@ void SSL_free(SSL *s)
     /* Free up if allocated */
 
 #ifndef OPENSSL_NO_TLSEXT
-    if (s-&gt;tlsext_hostname)
-        OPENSSL_free(s-&gt;tlsext_hostname);
+    OPENSSL_free(s-&gt;tlsext_hostname);
     SSL_CTX_free(s-&gt;initial_ctx);
 # ifndef OPENSSL_NO_EC
-    if (s-&gt;tlsext_ecpointformatlist)
-        OPENSSL_free(s-&gt;tlsext_ecpointformatlist);
-    if (s-&gt;tlsext_ellipticcurvelist)
-        OPENSSL_free(s-&gt;tlsext_ellipticcurvelist);
+    OPENSSL_free(s-&gt;tlsext_ecpointformatlist);
+    OPENSSL_free(s-&gt;tlsext_ellipticcurvelist);
 # endif                         /* OPENSSL_NO_EC */
     sk_X509_EXTENSION_pop_free(s-&gt;tlsext_ocsp_exts, X509_EXTENSION_free);
     if (s-&gt;tlsext_ocsp_ids)
         sk_OCSP_RESPID_pop_free(s-&gt;tlsext_ocsp_ids, OCSP_RESPID_free);
-    if (s-&gt;tlsext_ocsp_resp)
-        OPENSSL_free(s-&gt;tlsext_ocsp_resp);
-    if (s-&gt;alpn_client_proto_list)
-        OPENSSL_free(s-&gt;alpn_client_proto_list);
+    OPENSSL_free(s-&gt;tlsext_ocsp_resp);
+    OPENSSL_free(s-&gt;alpn_client_proto_list);
 #endif
 
     sk_X509_NAME_pop_free(s-&gt;client_CA, X509_NAME_free);
@@ -603,8 +598,7 @@ void SSL_free(SSL *s)
 #endif                          /* OPENSSL_NO_KRB5 */
 
 #if !defined(OPENSSL_NO_TLSEXT) &amp;&amp; !defined(OPENSSL_NO_NEXTPROTONEG)
-    if (s-&gt;next_proto_negotiated)
-        OPENSSL_free(s-&gt;next_proto_negotiated);
+    OPENSSL_free(s-&gt;next_proto_negotiated);
 #endif
 
 #ifndef OPENSSL_NO_SRTP
diff --git a/ssl/ssl_sess.c b/ssl/ssl_sess.c
index 34b6fac..a376875 100644
--- a/ssl/ssl_sess.c
+++ b/ssl/ssl_sess.c
@@ -931,11 +931,8 @@ int SSL_set_session_ticket_ext_cb(SSL *s, tls_session_ticket_ext_cb_fn cb,
 int SSL_set_session_ticket_ext(SSL *s, void *ext_data, int ext_len)
 {
     if (s-&gt;version &gt;= TLS1_VERSION) {
-        if (s-&gt;tlsext_session_ticket) {
-            OPENSSL_free(s-&gt;tlsext_session_ticket);
-            s-&gt;tlsext_session_ticket = NULL;
-        }
-
+        OPENSSL_free(s-&gt;tlsext_session_ticket);
+        s-&gt;tlsext_session_ticket = NULL;
         s-&gt;tlsext_session_ticket =
             OPENSSL_malloc(sizeof(TLS_SESSION_TICKET_EXT) + ext_len);
         if (!s-&gt;tlsext_session_ticket) {
diff --git a/ssl/t1_enc.c b/ssl/t1_enc.c
index edb6558..e87d4b3 100644
--- a/ssl/t1_enc.c
+++ b/ssl/t1_enc.c
@@ -953,10 +953,8 @@ int tls1_export_keying_material(SSL *s, unsigned char *out, size_t olen,
     SSLerr(SSL_F_TLS1_EXPORT_KEYING_MATERIAL, ERR_R_MALLOC_FAILURE);
     rv = 0;
  ret:
-    if (buff != NULL)
-        OPENSSL_free(buff);
-    if (val != NULL)
-        OPENSSL_free(val);
+    OPENSSL_free(buff);
+    OPENSSL_free(val);
     return (rv);
 }
 
diff --git a/ssl/t1_ext.c b/ssl/t1_ext.c
index ce54f4f..193cae8 100644
--- a/ssl/t1_ext.c
+++ b/ssl/t1_ext.c
@@ -195,8 +195,7 @@ int custom_exts_copy(custom_ext_methods *dst, const custom_ext_methods *src)
 
 void custom_exts_free(custom_ext_methods *exts)
 {
-    if (exts-&gt;meths)
-        OPENSSL_free(exts-&gt;meths);
+    OPENSSL_free(exts-&gt;meths);
 }
 
 /* Set callbacks for a custom extension. */
diff --git a/ssl/t1_lib.c b/ssl/t1_lib.c
index b77074a..31ebfdd 100644
--- a/ssl/t1_lib.c
+++ b/ssl/t1_lib.c
@@ -209,9 +209,7 @@ int tls1_new(SSL *s)
 void tls1_free(SSL *s)
 {
 #ifndef OPENSSL_NO_TLSEXT
-    if (s-&gt;tlsext_session_ticket) {
-        OPENSSL_free(s-&gt;tlsext_session_ticket);
-    }
+    OPENSSL_free(s-&gt;tlsext_session_ticket);
 #endif                          /* OPENSSL_NO_TLSEXT */
     ssl3_free(s);
 }
@@ -576,8 +574,7 @@ int tls1_set_curves(unsigned char **pext, size_t *pextlen,
         dup_list |= idmask;
         s2n(id, p);
     }
-    if (*pext)
-        OPENSSL_free(*pext);
+    OPENSSL_free(*pext);
     *pext = clist;
     *pextlen = ncurves * 2;
     return 1;
@@ -1779,8 +1776,7 @@ static int tls1_alpn_handle_client_hello(SSL *s, const unsigned char *data,
     r = s-&gt;ctx-&gt;alpn_select_cb(s, &amp;selected, &amp;selected_len, data, data_len,
                                s-&gt;ctx-&gt;alpn_select_cb_arg);
     if (r == SSL_TLSEXT_ERR_OK) {
-        if (s-&gt;s3-&gt;alpn_selected)
-            OPENSSL_free(s-&gt;s3-&gt;alpn_selected);
+        OPENSSL_free(s-&gt;s3-&gt;alpn_selected);
         s-&gt;s3-&gt;alpn_selected = OPENSSL_malloc(selected_len);
         if (!s-&gt;s3-&gt;alpn_selected) {
             *al = SSL_AD_INTERNAL_ERROR;
@@ -1894,10 +1890,8 @@ static int ssl_scan_clienthello_tlsext(SSL *s, unsigned char **p,
     s-&gt;s3-&gt;next_proto_neg_seen = 0;
 # endif
 
-    if (s-&gt;s3-&gt;alpn_selected) {
-        OPENSSL_free(s-&gt;s3-&gt;alpn_selected);
-        s-&gt;s3-&gt;alpn_selected = NULL;
-    }
+    OPENSSL_free(s-&gt;s3-&gt;alpn_selected);
+    s-&gt;s3-&gt;alpn_selected = NULL;
 # ifndef OPENSSL_NO_HEARTBEATS
     s-&gt;tlsext_heartbeat &amp;= ~(SSL_TLSEXT_HB_ENABLED |
                              SSL_TLSEXT_HB_DONT_SEND_REQUESTS);
@@ -1909,19 +1903,15 @@ static int ssl_scan_clienthello_tlsext(SSL *s, unsigned char **p,
 # endif                         /* !OPENSSL_NO_EC */
 
     /* Clear any signature algorithms extension received */
-    if (s-&gt;cert-&gt;peer_sigalgs) {
-        OPENSSL_free(s-&gt;cert-&gt;peer_sigalgs);
-        s-&gt;cert-&gt;peer_sigalgs = NULL;
-    }
+    OPENSSL_free(s-&gt;cert-&gt;peer_sigalgs);
+    s-&gt;cert-&gt;peer_sigalgs = NULL;
 # ifdef TLSEXT_TYPE_encrypt_then_mac
     s-&gt;s3-&gt;flags &amp;= ~TLS1_FLAGS_ENCRYPT_THEN_MAC;
 # endif
 
 # ifndef OPENSSL_NO_SRP
-    if (s-&gt;srp_ctx.login != NULL) {
-        OPENSSL_free(s-&gt;srp_ctx.login);
-        s-&gt;srp_ctx.login = NULL;
-    }
+    OPENSSL_free(s-&gt;srp_ctx.login);
+    s-&gt;srp_ctx.login = NULL;
 # endif
 
     s-&gt;srtp_profile = NULL;
@@ -2078,10 +2068,8 @@ static int ssl_scan_clienthello_tlsext(SSL *s, unsigned char **p,
                 return 0;
             }
             if (!s-&gt;hit) {
-                if (s-&gt;session-&gt;tlsext_ecpointformatlist) {
-                    OPENSSL_free(s-&gt;session-&gt;tlsext_ecpointformatlist);
-                    s-&gt;session-&gt;tlsext_ecpointformatlist = NULL;
-                }
+                OPENSSL_free(s-&gt;session-&gt;tlsext_ecpointformatlist);
+                s-&gt;session-&gt;tlsext_ecpointformatlist = NULL;
                 s-&gt;session-&gt;tlsext_ecpointformatlist_length = 0;
                 if ((s-&gt;session-&gt;tlsext_ecpointformatlist =
                      OPENSSL_malloc(ecpointformatlist_length)) == NULL) {
@@ -2387,10 +2375,8 @@ static int ssl_scan_serverhello_tlsext(SSL *s, unsigned char **p,
 # endif
     s-&gt;tlsext_ticket_expected = 0;
 
-    if (s-&gt;s3-&gt;alpn_selected) {
-        OPENSSL_free(s-&gt;s3-&gt;alpn_selected);
-        s-&gt;s3-&gt;alpn_selected = NULL;
-    }
+    OPENSSL_free(s-&gt;s3-&gt;alpn_selected);
+    s-&gt;s3-&gt;alpn_selected = NULL;
 # ifndef OPENSSL_NO_HEARTBEATS
     s-&gt;tlsext_heartbeat &amp;= ~(SSL_TLSEXT_HB_ENABLED |
                              SSL_TLSEXT_HB_DONT_SEND_REQUESTS);
@@ -2442,8 +2428,7 @@ static int ssl_scan_serverhello_tlsext(SSL *s, unsigned char **p,
             }
             if (!s-&gt;hit) {
                 s-&gt;session-&gt;tlsext_ecpointformatlist_length = 0;
-                if (s-&gt;session-&gt;tlsext_ecpointformatlist != NULL)
-                    OPENSSL_free(s-&gt;session-&gt;tlsext_ecpointformatlist);
+                OPENSSL_free(s-&gt;session-&gt;tlsext_ecpointformatlist);
                 if ((s-&gt;session-&gt;tlsext_ecpointformatlist =
                      OPENSSL_malloc(ecpointformatlist_length)) == NULL) {
                     *al = TLS1_AD_INTERNAL_ERROR;
@@ -2548,8 +2533,7 @@ static int ssl_scan_serverhello_tlsext(SSL *s, unsigned char **p,
                 *al = TLS1_AD_DECODE_ERROR;
                 return 0;
             }
-            if (s-&gt;s3-&gt;alpn_selected)
-                OPENSSL_free(s-&gt;s3-&gt;alpn_selected);
+            OPENSSL_free(s-&gt;s3-&gt;alpn_selected);
             s-&gt;s3-&gt;alpn_selected = OPENSSL_malloc(len);
             if (!s-&gt;s3-&gt;alpn_selected) {
                 *al = TLS1_AD_INTERNAL_ERROR;
@@ -2704,11 +2688,9 @@ int tls1_set_server_sigalgs(SSL *s)
     int al;
     size_t i;
     /* Clear any shared sigtnature algorithms */
-    if (s-&gt;cert-&gt;shared_sigalgs) {
-        OPENSSL_free(s-&gt;cert-&gt;shared_sigalgs);
-        s-&gt;cert-&gt;shared_sigalgs = NULL;
-        s-&gt;cert-&gt;shared_sigalgslen = 0;
-    }
+    OPENSSL_free(s-&gt;cert-&gt;shared_sigalgs);
+    s-&gt;cert-&gt;shared_sigalgs = NULL;
+    s-&gt;cert-&gt;shared_sigalgslen = 0;
     /* Clear certificate digests and validity flags */
     for (i = 0; i &lt; SSL_PKEY_NUM; i++) {
         s-&gt;cert-&gt;pkeys[i].digest = NULL;
@@ -2860,10 +2842,8 @@ int ssl_check_serverhello_tlsext(SSL *s)
          * Set resp to NULL, resplen to -1 so callback knows there is no
          * response.
          */
-        if (s-&gt;tlsext_ocsp_resp) {
-            OPENSSL_free(s-&gt;tlsext_ocsp_resp);
-            s-&gt;tlsext_ocsp_resp = NULL;
-        }
+        OPENSSL_free(s-&gt;tlsext_ocsp_resp);
+        s-&gt;tlsext_ocsp_resp = NULL;
         s-&gt;tlsext_ocsp_resplen = -1;
         r = s-&gt;ctx-&gt;tlsext_status_cb(s, s-&gt;ctx-&gt;tlsext_status_arg);
         if (r == 0) {
@@ -3408,11 +3388,10 @@ static int tls1_set_shared_sigalgs(SSL *s)
     TLS_SIGALGS *salgs = NULL;
     CERT *c = s-&gt;cert;
     unsigned int is_suiteb = tls1_suiteb(s);
-    if (c-&gt;shared_sigalgs) {
-        OPENSSL_free(c-&gt;shared_sigalgs);
-        c-&gt;shared_sigalgs = NULL;
-        c-&gt;shared_sigalgslen = 0;
-    }
+
+    OPENSSL_free(c-&gt;shared_sigalgs);
+    c-&gt;shared_sigalgs = NULL;
+    c-&gt;shared_sigalgslen = 0;
     /* If client use client signature algorithms if not NULL */
     if (!s-&gt;server &amp;&amp; c-&gt;client_sigalgs &amp;&amp; !is_suiteb) {
         conf = c-&gt;client_sigalgs;
@@ -3459,8 +3438,7 @@ int tls1_save_sigalgs(SSL *s, const unsigned char *data, int dsize)
     if (!c)
         return 0;
 
-    if (c-&gt;peer_sigalgs)
-        OPENSSL_free(c-&gt;peer_sigalgs);
+    OPENSSL_free(c-&gt;peer_sigalgs);
     c-&gt;peer_sigalgs = OPENSSL_malloc(dsize);
     if (!c-&gt;peer_sigalgs)
         return 0;
@@ -3840,13 +3818,11 @@ int tls1_set_sigalgs(CERT *c, const int *psig_nids, size_t salglen,
     }
 
     if (client) {
-        if (c-&gt;client_sigalgs)
-            OPENSSL_free(c-&gt;client_sigalgs);
+        OPENSSL_free(c-&gt;client_sigalgs);
         c-&gt;client_sigalgs = sigalgs;
         c-&gt;client_sigalgslen = salglen;
     } else {
-        if (c-&gt;conf_sigalgs)
-            OPENSSL_free(c-&gt;conf_sigalgs);
+        OPENSSL_free(c-&gt;conf_sigalgs);
         c-&gt;conf_sigalgs = sigalgs;
         c-&gt;conf_sigalgslen = salglen;
     }
diff --git a/test/dhtest.c b/test/dhtest.c
index 8f71723..621fcba 100644
--- a/test/dhtest.c
+++ b/test/dhtest.c
@@ -195,10 +195,8 @@ int main(int argc, char *argv[])
  err:
     ERR_print_errors_fp(stderr);
 
-    if (abuf != NULL)
-        OPENSSL_free(abuf);
-    if (bbuf != NULL)
-        OPENSSL_free(bbuf);
+    OPENSSL_free(abuf);
+    OPENSSL_free(bbuf);
     DH_free(b);
     DH_free(a);
     BN_GENCB_free(_cb);
diff --git a/test/ecdhtest.c b/test/ecdhtest.c
index af12476..47c8185 100644
--- a/test/ecdhtest.c
+++ b/test/ecdhtest.c
@@ -278,10 +278,8 @@ static int test_ecdh_curve(int nid, const char *text, BN_CTX *ctx, BIO *out)
  err:
     ERR_print_errors_fp(stderr);
 
-    if (abuf != NULL)
-        OPENSSL_free(abuf);
-    if (bbuf != NULL)
-        OPENSSL_free(bbuf);
+    OPENSSL_free(abuf);
+    OPENSSL_free(bbuf);
     BN_free(x_a);
     BN_free(y_a);
     BN_free(x_b);
@@ -433,8 +431,7 @@ static int ecdh_kat(BIO *out, const char *cname, int nid,
  err:
     EC_KEY_free(key1);
     EC_KEY_free(key2);
-    if (Ztmp)
-        OPENSSL_free(Ztmp);
+    OPENSSL_free(Ztmp);
     if (rv)
         BIO_puts(out, &quot; ok\n&quot;);
     else {
diff --git a/test/ecdsatest.c b/test/ecdsatest.c
index 1eeaaba..52326c5 100644
--- a/test/ecdsatest.c
+++ b/test/ecdsatest.c
@@ -504,12 +504,9 @@ int test_builtin(BIO *out)
     EC_KEY_free(wrong_eckey);
     if (ecdsa_sig)
         ECDSA_SIG_free(ecdsa_sig);
-    if (signature)
-        OPENSSL_free(signature);
-    if (raw_buf)
-        OPENSSL_free(raw_buf);
-    if (curves)
-        OPENSSL_free(curves);
+    OPENSSL_free(signature);
+    OPENSSL_free(raw_buf);
+    OPENSSL_free(curves);
 
     return ret;
 }
diff --git a/test/evp_extra_test.c b/test/evp_extra_test.c
index 5641d98..ac79388 100644
--- a/test/evp_extra_test.c
+++ b/test/evp_extra_test.c
@@ -320,9 +320,7 @@ static int test_EVP_DigestSignInit(void)
     EVP_MD_CTX_cleanup(&amp;md_ctx);
     EVP_MD_CTX_cleanup(&amp;md_ctx_verify);
     EVP_PKEY_free(pkey);
-    if (sig) {
-        OPENSSL_free(sig);
-    }
+    OPENSSL_free(sig);
 
     return ret;
 }
diff --git a/test/evp_test.c b/test/evp_test.c
index 68d5bde..7187624 100644
--- a/test/evp_test.c
+++ b/test/evp_test.c
@@ -249,10 +249,8 @@ static void hex_print(const char *name, const unsigned char *buf, size_t len)
 
 static void free_expected(struct evp_test *t)
 {
-    if (t-&gt;expected_err) {
-        OPENSSL_free(t-&gt;expected_err);
-        t-&gt;expected_err = NULL;
-    }
+    OPENSSL_free(t-&gt;expected_err);
+    t-&gt;expected_err = NULL;
     if (t-&gt;out_expected) {
         OPENSSL_free(t-&gt;out_expected);
         OPENSSL_free(t-&gt;out_got);
@@ -320,10 +318,8 @@ static int setup_test(struct evp_test *t, const struct evp_test_method *tmeth)
         t-&gt;meth-&gt;cleanup(t);
         OPENSSL_free(t-&gt;data);
         t-&gt;data = NULL;
-        if (t-&gt;expected_err) {
-            OPENSSL_free(t-&gt;expected_err);
-            t-&gt;expected_err = NULL;
-        }
+        OPENSSL_free(t-&gt;expected_err);
+        t-&gt;expected_err = NULL;
         free_expected(t);
     }
     t-&gt;meth = tmeth;
@@ -534,8 +530,7 @@ int main(int argc, char **argv)
 
 static void test_free(void *d)
 {
-    if (d)
-        OPENSSL_free(d);
+    OPENSSL_free(d);
 }
 
 /* Message digest tests */
@@ -861,8 +856,7 @@ static int cipher_test_enc(struct evp_test *t, int enc)
     }
     err = NULL;
  err:
-    if (tmp)
-        OPENSSL_free(tmp);
+    OPENSSL_free(tmp);
     EVP_CIPHER_CTX_free(ctx);
     t-&gt;err = err;
     return err ? 0 : 1;
@@ -1049,8 +1043,7 @@ static int mac_test_run(struct evp_test *t)
  err:
     if (mctx)
         EVP_MD_CTX_destroy(mctx);
-    if (mac)
-        OPENSSL_free(mac);
+    OPENSSL_free(mac);
     EVP_PKEY_CTX_free(genctx);
     EVP_PKEY_free(key);
     t-&gt;err = err;
@@ -1133,10 +1126,9 @@ static int pkey_test_init(struct evp_test *t, const char *name,
 static void pkey_test_cleanup(struct evp_test *t)
 {
     struct pkey_data *kdata = t-&gt;data;
-    if (kdata-&gt;input)
-        OPENSSL_free(kdata-&gt;input);
-    if (kdata-&gt;output)
-        OPENSSL_free(kdata-&gt;output);
+
+    OPENSSL_free(kdata-&gt;input);
+    OPENSSL_free(kdata-&gt;output);
     EVP_PKEY_CTX_free(kdata-&gt;ctx);
 }
 
@@ -1185,8 +1177,7 @@ static int pkey_test_run(struct evp_test *t)
         goto err;
     err = NULL;
  err:
-    if (out)
-        OPENSSL_free(out);
+    OPENSSL_free(out);
     t-&gt;err = err;
     return 1;
 }
diff --git a/test/ssltest.c b/test/ssltest.c
index 311fbc9..8b5ff3e 100644
--- a/test/ssltest.c
+++ b/test/ssltest.c
@@ -466,10 +466,8 @@ static int verify_alpn(SSL *client, SSL *server)
     SSL_get0_alpn_selected(client, &amp;client_proto, &amp;client_proto_len);
     SSL_get0_alpn_selected(server, &amp;server_proto, &amp;server_proto_len);
 
-    if (alpn_selected != NULL) {
-        OPENSSL_free(alpn_selected);
-        alpn_selected = NULL;
-    }
+    OPENSSL_free(alpn_selected);
+    alpn_selected = NULL;
 
     if (client_proto_len != server_proto_len ||
         memcmp(client_proto, server_proto, client_proto_len) != 0) {
@@ -2457,11 +2455,8 @@ int doit(SSL *s_ssl, SSL *c_ssl, long count)
     BIO_free(s_to_c);
     BIO_free_all(c_bio);
     BIO_free_all(s_bio);
-
-    if (cbuf)
-        OPENSSL_free(cbuf);
-    if (sbuf)
-        OPENSSL_free(sbuf);
+    OPENSSL_free(cbuf);
+    OPENSSL_free(sbuf);
 
     return (ret);
 }
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000996.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="000998.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#997">[ date ]</a>
              <a href="thread.html#997">[ thread ]</a>
              <a href="subject.html#997">[ subject ]</a>
              <a href="author.html#997">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
