<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2015-May/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1432314746.765138.20466.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001138.html">
   <LINK REL="Next"  HREF="001140.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Richard Levitte</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1432314746.765138.20466.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">levitte at openssl.org
       </A><BR>
    <I>Fri May 22 17:12:26 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001138.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="001140.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1139">[ date ]</a>
              <a href="thread.html#1139">[ thread ]</a>
              <a href="subject.html#1139">[ subject ]</a>
              <a href="author.html#1139">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  0f539dc1a2f45580435c39dada44dd276e79cb88 (commit)
      from  8757bf83775afe10cb18d15943248a75bcc6a24b (commit)


- Log -----------------------------------------------------------------
commit 0f539dc1a2f45580435c39dada44dd276e79cb88
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Fri May 22 17:54:06 2015 +0200

    Fix the update target and remove duplicate file updates
    
    We had updates of certain header files in both Makefile.org and the
    Makefile in the directory the header file lived in.  This is error
    prone and also sometimes generates slightly different results (usually
    just a comment that differs) depending on which way the update was
    done.
    
    This removes the file update targets from the top level Makefile, adds
    an update: target in all Makefiles and has it depend on the depend: or
    local_depend: targets, whichever is appropriate, so we don't get a
    double run through the whole file tree.
    
    Reviewed-by: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;

-----------------------------------------------------------------------

Summary of changes:
 Makefile.org             | 19 +++----------------
 apps/Makefile            |  5 +++++
 crypto/Makefile          | 11 ++++++++---
 crypto/aes/Makefile      |  2 ++
 crypto/asn1/Makefile     |  2 ++
 crypto/bf/Makefile       |  2 ++
 crypto/bio/Makefile      |  2 ++
 crypto/bn/Makefile       |  2 ++
 crypto/buffer/Makefile   |  2 ++
 crypto/camellia/Makefile |  2 ++
 crypto/cast/Makefile     |  2 ++
 crypto/cmac/Makefile     |  2 ++
 crypto/cms/Makefile      |  2 ++
 crypto/comp/Makefile     |  2 ++
 crypto/conf/Makefile     |  2 ++
 crypto/des/Makefile      |  2 ++
 crypto/dh/Makefile       |  2 ++
 crypto/dsa/Makefile      |  2 ++
 crypto/dso/Makefile      |  2 ++
 crypto/ec/Makefile       |  2 ++
 crypto/ecdh/Makefile     |  2 ++
 crypto/ecdsa/Makefile    |  2 ++
 crypto/engine/Makefile   |  2 ++
 crypto/err/Makefile      |  2 ++
 crypto/evp/Makefile      |  2 ++
 crypto/hmac/Makefile     |  2 ++
 crypto/idea/Makefile     |  2 ++
 crypto/jpake/Makefile    |  2 ++
 crypto/lhash/Makefile    |  2 ++
 crypto/md2/Makefile      |  2 ++
 crypto/md4/Makefile      |  2 ++
 crypto/md5/Makefile      |  2 ++
 crypto/mdc2/Makefile     |  2 ++
 crypto/modes/Makefile    |  2 ++
 crypto/objects/Makefile  |  2 ++
 crypto/ocsp/Makefile     |  2 ++
 crypto/pem/Makefile      |  2 ++
 crypto/pkcs12/Makefile   |  2 ++
 crypto/pkcs7/Makefile    |  2 ++
 crypto/pqueue/Makefile   |  2 ++
 crypto/rand/Makefile     |  2 ++
 crypto/rc2/Makefile      |  2 ++
 crypto/rc4/Makefile      |  2 ++
 crypto/rc5/Makefile      |  2 ++
 crypto/ripemd/Makefile   |  2 ++
 crypto/rsa/Makefile      |  2 ++
 crypto/seed/Makefile     |  2 ++
 crypto/sha/Makefile      |  2 ++
 crypto/srp/Makefile      |  2 ++
 crypto/stack/Makefile    |  2 ++
 crypto/store/Makefile    |  2 ++
 crypto/ts/Makefile       |  2 ++
 crypto/txt_db/Makefile   |  2 ++
 crypto/ui/Makefile       |  2 ++
 crypto/whrlpool/Makefile |  2 ++
 crypto/x509/Makefile     |  2 ++
 crypto/x509v3/Makefile   |  2 ++
 engines/Makefile         | 12 +++++++-----
 engines/ccgost/Makefile  | 13 +++++++------
 ssl/Makefile             | 13 +++++++------
 test/Makefile            | 13 +++++++------
 tools/Makefile           |  2 ++
 62 files changed, 154 insertions(+), 42 deletions(-)

diff --git a/Makefile.org b/Makefile.org
index 69baf48..ea9f6a0 100644
--- a/Makefile.org
+++ b/Makefile.org
@@ -439,6 +439,9 @@ tests: rehash
 report:
 	@$(PERL) util/selftest.pl
 
+update: errors stacks util/libeay.num util/ssleay.num apps/openssl-vms.cnf TABLE
+	@set -e; target=update; $(RECURSIVE_BUILD_CMD)
+
 depend:
 	@set -e; target=depend; $(RECURSIVE_BUILD_CMD)
 
@@ -466,26 +469,10 @@ util/libeay.num::
 util/ssleay.num::
 	$(PERL) util/mkdef.pl ssl update
 
-crypto/objects/obj_dat.h: crypto/objects/obj_dat.pl include/openssl/obj_mac.h
-	$(PERL) crypto/objects/obj_dat.pl include/openssl/obj_mac.h crypto/objects/obj_dat.h
-include/openssl/obj_mac.h: crypto/objects/objects.pl crypto/objects/objects.txt crypto/objects/obj_mac.num
-	$(PERL) crypto/objects/objects.pl crypto/objects/objects.txt crypto/objects/obj_mac.num include/openssl/obj_mac.h
-crypto/objects/obj_xref.h: crypto/objects/objxref.pl crypto/objects/obj_xref.txt crypto/objects/obj_mac.num
-	$(PERL) crypto/objects/objxref.pl crypto/objects/obj_mac.num crypto/objects/obj_xref.txt &gt;crypto/objects/obj_xref.h
-
-apps/openssl-vms.cnf: apps/openssl.cnf
-	$(PERL) VMS/VMSify-conf.pl &lt; apps/openssl.cnf &gt; apps/openssl-vms.cnf
-
-crypto/bn/bn_prime.h: crypto/bn/bn_prime.pl
-	$(PERL) crypto/bn/bn_prime.pl &gt;crypto/bn/bn_prime.h
-
-
 TABLE: Configure Configurations/*.conf
 	(echo 'Output of `Configure TABLE'&quot;':&quot;; \
 	$(PERL) Configure TABLE) &gt; TABLE
 
-update: errors stacks util/libeay.num util/ssleay.num crypto/objects/obj_dat.h crypto/objects/obj_xref.h apps/openssl-vms.cnf crypto/bn/bn_prime.h TABLE depend
-
 # Build distribution tar-file. As the list of files returned by &quot;find&quot; is
 # pretty long, on several platforms a &quot;too many arguments&quot; error or similar
 # would occur. Therefore the list of files is temporarily stored into a file
diff --git a/apps/Makefile b/apps/Makefile
index 29bad61..ea78064 100644
--- a/apps/Makefile
+++ b/apps/Makefile
@@ -76,6 +76,9 @@ all:	exe
 
 exe:	$(EXE)
 
+openssl-vms.cnf: openssl.cnf
+	$(PERL) $(TOP)/VMS/VMSify-conf.pl &lt; openssl.cnf &gt; openssl-vms.cnf
+
 files:
 	$(PERL) $(TOP)/util/files.pl Makefile &gt;&gt; $(TOP)/MINFO
 
@@ -120,6 +123,8 @@ tests:
 lint:
 	echo nope &gt;fluff
 
+update: openssl-vms.cnf depend
+
 depend:
 	@if [ -z &quot;$(THIS)&quot; ]; then \
 	    $(MAKE) -f $(TOP)/Makefile reflect THIS=$@; \
diff --git a/crypto/Makefile b/crypto/Makefile
index b0645fc..99cd65c 100644
--- a/crypto/Makefile
+++ b/crypto/Makefile
@@ -110,12 +110,17 @@ libs:
 lint:
 	@target=lint; $(RECURSIVE_MAKE)
 
-depend:
+update: local_depend
+	@[ -z &quot;$(THIS)&quot; ] || (set -e; target=update; $(RECURSIVE_MAKE) )
+	@if [ -z &quot;$(THIS)&quot; ]; then $(MAKE) -f $(TOP)/Makefile reflect THIS=$@; fi
+
+depend: local_depend
+	@[ -z &quot;$(THIS)&quot; ] || (set -e; target=depend; $(RECURSIVE_MAKE) )
+	@if [ -z &quot;$(THIS)&quot; ]; then $(MAKE) -f $(TOP)/Makefile reflect THIS=$@; fi
+local_depend:
 	@[ -z &quot;$(THIS)&quot; -o -f buildinf.h ] || touch buildinf.h # fake buildinf.h if it does not exist
 	@[ -z &quot;$(THIS)&quot; ] || $(MAKEDEPEND) -- $(CFLAG) $(INCLUDE) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
 	@[ -z &quot;$(THIS)&quot; -o -s buildinf.h ] || rm buildinf.h
-	@[ -z &quot;$(THIS)&quot; ] || (set -e; target=depend; $(RECURSIVE_MAKE) )
-	@if [ -z &quot;$(THIS)&quot; ]; then $(MAKE) -f $(TOP)/Makefile reflect THIS=$@; fi
 
 clean:
 	rm -f buildinf.h *.s *.o */*.o *.obj lib tags core .pure .nfs* *.old *.bak fluff
diff --git a/crypto/aes/Makefile b/crypto/aes/Makefile
index d3ce809..3ae1988 100644
--- a/crypto/aes/Makefile
+++ b/crypto/aes/Makefile
@@ -108,6 +108,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/asn1/Makefile b/crypto/asn1/Makefile
index 4dee260..66b0ef2 100644
--- a/crypto/asn1/Makefile
+++ b/crypto/asn1/Makefile
@@ -79,6 +79,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by top Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/bf/Makefile b/crypto/bf/Makefile
index 928e94d..dbf5a64 100644
--- a/crypto/bf/Makefile
+++ b/crypto/bf/Makefile
@@ -53,6 +53,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/bio/Makefile b/crypto/bio/Makefile
index ff00c6e..aa297f0 100644
--- a/crypto/bio/Makefile
+++ b/crypto/bio/Makefile
@@ -57,6 +57,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/bn/Makefile b/crypto/bn/Makefile
index c8d3dc2..7d55778 100644
--- a/crypto/bn/Makefile
+++ b/crypto/bn/Makefile
@@ -158,6 +158,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: bn_prime.h depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/buffer/Makefile b/crypto/buffer/Makefile
index 96261f1..f9d52fe 100644
--- a/crypto/buffer/Makefile
+++ b/crypto/buffer/Makefile
@@ -45,6 +45,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/camellia/Makefile b/crypto/camellia/Makefile
index 2602dbf..4aa84db 100644
--- a/crypto/camellia/Makefile
+++ b/crypto/camellia/Makefile
@@ -59,6 +59,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/cast/Makefile b/crypto/cast/Makefile
index 08d24b0..f9905ad 100644
--- a/crypto/cast/Makefile
+++ b/crypto/cast/Makefile
@@ -53,6 +53,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/cmac/Makefile b/crypto/cmac/Makefile
index 31d50e4..0c770c4 100644
--- a/crypto/cmac/Makefile
+++ b/crypto/cmac/Makefile
@@ -45,6 +45,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/cms/Makefile b/crypto/cms/Makefile
index 8383fe5..4924fcf 100644
--- a/crypto/cms/Makefile
+++ b/crypto/cms/Makefile
@@ -51,6 +51,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/comp/Makefile b/crypto/comp/Makefile
index 7884f99..5f9b42d 100644
--- a/crypto/comp/Makefile
+++ b/crypto/comp/Makefile
@@ -48,6 +48,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(LIBSRC)
diff --git a/crypto/conf/Makefile b/crypto/conf/Makefile
index 1ad2412..2df0a98 100644
--- a/crypto/conf/Makefile
+++ b/crypto/conf/Makefile
@@ -48,6 +48,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(LIBSRC)
diff --git a/crypto/des/Makefile b/crypto/des/Makefile
index eb8f3bd..56c41f1 100644
--- a/crypto/des/Makefile
+++ b/crypto/des/Makefile
@@ -74,6 +74,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/dh/Makefile b/crypto/dh/Makefile
index 14f1efa..f9be501 100644
--- a/crypto/dh/Makefile
+++ b/crypto/dh/Makefile
@@ -47,6 +47,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/dsa/Makefile b/crypto/dsa/Makefile
index 0761873..aa2b785 100644
--- a/crypto/dsa/Makefile
+++ b/crypto/dsa/Makefile
@@ -47,6 +47,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/dso/Makefile b/crypto/dso/Makefile
index 17af757..b2efd5c 100644
--- a/crypto/dso/Makefile
+++ b/crypto/dso/Makefile
@@ -47,6 +47,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/ec/Makefile b/crypto/ec/Makefile
index 5113faf..a2c135a 100644
--- a/crypto/ec/Makefile
+++ b/crypto/ec/Makefile
@@ -72,6 +72,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/ecdh/Makefile b/crypto/ecdh/Makefile
index b924e62..e980a1c 100644
--- a/crypto/ecdh/Makefile
+++ b/crypto/ecdh/Makefile
@@ -46,6 +46,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/ecdsa/Makefile b/crypto/ecdsa/Makefile
index be6f849..01a7c34 100644
--- a/crypto/ecdsa/Makefile
+++ b/crypto/ecdsa/Makefile
@@ -46,6 +46,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/engine/Makefile b/crypto/engine/Makefile
index bddabe2..532fadd 100644
--- a/crypto/engine/Makefile
+++ b/crypto/engine/Makefile
@@ -55,6 +55,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/err/Makefile b/crypto/err/Makefile
index acbb06e..e384e62 100644
--- a/crypto/err/Makefile
+++ b/crypto/err/Makefile
@@ -45,6 +45,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/evp/Makefile b/crypto/evp/Makefile
index 9cd98cd..c23c39a 100644
--- a/crypto/evp/Makefile
+++ b/crypto/evp/Makefile
@@ -68,6 +68,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(LIBSRC)
diff --git a/crypto/hmac/Makefile b/crypto/hmac/Makefile
index 1415ebd..934631a 100644
--- a/crypto/hmac/Makefile
+++ b/crypto/hmac/Makefile
@@ -45,6 +45,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/idea/Makefile b/crypto/idea/Makefile
index 345b602..db18952 100644
--- a/crypto/idea/Makefile
+++ b/crypto/idea/Makefile
@@ -45,6 +45,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/jpake/Makefile b/crypto/jpake/Makefile
index 1f01d73..3a7b5ae 100644
--- a/crypto/jpake/Makefile
+++ b/crypto/jpake/Makefile
@@ -27,6 +27,8 @@ lib:	$(LIBOBJ)
 files:
 	$(PERL) $(TOP)/util/files.pl Makefile &gt;&gt; $(TOP)/MINFO
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/lhash/Makefile b/crypto/lhash/Makefile
index 952f028..feb5fa5 100644
--- a/crypto/lhash/Makefile
+++ b/crypto/lhash/Makefile
@@ -45,6 +45,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/md2/Makefile b/crypto/md2/Makefile
index 153c48e..1ca1896 100644
--- a/crypto/md2/Makefile
+++ b/crypto/md2/Makefile
@@ -45,6 +45,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/md4/Makefile b/crypto/md4/Makefile
index b1904c0..cf5cb8d 100644
--- a/crypto/md4/Makefile
+++ b/crypto/md4/Makefile
@@ -46,6 +46,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/md5/Makefile b/crypto/md5/Makefile
index 7dd700f..24834f3 100644
--- a/crypto/md5/Makefile
+++ b/crypto/md5/Makefile
@@ -63,6 +63,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/mdc2/Makefile b/crypto/mdc2/Makefile
index 33f318f..5517a08 100644
--- a/crypto/mdc2/Makefile
+++ b/crypto/mdc2/Makefile
@@ -45,6 +45,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/modes/Makefile b/crypto/modes/Makefile
index 69afd89..ce27c2d 100644
--- a/crypto/modes/Makefile
+++ b/crypto/modes/Makefile
@@ -78,6 +78,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/objects/Makefile b/crypto/objects/Makefile
index 94e1d4e..7bc0aac 100644
--- a/crypto/objects/Makefile
+++ b/crypto/objects/Makefile
@@ -58,6 +58,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: obj_dat.h ../../include/openssl/obj_mac.h obj_xref.h depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/ocsp/Makefile b/crypto/ocsp/Makefile
index 497275d..ea5f728 100644
--- a/crypto/ocsp/Makefile
+++ b/crypto/ocsp/Makefile
@@ -48,6 +48,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(LIBSRC)
diff --git a/crypto/pem/Makefile b/crypto/pem/Makefile
index 03bb92c..ce112c0 100644
--- a/crypto/pem/Makefile
+++ b/crypto/pem/Makefile
@@ -48,6 +48,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(LIBSRC)
diff --git a/crypto/pkcs12/Makefile b/crypto/pkcs12/Makefile
index 4c08faa..98ec4bf 100644
--- a/crypto/pkcs12/Makefile
+++ b/crypto/pkcs12/Makefile
@@ -51,6 +51,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/pkcs7/Makefile b/crypto/pkcs7/Makefile
index f00ff24..96e5a07 100644
--- a/crypto/pkcs7/Makefile
+++ b/crypto/pkcs7/Makefile
@@ -52,6 +52,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/pqueue/Makefile b/crypto/pqueue/Makefile
index 569c3c9..b5c8eea 100644
--- a/crypto/pqueue/Makefile
+++ b/crypto/pqueue/Makefile
@@ -45,6 +45,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/rand/Makefile b/crypto/rand/Makefile
index 3e09b89..a0b1245 100644
--- a/crypto/rand/Makefile
+++ b/crypto/rand/Makefile
@@ -47,6 +47,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/rc2/Makefile b/crypto/rc2/Makefile
index 22e1b49..b07d3c1 100644
--- a/crypto/rc2/Makefile
+++ b/crypto/rc2/Makefile
@@ -45,6 +45,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/rc4/Makefile b/crypto/rc4/Makefile
index b8eecef..5d61aac 100644
--- a/crypto/rc4/Makefile
+++ b/crypto/rc4/Makefile
@@ -73,6 +73,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/rc5/Makefile b/crypto/rc5/Makefile
index 4336e6e..130b4a8 100644
--- a/crypto/rc5/Makefile
+++ b/crypto/rc5/Makefile
@@ -53,6 +53,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/ripemd/Makefile b/crypto/ripemd/Makefile
index af4824e..e86987f 100644
--- a/crypto/ripemd/Makefile
+++ b/crypto/ripemd/Makefile
@@ -53,6 +53,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/rsa/Makefile b/crypto/rsa/Makefile
index 6c33a04..65d243d 100644
--- a/crypto/rsa/Makefile
+++ b/crypto/rsa/Makefile
@@ -51,6 +51,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/seed/Makefile b/crypto/seed/Makefile
index b4ea879..5f13cbe 100644
--- a/crypto/seed/Makefile
+++ b/crypto/seed/Makefile
@@ -46,6 +46,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/sha/Makefile b/crypto/sha/Makefile
index f99a6b3..4a8b77f 100644
--- a/crypto/sha/Makefile
+++ b/crypto/sha/Makefile
@@ -108,6 +108,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/srp/Makefile b/crypto/srp/Makefile
index ff6e905..e90adf7 100644
--- a/crypto/srp/Makefile
+++ b/crypto/srp/Makefile
@@ -44,6 +44,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
 
diff --git a/crypto/stack/Makefile b/crypto/stack/Makefile
index 76f1b2b..9a60eec 100644
--- a/crypto/stack/Makefile
+++ b/crypto/stack/Makefile
@@ -45,6 +45,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/store/Makefile b/crypto/store/Makefile
index 79e31b5..b73fb30 100644
--- a/crypto/store/Makefile
+++ b/crypto/store/Makefile
@@ -45,6 +45,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/ts/Makefile b/crypto/ts/Makefile
index 2f56229..673d01b 100644
--- a/crypto/ts/Makefile
+++ b/crypto/ts/Makefile
@@ -57,6 +57,8 @@ tags:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(LIBSRC)
 
diff --git a/crypto/txt_db/Makefile b/crypto/txt_db/Makefile
index ca967ab..6e9d372 100644
--- a/crypto/txt_db/Makefile
+++ b/crypto/txt_db/Makefile
@@ -45,6 +45,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by top Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/ui/Makefile b/crypto/ui/Makefile
index 1346d13..2a02136 100644
--- a/crypto/ui/Makefile
+++ b/crypto/ui/Makefile
@@ -45,6 +45,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/whrlpool/Makefile b/crypto/whrlpool/Makefile
index 31c63ad..aafb467 100644
--- a/crypto/whrlpool/Makefile
+++ b/crypto/whrlpool/Makefile
@@ -58,6 +58,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/x509/Makefile b/crypto/x509/Makefile
index a6b2b7c..7e0e594 100644
--- a/crypto/x509/Makefile
+++ b/crypto/x509/Makefile
@@ -57,6 +57,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/crypto/x509v3/Makefile b/crypto/x509v3/Makefile
index d7be020..fb1085b 100644
--- a/crypto/x509v3/Makefile
+++ b/crypto/x509v3/Makefile
@@ -55,6 +55,8 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
+update: depend
+
 depend:
 	@[ -n &quot;$(MAKEDEPEND)&quot; ] # should be set by upper Makefile...
 	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
diff --git a/engines/Makefile b/engines/Makefile
index 769a4e5..eca15e2 100644
--- a/engines/Makefile
+++ b/engines/Makefile
@@ -134,12 +134,14 @@ lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 	@target=lint; $(RECURSIVE_MAKE)
 
-depend:
-	@if [ -z &quot;$(THIS)&quot; ]; then \
-	    $(MAKE) -f $(TOP)/Makefile reflect THIS=$@; \
-	fi
-	@[ -z &quot;$(THIS)&quot; ] || $(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
+update: local_depend
+	@if [ -z &quot;$(THIS)&quot; ]; then $(MAKE) -f $(TOP)/Makefile reflect THIS=$@; fi
+
+depend: local_depend
+	@if [ -z &quot;$(THIS)&quot; ]; then $(MAKE) -f $(TOP)/Makefile reflect THIS=$@; fi
 	@[ -z &quot;$(THIS)&quot; ] || (set -e; target=depend; $(RECURSIVE_MAKE) )
+local_depend:
+	@[ -z &quot;$(THIS)&quot; ] || $(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
 
 dclean:
 	$(PERL) -pe 'if (/^# DO NOT DELETE THIS LINE/) {print; exit(0);}' $(MAKEFILE) &gt;Makefile.new
diff --git a/engines/ccgost/Makefile b/engines/ccgost/Makefile
index 1ce1848..f3378aa 100644
--- a/engines/ccgost/Makefile
+++ b/engines/ccgost/Makefile
@@ -63,12 +63,13 @@ install:
 
 tests:
 
-depend:
-	@if [ -z &quot;$(THIS)&quot; ]; then \
-	    $(MAKE) -f $(TOP)/Makefile reflect THIS=$@; \
-	else \
-	    $(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC); \
-	fi
+update: local_depend
+	@[ -z &quot;$(THIS)&quot; ] &amp;&amp; $(MAKE) -f $(TOP)/Makefile reflect THIS=$@
+
+depend: local_depend
+	@[ -z &quot;$(THIS)&quot; ] &amp;&amp; $(MAKE) -f $(TOP)/Makefile reflect THIS=$@
+local_depend:
+	@[ -z &quot;$(THIS)&quot; ] || $(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
 
 files:
 	$(PERL) $(TOP)/util/files.pl Makefile &gt;&gt; $(TOP)/MINFO
diff --git a/ssl/Makefile b/ssl/Makefile
index ad2f99f..d1fc049 100644
--- a/ssl/Makefile
+++ b/ssl/Makefile
@@ -71,12 +71,13 @@ tests:
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)&gt;fluff
 
-depend:
-	@if [ -z &quot;$(THIS)&quot; ]; then \
-	    $(MAKE) -f $(TOP)/Makefile reflect THIS=$@; \
-	else \
-	    $(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC); \
-	fi
+update: local_depend
+	@if [ -z &quot;$(THIS)&quot; ]; then $(MAKE) -f $(TOP)/Makefile reflect THIS=$@; fi
+
+depend: local_depend
+	@if [ -z &quot;$(THIS)&quot; ]; then $(MAKE) -f $(TOP)/Makefile reflect THIS=$@; fi
+local_depend:
+	@[ -z &quot;$(THIS)&quot; ] || $(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
 
 dclean:
 	$(PERL) -pe 'if (/^# DO NOT DELETE THIS LINE/) {print; exit(0);}' $(MAKEFILE) &gt;Makefile.new
diff --git a/test/Makefile b/test/Makefile
index da97db7..86a251f 100644
--- a/test/Makefile
+++ b/test/Makefile
@@ -392,12 +392,13 @@ test_constant_time: $(CONSTTIMETEST)$(EXE_EXT)
 	@echo $(START) $@
 	../util/shlib_wrap.sh ./$(CONSTTIMETEST)
 
-depend:
-	@if [ -z &quot;$(THIS)&quot; ]; then \
-	    $(MAKE) -f $(TOP)/Makefile reflect THIS=$@; \
-	else \
-	    $(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(SRC); \
-	fi
+update: local_depend
+	@if [ -z &quot;$(THIS)&quot; ]; then $(MAKE) -f $(TOP)/Makefile reflect THIS=$@; fi
+
+depend: local_depend
+	@if [ -z &quot;$(THIS)&quot; ]; then $(MAKE) -f $(TOP)/Makefile reflect THIS=$@; fi
+local_depend:
+	@[ -z &quot;$(THIS)&quot; ] || $(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(SRC)
 
 dclean:
 	$(PERL) -pe 'if (/^# DO NOT DELETE THIS LINE/) {print; exit(0);}' $(MAKEFILE) &gt;Makefile.new
diff --git a/tools/Makefile b/tools/Makefile
index edd7fc5..d4752f8 100644
--- a/tools/Makefile
+++ b/tools/Makefile
@@ -53,6 +53,8 @@ tags:
 
 errors:
 
+update: depend
+
 depend:
 
 dclean:
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001138.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="001140.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1139">[ date ]</a>
              <a href="thread.html#1139">[ thread ]</a>
              <a href="subject.html#1139">[ subject ]</a>
              <a href="author.html#1139">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
