<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2019-January/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1548095660.670660.22060.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021678.html">
   <LINK REL="Next"  HREF="021685.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Richard Levitte</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1548095660.670660.22060.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">levitte at openssl.org
       </A><BR>
    <I>Mon Jan 21 18:34:20 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="021678.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="021685.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21680">[ date ]</a>
              <a href="thread.html#21680">[ thread ]</a>
              <a href="subject.html#21680">[ subject ]</a>
              <a href="author.html#21680">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  f5fb6f0543cafd3db6671cfb987bf475a35f30f6 (commit)
       via  9afc2b92fe6725336f9c7d917deb5ca8c5e4011b (commit)
       via  9dd4ed28eb5972f62723985429b57f42eefda124 (commit)
       via  c162a8c344f12b2e0e788920358f51181ddf168f (commit)
       via  957689611b355f3514bd9051829f3a9a0d9d4517 (commit)
       via  d7e4932eaf53a82a2606a73282d9c8a242c1a39d (commit)
      from  ac454d8d4663e2fcf8a8437fab8aefd883091c37 (commit)


- Log -----------------------------------------------------------------
commit f5fb6f0543cafd3db6671cfb987bf475a35f30f6
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Tue Oct 23 15:45:24 2018 +0200

    Rework building: Get rid of old %unified_info structures
    
    Now that we have the names of libraries on different systems
    established through platform modules, we can remove the old structure
    to establish the same thing, i.e. $unified_info{sharednames} and
    $unified_info{rename}.  That means removing support for the RENAME and
    SHARED_NAME keywords in build.info as well.
    
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">paul.dale at oracle.com</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/7473">https://github.com/openssl/openssl/pull/7473</A>)

commit 9afc2b92fe6725336f9c7d917deb5ca8c5e4011b
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Tue Oct 23 15:42:46 2018 +0200

    Rework building: adapt some scripts
    
    The platform module collection is made in such a way that any Perl
    script that wants to take part of the available information can use
    them just as well as the build system.
    
    This change adapts test/recipes/90-test_shlibload.t, util/mkdef.pl,
    and util/shlib_wrap.sh.in
    
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">paul.dale at oracle.com</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/7473">https://github.com/openssl/openssl/pull/7473</A>)

commit 9dd4ed28eb5972f62723985429b57f42eefda124
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Tue Oct 23 15:09:57 2018 +0200

    Rework building: Unix changes to handle extensions and product names
    
    Add platform::Unix, which is a generic Unix module to support product
    name and extensions functionlity.  However, this isn't quite enough,
    as mingw and Cygwin builds are done using the same templates, but
    since shared libraries work as on Windows and are named accordingly,
    platform::mingw and platform::Cygwin were also added to provide the
    necessary tweaks.
    
    This reworks Configurations/unix-Makefile.tmpl to work out product
    names in platform::Unix et al terms.  In this one, we currently do
    care about the *_extension config attributes, and the modules adapt
    accordingly where it matters.
    
    This change also affected crypto/include/internal/dso_conf.h.in, since
    the DSO extension is meant to be the same as the short shared library
    extension, which isn't '.so' everywhere.
    
    'shared_extension' attributes that had the value
    '.so.\$(SHLIB_VERSION_NUMBER)' are removed, platform::Unix provides
    an extension where the shared library version number is hard-coded
    instead.
    
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">paul.dale at oracle.com</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/7473">https://github.com/openssl/openssl/pull/7473</A>)

commit c162a8c344f12b2e0e788920358f51181ddf168f
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Tue Oct 23 15:00:36 2018 +0200

    Rework building: VMS changes to handle extensions and product names
    
    Add platform::VMS, which is a generic VMS module.  Additional modules
    to support specific building aspects (such as specific compilers) may
    be added later, but since we currently work on file names and those
    are generic enough, this is also enough.
    
    This reworks Configurations/descrip.mms.tmpl to work out product names
    in platform::VMS terms.  Something to be noted is that the new
    functionality ignores the *_extension config attributes, as they were
    never used.  VMS is very consistent in its use of extensions, so there
    is no reason to believe much will change in this respect.
    
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">paul.dale at oracle.com</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/7473">https://github.com/openssl/openssl/pull/7473</A>)

commit 957689611b355f3514bd9051829f3a9a0d9d4517
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Tue Oct 23 14:36:23 2018 +0200

    Rework building: Windows changes to handle extensions and product names
    
    Add platform::Windows, which is a generic Windows module, and
    platform::Windows::MSVC, which is a module specifically for MS Visual
    C.
    
    This reworks Configurations/windows-makeffile.tmpl to work out product
    names in platform::Windows.  Something to be noted is that the new
    functionality ignores the *_extension config attributes, as they were
    never used.
    
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">paul.dale at oracle.com</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/7473">https://github.com/openssl/openssl/pull/7473</A>)

commit d7e4932eaf53a82a2606a73282d9c8a242c1a39d
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Tue Oct 23 14:14:48 2018 +0200

    Rework building: initial changes
    
    This is the start of a major work to correct some quirks in the
    buiding system.  The base for this is to move certain attributes that
    lack desired flexibility from Configurations/*.conf to perl modules
    that can be selected with one single attribute in the config targets.
    
    The way this is meant to work is by adding this attribute in select
    config targets:
    
        perl_module         =&gt; 'Name';      # Name to be replaced
    
    Then, in the perl scripts or modules that need the functionality,
    these lines should be added:
    
        use lib catdir($srcdir, 'Configurations');	# Ensure access to platform.pm
        use lib $blddir;    # Ensure access to configdata.pm
        use platform;       # Will load platform::$target{perl_module}
    
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">paul.dale at oracle.com</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/7473">https://github.com/openssl/openssl/pull/7473</A>)

-----------------------------------------------------------------------

Summary of changes:
 Configurations/00-base-templates.conf   |  13 +-
 Configurations/10-main.conf             |  95 ++++--------
 Configurations/50-haiku.conf            |   2 +-
 Configurations/90-team.norelease.conf   |   3 -
 Configurations/README                   |  26 ----
 Configurations/common.tmpl              |   3 +-
 Configurations/descrip.mms.tmpl         | 186 +++++++++++------------
 Configurations/platform.pm              |  18 +++
 Configurations/platform/BASE.pm         |  96 ++++++++++++
 Configurations/platform/Cygwin.pm       |  22 +++
 Configurations/platform/Unix.pm         |  70 +++++++++
 Configurations/platform/VMS.pm          |  66 ++++++++
 Configurations/platform/Windows.pm      |  65 ++++++++
 Configurations/platform/Windows/MSVC.pm |  33 ++++
 Configurations/platform/mingw.pm        |  45 ++++++
 Configurations/unix-Makefile.tmpl       | 259 ++++++++++++--------------------
 Configurations/windows-makefile.tmpl    | 169 +++++++++------------
 Configure                               | 129 ++--------------
 build.info                              |  32 ----
 crypto/include/internal/dso_conf.h.in   |   2 +-
 test/recipes/90-test_shlibload.t        |  25 +--
 util/dofile.pl                          |  12 +-
 util/local_shlib.com.in                 |  11 +-
 util/mkdef.pl                           |   6 +-
 util/shlib_wrap.sh.in                   |  20 +--
 util/unlocal_shlib.com.in               |  11 +-
 26 files changed, 755 insertions(+), 664 deletions(-)
 create mode 100644 Configurations/platform.pm
 create mode 100644 Configurations/platform/BASE.pm
 create mode 100644 Configurations/platform/Cygwin.pm
 create mode 100644 Configurations/platform/Unix.pm
 create mode 100644 Configurations/platform/VMS.pm
 create mode 100644 Configurations/platform/Windows.pm
 create mode 100644 Configurations/platform/Windows/MSVC.pm
 create mode 100644 Configurations/platform/mingw.pm

diff --git a/Configurations/00-base-templates.conf b/Configurations/00-base-templates.conf
index 8555ba1..eb9feae 100644
--- a/Configurations/00-base-templates.conf
+++ b/Configurations/00-base-templates.conf
@@ -42,7 +42,6 @@ my %targets=(
 	shared_defines	=&gt; [],
 	shared_ldflag	=&gt; &quot;&quot;,
 	shared_rcflag	=&gt; &quot;&quot;,
-	shared_extension	=&gt; &quot;&quot;,
 
 	#### Defaults for the benefit of the config targets who don't inherit
 	#### a BASE and assume Unix defaults
@@ -102,10 +101,10 @@ my %targets=(
                                      ? &quot;ranlib&quot; : &quot;&quot; },
         RC              =&gt; &quot;windres&quot;,
 
-        shared_extension =&gt; &quot;.so&quot;,
-
         build_scheme    =&gt; [ &quot;unified&quot;, &quot;unix&quot; ],
         build_file      =&gt; &quot;Makefile&quot;,
+
+        perl_platform   =&gt; 'Unix',
     },
 
     BASE_Windows =&gt; {
@@ -144,10 +143,10 @@ my %targets=(
         mtinflag        =&gt; &quot;-manifest &quot;,
         mtoutflag       =&gt; &quot;-outputresource:&quot;,
 
-        shared_extension =&gt; &quot;.dll&quot;,
-
         build_file      =&gt; &quot;makefile&quot;,
         build_scheme    =&gt; [ &quot;unified&quot;, &quot;windows&quot; ],
+
+        perl_platform   =&gt; 'Windows',
     },
 
     BASE_VMS =&gt; {
@@ -164,10 +163,10 @@ my %targets=(
                     return [ @incs ];
                 }),
 
-        shared_extension =&gt; &quot;.exe&quot;,
-
         build_file       =&gt; &quot;descrip.mms&quot;,
         build_scheme     =&gt; [ &quot;unified&quot;, &quot;VMS&quot; ],
+
+        perl_platform    =&gt; 'VMS',
     },
 
     uplink_common =&gt; {
diff --git a/Configurations/10-main.conf b/Configurations/10-main.conf
index 21d8345..054e38c 100644
--- a/Configurations/10-main.conf
+++ b/Configurations/10-main.conf
@@ -212,7 +212,6 @@ my %targets = (
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         thread_scheme    =&gt; &quot;pthreads&quot;,
         shared_target    =&gt; &quot;solaris&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
         shared_ldflag    =&gt; &quot;-Wl,-Bsymbolic&quot;,
         shared_defflag   =&gt; &quot;-Wl,-M,&quot;,
         shared_sonameflag=&gt; &quot;-Wl,-h,&quot;,
@@ -365,7 +364,6 @@ my %targets = (
         thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;self&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
         shared_ldflag    =&gt; &quot;-shared -Wl,-Bsymbolic&quot;,
         shared_sonameflag=&gt; &quot;-Wl,-soname,&quot;,
     },
@@ -534,7 +532,6 @@ my %targets = (
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT&quot;,
         shared_cflag     =&gt; &quot;+Z&quot;,
         shared_ldflag    =&gt; add_before(&quot;-b&quot;),
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
         multilib         =&gt; &quot;/hpux32&quot;,
     },
     &quot;hpux64-ia64-cc&quot; =&gt; {
@@ -548,7 +545,6 @@ my %targets = (
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         shared_cflag     =&gt; &quot;+Z&quot;,
         shared_ldflag    =&gt; add_before(&quot;-b&quot;),
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
         multilib         =&gt; &quot;/hpux64&quot;,
     },
     # GCC builds...
@@ -562,7 +558,6 @@ my %targets = (
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT&quot;,
         shared_cflag     =&gt; &quot;-fpic&quot;,
         shared_ldflag    =&gt; add_before(&quot;-shared&quot;),
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
         multilib         =&gt; &quot;/hpux32&quot;,
     },
     &quot;hpux64-ia64-gcc&quot; =&gt; {
@@ -575,7 +570,6 @@ my %targets = (
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         shared_cflag     =&gt; &quot;-fpic&quot;,
         shared_ldflag    =&gt; add_before(&quot;-shared&quot;),
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
         multilib         =&gt; &quot;/hpux64&quot;,
     },
 
@@ -652,7 +646,6 @@ my %targets = (
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
         shared_ldflag    =&gt; sub { $disabled{pinshared} ? () : &quot;-Wl,-znodelete&quot; },
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
         enable           =&gt; [ &quot;afalgeng&quot; ],
     },
     &quot;linux-generic64&quot; =&gt; {
@@ -906,7 +899,6 @@ my %targets = (
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;--pic&quot;,
         shared_ldflag    =&gt; add(&quot;-z --sysv --shared&quot;),
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
         ranlib           =&gt; &quot;true&quot;,
     },
 
@@ -933,7 +925,6 @@ my %targets = (
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
     },
     &quot;BSD-generic64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;BSD-generic32&quot; ],
@@ -991,7 +982,6 @@ my %targets = (
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
     },
 
     &quot;nextstep&quot; =&gt; {
@@ -1052,7 +1042,6 @@ my %targets = (
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;svr5-shared&quot;,
         shared_cflag     =&gt; &quot;-Kpic&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
     },
     &quot;unixware-7-gcc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_elf_asm&quot;) ],
@@ -1067,7 +1056,6 @@ my %targets = (
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;gnu-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
     },
 # SCO 5 - Ben Laurie says the -O breaks the SCO cc.
     &quot;sco5-cc&quot; =&gt; {
@@ -1080,7 +1068,6 @@ my %targets = (
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;svr3-shared&quot;,
         shared_cflag     =&gt; &quot;-Kpic&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
     },
     &quot;sco5-gcc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_elf_asm&quot;) ],
@@ -1093,7 +1080,6 @@ my %targets = (
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;svr3-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
     },
 
 #### IBM's AIX.
@@ -1114,8 +1100,6 @@ my %targets = (
         module_ldflags   =&gt; &quot;-Wl,-G,-bsymbolic,-bexpall&quot;,
         shared_ldflag    =&gt; &quot;-Wl,-G,-bsymbolic&quot;,
         shared_defflag   =&gt; &quot;-Wl,-bE:&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
-        dso_extension    =&gt; &quot;.so&quot;,
         lib_extension    =&gt; shared(&quot;_a.a&quot;),
         shared_extension_simple =&gt; shared(&quot;.a&quot;),
     },
@@ -1235,6 +1219,7 @@ my %targets = (
         dso_scheme       =&gt; &quot;win32&quot;,
         apps_aux_src     =&gt; add(&quot;win32_init.c&quot;),
         bn_ops           =&gt; &quot;EXPORT_VAR_AS_FN&quot;,
+        perl_platform    =&gt; 'Windows::MSVC',
         # additional parameter to build_scheme denotes install-path &quot;flavour&quot;
         build_scheme     =&gt; add(&quot;VC-common&quot;, { separator =&gt; undef }),
     },
@@ -1375,30 +1360,37 @@ my %targets = (
     },
 
 #### MinGW
-    &quot;mingw&quot; =&gt; {
-        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_asm&quot;),
-                              sub { $disabled{shared} ? () : &quot;x86_uplink&quot; } ],
+    &quot;mingw-common&quot; =&gt; {
+        inherit_from     =&gt; [ 'BASE_unix' ],
+        template         =&gt; 1,
         CC               =&gt; &quot;gcc&quot;,
         CFLAGS           =&gt; picker(default =&gt; &quot;-Wall&quot;,
                                    debug   =&gt; &quot;-g -O0&quot;,
-                                   release =&gt; &quot;-O3 -fomit-frame-pointer&quot;),
-        cflags           =&gt; &quot;-m32&quot;,
+                                   release =&gt; &quot;-O3&quot;),
         cppflags         =&gt; combine(&quot;-DUNICODE -D_UNICODE -DWIN32_LEAN_AND_MEAN&quot;,
                                     threads(&quot;-D_MT&quot;)),
         lib_cppflags     =&gt; &quot;-DL_ENDIAN&quot;,
-        sys_id           =&gt; &quot;MINGW32&quot;,
         ex_libs          =&gt; add(&quot;-lws2_32 -lgdi32 -lcrypt32&quot;),
-        bn_ops           =&gt; &quot;BN_LLONG EXPORT_VAR_AS_FN&quot;,
+        bn_ops           =&gt; &quot;EXPORT_VAR_AS_FN&quot;,
         thread_scheme    =&gt; &quot;winthreads&quot;,
-        perlasm_scheme   =&gt; &quot;coff&quot;,
         dso_scheme       =&gt; &quot;win32&quot;,
         shared_target    =&gt; &quot;mingw-shared&quot;,
         shared_cppflags  =&gt; add(&quot;_WINDLL&quot;),
         shared_ldflag    =&gt; &quot;-static-libgcc&quot;,
+        apps_aux_src     =&gt; add(&quot;win32_init.c&quot;),
+
+        perl_platform    =&gt; 'mingw',
+    },
+    &quot;mingw&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;mingw-common&quot;, asm(&quot;x86_asm&quot;),
+                              sub { $disabled{shared} ? () : &quot;x86_uplink&quot; } ],
+        CFLAGS           =&gt; add(picker(release =&gt; &quot;-fomit-frame-pointer&quot;)),
+        cflags           =&gt; &quot;-m32&quot;,
+        sys_id           =&gt; &quot;MINGW32&quot;,
+        bn_ops           =&gt; add(&quot;BN_LLONG&quot;),
+        perlasm_scheme   =&gt; &quot;coff&quot;,
         shared_rcflag    =&gt; &quot;--target=pe-i386&quot;,
-        shared_extension =&gt; &quot;.dll&quot;,
         multilib         =&gt; &quot;&quot;,
-        apps_aux_src     =&gt; add(&quot;win32_init.c&quot;),
     },
     &quot;mingw64&quot; =&gt; {
         # As for OPENSSL_USE_APPLINK. Applink makes it possible to use
@@ -1409,28 +1401,13 @@ my %targets = (
         # consider its binaries for using with non-mingw64 run-time
         # environment. And as mingw64 is always consistent with itself,
         # Applink is never engaged and can as well be omitted.
-        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_64_asm&quot;) ],
-        CC               =&gt; &quot;gcc&quot;,
-        CFLAGS           =&gt; picker(default =&gt; &quot;-Wall&quot;,
-                                   debug   =&gt; &quot;-g -O0&quot;,
-                                   release =&gt; &quot;-O3&quot;),
+        inherit_from     =&gt; [ &quot;mingw-common&quot;, asm(&quot;x86_64_asm&quot;) ],
         cflags           =&gt; &quot;-m64&quot;,
-        cppflags         =&gt; combine(&quot;-DUNICODE -D_UNICODE -DWIN32_LEAN_AND_MEAN&quot;,
-                                    threads(&quot;-D_MT&quot;)),
-        lib_cppflags     =&gt; &quot;-DL_ENDIAN&quot;,
         sys_id           =&gt; &quot;MINGW64&quot;,
-        ex_libs          =&gt; add(&quot;-lws2_32 -lgdi32 -lcrypt32&quot;),
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT EXPORT_VAR_AS_FN&quot;,
-        thread_scheme    =&gt; &quot;winthreads&quot;,
+        bn_ops           =&gt; add(&quot;SIXTY_FOUR_BIT&quot;),
         perlasm_scheme   =&gt; &quot;mingw64&quot;,
-        dso_scheme       =&gt; &quot;win32&quot;,
-        shared_target    =&gt; &quot;mingw-shared&quot;,
-        shared_cppflags  =&gt; add(&quot;_WINDLL&quot;),
-        shared_ldflag    =&gt; &quot;-static-libgcc&quot;,
         shared_rcflag    =&gt; &quot;--target=pe-x86-64&quot;,
-        shared_extension =&gt; &quot;.dll&quot;,
         multilib         =&gt; &quot;64&quot;,
-        apps_aux_src     =&gt; add(&quot;win32_init.c&quot;),
     },
 
 #### UEFI
@@ -1454,37 +1431,34 @@ my %targets = (
     },
 
 #### Cygwin
-    &quot;Cygwin-x86&quot; =&gt; {
+    &quot;Cygwin-common&quot; =&gt; {
         inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_asm&quot;) ],
+        template         =&gt; 1,
+
         CC               =&gt; &quot;gcc&quot;,
         CFLAGS           =&gt; picker(default =&gt; &quot;-Wall&quot;,
                                    debug   =&gt; &quot;-g -O0&quot;,
-                                   release =&gt; &quot;-O3 -fomit-frame-pointer&quot;),
+                                   release =&gt; &quot;-O3&quot;),
         lib_cppflags     =&gt; &quot;-DTERMIOS -DL_ENDIAN&quot;,
         sys_id           =&gt; &quot;CYGWIN&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG&quot;,
         thread_scheme    =&gt; &quot;pthread&quot;,
-        perlasm_scheme   =&gt; &quot;coff&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;cygwin-shared&quot;,
         shared_cppflags  =&gt; &quot;-D_WINDLL&quot;,
-        shared_extension =&gt; &quot;.dll&quot;,
+
+        perl_platform    =&gt; 'Cygwin',
+    },
+    &quot;Cygwin-x86&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;Cygwin-common&quot;, asm(&quot;x86_asm&quot;) ],
+        CFLAGS           =&gt; add(picker(release =&gt; &quot;-O3 -fomit-frame-pointer&quot;)),
+        bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        perlasm_scheme   =&gt; &quot;coff&quot;,
     },
     &quot;Cygwin-x86_64&quot; =&gt; {
-        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;Cygwin-common&quot;, asm(&quot;x86_64_asm&quot;) ],
         CC               =&gt; &quot;gcc&quot;,
-        CFLAGS           =&gt; picker(default =&gt; &quot;-Wall&quot;,
-                                   debug   =&gt; &quot;-g -O0&quot;,
-                                   release =&gt; &quot;-O3&quot;),
-        lib_cppflags     =&gt; &quot;-DTERMIOS -DL_ENDIAN&quot;,
-        sys_id           =&gt; &quot;CYGWIN&quot;,
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
-        thread_scheme    =&gt; &quot;pthread&quot;,
         perlasm_scheme   =&gt; &quot;mingw64&quot;,
-        dso_scheme       =&gt; &quot;dlfcn&quot;,
-        shared_target    =&gt; &quot;cygwin-shared&quot;,
-        shared_cppflags  =&gt; &quot;-D_WINDLL&quot;,
-        shared_extension =&gt; &quot;.dll&quot;,
     },
     # Backward compatibility for those using this target
     &quot;Cygwin&quot; =&gt; {
@@ -1571,7 +1545,6 @@ my %targets = (
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
     },
 
 ##### VxWorks for various targets
@@ -1687,7 +1660,6 @@ my %targets = (
         dso_scheme       =&gt; sub { env('LIBSSL_dlfcn') },
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
         ranlib           =&gt; sub { env('RANLIB') },
     },
     &quot;uClinux-dist64&quot; =&gt; {
@@ -1700,7 +1672,6 @@ my %targets = (
         dso_scheme       =&gt; sub { env('LIBSSL_dlfcn') },
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
         ranlib           =&gt; sub { env('RANLIB') },
     },
 
diff --git a/Configurations/50-haiku.conf b/Configurations/50-haiku.conf
index cd6d10e..5bc4db5 100644
--- a/Configurations/50-haiku.conf
+++ b/Configurations/50-haiku.conf
@@ -15,7 +15,7 @@ my %targets = (
         shared_target    =&gt; &quot;gnu-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
         shared_ldflag    =&gt; &quot;-shared&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
+        perl_platform    =&gt; 'Unix',
     },
     &quot;haiku-x86&quot; =&gt; {
         inherit_from     =&gt; [ &quot;haiku-common&quot;, asm(&quot;x86_elf_asm&quot;) ],
diff --git a/Configurations/90-team.norelease.conf b/Configurations/90-team.norelease.conf
index a9ab98d..7849fdb 100644
--- a/Configurations/90-team.norelease.conf
+++ b/Configurations/90-team.norelease.conf
@@ -28,7 +28,6 @@ my %targets = (
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
         shared_ldflag    =&gt; &quot;-m64&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
         multilib         =&gt; &quot;64&quot;,
     },
     &quot;debug-linux-pentium&quot; =&gt; {
@@ -77,7 +76,6 @@ my %targets = (
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
     },
     &quot;debug-test-64-clang&quot; =&gt; {
         inherit_from     =&gt; [ 'BASE_unix', &quot;x86_64_asm&quot; ],
@@ -90,7 +88,6 @@ my %targets = (
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
-        shared_extension =&gt; &quot;.so.\$(SHLIB_VERSION_NUMBER)&quot;,
     },
     &quot;darwin64-debug-test-64-clang&quot; =&gt; {
         inherit_from     =&gt; [ 'BASE_unix', &quot;x86_64_asm&quot; ],
diff --git a/Configurations/README b/Configurations/README
index 10463aa..c1f80fe 100644
--- a/Configurations/README
+++ b/Configurations/README
@@ -446,23 +446,6 @@ support building static libraries and DLLs at the same time, so using
 static libraries on Windows can only be done when configured
 'no-shared'.
 
-One some platforms, shared libraries come with a name that's different
-from their static counterpart.  That's declared as follows:
-
-    SHARED_NAME[libfoo]=cygfoo-{- $config{shlibver} -}
-
-The example is from Cygwin, which has a required naming convention.
-
-Sometimes, it makes sense to rename an output file, for example a
-library:
-
-    RENAME[libfoo]=libbar
-
-That line has &quot;libfoo&quot; renamed to &quot;libbar&quot;.  While it makes no
-sense at all to just have a rename like that (why not just use
-&quot;libbar&quot; everywhere?), it does make sense when it can be used
-conditionally.  See a little further below for an example.
-
 In some cases, it's desirable to include some source files in the
 shared form of a library only:
 
@@ -571,15 +554,6 @@ conditions based on something in the passed variables, for example:
       SOURCE[libfoo]=...
     ENDIF
 
-or:
-
-    # VMS has a cultural standard where all libraries are prefixed.
-    # For OpenSSL, the choice is 'ossl_'
-    IF[{- $config{target} =~ /^vms/ -}]
-     RENAME[libcrypto]=ossl_libcrypto
-     RENAME[libssl]=ossl_libssl
-    ENDIF
-
 
 Build-file programming with the &quot;unified&quot; build system
 ======================================================
diff --git a/Configurations/common.tmpl b/Configurations/common.tmpl
index bf440d9..9e07a6f 100644
--- a/Configurations/common.tmpl
+++ b/Configurations/common.tmpl
@@ -129,8 +129,7 @@
      return &quot;&quot; if $cache{$lib};
      unless ($disabled{shared} || $lib =~ /\.a$/) {
          my $obj2shlib = defined &amp;obj2shlib ? \&amp;obj2shlib : \&amp;libobj2shlib;
-         $OUT .= $obj2shlib-&gt;(shlib =&gt; $unified_info{sharednames}-&gt;{$lib},
-                              lib =&gt; $lib,
+         $OUT .= $obj2shlib-&gt;(lib =&gt; $lib,
                               objs =&gt; $unified_info{shared_sources}-&gt;{$lib},
                               deps =&gt; [ reducedepends(resolvedepends($lib)) ],
                               installed =&gt; is_installed($lib));
diff --git a/Configurations/descrip.mms.tmpl b/Configurations/descrip.mms.tmpl
index 2950b43..ebafcc7 100644
--- a/Configurations/descrip.mms.tmpl
+++ b/Configurations/descrip.mms.tmpl
@@ -5,12 +5,9 @@
   use File::Spec::Functions qw/:DEFAULT abs2rel rel2abs/;
   use File::Basename;
 
-  # Our prefix, claimed when speaking with the VSI folks Tuesday
-  # January 26th 2016
-  our $osslprefix = 'OSSL$';
-  (our $osslprefix_q = $osslprefix) =~ s/\$/\\\$/;
+  (our $osslprefix_q = platform-&gt;osslprefix()) =~ s/\$/\\\$/;
 
-  our $sover_dirname = sprintf &quot;%02d%02d&quot;, split(/\./, $config{shlib_version});
+  our $sover_dirname = platform-&gt;shlib_version_as_filename();
   our $osslver = sprintf &quot;%02d%02d&quot;, split(/\./, $config{version});
 
   our $sourcedir = $config{sourcedir};
@@ -44,27 +41,27 @@
   # Because we need to make two computations of these data,
   # we store them in arrays for reuse
   our @libs =
-      map { (my $x = $_) =~ s/\.a$//; $x }
+      map { platform-&gt;staticname($_) }
       @{$unified_info{libraries}};
   our @shlibs =
-      map { $unified_info{sharednames}-&gt;{$_} || () }
-      grep(!/\.a$/, @{$unified_info{libraries}});
+      map { platform-&gt;sharedname($_) // () }
+      @{$unified_info{libraries}};
   our @install_libs =
-      map { (my $x = $_) =~ s/\.a$//; $x }
+      map { platform-&gt;staticname($_) }
       @{$unified_info{install}-&gt;{libraries}};
   our @install_shlibs =
-      map { $unified_info{sharednames}-&gt;{$_} || () }
-      grep(!/\.a$/, @{$unified_info{install}-&gt;{libraries}});
+      map { platform-&gt;sharedname($_) // () }
+      @{$unified_info{install}-&gt;{libraries}};
 
   # This is a horrible hack, but is needed because recursive inclusion of files
   # in different directories does not work well with HP C.
   my $sd = sourcedir(&quot;crypto&quot;, &quot;async&quot;, &quot;arch&quot;);
   foreach (grep /\[\.crypto\.async\.arch\].*\.o$/, keys %{$unified_info{sources}}) {
-      (my $x = $_) =~ s|\.o$|.OBJ|;
-      $unified_info{before}-&gt;{$x}
+      my $obj = platform-&gt;obj($_);
+      $unified_info{before}-&gt;{$obj}
           = qq(arch_include = F\$PARSE(&quot;$sd&quot;,&quot;A.;&quot;,,,&quot;SYNTAX_ONLY&quot;) - &quot;A.;&quot;
         define arch 'arch_include');
-      $unified_info{after}-&gt;{$x}
+      $unified_info{after}-&gt;{$obj}
           = qq(deassign arch);
   }
   my $sd1 = sourcedir(&quot;ssl&quot;,&quot;record&quot;);
@@ -72,13 +69,13 @@
   my @ssl_locl_users = grep(/^\[\.(?:ssl\.(?:record|statem)|test)\].*\.o$/,
                             keys %{$unified_info{sources}});
   foreach (@ssl_locl_users) {
-      (my $x = $_) =~ s|\.o$|.OBJ|;
-      $unified_info{before}-&gt;{$x}
+      my $obj = platform-&gt;obj($_);
+      $unified_info{before}-&gt;{$obj}
           = qq(record_include = F\$PARSE(&quot;$sd1&quot;,&quot;A.;&quot;,,,&quot;SYNTAX_ONLY&quot;) - &quot;A.;&quot;
         define record 'record_include'
         statem_include = F\$PARSE(&quot;$sd2&quot;,&quot;A.;&quot;,,,&quot;SYNTAX_ONLY&quot;) - &quot;A.;&quot;
         define statem 'statem_include');
-      $unified_info{after}-&gt;{$x}
+      $unified_info{after}-&gt;{$obj}
           = qq(deassign statem
         deassign record);
   }
@@ -110,30 +107,20 @@ MINOR={- $config{minor} -}
 SHLIB_VERSION_NUMBER={- $config{shlib_version} -}
 SHLIB_TARGET={- $target{shared_target} -}
 
-EXE_EXT=.EXE
-LIB_EXT=.OLB
-SHLIB_EXT=.EXE
-OBJ_EXT=.OBJ
-DEP_EXT=.D
-
 LIBS={- join(&quot;, &quot;, map { &quot;-\n\t&quot;.$_.&quot;.OLB&quot; } @libs) -}
 SHLIBS={- join(&quot;, &quot;, map { &quot;-\n\t&quot;.$_.&quot;.EXE&quot; } @shlibs) -}
 ENGINES={- join(&quot;, &quot;, map { &quot;-\n\t&quot;.$_.&quot;.EXE&quot; } @{$unified_info{engines}}) -}
 PROGRAMS={- join(&quot;, &quot;, map { &quot;-\n\t&quot;.$_.&quot;.EXE&quot; } @{$unified_info{programs}}) -}
 SCRIPTS={- join(&quot;, &quot;, map { &quot;-\n\t&quot;.$_ } @{$unified_info{scripts}}) -}
 {- output_off() if $disabled{makedepend}; &quot;&quot; -}
-DEPS={- our @deps = map { (my $x = $_) =~ s|\.o$|\$(DEP_EXT)|; $x; }
+DEPS={- our @deps = map { platform-&gt;isobj($_) ? platform-&gt;dep($_) : $_ }
                     grep { $unified_info{sources}-&gt;{$_}-&gt;[0] =~ /\.c$/ }
                     keys %{$unified_info{sources}};
         join(&quot;, &quot;, map { &quot;-\n\t&quot;.$_ } @deps); -}
 {- output_on() if $disabled{makedepend}; &quot;&quot; -}
 GENERATED_MANDATORY={- join(&quot;, &quot;, map { &quot;-\n\t&quot;.$_ } @{$unified_info{depends}-&gt;{&quot;&quot;}} ) -}
 GENERATED={- # common0.tmpl provides @generated
-             join(&quot;, &quot;, map { my $x = $_;
-                              $x =~ s|\.[sS]$|.asm|;
-                              $x =~ s|\.ld$|.OPT|;
-                              &quot;-\n\t&quot;.$x }
-                        @generated) -}
+             join(&quot;, &quot;, map { platform-&gt;convertext($_) } @generated) -}
 
 INSTALL_LIBS={- join(&quot;, &quot;, map { &quot;-\n\t&quot;.$_.&quot;.OLB&quot; } @install_libs) -}
 INSTALL_SHLIBS={- join(&quot;, &quot;, map { &quot;-\n\t&quot;.$_.&quot;.EXE&quot; } @install_shlibs) -}
@@ -165,9 +152,9 @@ OPENSSLDIR={- catdir($config{openssldir}) or
               $config{prefix} ? catdir($config{prefix},&quot;COMMON&quot;)
                               : &quot;SYS\$COMMON:[OPENSSL-COMMON]&quot; -}
 # The same, but for C
-OPENSSLDIR_C={- $osslprefix -}DATAROOT:[000000]
+OPENSSLDIR_C={- platform-&gt;osslprefix() -}DATAROOT:[000000]
 # Where installed engines reside, for C
-ENGINESDIR_C={- $osslprefix -}ENGINES{- $sover_dirname.$target{pointer_size} -}:
+ENGINESDIR_C={- platform-&gt;osslprefix() -}ENGINES{- $sover_dirname.$target{pointer_size} -}:
 
 ##### User defined commands and flags ################################
 
@@ -694,12 +681,10 @@ reconfigure reconf :
   # Helper function to figure out dependencies on libraries
   # It takes a list of library names and outputs a list of dependencies
   sub compute_lib_depends {
-      if ($disabled{shared}) {
-          return map { $_ =~ /\.a$/ ? $`.&quot;.OLB&quot; : $_.&quot;.OLB&quot; } @_;
-      }
-      return map { $_ =~ /\.a$/
-                   ? $`.&quot;.OLB&quot;
-                   : $unified_info{sharednames}-&gt;{$_}.&quot;.EXE&quot; } @_;
+      # Depending on shared libraries:
+      # On Windows POSIX layers, we depend on {libname}.dll.a
+      # On Unix platforms, we depend on {shlibname}.so
+      return map { platform-&gt;sharedlib($_) // platform-&gt;staticlib($_) } @_;
   }
 
   # Helper function to deal with inclusion directory specs.
@@ -750,8 +735,8 @@ reconfigure reconf :
       my $generator_incs = join(&quot;&quot;, map { ' &quot;-I'.$_.'&quot;' } @{$args{generator_incs}});
       my $deps = join(&quot;, -\n\t\t&quot;, @{$args{generator_deps}}, @{$args{deps}});
 
-      if ($args{src} =~ /\.ld$/) {
-          (my $target = $args{src}) =~ s/\.ld$/.OPT/;
+      if (platform-&gt;isdef($args{src})) {
+          my $target = platform-&gt;def($args{src});
           my $mkdef = sourcefile('util', 'mkdef.pl');
           my $ord_ver = $args{intent} eq 'lib' ? ' --version $(VERSION)' : '';
           my $ord_name =
@@ -763,7 +748,7 @@ reconfigure reconf :
 $target : $args{generator}-&gt;[0] $deps $mkdef
 	\$(PERL) $mkdef$ord_ver --ordinals $args{generator}-&gt;[0] --name $ord_name &quot;--OS&quot; &quot;VMS&quot;$case_insensitive &gt; $target
 EOF
-      } elsif ($args{src} !~ /\.[sS]$/) {
+      } elsif (!platform-&gt;isasm($args{src})) {
           my $target = $args{src};
           if ($args{generator}-&gt;[0] =~ m|^.*\.in$|) {
 	      my $dofile = abs2rel(rel2abs(catfile($config{sourcedir},
@@ -781,7 +766,7 @@ $target : $args{generator}-&gt;[0] $deps
 EOF
 	  }
       } else {
-          (my $target = $args{src}) =~ s/\.[sS]$/.asm/;
+          my $target = platform-&gt;asm($args{src});
           if ($args{generator}-&gt;[0] =~ /\.pl$/) {
               $generator = '$(PERL)'.$generator_incs.' '.$generator;
           } elsif ($args{generator}-&gt;[0] =~ /\.S$/) {
@@ -844,9 +829,8 @@ EOF
 
   sub src2obj {
       my %args = @_;
-      my @srcs = map { (my $x = $_) =~ s/\.s$/.asm/; $x
-                     } ( @{$args{srcs}} );
-      (my $obj = $args{obj}) =~ s|\.o$||;
+      my @srcs = map { (my $x = $_) =~ s/\.s$/.asm/; $x } ( @{$args{srcs}} );
+      my $obj = platform-&gt;obj($args{obj});
       my $deps = join(&quot;, -\n\t\t&quot;, @srcs, @{$args{deps}});
 
       # Because VMS C isn't very good at combining a /INCLUDE path with
@@ -858,11 +842,25 @@ EOF
       my $forward = dirname($args{srcs}-&gt;[0]);
       my $backward = abs2rel(rel2abs(&quot;.&quot;), rel2abs($forward));
       my $objd = abs2rel(rel2abs(dirname($obj)), rel2abs($forward));
-      my $objn = basename($obj);
+      my $objn = basename($obj, platform-&gt;objext());
       my $srcs =
           join(&quot;, &quot;, map { abs2rel(rel2abs($_), rel2abs($forward)) } @srcs);
-      my $before = $unified_info{before}-&gt;{$obj.&quot;.OBJ&quot;} || &quot;\@ !&quot;;
-      my $after = $unified_info{after}-&gt;{$obj.&quot;.OBJ&quot;} || &quot;\@ !&quot;;
+      my $before = $unified_info{before}-&gt;{$obj} || &quot;\@ !&quot;;
+      my $after = $unified_info{after}-&gt;{$obj} || &quot;\@ !&quot;;
+
+      if ($srcs[0] =~ /\.asm$/) {
+          my $asflags = { shlib =&gt; ' $(LIB_ASFLAGS)',
+		          lib =&gt; ' $(LIB_ASFLAGS)',
+		          dso =&gt; ' $(DSO_ASFLAGS)',
+		          bin =&gt; ' $(BIN_ASFLAGS)' } -&gt; {$args{intent}};
+          return &lt;&lt;&quot;EOF&quot;;
+$obj : $deps
+        ${before}
+        SET DEFAULT $forward
+        \$(AS) $asflags \$(ASOUTFLAG)${objd}${objn}.OBJ $srcs
+        SET DEFAULT $backward
+EOF
+      }
 
       my $cflags;
       if ($args{installed}) {
@@ -928,10 +926,10 @@ EOF
       }
 
       my $depbuild = $disabled{makedepend} ? &quot;&quot;
-          : &quot; /MMS=(FILE=${objd}${objn}.D,TARGET=$obj.OBJ)&quot;;
+          : &quot; /MMS=(FILE=${objd}${objn}.D,TARGET=$obj)&quot;;
 
       return &lt;&lt;&quot;EOF&quot;;
-$obj.OBJ : $deps
+$obj : $deps
         ${before}
         SET DEFAULT $forward
         \@ $incs_on
@@ -941,20 +939,18 @@ $obj.OBJ : $deps
         \@ $incs_off
         SET DEFAULT $backward
         ${after}
-        - PURGE $obj.OBJ
+        - PURGE $obj
 EOF
   }
   sub obj2shlib {
       my %args = @_;
-      my $lib = $args{lib};
-      my $shlib = $args{shlib};
-      my $libd = dirname($lib);
-      my $libn = basename($lib);
-      my @objs = map { (my $x = $_) =~ s|\.o$|.OBJ|; $x }
-                 grep { $_ =~ m|\.o$| }
+      my $shlibname = platform-&gt;sharedname($args{lib});
+      my $shlib = platform-&gt;sharedlib($args{lib});
+      my @objs = map { platform-&gt;convertext($_) }
+                 grep { platform-&gt;isobj($_) }
                  @{$args{objs}};
-      my @defs = map { (my $x = $_) =~ s|\.ld$|.OPT|; $x }
-                 grep { $_ =~ m|\.ld$| }
+      my @defs = map { platform-&gt;convertext($_) }
+                 grep { platform-&gt;isdef($_) }
                  @{$args{objs}};
       my @deps = compute_lib_depends(@{$args{deps}});
       die &quot;More than one symbol vector&quot; if scalar @defs &gt; 1;
@@ -978,16 +974,16 @@ EOF
                              &quot;WRITE OPT_FILE \&quot;$x\&quot;&quot; } @deps)
           || &quot;\@ !&quot;;
       return &lt;&lt;&quot;EOF&quot;
-$shlib.EXE : $deps
+$shlib : $deps
         \$(PERL) $translatesyms_pl \$(BLDDIR)CXX\$DEMANGLER_DB. &lt; $defs[0] &gt; $defs[0]-translated
-        OPEN/WRITE/SHARE=READ OPT_FILE $lib-components.OPT
+        OPEN/WRITE/SHARE=READ OPT_FILE $shlibname-components.OPT
         $write_opt1
         $write_opt2
         CLOSE OPT_FILE
         LINK \$(LIB_LDFLAGS)/SHARE=\$\@ $defs[0]-translated/OPT,-
-                $lib-components.OPT/OPT \$(LIB_EX_LIBS)
-        DELETE $defs[0]-translated;*,$lib-components.OPT;*
-        PURGE $shlib.EXE,$shlib.MAP
+                $shlibname-components.OPT/OPT \$(LIB_EX_LIBS)
+        DELETE $defs[0]-translated;*,$shlibname-components.OPT;*
+        PURGE $shlibname.EXE,$shlibname.MAP
 EOF
         . ($config{target} =~ m|alpha| ? &quot;&quot; : &lt;&lt;&quot;EOF&quot;
         SET IMAGE/FLAGS=(NOCALL_DEBUG) \$\@
@@ -996,15 +992,13 @@ EOF
   }
   sub obj2dso {
       my %args = @_;
-      my $lib = $args{lib};
-      my $libd = dirname($lib);
-      my $libn = basename($lib);
-      (my $libn_nolib = $libn) =~ s/^lib//;
-      my @objs = map { (my $x = $_) =~ s|\.o$|.OBJ|; $x }
-                 grep { $_ =~ m|\.o$| }
+      my $dsoname = platform-&gt;dsoname($args{lib});
+      my $dso = platform-&gt;dso($args{lib});
+      my @objs = map { platform-&gt;convertext($_) }
+                 grep { platform-&gt;isobj($_) }
                  @{$args{objs}};
-      my @defs = map { (my $x = $_) =~ s|\.ld$|.OPT|; $x }
-                 grep { $_ =~ m|\.ld$| }
+      my @defs = map { platform-&gt;convertext($_) }
+                 grep { platform-&gt;isdef($_) }
                  @{$args{objs}};
       my @deps = compute_lib_depends(@{$args{deps}});
       my $deps = join(&quot;, -\n\t\t&quot;, @objs, @defs, @deps);
@@ -1025,14 +1019,14 @@ EOF
                              &quot;WRITE OPT_FILE \&quot;$x\&quot;&quot; } @deps)
           || &quot;\@ !&quot;;
       return &lt;&lt;&quot;EOF&quot;
-$lib.EXE : $deps
-        OPEN/WRITE/SHARE=READ OPT_FILE $lib-components.OPT
+$dso : $deps
+        OPEN/WRITE/SHARE=READ OPT_FILE $dsoname-components.OPT
         $write_opt1
         $write_opt2
         CLOSE OPT_FILE
         LINK \$(DSO_LDFLAGS)/SHARE=\$\@ $defs[0]/OPT,-
-		$lib-components.OPT/OPT \$(DSO_EX_LIBS)
-        - PURGE $lib.EXE,$lib.OPT,$lib.MAP
+		$dsoname-components.OPT/OPT \$(DSO_EX_LIBS)
+        - PURGE $dsoname.EXE,$dsoname.OPT,$dsoname.MAP
 EOF
         . ($config{target} =~ m|alpha| ? &quot;&quot; : &lt;&lt;&quot;EOF&quot;
         SET IMAGE/FLAGS=(NOCALL_DEBUG) \$\@
@@ -1041,24 +1035,26 @@ EOF
   }
   sub obj2lib {
       my %args = @_;
-      (my $lib = $args{lib}) =~ s/\.a$//;
-      my @objs = map { (my $x = $_) =~ s|\.o$|.OBJ|; $x } @{$args{objs}};
+      my $lib = platform-&gt;staticlib($args{lib});
+      my @objs = map { platform-&gt;convertext($_) }
+                 grep { platform-&gt;isobj($_) }
+                 @{$args{objs}};
       my $objs = join(&quot;, -\n\t\t&quot;, @objs);
-      my $fill_lib = join(&quot;\n\t&quot;, (map { &quot;LIBRARY/REPLACE $lib.OLB $_&quot; }
-                                   @objs));
+      my $fill_lib = join(&quot;\n\t&quot;, (map { &quot;LIBRARY/REPLACE $lib $_&quot; } @objs));
       return &lt;&lt;&quot;EOF&quot;;
-$lib.OLB : $objs
-        LIBRARY/CREATE/OBJECT $lib.OLB
+$lib : $objs
+        LIBRARY/CREATE/OBJECT $lib
         $fill_lib
-        - PURGE $lib.OLB
+        - PURGE $lib
 EOF
   }
   sub obj2bin {
       my %args = @_;
-      my $bin = $args{bin};
-      my $bind = dirname($bin);
-      my $binn = basename($bin);
-      my @objs = map { (my $x = $_) =~ s|\.o$|.OBJ|; $x } @{$args{objs}};
+      my $bin = platform-&gt;bin($args{bin});
+      my $binname = platform-&gt;binname($args{bin});
+      my @objs = map { platform-&gt;convertext($_) }
+                 grep { platform-&gt;isobj($_) }
+                 @{$args{objs}};
       my $objs = join(&quot;,&quot;, @objs);
       my @deps = compute_lib_depends(@{$args{deps}});
       my $deps = join(&quot;, -\n\t\t&quot;, @objs, @deps);
@@ -1113,19 +1109,19 @@ EOF
       # isn't necessary.  If there are other warnings, however, we show them
       # and let it break the build.
       return &lt;&lt;&quot;EOF&quot;
-$bin.EXE : $deps
+$bin : $deps
         $analyse_objs
-        @ OPEN/WRITE/SHARE=READ OPT_FILE $bin.OPT
+        @ OPEN/WRITE/SHARE=READ OPT_FILE $binname.OPT
         $write_opt1
         $write_opt2
         @ CLOSE OPT_FILE
-        TYPE $bin.opt ! For debugging
-        - pipe SPAWN/WAIT/NOLOG/OUT=$bin.LINKLOG -
-                    LINK \$(BIN_LDFLAGS)/EXEC=\$\@ $bin.OPT/OPT \$(BIN_EX_LIBS) ; -
+        TYPE $binname.OPT ! For debugging
+        - pipe SPAWN/WAIT/NOLOG/OUT=$binname.LINKLOG -
+                    LINK \$(BIN_LDFLAGS)/EXEC=\$\@ $binname.OPT/OPT \$(BIN_EX_LIBS) ; -
                link_status = \$status ; link_severity = link_status .AND. 7
         @ search_severity = 1
         -@ IF link_severity .EQ. 0 THEN -
-                pipe SEARCH $bin.LINKLOG &quot;%&quot;,&quot;-&quot;/MATCH=AND | -
+                pipe SEARCH $binname.LINKLOG &quot;%&quot;,&quot;-&quot;/MATCH=AND | -
                      SPAWN/WAIT/NOLOG/OUT=NLA0: -
                           SEARCH SYS\$INPUT: &quot;-W-MULDEF,&quot;/MATCH=NOR ; -
                      search_severity = \$severity
@@ -1136,10 +1132,10 @@ $bin.EXE : $deps
         @ IF search_severity .EQ. 3 THEN link_severity = 1
         @ ! At this point, if link_severity shows that there was a fault
         @ ! or warning, make sure to restore the linking status.
-        -@ IF .NOT. link_severity THEN TYPE $bin.LINKLOG
-        -@ DELETE $bin.LINKLOG;*
+        -@ IF .NOT. link_severity THEN TYPE $binname.LINKLOG
+        -@ DELETE $binname.LINKLOG;*
         @ IF .NOT. link_severity THEN SPAWN/WAIT/NOLOG EXIT 'link_status'
-        - PURGE $bin.EXE,$bin.OPT
+        - PURGE $bin,$binname.OPT
 EOF
       . ($config{target} =~ m|alpha| ? &quot;&quot; : &lt;&lt;&quot;EOF&quot;
         SET IMAGE/FLAGS=(NOCALL_DEBUG) \$\@
diff --git a/Configurations/platform.pm b/Configurations/platform.pm
new file mode 100644
index 0000000..909da0a
--- /dev/null
+++ b/Configurations/platform.pm
@@ -0,0 +1,18 @@
+package platform;
+
+use strict;
+use warnings;
+use vars qw(@ISA);
+
+# Callers must make sure @INC has the build directory
+use configdata;
+
+my $module = $target{perl_platform} || 'Unix';
+(my $module_path = $module) =~ s|::|/|g;
+
+require &quot;platform/$module_path.pm&quot;;
<A HREF="../../../mailman/listinfo/openssl-commits.html">+ at ISA</A> = (&quot;platform::$module&quot;);
+
+1;
+
+__END__
diff --git a/Configurations/platform/BASE.pm b/Configurations/platform/BASE.pm
new file mode 100644
index 0000000..b7fec11
--- /dev/null
+++ b/Configurations/platform/BASE.pm
@@ -0,0 +1,96 @@
+package platform::BASE;
+
+use strict;
+use warnings;
+use Carp;
+
+# Assume someone set @INC right before loading this module
+use configdata;
+
+# Globally defined &quot;platform specific&quot; extensions, available for uniformity
+sub depext      { '.d' }
+
+# Functions to convert internal file representations to platform specific
+# ones.  Note that these all depend on extension functions that MUST be
+# defined per platform.
+#
+# Currently known internal or semi-internal extensions are:
+#
+# .a            For libraries that are made static only.
+#               Internal libraries only.
+# .o            For object files.
+# .s, .S        Assembler files.  This is an actual extension on Unix
+# .res          Resource file.  This is an actual extension on Windows
+
+sub binname     { return $_[1] } # Name of executable binary
+sub dsoname     { return $_[1] } # Name of dynamic shared object (DSO)
+sub sharedname  { return __isshared($_[1]) ? $_[1] : undef } # Name of shared lib
+sub staticname  { return __base($_[1], '.a') } # Name of static lib
+
+# Convenience function to convert the shlib version to an acceptable part
+# of a file or directory name.
+sub shlib_version_as_filename { return $_[1] }
+
+# Convenience functions to convert the possible extension of an input file name
+sub bin         { return $_[0]-&gt;binname($_[1]) . $_[0]-&gt;binext() }
+sub dso         { return $_[0]-&gt;dsoname($_[1]) . $_[0]-&gt;dsoext() }
+sub sharedlib   { return __concat($_[0]-&gt;sharedname($_[1]), $_[0]-&gt;shlibext()) }
+sub staticlib   { return $_[0]-&gt;staticname($_[1]) . $_[0]-&gt;libext() }
+
+# More convenience functions for intermediary files
+sub def         { return __base($_[1], '.ld') . $_[0]-&gt;defext() }
+sub obj         { return __base($_[1], '.o') . $_[0]-&gt;objext() }
+sub res         { return __base($_[1], '.res') . $_[0]-&gt;resext() }
+sub dep         { return __base($_[1], '.o') . $_[0]-&gt;depext() } # &lt;- objname
+sub asm         { return __base($_[1], '.S', '.s') . $_[0]-&gt;asmext() }
+
+# Another set of convenience functions for standard checks of certain
+# internal extensions and conversion from internal to platform specific
+# extension.  Note that the latter doesn't deal with libraries because
+# of ambivalence
+sub isdef       { return $_[1] =~ m|\.ld$|;   }
+sub isobj       { return $_[1] =~ m|\.o$|;    }
+sub isres       { return $_[1] =~ m|\.res$|;  }
+sub isasm       { return $_[1] =~ m|\.[Ss]$|; }
+sub convertext {
+    if ($_[0]-&gt;isdef($_[1]))    { return $_[0]-&gt;def($_[1]); }
+    if ($_[0]-&gt;isobj($_[1]))    { return $_[0]-&gt;obj($_[1]); }
+    if ($_[0]-&gt;isres($_[1]))    { return $_[0]-&gt;res($_[1]); }
+    if ($_[0]-&gt;isasm($_[1]))    { return $_[0]-&gt;asm($_[1]); }
+    return $_[1];
+}
+
+# Helpers ############################################################
+
+# __base EXPR, LIST
+# This returns the given path (EXPR) with the matching suffix from LIST stripped
+sub __base {
+    my $path = shift;
+    foreach (@_) {
+        if ($path =~ m|\Q${_}\E$|) {
+            return $`;
+        }
+    }
+    return $path;
+}
+
+# __isshared EXPR
+# EXPR is supposed to be a library name.  This will return true if that library
+# can be assumed to be a shared library, otherwise false
+sub __isshared {
+    return !($disabled{shared} || $_[0] =~ /\.a$/);
+}
+
+# __concat LIST
+# Returns the concatenation of all elements of LIST if none of them is
+# undefined.  If one of them is undefined, returns undef instead.
+sub __concat {
+    my $result = '';
+    foreach (@_) {
+        return undef unless defined $_;
+        $result .= $_;
+    }
+    return $result;
+}
+
+1;
diff --git a/Configurations/platform/Cygwin.pm b/Configurations/platform/Cygwin.pm
new file mode 100644
index 0000000..bc62e9d
--- /dev/null
+++ b/Configurations/platform/Cygwin.pm
@@ -0,0 +1,22 @@
+package platform::Cygwin;
+
+use strict;
+use warnings;
+use Carp;
+
+use vars qw(@ISA);
+
+require platform::mingw;
<A HREF="../../../mailman/listinfo/openssl-commits.html">+ at ISA</A> = qw(platform::mingw);
+
+# Assume someone set @INC right before loading this module
+use configdata;
+
+sub sharedname {
+    my $class = shift;
+    my $lib = platform::mingw-&gt;sharedname(@_);
+    $lib =~ s|^lib|cyg| if defined $lib;
+    return $lib;
+}
+
+1;
diff --git a/Configurations/platform/Unix.pm b/Configurations/platform/Unix.pm
new file mode 100644
index 0000000..7f69cac
--- /dev/null
+++ b/Configurations/platform/Unix.pm
@@ -0,0 +1,70 @@
+package platform::Unix;
+
+use strict;
+use warnings;
+use Carp;
+
+use vars qw(@ISA);
+
+require platform::BASE;
<A HREF="../../../mailman/listinfo/openssl-commits.html">+ at ISA</A> = qw(platform::BASE);
+
+# Assume someone set @INC right before loading this module
+use configdata;
+
+sub binext              { $target{exe_extension} || '' }
+sub dsoext              { $target{dso_extension} || '.so' }
+# Because these are also used in scripts and not just Makefile, we must
+# convert $(SHLIB_VERSION_NUMBER) to the actual number.
+sub shlibext            { (my $x = $target{shared_extension}
+                               || '.so.$(SHLIB_VERSION_NUMBER)')
+                              =~ s|\.\$\(SHLIB_VERSION_NUMBER\)
+                                  |.$config{shlib_version}|x;
+                          $x; }
+sub libext              { $target{lib_extension} || '.a' }
+sub defext              { $target{def_extension} || '.ld' }
+sub objext              { $target{obj_extension} || '.o' }
+sub depext              { $target{obj_extension} || '.d' }
+
+# Other extra that aren't defined in platform::BASE
+sub shlibextsimple      { (my $x = $target{shared_extension} || '.so')
+                              =~ s|\.\$\(SHLIB_VERSION_NUMBER\)||;
+                          $x; }
+sub shlibvariant        { $target{shlib_variant} || &quot;&quot; }
+sub makedepprog         { $disabled{makedepend} ? undef : $config{makedepprog} }
+
+# No conversion of assembler extension on Unix
+sub asm {
+    return $_[1];
+}
+
+# At some point, we might decide that static libraries are called something
+# other than the default...
+sub staticname {
+    # Non-installed libraries are *always* static, and their names remain
+    # the same, except for the mandatory extension
+    my $in_libname = platform::BASE-&gt;staticname($_[1]);
+    return $in_libname
+        unless ( grep { platform::BASE-&gt;staticname($_) eq $in_libname }
+                 @{$unified_info{install}-&gt;{libraries}} );
+
+    # We currently return the same name anyway...  but we might choose to
+    # append '_static' or '_a' some time in the future.
+    return platform::BASE-&gt;staticname($_[1]);
+}
+
+sub sharedname {
+    return platform::BASE::__concat(platform::BASE-&gt;sharedname($_[1]),
+                                    ($_[0]-&gt;shlibvariant() // ''));
+}
+
+sub sharedname_simple {
+    return platform::BASE::__isshared($_[1]) ? $_[1] : undef;
+}
+
+sub sharedlib_simple {
+    return platform::BASE::__concat($_[0]-&gt;sharedname_simple($_[1]),
+                                    $_[0]-&gt;shlibextsimple());
+}
+
+1;
diff --git a/Configurations/platform/VMS.pm b/Configurations/platform/VMS.pm
new file mode 100644
index 0000000..03e57e3
--- /dev/null
+++ b/Configurations/platform/VMS.pm
@@ -0,0 +1,66 @@
+package platform::VMS;
+
+use strict;
+use warnings;
+use Carp;
+
+use vars qw(@ISA);
+
+require platform::BASE;
<A HREF="../../../mailman/listinfo/openssl-commits.html">+ at ISA</A> = qw(platform::BASE);
+
+# Assume someone set @INC right before loading this module
+use configdata;
+
+# VMS has a cultural standard where all installed libraries are prefixed.
+# For OpenSSL, the choice is 'ossl$' (this prefix was claimed in a
+# conversation with VSI, Tuesday January 26 2016)
+sub osslprefix          { 'OSSL$' }
+
+sub binext              { '.EXE' }
+sub dsoext              { '.EXE' }
+sub shlibext            { '.EXE' }
+sub libext              { '.OLB' }
+sub defext              { '.OPT' }
+sub objext              { '.OBJ' }
+sub depext              { '.D' }
+sub asmext              { '.ASM' }
+
+# Other extra that aren't defined in platform::BASE
+sub shlibvariant        { $target{shlib_variant} || '' }
+
+sub optext              { '.OPT' }
+sub optname             { return $_[1] }
+sub opt                 { return $_[0]-&gt;optname($_[1]) . $_[0]-&gt;optext() }
+
+# Other projects include the pointer size in the name of installed libraries,
+# so we do too.
+sub staticname {
+    # Non-installed libraries are *always* static, and their names remain
+    # the same, except for the mandatory extension
+    my $in_libname = platform::BASE-&gt;staticname($_[1]);
+    return $in_libname
+        unless ( grep { platform::BASE-&gt;staticname($_) eq $in_libname }
+                 @{$unified_info{install}-&gt;{libraries}} );
+
+    return platform::BASE::__concat($_[0]-&gt;osslprefix(),
+                                    platform::BASE-&gt;staticname($_[1]),
+                                    $target{pointer_size});
+}
+
+# To enable installation of multiple major OpenSSL releases, we include the
+# version number in installed shared library names.
+my $sover_filename =
+    join('', map { sprintf &quot;%02d&quot;, $_ } split(m|\.|, $config{shlib_version}));
+sub shlib_version_as_filename {
+    return $sover_filename;
+}
+sub sharedname {
+    return platform::BASE::__concat($_[0]-&gt;osslprefix(),
+                                    platform::BASE-&gt;sharedname($_[1]),
+                                    $_[0]-&gt;shlib_version_as_filename(),
+                                    ($_[0]-&gt;shlibvariant() // ''),
+                                    &quot;_shr$target{pointer_size}&quot;);
+}
+
+1;
diff --git a/Configurations/platform/Windows.pm b/Configurations/platform/Windows.pm
new file mode 100644
index 0000000..3e13f6e
--- /dev/null
+++ b/Configurations/platform/Windows.pm
@@ -0,0 +1,65 @@
+package platform::Windows;
+
+use strict;
+use warnings;
+use Carp;
+
+use vars qw(@ISA);
+
+require platform::BASE;
<A HREF="../../../mailman/listinfo/openssl-commits.html">+ at ISA</A> = qw(platform::BASE);
+
+# Assume someone set @INC right before loading this module
+use configdata;
+
+sub binext              { '.exe' }
+sub dsoext              { '.dll' }
+sub shlibext            { '.dll' }
+sub libext              { '.lib' }
+sub defext              { '.def' }
+sub objext              { '.obj' }
+sub depext              { '.d' }
+sub asmext              { '.asm' }
+
+# Other extra that aren't defined in platform::BASE
+sub resext              { '.res' }
+sub shlibextimport      { '.lib' }
+sub shlibvariant        { $target{shlib_variant} || '' }
+
+sub staticname {
+    # Non-installed libraries are *always* static, and their names remain
+    # the same, except for the mandatory extension
+    my $in_libname = platform::BASE-&gt;staticname($_[1]);
+    return $in_libname
+        unless ( grep { platform::BASE-&gt;staticname($_) eq $in_libname }
+                 @{$unified_info{install}-&gt;{libraries}} );
+
+    # To make sure not to clash with an import library, we make the static
+    # variant of our installed libraries get '_static' added to their names.
+    return platform::BASE-&gt;staticname($_[1])
+        . ($disabled{shared} ? '' : '_static');
+}
+
+# To mark forward compatibility, we include the OpenSSL major release version
+# number in the installed shared library names.
+(my $sover_filename = $config{shlib_version}) =~ s|\.|_|g;
+sub shlib_version_as_filename {
+    return $sover_filename
+}
+sub sharedname {
+    return platform::BASE::__concat(platform::BASE-&gt;sharedname($_[1]),
+                                    &quot;-&quot;,
+                                    $_[0]-&gt;shlib_version_as_filename(),
+                                    ($_[0]-&gt;shlibvariant() // ''));
+}
+
+sub sharedname_import {
+    return platform::BASE::__isshared($_[1]) ? $_[1] : undef;
+}
+
+sub sharedlib_import {
+    return platform::BASE::__concat($_[0]-&gt;sharedname_import($_[1]),
+                                    $_[0]-&gt;shlibextimport());
+}
+
+1;
diff --git a/Configurations/platform/Windows/MSVC.pm b/Configurations/platform/Windows/MSVC.pm
new file mode 100644
index 0000000..6109749
--- /dev/null
+++ b/Configurations/platform/Windows/MSVC.pm
@@ -0,0 +1,33 @@
+package platform::Windows::MSVC;
+
+use strict;
+use warnings;
+use Carp;
+
+use vars qw(@ISA);
+
+require platform::Windows;
<A HREF="../../../mailman/listinfo/openssl-commits.html">+ at ISA</A> = qw(platform::Windows);
+
+# Assume someone set @INC right before loading this module
+use configdata;
+
+sub pdbext              { '.pdb' }
+
+sub staticlibpdb {
+    return platform::BASE::__concat($_[0]-&gt;staticname($_[1]), $_[0]-&gt;pdbext());
+}
+
+sub sharedlibpdb {
+    return platform::BASE::__concat($_[0]-&gt;sharedname($_[1]), $_[0]-&gt;pdbext());
+}
+
+sub dsopdb {
+    return platform::BASE::__concat($_[0]-&gt;dsoname($_[1]), $_[0]-&gt;pdbext());
+}
+
+sub binpdb {
+    return platform::BASE::__concat($_[0]-&gt;binname($_[1]), $_[0]-&gt;pdbext());
+}
+
+1;
diff --git a/Configurations/platform/mingw.pm b/Configurations/platform/mingw.pm
new file mode 100644
index 0000000..5788a36
--- /dev/null
+++ b/Configurations/platform/mingw.pm
@@ -0,0 +1,45 @@
+package platform::mingw;
+
+use strict;
+use warnings;
+use Carp;
+
+use vars qw(@ISA);
+
+require platform::Unix;
<A HREF="../../../mailman/listinfo/openssl-commits.html">+ at ISA</A> = qw(platform::Unix);
+
+# Assume someone set @INC right before loading this module
+use configdata;
+
+sub binext              { '.exe' }
+sub objext              { '.obj' }
+sub libext              { '.a' }
+sub dsoext              { '.dll' }
+sub defext              { '.def' }
+sub shlibext            { '.dll' }
+sub shlibextimport      { $target{shared_import_extension} || '.dll.a' }
+sub shlibextsimple      { undef }
+sub makedepprog         { $disabled{makedepend} ? undef : $config{makedepprog} }
+
+(my $sover_filename = $config{shlib_version}) =~ s|\.|_|g;
+sub shlib_version_as_filename {
+    return $sover_filename;
+}
+sub sharedname {
+    return platform::BASE::__concat(platform::BASE-&gt;sharedname($_[1]),
+                                    &quot;-&quot;,
+                                    $_[0]-&gt;shlib_version_as_filename(),
+                                    ($config{target} eq &quot;mingw64&quot;
+                                         ? &quot;-x64&quot; : &quot;&quot;));
+}
+
+# With Mingw and other DLL producers, there isn't really any &quot;simpler&quot;
+# shared library name.  However, there is a static import library, so
+# we return that instead.
+sub sharedlib_simple {
+    return platform::BASE::__concat(platform::BASE-&gt;sharedname($_[1]),
+                                    $_[0]-&gt;shlibextimport());
+}
+
+1;
diff --git a/Configurations/unix-Makefile.tmpl b/Configurations/unix-Makefile.tmpl
index 11fecc2..4c76b8d 100644
--- a/Configurations/unix-Makefile.tmpl
+++ b/Configurations/unix-Makefile.tmpl
@@ -3,17 +3,7 @@
 ##
 ## {- join(&quot;\n## &quot;, @autowarntext) -}
 {-
-     our $objext = $target{obj_extension} || &quot;.o&quot;;
-     our $defext = $target{def_extension} || &quot;.ld&quot;;
-     our $depext = $target{dep_extension} || &quot;.d&quot;;
-     our $exeext = $target{exe_extension} || &quot;&quot;;
-     our $libext = $target{lib_extension} || &quot;.a&quot;;
-     our $shlibext = $target{shared_extension} || &quot;.so&quot;;
-     our $shlibvariant = $target{shlib_variant} || &quot;&quot;;
-     our $shlibextsimple = $target{shared_extension_simple} || &quot;.so&quot;;
-     our $shlibextimport = $target{shared_import_extension} || &quot;&quot;;
-     our $dsoext = $target{dso_extension} || &quot;.so&quot;;
-     our $makedepprog = $disabled{makedepend} ? undef : $config{makedepprog};
+     our $makedepprog = platform-&gt;makedepprog();
 
      sub windowsdll { $config{target} =~ /^(?:Cygwin|mingw)/ }
 
@@ -21,58 +11,8 @@
      # libcrypto.a and use libcrypto_a.a as static one.
      sub sharedaix  { !$disabled{shared} &amp;&amp; $config{target} =~ /^aix/ }
 
-     our $sover_dirname = $config{shlib_version};
-     $sover_dirname =~ s|\.|_|g
-         if $config{target} =~ /^mingw/;
-
-     # shlib and shlib_simple both take a static library name and figure
-     # out what the shlib name should be.
-     #
-     # When OpenSSL is configured &quot;no-shared&quot;, these functions will just
-     # return empty lists, making them suitable to join().
-     #
-     # With Windows DLL producers, shlib($libname) will return the shared
-     # library name (which usually is different from the static library
-     # name) with the default shared extension appended to it, while
-     # shlib_simple($libname) will return the static library name with
-     # the shared extension followed by &quot;.a&quot; appended to it.  The former
-     # result is used as the runtime shared library while the latter is
-     # used as the DLL import library.
-     #
-     # On all Unix systems, shlib($libname) will return the library name
-     # with the default shared extension, while shlib_simple($libname)
-     # will return the name from shlib($libname) with any SO version number
-     # removed.  On some systems, they may therefore return the exact same
-     # string.
-     sub shlib {
-         my $lib = shift;
-         return () if $disabled{shared} || $lib =~ /\.a$/;
-         return $unified_info{sharednames}-&gt;{$lib}. $shlibvariant. '$(SHLIB_EXT)';
-     }
-     sub shlib_simple {
-         my $lib = shift;
-         return () if $disabled{shared} || $lib =~ /\.a$/;
-
-         if (windowsdll()) {
-             return $lib . '$(SHLIB_EXT_IMPORT)';
-         }
-         return $lib .  '$(SHLIB_EXT_SIMPLE)';
-     }
-
-     # Easy fixing of static library names
-     sub lib {
-         (my $lib = shift) =~ s/\.a$//;
-         return $lib . $libext;
-     }
+     our $sover_dirname = platform-&gt;shlib_version_as_filename();
 
-     # dso is a complement to shlib / shlib_simple that returns the
-     # given libname with the simple shared extension (possible SO version
-     # removed).  This differs from shlib_simple() by being unconditional.
-     sub dso {
-         my $engine = shift;
-
-         return $engine . $dsoext;
-     }
      # This makes sure things get built in the order they need
      # to. You're welcome.
      sub dependmagic {
@@ -93,33 +33,33 @@ MAJOR={- $config{major} -}
 MINOR={- $config{minor} -}
 SHLIB_VERSION_NUMBER={- $config{shlib_version} -}
 SHLIB_TARGET={- $target{shared_target} -}
-SHLIB_EXT={- $shlibext -}
-SHLIB_EXT_SIMPLE={- $shlibextsimple -}
-SHLIB_EXT_IMPORT={- $shlibextimport -}
-
-LIBS={- join(&quot; &quot;, map { lib($_) } @{$unified_info{libraries}}) -}
-SHLIBS={- join(&quot; &quot;, map { shlib($_) } @{$unified_info{libraries}}) -}
-SHLIB_INFO={- join(&quot; &quot;, map { &quot;\&quot;&quot;.shlib($_).&quot;;&quot;.shlib_simple($_).&quot;\&quot;&quot; } @{$unified_info{libraries}}) -}
-ENGINES={- join(&quot; &quot;, map { dso($_) } @{$unified_info{engines}}) -}
-PROGRAMS={- join(&quot; &quot;, map { $_.$exeext } @{$unified_info{programs}}) -}
+
+LIBS={- join(&quot; &quot;, map { platform-&gt;staticlib($_) // () } @{$unified_info{libraries}}) -}
+SHLIBS={- join(&quot; &quot;, map { platform-&gt;sharedlib($_) // () } @{$unified_info{libraries}}) -}
+SHLIB_INFO={- join(&quot; &quot;, map { my $x = platform-&gt;sharedlib($_);
+                              my $y = platform-&gt;sharedlib_simple($_);
+                              $x ? &quot;\&quot;$x;$y\&quot;&quot; : () }
+                        @{$unified_info{libraries}}) -}
+ENGINES={- join(&quot; &quot;, map { platform-&gt;dso($_) } @{$unified_info{engines}}) -}
+PROGRAMS={- join(&quot; &quot;, map { platform-&gt;bin($_) } @{$unified_info{programs}}) -}
 SCRIPTS={- join(&quot; &quot;, @{$unified_info{scripts}}) -}
 {- output_off() if $disabled{makedepend}; &quot;&quot; -}
-DEPS={- join(&quot; &quot;, map { (my $x = $_) =~ s|\.o$|$depext|; $x; }
+DEPS={- join(&quot; &quot;, map { platform-&gt;isobj($_) ? platform-&gt;dep($_) : () }
                   grep { $unified_info{sources}-&gt;{$_}-&gt;[0] =~ /\.c$/ }
                   keys %{$unified_info{sources}}); -}
 {- output_on() if $disabled{makedepend}; &quot;&quot; -}
 GENERATED_MANDATORY={- join(&quot; &quot;, @{$unified_info{depends}-&gt;{&quot;&quot;}}) -}
 GENERATED={- # common0.tmpl provides @generated
-             join(&quot; &quot;, map { my $x = $_;
-                             $x =~ s|\.ld$|$defext|;
-                             $x }
-                       @generated ) -}
-
-INSTALL_LIBS={- join(&quot; &quot;, map { lib($_) } @{$unified_info{install}-&gt;{libraries}}) -}
-INSTALL_SHLIBS={- join(&quot; &quot;, map { shlib($_) } @{$unified_info{install}-&gt;{libraries}}) -}
-INSTALL_SHLIB_INFO={- join(&quot; &quot;, map { &quot;\&quot;&quot;.shlib($_).&quot;;&quot;.shlib_simple($_).&quot;\&quot;&quot; } @{$unified_info{install}-&gt;{libraries}}) -}
-INSTALL_ENGINES={- join(&quot; &quot;, map { dso($_) } @{$unified_info{install}-&gt;{engines}}) -}
-INSTALL_PROGRAMS={- join(&quot; &quot;, map { $_.$exeext } @{$unified_info{install}-&gt;{programs}}) -}
+             join(&quot; &quot;, map { platform-&gt;convertext($_) } @generated ) -}
+
+INSTALL_LIBS={- join(&quot; &quot;, map { platform-&gt;staticlib($_) // () } @{$unified_info{install}-&gt;{libraries}}) -}
+INSTALL_SHLIBS={- join(&quot; &quot;, map { platform-&gt;sharedlib($_) // () } @{$unified_info{install}-&gt;{libraries}}) -}
+INSTALL_SHLIB_INFO={- join(&quot; &quot;, map { my $x = platform-&gt;sharedlib($_);
+                                      my $y = platform-&gt;sharedlib_simple($_);
+                                      $x ? &quot;\&quot;$x;$y\&quot;&quot; : () }
+                                @{$unified_info{install}-&gt;{libraries}}) -}
+INSTALL_ENGINES={- join(&quot; &quot;, map { platform-&gt;dso($_) } @{$unified_info{install}-&gt;{engines}}) -}
+INSTALL_PROGRAMS={- join(&quot; &quot;, map { platform-&gt;bin($_) } @{$unified_info{install}-&gt;{programs}}) -}
 {- output_off() if $disabled{apps}; &quot;&quot; -}
 BIN_SCRIPTS=$(BLDDIR)/tools/c_rehash
 MISC_SCRIPTS=$(BLDDIR)/apps/CA.pl $(BLDDIR)/apps/tsget.pl:tsget
@@ -374,7 +314,7 @@ test: tests
 	  BLDTOP=../$(BLDDIR) \
 	  RESULT_D=test-runs \
 	  PERL=&quot;$(PERL)&quot; \
-	  EXE_EXT={- $exeext -} \
+	  EXE_EXT={- platform-&gt;binext() -} \
 	  OPENSSL_ENGINES=`cd ../$(BLDDIR)/engines 2&gt;/dev/null &amp;&amp; pwd` \
 	  OPENSSL_DEBUG_MEMORY=on \
 	    $(PERL) ../$(SRCDIR)/test/run_tests.pl $(TESTS) )
@@ -410,13 +350,13 @@ libclean:
 		fi; \
 	done
 	$(RM) $(LIBS)
-	$(RM) *.{- $defext -}
+	$(RM) *{- platform-&gt;defext() -}
 
 clean: libclean
 	$(RM) $(PROGRAMS) $(TESTPROGS) $(ENGINES) $(SCRIPTS)
 	$(RM) $(GENERATED_MANDATORY) $(GENERATED)
-	-$(RM) `find . -name .git -prune -o -name '*{- $depext -}' -print`
-	-$(RM) `find . -name .git -prune -o -name '*{- $objext -}' -print`
+	-$(RM) `find . -name .git -prune -o -name '*{- platform-&gt;depext() -}' -print`
+	-$(RM) `find . -name .git -prune -o -name '*{- platform-&gt;objext() -}' -print`
 	$(RM) core
 	$(RM) tags TAGS doc-nits
 	$(RM) -r test/test-runs
@@ -628,7 +568,7 @@ uninstall_engines:
 	@set -e; for e in dummy $(INSTALL_ENGINES); do \
 		if [ &quot;$$e&quot; = &quot;dummy&quot; ]; then continue; fi; \
 		fn=`basename $$e`; \
-		if [ &quot;$$fn&quot; = '{- dso(&quot;ossltest&quot;) -}' ]; then \
+		if [ &quot;$$fn&quot; = '{- platform-&gt;dso(&quot;ossltest&quot;) -}' ]; then \
 			continue; \
 		fi; \
 		$(ECHO) &quot;$(RM) $(DESTDIR)$(ENGINESDIR)/$$fn&quot;; \
@@ -887,7 +827,7 @@ FORCE:
 
 # Building targets ###################################################
 
-libcrypto.pc libssl.pc openssl.pc: configdata.pm $(LIBS) {- join(&quot; &quot;,map { shlib_simple($_) } @{$unified_info{libraries}}) -}
+libcrypto.pc libssl.pc openssl.pc: configdata.pm $(LIBS) {- join(&quot; &quot;,map { platform-&gt;sharedlib_simple($_) // () } @{$unified_info{libraries}}) -}
 libcrypto.pc:
 	@ ( echo 'prefix=$(INSTALLTOP)'; \
 	    echo 'exec_prefix=$${prefix}'; \
@@ -958,14 +898,10 @@ reconfigure reconf:
   # Helper function to figure out dependencies on libraries
   # It takes a list of library names and outputs a list of dependencies
   sub compute_lib_depends {
-      if ($disabled{shared}) {
-          return map { lib($_) } @_;
-      }
-
       # Depending on shared libraries:
       # On Windows POSIX layers, we depend on {libname}.dll.a
       # On Unix platforms, we depend on {shlibname}.so
-      return map { $_ =~ /\.a$/ ? $`.$libext : shlib_simple($_) } @_;
+      return map { platform-&gt;sharedlib_simple($_) // platform-&gt;staticlib($_) } @_;
   }
 
   sub generatesrc {
@@ -976,17 +912,16 @@ reconfigure reconf:
       my $defs = join(&quot;&quot;, map { &quot; -D&quot;.$_ } @{$args{defs}});
       my $deps = join(&quot; &quot;, @{$args{generator_deps}}, @{$args{deps}});
 
-      if ($args{src} =~ /\.ld$/) {
-          (my $target = $args{src}) =~ s/\.ld$/${defext}/;
+      if (platform-&gt;isdef($args{src})) {
+          my $target = platform-&gt;def($args{src});
           (my $mkdef_os = $target{shared_target}) =~ s|-shared$||;
           my $ord_ver = $args{intent} eq 'lib' ? ' --version $(VERSION)' : '';
-          my $ord_name =
-              $args{generator}-&gt;[1] || basename($args{product}, $dsoext);
+          my $ord_name = $args{generator}-&gt;[1] || $args{product};
           return &lt;&lt;&quot;EOF&quot;;
 $target: $args{generator}-&gt;[0] $deps \$(SRCDIR)/util/mkdef.pl
 	\$(PERL) \$(SRCDIR)/util/mkdef.pl$ord_ver --ordinals $args{generator}-&gt;[0]  --name $ord_name --OS $mkdef_os &gt; $target
 EOF
-      } elsif ($args{src} !~ /\.[sS]$/) {
+      } elsif (!platform-&gt;isasm($args{src})) {
           if ($args{generator}-&gt;[0] =~ m|^.*\.in$|) {
               my $dofile = abs2rel(rel2abs(catfile($config{sourcedir},
                                                    &quot;util&quot;, &quot;dofile.pl&quot;)),
@@ -1038,7 +973,8 @@ EOF
   # last in the line.  We may therefore need to put back a line ending.
   sub src2obj {
       my %args = @_;
-      (my $obj = $args{obj}) =~ s|\.o$||;
+      my $obj = platform-&gt;obj($args{obj});
+      my $dep = platform-&gt;dep($args{obj});
       my @srcs = @{$args{srcs}};
       my $srcs = join(&quot; &quot;,  @srcs);
       my $deps = join(&quot; &quot;, @srcs, @{$args{deps}});
@@ -1074,7 +1010,7 @@ EOF
       # extension-specific rules
       if (grep /\.s$/, @srcs) {
           $recipe .= &lt;&lt;&quot;EOF&quot;;
-$obj$objext: $deps
+$obj: $deps
 	$cmd $cmdflags -c -o \$\@ $srcs
 EOF
       } elsif (grep /\.S$/, @srcs) {
@@ -1084,30 +1020,30 @@ EOF
           # The platform is long discontinued by vendor so there is
           # hardly a point to drag it along...
           $recipe .= &lt;&lt;&quot;EOF&quot;;
-$obj$objext: $deps
+$obj: $deps
 	$cmd $incs $defs $cmdflags -c -o \$\@ $srcs
 EOF
       } elsif (defined $makedepprog &amp;&amp; $makedepprog !~ /\/makedepend/
                &amp;&amp; !grep /\.rc$/, @srcs) {
           $recipe .= &lt;&lt;&quot;EOF&quot;;
-$obj$objext: $deps
-	$cmd $incs $defs $cmdflags -MMD -MF $obj$depext.tmp -MT \$\@ -c -o \$\@ $srcs
-	\@touch $obj$depext.tmp
-	\@if cmp $obj$depext.tmp $obj$depext &gt; /dev/null 2&gt; /dev/null; then \\
-		rm -f $obj$depext.tmp; \\
+$obj: $deps
+	$cmd $incs $defs $cmdflags -MMD -MF $dep.tmp -MT \$\@ -c -o \$\@ $srcs
+	\@touch $dep.tmp
+	\@if cmp $dep.tmp $dep &gt; /dev/null 2&gt; /dev/null; then \\
+		rm -f $dep.tmp; \\
 	else \\
-		mv $obj$depext.tmp $obj$depext; \\
+		mv $dep.tmp $dep; \\
 	fi
 EOF
       } else {
           $recipe .= &lt;&lt;&quot;EOF&quot;;
-$obj$objext: $deps
+$obj: $deps
 	$cmd $incs $defs $cmdflags $cmdcompile -o \$\@ $srcs
 EOF
           if (defined $makedepprog  &amp;&amp; $makedepprog =~ /\/makedepend/) {
               $recipe .= &lt;&lt;&quot;EOF&quot;;
 	\$(MAKEDEPEND) -f- -Y -- $incs $cmdflags -- $srcs 2&gt;/dev/null \\
-	    &gt; $obj$depext
+	    &gt; $dep
 EOF
           }
       }
@@ -1116,11 +1052,6 @@ EOF
   # We *know* this routine is only called when we've configure 'shared'.
   sub obj2shlib {
       my %args = @_;
-      my $lib = $args{lib};
-      my $shlib = $args{shlib};
-      my $libd = dirname($lib);
-      my $libn = basename($lib);
-      (my $libname = $libn) =~ s/^lib//;
       my @linkdirs = ();
       foreach (@{args{deps}}) {
           my $d = dirname($_);
@@ -1130,19 +1061,18 @@ EOF
       my $linklibs = join(&quot;&quot;, map { my $f = basename($_);
                                     (my $l = $f) =~ s/^lib//;
                                     &quot; -l$l&quot; } @{$args{deps}});
-      my @objs = map { (my $x = $_) =~ s|\.o$||; &quot;$x$objext&quot; }
-                 grep { $_ !~ m/\.ld$/ }
+      my @objs = map { platform-&gt;obj($_) }
+                 grep { !platform-&gt;isdef($_) }
                  @{$args{objs}};
-      my @defs = map { (my $x = $_) =~ s|\.ld$||; &quot;$x$defext&quot; }
-                 grep { $_ =~ /\.ld$/ }
+      my @defs = map { platform-&gt;def($_) }
+                 grep { platform-&gt;isdef($_) }
                  @{$args{objs}};
       my @deps = compute_lib_depends(@{$args{deps}});
       die &quot;More than one exported symbol map&quot; if scalar @defs &gt; 1;
       my $objs = join(&quot; &quot;, @objs);
       my $deps = join(&quot; &quot;, @objs, @defs, @deps);
-      my $simple = shlib_simple($lib);
-      my $full = shlib($lib);
-      my $target = &quot;$simple $full&quot;;
+      my $simple = platform-&gt;sharedlib_simple($args{lib});
+      my $full = platform-&gt;sharedlib($args{lib});
       my $shared_soname = &quot;&quot;;
       $shared_soname .= ' '.$target{shared_sonameflag}.basename($full)
           if defined $target{shared_sonameflag};
@@ -1151,39 +1081,40 @@ EOF
           if defined $target{shared_impflag};
       my $shared_def = join(&quot;&quot;, map { ' '.$target{shared_defflag}.$_ } @defs);
       my $recipe = &lt;&lt;&quot;EOF&quot;;
-$target: $deps
-	\$(CC) \$(LIB_CFLAGS) $linkflags\$(LIB_LDFLAGS)$shared_soname$shared_imp \\
-		-o $full$shared_def $objs \\
-                $linklibs \$(LIB_EX_LIBS)
+$simple: $full
 EOF
-      if (windowsdll()) {
+      if (sharedaix()) {
           $recipe .= &lt;&lt;&quot;EOF&quot;;
-	rm -f apps/$shlib'\$(SHLIB_EXT)'
-	rm -f test/$shlib'\$(SHLIB_EXT)'
-	rm -f fuzz/$shlib'\$(SHLIB_EXT)'
-	cp -p $shlib'\$(SHLIB_EXT)' apps/
-	cp -p $shlib'\$(SHLIB_EXT)' test/
-	cp -p $shlib'\$(SHLIB_EXT)' fuzz/
+	rm -f $simple &amp;&amp; \\
+	\$(AR) r $simple $full
 EOF
-      } elsif (sharedaix()) {
+      } elsif ($simple ne $full) {
           $recipe .= &lt;&lt;&quot;EOF&quot;;
 	rm -f $simple &amp;&amp; \\
-	\$(AR) r $simple $full
+	ln -s $full $simple
 EOF
-      } else {
+      }
+      $recipe .= &lt;&lt;&quot;EOF&quot;;
+$full: $deps
+	\$(CC) \$(LIB_CFLAGS) $linkflags\$(LIB_LDFLAGS)$shared_soname$shared_imp \\
+		-o $full$shared_def $objs \\
+                $linklibs \$(LIB_EX_LIBS)
+EOF
+      if (windowsdll()) {
           $recipe .= &lt;&lt;&quot;EOF&quot;;
-	if [ '$simple' != '$full' ]; then \\
-		rm -f $simple; \\
-		ln -s $full $simple; \\
-	fi
+	rm -f apps/$full
+	rm -f test/$full
+	rm -f fuzz/$full
+	cp -p $full apps/
+	cp -p $full test/
+	cp -p $full fuzz/
 EOF
       }
+      return $recipe;
   }
   sub obj2dso {
       my %args = @_;
-      my $dso = $args{lib};
-      my $dsod = dirname($dso);
-      my $dson = basename($dso);
+      my $dso = platform-&gt;dso($args{lib});
       my @linkdirs = ();
       foreach (@{args{deps}}) {
           my $d = dirname($_);
@@ -1193,43 +1124,39 @@ EOF
       my $linklibs = join(&quot;&quot;, map { my $f = basename($_);
                                     (my $l = $f) =~ s/^lib//;
                                     &quot; -l$l&quot; } @{$args{deps}});
-      my @objs = map { (my $x = $_) =~ s|\.o$||; &quot;$x$objext&quot; }
-                 grep { $_ !~ m/\.ld$/ }
+      my @objs = map { platform-&gt;obj($_) }
+                 grep { !platform-&gt;isdef($_) }
                  @{$args{objs}};
-      my @defs = map { (my $x = $_) =~ s|\.ld$||; &quot;$x$defext&quot; }
-                 grep { $_ =~ /\.ld$/ }
+      my @defs = map { platform-&gt;def($_) }
+                 grep { platform-&gt;isdef($_) }
                  @{$args{objs}};
       my @deps = compute_lib_depends(@{$args{deps}});
       my $objs = join(&quot; &quot;, @objs);
       my $deps = join(&quot; &quot;, @objs, @defs, @deps);
-      my $target = dso($dso);
       my $shared_def = join(&quot;&quot;, map { ' '.$target{shared_defflag}.$_ } @defs);
       return &lt;&lt;&quot;EOF&quot;;
-$target: $deps
+$dso: $deps
 	\$(CC) \$(DSO_CFLAGS) $linkflags\$(DSO_LDFLAGS) \\
-		-o $target$shared_def $objs \\
+		-o $dso$shared_def $objs \\
                 $linklibs \$(DSO_EX_LIBS)
 EOF
   }
   sub obj2lib {
       my %args = @_;
-      (my $lib = $args{lib}) =~ s/\.a$//;
-      my @objs = map { (my $x = $_) =~ s|\.o$|$objext|; $x } @{$args{objs}};
+      my $lib = platform-&gt;staticlib($args{lib});
+      my @objs = map { platform-&gt;obj($_) } @{$args{objs}};
       my $objs = join(&quot; &quot;, @objs);
       return &lt;&lt;&quot;EOF&quot;;
-$lib$libext: $objs
+$lib: $objs
 	\$(AR) \$(ARFLAGS) \$\@ \$\?
 	\$(RANLIB) \$\@ || echo Never mind.
 EOF
   }
   sub obj2bin {
       my %args = @_;
-      my $bin = $args{bin};
-      my $bind = dirname($bin);
-      my $binn = basename($bin);
-      my $objs = join(&quot; &quot;, map { (my $x = $_) =~ s|\.o$||; &quot;$x$objext&quot; }
-                           @{$args{objs}});
-      my $deps = join(&quot; &quot;,compute_lib_depends(@{$args{deps}}));
+      my $bin = platform-&gt;bin($args{bin});
+      my $objs = join(&quot; &quot;, map { platform-&gt;obj($_) } @{$args{objs}});
+      my $deps = join(&quot; &quot;, compute_lib_depends(@{$args{deps}}));
       my @linkdirs = ();
       foreach (@{args{deps}}) {
           next if $_ =~ /\.a$/;
@@ -1238,7 +1165,7 @@ EOF
       }
       my $linkflags = join(&quot;&quot;, map { &quot;-L$_ &quot; } @linkdirs);
       my $linklibs = join(&quot;&quot;, map { if ($_ =~ s/\.a$//) {
-                                        &quot; $_$libext&quot;;
+                                        &quot; &quot;.platform-&gt;staticlib($_);
                                     } else {
                                         my $f = basename($_);
                                         (my $l = $f) =~ s/^lib//;
@@ -1252,10 +1179,10 @@ EOF
           $cmdflags = '$(BIN_CXXFLAGS)';
       }
       return &lt;&lt;&quot;EOF&quot;;
-$bin$exeext: $objs $deps
-	rm -f $bin$exeext
+$bin: $objs $deps
+	rm -f $bin
 	\$\${LDCMD:-$cmd} $cmdflags $linkflags\$(BIN_LDFLAGS) \\
-		-o $bin$exeext $objs \\
+		-o $bin $objs \\
 		$linklibs \$(BIN_EX_LIBS)
 EOF
   }
@@ -1276,11 +1203,11 @@ EOF
   sub generatedir {
       my %args = @_;
       my $dir = $args{dir};
-      my @deps = map { s|\.o$|$objext|; $_ } @{$args{deps}};
+      my @deps = map { platform-&gt;convertext($_) } @{$args{deps}};
       my @actions = ();
-      my %extinfo = ( dso =&gt; $dsoext,
-                      lib =&gt; $libext,
-                      bin =&gt; $exeext );
+      my %extinfo = ( dso =&gt; platform-&gt;dsoext(),
+                      lib =&gt; platform-&gt;libext(),
+                      bin =&gt; platform-&gt;binext() );
 
       # We already have a 'test' target, and the top directory is just plain
       # silly
diff --git a/Configurations/windows-makefile.tmpl b/Configurations/windows-makefile.tmpl
index 6f090de..97e59c3 100644
--- a/Configurations/windows-makefile.tmpl
+++ b/Configurations/windows-makefile.tmpl
@@ -3,17 +3,7 @@
 ##
 ## {- join(&quot;\n## &quot;, @autowarntext) -}
 {-
- our $objext = $target{obj_extension} || &quot;.obj&quot;;
- our $resext = $target{res_extension} || &quot;.res&quot;;
- our $depext = $target{dep_extension} || &quot;.d&quot;;
- our $defext = $target{dep_extension} || &quot;.def&quot;;
- our $exeext = $target{exe_extension} || &quot;.exe&quot;;
- our $libext = $target{lib_extension} || &quot;.lib&quot;;
- our $shlibext = $target{shared_extension} || &quot;.dll&quot;;
- our $shlibextimport = $target{shared_import_extension} || &quot;.lib&quot;;
- our $dsoext = $target{dso_extension} || &quot;.dll&quot;;
-
- (our $sover_dirname = $config{shlib_version}) =~ s|\.|_|g;
+ our $sover_dirname = platform-&gt;shlib_version_as_filename();
 
  my $build_scheme = $target{build_scheme};
  my $install_flavour = $build_scheme-&gt;[$#$build_scheme]; # last element
@@ -32,31 +22,6 @@
  $win_installroot = $ENV{$win_installroot};
  $win_commonroot = $ENV{$win_commonroot};
 
- sub shlib {
-     my $lib = shift;
-     return () if $disabled{shared} || $lib =~ /\.a$/;
-     return () unless defined $unified_info{sharednames}-&gt;{$lib};
-     return $unified_info{sharednames}-&gt;{$lib} . $shlibext;
- }
-
- sub lib {
-     (my $lib = shift) =~ s/\.a$//;
-     $lib .= '_static'
-         if (defined $unified_info{sharednames}-&gt;{$lib});
-     return $lib . $libext;
- }
-
- sub shlib_import {
-     my $lib = shift;
-     return () if $disabled{shared} || $lib =~ /\.a$/;
-     return $lib . $shlibextimport;
- }
-
- sub dso {
-     my $dso = shift;
-
-     return $dso . $dsoext;
- }
  # This makes sure things get built in the order they need
  # to. You're welcome.
  sub dependmagic {
@@ -77,34 +42,32 @@ MINOR={- $config{minor} -}
 
 SHLIB_VERSION_NUMBER={- $config{shlib_version} -}
 
-LIBS={- join(&quot; &quot;, map { ( shlib_import($_), lib($_) ) } @{$unified_info{libraries}}) -}
-SHLIBS={- join(&quot; &quot;, map { shlib($_) } @{$unified_info{libraries}}) -}
-SHLIBPDBS={- join(&quot; &quot;, map { local $shlibext = &quot;.pdb&quot;; shlib($_) } @{$unified_info{libraries}}) -}
-ENGINES={- join(&quot; &quot;, map { dso($_) } @{$unified_info{engines}}) -}
-ENGINEPDBS={- join(&quot; &quot;, map { local $dsoext = &quot;.pdb&quot;; dso($_) } @{$unified_info{engines}}) -}
-PROGRAMS={- our @PROGRAMS = map { $_.$exeext } @{$unified_info{programs}}; join(&quot; &quot;, @PROGRAMS) -}
+LIBS={- join(&quot; &quot;, map { ( platform-&gt;sharedlib_import($_), platform-&gt;staticlib($_) ) } @{$unified_info{libraries}}) -}
+SHLIBS={- join(&quot; &quot;, map { platform-&gt;sharedlib($_) // () } @{$unified_info{libraries}}) -}
+SHLIBPDBS={- join(&quot; &quot;, map { platform-&gt;sharedlibpdb($_) // () } @{$unified_info{libraries}}) -}
+ENGINES={- join(&quot; &quot;, map { platform-&gt;dso($_) } @{$unified_info{engines}}) -}
+ENGINEPDBS={- join(&quot; &quot;, map { platform-&gt;dsopdb($_) } @{$unified_info{engines}}) -}
+PROGRAMS={- our @PROGRAMS = map { platform-&gt;bin($_) } @{$unified_info{programs}}; join(&quot; &quot;, @PROGRAMS) -}
 PROGRAMPDBS={- join(&quot; &quot;, map { $_.&quot;.pdb&quot; } @{$unified_info{programs}}) -}
 SCRIPTS={- join(&quot; &quot;, @{$unified_info{scripts}}) -}
 {- output_off() if $disabled{makedepend}; &quot;&quot; -}
-DEPS={- join(&quot; &quot;, map { (my $x = $_) =~ s|\.o$|$depext|; $x; }
+DEPS={- join(&quot; &quot;, map { platform-&gt;isobj($_) ? platform-&gt;dep($_) : () }
                   grep { $unified_info{sources}-&gt;{$_}-&gt;[0] =~ /\.c$/ }
                   keys %{$unified_info{sources}}); -}
 {- output_on() if $disabled{makedepend}; &quot;&quot; -}
 GENERATED_MANDATORY={- join(&quot; &quot;, @{$unified_info{depends}-&gt;{&quot;&quot;}} ) -}
 GENERATED={- # common0.tmpl provides @generated
-             join(&quot; &quot;, map { my $x = $_;
-                             $x =~ s|\.[sS]$|.asm|;
-                             $x =~ s|\.ld$|$defext|;
-                             $x }
-                       @generated) -}
-
-INSTALL_LIBS={- join(&quot; &quot;, map { quotify1(shlib_import($_) or lib($_)) } @{$unified_info{install}-&gt;{libraries}}) -}
-INSTALL_SHLIBS={- join(&quot; &quot;, map { quotify_l(shlib($_)) } @{$unified_info{install}-&gt;{libraries}}) -}
-INSTALL_SHLIBPDBS={- join(&quot; &quot;, map { local $shlibext = &quot;.pdb&quot;; quotify_l(shlib($_)) } @{$unified_info{install}-&gt;{libraries}}) -}
-INSTALL_ENGINES={- join(&quot; &quot;, map { quotify1(dso($_)) } @{$unified_info{install}-&gt;{engines}}) -}
-INSTALL_ENGINEPDBS={- join(&quot; &quot;, map { local $dsoext = &quot;.pdb&quot;; quotify1(dso($_)) } @{$unified_info{install}-&gt;{engines}}) -}
-INSTALL_PROGRAMS={- join(&quot; &quot;, map { quotify1($_.$exeext) } grep { !m|^test\\| } @{$unified_info{install}-&gt;{programs}}) -}
-INSTALL_PROGRAMPDBS={- join(&quot; &quot;, map { quotify1($_.&quot;.pdb&quot;) } grep { !m|^test\\| } @{$unified_info{install}-&gt;{programs}}) -}
+             join(&quot; &quot;, map { platform-&gt;convertext($_) } @generated) -}
+
+INSTALL_LIBS={- join(&quot; &quot;, map { quotify1(platform-&gt;sharedlib_import($_) // platform-&gt;staticlib($_)) } @{$unified_info{install}-&gt;{libraries}}) -}
+INSTALL_SHLIBS={- join(&quot; &quot;, map { my $x = platform-&gt;sharedlib($_);
+                                  $x ? quotify_l($x) : () } @{$unified_info{install}-&gt;{libraries}}) -}
+INSTALL_SHLIBPDBS={- join(&quot; &quot;, map { my $x = platform-&gt;sharedlibpdb($_);
+                                     $x ? quotify_l($x) : () } @{$unified_info{install}-&gt;{libraries}}) -}
+INSTALL_ENGINES={- join(&quot; &quot;, map { quotify1(platform-&gt;dso($_)) } @{$unified_info{install}-&gt;{engines}}) -}
+INSTALL_ENGINEPDBS={- join(&quot; &quot;, map { quotify1(platform-&gt;dsopdb($_)) } @{$unified_info{install}-&gt;{engines}}) -}
+INSTALL_PROGRAMS={- join(&quot; &quot;, map { quotify1(platform-&gt;bin($_)) } grep { !m|^test\\| } @{$unified_info{install}-&gt;{programs}}) -}
+INSTALL_PROGRAMPDBS={- join(&quot; &quot;, map { quotify1(platform-&gt;binpdb($_)) } grep { !m|^test\\| } @{$unified_info{install}-&gt;{programs}}) -}
 {- output_off() if $disabled{apps}; &quot;&quot; -}
 BIN_SCRIPTS=&quot;$(BLDDIR)\tools\c_rehash.pl&quot;
 MISC_SCRIPTS=&quot;$(BLDDIR)\apps\CA.pl&quot; &quot;$(BLDDIR)\apps\tsget.pl&quot;
@@ -317,7 +280,7 @@ PROCESSOR= {- $config{processor} -}
 {- dependmagic('build_programs'); -}: build_programs_nodep
 
 build_generated: $(GENERATED_MANDATORY)
-build_libs_nodep: $(LIBS) {- join(&quot; &quot;,map { shlib_import($_) } @{$unified_info{libraries}}) -}
+build_libs_nodep: $(LIBS) {- join(&quot; &quot;,map { platform-&gt;sharedlib_import($_) // () } @{$unified_info{libraries}}) -}
 build_engines_nodep: $(ENGINES)
 build_programs_nodep: $(PROGRAMS) $(SCRIPTS)
 
@@ -497,9 +460,9 @@ reconfigure reconf:
  # It takes a list of library names and outputs a list of dependencies
  sub compute_lib_depends {
      if ($disabled{shared}) {
-	 return map { lib($_) } @_;
+	 return map { platform-&gt;staticlib($_) } @_;
      }
-     return map { shlib_import($_) or lib($_) } @_;
+     return map { platform-&gt;sharedlib_import($_) // platform-&gt;staticlib($_) } @_;
  }
 
   sub generatesrc {
@@ -512,19 +475,19 @@ reconfigure reconf:
       my $deps = @{$args{deps}} ?
           '&quot;'.join('&quot; &quot;', @{$args{generator_deps}}, @{$args{deps}}).'&quot;' : '';
 
-      if ($args{src} =~ /\.ld$/) {
-          (my $target = $args{src}) =~ s/\.ld$/$defext/;
+      if (platform-&gt;isdef($args{src})) {
+          my $target = platform-&gt;def($args{src});
           my $mkdef = abs2rel(rel2abs(catfile($config{sourcedir},
                                               &quot;util&quot;, &quot;mkdef.pl&quot;)),
                               rel2abs($config{builddir}));
           my $ord_ver = $args{intent} eq 'lib' ? ' --version $(VERSION)' : '';
           my $ord_name =
-              $args{generator}-&gt;[1] || basename($args{product}, $dsoext);
+              $args{generator}-&gt;[1] || platform-&gt;dsoname($args{product});
           return &lt;&lt;&quot;EOF&quot;;
 $target: $args{generator}-&gt;[0] $deps $mkdef
 	\$(PERL) $mkdef$ord_ver --ordinals $args{generator}-&gt;[0] --name $ord_name --OS windows &gt; $target
 EOF
-      } elsif ($args{src} !~ /\.[sS]$/) {
+      } elsif (!platform-&gt;isasm($args{src})) {
           my $target = $args{src};
           if ($args{generator}-&gt;[0] =~ m|^.*\.in$|) {
               my $dofile = abs2rel(rel2abs(catfile($config{sourcedir},
@@ -542,7 +505,7 @@ $target: &quot;$args{generator}-&gt;[0]&quot; $deps
 EOF
 	  }
       } else {
-          (my $target = $args{src}) =~ s/\.[sS]$/.asm/;
+          my $target = platform-&gt;asm($args{src});
           if ($args{generator}-&gt;[0] =~ /\.pl$/) {
               $generator = '&quot;$(PERL)&quot;'.$generator_incs.' '.$generator;
           } elsif ($args{generator}-&gt;[0] =~ /\.S$/) {
@@ -586,8 +549,7 @@ EOF
 
  sub src2obj {
      my %args = @_;
-     my @srcs = map { (my $x = $_) =~ s/\.s$/.asm/; $x
-                    } ( @{$args{srcs}} );
+     my @srcs = map { (my $x = $_) =~ s/\.s$/.asm/; $x } ( @{$args{srcs}} );
      my $srcs = '&quot;'.join('&quot; &quot;',  @srcs).'&quot;';
      my $deps = '&quot;'.join('&quot; &quot;', @srcs, @{$args{deps}}).'&quot;';
      my $incs = join(&quot;&quot;, map { ' /I &quot;'.$_.'&quot;' } @{$args{incs}});
@@ -607,29 +569,30 @@ EOF
 		     bin =&gt; ' $(BIN_ASFLAGS)' } -&gt; {$args{intent}};
      my $makedepprog = $config{makedepprog};
      if ($srcs[0] =~ /\.rc$/) {
+         my $res = platform-&gt;res($args{obj});
          return &lt;&lt;&quot;EOF&quot;;
-$args{obj}: $deps
+$res: $deps
 	\$(RC) \$(RCOUTFLAG)\$\@ $srcs
 EOF
      }
-     (my $obj = $args{obj}) =~ s|\.o$||;
+     my $obj = platform-&gt;obj($args{obj});
      if ($srcs[0] =~ /\.asm$/) {
          return &lt;&lt;&quot;EOF&quot;;
-$obj$objext: $deps
+$obj: $deps
 	\$(AS) $asflags \$(ASOUTFLAG)\$\@ $srcs
 EOF
      } elsif ($srcs[0] =~ /.S$/) {
          return &lt;&lt;&quot;EOF&quot;;
-$obj$objext: $deps
+$obj: $deps
 	\$(CC) /EP /D__ASSEMBLER__ $cflags $defs $srcs &gt; \$@.asm &amp;&amp; \$(AS) $asflags \$(ASOUTFLAG)\$\@ \$@.asm
 EOF
      }
      my $recipe = &lt;&lt;&quot;EOF&quot;;
-$obj$objext: $deps
+$obj: $deps
 	\$(CC) $cflags $defs -c \$(COUTFLAG)\$\@ $srcs
 EOF
      $recipe .= &lt;&lt;&quot;EOF&quot;	unless $disabled{makedepend};
-	\$(CC) $cflags $defs /Zs /showIncludes $srcs 2&gt;&amp;1 &gt; $obj$depext
+	\$(CC) $cflags $defs /Zs /showIncludes $srcs 2&gt;&amp;1 &gt; $dep
 EOF
      return $recipe;
  }
@@ -640,19 +603,19 @@ EOF
  sub obj2shlib {
      my %args = @_;
      my $lib = $args{lib};
-     my @objs = map { (my $x = $_) =~ s|\.o$|$objext|; $x }
-                grep { $_ =~ m/\.(?:o|res)$/ }
+     my @objs = map { platform-&gt;convertext($_) }
+                grep { platform-&gt;isobj($_) || platform-&gt;isres($_) }
                 @{$args{objs}};
-     my @defs = map { (my $x = $_) =~ s|\.ld$||; &quot;$x$defext&quot; }
-                grep { $_ =~ /\.ld$/ }
+     my @defs = map { platform-&gt;def($_) }
+                grep { platform-&gt;isdef($_) }
                 @{$args{objs}};
      my @deps = compute_lib_depends(@{$args{deps}});
      die &quot;More than one exported symbols list&quot; if scalar @defs &gt; 1;
      my $linklibs = join(&quot;&quot;, map { &quot;$_\n&quot; } @deps);
      my $objs = join(&quot;\n&quot;, @objs);
      my $deps = join(&quot; &quot;, @objs, @defs, @deps);
-     my $import = shlib_import($lib);
-     my $dll =  shlib($lib);
+     my $import = platform-&gt;sharedlib_import($lib);
+     my $dll =  platform-&gt;sharedlib($lib);
      my $shared_def = join(&quot;&quot;, map { &quot; /def:$_&quot; } @defs);
      return &lt;&lt;&quot;EOF&quot;
 # The import library may look like a static library, but it is not.
@@ -679,13 +642,13 @@ EOF
  }
  sub obj2dso {
      my %args = @_;
-     my $dso = $args{lib};
-     my $dso_n = basename($dso);
-     my @objs = map { (my $x = $_) =~ s|\.o$|$objext|; $x }
-                grep { $_ =~ m/\.(?:o|res)$/ }
+     my $dso = platform-&gt;dso($args{lib});
+     my $dso_n = platform-&gt;dsoname($args{lib});
+     my @objs = map { platform-&gt;convertext($_) }
+                grep { platform-&gt;isobj($_) || platform-&gt;isres($_) }
                 @{$args{objs}};
-     my @defs = map { (my $x = $_) =~ s|\.ld$|$defext|; $x }
-                grep { $_ =~ /\.ld$/ }
+     my @defs = map { platform-&gt;def($_) }
+                grep { platform-&gt;isdef($_) }
                 @{$args{objs}};
      my @deps = compute_lib_depends(@{$args{deps}});
      my $objs = join(&quot;\n&quot;, @objs);
@@ -693,21 +656,21 @@ EOF
      my $deps = join(&quot; &quot;, @objs, @defs, @deps);
      my $shared_def = join(&quot;&quot;, map { &quot; /def:$_&quot; } @defs);
      return &lt;&lt;&quot;EOF&quot;;
-$dso$dsoext: $deps
-	IF EXIST $dso$dsoext.manifest DEL /F /Q $dso$dsoext.manifest
+$dso: $deps
+	IF EXIST $dso.manifest DEL /F /Q $dso.manifest
 	\$(LD) \$(LDFLAGS) \$(DSO_LDFLAGS) \\
-		\$(LDOUTFLAG)$dso$dsoext$shared_def @&lt;&lt; || (DEL /Q \$(\@B).* $dso.* &amp;&amp; EXIT 1)
+		\$(LDOUTFLAG)$dso$shared_def @&lt;&lt; || (DEL /Q \$(\@B).* $dso_n.* &amp;&amp; EXIT 1)
 $objs
 $linklibs \$(DSO_EX_LIBS)
 &lt;&lt;
-	IF EXIST $dso$dsoext.manifest \\
-	   \$(MT) \$(MTFLAGS) \$(MTINFLAG)$dso$dsoext.manifest \$(MTOUTFLAG)$dso$dsoext
+	IF EXIST $dso.manifest \\
+	   \$(MT) \$(MTFLAGS) \$(MTINFLAG)$dso.manifest \$(MTOUTFLAG)$dso
 EOF
  }
  sub obj2lib {
      my %args = @_;
-     my $lib = lib($args{lib});
-     my @objs = map { (my $x = $_) =~ s|\.o$|$objext|; $x } @{$args{objs}};
+     my $lib = platform-&gt;staticlib($args{lib});
+     my @objs = map { platform-&gt;obj($_) } @{$args{objs}};
      my $objs = join(&quot;\n&quot;, @objs);
      my $deps = join(&quot; &quot;, @objs);
      return &lt;&lt;&quot;EOF&quot;;
@@ -719,22 +682,24 @@ EOF
  }
  sub obj2bin {
      my %args = @_;
-     my $bin = $args{bin};
-     my @objs = map { (my $x = $_) =~ s|\.o$|$objext|; $x } @{$args{objs}};
+     my $bin = platform-&gt;bin($args{bin});
+     my @objs = map { platform-&gt;convertext($_) }
+                grep { platform-&gt;isobj($_) || platform-&gt;isres($_) }
+                @{$args{objs}};
      my @deps = compute_lib_depends(@{$args{deps}});
      my $objs = join(&quot;\n&quot;, @objs);
      my $linklibs = join(&quot;&quot;, map { &quot;$_\n&quot; } @deps);
      my $deps = join(&quot; &quot;, @objs, @deps);
      return &lt;&lt;&quot;EOF&quot;;
-$bin$exeext: $deps
-	IF EXIST $bin$exeext.manifest DEL /F /Q $bin$exeext.manifest
-	\$(LD) \$(LDFLAGS) \$(BIN_LDFLAGS) \$(LDOUTFLAG)$bin$exeext @&lt;&lt;
+$bin: $deps
+	IF EXIST $bin.manifest DEL /F /Q $bin.manifest
+	\$(LD) \$(LDFLAGS) \$(BIN_LDFLAGS) \$(LDOUTFLAG)$bin @&lt;&lt;
 $objs
 setargv.obj
 $linklibs\$(BIN_EX_LIBS)
 &lt;&lt;
-	IF EXIST $bin$exeext.manifest \\
-	   \$(MT) \$(MTFLAGS) \$(MTINFLAG)$bin$exeext.manifest \$(MTOUTFLAG)$bin$exeext
+	IF EXIST $bin.manifest \\
+	   \$(MT) \$(MTFLAGS) \$(MTINFLAG)$bin.manifest \$(MTOUTFLAG)$bin
 EOF
   }
   sub in2script {
@@ -753,11 +718,11 @@ EOF
   sub generatedir {
       my %args = @_;
       my $dir = $args{dir};
-      my @deps = map { s|\.o$|$objext|; $_ } @{$args{deps}};
+      my @deps = map { platform-&gt;convertext($_) } @{$args{deps}};
       my @actions = ();
-      my %extinfo = ( dso =&gt; $dsoext,
-                      lib =&gt; $libext,
-                      bin =&gt; $exeext );
+      my %extinfo = ( dso =&gt; platform-&gt;dsoext(),
+                      lib =&gt; platform-&gt;libext(),
+                      bin =&gt; platform-&gt;binext() );
 
       # We already have a 'test' target, and the top directory is just plain
       # silly
diff --git a/Configure b/Configure
index 7a2be83..6860cfa 100755
--- a/Configure
+++ b/Configure
@@ -1125,19 +1125,8 @@ foreach my $feature (@{$target{enable}}) {
 
 $target{CXXFLAGS}//=$target{CFLAGS} if $target{CXX};
 $target{cxxflags}//=$target{cflags} if $target{CXX};
-$target{exe_extension}=&quot;&quot;;
-$target{exe_extension}=&quot;.exe&quot; if ($config{target} eq &quot;DJGPP&quot;
-                                  || $config{target} =~ /^(?:Cygwin|mingw)/);
+$target{exe_extension}=&quot;.exe&quot; if ($config{target} eq &quot;DJGPP&quot;);
 $target{exe_extension}=&quot;.pm&quot;  if ($config{target} =~ /vos/);
-$target{def_extension}=&quot;.ld&quot;;
-$target{def_extension}=&quot;.def&quot; if $config{target} =~ /^mingw|VC-/;
-$target{def_extension}=&quot;.opt&quot; if $config{target} =~ /^vms/;
-($target{shared_extension_simple}=$target{shared_extension})
-    =~ s|\.\$\(SHLIB_VERSION_NUMBER\)||
-    unless defined($target{shared_extension_simple});
-$target{dso_extension}//=$target{shared_extension_simple};
-($target{shared_import_extension}=$target{shared_extension_simple}.&quot;.a&quot;)
-    if ($config{target} =~ /^(?:Cygwin|mingw)/);
 
 # Fill %config with values from %user, and in case those are undefined or
 # empty, use values from %target (acting as a default).
@@ -1738,8 +1727,6 @@ if ($builder eq &quot;unified&quot;) {
         my %includes = ();
         my %defines = ();
         my %depends = ();
-        my %renames = ();
-        my %sharednames = ();
         my %generate = ();
 
         # We want to detect configdata.pm in the source tree, so we
@@ -1870,11 +1857,9 @@ if ($builder eq &quot;unified&quot;) {
             =&gt; sub { push @{$generate{$1}}, $2
                          if !@skip || $skip[$#skip] &gt; 0 },
             qr/^\s*RENAME\[((?:\\.|[^\\\]])+)\]\s*=\s*(.*)\s*$/
-            =&gt; sub { push @{$renames{$1}}, tokenize($2)
-                         if !@skip || $skip[$#skip] &gt; 0 },
-            qr/^\s*SHARED_NAME\[((?:\\.|[^\\\]])+)\]\s*=\s*(.*)\s*$/
-            =&gt; sub { push @{$sharednames{$1}}, tokenize($2)
-                         if !@skip || $skip[$#skip] &gt; 0 },
+            =&gt; sub { warn &quot;RENAME is no longer supported\n&quot; },
+             qr/^\s*SHARED_NAME\[((?:\\.|[^\\\]])+)\]\s*=\s*(.*)\s*$/
+            =&gt; sub { warn &quot;SHARED_NAME is no longer supported\n&quot; },
             qr/^\s*BEGINRAW\[((?:\\.|[^\\\]])+)\]\s*$/
             =&gt; sub {
                 my $lineiterator = shift;
@@ -1908,48 +1893,23 @@ if ($builder eq &quot;unified&quot;) {
             );
         die &quot;runaway IF?&quot; if (@skip);
 
-        foreach (keys %renames) {
-            die &quot;$_ renamed to more than one thing: &quot;
-                ,join(&quot; &quot;, @{$renames{$_}}),&quot;\n&quot;
-                if scalar @{$renames{$_}} &gt; 1;
-            my $dest = cleanfile($buildd, $_, $blddir);
-            my $to = cleanfile($buildd, $renames{$_}-&gt;[0], $blddir);
-            die &quot;$dest renamed to more than one thing: &quot;
-                ,$unified_info{rename}-&gt;{$dest}, $to
-                unless !defined($unified_info{rename}-&gt;{$dest})
-                or $unified_info{rename}-&gt;{$dest} eq $to;
-            $unified_info{rename}-&gt;{$dest} = $to;
-        }
-
         foreach (@programs) {
             my $program = cleanfile($buildd, $_, $blddir);
-            if ($unified_info{rename}-&gt;{$program}) {
-                $program = $unified_info{rename}-&gt;{$program};
-            }
             $unified_info{programs}-&gt;{$program} = 1;
         }
 
         foreach (@programs_install) {
             my $program = cleanfile($buildd, $_, $blddir);
-            if ($unified_info{rename}-&gt;{$program}) {
-                $program = $unified_info{rename}-&gt;{$program};
-            }
             $unified_info{install}-&gt;{programs}-&gt;{$program} = 1;
         }
 
         foreach (@libraries) {
             my $library = cleanfile($buildd, $_, $blddir);
-            if ($unified_info{rename}-&gt;{$library}) {
-                $library = $unified_info{rename}-&gt;{$library};
-            }
             $unified_info{libraries}-&gt;{$library} = 1;
         }
 
         foreach (@libraries_install) {
             my $library = cleanfile($buildd, $_, $blddir);
-            if ($unified_info{rename}-&gt;{$library}) {
-                $library = $unified_info{rename}-&gt;{$library};
-            }
             $unified_info{install}-&gt;{libraries}-&gt;{$library} = 1;
         }
 
@@ -1959,33 +1919,21 @@ This is usually a fault in a build.info file.
 EOF
         foreach (@engines) {
             my $library = cleanfile($buildd, $_, $blddir);
-            if ($unified_info{rename}-&gt;{$library}) {
-                $library = $unified_info{rename}-&gt;{$library};
-            }
             $unified_info{engines}-&gt;{$library} = 1;
         }
 
         foreach (@engines_install) {
             my $library = cleanfile($buildd, $_, $blddir);
-            if ($unified_info{rename}-&gt;{$library}) {
-                $library = $unified_info{rename}-&gt;{$library};
-            }
             $unified_info{install}-&gt;{engines}-&gt;{$library} = 1;
         }
 
         foreach (@scripts) {
             my $script = cleanfile($buildd, $_, $blddir);
-            if ($unified_info{rename}-&gt;{$script}) {
-                $script = $unified_info{rename}-&gt;{$script};
-            }
             $unified_info{scripts}-&gt;{$script} = 1;
         }
 
         foreach (@scripts_install) {
             my $script = cleanfile($buildd, $_, $blddir);
-            if ($unified_info{rename}-&gt;{$script}) {
-                $script = $unified_info{rename}-&gt;{$script};
-            }
             $unified_info{install}-&gt;{scripts}-&gt;{$script} = 1;
         }
 
@@ -2001,53 +1949,20 @@ EOF
 
         push @{$unified_info{rawlines}}, @rawlines;
 
-        unless ($disabled{shared}) {
-            # Check sharednames.
-            foreach (keys %sharednames) {
-                my $dest = cleanfile($buildd, $_, $blddir);
-                if ($unified_info{rename}-&gt;{$dest}) {
-                    $dest = $unified_info{rename}-&gt;{$dest};
-                }
-                die &quot;shared_name for $dest with multiple values: &quot;
-                    ,join(&quot; &quot;, @{$sharednames{$_}}),&quot;\n&quot;
-                    if scalar @{$sharednames{$_}} &gt; 1;
-                my $to = cleanfile($buildd, $sharednames{$_}-&gt;[0], $blddir);
-                die &quot;shared_name found for a library $dest that isn't defined\n&quot;
-                    unless $unified_info{libraries}-&gt;{$dest};
-                die &quot;shared_name for $dest with multiple values: &quot;
-                    ,$unified_info{sharednames}-&gt;{$dest}, &quot;, &quot;, $to
-                    unless !defined($unified_info{sharednames}-&gt;{$dest})
-                    or $unified_info{sharednames}-&gt;{$dest} eq $to;
-                $unified_info{sharednames}-&gt;{$dest} = $to;
-            }
-
-            # Additionally, we set up sharednames for libraries that don't
-            # have any, as themselves.  Only for libraries that aren't
-            # explicitly static.
-            foreach (grep !/\.a$/, keys %{$unified_info{libraries}}) {
-                if (!defined $unified_info{sharednames}-&gt;{$_}) {
-                    $unified_info{sharednames}-&gt;{$_} = $_
-                }
-            }
-
-            # Check that we haven't defined any library as both shared and
-            # explicitly static.  That is forbidden.
-            my @doubles = ();
-            foreach (grep /\.a$/, keys %{$unified_info{libraries}}) {
-                (my $l = $_) =~ s/\.a$//;
-                push @doubles, $l if defined $unified_info{sharednames}-&gt;{$l};
-            }
-            die &quot;these libraries are both explicitly static and shared:\n  &quot;,
-                join(&quot; &quot;, @doubles), &quot;\n&quot;
-                if @doubles;
+        # Check that we haven't defined any library as both shared and
+        # explicitly static.  That is forbidden.
+        my @doubles = ();
+        foreach (grep /\.a$/, keys %{$unified_info{libraries}}) {
+            (my $l = $_) =~ s/\.a$//;
+            push @doubles, $l if defined $unified_info{libraries}-&gt;{$l};
         }
+        die &quot;these libraries are both explicitly static and shared:\n  &quot;,
+            join(&quot; &quot;, @doubles), &quot;\n&quot;
+            if @doubles;
 
         foreach (keys %sources) {
             my $dest = $_;
             my $ddest = cleanfile($buildd, $_, $blddir);
-            if ($unified_info{rename}-&gt;{$ddest}) {
-                $ddest = $unified_info{rename}-&gt;{$ddest};
-            }
             foreach (@{$sources{$dest}}) {
                 my $s = cleanfile($sourced, $_, $blddir);
 
@@ -2080,9 +1995,6 @@ EOF
         foreach (keys %shared_sources) {
             my $dest = $_;
             my $ddest = cleanfile($buildd, $_, $blddir);
-            if ($unified_info{rename}-&gt;{$ddest}) {
-                $ddest = $unified_info{rename}-&gt;{$ddest};
-            }
             foreach (@{$shared_sources{$dest}}) {
                 my $s = cleanfile($sourced, $_, $blddir);
 
@@ -2121,9 +2033,6 @@ EOF
         foreach (keys %generate) {
             my $dest = $_;
             my $ddest = cleanfile($buildd, $_, $blddir);
-            if ($unified_info{rename}-&gt;{$ddest}) {
-                $ddest = $unified_info{rename}-&gt;{$ddest};
-            }
             die &quot;more than one generator for $dest: &quot;
                     ,join(&quot; &quot;, @{$generate{$_}}),&quot;\n&quot;
                     if scalar @{$generate{$_}} &gt; 1;
@@ -2140,9 +2049,6 @@ EOF
             # a generated file in the build tree.
             if ($ddest ne &quot;&quot; &amp;&amp; ($ddest eq $src_configdata || ! -f $ddest)) {
                 $ddest = cleanfile($buildd, $_, $blddir);
-                if ($unified_info{rename}-&gt;{$ddest}) {
-                    $ddest = $unified_info{rename}-&gt;{$ddest};
-                }
             }
             foreach (@{$depends{$dest}}) {
                 my $d = cleanfile($sourced, $_, $blddir);
@@ -2165,11 +2071,7 @@ EOF
                 # should be added back after treatment.
                 $d =~ /(\.a)?$/;
                 my $e = $1 // &quot;&quot;;
-                $d = $`;
-                if ($unified_info{rename}-&gt;{$d}) {
-                    $d = $unified_info{rename}-&gt;{$d};
-                }
-                $d .= $e;
+                $d = $`.$e;
                 $unified_info{depends}-&gt;{$ddest}-&gt;{$d} = 1;
             }
         }
@@ -2182,9 +2084,6 @@ EOF
             # a generated file in the build tree.
             if ($ddest eq $src_configdata || ! -f $ddest) {
                 $ddest = cleanfile($buildd, $_, $blddir);
-                if ($unified_info{rename}-&gt;{$ddest}) {
-                    $ddest = $unified_info{rename}-&gt;{$ddest};
-                }
             }
             foreach (@{$includes{$dest}}) {
                 my $is = cleandir($sourced, $_, $blddir);
diff --git a/build.info b/build.info
index afcb772..bea1441 100644
--- a/build.info
+++ b/build.info
@@ -2,15 +2,6 @@
 # %skipdir there for further explanations.
 SUBDIRS=crypto ssl apps test util tools fuzz engines
 
-{-
-     my @sover = split(/\./, $config{shlib_version});
-     our $sover_filename;
-     $sover_filename = join('.', @sover)
-         if $config{target} =~ /^mingw/ || $config{target} =~ /^VC-/;
-     $sover_filename = join('', map { sprintf &quot;%02d&quot;, $_ } @sover)
-         if $config{target} =~ /^vms/;
-     &quot;&quot;;
--}
 LIBS=libcrypto libssl
 INCLUDE[libcrypto]=. crypto/include include
 INCLUDE[libssl]=. include
@@ -44,26 +35,3 @@ IF[{- $config{target} =~ /^(?:Cygwin|mingw|VC-)/ -}]
   SHARED_SOURCE[libcrypto]=libcrypto.rc
   SHARED_SOURCE[libssl]=libssl.rc
 ENDIF
-
-IF[{- $config{target} =~ /^Cygwin/ -}]
- SHARED_NAME[libcrypto]=cygcrypto-{- $sover_filename -}
- SHARED_NAME[libssl]=cygssl-{- $sover_filename -}
-ELSIF[{- $config{target} =~ /^mingw/ -}]
- SHARED_NAME[libcrypto]=libcrypto-{- $sover_filename -}{- $config{target} eq &quot;mingw64&quot; ? &quot;-x64&quot; : &quot;&quot; -}
- SHARED_NAME[libssl]=libssl-{- $sover_filename -}{- $config{target} eq &quot;mingw64&quot; ? &quot;-x64&quot; : &quot;&quot; -}
-ELSIF[{- $config{target} =~ /^VC-/ -}]
- SHARED_NAME[libcrypto]=libcrypto-{- $sover_filename -}{- $target{multilib} -}
- SHARED_NAME[libssl]=libssl-{- $sover_filename -}{- $target{multilib} -}
-ENDIF
-
-# VMS has a cultural standard where all libraries are prefixed.
-# For OpenSSL, the choice is 'ossl$' (this prefix was claimed in a
-# conversation with VSI, Tuesday January 26 2016)
-# Also, it seems it's usual to have the pointer size the libraries
-# were built for as part of the name.
-IF[{- $config{target} =~ /^vms/ -}]
- RENAME[libcrypto]=ossl$libcrypto{- $target{pointer_size} -}
- RENAME[libssl]=ossl$libssl{- $target{pointer_size} -}
- SHARED_NAME[libcrypto]=ossl$libcrypto{- $sover_filename -}_shr{- $target{pointer_size} -}
- SHARED_NAME[libssl]=ossl$libssl{- $sover_filename -}_shr{- $target{pointer_size} -}
-ENDIF
diff --git a/crypto/include/internal/dso_conf.h.in b/crypto/include/internal/dso_conf.h.in
index af9e307..6e6b9bc 100644
--- a/crypto/include/internal/dso_conf.h.in
+++ b/crypto/include/internal/dso_conf.h.in
@@ -25,6 +25,6 @@
         @macros = ( &quot;DSO_DLFCN&quot; );
     }
     join(&quot;\n&quot;, map { &quot;# define $_&quot; } @macros); -}
-# define DSO_EXTENSION &quot;{- $target{dso_extension} -}&quot;
+# define DSO_EXTENSION &quot;{- platform-&gt;dsoext() -}&quot;
 {- output_on() if $disabled{dso} -}
 #endif
diff --git a/test/recipes/90-test_shlibload.t b/test/recipes/90-test_shlibload.t
index ea8aeeb..1f097ed 100644
--- a/test/recipes/90-test_shlibload.t
+++ b/test/recipes/90-test_shlibload.t
@@ -6,7 +6,7 @@
 # in the file LICENSE in the source distribution or at
 # <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
 
-use OpenSSL::Test qw/:DEFAULT bldtop_dir bldtop_file/;
+use OpenSSL::Test qw/:DEFAULT srctop_dir bldtop_dir/;
 use OpenSSL::Test::Utils;
 use File::Temp qw(tempfile);
 
@@ -15,21 +15,17 @@ use File::Temp qw(tempfile);
 BEGIN {
     setup(&quot;test_shlibload&quot;);
 }
+use lib srctop_dir('Configurations');
 use lib bldtop_dir('.');
-use configdata;
+use platform;
 
 plan skip_all =&gt; &quot;Test only supported in a shared build&quot; if disabled(&quot;shared&quot;);
 plan skip_all =&gt; &quot;Test is disabled on AIX&quot; if config('target') =~ m|^aix|;
 
 plan tests =&gt; 10;
 
-# When libssl and libcrypto are compiled on Linux with &quot;-rpath&quot;, but not
-# &quot;--enable-new-dtags&quot;, the RPATH takes precedence over LD_LIBRARY_PATH,
-# and we end up running with the wrong libraries.  This is resolved by
-# using paths to the shared objects, not just the names.
-
-my $libcrypto = bldtop_file(shlib('libcrypto'));
-my $libssl = bldtop_file(shlib('libssl'));
+my $libcrypto = platform-&gt;sharedlib('libcrypto');
+my $libssl = platform-&gt;sharedlib('libssl');
 
 (my $fh, my $filename) = tempfile();
 ok(run(test([&quot;shlibloadtest&quot;, &quot;-crypto_first&quot;, $libcrypto, $libssl, $filename])),
@@ -57,17 +53,6 @@ ok(run(test([&quot;shlibloadtest&quot;, &quot;-no_atexit&quot;, $libcrypto, $libssl, $filename])),
 ok(!check_atexit($fh));
 unlink $filename;
 
-sub shlib {
-    my $lib = shift;
-    $lib = $unified_info{rename}-&gt;{$lib}
-        if defined $unified_info{rename}-&gt;{$lib};
-    $lib = $unified_info{sharednames}-&gt;{$lib}
-        . ($target{shlib_variant} || &quot;&quot;)
-        . ($target{shared_extension} || &quot;.so&quot;);
-    $lib =~ s|\.\$\(SHLIB_VERSION_NUMBER\)|.$config{shlib_version}|;
-    return $lib;
-}
-
 sub check_atexit {
     my $fh = shift;
     my $data = &lt;$fh&gt;;
diff --git a/util/dofile.pl b/util/dofile.pl
index c5d9e77..10a1ad8 100644
--- a/util/dofile.pl
+++ b/util/dofile.pl
@@ -176,10 +176,20 @@ my $text =
 # Load the full template (combination of files) into Text::Template
 # and fill it up with our data.  Output goes directly to STDOUT
 
+my $prepend = qq{
+use File::Spec::Functions;
+use lib catdir('$config{sourcedir}', 'util', 'perl');
+};
+$prepend .= qq{
+use lib catdir('$config{sourcedir}', 'Configurations');
+use lib '$config{builddir}';
+use platform;
+} if defined $target{perl_platform};
+
 my $template =
     OpenSSL::Template-&gt;new(TYPE =&gt; 'STRING',
                            SOURCE =&gt; $text,
-                           PREPEND =&gt; qq{use lib &quot;$FindBin::Bin/perl&quot;;});
+                           PREPEND =&gt; $prepend);
 
 sub output_reset_on {
     $template-&gt;output_reset_on();
diff --git a/util/local_shlib.com.in b/util/local_shlib.com.in
index e49aa15..b3484e1 100644
--- a/util/local_shlib.com.in
+++ b/util/local_shlib.com.in
@@ -1,10 +1,7 @@
 ${-
-  use File::Spec::Functions qw(rel2abs);
-
-  my $bldtop = rel2abs($config{builddir});
-  our %names = ( map { $_ =&gt; $bldtop.$_.&quot;.EXE&quot; }
-                 map { $unified_info{sharednames}-&gt;{$_} || () }
-                 @{$unified_info{libraries}} );
+  our %names = ( map { platform-&gt;sharedname($_) =&gt;
+                           $bldtop.platform-&gt;sharedlib($_) }
+                 @{$unified_info{install}-&gt;{libraries}} );
   &quot;&quot; -}
 $       ! Create a local environment with the shared library logical names
 $       ! properly set.  Undo this with unlocal_shlib.com
@@ -15,7 +12,7 @@ $       DEFINE/TABLE='OPENSSL_NAMES' OSSL_FLAG YES
 $
 $       NAMES := {- join(&quot;,&quot;, keys %names); -}
 {-
-  join(&quot;\n&quot;, map { &quot;\$       __$_ = \&quot;&quot;.$names{$_}.&quot;\&quot;&quot; } keys %names);
+  join(&quot;\n&quot;, map { &quot;\$       __$_ = \&quot;&quot;.$names{$_}.&quot;\&quot;&quot; } sort keys %names);
 -}      
 $       I = 0
 $       LOOP:
diff --git a/util/mkdef.pl b/util/mkdef.pl
index 8f37fbe..83c9d79 100755
--- a/util/mkdef.pl
+++ b/util/mkdef.pl
@@ -21,6 +21,10 @@ use OpenSSL::Ordinals;
 use lib '.';
 use configdata;
 
+use File::Spec::Functions;
+use lib catdir($config{sourcedir}, 'Configurations');
+use platform;
+
 my $name = undef;               # internal library/module name
 my $ordinals_file = undef;      # the ordinals file to use
 my $version = undef;            # the version to use for the library
@@ -100,7 +104,7 @@ my $apiv = undef;
 $apiv = sprintf &quot;%x%02x%02x&quot;, split(/\./, $config{api})
     if $config{api};
 
-my $libname = $unified_info{sharednames}-&gt;{$name} // $name;
+my $libname = platform-&gt;sharedname($name);
 
 my %OS_data = (
     solaris     =&gt; { writer     =&gt; \&amp;writer_linux,
diff --git a/util/shlib_wrap.sh.in b/util/shlib_wrap.sh.in
index fc0687d..7024caf 100755
--- a/util/shlib_wrap.sh.in
+++ b/util/shlib_wrap.sh.in
@@ -2,20 +2,8 @@
 {-
     use lib '.';
     use configdata;
-
-    sub shlib {
-        my $lib = shift;
-        return &quot;&quot; if $disabled{shared};
-        $lib = $unified_info{rename}-&gt;{$lib}
-            if defined $unified_info{rename}-&gt;{$lib};
-        $lib = $unified_info{sharednames}-&gt;{$lib}
-            . ($target{shlib_variant} || &quot;&quot;)
-            . ($target{shared_extension} || &quot;.so&quot;);
-        $lib =~ s|\.\$\(SHLIB_VERSION_NUMBER\)
-                 |.$config{shlib_version}|x;
-        return $lib;
-    }
-    &quot;&quot;;     # Make sure no left over string sneaks its way into the script
+    use lib catdir($config{sourcedir}, 'Configurations');
+    use platform;
 -}
 # To test this OpenSSL version's applications against another version's
 # shared libraries, simply set
@@ -42,8 +30,8 @@ fi
 THERE=&quot;`echo $0 | sed -e 's|[^/]*$||' 2&gt;/dev/null`..&quot;
 [ -d &quot;${THERE}&quot; ] || exec &quot;$@&quot;	# should never happen...
 
-LIBCRYPTOSO=&quot;${THERE}/{- shlib('libcrypto') -}&quot;
-LIBSSLSO=&quot;${THERE}/{- shlib('libssl') -}&quot;
+LIBCRYPTOSO=&quot;${THERE}/{- platform-&gt;sharedlib('libcrypto') -}&quot;
+LIBSSLSO=&quot;${THERE}/{- platform-&gt;sharedlib('libssl') -}&quot;
 
 SYSNAME=`(uname -s) 2&gt;/dev/null`;
 case &quot;$SYSNAME&quot; in
diff --git a/util/unlocal_shlib.com.in b/util/unlocal_shlib.com.in
index dd4fd2a..f9ae76b 100644
--- a/util/unlocal_shlib.com.in
+++ b/util/unlocal_shlib.com.in
@@ -1,17 +1,14 @@
 ${-
-  use File::Spec::Functions qw(rel2abs);
-
-  my $bldtop = rel2abs($config{builddir});
-  our %names = ( map { $_ =&gt; $bldtop.$_.&quot;.EXE&quot; }
-                 map { $unified_info{sharednames}-&gt;{$_} || () }
-                 @{$unified_info{libraries}} );
+  our %names = ( map { platform-&gt;sharedname($_) =&gt;
+                           $bldtop.platform-&gt;sharedlib($_) }
+                 @{$unified_info{install}-&gt;{libraries}} );
   &quot;&quot; -}
 $       ! Remove the local environment created by local_shlib.com
 $
 $       OPENSSL_NAMES := OPENSSL_NAMES_'F$GETJPI(&quot;&quot;,&quot;PID&quot;)'
 $       IF F$TRNLNM(&quot;OSSL_FLAG&quot;,OPENSSL_NAMES) .EQS. &quot;&quot; THEN EXIT 0
 $
-$       NAMES := {- join(&quot;,&quot;, keys %names); -}
+$       NAMES := {- join(&quot;,&quot;, sort keys %names); -}
 $       I = 0
 $       LOOP:
 $           E = F$ELEMENT(I,&quot;,&quot;,NAMES)
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021678.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="021685.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21680">[ date ]</a>
              <a href="thread.html#21680">[ thread ]</a>
              <a href="subject.html#21680">[ subject ]</a>
              <a href="author.html#21680">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
