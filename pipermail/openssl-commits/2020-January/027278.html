<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2020-January/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1580319879.360944.13313.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027275.html">
   <LINK REL="Next"  HREF="027281.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl]  master update</H1>
    <B>matthias.st.pierre at ncp-e.com</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1580319879.360944.13313.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl]  master update">matthias.st.pierre at ncp-e.com
       </A><BR>
    <I>Wed Jan 29 17:44:39 UTC 2020</I>
    <P><UL>
        <LI>Previous message: <A HREF="027275.html">[openssl]  master update
</A></li>
        <LI>Next message: <A HREF="027281.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27278">[ date ]</a>
              <a href="thread.html#27278">[ thread ]</a>
              <a href="subject.html#27278">[ subject ]</a>
              <a href="author.html#27278">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  68581885cba2a64c47bae7fdd8674be852d0c74c (commit)
       via  65718c516ec69ff2314d12c7ce57b242ccc3021d (commit)
       via  62742fdd8ca46c5455441b9e5e5ddb746c8d38e2 (commit)
      from  12603de634fe628488066d1f3f2c720ca20d6df9 (commit)


- Log -----------------------------------------------------------------
commit 68581885cba2a64c47bae7fdd8674be852d0c74c
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at akamai.com</A>&gt;
Date:   Fri Jan 24 13:32:34 2020 -0500

    Add -issuer_checks to verify options
    
    Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
    Reviewed-by: Dmitry Belyavskiy &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">beldmit at gmail.com</A>&gt;
    Reviewed-by: Matthias St. Pierre &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">Matthias.St.Pierre at ncp-e.com</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/10873">https://github.com/openssl/openssl/pull/10873</A>)

commit 65718c516ec69ff2314d12c7ce57b242ccc3021d
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at akamai.com</A>&gt;
Date:   Thu Jan 16 13:40:52 2020 -0500

    Document most missing options
    
    Add cmd-nits make target.
    
    Listing options should stop when it hits the &quot;parameters&quot; separator.
    
    Add missing .pod.in files to doc/man1/build.info
    
    Tweak find-doc-nits to try openssl-XXX before XXX for POD files and
    change an error messavge to be more useful.
    
    Fix the following pages: ca, cms, crl, dgst, enc,
    engine, errstr, gendsa, genrsa, list, ocsp, passwd, pkcs7, pkcs12, rand,
    rehash, req, rsautil, s_server, speed, s_time,
    sess_id, smime, srp, ts, x509.
    
    Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
    Reviewed-by: Dmitry Belyavskiy &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">beldmit at gmail.com</A>&gt;
    Reviewed-by: Matthias St. Pierre &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">Matthias.St.Pierre at ncp-e.com</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/10873">https://github.com/openssl/openssl/pull/10873</A>)

commit 62742fdd8ca46c5455441b9e5e5ddb746c8d38e2
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at akamai.com</A>&gt;
Date:   Mon Jan 20 09:45:27 2020 -0500

    Add more generated man1 doc files
    
    Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
    Reviewed-by: Dmitry Belyavskiy &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">beldmit at gmail.com</A>&gt;
    Reviewed-by: Matthias St. Pierre &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">Matthias.St.Pierre at ncp-e.com</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/10873">https://github.com/openssl/openssl/pull/10873</A>)

-----------------------------------------------------------------------

Summary of changes:
 .gitignore                        |  6 +--
 Configurations/unix-Makefile.tmpl |  7 +++-
 apps/list.c                       |  4 +-
 apps/s_time.c                     |  1 +
 doc/man1/build.info               | 84 ++++++++++++++++++++-------------------
 doc/man1/openssl-ca.pod.in        |  5 +++
 doc/man1/openssl-cms.pod.in       | 39 +++++++++++++++++-
 doc/man1/openssl-crl.pod.in       | 32 +++++++++++++++
 doc/man1/openssl-dgst.pod.in      | 10 +++--
 doc/man1/openssl-enc.pod.in       |  7 +++-
 doc/man1/openssl-engine.pod       |  5 +++
 doc/man1/openssl-errstr.pod       | 18 ++++++---
 doc/man1/openssl-gendsa.pod.in    |  6 +++
 doc/man1/openssl-genrsa.pod.in    |  6 ++-
 doc/man1/openssl-list.pod         | 10 +++++
 doc/man1/openssl-ocsp.pod.in      | 12 ++++++
 doc/man1/openssl-passwd.pod.in    |  5 +++
 doc/man1/openssl-pkcs12.pod.in    | 23 ++++++++++-
 doc/man1/openssl-pkcs7.pod.in     | 11 +++--
 doc/man1/openssl-rand.pod.in      |  3 ++
 doc/man1/openssl-rehash.pod       |  7 ++--
 doc/man1/openssl-req.pod.in       |  1 +
 doc/man1/openssl-rsautl.pod.in    | 22 +++++++++-
 doc/man1/openssl-s_server.pod.in  | 12 ++++++
 doc/man1/openssl-s_time.pod.in    | 19 ++++++++-
 doc/man1/openssl-sess_id.pod      |  1 +
 doc/man1/openssl-smime.pod.in     | 39 ++++++++++++++----
 doc/man1/openssl-speed.pod.in     | 22 ++++++++++
 doc/man1/openssl-srp.pod.in       |  3 ++
 doc/man1/openssl-ts.pod.in        | 11 +++++
 doc/man1/openssl-x509.pod.in      | 33 +++++++++++++++
 doc/perlvars.pm                   |  5 ++-
 util/find-doc-nits                | 17 +++++---
 33 files changed, 396 insertions(+), 90 deletions(-)

diff --git a/.gitignore b/.gitignore
index 691e88a13e..52c845300b 100644
--- a/.gitignore
+++ b/.gitignore
@@ -26,7 +26,7 @@
 /include/openssl/opensslv.h
 
 # Auto generated doc files
-# If you add to this list, make sure doc/man1/build.info is sync'd!
+# Keep this in sync with doc/man1/build.info
 doc/man1/openssl-ca.pod
 doc/man1/openssl-cms.pod
 doc/man1/openssl-crl.pod
@@ -37,12 +37,9 @@ doc/man1/openssl-dsaparam.pod
 doc/man1/openssl-ec.pod
 doc/man1/openssl-ecparam.pod
 doc/man1/openssl-enc.pod
-doc/man1/openssl-engine.pod
 doc/man1/openssl-gendsa.pod
 doc/man1/openssl-genpkey.pod
 doc/man1/openssl-genrsa.pod
-doc/man1/openssl-info.pod
-doc/man1/openssl-list.pod
 doc/man1/openssl-ocsp.pod
 doc/man1/openssl-passwd.pod
 doc/man1/openssl-pkcs12.pod
@@ -66,7 +63,6 @@ doc/man1/openssl-storeutl.pod
 doc/man1/openssl-ts.pod
 doc/man1/openssl-verify.pod
 doc/man1/openssl-x509.pod
-doc/man1/openssl.pod
 
 # error code files
 /crypto/err/openssl.txt.old
diff --git a/Configurations/unix-Makefile.tmpl b/Configurations/unix-Makefile.tmpl
index 62ca26dde5..14e6627d62 100644
--- a/Configurations/unix-Makefile.tmpl
+++ b/Configurations/unix-Makefile.tmpl
@@ -516,7 +516,7 @@ clean: libclean
 	-$(RM) `find . -name '*{- platform-&gt;depext() -}' \! -name '.*' \! -type d -print`
 	-$(RM) `find . -name '*{- platform-&gt;objext() -}' \! -name '.*' \! -type d -print`
 	$(RM) core
-	$(RM) tags TAGS doc-nits
+	$(RM) tags TAGS doc-nits cmd-nits
 	$(RM) -r test/test-runs
 	$(RM) openssl.pc libcrypto.pc libssl.pc
 	-$(RM) `find . -type l \! -name '.*' -print`
@@ -950,10 +950,13 @@ update: generate errors ordinals
 generate: generate_apps generate_crypto_bn generate_crypto_objects \
           generate_crypto_conf generate_crypto_asn1 generate_fuzz_oids
 
-.PHONY: doc-nits
+.PHONY: doc-nits cmd-nits
 doc-nits: build_generated
 	(cd $(SRCDIR); $(PERL) util/find-doc-nits -n -l -e )
 
+cmd-nits: build_generated apps/openssl
+	(cd $(SRCDIR); $(PERL) util/find-doc-nits -c )
+
 # Test coverage is a good idea for the future
 #coverage: $(PROGRAMS) $(TESTPROGRAMS)
 #	...
diff --git a/apps/list.c b/apps/list.c
index a5382ac24f..ed6f1c71ac 100644
--- a/apps/list.c
+++ b/apps/list.c
@@ -364,10 +364,12 @@ static void list_options_for_command(const char *command)
     for ( ; o-&gt;name != NULL; o++) {
         char c = o-&gt;valtype;
 
+        if (o-&gt;name == OPT_PARAM_STR)
+            break;
+
         if (o-&gt;name == OPT_HELP_STR
                 || o-&gt;name == OPT_MORE_STR
                 || o-&gt;name == OPT_SECTION_STR
-                || o-&gt;name == OPT_PARAM_STR
                 || o-&gt;name[0] == '\0')
             continue;
         BIO_printf(bio_out, &quot;%s %c\n&quot;, o-&gt;name, c == '\0' ? '-' : c);
diff --git a/apps/s_time.c b/apps/s_time.c
index d5816a1b16..babbdbe13e 100644
--- a/apps/s_time.c
+++ b/apps/s_time.c
@@ -89,6 +89,7 @@ const OPTIONS s_time_options[] = {
     {&quot;cert&quot;, OPT_CERT, '&lt;', &quot;Cert file to use, PEM format assumed&quot;},
     {&quot;key&quot;, OPT_KEY, '&lt;', &quot;File with key, PEM; default is -cert file&quot;},
     {&quot;cafile&quot;, OPT_CAFILE, '&lt;', &quot;PEM format file of CA's&quot;},
+    {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;PEM format file of CA's&quot;},
     {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;PEM format directory of CA's&quot;},
     {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;URI to store of CA's&quot;},
     {&quot;no-CAfile&quot;, OPT_NOCAFILE, '-',
diff --git a/doc/man1/build.info b/doc/man1/build.info
index 2fbbb258b4..13012d4432 100644
--- a/doc/man1/build.info
+++ b/doc/man1/build.info
@@ -1,4 +1,5 @@
 
+# Keep this in sync with .gitignore!
 DEPEND[]= \
          openssl-ca.pod \
          openssl-cms.pod \
@@ -7,8 +8,8 @@ DEPEND[]= \
          openssl-dhparam.pod \
          openssl-dsa.pod \
          openssl-dsaparam.pod \
-         openssl-ecparam.pod \
          openssl-ec.pod \
+         openssl-ecparam.pod \
          openssl-enc.pod \
          openssl-gendsa.pod \
          openssl-genpkey.pod \
@@ -16,8 +17,8 @@ DEPEND[]= \
          openssl-ocsp.pod \
          openssl-passwd.pod \
          openssl-pkcs12.pod \
-         openssl-pkcs8.pod \
          openssl-pkcs7.pod \
+         openssl-pkcs8.pod \
          openssl-pkey.pod \
          openssl-pkeyparam.pod \
          openssl-pkeyutl.pod \
@@ -31,81 +32,82 @@ DEPEND[]= \
          openssl-smime.pod \
          openssl-speed.pod \
          openssl-spkac.pod \
-         openssl-storeutl.pod \
          openssl-srp.pod \
+         openssl-storeutl.pod \
          openssl-ts.pod \
          openssl-verify.pod \
          openssl-x509.pod
 
 DEPEND[openssl-ca.pod]=../perlvars.pm
-GENERATE[openssl-ca.pod]=openssl-ca.pod.in
 DEPEND[openssl-cms.pod]=../perlvars.pm
-GENERATE[openssl-cms.pod]=openssl-cms.pod.in
 DEPEND[openssl-crl.pod]=../perlvars.pm
-GENERATE[openssl-crl.pod]=openssl-crl.pod.in
 DEPEND[openssl-dgst.pod]=../perlvars.pm
-GENERATE[openssl-dgst.pod]=openssl-dgst.pod.in
 DEPEND[openssl-dhparam.pod]=../perlvars.pm
-GENERATE[openssl-dhparam.pod]=openssl-dhparam.pod.in
 DEPEND[openssl-dsa.pod]=../perlvars.pm
-GENERATE[openssl-dsa.pod]=openssl-dsa.pod.in
 DEPEND[openssl-dsaparam.pod]=../perlvars.pm
-GENERATE[openssl-dsaparam.pod]=openssl-dsaparam.pod.in
-DEPEND[openssl-ecparam.pod]=../perlvars.pm
-GENERATE[openssl-ecparam.pod]=openssl-ecparam.pod.in
 DEPEND[openssl-ec.pod]=../perlvars.pm
-GENERATE[openssl-ec.pod]=openssl-ec.pod.in
+DEPEND[openssl-ecparam.pod]=../perlvars.pm
 DEPEND[openssl-enc.pod]=../perlvars.pm
-GENERATE[openssl-enc.pod]=openssl-enc.pod.in
 DEPEND[openssl-gendsa.pod]=../perlvars.pm
-GENERATE[openssl-gendsa.pod]=openssl-gendsa.pod.in
 DEPEND[openssl-genpkey.pod]=../perlvars.pm
-GENERATE[openssl-genpkey.pod]=openssl-genpkey.pod.in
 DEPEND[openssl-genrsa.pod]=../perlvars.pm
-GENERATE[openssl-genrsa.pod]=openssl-genrsa.pod.in
 DEPEND[openssl-ocsp.pod]=../perlvars.pm
-GENERATE[openssl-ocsp.pod]=openssl-ocsp.pod.in
 DEPEND[openssl-passwd.pod]=../perlvars.pm
-GENERATE[openssl-passwd.pod]=openssl-passwd.pod.in
+DEPEND[openssl-pkcs12.pod]=../perlvars.pm
 DEPEND[openssl-pkcs7.pod]=../perlvars.pm
-GENERATE[openssl-pkcs7.pod]=openssl-pkcs7.pod.in
 DEPEND[openssl-pkcs8.pod]=../perlvars.pm
-GENERATE[openssl-pkcs8.pod]=openssl-pkcs8.pod.in
-DEPEND[openssl-pkcs12.pod]=../perlvars.pm
-GENERATE[openssl-pkcs12.pod]=openssl-pkcs12.pod.in
 DEPEND[openssl-pkey.pod]=../perlvars.pm
-GENERATE[openssl-pkey.pod]=openssl-pkey.pod.in
 DEPEND[openssl-pkeyparam.pod]=../perlvars.pm
-GENERATE[openssl-pkeyparam.pod]=openssl-pkeyparam.pod.in
 DEPEND[openssl-pkeyutl.pod]=../perlvars.pm
-GENERATE[openssl-pkeyutl.pod]=openssl-pkeyutl.pod.in
 DEPEND[openssl-rand.pod]=../perlvars.pm
-GENERATE[openssl-rand.pod]=openssl-rand.pod.in
 DEPEND[openssl-req.pod]=../perlvars.pm
-GENERATE[openssl-req.pod]=openssl-req.pod.in
 DEPEND[openssl-rsa.pod]=../perlvars.pm
-GENERATE[openssl-rsa.pod]=openssl-rsa.pod.in
 DEPEND[openssl-rsautl.pod]=../perlvars.pm
-GENERATE[openssl-rsautl.pod]=openssl-rsautl.pod.in
 DEPEND[openssl-s_client.pod]=../perlvars.pm
-GENERATE[openssl-s_client.pod]=openssl-s_client.pod.in
 DEPEND[openssl-s_server.pod]=../perlvars.pm
-GENERATE[openssl-s_server.pod]=openssl-s_server.pod.in
 DEPEND[openssl-s_time.pod]=../perlvars.pm
-GENERATE[openssl-s_time.pod]=openssl-s_time.pod.in
 DEPEND[openssl-smime.pod]=../perlvars.pm
-GENERATE[openssl-smime.pod]=openssl-smime.pod.in
 DEPEND[openssl-speed.pod]=../perlvars.pm
-GENERATE[openssl-speed.pod]=openssl-speed.pod.in
 DEPEND[openssl-spkac.pod]=../perlvars.pm
-GENERATE[openssl-spkac.pod]=openssl-spkac.pod.in
-DEPEND[openssl-storeutl.pod]=../perlvars.pm
-GENERATE[openssl-storeutl.pod]=openssl-storeutl.pod.in
 DEPEND[openssl-srp.pod]=../perlvars.pm
-GENERATE[openssl-srp.pod]=openssl-srp.pod.in
+DEPEND[openssl-storeutl.pod]=../perlvars.pm
 DEPEND[openssl-ts.pod]=../perlvars.pm
-GENERATE[openssl-ts.pod]=openssl-ts.pod.in
 DEPEND[openssl-verify.pod]=../perlvars.pm
-GENERATE[openssl-verify.pod]=openssl-verify.pod.in
 DEPEND[openssl-x509.pod]=../perlvars.pm
+
+GENERATE[openssl-ca.pod]=openssl-ca.pod.in
+GENERATE[openssl-cms.pod]=openssl-cms.pod.in
+GENERATE[openssl-crl.pod]=openssl-crl.pod.in
+GENERATE[openssl-dgst.pod]=openssl-dgst.pod.in
+GENERATE[openssl-dhparam.pod]=openssl-dhparam.pod.in
+GENERATE[openssl-dsa.pod]=openssl-dsa.pod.in
+GENERATE[openssl-dsaparam.pod]=openssl-dsaparam.pod.in
+GENERATE[openssl-ec.pod]=openssl-ec.pod.in
+GENERATE[openssl-ecparam.pod]=openssl-ecparam.pod.in
+GENERATE[openssl-enc.pod]=openssl-enc.pod.in
+GENERATE[openssl-gendsa.pod]=openssl-gendsa.pod.in
+GENERATE[openssl-genpkey.pod]=openssl-genpkey.pod.in
+GENERATE[openssl-genrsa.pod]=openssl-genrsa.pod.in
+GENERATE[openssl-ocsp.pod]=openssl-ocsp.pod.in
+GENERATE[openssl-passwd.pod]=openssl-passwd.pod.in
+GENERATE[openssl-pkcs12.pod]=openssl-pkcs12.pod.in
+GENERATE[openssl-pkcs7.pod]=openssl-pkcs7.pod.in
+GENERATE[openssl-pkcs8.pod]=openssl-pkcs8.pod.in
+GENERATE[openssl-pkey.pod]=openssl-pkey.pod.in
+GENERATE[openssl-pkeyparam.pod]=openssl-pkeyparam.pod.in
+GENERATE[openssl-pkeyutl.pod]=openssl-pkeyutl.pod.in
+GENERATE[openssl-rand.pod]=openssl-rand.pod.in
+GENERATE[openssl-req.pod]=openssl-req.pod.in
+GENERATE[openssl-rsa.pod]=openssl-rsa.pod.in
+GENERATE[openssl-rsautl.pod]=openssl-rsautl.pod.in
+GENERATE[openssl-s_client.pod]=openssl-s_client.pod.in
+GENERATE[openssl-s_server.pod]=openssl-s_server.pod.in
+GENERATE[openssl-s_time.pod]=openssl-s_time.pod.in
+GENERATE[openssl-smime.pod]=openssl-smime.pod.in
+GENERATE[openssl-speed.pod]=openssl-speed.pod.in
+GENERATE[openssl-spkac.pod]=openssl-spkac.pod.in
+GENERATE[openssl-srp.pod]=openssl-srp.pod.in
+GENERATE[openssl-storeutl.pod]=openssl-storeutl.pod.in
+GENERATE[openssl-ts.pod]=openssl-ts.pod.in
+GENERATE[openssl-verify.pod]=openssl-verify.pod.in
 GENERATE[openssl-x509.pod]=openssl-x509.pod.in
diff --git a/doc/man1/openssl-ca.pod.in b/doc/man1/openssl-ca.pod.in
index 6d351ae1cc..720db228cb 100644
--- a/doc/man1/openssl-ca.pod.in
+++ b/doc/man1/openssl-ca.pod.in
@@ -23,6 +23,7 @@ B&lt;openssl&gt; B&lt;ca&gt;
 [B&lt;-crl_CA_compromise&gt; I&lt;time&gt;]
 [B&lt;-crldays&gt; I&lt;days&gt;]
 [B&lt;-crlhours&gt; I&lt;hours&gt;]
+[B&lt;-crlsec&gt; I&lt;seconds&gt;]
 [B&lt;-crlexts&gt; I&lt;section&gt;]
 [B&lt;-startdate&gt; I&lt;date&gt;]
 [B&lt;-enddate&gt; I&lt;date&gt;]
@@ -326,6 +327,10 @@ now to place in the CRL nextUpdate field.
 
 The number of hours before the next CRL is due.
 
+=item B&lt;-crlsec&gt; I&lt;num&gt;
+
+The number of seconds before the next CRL is due.
+
 =item B&lt;-revoke&gt; I&lt;filename&gt;
 
 A filename containing a certificate to revoke.
diff --git a/doc/man1/openssl-cms.pod.in b/doc/man1/openssl-cms.pod.in
index 3a919edae5..1965a952be 100644
--- a/doc/man1/openssl-cms.pod.in
+++ b/doc/man1/openssl-cms.pod.in
@@ -11,8 +11,13 @@ B&lt;openssl&gt; B&lt;cms&gt;
 [B&lt;-help&gt;]
 [B&lt;-encrypt&gt;]
 [B&lt;-decrypt&gt;]
+[B&lt;-debug_decrypt&gt;]
 [B&lt;-sign&gt;]
 [B&lt;-verify&gt;]
+[B&lt;-verify_retcode&gt;]
+[B&lt;-no_attr_verify&gt;]
+[B&lt;-nosigs&gt;]
+[B&lt;-no_content_verify&gt;]
 [B&lt;-cmsout&gt;]
 [B&lt;-resign&gt;]
 [B&lt;-cades&gt;]
@@ -22,6 +27,7 @@ B&lt;openssl&gt; B&lt;cms&gt;
 [B&lt;-digest_verify&gt;]
 [B&lt;-compress&gt;]
 [B&lt;-uncompress&gt;]
+[B&lt;-EncryptedData_decrypt&gt;]
 [B&lt;-EncryptedData_encrypt&gt;]
 [B&lt;-sign_receipt&gt;]
 [B&lt;-verify_receipt&gt; I&lt;receipt&gt;]
@@ -34,7 +40,6 @@ B&lt;openssl&gt; B&lt;cms&gt;
 [B&lt;-stream&gt;]
 [B&lt;-indef&gt;]
 [B&lt;-noindef&gt;]
-[B&lt;-noindef&gt;]
 [B&lt;-content&gt; I&lt;filename&gt;]
 [B&lt;-text&gt;]
 [B&lt;-noout&gt;]
@@ -50,6 +55,7 @@ B&lt;openssl&gt; B&lt;cms&gt;
 [B&lt;-crlfeol&gt;]
 [B&lt;-asciicrlf&gt;]
 [B&lt;-nodetach&gt;]
+[B&lt;-certfile&gt; I&lt;file&gt;]
 [B&lt;-certsout&gt; I&lt;file&gt;]
 [B&lt;-signer&gt; I&lt;file&gt;]
 [B&lt;-recip&gt; I&lt;file&gt;]
@@ -59,6 +65,7 @@ B&lt;openssl&gt; B&lt;cms&gt;
 [B&lt;-receipt_request_from&gt; I&lt;emailaddress&gt;]
 [B&lt;-receipt_request_to&gt; I&lt;emailaddress&gt;]
 [B&lt;-receipt_request_print&gt;]
+[B&lt;-pwri_password&gt; I&lt;password&gt;]
 [B&lt;-secretkey&gt; I&lt;key&gt;]
 [B&lt;-secretkeyid&gt; I&lt;id&gt;]
 [B&lt;-econtent_type&gt; I&lt;type&gt;]
@@ -71,6 +78,7 @@ B&lt;openssl&gt; B&lt;cms&gt;
 {- $OpenSSL::safe::opt_v_synopsis -}
 {- $OpenSSL::safe::opt_trust_synopsis -}
 {- $OpenSSL::safe::opt_r_synopsis -}
+{- $OpenSSL::safe::opt_engine_synopsis -}
 [I&lt;cert.pem&gt; ...]
 
 =for openssl ifdef des-wrap engine
@@ -123,6 +131,22 @@ to the output file.
 Verify signed mail. Expects a signed mail message on input and outputs
 the signed data. Both clear text and opaque signing is supported.
 
+=item B&lt;-verify_retcode&gt;
+
+Exit nonzero on verification failure.
+
+=item B&lt;-no_attr_verify&gt;
+
+Do not verify signed attribute signatures.
+
+=item B&lt;-no_content_verify&gt;
+
+Do not verify signed content signatures.
+
+=item B&lt;-nosigs&gt;
+
+Don't verify message signature.
+
 =item B&lt;-cmsout&gt;
 
 Takes an input message and writes out a PEM encoded CMS structure.
@@ -164,6 +188,11 @@ Uncompress a CMS B&lt;CompressedData&gt; type and output the content. OpenSSL must be
 compiled with B&lt;zlib&gt; support for this option to work, otherwise it will
 output an error.
 
+=item B&lt;-EncryptedData_decrypt&gt;
+
+Decrypt content using supplied symmetric key and algorithm using a CMS
+B&lt;EncryptedData&gt; type and output the content.
+
 =item B&lt;-EncryptedData_encrypt&gt;
 
 Encrypt content using supplied symmetric key and algorithm using a CMS
@@ -214,7 +243,7 @@ The signed receipt format for use with the B&lt;-receipt_verify&gt;; the default
 is B&lt;SMIME&gt;.
 See L&lt;openssl(1)/Format Options&gt; for details.
 
-=item B&lt;-stream&gt;, B&lt;-indef&gt;, B&lt;-noindef&gt;
+=item B&lt;-stream&gt;, B&lt;-indef&gt;
 
 The B&lt;-stream&gt; and B&lt;-indef&gt; options are equivalent and enable streaming I/O
 for encoding operations. This permits single pass processing of data without
@@ -385,6 +414,10 @@ option B&lt;must&gt; but supplied if a signed receipt it requested.
 For the B&lt;-verify&gt; operation print out the contents of any signed receipt
 requests.
 
+=item B&lt;-pwri_password&gt; I&lt;password&gt;
+
+Specify password for recipient.
+
 =item B&lt;-secretkey&gt; I&lt;key&gt;
 
 Specify symmetric key to use. The key must be supplied in hex format and be
@@ -442,6 +475,8 @@ Any verification errors cause the command to exit.
 
 {- $OpenSSL::safe::opt_r_item -}
 
+{- $OpenSSL::safe::opt_engine_item -}
+
 =item I&lt;cert.pem&gt; ...
 
 One or more certificates of message recipients: used when encrypting
diff --git a/doc/man1/openssl-crl.pod.in b/doc/man1/openssl-crl.pod.in
index 680a11d06c..c1272c2580 100644
--- a/doc/man1/openssl-crl.pod.in
+++ b/doc/man1/openssl-crl.pod.in
@@ -11,12 +11,19 @@ B&lt;openssl&gt; B&lt;crl&gt;
 [B&lt;-help&gt;]
 [B&lt;-inform&gt; B&lt;DER&gt;|B&lt;PEM&gt;]
 [B&lt;-outform&gt; B&lt;DER&gt;|B&lt;PEM&gt;]
+[B&lt;-key&gt; I&lt;filename&gt;]
 [B&lt;-keyform&gt; B&lt;DER&gt;|B&lt;PEM&gt;|B&lt;ENGINE&gt;]
 [B&lt;-text&gt;]
 [B&lt;-in&gt; I&lt;filename&gt;]
 [B&lt;-out&gt; I&lt;filename&gt;]
+[B&lt;-gendelta&gt; I&lt;filename&gt;]
+[B&lt;-badsig&gt;]
+[B&lt;-verify&gt;]
 [B&lt;-noout&gt;]
 [B&lt;-hash&gt;]
+[B&lt;-hash_old&gt;]
+[B&lt;-fingerprint&gt;]
+[B&lt;-crlnumber&gt;]
 [B&lt;-issuer&gt;]
 [B&lt;-lastupdate&gt;]
 [B&lt;-nextupdate&gt;]
@@ -42,6 +49,10 @@ Print out a usage message.
 The input and output formats of the CRL; the default is B&lt;PEM&gt;.
 See L&lt;openssl(1)/Format Options&gt; for details.
 
+=item B&lt;-key&gt; I&lt;filename&gt;
+
+The private key to be used to sign the CRL.
+
 =item B&lt;-keyform&gt; B&lt;DER&gt;|B&lt;PEM&gt;|B&lt;ENGINE&gt;
 
 The format of the private key file; the default is B&lt;PEM&gt;.
@@ -57,14 +68,35 @@ option is not specified.
 Specifies the output filename to write to or standard output by
 default.
 
+=item B&lt;-gendelta&gt; I&lt;filename&gt;
+
+Output a comparison of the main CRL and the one specified here.
+
+=item B&lt;-badsig&gt;
+
+Corrupt the signature before writing it; this can be useful
+for testing.
+
 =item B&lt;-text&gt;
 
 Print out the CRL in text form.
 
+=item B&lt;-verify&gt;
+
+Verify the signature in the CRL.
+
 =item B&lt;-noout&gt;
 
 Don't output the encoded version of the CRL.
 
+=item B&lt;-fingerprint&gt;
+
+Output the fingerprint of the CRL.
+
+=item B&lt;-crlnumber&gt;
+
+Output the number of the CRL.
+
 =item B&lt;-hash&gt;
 
 Output a hash of the issuer name. This can be use to lookup CRLs in
diff --git a/doc/man1/openssl-dgst.pod.in b/doc/man1/openssl-dgst.pod.in
index bd7b41cb37..caa5b0a45a 100644
--- a/doc/man1/openssl-dgst.pod.in
+++ b/doc/man1/openssl-dgst.pod.in
@@ -12,6 +12,7 @@ B&lt;openssl&gt; B&lt;dgst&gt;|I&lt;digest&gt;
 [B&lt;-help&gt;]
 [B&lt;-c&gt;]
 [B&lt;-d&gt;]
+[B&lt;-debug&gt;]
 [B&lt;-list&gt;]
 [B&lt;-hex&gt;]
 [B&lt;-binary&gt;]
@@ -25,10 +26,11 @@ B&lt;openssl&gt; B&lt;dgst&gt;|I&lt;digest&gt;
 [B&lt;-signature&gt; I&lt;filename&gt;]
 [B&lt;-sigopt&gt; I&lt;nm&gt;:I&lt;v&gt;]
 [B&lt;-hmac&gt; I&lt;key&gt;]
+[B&lt;-mac&gt; I&lt;alg&gt;]
+[B&lt;-macopt&gt; I&lt;nm&gt;:I&lt;v&gt;]
 [B&lt;-fips-fingerprint&gt;]
-[B&lt;-engine&gt; I&lt;id&gt;]
-[B&lt;-engine_impl&gt; I&lt;id&gt;]
 {- $OpenSSL::safe::opt_engine_synopsis -}
+[B&lt;-engine_impl&gt; I&lt;id&gt;]
 {- $OpenSSL::safe::opt_r_synopsis -}
 [I&lt;file&gt; ...]
 
@@ -62,7 +64,7 @@ supported digests, use the command C&lt;list --digest-commands&gt;.
 Print out the digest in two digit groups separated by colons, only relevant if
 the B&lt;-hex&gt; option is given as well.
 
-=item B&lt;-d&gt;
+=item B&lt;-d&gt;, B&lt;-debug&gt;
 
 Print out BIO debugging information.
 
@@ -177,7 +179,7 @@ Compute HMAC using a specific key for certain OpenSSL-FIPS operations.
 The engine is not used for digests unless the B&lt;-engine_impl&gt; option is
 used or it is configured to do so, see L&lt;config(5)/Engine Configuration Module&gt;.
 
-=item B&lt;-engine_impl&gt;
+=item B&lt;-engine_impl&gt; I&lt;id&gt;
 
 When used with the B&lt;-engine&gt; option, it specifies to also use
 engine I&lt;id&gt; for digest operations.
diff --git a/doc/man1/openssl-enc.pod.in b/doc/man1/openssl-enc.pod.in
index cff127d211..515a452f70 100644
--- a/doc/man1/openssl-enc.pod.in
+++ b/doc/man1/openssl-enc.pod.in
@@ -35,12 +35,13 @@ B&lt;openssl&gt; B&lt;enc&gt;|I&lt;cipher&gt;
 [B&lt;-P&gt;]
 [B&lt;-bufsize&gt; I&lt;number&gt;]
 [B&lt;-nopad&gt;]
+[B&lt;-v&gt;]
 [B&lt;-debug&gt;]
 [B&lt;-none&gt;]
 {- $OpenSSL::safe::opt_engine_synopsis -}
 {- $OpenSSL::safe::opt_r_synopsis -}
 
-=for openssl ifdef z engine
+=for openssl ifdef z engine ciphers
 
 B&lt;openssl&gt; I&lt;cipher&gt; [B&lt;...&gt;]
 
@@ -176,6 +177,10 @@ Set the buffer size for I/O.
 
 Disable standard block padding.
 
+=item B&lt;-v&gt;
+
+Verbose print; display some statistics about I/O and buffer sizes.
+
 =item B&lt;-debug&gt;
 
 Debug the BIOs used for I/O.
diff --git a/doc/man1/openssl-engine.pod b/doc/man1/openssl-engine.pod
index 30e391fd4e..7110ceecbc 100644
--- a/doc/man1/openssl-engine.pod
+++ b/doc/man1/openssl-engine.pod
@@ -7,6 +7,7 @@ openssl-engine - load and query engines
 =head1 SYNOPSIS
 
 B&lt;openssl engine&gt;
+[B&lt;-help&gt;]
 [B&lt;-v&gt;]
 [B&lt;-vv&gt;]
 [B&lt;-vvv&gt;]
@@ -29,6 +30,10 @@ Only those specified are queried.
 
 =over 4
 
+=item B&lt;-help&gt;
+
+Display an option summary.
+
 =item B&lt;-v&gt; B&lt;-vv&gt; B&lt;-vvv&gt; B&lt;-vvvv&gt;
 
 Provides information about each specified engine. The first flag lists
diff --git a/doc/man1/openssl-errstr.pod b/doc/man1/openssl-errstr.pod
index b19b9da75c..ea838d9eb2 100644
--- a/doc/man1/openssl-errstr.pod
+++ b/doc/man1/openssl-errstr.pod
@@ -6,24 +6,32 @@ openssl-errstr - lookup error codes
 
 =head1 SYNOPSIS
 
-B&lt;openssl errstr&gt; I&lt;error_code&gt;
+B&lt;openssl errstr&gt;
+[B&lt;-help&gt;]
+I&lt;error_code...&gt;
 
 =head1 DESCRIPTION
 
-Sometimes an application will not load error message and only
+Sometimes an application will not load error message texts and only
 numerical forms will be available. This command can be
 used to display the meaning of the hex code. The hex code is the hex digits
 after the second colon.
 
 =head1 OPTIONS
 
-None.
+=over 4
+
+=item B&lt;-help&gt;
+
+Display a usage message.
+
+=back
 
 =head1 EXAMPLES
 
 The error code:
 
- 27594:error:2006D080:lib(32):func(109):reason(128):bss_file.c:107:
+ 27594:error:2006D080:lib(32)::reason(128)::107:
 
 can be displayed with:
 
@@ -31,7 +39,7 @@ can be displayed with:
 
 to produce the error message:
 
- error:2006D080:BIO routines:BIO_new_file:no such file
+ error:2006D080:BIO routines::no such file
 
 =head1 COPYRIGHT
 
diff --git a/doc/man1/openssl-gendsa.pod.in b/doc/man1/openssl-gendsa.pod.in
index 46b9c70bba..e98d662a5a 100644
--- a/doc/man1/openssl-gendsa.pod.in
+++ b/doc/man1/openssl-gendsa.pod.in
@@ -10,6 +10,7 @@ openssl-gendsa - generate a DSA private key from a set of parameters
 B&lt;openssl&gt; B&lt;gendsa&gt;
 [B&lt;-help&gt;]
 [B&lt;-out&gt; I&lt;filename&gt;]
+[B&lt;-passout&gt; I&lt;arg&gt;]
 [B&lt;-aes128&gt;]
 [B&lt;-aes192&gt;]
 [B&lt;-aes256&gt;]
@@ -47,6 +48,11 @@ Print out a usage message.
 Output the key to the specified file. If this argument is not specified then
 standard output is used.
 
+=item B&lt;-passout&gt; I&lt;arg&gt;
+
+The passphrase used for the output file.
+See L&lt;openssl(1)/Pass Phrase Options&gt;.
+
 =item B&lt;-aes128&gt;, B&lt;-aes192&gt;, B&lt;-aes256&gt;, B&lt;-aria128&gt;, B&lt;-aria192&gt;, B&lt;-aria256&gt;, B&lt;-camellia128&gt;, B&lt;-camellia192&gt;, B&lt;-camellia256&gt;, B&lt;-des&gt;, B&lt;-des3&gt;, B&lt;-idea&gt;
 
 These options encrypt the private key with specified
diff --git a/doc/man1/openssl-genrsa.pod.in b/doc/man1/openssl-genrsa.pod.in
index 8a815ee960..ed264332ba 100644
--- a/doc/man1/openssl-genrsa.pod.in
+++ b/doc/man1/openssl-genrsa.pod.in
@@ -23,7 +23,9 @@ B&lt;openssl&gt; B&lt;genrsa&gt;
 [B&lt;-des&gt;]
 [B&lt;-des3&gt;]
 [B&lt;-idea&gt;]
-[B&lt;-f4&gt;|B&lt;-3&gt;]
+[B&lt;-F4&gt;]
+[B&lt;-f4&gt;]
+[B&lt;-3&gt;]
 [B&lt;-primes&gt; I&lt;num&gt;]
 [B&lt;-verbose&gt;]
 {- $OpenSSL::safe::opt_r_synopsis -}
@@ -61,7 +63,7 @@ cipher before outputting it. If none of these options is
 specified no encryption is used. If encryption is used a pass phrase is prompted
 for if it is not supplied via the B&lt;-passout&gt; argument.
 
-=item B&lt;-F4&gt;|B&lt;-3&gt;
+=item B&lt;-F4&gt;, B&lt;-f4&gt;, B&lt;-3&gt;
 
 The public exponent to use, either 65537 or 3. The default is 65537.
 
diff --git a/doc/man1/openssl-list.pod b/doc/man1/openssl-list.pod
index 5388b478a5..88bcc751e6 100644
--- a/doc/man1/openssl-list.pod
+++ b/doc/man1/openssl-list.pod
@@ -21,6 +21,8 @@ B&lt;openssl list&gt;
 [B&lt;-public-key-methods&gt;]
 [B&lt;-engines&gt;]
 [B&lt;-disabled&gt;]
+[B&lt;-objects&gt;]
+[B&lt;-options&gt; I&lt;command&gt;]
 
 =head1 DESCRIPTION
 
@@ -92,6 +94,14 @@ of the installation.
 Display a list of built in objects, i.e. OIDs with names.  They're listed in the
 format described in L&lt;config(5)/ASN1 Object Configuration Module&gt;.
 
+=item B&lt;-options&gt; I&lt;command&gt;
+
+Output a two-column list of the options accepted by the specified I&lt;command&gt;.
+The first is the option name, and the second is a one-character indication
+of what type of parameter it takes, if any.
+This is an internal option, used for checking that the documentation
+is complete.
+
 =back
 
 =head2 Display of algorithm names
diff --git a/doc/man1/openssl-ocsp.pod.in b/doc/man1/openssl-ocsp.pod.in
index a866a38ebc..c04d3659b9 100644
--- a/doc/man1/openssl-ocsp.pod.in
+++ b/doc/man1/openssl-ocsp.pod.in
@@ -30,6 +30,7 @@ B&lt;openssl&gt; B&lt;ocsp&gt;
 [B&lt;-host&gt; I&lt;host&gt;:I&lt;port&gt;]
 [B&lt;-multi&gt; I&lt;process-count&gt;]
 [B&lt;-header&gt;]
+[B&lt;-timeout&gt; I&lt;seconds&gt;]
 [B&lt;-path&gt;]
 [B&lt;-VAfile&gt; I&lt;file&gt;]
 [B&lt;-validity_period&gt; I&lt;n&gt;]
@@ -52,6 +53,8 @@ B&lt;openssl&gt; B&lt;ocsp&gt;
 [B&lt;-passin&gt; I&lt;arg&gt;]
 [B&lt;-rother&gt; I&lt;file&gt;]
 [B&lt;-rsigopt&gt; I&lt;nm&gt;:I&lt;v&gt;]
+[B&lt;-rmd&gt; I&lt;digest&gt;]
+[B&lt;-badsig&gt;]
 [B&lt;-resp_no_certs&gt;]
 [B&lt;-nmin&gt; I&lt;n&gt;]
 [B&lt;-ndays&gt; I&lt;n&gt;]
@@ -328,6 +331,15 @@ see L&lt;openssl(1)/Pass Phrase Options&gt;.
 Pass options to the signature algorithm when signing OCSP responses.
 Names and values of these options are algorithm-specific.
 
+=item B&lt;-rmd&gt; I&lt;digest&gt;
+
+The digest to use when signing the response.
+
+=item B&lt;-badsig&gt;
+
+Corrupt the response signature before writing it; this can be useful
+for testing.
+
 =item B&lt;-port&gt; I&lt;portnum&gt;
 
 Port to listen for OCSP requests on. The port may also be specified
diff --git a/doc/man1/openssl-passwd.pod.in b/doc/man1/openssl-passwd.pod.in
index 93039090a3..83ef7ba674 100644
--- a/doc/man1/openssl-passwd.pod.in
+++ b/doc/man1/openssl-passwd.pod.in
@@ -21,6 +21,7 @@ B&lt;openssl passwd&gt;
 [B&lt;-noverify&gt;]
 [B&lt;-quiet&gt;]
 [B&lt;-table&gt;]
+[B&lt;-reverse&gt;]
 {- $OpenSSL::safe::opt_r_synopsis -}
 [I&lt;password&gt;]
 
@@ -93,6 +94,10 @@ Don't output warnings when passwords given at the command line are truncated.
 In the output list, prepend the cleartext password and a TAB character
 to each password hash.
 
+=item B&lt;-reverse&gt;
+
+When the B&lt;-table&gt; option is used, reverse the order of cleartext and hash.
+
 {- $OpenSSL::safe::opt_r_item -}
 
 =back
diff --git a/doc/man1/openssl-pkcs12.pod.in b/doc/man1/openssl-pkcs12.pod.in
index bc2f4963d5..7d562b002e 100644
--- a/doc/man1/openssl-pkcs12.pod.in
+++ b/doc/man1/openssl-pkcs12.pod.in
@@ -24,8 +24,22 @@ B&lt;openssl&gt; B&lt;pkcs12&gt;
 [B&lt;-cacerts&gt;]
 [B&lt;-nokeys&gt;]
 [B&lt;-info&gt;]
-[B&lt;-des&gt; B&lt;-des3&gt; B&lt;-idea&gt; B&lt;-aes128&gt; B&lt;-aes192&gt; B&lt;-aes256&gt; B&lt;-aria128&gt; B&lt;-aria192&gt; B&lt;-aria256&gt; B&lt;-camellia128&gt; B&lt;-camellia192&gt; B&lt;-camellia256&gt; B&lt;-nodes&gt;]
-[B&lt;-iter&gt; I&lt;count&gt; | B&lt;-noiter&gt; | B&lt;-nomaciter&gt;]
+[B&lt;-des&gt;]
+[B&lt;-des3&gt;]
+[B&lt;-idea&gt;]
+[B&lt;-aes128&gt;]
+[B&lt;-aes192&gt;]
+[B&lt;-aes256&gt;]
+[B&lt;-aria128&gt;]
+[B&lt;-aria192&gt;]
+[B&lt;-aria256&gt;]
+[B&lt;-camellia128&gt;]
+[B&lt;-camellia192&gt;]
+[B&lt;-camellia256&gt;]
+[B&lt;-nodes&gt;]
+[B&lt;-iter&gt; I&lt;count&gt;]
+[B&lt;-noiter&gt;]
+[B&lt;-nomaciter&gt;]
 [B&lt;-maciter&gt;]
 [B&lt;-nomac&gt;]
 [B&lt;-twopass&gt;]
@@ -38,6 +52,7 @@ B&lt;openssl&gt; B&lt;pkcs12&gt;
 [B&lt;-password&gt; I&lt;arg&gt;]
 [B&lt;-passin&gt; I&lt;arg&gt;]
 [B&lt;-passout&gt; I&lt;arg&gt;]
+[B&lt;-LMK&gt;]
 [B&lt;-CSP&gt; I&lt;name&gt;]
 {- $OpenSSL::safe::opt_trust_synopsis -}
 {- $OpenSSL::safe::opt_r_synopsis -}
@@ -264,6 +279,10 @@ to be needed to use MAC iterations counts but they are now used by default.
 
 Don't attempt to provide the MAC integrity.
 
+=item B&lt;-LMK&gt;
+
+Add the &quot;Local Key Set&quot; identifier to the attributes.
+
 =item B&lt;-CSP&gt; I&lt;name&gt;
 
 Write I&lt;name&gt; as a Microsoft CSP name.
diff --git a/doc/man1/openssl-pkcs7.pod.in b/doc/man1/openssl-pkcs7.pod.in
index f62b69b52b..77ef9f9558 100644
--- a/doc/man1/openssl-pkcs7.pod.in
+++ b/doc/man1/openssl-pkcs7.pod.in
@@ -17,6 +17,7 @@ B&lt;openssl&gt; B&lt;pkcs7&gt;
 [B&lt;-outform&gt; B&lt;DER&gt;|B&lt;PEM&gt;]
 [B&lt;-in&gt; I&lt;filename&gt;]
 [B&lt;-out&gt; I&lt;filename&gt;]
+[B&lt;-print&gt;]
 [B&lt;-print_certs&gt;]
 [B&lt;-text&gt;]
 [B&lt;-noout&gt;]
@@ -30,8 +31,6 @@ This command processes PKCS#7 files.  Note that it only understands PKCS#7
 v 1.5 as specified in IETF RFC 2315.  It cannot currently parse CMS as
 described in IETF RFC 2630.
 
-There is no option to print out all the fields of a PKCS#7 file.
-
 =head1 OPTIONS
 
 =over 4
@@ -57,6 +56,10 @@ option is not specified.
 Specifies the output filename to write to or standard output by
 default.
 
+=item B&lt;-print&gt;
+
+Print out the full PKCS7 object.
+
 =item B&lt;-print_certs&gt;
 
 Prints out any certificates or CRLs contained in the file. They are
@@ -64,13 +67,13 @@ preceded by their subject and issuer names in one line format.
 
 =item B&lt;-text&gt;
 
-Prints out certificates details in full rather than just subject and
+Prints out certificate details in full rather than just subject and
 issuer names.
 
 =item B&lt;-noout&gt;
 
 Don't output the encoded version of the PKCS#7 structure (or certificates
-is B&lt;-print_certs&gt; is set).
+if B&lt;-print_certs&gt; is set).
 
 {- $OpenSSL::safe::opt_engine_item -}
 
diff --git a/doc/man1/openssl-rand.pod.in b/doc/man1/openssl-rand.pod.in
index fd41da379d..61c74df466 100644
--- a/doc/man1/openssl-rand.pod.in
+++ b/doc/man1/openssl-rand.pod.in
@@ -12,6 +12,7 @@ B&lt;openssl rand&gt;
 [B&lt;-out&gt; I&lt;file&gt;]
 [B&lt;-base64&gt;]
 [B&lt;-hex&gt;]
+{- $OpenSSL::safe::opt_engine_synopsis -}
 {- $OpenSSL::safe::opt_r_synopsis -}
 I&lt;num&gt;
 
@@ -42,6 +43,8 @@ Perform base64 encoding on the output.
 
 Show the output as a hex string.
 
+{- $OpenSSL::safe::opt_engine_item -}
+
 {- $OpenSSL::safe::opt_r_item -}
 
 =back
diff --git a/doc/man1/openssl-rehash.pod b/doc/man1/openssl-rehash.pod
index eed2864446..241f225380 100644
--- a/doc/man1/openssl-rehash.pod
+++ b/doc/man1/openssl-rehash.pod
@@ -15,6 +15,7 @@ B&lt;rehash&gt;
 [B&lt;-h&gt;]
 [B&lt;-help&gt;]
 [B&lt;-old&gt;]
+[B&lt;-compat&gt;]
 [B&lt;-n&gt;]
 [B&lt;-v&gt;]
 [I&lt;directory&gt;] ...
@@ -29,9 +30,9 @@ B&lt;c_rehash&gt;
 
 =head1 DESCRIPTION
 
-On some platforms, this command isn't available, and the external
-script B&lt;c_rehash&gt; has to be used instead.  They are functionally
-equivalent, except for minor differences noted below.
+This command is generally equivalent to the external
+script B&lt;c_rehash&gt;,
+except for minor differences noted below.
 
 B&lt;openssl rehash&gt; scans directories and calculates a hash value of
 each F&lt;.pem&gt;, F&lt;.crt&gt;, F&lt;.cer&gt;, or F&lt;.crl&gt;
diff --git a/doc/man1/openssl-req.pod.in b/doc/man1/openssl-req.pod.in
index cd49679d04..598e6a8d54 100644
--- a/doc/man1/openssl-req.pod.in
+++ b/doc/man1/openssl-req.pod.in
@@ -22,6 +22,7 @@ B&lt;openssl&gt; B&lt;req&gt;
 [B&lt;-modulus&gt;]
 [B&lt;-new&gt;]
 [B&lt;-newkey&gt; I&lt;arg&gt;]
+[B&lt;-pkeyopt&gt; I&lt;opt&gt;:I&lt;value&gt;]
 [B&lt;-nodes&gt;]
 [B&lt;-key&gt; I&lt;filename&gt;]
 [B&lt;-keyform&gt; B&lt;DER&gt;|B&lt;PEM&gt;]
diff --git a/doc/man1/openssl-rsautl.pod.in b/doc/man1/openssl-rsautl.pod.in
index 9cabb5f173..628e83c87c 100644
--- a/doc/man1/openssl-rsautl.pod.in
+++ b/doc/man1/openssl-rsautl.pod.in
@@ -10,6 +10,8 @@ openssl-rsautl - RSA utility
 B&lt;openssl&gt; B&lt;rsautl&gt;
 [B&lt;-help&gt;]
 [B&lt;-in&gt; I&lt;file&gt;]
+[B&lt;-passin&gt; I&lt;arg&gt;]
+[B&lt;-rev&gt;]
 [B&lt;-out&gt; I&lt;file&gt;]
 [B&lt;-inkey&gt; I&lt;file&gt;]
 [B&lt;-keyform&gt; B&lt;DER&gt;|B&lt;PEM&gt;|B&lt;ENGINE&gt;]
@@ -20,10 +22,16 @@ B&lt;openssl&gt; B&lt;rsautl&gt;
 [B&lt;-encrypt&gt;]
 [B&lt;-decrypt&gt;]
 [B&lt;-pkcs&gt;]
+[B&lt;-x931&gt;]
+[B&lt;-oaep&gt;]
+[B&lt;-ssl&gt;]
+[B&lt;-raw&gt;]
+[B&lt;-pkcs&gt;]
 [B&lt;-ssl&gt;]
 [B&lt;-raw&gt;]
 [B&lt;-hexdump&gt;]
 [B&lt;-asn1parse&gt;]
+{- $OpenSSL::safe::opt_engine_synopsis -}
 {- $OpenSSL::safe::opt_r_synopsis -}
 
 =for openssl ifdef engine
@@ -46,6 +54,15 @@ Print out a usage message.
 This specifies the input filename to read data from or standard input
 if this option is not specified.
 
+=item B&lt;-passin&gt; I&lt;arg&gt;
+
+The passphrase used in the output file.
+See see L&lt;openssl(1)/Pass Phrase Options&gt;.
+
+=item B&lt;-rev&gt;
+
+Reverse the order of the input.
+
 =item B&lt;-out&gt; I&lt;filename&gt;
 
 Specifies the output filename to write to or standard output by
@@ -85,9 +102,10 @@ Encrypt the input data using an RSA public key.
 
 Decrypt the input data using an RSA private key.
 
-=item B&lt;-pkcs&gt;, B&lt;-oaep&gt;, B&lt;-ssl&gt;, B&lt;-raw&gt;
+=item B&lt;-pkcs&gt;, B&lt;-oaep&gt;, B&lt;-x931&gt; B&lt;-ssl&gt;, B&lt;-raw&gt;
 
 The padding to use: PKCS#1 v1.5 (the default), PKCS#1 OAEP,
+ANSI X9.31,
 special padding used in SSL v2 backwards compatible handshakes,
 or no padding, respectively.
 For signatures, only B&lt;-pkcs&gt; and B&lt;-raw&gt; can be used.
@@ -101,6 +119,8 @@ Hex dump the output data.
 Parse the ASN.1 output data, this is useful when combined with the
 B&lt;-verify&gt; option.
 
+{- $OpenSSL::safe::opt_engine_item -}
+
 {- $OpenSSL::safe::opt_r_item -}
 
 =back
diff --git a/doc/man1/openssl-s_server.pod.in b/doc/man1/openssl-s_server.pod.in
index a35ddf289e..78119281db 100644
--- a/doc/man1/openssl-s_server.pod.in
+++ b/doc/man1/openssl-s_server.pod.in
@@ -50,6 +50,7 @@ B&lt;openssl&gt; B&lt;s_server&gt;
 [B&lt;-id_prefix&gt; I&lt;val&gt;]
 [B&lt;-keymatexport&gt; I&lt;val&gt;]
 [B&lt;-keymatexportlen&gt; I&lt;+int&gt;]
+[B&lt;-CRLform&gt; B&lt;DER&gt;|B&lt;PEM&gt;]
 [B&lt;-CRL&gt; I&lt;infile&gt;]
 [B&lt;-crl_download&gt;]
 [B&lt;-cert_chain&gt; I&lt;infile&gt;]
@@ -125,7 +126,9 @@ B&lt;openssl&gt; B&lt;s_server&gt;
 [B&lt;-alpn&gt; I&lt;val&gt;]
 [B&lt;-keylogfile&gt; I&lt;outfile&gt;]
 [B&lt;-max_early_data&gt; I&lt;int&gt;]
+[B&lt;-recv_max_early_data&gt; I&lt;int&gt;]
 [B&lt;-early_data&gt;]
+[B&lt;-stateless&gt;]
 [B&lt;-anti_replay&gt;]
 [B&lt;-no_anti_replay&gt;]
 [B&lt;-http_server_binmode&gt;]
@@ -615,11 +618,20 @@ and any incoming early data (when used in conjunction with the B&lt;-early_data&gt;
 flag). The default value is approximately 16k. The argument must be an integer
 greater than or equal to 0.
 
+=item B&lt;-recv_max_early_data&gt; I&lt;int&gt;
+
+Specify the hard limit on the maximum number of early data bytes that will
+be accepted.
+
 =item B&lt;-early_data&gt;
 
 Accept early data where possible. Cannot be used in conjunction with B&lt;-www&gt;,
 B&lt;-WWW&gt;, B&lt;-HTTP&gt; or B&lt;-rev&gt;.
 
+=item B&lt;-stateless&gt;
+
+Require TLSv1.3 cookies.
+
 =item B&lt;-anti_replay&gt;, B&lt;-no_anti_replay&gt;
 
 Switches replay protection on or off, respectively. Replay protection is on by
diff --git a/doc/man1/openssl-s_time.pod.in b/doc/man1/openssl-s_time.pod.in
index 1d87c8c0dd..cf8759108a 100644
--- a/doc/man1/openssl-s_time.pod.in
+++ b/doc/man1/openssl-s_time.pod.in
@@ -17,11 +17,16 @@ B&lt;openssl&gt; B&lt;s_time&gt;
 [B&lt;-new&gt;]
 [B&lt;-verify&gt; I&lt;depth&gt;]
 [B&lt;-time&gt; I&lt;seconds&gt;]
-{- $OpenSSL::safe::opt_versiontls_synopsis -}
+[B&lt;-ssl3&gt;]
+[B&lt;-tls1&gt;]
+[B&lt;-tls1_1&gt;]
+[B&lt;-tls1_2&gt;]
+[B&lt;-tls1_3&gt;]
 [B&lt;-bugs&gt;]
 [B&lt;-cipher&gt; I&lt;cipherlist&gt;]
 [B&lt;-ciphersuites&gt; I&lt;val&gt;]
 {- $OpenSSL::safe::opt_name_synopsis -}
+[B&lt;-cafile&gt; I&lt;file&gt;]
 {- $OpenSSL::safe::opt_trust_synopsis -}
 
 =for openssl ifdef ssl3 tls1 tls1_1 tls1_2 tls1_3
@@ -117,7 +122,13 @@ can establish.
 
 {- $OpenSSL::safe::opt_trust_item -}
 
-{- $OpenSSL::safe::opt_versiontls_item -}
+=item B&lt;-cafile&gt; I&lt;file&gt;
+
+This is an obsolete synonym for B&lt;-CAfile&gt;.
+
+=item B&lt;-ssl3&gt;, B&lt;-tls1&gt;, B&lt;-tls1_1&gt;, B&lt;-tls1_2&gt;, B&lt;-tls1_3&gt;
+
+See L&lt;openssl(1)/TLS Version Options&gt;.
 
 =back
 
@@ -162,6 +173,10 @@ be able to measure the performance of all protocols with all servers.
 The B&lt;-verify&gt; option should really exit if the server verification
 fails.
 
+=head1 HISTORY
+
+The B&lt;-cafile&gt; option was deprecated in OpenSSL 3.0.
+
 =head1 SEE ALSO
 
 L&lt;openssl(1)&gt;,
diff --git a/doc/man1/openssl-sess_id.pod b/doc/man1/openssl-sess_id.pod
index 9bd31a351e..ff90231fa2 100644
--- a/doc/man1/openssl-sess_id.pod
+++ b/doc/man1/openssl-sess_id.pod
@@ -13,6 +13,7 @@ B&lt;openssl&gt; B&lt;sess_id&gt;
 [B&lt;-in&gt; I&lt;filename&gt;]
 [B&lt;-out&gt; I&lt;filename&gt;]
 [B&lt;-text&gt;]
+[B&lt;-cert&gt;]
 [B&lt;-noout&gt;]
 [B&lt;-context&gt; I&lt;ID&gt;]
 
diff --git a/doc/man1/openssl-smime.pod.in b/doc/man1/openssl-smime.pod.in
index 55bd34f72e..e9500924ef 100644
--- a/doc/man1/openssl-smime.pod.in
+++ b/doc/man1/openssl-smime.pod.in
@@ -21,6 +21,14 @@ B&lt;openssl&gt; B&lt;smime&gt;
 [B&lt;-in&gt; I&lt;file&gt;]
 [B&lt;-certfile&gt; I&lt;file&gt;]
 [B&lt;-signer&gt; I&lt;file&gt;]
+[B&lt;-nointern&gt;]
+[B&lt;-noverify&gt;]
+[B&lt;-nochain&gt;]
+[B&lt;-nosigs&gt;]
+[B&lt;-nocerts&gt;]
+[B&lt;-noattr&gt;]
+[B&lt;-nodetach&gt;]
+[B&lt;-nosmimecap&gt;]
 [B&lt;-recip&gt; I&lt; file&gt;]
 [B&lt;-inform&gt; B&lt;DER&gt;|B&lt;PEM&gt;|B&lt;SMIME&gt;]
 [B&lt;-outform&gt; B&lt;DER&gt;|B&lt;PEM&gt;|B&lt;SMIME&gt;]
@@ -38,6 +46,7 @@ B&lt;openssl&gt; B&lt;smime&gt;
 [B&lt;-stream&gt;]
 [B&lt;-md&gt; I&lt;digest&gt;]
 {- $OpenSSL::safe::opt_trust_synopsis -}
+{- $OpenSSL::safe::opt_engine_synopsis -}
 {- $OpenSSL::safe::opt_r_synopsis -}
 {- $OpenSSL::safe::opt_v_synopsis -}
 I&lt;cert.pem&gt; ...
@@ -178,7 +187,7 @@ Do not verify the signers certificate of a signed message.
 
 =item B&lt;-nochain&gt;
 
-Do not do chain verification of signers certificates: that is don't
+Do not do chain verification of signers certificates; that is, do not
 use the certificates in the signed message as untrusted CAs.
 
 =item B&lt;-nosigs&gt;
@@ -198,6 +207,17 @@ Normally when a message is signed a set of attributes are included which
 include the signing time and supported symmetric algorithms. With this
 option they are not included.
 
+=item B&lt;-nodetach&gt;
+
+When signing a message use opaque signing. This form is more resistant
+to translation by mail relays but it cannot be read by mail agents that
+do not support S/MIME.  Without this option cleartext signing with
+the MIME type multipart/signed is used.
+
+=item B&lt;-nosmimecap&gt;
+
+When signing a message, do not include the B&lt;SMIMECapabilities&gt; attribute.
+
 =item B&lt;-binary&gt;
 
 Normally the input message is converted to &quot;canonical&quot; format which is
@@ -210,13 +230,6 @@ is useful when handling binary data which may not be in MIME format.
 Normally the output file uses a single B&lt;LF&gt; as end of line. When this
 option is present B&lt;CRLF&gt; is used instead.
 
-=item B&lt;-nodetach&gt;
-
-When signing a message use opaque signing: this form is more resistant
-to translation by mail relays but it cannot be read by mail agents that
-do not support S/MIME.  Without this option cleartext signing with
-the MIME type multipart/signed is used.
-
 =item B&lt;-certfile&gt; I&lt;file&gt;
 
 Allows additional certificates to be specified. When signing these will
@@ -230,6 +243,14 @@ used multiple times if more than one signer is required. If a message is being
 verified then the signers certificates will be written to this file if the
 verification was successful.
 
+=item B&lt;-nocerts&gt;
+
+Don't include signers certificate when signing.
+
+=item B&lt;-noattr&gt;
+
+Don't include any signed attributes when signing.
+
 =item B&lt;-recip&gt; I&lt;file&gt;
 
 The recipients certificate when decrypting a message. This certificate
@@ -263,6 +284,8 @@ Any verification errors cause the command to exit.
 
 {- $OpenSSL::safe::opt_trust_item -}
 
+{- $OpenSSL::safe::opt_engine_item -}
+
 {- $OpenSSL::safe::opt_r_item -}
 
 =item I&lt;cert.pem&gt; ...
diff --git a/doc/man1/openssl-speed.pod.in b/doc/man1/openssl-speed.pod.in
index 6e1bb642e1..669b206fe6 100644
--- a/doc/man1/openssl-speed.pod.in
+++ b/doc/man1/openssl-speed.pod.in
@@ -13,10 +13,16 @@ B&lt;openssl speed&gt;
 [B&lt;-evp&gt; I&lt;algo&gt;]
 [B&lt;-hmac&gt; I&lt;algo&gt;]
 [B&lt;-cmac&gt; I&lt;algo&gt;]
+[B&lt;-mb&gt;]
+[B&lt;-aead&gt;]
+[B&lt;-multi&gt; I&lt;num&gt;]
+[B&lt;-async_jobs&gt; I&lt;num&gt;]
+[B&lt;-misalign&gt; I&lt;num&gt;]
 [B&lt;-decrypt&gt;]
 [B&lt;-primes&gt; I&lt;num&gt;]
 [B&lt;-seconds&gt; I&lt;num&gt;]
 [B&lt;-bytes&gt; I&lt;num&gt;]
+[B&lt;-mr&gt;]
 {- $OpenSSL::safe::opt_r_synopsis -}
 {- $OpenSSL::safe::opt_engine_synopsis -}
 [I&lt;algorithm&gt; ...]
@@ -51,6 +57,18 @@ If I&lt;algo&gt; is an AEAD cipher, then you can pass B&lt;-aead&gt; to benchmark a
 TLS-like sequence. And if I&lt;algo&gt; is a multi-buffer capable cipher, e.g.
 aes-128-cbc-hmac-sha1, then B&lt;-mb&gt; will time multi-buffer operation.
 
+=item B&lt;-multi&gt; I&lt;num&gt;
+
+Run multiple operations in parallel.
+
+=item B&lt;-async_jobs&gt; I&lt;num&gt;
+
+Enable async mode and start specified number of jobs.
+
+=item B&lt;-misalign&gt; I&lt;num&gt;
+
+Misalign the buffers by the specified number of bytes.
+
 =item B&lt;-hmac&gt; I&lt;digest&gt;
 
 Time the HMAC algorithm using the specified message digest.
@@ -77,6 +95,10 @@ Run benchmarks for I&lt;num&gt; seconds.
 
 Run benchmarks on I&lt;num&gt;-byte buffers. Affects ciphers, digests and the CSPRNG.
 
+=item B&lt;-mr&gt;
+
+Produce the summary in a mechanical, machine-readable, format.
+
 {- $OpenSSL::safe::opt_r_item -}
 
 {- $OpenSSL::safe::opt_engine_item -}
diff --git a/doc/man1/openssl-srp.pod.in b/doc/man1/openssl-srp.pod.in
index 47dfe40aa7..e9955d5c40 100644
--- a/doc/man1/openssl-srp.pod.in
+++ b/doc/man1/openssl-srp.pod.in
@@ -21,6 +21,7 @@ B&lt;openssl srp&gt;
 [B&lt;-userinfo&gt; I&lt;text&gt;]
 [B&lt;-passin&gt; I&lt;arg&gt;]
 [B&lt;-passout&gt; I&lt;arg&gt;]
+{- $OpenSSL::safe::opt_engine_synopsis -}
 {- $OpenSSL::safe::opt_r_synopsis -}
 [I&lt;user&gt; ...]
 
@@ -71,6 +72,8 @@ The password source for the input and output file.
 For more information about the format of B&lt;arg&gt;
 see L&lt;openssl(1)/Pass Phrase Options&gt;.
 
+{- $OpenSSL::safe::opt_engine_item -}
+
 {- $OpenSSL::safe::opt_r_synopsis -}
 
 =back
diff --git a/doc/man1/openssl-ts.pod.in b/doc/man1/openssl-ts.pod.in
index b9c3692c62..b9e911827d 100644
--- a/doc/man1/openssl-ts.pod.in
+++ b/doc/man1/openssl-ts.pod.in
@@ -7,6 +7,9 @@ openssl-ts - Time Stamping Authority tool (client/server)
 
 =head1 SYNOPSIS
 
+B&lt;openssl&gt; B&lt;ts&gt;
+B&lt;-help&gt;
+
 B&lt;openssl&gt; B&lt;ts&gt;
 B&lt;-query&gt;
 [B&lt;-config&gt; I&lt;configfile&gt;]
@@ -95,6 +98,14 @@ requests either by ftp or e-mail.
 
 =head1 OPTIONS
 
+=over 4
+
+=item B&lt;-help&gt;
+
+Print out a usage message.
+
+=back
+
 =head2 Timestamp Request generation
 
 The B&lt;-query&gt; switch can be used for creating and printing a timestamp
diff --git a/doc/man1/openssl-x509.pod.in b/doc/man1/openssl-x509.pod.in
index a69d219f74..3da2b0d122 100644
--- a/doc/man1/openssl-x509.pod.in
+++ b/doc/man1/openssl-x509.pod.in
@@ -19,7 +19,9 @@ B&lt;openssl&gt; B&lt;x509&gt;
 [B&lt;-serial&gt;]
 [B&lt;-hash&gt;]
 [B&lt;-subject_hash&gt;]
+[B&lt;-subject_hash_old&gt;]
 [B&lt;-issuer_hash&gt;]
+[B&lt;-issuer_hash_old&gt;]
 [B&lt;-ocspid&gt;]
 [B&lt;-subject&gt;]
 [B&lt;-issuer&gt;]
@@ -44,6 +46,7 @@ B&lt;openssl&gt; B&lt;x509&gt;
 [B&lt;-days&gt; I&lt;arg&gt;]
 [B&lt;-set_serial&gt; I&lt;n&gt;]
 [B&lt;-signkey&gt; I&lt;filename&gt;]
+[B&lt;-badsig&gt;]
 [B&lt;-passin&gt; I&lt;arg&gt;]
 [B&lt;-x509toreq&gt;]
 [B&lt;-req&gt;]
@@ -52,11 +55,16 @@ B&lt;openssl&gt; B&lt;x509&gt;
 [B&lt;-CAcreateserial&gt;]
 [B&lt;-CAserial&gt; I&lt;filename&gt;]
 [B&lt;-new&gt;]
+[B&lt;-next_serial&gt;]
+[B&lt;-nocert&gt;]
 [B&lt;-force_pubkey&gt; I&lt;filename&gt;]
 [B&lt;-subj&gt; I&lt;arg&gt;]
 [B&lt;-text&gt;]
 [B&lt;-ext&gt; I&lt;extensions&gt;]
 [B&lt;-certopt&gt; I&lt;option&gt;]
+[B&lt;-checkhost&gt; I&lt;host&gt;]
+[B&lt;-checkemail&gt; I&lt;host&gt;]
+[B&lt;-checkip&gt; I&lt;ipaddr&gt;]
 [B&lt;-C&gt;]
 [B&lt;-I&lt;digest&gt;&gt;]
 [B&lt;-clrext&gt;]
@@ -155,6 +163,18 @@ can be a single option or multiple options separated by commas. The
 B&lt;-certopt&gt; switch may be also be used more than once to set multiple
 options. See the L&lt;/Text Options&gt; section for more information.
 
+=item B&lt;-checkhost&gt; I&lt;host&gt;
+
+Check that the certificate matches the specified host.
+
+=item B&lt;-checkemail&gt; I&lt;email&gt;
+
+Check that the certificate matches the specified email address.
+
+=item B&lt;-checkip&gt; I&lt;ipaddr&gt;
+
+Check that the certificate matches the specified IP address.
+
 =item B&lt;-noout&gt;
 
 This option prevents output of the encoded version of the certificate.
@@ -340,6 +360,11 @@ and the end date to a value determined by the B&lt;-days&gt; option.
 It retains any certificate extensions unless the B&lt;-clrext&gt; option is supplied;
 this includes, for example, any existing key identifier extensions.
 
+=item B&lt;-badsig&gt;
+
+Corrupt the signature before writing it; this can be useful
+for testing.
+
 =item B&lt;-sigopt&gt; I&lt;nm&gt;:I&lt;v&gt;
 
 Pass options to the signature algorithm during sign or verify operations.
@@ -449,6 +474,14 @@ Generate a certificate from scratch, not using an input certificate
 or certificate request. So the B&lt;-in&gt; option must not be used in this case.
 Instead, the B&lt;-subj&gt; and &lt;-force_pubkey&gt; options need to be given.
 
+=item B&lt;-next_serial&gt;
+
+Set the serial to be one more than the number in the certificate.
+
+=item B&lt;-nocert&gt;
+
+Do not generate or output a certificate.
+
 =item B&lt;-force_pubkey&gt; I&lt;filename&gt;
 
 When a certificate is created set its public key to the key in I&lt;filename&gt;
diff --git a/doc/perlvars.pm b/doc/perlvars.pm
index b2047bdca0..c20f4aedaa 100644
--- a/doc/perlvars.pm
+++ b/doc/perlvars.pm
@@ -38,7 +38,8 @@ $OpenSSL::safe::opt_v_synopsis = &quot;&quot;
 . &quot;[B&lt;-verify_hostname&gt; I&lt;hostname&gt;]\n&quot;
 . &quot;[B&lt;-verify_ip&gt; I&lt;ip&gt;]\n&quot;
 . &quot;[B&lt;-verify_name&gt; I&lt;name&gt;]\n&quot;
-. &quot;[B&lt;-x509_strict&gt;]\n&quot;;
+. &quot;[B&lt;-x509_strict&gt;]\n&quot;
+. &quot;[B&lt;-issuer_checks&gt;]\n&quot;;
 $OpenSSL::safe::opt_v_item = &quot;&quot;
 . &quot;=item B&lt;-allow_proxy_certs&gt;, B&lt;-attime&gt;, B&lt;-no_check_time&gt;,\n&quot;
 . &quot;B&lt;-check_ss_sig&gt;, B&lt;-crl_check&gt;, B&lt;-crl_check_all&gt;,\n&quot;
@@ -47,7 +48,7 @@ $OpenSSL::safe::opt_v_item = &quot;&quot;
 . &quot;B&lt;-policy_check&gt;, B&lt;-policy_print&gt;, B&lt;-purpose&gt;, B&lt;-suiteB_128&gt;,\n&quot;
 . &quot;B&lt;-suiteB_128_only&gt;, B&lt;-suiteB_192&gt;, B&lt;-trusted_first&gt;, B&lt;-use_deltas&gt;,\n&quot;
 . &quot;B&lt;-auth_level&gt;, B&lt;-verify_depth&gt;, B&lt;-verify_email&gt;, B&lt;-verify_hostname&gt;,\n&quot;
-. &quot;B&lt;-verify_ip&gt;, B&lt;-verify_name&gt;, B&lt;-x509_strict&gt;\n&quot;
+. &quot;B&lt;-verify_ip&gt;, B&lt;-verify_name&gt;, B&lt;-x509_strict&gt; B&lt;-issuer_checks&gt;\n&quot;
 . &quot;\n&quot;
 . &quot;Set various options of certificate chain verification.\n&quot;
 . &quot;See L&lt;openssl(1)/Verification Options&gt; for details.&quot;;
diff --git a/util/find-doc-nits b/util/find-doc-nits
index 3daf58182f..293f603b79 100755
--- a/util/find-doc-nits
+++ b/util/find-doc-nits
@@ -808,8 +808,14 @@ sub checkflags {
             }
             next;
         }
-        next unless /\[B&lt;-([^ &gt;]+)/;
-        my $opt = $1;
+        my $opt;
+        if ( /\[B&lt;-([^ &gt;]+)/ ) {
+            $opt = $1;
+        } elsif ( /^B&lt;-([^ &gt;]+)/ ) {
+            $opt = $1;
+        } else {
+            next;
+        }
         $opt = $1 if $opt =~ /I&lt;(.*)/;
         $docopts{$1} = 1;
     }
@@ -826,7 +832,7 @@ sub checkflags {
     my @unimpl = sort grep { !defined $cmdopts{$_} } keys %docopts;
     foreach ( @unimpl ) {
         next if defined $skips{$_} || defined $localskips{$_};
-        err(&quot;$cmd documented but not implemented -$_&quot;);
+        err(&quot;$doc: $cmd does not implement -$_&quot;);
     }
 }
 
@@ -852,8 +858,9 @@ if ( $opt_c ) {
     # See if each has a manpage.
     foreach my $cmd ( @commands ) {
         next if $cmd eq 'help' || $cmd eq 'exit';
-        my $doc = &quot;doc/man1/$cmd.pod&quot;;
-        $doc = &quot;doc/man1/openssl-$cmd.pod&quot; if -f &quot;doc/man1/openssl-$cmd.pod&quot;;
+        my $doc = &quot;doc/man1/openssl-$cmd.pod&quot;;
+        # Handle &quot;tsget&quot; and &quot;CA.pl&quot; pod pages
+        $doc = &quot;doc/man1/$cmd.pod&quot; if -f &quot;doc/man1/$cmd.pod&quot;;
         if ( ! -f &quot;$doc&quot; ) {
             err(&quot;$doc does not exist&quot;);
         } else {
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027275.html">[openssl]  master update
</A></li>
	<LI>Next message: <A HREF="027281.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27278">[ date ]</a>
              <a href="thread.html#27278">[ thread ]</a>
              <a href="subject.html#27278">[ subject ]</a>
              <a href="author.html#27278">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
