<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl]  OpenSSL_1_1_1-stable update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2020-January/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20OpenSSL_1_1_1-stable%20update&In-Reply-To=%3C1579210925.123602.17578.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027090.html">
   <LINK REL="Next"  HREF="027104.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl]  OpenSSL_1_1_1-stable update</H1>
    <B>kaduk at mit.edu</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20OpenSSL_1_1_1-stable%20update&In-Reply-To=%3C1579210925.123602.17578.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl]  OpenSSL_1_1_1-stable update">kaduk at mit.edu
       </A><BR>
    <I>Thu Jan 16 21:42:05 UTC 2020</I>
    <P><UL>
        <LI>Previous message: <A HREF="027090.html">[openssl]  OpenSSL_1_1_1-stable update
</A></li>
        <LI>Next message: <A HREF="027104.html">[openssl]  OpenSSL_1_1_1-stable update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27094">[ date ]</a>
              <a href="thread.html#27094">[ thread ]</a>
              <a href="subject.html#27094">[ subject ]</a>
              <a href="author.html#27094">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch OpenSSL_1_1_1-stable has been updated
       via  017015ceecaf2b4464aeeeb9a051dbe91d17f6e2 (commit)
      from  56c59ddd99da05c2f30832cccaffb873a8481555 (commit)


- Log -----------------------------------------------------------------
commit 017015ceecaf2b4464aeeeb9a051dbe91d17f6e2
Author: Benjamin Kaduk &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">bkaduk at akamai.com</A>&gt;
Date:   Tue Jan 14 16:22:52 2020 -0800

    Update SSL_CTX_sess_set_new_cb(3) docs for refcounts
    
    The existing documentation for the new-session callback was unclear
    about the requirements on the callback with respect to reference-handling
    of the session object being created.  Be more explicit about the
    (non-)requirements on the callback code for &quot;success&quot; (1) and &quot;ignore&quot;
    (0) return values.
    
    Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/10848">https://github.com/openssl/openssl/pull/10848</A>)
    
    (cherry picked from commit 188d4ec82a9b0085ac5841cce3eda95efb94f2b4)

-----------------------------------------------------------------------

Summary of changes:
 doc/man3/SSL_CTX_sess_set_get_cb.pod | 18 ++++++++++++------
 1 file changed, 12 insertions(+), 6 deletions(-)

diff --git a/doc/man3/SSL_CTX_sess_set_get_cb.pod b/doc/man3/SSL_CTX_sess_set_get_cb.pod
index 774c4b120f..11eda7e141 100644
--- a/doc/man3/SSL_CTX_sess_set_get_cb.pod
+++ b/doc/man3/SSL_CTX_sess_set_get_cb.pod
@@ -54,12 +54,18 @@ session cache is realized via callback functions. Inside these callback
 functions, session can be saved to disk or put into a database using the
 L&lt;d2i_SSL_SESSION(3)&gt; interface.
 
-The new_session_cb() is called, whenever a new session has been negotiated
-and session caching is enabled (see
-L&lt;SSL_CTX_set_session_cache_mode(3)&gt;).
-The new_session_cb() is passed the B&lt;ssl&gt; connection and the ssl session
-B&lt;sess&gt;. If the callback returns B&lt;0&gt;, the session will be immediately
-removed again. Note that in TLSv1.3, sessions are established after the main
+The new_session_cb() is called whenever a new session has been negotiated and
+session caching is enabled (see L&lt;SSL_CTX_set_session_cache_mode(3)&gt;).  The
+new_session_cb() is passed the B&lt;ssl&gt; connection and the ssl session B&lt;sess&gt;.
+Since sessions are reference-counted objects, the reference count on the
+session is incremented before the callback, on behalf of the application.  If
+the callback returns B&lt;0&gt;, the session will be immediately removed from the
+internal cache and the reference count released. If the callback returns B&lt;1&gt;,
+the application retains the reference (for an entry in the
+application-maintained &quot;external session cache&quot;), and is responsible for
+calling SSL_SESSION_free() when the session reference is no longer in use.
+
+Note that in TLSv1.3, sessions are established after the main
 handshake has completed. The server decides when to send the client the session
 information and this may occur some time after the end of the handshake (or not
 at all). This means that applications should expect the new_session_cb()
</PRE>

























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027090.html">[openssl]  OpenSSL_1_1_1-stable update
</A></li>
	<LI>Next message: <A HREF="027104.html">[openssl]  OpenSSL_1_1_1-stable update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27094">[ date ]</a>
              <a href="thread.html#27094">[ thread ]</a>
              <a href="subject.html#27094">[ subject ]</a>
              <a href="author.html#27094">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
