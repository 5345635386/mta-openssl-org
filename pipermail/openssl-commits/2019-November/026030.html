<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2019-November/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1573157347.781622.5243.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026023.html">
   <LINK REL="Next"  HREF="026032.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl]  master update</H1>
    <B>Dr. Paul Dale</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1573157347.781622.5243.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl]  master update">pauli at openssl.org
       </A><BR>
    <I>Thu Nov  7 20:09:07 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="026023.html">[openssl]  master update
</A></li>
        <LI>Next message: <A HREF="026032.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26030">[ date ]</a>
              <a href="thread.html#26030">[ thread ]</a>
              <a href="subject.html#26030">[ subject ]</a>
              <a href="author.html#26030">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  5388f9862d9aaf3c7cf7a70c1e36e7e983c26cfc (commit)
      from  ab14d2af5386897eba8307c9f3220a6d775c0898 (commit)


- Log -----------------------------------------------------------------
commit 5388f9862d9aaf3c7cf7a70c1e36e7e983c26cfc
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at akamai.com</A>&gt;
Date:   Fri Nov 8 06:08:30 2019 +1000

    Add &quot;sections&quot; to -help output
    
    Remove &quot;Valid options&quot; label, since all commands have sections (and
    [almost] always the first one is &quot;General options&quot;).
    Have &quot;list --options&quot; ignore section headers
    Reformat ts's additional help
    
    Add output section
    
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tmraz at fedoraproject.org</A>&gt;
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">paul.dale at oracle.com</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/9953">https://github.com/openssl/openssl/pull/9953</A>)

-----------------------------------------------------------------------

Summary of changes:
 apps/asn1pars.c    |  19 +++---
 apps/ca.c          |  72 ++++++++++++----------
 apps/ciphers.c     |  23 ++++---
 apps/cms.c         | 104 ++++++++++++++++++-------------
 apps/crl.c         |  33 ++++++----
 apps/crl2p7.c      |  11 +++-
 apps/dgst.c        |  34 +++++-----
 apps/dhparam.c     |  28 +++++----
 apps/dsa.c         |  28 +++++----
 apps/dsaparam.c    |  18 ++++--
 apps/ec.c          |  25 +++++---
 apps/ecparam.c     |  29 +++++----
 apps/enc.c         |  37 ++++++-----
 apps/engine.c      |  10 ++-
 apps/errstr.c      |   2 +
 apps/fipsinstall.c |  12 ++--
 apps/gendsa.c      |  11 ++--
 apps/genpkey.c     |  16 +++--
 apps/genrsa.c      |  17 +++--
 apps/include/opt.h |   6 +-
 apps/info.c        |   4 ++
 apps/kdf.c         |   8 ++-
 apps/lib/opt.c     |  12 +++-
 apps/list.c        |   5 ++
 apps/mac.c         |   6 ++
 apps/nseq.c        |   7 ++-
 apps/ocsp.c        | 102 +++++++++++++++---------------
 apps/openssl.c     |   2 +
 apps/passwd.c      |  10 ++-
 apps/pkcs12.c      |  78 +++++++++++++----------
 apps/pkcs7.c       |  13 ++--
 apps/pkcs8.c       |  34 ++++++----
 apps/pkey.c        |  30 +++++----
 apps/pkeyparam.c   |  13 ++--
 apps/pkeyutl.c     |  50 ++++++++-------
 apps/prime.c       |   8 ++-
 apps/provider.c    |   4 ++
 apps/rand.c        |  14 +++--
 apps/rehash.c      |   5 +-
 apps/req.c         |  62 +++++++++++--------
 apps/rsa.c         |  29 +++++----
 apps/rsautl.c      |  28 +++++----
 apps/s_client.c    | 178 +++++++++++++++++++++++++++++------------------------
 apps/s_server.c    | 154 ++++++++++++++++++++++++---------------------
 apps/s_time.c      |  44 +++++++------
 apps/sess_id.c     |  11 +++-
 apps/smime.c       |  65 +++++++++++--------
 apps/speed.c       |  30 +++++----
 apps/spkac.c       |  17 +++--
 apps/srp.c         |  17 +++--
 apps/storeutl.c    |  26 +++++---
 apps/ts.c          |  78 ++++++++++++-----------
 apps/verify.c      |  14 +++--
 apps/version.c     |   3 +
 apps/x509.c        |  79 +++++++++++++-----------
 55 files changed, 1057 insertions(+), 718 deletions(-)

diff --git a/apps/asn1pars.c b/apps/asn1pars.c
index 14f1dcad32..342e12d9b2 100644
--- a/apps/asn1pars.c
+++ b/apps/asn1pars.c
@@ -27,27 +27,32 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS asn1parse_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+    {&quot;oid&quot;, OPT_OID, '&lt;', &quot;file of extra oid definitions&quot;},
+
+    OPT_SECTION(&quot;I/O&quot;),
     {&quot;inform&quot;, OPT_INFORM, 'F', &quot;input format - one of DER PEM&quot;},
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;input file&quot;},
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;output file (output format is always DER)&quot;},
-    {&quot;i&quot;, OPT_INDENT, 0, &quot;indents the output&quot;},
     {&quot;noout&quot;, OPT_NOOUT, 0, &quot;do not produce any output&quot;},
     {&quot;offset&quot;, OPT_OFFSET, 'p', &quot;offset into file&quot;},
     {&quot;length&quot;, OPT_LENGTH, 'p', &quot;length of section in file&quot;},
-    {&quot;oid&quot;, OPT_OID, '&lt;', &quot;file of extra oid definitions&quot;},
-    {&quot;dump&quot;, OPT_DUMP, 0, &quot;unknown data in hex form&quot;},
-    {&quot;dlimit&quot;, OPT_DLIMIT, 'p',
-     &quot;dump the first arg bytes of unknown data in hex form&quot;},
     {&quot;strparse&quot;, OPT_STRPARSE, 'p',
      &quot;offset; a series of these can be used to 'dig'&quot;},
-    {OPT_MORE_STR, 0, 0, &quot;into multiple ASN1 blob wrappings&quot;},
     {&quot;genstr&quot;, OPT_GENSTR, 's', &quot;string to generate ASN1 structure from&quot;},
+    {OPT_MORE_STR, 0, 0, &quot;into multiple ASN1 blob wrappings&quot;},
     {&quot;genconf&quot;, OPT_GENCONF, 's', &quot;file to generate ASN1 structure from&quot;},
-    {OPT_MORE_STR, 0, 0, &quot;(-inform  will be ignored)&quot;},
     {&quot;strictpem&quot;, OPT_STRICTPEM, 0,
      &quot;do not attempt base64 decode outside PEM markers&quot;},
     {&quot;item&quot;, OPT_ITEM, 's', &quot;item to parse and print&quot;},
+    {OPT_MORE_STR, 0, 0, &quot;(-inform  will be ignored)&quot;},
+
+    OPT_SECTION(&quot;Formatting&quot;),
+    {&quot;i&quot;, OPT_INDENT, 0, &quot;indents the output&quot;},
+    {&quot;dump&quot;, OPT_DUMP, 0, &quot;unknown data in hex form&quot;},
+    {&quot;dlimit&quot;, OPT_DLIMIT, 'p',
+     &quot;dump the first arg bytes of unknown data in hex form&quot;},
     {NULL}
 };
 
diff --git a/apps/ca.c b/apps/ca.c
index b188b9b4dd..824c022502 100644
--- a/apps/ca.c
+++ b/apps/ca.c
@@ -154,10 +154,30 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS ca_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
     {&quot;verbose&quot;, OPT_VERBOSE, '-', &quot;Verbose output during processing&quot;},
+    {&quot;outdir&quot;, OPT_OUTDIR, '/', &quot;Where to put output cert&quot;},
+    {&quot;in&quot;, OPT_IN, '&lt;', &quot;The input PEM encoded cert request(s)&quot;},
+    {&quot;infiles&quot;, OPT_INFILES, '-', &quot;The last argument, requests to process&quot;},
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Where to put the output file(s)&quot;},
+    {&quot;notext&quot;, OPT_NOTEXT, '-', &quot;Do not print the generated certificate&quot;},
+    {&quot;batch&quot;, OPT_BATCH, '-', &quot;Don't ask questions&quot;},
+    {&quot;msie_hack&quot;, OPT_MSIE_HACK, '-',
+     &quot;msie modifications to handle all Universal Strings&quot;},
+    {&quot;ss_cert&quot;, OPT_SS_CERT, '&lt;', &quot;File contains a self signed cert to sign&quot;},
+    {&quot;spkac&quot;, OPT_SPKAC, '&lt;',
+     &quot;File contains DN and signed public key and challenge&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#endif
+
+    OPT_SECTION(&quot;Configuration&quot;),
     {&quot;config&quot;, OPT_CONFIG, 's', &quot;A config file&quot;},
     {&quot;name&quot;, OPT_NAME, 's', &quot;The particular CA definition to use&quot;},
+    {&quot;policy&quot;, OPT_POLICY, 's', &quot;The CA 'policy' to support&quot;},
+
+    OPT_SECTION(&quot;Certificate&quot;),
     {&quot;subj&quot;, OPT_SUBJ, 's', &quot;Use arg instead of request's subject&quot;},
     {&quot;utf8&quot;, OPT_UTF8, '-', &quot;Input characters are UTF8 (default ASCII)&quot;},
     {&quot;create_serial&quot;, OPT_CREATE_SERIAL, '-',
@@ -170,8 +190,21 @@ const OPTIONS ca_options[] = {
     {&quot;enddate&quot;, OPT_ENDDATE, 's',
      &quot;YYMMDDHHMMSSZ cert notAfter (overrides -days)&quot;},
     {&quot;days&quot;, OPT_DAYS, 'p', &quot;Number of days to certify the cert for&quot;},
+    {&quot;extensions&quot;, OPT_EXTENSIONS, 's',
+     &quot;Extension section (override value in config file)&quot;},
+    {&quot;extfile&quot;, OPT_EXTFILE, '&lt;',
+     &quot;Configuration file with X509v3 extensions to add&quot;},
+#ifndef OPENSSL_NO_SM2
+    {&quot;sm2-id&quot;, OPT_SM2ID, 's',
+     &quot;Specify an ID string to verify an SM2 certificate request&quot;},
+    {&quot;sm2-hex-id&quot;, OPT_SM2HEXID, 's',
+     &quot;Specify a hex ID string to verify an SM2 certificate request&quot;},
+#endif
+    {&quot;preserveDN&quot;, OPT_PRESERVEDN, '-', &quot;Don't re-order the DN&quot;},
+    {&quot;noemailDN&quot;, OPT_NOEMAILDN, '-', &quot;Don't add the EMAIL field to the DN&quot;},
+
+    OPT_SECTION(&quot;Signing&quot;),
     {&quot;md&quot;, OPT_MD, 's', &quot;md to use; one of md2, md5, sha or sha1&quot;},
-    {&quot;policy&quot;, OPT_POLICY, 's', &quot;The CA 'policy' to support&quot;},
     {&quot;keyfile&quot;, OPT_KEYFILE, 's', &quot;Private key&quot;},
     {&quot;keyform&quot;, OPT_KEYFORM, 'f', &quot;Private key file format (PEM or ENGINE)&quot;},
     {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
@@ -179,31 +212,12 @@ const OPTIONS ca_options[] = {
     {&quot;cert&quot;, OPT_CERT, '&lt;', &quot;The CA cert&quot;},
     {&quot;selfsign&quot;, OPT_SELFSIGN, '-',
      &quot;Sign a cert with the key associated with it&quot;},
-    {&quot;in&quot;, OPT_IN, '&lt;', &quot;The input PEM encoded cert request(s)&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Where to put the output file(s)&quot;},
-    {&quot;outdir&quot;, OPT_OUTDIR, '/', &quot;Where to put output cert&quot;},
     {&quot;sigopt&quot;, OPT_SIGOPT, 's', &quot;Signature parameter in n:v form&quot;},
-    {&quot;notext&quot;, OPT_NOTEXT, '-', &quot;Do not print the generated certificate&quot;},
-    {&quot;batch&quot;, OPT_BATCH, '-', &quot;Don't ask questions&quot;},
-    {&quot;preserveDN&quot;, OPT_PRESERVEDN, '-', &quot;Don't re-order the DN&quot;},
-    {&quot;noemailDN&quot;, OPT_NOEMAILDN, '-', &quot;Don't add the EMAIL field to the DN&quot;},
+
+    OPT_SECTION(&quot;Revocation&quot;),
     {&quot;gencrl&quot;, OPT_GENCRL, '-', &quot;Generate a new CRL&quot;},
-    {&quot;msie_hack&quot;, OPT_MSIE_HACK, '-',
-     &quot;msie modifications to handle all those universal strings&quot;},
-    {&quot;crldays&quot;, OPT_CRLDAYS, 'p', &quot;Days until the next CRL is due&quot;},
-    {&quot;crlhours&quot;, OPT_CRLHOURS, 'p', &quot;Hours until the next CRL is due&quot;},
-    {&quot;crlsec&quot;, OPT_CRLSEC, 'p', &quot;Seconds until the next CRL is due&quot;},
-    {&quot;infiles&quot;, OPT_INFILES, '-', &quot;The last argument, requests to process&quot;},
-    {&quot;ss_cert&quot;, OPT_SS_CERT, '&lt;', &quot;File contains a self signed cert to sign&quot;},
-    {&quot;spkac&quot;, OPT_SPKAC, '&lt;',
-     &quot;File contains DN and signed public key and challenge&quot;},
-    {&quot;revoke&quot;, OPT_REVOKE, '&lt;', &quot;Revoke a cert (given in file)&quot;},
     {&quot;valid&quot;, OPT_VALID, 's',
      &quot;Add a Valid(not-revoked) DB entry about a cert (given in file)&quot;},
-    {&quot;extensions&quot;, OPT_EXTENSIONS, 's',
-     &quot;Extension section (override value in config file)&quot;},
-    {&quot;extfile&quot;, OPT_EXTFILE, '&lt;',
-     &quot;Configuration file with X509v3 extensions to add&quot;},
     {&quot;status&quot;, OPT_STATUS, 's', &quot;Shows cert status given the serial number&quot;},
     {&quot;updatedb&quot;, OPT_UPDATEDB, '-', &quot;Updates db for expired cert&quot;},
     {&quot;crlexts&quot;, OPT_CRLEXTS, 's',
@@ -215,16 +229,12 @@ const OPTIONS ca_options[] = {
      &quot;sets compromise time to val and the revocation reason to keyCompromise&quot;},
     {&quot;crl_CA_compromise&quot;, OPT_CRL_CA_COMPROMISE, 's',
      &quot;sets compromise time to val and the revocation reason to CACompromise&quot;},
+    {&quot;crldays&quot;, OPT_CRLDAYS, 'p', &quot;Days until the next CRL is due&quot;},
+    {&quot;crlhours&quot;, OPT_CRLHOURS, 'p', &quot;Hours until the next CRL is due&quot;},
+    {&quot;crlsec&quot;, OPT_CRLSEC, 'p', &quot;Seconds until the next CRL is due&quot;},
+    {&quot;revoke&quot;, OPT_REVOKE, '&lt;', &quot;Revoke a cert (given in file)&quot;},
+
     OPT_R_OPTIONS,
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-#endif
-#ifndef OPENSSL_NO_SM2
-    {&quot;sm2-id&quot;, OPT_SM2ID, 's',
-     &quot;Specify an ID string to verify an SM2 certificate request&quot;},
-    {&quot;sm2-hex-id&quot;, OPT_SM2HEXID, 's',
-     &quot;Specify a hex ID string to verify an SM2 certificate request&quot;},
-#endif
     {NULL}
 };
 
diff --git a/apps/ciphers.c b/apps/ciphers.c
index e51fac11ee..c2ac40a3b5 100644
--- a/apps/ciphers.c
+++ b/apps/ciphers.c
@@ -31,33 +31,38 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS ciphers_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;v&quot;, OPT_V, '-', &quot;Verbose listing of the SSL/TLS ciphers&quot;},
     {&quot;V&quot;, OPT_UPPER_V, '-', &quot;Even more verbose&quot;},
+    {&quot;stdname&quot;, OPT_STDNAME, '-', &quot;Show standard cipher names&quot;},
+    {&quot;convert&quot;, OPT_CONVERT, 's', &quot;Convert standard name into OpenSSL name&quot;},
+
+    OPT_SECTION(&quot;Cipher specification&quot;),
     {&quot;s&quot;, OPT_S, '-', &quot;Only supported ciphers&quot;},
 #ifndef OPENSSL_NO_SSL3
-    {&quot;ssl3&quot;, OPT_SSL3, '-', &quot;SSL3 mode&quot;},
+    {&quot;ssl3&quot;, OPT_SSL3, '-', &quot;Ciphers compatible with SSL3&quot;},
 #endif
 #ifndef OPENSSL_NO_TLS1
-    {&quot;tls1&quot;, OPT_TLS1, '-', &quot;TLS1 mode&quot;},
+    {&quot;tls1&quot;, OPT_TLS1, '-', &quot;Ciphers compatible with TLS1&quot;},
 #endif
 #ifndef OPENSSL_NO_TLS1_1
-    {&quot;tls1_1&quot;, OPT_TLS1_1, '-', &quot;TLS1.1 mode&quot;},
+    {&quot;tls1_1&quot;, OPT_TLS1_1, '-', &quot;Ciphers compatible with TLS1.1&quot;},
 #endif
 #ifndef OPENSSL_NO_TLS1_2
-    {&quot;tls1_2&quot;, OPT_TLS1_2, '-', &quot;TLS1.2 mode&quot;},
+    {&quot;tls1_2&quot;, OPT_TLS1_2, '-', &quot;Ciphers compatible with TLS1.2&quot;},
 #endif
 #ifndef OPENSSL_NO_TLS1_3
-    {&quot;tls1_3&quot;, OPT_TLS1_3, '-', &quot;TLS1.3 mode&quot;},
+    {&quot;tls1_3&quot;, OPT_TLS1_3, '-', &quot;Ciphers compatible with TLS1.3&quot;},
 #endif
-    {&quot;stdname&quot;, OPT_STDNAME, '-', &quot;Show standard cipher names&quot;},
 #ifndef OPENSSL_NO_PSK
-    {&quot;psk&quot;, OPT_PSK, '-', &quot;include ciphersuites requiring PSK&quot;},
+    {&quot;psk&quot;, OPT_PSK, '-', &quot;Include ciphersuites requiring PSK&quot;},
 #endif
 #ifndef OPENSSL_NO_SRP
-    {&quot;srp&quot;, OPT_SRP, '-', &quot;include ciphersuites requiring SRP&quot;},
+    {&quot;srp&quot;, OPT_SRP, '-', &quot;Include ciphersuites requiring SRP&quot;},
 #endif
-    {&quot;convert&quot;, OPT_CONVERT, 's', &quot;Convert standard name into OpenSSL name&quot;},
     {&quot;ciphersuites&quot;, OPT_CIPHERSUITES, 's',
      &quot;Configure the TLSv1.3 ciphersuites to use&quot;},
     {NULL}
diff --git a/apps/cms.c b/apps/cms.c
index 468820f3cf..c30bd62bb1 100644
--- a/apps/cms.c
+++ b/apps/cms.c
@@ -91,13 +91,35 @@ const OPTIONS cms_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] cert.pem...\n&quot;},
     {OPT_HELP_STR, 1, '-',
         &quot;  cert.pem... recipient certs for encryption\n&quot;},
-    {OPT_HELP_STR, 1, '-', &quot;Valid options are:\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
     {&quot;inform&quot;, OPT_INFORM, 'c', &quot;Input format SMIME (default), PEM or DER&quot;},
     {&quot;outform&quot;, OPT_OUTFORM, 'c',
      &quot;Output format SMIME (default), PEM or DER&quot;},
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;debug_decrypt&quot;, OPT_DEBUG_DECRYPT, '-',
+        &quot;Disable MMA protection and return an error if no recipient found&quot;
+        &quot; (see documentation)&quot;},
+    {&quot;stream&quot;, OPT_INDEF, '-', &quot;Enable CMS streaming&quot;},
+    {&quot;indef&quot;, OPT_INDEF, '-', &quot;Same as -stream&quot;},
+    {&quot;noindef&quot;, OPT_NOINDEF, '-', &quot;Disable CMS streaming&quot;},
+    {&quot;crlfeol&quot;, OPT_CRLFEOL, '-', &quot;Use CRLF as EOL termination instead of CR only&quot; },
+    {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;Trusted certificates file&quot;},
+    {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;trusted certificates directory&quot;},
+    {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;trusted certificates store URI&quot;},
+    {&quot;no-CAfile&quot;, OPT_NOCAFILE, '-',
+     &quot;Do not load the default certificates file&quot;},
+    {&quot;no-CApath&quot;, OPT_NOCAPATH, '-',
+     &quot;Do not load certificates from the default certificates directory&quot;},
+    {&quot;no-CAstore&quot;, OPT_NOCASTORE, '-',
+     &quot;Do not load certificates from the default certificates store&quot;},
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
+# endif
+
+    OPT_SECTION(&quot;Action&quot;),
     {&quot;encrypt&quot;, OPT_ENCRYPT, '-', &quot;Encrypt message&quot;},
     {&quot;decrypt&quot;, OPT_DECRYPT, '-', &quot;Decrypt encrypted message&quot;},
     {&quot;sign&quot;, OPT_SIGN, '-', &quot;Sign message&quot;},
@@ -109,45 +131,42 @@ const OPTIONS cms_options[] = {
         &quot;Exit non-zero on verification failure&quot;},
     {&quot;verify_receipt&quot;, OPT_VERIFY_RECEIPT, '&lt;',
         &quot;Verify receipts; exit if receipt signatures do not verify&quot;},
-    {&quot;cmsout&quot;, OPT_CMSOUT, '-', &quot;Output CMS structure&quot;},
-    {&quot;data_out&quot;, OPT_DATA_OUT, '-', &quot;Copy CMS \&quot;Data\&quot; object to output&quot;},
-    {&quot;data_create&quot;, OPT_DATA_CREATE, '-', &quot;Create a CMS \&quot;Data\&quot; object&quot;},
     {&quot;digest_verify&quot;, OPT_DIGEST_VERIFY, '-',
         &quot;Verify a CMS \&quot;DigestedData\&quot; object and output it&quot;},
     {&quot;digest_create&quot;, OPT_DIGEST_CREATE, '-',
         &quot;Create a CMS \&quot;DigestedData\&quot; object&quot;},
     {&quot;compress&quot;, OPT_COMPRESS, '-', &quot;Create a CMS \&quot;CompressedData\&quot; object&quot;},
-    {&quot;uncompress&quot;, OPT_UNCOMPRESS, '-', &quot;Uncompress a CMS \&quot;CompressedData\&quot; object&quot;},
+    {&quot;uncompress&quot;, OPT_UNCOMPRESS, '-',
+        &quot;Uncompress a CMS \&quot;CompressedData\&quot; object&quot;},
     {&quot;EncryptedData_decrypt&quot;, OPT_ED_DECRYPT, '-',
         &quot;Decrypt CMS \&quot;EncryptedData\&quot; object using symmetric key&quot;},
     {&quot;EncryptedData_encrypt&quot;, OPT_ED_ENCRYPT, '-',
         &quot;Create CMS \&quot;EncryptedData\&quot; object using symmetric key&quot;},
-    {&quot;debug_decrypt&quot;, OPT_DEBUG_DECRYPT, '-',
-        &quot;Disable MMA protection and return an error if no recipient found&quot;
-        &quot; (see documentation)&quot;},
+    {&quot;data_out&quot;, OPT_DATA_OUT, '-', &quot;Copy CMS \&quot;Data\&quot; object to output&quot;},
+    {&quot;data_create&quot;, OPT_DATA_CREATE, '-', &quot;Create a CMS \&quot;Data\&quot; object&quot;},
+    {&quot;cmsout&quot;, OPT_CMSOUT, '-', &quot;Output CMS structure&quot;},
+    {&quot;no_content_verify&quot;, OPT_NO_CONTENT_VERIFY, '-',
+        &quot;Do not verify signed content signatures&quot;},
+    {&quot;no_attr_verify&quot;, OPT_NO_ATTR_VERIFY, '-',
+        &quot;Do not verify signed attribute signatures&quot;},
+    {&quot;nointern&quot;, OPT_NOINTERN, '-',
+        &quot;Don't search certificates in message for signer&quot;},
+    {&quot;noverify&quot;, OPT_NOVERIFY, '-', &quot;Don't verify signers certificate&quot;},
+
+    OPT_SECTION(&quot;Formatting&quot;),
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Include or delete text MIME headers&quot;},
     {&quot;asciicrlf&quot;, OPT_ASCIICRLF, '-',
         &quot;Perform CRLF canonicalisation when signing&quot;},
-    {&quot;nointern&quot;, OPT_NOINTERN, '-',
-     &quot;Don't search certificates in message for signer&quot;},
-    {&quot;noverify&quot;, OPT_NOVERIFY, '-', &quot;Don't verify signers certificate&quot;},
-    {&quot;nocerts&quot;, OPT_NOCERTS, '-',
-     &quot;Don't include signers certificate when signing&quot;},
-    {&quot;noattr&quot;, OPT_NOATTR, '-', &quot;Don't include any signed attributes&quot;},
     {&quot;nodetach&quot;, OPT_NODETACH, '-', &quot;Use opaque signing&quot;},
     {&quot;nosmimecap&quot;, OPT_NOSMIMECAP, '-', &quot;Omit the SMIMECapabilities attribute&quot;},
+    {&quot;noattr&quot;, OPT_NOATTR, '-', &quot;Don't include any signed attributes&quot;},
     {&quot;binary&quot;, OPT_BINARY, '-', &quot;Don't translate message to text&quot;},
     {&quot;keyid&quot;, OPT_KEYID, '-', &quot;Use subject key identifier&quot;},
     {&quot;nosigs&quot;, OPT_NOSIGS, '-', &quot;Don't verify message signature&quot;},
-    {&quot;no_content_verify&quot;, OPT_NO_CONTENT_VERIFY, '-',
-        &quot;Do not verify signed content signatures&quot;},
-    {&quot;no_attr_verify&quot;, OPT_NO_ATTR_VERIFY, '-',
-        &quot;Do not verify signed attribute signatures&quot;},
-    {&quot;stream&quot;, OPT_INDEF, '-', &quot;Enable CMS streaming&quot;},
-    {&quot;indef&quot;, OPT_INDEF, '-', &quot;Same as -stream&quot;},
-    {&quot;noindef&quot;, OPT_NOINDEF, '-', &quot;Disable CMS streaming&quot;},
-    {&quot;crlfeol&quot;, OPT_CRLFEOL, '-', &quot;Use CRLF as EOL termination instead of CR only&quot; },
-    {&quot;noout&quot;, OPT_NOOUT, '-', &quot;For the -cmsout operation do not output the parsed CMS structure&quot;},
+    {&quot;nocerts&quot;, OPT_NOCERTS, '-',
+     &quot;Don't include signers certificate when signing&quot;},
+    {&quot;noout&quot;, OPT_NOOUT, '-',
+        &quot;For the -cmsout operation do not output the parsed CMS structure&quot;},
     {&quot;receipt_request_print&quot;, OPT_RR_PRINT, '-', &quot;Print CMS Receipt Request&quot; },
     {&quot;receipt_request_all&quot;, OPT_RR_ALL, '-',
         &quot;When signing, create a receipt request for all recipients&quot;},
@@ -155,54 +174,51 @@ const OPTIONS cms_options[] = {
         &quot;When signing, create a receipt request for first recipient&quot;},
     {&quot;rctform&quot;, OPT_RCTFORM, 'F', &quot;Receipt file format&quot;},
     {&quot;certfile&quot;, OPT_CERTFILE, '&lt;', &quot;Other certificates file&quot;},
-    {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;Trusted certificates file&quot;},
-    {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;trusted certificates directory&quot;},
-    {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;trusted certificates store URI&quot;},
-    {&quot;no-CAfile&quot;, OPT_NOCAFILE, '-',
-     &quot;Do not load the default certificates file&quot;},
-    {&quot;no-CApath&quot;, OPT_NOCAPATH, '-',
-     &quot;Do not load certificates from the default certificates directory&quot;},
-    {&quot;no-CAstore&quot;, OPT_NOCASTORE, '-',
-     &quot;Do not load certificates from the default certificates store&quot;},
     {&quot;content&quot;, OPT_CONTENT, '&lt;',
      &quot;Supply or override content for detached signature&quot;},
     {&quot;print&quot;, OPT_PRINT, '-',
      &quot;For the -cmsout operation print out all fields of the CMS structure&quot;},
+    {&quot;certsout&quot;, OPT_CERTSOUT, '&gt;', &quot;Certificate output file&quot;},
+
+    OPT_SECTION(&quot;Keying&quot;),
     {&quot;secretkey&quot;, OPT_SECRETKEY, 's',
         &quot;Use specified hex-encoded key to decrypt/encrypt recipients or content&quot;},
     {&quot;secretkeyid&quot;, OPT_SECRETKEYID, 's',
         &quot;Identity of the -secretkey for CMS \&quot;KEKRecipientInfo\&quot; object&quot;},
     {&quot;pwri_password&quot;, OPT_PWRI_PASSWORD, 's',
         &quot;Specific password for recipient&quot;},
-    {&quot;econtent_type&quot;, OPT_ECONTENT_TYPE, 's', &quot;OID for external content&quot;},
     {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
+    {&quot;inkey&quot;, OPT_INKEY, 's',
+     &quot;Input private key (if not signer or recipient)&quot;},
+    {&quot;keyform&quot;, OPT_KEYFORM, 'f', &quot;Input private key format (PEM or ENGINE)&quot;},
+    {&quot;keyopt&quot;, OPT_KEYOPT, 's', &quot;Set public key parameters as n:v pairs&quot;},
+
+    OPT_SECTION(&quot;Mail header&quot;),
+    {&quot;econtent_type&quot;, OPT_ECONTENT_TYPE, 's', &quot;OID for external content&quot;},
     {&quot;to&quot;, OPT_TO, 's', &quot;To address&quot;},
     {&quot;from&quot;, OPT_FROM, 's', &quot;From address&quot;},
     {&quot;subject&quot;, OPT_SUBJECT, 's', &quot;Subject&quot;},
     {&quot;signer&quot;, OPT_SIGNER, 's', &quot;Signer certificate file&quot;},
     {&quot;recip&quot;, OPT_RECIP, '&lt;', &quot;Recipient cert file for decryption&quot;},
-    {&quot;certsout&quot;, OPT_CERTSOUT, '&gt;', &quot;Certificate output file&quot;},
-    {&quot;md&quot;, OPT_MD, 's', &quot;Digest algorithm to use when signing or resigning&quot;},
-    {&quot;inkey&quot;, OPT_INKEY, 's',
-     &quot;Input private key (if not signer or recipient)&quot;},
-    {&quot;keyform&quot;, OPT_KEYFORM, 'f', &quot;Input private key format (PEM or ENGINE)&quot;},
-    {&quot;keyopt&quot;, OPT_KEYOPT, 's', &quot;Set public key parameters as n:v pairs&quot;},
     {&quot;receipt_request_from&quot;, OPT_RR_FROM, 's',
         &quot;Create signed receipt request with specified email address&quot;},
     {&quot;receipt_request_to&quot;, OPT_RR_TO, 's',
         &quot;Create signed receipt targeted to specified address&quot;},
+
+    OPT_SECTION(&quot;Encryption&quot;),
+    {&quot;md&quot;, OPT_MD, 's', &quot;Digest algorithm to use when signing or resigning&quot;},
     {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
-    OPT_R_OPTIONS,
-    OPT_V_OPTIONS,
+
+    OPT_SECTION(&quot;Key-wrapping&quot;),
     {&quot;aes128-wrap&quot;, OPT_AES128_WRAP, '-', &quot;Use AES128 to wrap key&quot;},
     {&quot;aes192-wrap&quot;, OPT_AES192_WRAP, '-', &quot;Use AES192 to wrap key&quot;},
     {&quot;aes256-wrap&quot;, OPT_AES256_WRAP, '-', &quot;Use AES256 to wrap key&quot;},
 # ifndef OPENSSL_NO_DES
     {&quot;des3-wrap&quot;, OPT_3DES_WRAP, '-', &quot;Use 3DES-EDE to wrap key&quot;},
 # endif
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
-# endif
+
+    OPT_R_OPTIONS,
+    OPT_V_OPTIONS,
     {NULL}
 };
 
diff --git a/apps/crl.c b/apps/crl.c
index f7f4fb7150..14410f3512 100644
--- a/apps/crl.c
+++ b/apps/crl.c
@@ -28,13 +28,28 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS crl_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format; default PEM&quot;},
+    {&quot;verify&quot;, OPT_VERIFY, '-', &quot;Verify CRL signature&quot;},
+
+    OPT_SECTION(&quot;Input&quot;),
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file - default stdin&quot;},
-    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format - default PEM&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;output file - default stdout&quot;},
-    {&quot;keyform&quot;, OPT_KEYFORM, 'F', &quot;Private key file format (PEM or ENGINE)&quot;},
+    {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format; default PEM&quot;},
     {&quot;key&quot;, OPT_KEY, '&lt;', &quot;CRL signing Private key to use&quot;},
+    {&quot;keyform&quot;, OPT_KEYFORM, 'F', &quot;Private key file format (PEM or ENGINE)&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;output file - default stdout&quot;},
+    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format - default PEM&quot;},
+    {&quot;text&quot;, OPT_TEXT, '-', &quot;Print out a text format version&quot;},
+    {&quot;hash&quot;, OPT_HASH, '-', &quot;Print hash value&quot;},
+#ifndef OPENSSL_NO_MD5
+    {&quot;hash_old&quot;, OPT_HASH_OLD, '-', &quot;Print old-style (MD5) hash value&quot;},
+#endif
+    {&quot;nameopt&quot;, OPT_NAMEOPT, 's', &quot;Various certificate name options&quot;},
+    {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest&quot;},
+
+    OPT_SECTION(&quot;CRL&quot;),
     {&quot;issuer&quot;, OPT_ISSUER, '-', &quot;Print issuer DN&quot;},
     {&quot;lastupdate&quot;, OPT_LASTUPDATE, '-', &quot;Set lastUpdate field&quot;},
     {&quot;nextupdate&quot;, OPT_NEXTUPDATE, '-', &quot;Set nextUpdate field&quot;},
@@ -43,6 +58,8 @@ const OPTIONS crl_options[] = {
     {&quot;crlnumber&quot;, OPT_CRLNUMBER, '-', &quot;Print CRL number&quot;},
     {&quot;badsig&quot;, OPT_BADSIG, '-', &quot;Corrupt last byte of loaded CRL signature (for test)&quot; },
     {&quot;gendelta&quot;, OPT_GENDELTA, '&lt;', &quot;Other CRL to compare/diff to the Input one&quot;},
+
+    OPT_SECTION(&quot;Certificate&quot;),
     {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;Verify CRL using certificates in dir&quot;},
     {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;Verify CRL using certificates in file name&quot;},
     {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;Verify CRL using certificates in store URI&quot;},
@@ -52,14 +69,6 @@ const OPTIONS crl_options[] = {
      &quot;Do not load certificates from the default certificates directory&quot;},
     {&quot;no-CAstore&quot;, OPT_NOCASTORE, '-',
      &quot;Do not load certificates from the default certificates store&quot;},
-    {&quot;verify&quot;, OPT_VERIFY, '-', &quot;Verify CRL signature&quot;},
-    {&quot;text&quot;, OPT_TEXT, '-', &quot;Print out a text format version&quot;},
-    {&quot;hash&quot;, OPT_HASH, '-', &quot;Print hash value&quot;},
-    {&quot;nameopt&quot;, OPT_NAMEOPT, 's', &quot;Various certificate name options&quot;},
-    {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest&quot;},
-#ifndef OPENSSL_NO_MD5
-    {&quot;hash_old&quot;, OPT_HASH_OLD, '-', &quot;Print old-style (MD5) hash value&quot;},
-#endif
     {NULL}
 };
 
diff --git a/apps/crl2p7.c b/apps/crl2p7.c
index 6f284cb10e..ffbee4cbff 100644
--- a/apps/crl2p7.c
+++ b/apps/crl2p7.c
@@ -27,14 +27,19 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS crl2pkcs7_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format - DER or PEM&quot;},
-    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format - DER or PEM&quot;},
+
+    OPT_SECTION(&quot;Input&quot;),
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format - DER or PEM&quot;},
     {&quot;nocrl&quot;, OPT_NOCRL, '-', &quot;No crl to load, just certs from '-certfile'&quot;},
     {&quot;certfile&quot;, OPT_CERTFILE, '&lt;',
      &quot;File of chain of certs to a trusted CA; can be repeated&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format - DER or PEM&quot;},
     {NULL}
 };
 
diff --git a/apps/dgst.c b/apps/dgst.c
index 531627c40a..7e1afb9bba 100644
--- a/apps/dgst.c
+++ b/apps/dgst.c
@@ -49,36 +49,40 @@ const OPTIONS dgst_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] [file...]\n&quot;},
     {OPT_HELP_STR, 1, '-',
         &quot;  file... files to digest (default is stdin)\n&quot;},
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
     {&quot;list&quot;, OPT_LIST, '-', &quot;List digests&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
+    {&quot;engine_impl&quot;, OPT_ENGINE_IMPL, '-',
+     &quot;Also use engine given by -engine for digest operations&quot;},
+#endif
+    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;c&quot;, OPT_C, '-', &quot;Print the digest with separating colons&quot;},
     {&quot;r&quot;, OPT_R, '-', &quot;Print the digest in coreutils format&quot;},
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output to filename rather than stdout&quot;},
-    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
-    {&quot;sign&quot;, OPT_SIGN, 's', &quot;Sign digest using private key&quot;},
-    {&quot;verify&quot;, OPT_VERIFY, 's',
-     &quot;Verify a signature using public key&quot;},
-    {&quot;prverify&quot;, OPT_PRVERIFY, 's',
-     &quot;Verify a signature using private key&quot;},
-    {&quot;signature&quot;, OPT_SIGNATURE, '&lt;', &quot;File with signature to verify&quot;},
     {&quot;keyform&quot;, OPT_KEYFORM, 'f', &quot;Key file format (PEM or ENGINE)&quot;},
     {&quot;hex&quot;, OPT_HEX, '-', &quot;Print as hex dump&quot;},
     {&quot;binary&quot;, OPT_BINARY, '-', &quot;Print in binary form&quot;},
     {&quot;d&quot;, OPT_DEBUG, '-', &quot;Print debug info&quot;},
     {&quot;debug&quot;, OPT_DEBUG, '-', &quot;Print debug info&quot;},
-    {&quot;fips-fingerprint&quot;, OPT_FIPS_FINGERPRINT, '-',
-     &quot;Compute HMAC with the key used in OpenSSL-FIPS fingerprint&quot;},
+
+    OPT_SECTION(&quot;Signing&quot;),
+    {&quot;sign&quot;, OPT_SIGN, 's', &quot;Sign digest using private key&quot;},
+    {&quot;verify&quot;, OPT_VERIFY, 's', &quot;Verify a signature using public key&quot;},
+    {&quot;prverify&quot;, OPT_PRVERIFY, 's', &quot;Verify a signature using private key&quot;},
+    {&quot;sigopt&quot;, OPT_SIGOPT, 's', &quot;Signature parameter in n:v form&quot;},
+    {&quot;signature&quot;, OPT_SIGNATURE, '&lt;', &quot;File with signature to verify&quot;},
     {&quot;hmac&quot;, OPT_HMAC, 's', &quot;Create hashed MAC with key&quot;},
     {&quot;mac&quot;, OPT_MAC, 's', &quot;Create MAC (not necessarily HMAC)&quot;},
-    {&quot;sigopt&quot;, OPT_SIGOPT, 's', &quot;Signature parameter in n:v form&quot;},
     {&quot;macopt&quot;, OPT_MACOPT, 's', &quot;MAC algorithm parameters in n:v form or key&quot;},
     {&quot;&quot;, OPT_DIGEST, '-', &quot;Any supported digest&quot;},
+    {&quot;fips-fingerprint&quot;, OPT_FIPS_FINGERPRINT, '-',
+     &quot;Compute HMAC with the key used in OpenSSL-FIPS fingerprint&quot;},
+
     OPT_R_OPTIONS,
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
-    {&quot;engine_impl&quot;, OPT_ENGINE_IMPL, '-',
-     &quot;Also use engine given by -engine for digest operations&quot;},
-#endif
     {NULL}
 };
 
diff --git a/apps/dhparam.c b/apps/dhparam.c
index 7cd69b9270..74758a5dee 100644
--- a/apps/dhparam.c
+++ b/apps/dhparam.c
@@ -43,27 +43,33 @@ typedef enum OPTION_choice {
 
 const OPTIONS dhparam_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [flags] [numbits]\n&quot;},
-    {OPT_HELP_STR, 1, '-', &quot;Valid options are:\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+    {&quot;check&quot;, OPT_CHECK, '-', &quot;Check the DH parameters&quot;},
+# ifndef OPENSSL_NO_DSA
+    {&quot;dsaparam&quot;, OPT_DSAPARAM, '-',
+     &quot;Read or generate DSA parameters, convert to DH&quot;},
+# endif
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
+# endif
+
+    OPT_SECTION(&quot;Input&quot;),
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
     {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format, DER or PEM&quot;},
-    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format, DER or PEM&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
-    {&quot;check&quot;, OPT_CHECK, '-', &quot;Check the DH parameters&quot;},
+    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format, DER or PEM&quot;},
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Print a text form of the DH parameters&quot;},
     {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't output any DH parameters&quot;},
-    OPT_R_OPTIONS,
     {&quot;C&quot;, OPT_C, '-', &quot;Print C code&quot;},
     {&quot;2&quot;, OPT_2, '-', &quot;Generate parameters using 2 as the generator value&quot;},
     {&quot;3&quot;, OPT_3, '-', &quot;Generate parameters using 3 as the generator value&quot;},
     {&quot;5&quot;, OPT_5, '-', &quot;Generate parameters using 5 as the generator value&quot;},
-# ifndef OPENSSL_NO_DSA
-    {&quot;dsaparam&quot;, OPT_DSAPARAM, '-',
-     &quot;Read or generate DSA parameters, convert to DH&quot;},
-# endif
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
-# endif
+
+    OPT_R_OPTIONS,
     {NULL}
 };
 
diff --git a/apps/dsa.c b/apps/dsa.c
index 629ba1d9e3..f0c9fc1c52 100644
--- a/apps/dsa.c
+++ b/apps/dsa.c
@@ -36,18 +36,8 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS dsa_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;inform&quot;, OPT_INFORM, 'f', &quot;Input format, DER PEM PVK&quot;},
-    {&quot;outform&quot;, OPT_OUTFORM, 'f', &quot;Output format, DER PEM PVK&quot;},
-    {&quot;in&quot;, OPT_IN, 's', &quot;Input key&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
-    {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't print key out&quot;},
-    {&quot;text&quot;, OPT_TEXT, '-', &quot;Print the key in text&quot;},
-    {&quot;modulus&quot;, OPT_MODULUS, '-', &quot;Print the DSA public value&quot;},
-    {&quot;pubin&quot;, OPT_PUBIN, '-', &quot;Expect a public key in input file&quot;},
-    {&quot;pubout&quot;, OPT_PUBOUT, '-', &quot;Output public key, not private&quot;},
-    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
-    {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
     {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
 # ifndef OPENSSL_NO_RC4
     {&quot;pvk-strong&quot;, OPT_PVK_STRONG, '-', &quot;Enable 'Strong' PVK encoding level (default)&quot;},
@@ -57,6 +47,22 @@ const OPTIONS dsa_options[] = {
 # ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
 # endif
+
+    OPT_SECTION(&quot;Input&quot;),
+    {&quot;in&quot;, OPT_IN, 's', &quot;Input key&quot;},
+    {&quot;inform&quot;, OPT_INFORM, 'f', &quot;Input format, DER PEM PVK&quot;},
+    {&quot;pubin&quot;, OPT_PUBIN, '-', &quot;Expect a public key in input file&quot;},
+    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;outform&quot;, OPT_OUTFORM, 'f', &quot;Output format, DER PEM PVK&quot;},
+    {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't print key out&quot;},
+    {&quot;text&quot;, OPT_TEXT, '-', &quot;Print the key in text&quot;},
+    {&quot;modulus&quot;, OPT_MODULUS, '-', &quot;Print the DSA public value&quot;},
+    {&quot;pubout&quot;, OPT_PUBOUT, '-', &quot;Output public key, not private&quot;},
+    {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
+
     {NULL}
 };
 
diff --git a/apps/dsaparam.c b/apps/dsaparam.c
index 959c33126a..bea5de3dba 100644
--- a/apps/dsaparam.c
+++ b/apps/dsaparam.c
@@ -37,20 +37,26 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS dsaparam_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format - DER or PEM&quot;},
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
+# endif
+
+    OPT_SECTION(&quot;Input&quot;),
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
-    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format - DER or PEM&quot;},
+    {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format - DER or PEM&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format - DER or PEM&quot;},
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Print as text&quot;},
     {&quot;C&quot;, OPT_C, '-', &quot;Output C code&quot;},
     {&quot;noout&quot;, OPT_NOOUT, '-', &quot;No output&quot;},
+    {&quot;verbose&quot;, OPT_VERBOSE, '-', &quot;Verbose output&quot;},
     {&quot;genkey&quot;, OPT_GENKEY, '-', &quot;Generate a DSA key&quot;},
+
     OPT_R_OPTIONS,
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine e, possibly a hardware device&quot;},
-# endif
-    {&quot;verbose&quot;, OPT_VERBOSE, '-', &quot;Verbose output&quot;},
     {NULL}
 };
 
diff --git a/apps/ec.c b/apps/ec.c
index c09d29d378..3d901bbad3 100644
--- a/apps/ec.c
+++ b/apps/ec.c
@@ -44,27 +44,32 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS ec_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+# endif
+
+    OPT_SECTION(&quot;Input&quot;),
     {&quot;in&quot;, OPT_IN, 's', &quot;Input file&quot;},
     {&quot;inform&quot;, OPT_INFORM, 'f', &quot;Input format - DER or PEM&quot;},
+    {&quot;pubin&quot;, OPT_PUBIN, '-', &quot;Expect a public key in input file&quot;},
+    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
+    {&quot;check&quot;, OPT_CHECK, '-', &quot;check key consistency&quot;},
+    {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
+    {&quot;param_enc&quot;, OPT_PARAM_ENC, 's',
+     &quot;Specifies the way the ec parameters are encoded&quot;},
+    {&quot;conv_form&quot;, OPT_CONV_FORM, 's', &quot;Specifies the point conversion form &quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
     {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format - DER or PEM&quot;},
     {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't print key out&quot;},
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Print the key&quot;},
     {&quot;param_out&quot;, OPT_PARAM_OUT, '-', &quot;Print the elliptic curve parameters&quot;},
-    {&quot;pubin&quot;, OPT_PUBIN, '-', &quot;Expect a public key in input file&quot;},
     {&quot;pubout&quot;, OPT_PUBOUT, '-', &quot;Output public key, not private&quot;},
     {&quot;no_public&quot;, OPT_NO_PUBLIC, '-', &quot;exclude public key from private key&quot;},
-    {&quot;check&quot;, OPT_CHECK, '-', &quot;check key consistency&quot;},
-    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
     {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
-    {&quot;param_enc&quot;, OPT_PARAM_ENC, 's',
-     &quot;Specifies the way the ec parameters are encoded&quot;},
-    {&quot;conv_form&quot;, OPT_CONV_FORM, 's', &quot;Specifies the point conversion form &quot;},
-    {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-# endif
     {NULL}
 };
 
diff --git a/apps/ecparam.c b/apps/ecparam.c
index 6796af6578..307eb1f37e 100644
--- a/apps/ecparam.c
+++ b/apps/ecparam.c
@@ -35,31 +35,38 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS ecparam_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format - default PEM (DER or PEM)&quot;},
-    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format - default PEM&quot;},
+    {&quot;list_curves&quot;, OPT_LIST_CURVES, '-',
+     &quot;Prints a list of all curve 'short names'&quot;},
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+# endif
+
+    {&quot;genkey&quot;, OPT_GENKEY, '-', &quot;Generate ec key&quot;},
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file  - default stdin&quot;},
+    {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format - default PEM (DER or PEM)&quot;},
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file - default stdout&quot;},
+    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format - default PEM&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Print the ec parameters in text form&quot;},
     {&quot;C&quot;, OPT_C, '-', &quot;Print a 'C' function creating the parameters&quot;},
+    {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Do not print the ec parameter&quot;},
+    {&quot;param_enc&quot;, OPT_PARAM_ENC, 's',
+     &quot;Specifies the way the ec parameters are encoded&quot;},
+
+    OPT_SECTION(&quot;Parameter&quot;),
     {&quot;check&quot;, OPT_CHECK, '-', &quot;Validate the ec parameters&quot;},
     {&quot;check_named&quot;, OPT_CHECK_NAMED, '-',
      &quot;Check that named EC curve parameters have not been modified&quot;},
-    {&quot;list_curves&quot;, OPT_LIST_CURVES, '-',
-     &quot;Prints a list of all curve 'short names'&quot;},
     {&quot;no_seed&quot;, OPT_NO_SEED, '-',
      &quot;If 'explicit' parameters are chosen do not use the seed&quot;},
-    {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Do not print the ec parameter&quot;},
     {&quot;name&quot;, OPT_NAME, 's',
      &quot;Use the ec parameters with specified 'short name'&quot;},
     {&quot;conv_form&quot;, OPT_CONV_FORM, 's', &quot;Specifies the point conversion form &quot;},
-    {&quot;param_enc&quot;, OPT_PARAM_ENC, 's',
-     &quot;Specifies the way the ec parameters are encoded&quot;},
-    {&quot;genkey&quot;, OPT_GENKEY, '-', &quot;Generate ec key&quot;},
+
     OPT_R_OPTIONS,
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-# endif
     {NULL}
 };
 
diff --git a/apps/enc.c b/apps/enc.c
index 243cc1280c..2b23564fab 100644
--- a/apps/enc.c
+++ b/apps/enc.c
@@ -49,30 +49,41 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS enc_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
     {&quot;list&quot;, OPT_LIST, '-', &quot;List ciphers&quot;},
 #ifndef OPENSSL_NO_DEPRECATED_3_0
     {&quot;ciphers&quot;, OPT_LIST, '-', &quot;Alias for -list&quot;},
 #endif
-    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
-    {&quot;pass&quot;, OPT_PASS, 's', &quot;Passphrase source&quot;},
     {&quot;e&quot;, OPT_E, '-', &quot;Encrypt&quot;},
     {&quot;d&quot;, OPT_D, '-', &quot;Decrypt&quot;},
     {&quot;p&quot;, OPT_P, '-', &quot;Print the iv/key&quot;},
     {&quot;P&quot;, OPT_UPPER_P, '-', &quot;Print the iv/key and exit&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#endif
+
+    OPT_SECTION(&quot;Input&quot;),
+    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
+    {&quot;k&quot;, OPT_K, 's', &quot;Passphrase&quot;},
+    {&quot;kfile&quot;, OPT_KFILE, '&lt;', &quot;Read passphrase from file&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;pass&quot;, OPT_PASS, 's', &quot;Passphrase source&quot;},
     {&quot;v&quot;, OPT_V, '-', &quot;Verbose output&quot;},
-    {&quot;nopad&quot;, OPT_NOPAD, '-', &quot;Disable standard block padding&quot;},
-    {&quot;salt&quot;, OPT_SALT, '-', &quot;Use salt in the KDF (default)&quot;},
-    {&quot;nosalt&quot;, OPT_NOSALT, '-', &quot;Do not use salt in the KDF&quot;},
-    {&quot;debug&quot;, OPT_DEBUG, '-', &quot;Print debug info&quot;},
     {&quot;a&quot;, OPT_A, '-', &quot;Base64 encode/decode, depending on encryption flag&quot;},
     {&quot;base64&quot;, OPT_A, '-', &quot;Same as option -a&quot;},
     {&quot;A&quot;, OPT_UPPER_A, '-',
      &quot;Used with -[base64|a] to specify base64 buffer as a single line&quot;},
+
+    OPT_SECTION(&quot;Encryption&quot;),
+    {&quot;nopad&quot;, OPT_NOPAD, '-', &quot;Disable standard block padding&quot;},
+    {&quot;salt&quot;, OPT_SALT, '-', &quot;Use salt in the KDF (default)&quot;},
+    {&quot;nosalt&quot;, OPT_NOSALT, '-', &quot;Do not use salt in the KDF&quot;},
+    {&quot;debug&quot;, OPT_DEBUG, '-', &quot;Print debug info&quot;},
+
     {&quot;bufsize&quot;, OPT_BUFSIZE, 's', &quot;Buffer size&quot;},
-    {&quot;k&quot;, OPT_K, 's', &quot;Passphrase&quot;},
-    {&quot;kfile&quot;, OPT_KFILE, '&lt;', &quot;Read passphrase from file&quot;},
     {&quot;K&quot;, OPT_UPPER_K, 's', &quot;Raw key, in hex&quot;},
     {&quot;S&quot;, OPT_UPPER_S, 's', &quot;Salt, in hex&quot;},
     {&quot;iv&quot;, OPT_IV, 's', &quot;IV in hex&quot;},
@@ -80,14 +91,12 @@ const OPTIONS enc_options[] = {
     {&quot;iter&quot;, OPT_ITER, 'p', &quot;Specify the iteration count and force use of PBKDF2&quot;},
     {&quot;pbkdf2&quot;, OPT_PBKDF2, '-', &quot;Use password-based key derivation function 2&quot;},
     {&quot;none&quot;, OPT_NONE, '-', &quot;Don't encrypt&quot;},
-    {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
-    OPT_R_OPTIONS,
 #ifdef ZLIB
     {&quot;z&quot;, OPT_Z, '-', &quot;Use zlib as the 'encryption'&quot;},
 #endif
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-#endif
+    {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
+
+    OPT_R_OPTIONS,
     {NULL}
 };
 
diff --git a/apps/engine.c b/apps/engine.c
index 8444fe2df6..24dff22c54 100644
--- a/apps/engine.c
+++ b/apps/engine.c
@@ -32,16 +32,20 @@ const OPTIONS engine_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] engine...\n&quot;},
     {OPT_HELP_STR, 1, '-',
         &quot;  engine... Engines to load\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+    {&quot;t&quot;, OPT_T, '-', &quot;Check that specified engine is available&quot;},
+    {&quot;pre&quot;, OPT_PRE, 's', &quot;Run command against the ENGINE before loading it&quot;},
+    {&quot;post&quot;, OPT_POST, 's', &quot;Run command against the ENGINE after loading it&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;v&quot;, OPT_V, '-', &quot;List 'control commands' For each specified engine&quot;},
     {&quot;vv&quot;, OPT_VV, '-', &quot;Also display each command's description&quot;},
     {&quot;vvv&quot;, OPT_VVV, '-', &quot;Also add the input flags for each command&quot;},
     {&quot;vvvv&quot;, OPT_VVVV, '-', &quot;Also show internal input flags&quot;},
     {&quot;c&quot;, OPT_C, '-', &quot;List the capabilities of specified engine&quot;},
-    {&quot;t&quot;, OPT_T, '-', &quot;Check that specified engine is available&quot;},
     {&quot;tt&quot;, OPT_TT, '-', &quot;Display error trace for unavailable engines&quot;},
-    {&quot;pre&quot;, OPT_PRE, 's', &quot;Run command against the ENGINE before loading it&quot;},
-    {&quot;post&quot;, OPT_POST, 's', &quot;Run command against the ENGINE after loading it&quot;},
     {OPT_MORE_STR, OPT_EOF, 1,
      &quot;Commands are like \&quot;SO_PATH:/lib/libdriver.so\&quot;&quot;},
     {NULL}
diff --git a/apps/errstr.c b/apps/errstr.c
index df0253c416..212b7293cd 100644
--- a/apps/errstr.c
+++ b/apps/errstr.c
@@ -23,6 +23,8 @@ typedef enum OPTION_choice {
 const OPTIONS errstr_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] errnum...\n&quot;},
     {OPT_HELP_STR, 1, '-', &quot;  errnum  Error number\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
     {NULL}
 };
diff --git a/apps/fipsinstall.c b/apps/fipsinstall.c
index fd28b484b9..8846779932 100644
--- a/apps/fipsinstall.c
+++ b/apps/fipsinstall.c
@@ -32,18 +32,20 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS fipsinstall_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {OPT_MORE_STR, 0, 0, &quot;e.g: openssl fipsinstall -provider_name fips&quot;
-     &quot;-section_name fipsinstall -out fips.conf -module ./fips.so&quot;
-     &quot;-mac_name HMAC -macopt digest:SHA256 -macopt hexkey:00&quot;},
     {&quot;verify&quot;, OPT_VERIFY, '-', &quot;Verification mode, i.e verify a config file &quot;
      &quot;instead of generating one&quot;},
-    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input config file, used when verifying&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output config file, used when generating&quot;},
     {&quot;module&quot;, OPT_MODULE, '&lt;', &quot;File name of the provider module&quot;},
     {&quot;provider_name&quot;, OPT_PROV_NAME, 's', &quot;FIPS provider name&quot;},
     {&quot;section_name&quot;, OPT_SECTION_NAME, 's',
      &quot;FIPS Provider config section name (optional)&quot;},
+
+    OPT_SECTION(&quot;Input&quot;),
+    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input config file, used when verifying&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output config file, used when generating&quot;},
     {&quot;mac_name&quot;, OPT_MAC_NAME, 's', &quot;MAC name&quot;},
     {&quot;macopt&quot;, OPT_MACOPT, 's', &quot;MAC algorithm parameters in n:v form. &quot;
                                 &quot;See 'PARAMETER NAMES' in the EVP_MAC_ docs&quot;},
diff --git a/apps/gendsa.c b/apps/gendsa.c
index 9671b23424..45ae815fd4 100644
--- a/apps/gendsa.c
+++ b/apps/gendsa.c
@@ -33,15 +33,18 @@ typedef enum OPTION_choice {
 
 const OPTIONS gendsa_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [args] dsaparam-file\n&quot;},
-    {OPT_HELP_STR, 1, '-', &quot;Valid options are:\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+# endif
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output the key to the specified file&quot;},
     {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
     OPT_R_OPTIONS,
     {&quot;&quot;, OPT_CIPHER, '-', &quot;Encrypt the output with any supported cipher&quot;},
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-# endif
     {&quot;verbose&quot;, OPT_VERBOSE, '-', &quot;Verbose output&quot;},
     {NULL}
 };
diff --git a/apps/genpkey.c b/apps/genpkey.c
index afae4b656c..3ae508c1c8 100644
--- a/apps/genpkey.c
+++ b/apps/genpkey.c
@@ -28,20 +28,24 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS genpkey_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
-    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;output format (DER or PEM)&quot;},
-    {&quot;pass&quot;, OPT_PASS, 's', &quot;Output file pass phrase source&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#endif
     {&quot;paramfile&quot;, OPT_PARAMFILE, '&lt;', &quot;Parameters file&quot;},
     {&quot;algorithm&quot;, OPT_ALGORITHM, 's', &quot;The public key algorithm&quot;},
     {&quot;pkeyopt&quot;, OPT_PKEYOPT, 's',
      &quot;Set the public key algorithm option as opt:value&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;output format (DER or PEM)&quot;},
+    {&quot;pass&quot;, OPT_PASS, 's', &quot;Output file pass phrase source&quot;},
     {&quot;genparam&quot;, OPT_GENPARAM, '-', &quot;Generate parameters, not key&quot;},
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Print the in text&quot;},
     {&quot;&quot;, OPT_CIPHER, '-', &quot;Cipher to use to encrypt the key&quot;},
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-#endif
+
     /* This is deliberately last. */
     {OPT_HELP_STR, 1, 1,
      &quot;Order of options may be important!  See the documentation.\n&quot;},
diff --git a/apps/genrsa.c b/apps/genrsa.c
index ebf9c55329..fe57547f33 100644
--- a/apps/genrsa.c
+++ b/apps/genrsa.c
@@ -42,19 +42,26 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS genrsa_options[] = {
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+# endif
+
+    OPT_SECTION(&quot;Input&quot;),
     {&quot;3&quot;, OPT_3, '-', &quot;Use 3 for the E value&quot;},
     {&quot;F4&quot;, OPT_F4, '-', &quot;Use F4 (0x10001) for the E value&quot;},
     {&quot;f4&quot;, OPT_F4, '-', &quot;Use F4 (0x10001) for the E value&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output the key to specified file&quot;},
-    OPT_R_OPTIONS,
     {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
-    {&quot;&quot;, OPT_CIPHER, '-', &quot;Encrypt the output with any supported cipher&quot;},
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-# endif
     {&quot;primes&quot;, OPT_PRIMES, 'p', &quot;Specify number of primes&quot;},
     {&quot;verbose&quot;, OPT_VERBOSE, '-', &quot;Verbose output&quot;},
+    {&quot;&quot;, OPT_CIPHER, '-', &quot;Encrypt the output with any supported cipher&quot;},
+
+    OPT_R_OPTIONS,
     {NULL}
 };
 
diff --git a/apps/include/opt.h b/apps/include/opt.h
index 5493563004..59bfdcfefb 100644
--- a/apps/include/opt.h
+++ b/apps/include/opt.h
@@ -32,6 +32,7 @@
         OPT_V__LAST
 
 # define OPT_V_OPTIONS \
+        OPT_SECTION(&quot;Validation&quot;), \
         { &quot;policy&quot;, OPT_V_POLICY, 's', &quot;adds policy to the acceptable policy set&quot;}, \
         { &quot;purpose&quot;, OPT_V_PURPOSE, 's', \
             &quot;certificate chain purpose&quot;}, \
@@ -124,6 +125,7 @@
         OPT_X__LAST
 
 # define OPT_X_OPTIONS \
+        OPT_SECTION(&quot;Extended certificate&quot;), \
         { &quot;xkey&quot;, OPT_X_KEY, '&lt;', &quot;key for Extended certificates&quot;}, \
         { &quot;xcert&quot;, OPT_X_CERT, '&lt;', &quot;cert for Extended certificates&quot;}, \
         { &quot;xchain&quot;, OPT_X_CHAIN, '&lt;', &quot;chain for Extended certificates&quot;}, \
@@ -161,6 +163,7 @@
         OPT_S_NO_RENEGOTIATION, OPT_S_NO_MIDDLEBOX, OPT_S__LAST
 
 # define OPT_S_OPTIONS \
+        OPT_SECTION(&quot;TLS/SSL&quot;), \
         {&quot;no_ssl3&quot;, OPT_S_NOSSL3, '-',&quot;Just disable SSLv3&quot; }, \
         {&quot;no_tls1&quot;, OPT_S_NOTLS1, '-', &quot;Just disable TLSv1&quot;}, \
         {&quot;no_tls1_1&quot;, OPT_S_NOTLS1_1, '-', &quot;Just disable TLSv1.1&quot; }, \
@@ -254,6 +257,7 @@
         OPT_R__FIRST=1500, OPT_R_RAND, OPT_R_WRITERAND, OPT_R__LAST
 
 # define OPT_R_OPTIONS \
+    OPT_SECTION(&quot;Random state&quot;), \
     {&quot;rand&quot;, OPT_R_RAND, 's', &quot;Load the file(s) into the random number generator&quot;}, \
     {&quot;writerand&quot;, OPT_R_WRITERAND, '&gt;', &quot;Write random data to the specified file&quot;}
 
@@ -309,7 +313,7 @@ typedef struct string_int_pair_st {
         OPT_FMT_TEXT   | OPT_FMT_HTTP   | OPT_FMT_PVK)
 
 /* Divide options into sections when displaying usage */
-#define OPT_SECTION(sec) {OPT_SECTION_STR, 1, '-', sec &quot; options:\n&quot;}
+#define OPT_SECTION(sec) { OPT_SECTION_STR, 1, '-', sec &quot; options:\n&quot; }
 
 char *opt_progname(const char *argv0);
 char *opt_getprog(void);
diff --git a/apps/info.c b/apps/info.c
index 586917298d..ae6e34c9bc 100644
--- a/apps/info.c
+++ b/apps/info.c
@@ -18,7 +18,11 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS info_options[] = {
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;configdir&quot;, OPT_CONFIGDIR, '-', &quot;Default configuration file directory&quot;},
     {&quot;enginesdir&quot;, OPT_ENGINESDIR, '-', &quot;Default engine module directory&quot;},
     {&quot;modulesdir&quot;, OPT_MODULESDIR, '-',
diff --git a/apps/kdf.c b/apps/kdf.c
index 35cc0db21c..abd21cee51 100644
--- a/apps/kdf.c
+++ b/apps/kdf.c
@@ -25,10 +25,14 @@ typedef enum OPTION_choice {
 const OPTIONS kdf_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] kdf_name\n&quot;},
     {OPT_HELP_STR, 1, '-', &quot;kdf_name\t KDF algorithm.\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;kdfopt&quot;, OPT_KDFOPT, 's', &quot;KDF algorithm control parameters in n:v form. &quot;
-                                &quot;See 'Supported Controls' in the EVP_KDF_ docs&quot;},
+    {&quot;kdfopt&quot;, OPT_KDFOPT, 's', &quot;KDF algorithm control parameters in n:v form.&quot;},
+    {OPT_HELP_STR, 1, '-', &quot;See 'Supported Controls' in the EVP_KDF_ docs&quot;},
     {&quot;keylen&quot;, OPT_KEYLEN, 's', &quot;The size of the output derived key&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output to filename rather than stdout&quot;},
     {&quot;binary&quot;, OPT_BIN, '-', &quot;Output in binary format (Default is hexadecimal &quot;
                              &quot;output)&quot;},
diff --git a/apps/lib/opt.c b/apps/lib/opt.c
index 98979fc2a1..2b9c922135 100644
--- a/apps/lib/opt.c
+++ b/apps/lib/opt.c
@@ -134,8 +134,9 @@ char *opt_init(int ac, char **av, const OPTIONS *o)
         int duplicated, i;
 #endif
 
-        if (o-&gt;name == OPT_HELP_STR || o-&gt;name == OPT_MORE_STR ||
-            o-&gt;name == OPT_SECTION_STR)
+        if (o-&gt;name == OPT_HELP_STR
+                || o-&gt;name == OPT_MORE_STR
+                || o-&gt;name == OPT_SECTION_STR)
             continue;
 #ifndef NDEBUG
         i = o-&gt;valtype;
@@ -844,7 +845,12 @@ void opt_print(const OPTIONS *o, int width)
     char *p;
 
         help = o-&gt;helpstr ? o-&gt;helpstr : &quot;(No additional info)&quot;;
-        if (o-&gt;name == OPT_HELP_STR || o-&gt;name == OPT_SECTION_STR) {
+        if (o-&gt;name == OPT_HELP_STR) {
+            opt_printf_stderr(help, prog);
+            return;
+        }
+        if (o-&gt;name == OPT_SECTION_STR) {
+            opt_printf_stderr(&quot;\n&quot;);
             opt_printf_stderr(help, prog);
             return;
         }
diff --git a/apps/list.c b/apps/list.c
index 2e8867df20..a260db80fd 100644
--- a/apps/list.c
+++ b/apps/list.c
@@ -366,6 +366,7 @@ static void list_options_for_command(const char *command)
 
         if (o-&gt;name == OPT_HELP_STR
                 || o-&gt;name == OPT_MORE_STR
+                || o-&gt;name == OPT_SECTION_STR
                 || o-&gt;name[0] == '\0')
             continue;
         BIO_printf(bio_out, &quot;%s %c\n&quot;, o-&gt;name, c == '\0' ? '-' : c);
@@ -617,7 +618,11 @@ typedef enum HELPLIST_CHOICE {
 } HELPLIST_CHOICE;
 
 const OPTIONS list_options[] = {
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;1&quot;, OPT_ONE, '-', &quot;List in one column&quot;},
     {&quot;verbose&quot;, OPT_VERBOSE, '-', &quot;Verbose listing&quot;},
     {&quot;commands&quot;, OPT_COMMANDS, '-', &quot;List of standard commands&quot;},
diff --git a/apps/mac.c b/apps/mac.c
index 8383d0d7b3..0cd3323f3b 100644
--- a/apps/mac.c
+++ b/apps/mac.c
@@ -28,10 +28,16 @@ const OPTIONS mac_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] mac_name\n&quot;},
     {OPT_HELP_STR, 1, '-', &quot;mac_name\t\t MAC algorithm (See list &quot;
                            &quot;-mac-algorithms)&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
     {&quot;macopt&quot;, OPT_MACOPT, 's', &quot;MAC algorithm parameters in n:v form. &quot;
                                 &quot;See 'PARAMETER NAMES' in the EVP_MAC_ docs&quot;},
+
+    OPT_SECTION(&quot;Input&quot;),
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file to MAC (default is stdin)&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output to filename rather than stdout&quot;},
     {&quot;binary&quot;, OPT_BIN, '-', &quot;Output in binary format (Default is hexadecimal &quot;
                              &quot;output)&quot;},
diff --git a/apps/nseq.c b/apps/nseq.c
index 6c883c0f70..5b7ab67dd1 100644
--- a/apps/nseq.c
+++ b/apps/nseq.c
@@ -20,9 +20,14 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS nseq_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;toseq&quot;, OPT_TOSEQ, '-', &quot;Output NS Sequence file&quot;},
+
+    OPT_SECTION(&quot;Input&quot;),
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;toseq&quot;, OPT_TOSEQ, '-', &quot;Output NS Sequence file&quot;},
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
     {NULL}
 };
diff --git a/apps/ocsp.c b/apps/ocsp.c
index 458c808634..ee38b23388 100644
--- a/apps/ocsp.c
+++ b/apps/ocsp.c
@@ -147,31 +147,69 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS ocsp_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;out&quot;, OPT_OUTFILE, '&gt;', &quot;Output filename&quot;},
-    {&quot;timeout&quot;, OPT_TIMEOUT, 'p',
-     &quot;Connection timeout (in seconds) to the OCSP responder&quot;},
-    {&quot;url&quot;, OPT_URL, 's', &quot;Responder URL&quot;},
-    {&quot;host&quot;, OPT_HOST, 's', &quot;TCP/IP hostname:port to connect to&quot;},
-    {&quot;port&quot;, OPT_PORT, 'p', &quot;Port to run responder on&quot;},
     {&quot;ignore_err&quot;, OPT_IGNORE_ERR, '-',
      &quot;Ignore error on OCSP request or response and continue running&quot;},
-    {&quot;noverify&quot;, OPT_NOVERIFY, '-', &quot;Don't verify response at all&quot;},
-    {&quot;nonce&quot;, OPT_NONCE, '-', &quot;Add OCSP nonce to request&quot;},
-    {&quot;no_nonce&quot;, OPT_NO_NONCE, '-', &quot;Don't add OCSP nonce to request&quot;},
+    {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;Trusted certificates file&quot;},
+    {&quot;CApath&quot;, OPT_CAPATH, '&lt;', &quot;Trusted certificates directory&quot;},
+    {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;Trusted certificates store URI&quot;},
+    {&quot;no-CAfile&quot;, OPT_NOCAFILE, '-',
+     &quot;Do not load the default certificates file&quot;},
+    {&quot;no-CApath&quot;, OPT_NOCAPATH, '-',
+     &quot;Do not load certificates from the default certificates directory&quot;},
+    {&quot;no-CAstore&quot;, OPT_NOCAPATH, '-',
+     &quot;Do not load certificates from the default certificates store&quot;},
+
+    OPT_SECTION(&quot;Responder&quot;),
+    {&quot;timeout&quot;, OPT_TIMEOUT, 'p',
+     &quot;Connection timeout (in seconds) to the OCSP responder&quot;},
     {&quot;resp_no_certs&quot;, OPT_RESP_NO_CERTS, '-',
      &quot;Don't include any certificates in response&quot;},
-    {&quot;resp_key_id&quot;, OPT_RESP_KEY_ID, '-',
-     &quot;Identify response by signing certificate key ID&quot;},
 # ifdef OCSP_DAEMON
     {&quot;multi&quot;, OPT_MULTI, 'p', &quot;run multiple responder processes&quot;},
 # endif
     {&quot;no_certs&quot;, OPT_NO_CERTS, '-',
      &quot;Don't include any certificates in signed request&quot;},
+    {&quot;badsig&quot;, OPT_BADSIG, '-',
+        &quot;Corrupt last byte of loaded OSCP response signature (for test)&quot;},
+    {&quot;CA&quot;, OPT_CA, '&lt;', &quot;CA certificate&quot;},
+    {&quot;nmin&quot;, OPT_NMIN, 'p', &quot;Number of minutes before next update&quot;},
+    {&quot;nrequest&quot;, OPT_REQUEST, 'p',
+     &quot;Number of requests to accept (default unlimited)&quot;},
+    {&quot;reqin&quot;, OPT_REQIN, 's', &quot;File with the DER-encoded request&quot;},
+    {&quot;signer&quot;, OPT_SIGNER, '&lt;', &quot;Certificate to sign OCSP request with&quot;},
+    {&quot;sign_other&quot;, OPT_SIGN_OTHER, '&lt;',
+     &quot;Additional certificates to include in signed request&quot;},
+    {&quot;index&quot;, OPT_INDEX, '&lt;', &quot;Certificate status index file&quot;},
+    {&quot;ndays&quot;, OPT_NDAYS, 'p', &quot;Number of days before next update&quot;},
+    {&quot;rsigner&quot;, OPT_RSIGNER, '&lt;',
+     &quot;Responder certificate to sign responses with&quot;},
+    {&quot;rkey&quot;, OPT_RKEY, '&lt;', &quot;Responder key to sign responses with&quot;},
+    {&quot;rother&quot;, OPT_ROTHER, '&lt;', &quot;Other certificates to include in response&quot;},
+    {&quot;rmd&quot;, OPT_RMD, 's', &quot;Digest Algorithm to use in signature of OCSP response&quot;},
+    {&quot;rsigopt&quot;, OPT_RSIGOPT, 's', &quot;OCSP response signature parameter in n:v form&quot;},
+    {&quot;header&quot;, OPT_HEADER, 's', &quot;key=value header to add&quot;},
+    {&quot;rcid&quot;, OPT_RCID, 's', &quot;Use specified algorithm for cert id in response&quot;},
+    {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest algorithm (sha1,sha256, ... )&quot;},
+
+    OPT_SECTION(&quot;Client&quot;),
+    {&quot;url&quot;, OPT_URL, 's', &quot;Responder URL&quot;},
+    {&quot;host&quot;, OPT_HOST, 's', &quot;TCP/IP hostname:port to connect to&quot;},
+    {&quot;port&quot;, OPT_PORT, 'p', &quot;Port to run responder on&quot;},
+    {&quot;out&quot;, OPT_OUTFILE, '&gt;', &quot;Output filename&quot;},
+    {&quot;noverify&quot;, OPT_NOVERIFY, '-', &quot;Don't verify response at all&quot;},
+    {&quot;nonce&quot;, OPT_NONCE, '-', &quot;Add OCSP nonce to request&quot;},
+    {&quot;no_nonce&quot;, OPT_NO_NONCE, '-', &quot;Don't add OCSP nonce to request&quot;},
     {&quot;no_signature_verify&quot;, OPT_NO_SIGNATURE_VERIFY, '-',
      &quot;Don't check signature on response&quot;},
+    {&quot;resp_key_id&quot;, OPT_RESP_KEY_ID, '-',
+     &quot;Identify response by signing certificate key ID&quot;},
     {&quot;no_cert_verify&quot;, OPT_NO_CERT_VERIFY, '-',
      &quot;Don't check signing certificate&quot;},
+    {&quot;text&quot;, OPT_TEXT, '-', &quot;Print text form of request and response&quot;},
+    {&quot;req_text&quot;, OPT_REQ_TEXT, '-', &quot;Print text form of request&quot;},
+    {&quot;resp_text&quot;, OPT_RESP_TEXT, '-', &quot;Print text form of response&quot;},
     {&quot;no_chain&quot;, OPT_NO_CHAIN, '-', &quot;Don't chain verify response&quot;},
     {&quot;no_cert_checks&quot;, OPT_NO_CERT_CHECKS, '-',
      &quot;Don't do additional checks on signing certificate&quot;},
@@ -181,53 +219,21 @@ const OPTIONS ocsp_options[] = {
      &quot;Don't verify additional certificates&quot;},
     {&quot;no_intern&quot;, OPT_NO_INTERN, '-',
      &quot;Don't search certificates contained in response for signer&quot;},
-    {&quot;badsig&quot;, OPT_BADSIG, '-',
-        &quot;Corrupt last byte of loaded OSCP response signature (for test)&quot;},
-    {&quot;text&quot;, OPT_TEXT, '-', &quot;Print text form of request and response&quot;},
-    {&quot;req_text&quot;, OPT_REQ_TEXT, '-', &quot;Print text form of request&quot;},
-    {&quot;resp_text&quot;, OPT_RESP_TEXT, '-', &quot;Print text form of response&quot;},
-    {&quot;reqin&quot;, OPT_REQIN, 's', &quot;File with the DER-encoded request&quot;},
     {&quot;respin&quot;, OPT_RESPIN, 's', &quot;File with the DER-encoded response&quot;},
-    {&quot;signer&quot;, OPT_SIGNER, '&lt;', &quot;Certificate to sign OCSP request with&quot;},
     {&quot;VAfile&quot;, OPT_VAFILE, '&lt;', &quot;Validator certificates file&quot;},
-    {&quot;sign_other&quot;, OPT_SIGN_OTHER, '&lt;',
-     &quot;Additional certificates to include in signed request&quot;},
     {&quot;verify_other&quot;, OPT_VERIFY_OTHER, '&lt;',
      &quot;Additional certificates to search for signer&quot;},
-    {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;Trusted certificates file&quot;},
-    {&quot;CApath&quot;, OPT_CAPATH, '&lt;', &quot;Trusted certificates directory&quot;},
-    {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;Trusted certificates store URI&quot;},
-    {&quot;no-CAfile&quot;, OPT_NOCAFILE, '-',
-     &quot;Do not load the default certificates file&quot;},
-    {&quot;no-CApath&quot;, OPT_NOCAPATH, '-',
-     &quot;Do not load certificates from the default certificates directory&quot;},
-    {&quot;no-CAstore&quot;, OPT_NOCAPATH, '-',
-     &quot;Do not load certificates from the default certificates store&quot;},
+    {&quot;path&quot;, OPT_PATH, 's', &quot;Path to use in OCSP request&quot;},
+    {&quot;cert&quot;, OPT_CERT, '&lt;', &quot;Certificate to check&quot;},
+    {&quot;serial&quot;, OPT_SERIAL, 's', &quot;Serial number to check&quot;},
     {&quot;validity_period&quot;, OPT_VALIDITY_PERIOD, 'u',
      &quot;Maximum validity discrepancy in seconds&quot;},
-    {&quot;status_age&quot;, OPT_STATUS_AGE, 'p', &quot;Maximum status age in seconds&quot;},
     {&quot;signkey&quot;, OPT_SIGNKEY, 's', &quot;Private key to sign OCSP request with&quot;},
     {&quot;reqout&quot;, OPT_REQOUT, 's', &quot;Output file for the DER-encoded request&quot;},
     {&quot;respout&quot;, OPT_RESPOUT, 's', &quot;Output file for the DER-encoded response&quot;},
-    {&quot;path&quot;, OPT_PATH, 's', &quot;Path to use in OCSP request&quot;},
     {&quot;issuer&quot;, OPT_ISSUER, '&lt;', &quot;Issuer certificate&quot;},
-    {&quot;cert&quot;, OPT_CERT, '&lt;', &quot;Certificate to check&quot;},
-    {&quot;serial&quot;, OPT_SERIAL, 's', &quot;Serial number to check&quot;},
-    {&quot;index&quot;, OPT_INDEX, '&lt;', &quot;Certificate status index file&quot;},
-    {&quot;CA&quot;, OPT_CA, '&lt;', &quot;CA certificate&quot;},
-    {&quot;nmin&quot;, OPT_NMIN, 'p', &quot;Number of minutes before next update&quot;},
-    {&quot;nrequest&quot;, OPT_REQUEST, 'p',
-     &quot;Number of requests to accept (default unlimited)&quot;},
-    {&quot;ndays&quot;, OPT_NDAYS, 'p', &quot;Number of days before next update&quot;},
-    {&quot;rsigner&quot;, OPT_RSIGNER, '&lt;',
-     &quot;Responder certificate to sign responses with&quot;},
-    {&quot;rkey&quot;, OPT_RKEY, '&lt;', &quot;Responder key to sign responses with&quot;},
-    {&quot;rother&quot;, OPT_ROTHER, '&lt;', &quot;Other certificates to include in response&quot;},
-    {&quot;rmd&quot;, OPT_RMD, 's', &quot;Digest Algorithm to use in signature of OCSP response&quot;},
-    {&quot;rsigopt&quot;, OPT_RSIGOPT, 's', &quot;OCSP response signature parameter in n:v form&quot;},
-    {&quot;header&quot;, OPT_HEADER, 's', &quot;key=value header to add&quot;},
-    {&quot;rcid&quot;, OPT_RCID, 's', &quot;Use specified algorithm for cert id in response&quot;},
-    {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest algorithm (sha1,sha256, ... )&quot;},
+    {&quot;status_age&quot;, OPT_STATUS_AGE, 'p', &quot;Maximum status age in seconds&quot;},
+
     OPT_V_OPTIONS,
     {NULL}
 };
diff --git a/apps/openssl.c b/apps/openssl.c
index 123c1ff4ce..9aabad5e09 100644
--- a/apps/openssl.c
+++ b/apps/openssl.c
@@ -386,6 +386,8 @@ typedef enum HELP_CHOICE {
 const OPTIONS help_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: help [options]\n&quot;},
     {OPT_HELP_STR, 1, '-', &quot;       help [command]\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_hHELP, '-', &quot;Display this summary&quot;},
     {NULL}
 };
diff --git a/apps/passwd.c b/apps/passwd.c
index 956623653f..e305bd268d 100644
--- a/apps/passwd.c
+++ b/apps/passwd.c
@@ -59,15 +59,22 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS passwd_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+
+    OPT_SECTION(&quot;Input&quot;),
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Read passwords from file&quot;},
     {&quot;noverify&quot;, OPT_NOVERIFY, '-',
      &quot;Never verify when reading password from terminal&quot;},
+    {&quot;stdin&quot;, OPT_STDIN, '-', &quot;Read passwords from stdin&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;quiet&quot;, OPT_QUIET, '-', &quot;No warnings&quot;},
     {&quot;table&quot;, OPT_TABLE, '-', &quot;Format output as table&quot;},
     {&quot;reverse&quot;, OPT_REVERSE, '-', &quot;Switch table columns&quot;},
+
+    OPT_SECTION(&quot;Cryptographic&quot;),
     {&quot;salt&quot;, OPT_SALT, 's', &quot;Use provided salt&quot;},
-    {&quot;stdin&quot;, OPT_STDIN, '-', &quot;Read passwords from stdin&quot;},
     {&quot;6&quot;, OPT_6, '-', &quot;SHA512-based password algorithm&quot;},
     {&quot;5&quot;, OPT_5, '-', &quot;SHA256-based password algorithm&quot;},
     {&quot;apr1&quot;, OPT_APR1, '-', &quot;MD5-based password algorithm, Apache variant&quot;},
@@ -76,6 +83,7 @@ const OPTIONS passwd_options[] = {
 #ifndef OPENSSL_NO_DES
     {&quot;crypt&quot;, OPT_CRYPT, '-', &quot;Standard Unix password algorithm (default)&quot;},
 #endif
+
     OPT_R_OPTIONS,
     {NULL}
 };
diff --git a/apps/pkcs12.c b/apps/pkcs12.c
index 781c3ad7ec..96e142ff81 100644
--- a/apps/pkcs12.c
+++ b/apps/pkcs12.c
@@ -62,18 +62,56 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS pkcs12_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;nokeys&quot;, OPT_NOKEYS, '-', &quot;Don't output private keys&quot;},
-    {&quot;keyex&quot;, OPT_KEYEX, '-', &quot;Set MS key exchange type&quot;},
-    {&quot;keysig&quot;, OPT_KEYSIG, '-', &quot;Set MS key signature type&quot;},
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+# endif
+
+    OPT_SECTION(&quot;CA&quot;),
+    {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;PEM-format directory of CA's&quot;},
+    {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;PEM-format file of CA's&quot;},
+    {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;URI to store of CA's&quot;},
+    {&quot;no-CAfile&quot;, OPT_NOCAFILE, '-',
+     &quot;Do not load the default certificates file&quot;},
+    {&quot;no-CApath&quot;, OPT_NOCAPATH, '-',
+     &quot;Do not load certificates from the default certificates directory&quot;},
+    {&quot;no-CAstore&quot;, OPT_NOCASTORE, '-',
+     &quot;Do not load certificates from the default certificates store&quot;},
+
+    OPT_SECTION(&quot;Input&quot;),
+    {&quot;inkey&quot;, OPT_INKEY, 's', &quot;Private key if not infile&quot;},
+    {&quot;certfile&quot;, OPT_CERTFILE, '&lt;', &quot;Load certs from file&quot;},
+    {&quot;name&quot;, OPT_NAME, 's', &quot;Use name as friendly name&quot;},
+    {&quot;CSP&quot;, OPT_CSP, 's', &quot;Microsoft CSP name&quot;},
+    {&quot;caname&quot;, OPT_CANAME, 's',
+     &quot;Use name as CA friendly name (can be repeated)&quot;},
+    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input filename&quot;},
+    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;export&quot;, OPT_EXPORT, '-', &quot;Output PKCS12 file&quot;},
+    {&quot;LMK&quot;, OPT_LMK, '-',
+     &quot;Add local machine keyset attribute to private key&quot;},
+    {&quot;macalg&quot;, OPT_MACALG, 's',
+     &quot;Digest algorithm used in MAC (default SHA1)&quot;},
+    {&quot;keypbe&quot;, OPT_KEYPBE, 's', &quot;Private key PBE algorithm (default 3DES)&quot;},
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output filename&quot;},
+    {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
+    {&quot;password&quot;, OPT_PASSWORD, 's', &quot;Set import/export password source&quot;},
     {&quot;nocerts&quot;, OPT_NOCERTS, '-', &quot;Don't output certificates&quot;},
     {&quot;clcerts&quot;, OPT_CLCERTS, '-', &quot;Only output client certificates&quot;},
     {&quot;cacerts&quot;, OPT_CACERTS, '-', &quot;Only output CA certificates&quot;},
     {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't output anything, just verify&quot;},
-    {&quot;info&quot;, OPT_INFO, '-', &quot;Print info about PKCS#12 structure&quot;},
     {&quot;chain&quot;, OPT_CHAIN, '-', &quot;Add certificate chain&quot;},
     {&quot;twopass&quot;, OPT_TWOPASS, '-', &quot;Separate MAC, encryption passwords&quot;},
     {&quot;nomacver&quot;, OPT_NOMACVER, '-', &quot;Don't verify MAC&quot;},
+    {&quot;info&quot;, OPT_INFO, '-', &quot;Print info about PKCS#12 structure&quot;},
+    {&quot;nokeys&quot;, OPT_NOKEYS, '-', &quot;Don't output private keys&quot;},
+    {&quot;keyex&quot;, OPT_KEYEX, '-', &quot;Set MS key exchange type&quot;},
+    {&quot;keysig&quot;, OPT_KEYSIG, '-', &quot;Set MS key signature type&quot;},
+
+    OPT_SECTION(&quot;Encryption&quot;),
 # ifndef OPENSSL_NO_RC2
     {&quot;descert&quot;, OPT_DESCERT, '-',
      &quot;Encrypt output with 3DES (default RC2-40)&quot;},
@@ -83,42 +121,14 @@ const OPTIONS pkcs12_options[] = {
     {&quot;descert&quot;, OPT_DESCERT, '-', &quot;Encrypt output with 3DES (the default)&quot;},
     {&quot;certpbe&quot;, OPT_CERTPBE, 's', &quot;Certificate PBE algorithm (default 3DES)&quot;},
 # endif
-    {&quot;export&quot;, OPT_EXPORT, '-', &quot;Output PKCS12 file&quot;},
     {&quot;noiter&quot;, OPT_NOITER, '-', &quot;Don't use encryption iteration&quot;},
     {&quot;maciter&quot;, OPT_MACITER, '-', &quot;Use MAC iteration&quot;},
     {&quot;nomaciter&quot;, OPT_NOMACITER, '-', &quot;Don't use MAC iteration&quot;},
     {&quot;nomac&quot;, OPT_NOMAC, '-', &quot;Don't generate MAC&quot;},
-    {&quot;LMK&quot;, OPT_LMK, '-',
-     &quot;Add local machine keyset attribute to private key&quot;},
     {&quot;nodes&quot;, OPT_NODES, '-', &quot;Don't encrypt private keys&quot;},
-    {&quot;macalg&quot;, OPT_MACALG, 's',
-     &quot;Digest algorithm used in MAC (default SHA1)&quot;},
-    {&quot;keypbe&quot;, OPT_KEYPBE, 's', &quot;Private key PBE algorithm (default 3DES)&quot;},
-    OPT_R_OPTIONS,
-    {&quot;inkey&quot;, OPT_INKEY, 's', &quot;Private key if not infile&quot;},
-    {&quot;certfile&quot;, OPT_CERTFILE, '&lt;', &quot;Load certs from file&quot;},
-    {&quot;name&quot;, OPT_NAME, 's', &quot;Use name as friendly name&quot;},
-    {&quot;CSP&quot;, OPT_CSP, 's', &quot;Microsoft CSP name&quot;},
-    {&quot;caname&quot;, OPT_CANAME, 's',
-     &quot;Use name as CA friendly name (can be repeated)&quot;},
-    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input filename&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output filename&quot;},
-    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
-    {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
-    {&quot;password&quot;, OPT_PASSWORD, 's', &quot;Set import/export password source&quot;},
-    {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;PEM-format directory of CA's&quot;},
-    {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;PEM-format file of CA's&quot;},
-    {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;URI to store if CA's&quot;},
-    {&quot;no-CAfile&quot;, OPT_NOCAFILE, '-',
-     &quot;Do not load the default certificates file&quot;},
-    {&quot;no-CApath&quot;, OPT_NOCAPATH, '-',
-     &quot;Do not load certificates from the default certificates directory&quot;},
-    {&quot;no-CAstore&quot;, OPT_NOCASTORE, '-',
-     &quot;Do not load certificates from the default certificates store&quot;},
     {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-# endif
+
+    OPT_R_OPTIONS,
     {NULL}
 };
 
diff --git a/apps/pkcs7.c b/apps/pkcs7.c
index a385f90980..bd1cb1013c 100644
--- a/apps/pkcs7.c
+++ b/apps/pkcs7.c
@@ -27,9 +27,17 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS pkcs7_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format - DER or PEM&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#endif
+
+    OPT_SECTION(&quot;Input&quot;),
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
+    {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format - DER or PEM&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format - DER or PEM&quot;},
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
     {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't output encoded data&quot;},
@@ -37,9 +45,6 @@ const OPTIONS pkcs7_options[] = {
     {&quot;print&quot;, OPT_PRINT, '-', &quot;Print out all fields of the PKCS7 structure&quot;},
     {&quot;print_certs&quot;, OPT_PRINT_CERTS, '-',
      &quot;Print_certs  print any certs or crl in the input&quot;},
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-#endif
     {NULL}
 };
 
diff --git a/apps/pkcs8.c b/apps/pkcs8.c
index 26ab0eefe6..1ccaff06f8 100644
--- a/apps/pkcs8.c
+++ b/apps/pkcs8.c
@@ -30,31 +30,39 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS pkcs8_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format (DER or PEM)&quot;},
-    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format (DER or PEM)&quot;},
-    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
-    {&quot;topk8&quot;, OPT_TOPK8, '-', &quot;Output PKCS8 file&quot;},
-    {&quot;noiter&quot;, OPT_NOITER, '-', &quot;Use 1 as iteration count&quot;},
-    {&quot;nocrypt&quot;, OPT_NOCRYPT, '-', &quot;Use or expect unencrypted private key&quot;},
-    OPT_R_OPTIONS,
-    {&quot;v2&quot;, OPT_V2, 's', &quot;Use PKCS#5 v2.0 and cipher&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#endif
     {&quot;v1&quot;, OPT_V1, 's', &quot;Use PKCS#5 v1.5 and cipher&quot;},
+    {&quot;v2&quot;, OPT_V2, 's', &quot;Use PKCS#5 v2.0 and cipher&quot;},
     {&quot;v2prf&quot;, OPT_V2PRF, 's', &quot;Set the PRF algorithm to use with PKCS#5 v2.0&quot;},
-    {&quot;iter&quot;, OPT_ITER, 'p', &quot;Specify the iteration count&quot;},
+
+    OPT_SECTION(&quot;Input&quot;),
+    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
+    {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format (DER or PEM)&quot;},
     {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
+    {&quot;nocrypt&quot;, OPT_NOCRYPT, '-', &quot;Use or expect unencrypted private key&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format (DER or PEM)&quot;},
+    {&quot;topk8&quot;, OPT_TOPK8, '-', &quot;Output PKCS8 file&quot;},
     {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
     {&quot;traditional&quot;, OPT_TRADITIONAL, '-', &quot;use traditional format private key&quot;},
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-#endif
+    {&quot;iter&quot;, OPT_ITER, 'p', &quot;Specify the iteration count&quot;},
+    {&quot;noiter&quot;, OPT_NOITER, '-', &quot;Use 1 as iteration count&quot;},
+
 #ifndef OPENSSL_NO_SCRYPT
+    OPT_SECTION(&quot;Scrypt&quot;),
     {&quot;scrypt&quot;, OPT_SCRYPT, '-', &quot;Use scrypt algorithm&quot;},
     {&quot;scrypt_N&quot;, OPT_SCRYPT_N, 's', &quot;Set scrypt N parameter&quot;},
     {&quot;scrypt_r&quot;, OPT_SCRYPT_R, 's', &quot;Set scrypt r parameter&quot;},
     {&quot;scrypt_p&quot;, OPT_SCRYPT_P, 's', &quot;Set scrypt p parameter&quot;},
 #endif
+
+    OPT_R_OPTIONS,
     {NULL}
 };
 
diff --git a/apps/pkey.c b/apps/pkey.c
index 0806b4e045..6100f8dcd3 100644
--- a/apps/pkey.c
+++ b/apps/pkey.c
@@ -23,27 +23,33 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS pkey_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#endif
+    {&quot;check&quot;, OPT_CHECK, '-', &quot;Check key consistency&quot;},
+    {&quot;pubcheck&quot;, OPT_PUB_CHECK, '-', &quot;Check public key consistency&quot;},
+    {&quot;&quot;, OPT_MD, '-', &quot;Any supported cipher&quot;},
+
+    OPT_SECTION(&quot;Input&quot;),
+    {&quot;in&quot;, OPT_IN, 's', &quot;Input key&quot;},
     {&quot;inform&quot;, OPT_INFORM, 'f', &quot;Input format (DER or PEM)&quot;},
-    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format (DER or PEM)&quot;},
     {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
-    {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
-    {&quot;in&quot;, OPT_IN, 's', &quot;Input key&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
     {&quot;pubin&quot;, OPT_PUBIN, '-',
      &quot;Read public key from input (default is private key)&quot;},
+    {&quot;traditional&quot;, OPT_TRADITIONAL, '-',
+     &quot;Use traditional format for private keys&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format (DER or PEM)&quot;},
+    {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
     {&quot;pubout&quot;, OPT_PUBOUT, '-', &quot;Output public key, not private&quot;},
     {&quot;text_pub&quot;, OPT_TEXT_PUB, '-', &quot;Only output public key components&quot;},
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Output in plaintext as well&quot;},
     {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't output the key&quot;},
-    {&quot;&quot;, OPT_MD, '-', &quot;Any supported cipher&quot;},
-    {&quot;traditional&quot;, OPT_TRADITIONAL, '-',
-     &quot;Use traditional format for private keys&quot;},
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-#endif
-    {&quot;check&quot;, OPT_CHECK, '-', &quot;Check key consistency&quot;},
-    {&quot;pubcheck&quot;, OPT_PUB_CHECK, '-', &quot;Check public key consistency&quot;},
+
     {NULL}
 };
 
diff --git a/apps/pkeyparam.c b/apps/pkeyparam.c
index 1b037aea8b..552ba56d99 100644
--- a/apps/pkeyparam.c
+++ b/apps/pkeyparam.c
@@ -22,15 +22,20 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS pkeyparam_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
-    {&quot;text&quot;, OPT_TEXT, '-', &quot;Print parameters as text&quot;},
-    {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't output encoded parameters&quot;},
 #ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
 #endif
     {&quot;check&quot;, OPT_CHECK, '-', &quot;Check key param consistency&quot;},
+
+    OPT_SECTION(&quot;Input&quot;),
+    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;text&quot;, OPT_TEXT, '-', &quot;Print parameters as text&quot;},
+    {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't output encoded parameters&quot;},
     {NULL}
 };
 
diff --git a/apps/pkeyutl.c b/apps/pkeyutl.c
index 6b012211e4..a8cd2a0e3e 100644
--- a/apps/pkeyutl.c
+++ b/apps/pkeyutl.c
@@ -49,41 +49,49 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS pkeyutl_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file - default stdin&quot;},
-    {&quot;rawin&quot;, OPT_RAWIN, '-', &quot;Indicate the input data is in raw form&quot;},
-    {&quot;digest&quot;, OPT_DIGEST, 's',
-     &quot;Specify the digest algorithm when signing the raw input data&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file - default stdout&quot;},
-    {&quot;pubin&quot;, OPT_PUBIN, '-', &quot;Input is a public key&quot;},
-    {&quot;certin&quot;, OPT_CERTIN, '-', &quot;Input is a cert with a public key&quot;},
-    {&quot;asn1parse&quot;, OPT_ASN1PARSE, '-', &quot;asn1parse the output data&quot;},
-    {&quot;hexdump&quot;, OPT_HEXDUMP, '-', &quot;Hex dump output&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+    {&quot;engine_impl&quot;, OPT_ENGINE_IMPL, '-',
+     &quot;Also use engine given by -engine for crypto operations&quot;},
+#endif
     {&quot;sign&quot;, OPT_SIGN, '-', &quot;Sign input data with private key&quot;},
     {&quot;verify&quot;, OPT_VERIFY, '-', &quot;Verify with public key&quot;},
-    {&quot;verifyrecover&quot;, OPT_VERIFYRECOVER, '-',
-     &quot;Verify with public key, recover original data&quot;},
-    {&quot;rev&quot;, OPT_REV, '-', &quot;Reverse the order of the input buffer&quot;},
     {&quot;encrypt&quot;, OPT_ENCRYPT, '-', &quot;Encrypt input data with public key&quot;},
     {&quot;decrypt&quot;, OPT_DECRYPT, '-', &quot;Decrypt input data with private key&quot;},
     {&quot;derive&quot;, OPT_DERIVE, '-', &quot;Derive shared secret&quot;},
-    {&quot;kdf&quot;, OPT_KDF, 's', &quot;Use KDF algorithm&quot;},
-    {&quot;kdflen&quot;, OPT_KDFLEN, 'p', &quot;KDF algorithm output length&quot;},
-    {&quot;sigfile&quot;, OPT_SIGFILE, '&lt;', &quot;Signature file (verify operation only)&quot;},
+
+    OPT_SECTION(&quot;Input&quot;),
+    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file - default stdin&quot;},
+    {&quot;rawin&quot;, OPT_RAWIN, '-', &quot;Indicate the input data is in raw form&quot;},
+    {&quot;pubin&quot;, OPT_PUBIN, '-', &quot;Input is a public key&quot;},
     {&quot;inkey&quot;, OPT_INKEY, 's', &quot;Input private key file&quot;},
-    {&quot;peerkey&quot;, OPT_PEERKEY, 's', &quot;Peer key file used in key derivation&quot;},
     {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
+    {&quot;peerkey&quot;, OPT_PEERKEY, 's', &quot;Peer key file used in key derivation&quot;},
     {&quot;peerform&quot;, OPT_PEERFORM, 'E', &quot;Peer key format - default PEM&quot;},
+    {&quot;certin&quot;, OPT_CERTIN, '-', &quot;Input is a cert with a public key&quot;},
+    {&quot;rev&quot;, OPT_REV, '-', &quot;Reverse the order of the input buffer&quot;},
+    {&quot;sigfile&quot;, OPT_SIGFILE, '&lt;', &quot;Signature file (verify operation only)&quot;},
     {&quot;keyform&quot;, OPT_KEYFORM, 'E', &quot;Private key format - default PEM&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file - default stdout&quot;},
+    {&quot;asn1parse&quot;, OPT_ASN1PARSE, '-', &quot;asn1parse the output data&quot;},
+    {&quot;hexdump&quot;, OPT_HEXDUMP, '-', &quot;Hex dump output&quot;},
+    {&quot;verifyrecover&quot;, OPT_VERIFYRECOVER, '-',
+     &quot;Verify with public key, recover original data&quot;},
+
+    OPT_SECTION(&quot;Signing/Derivation&quot;),
+    {&quot;digest&quot;, OPT_DIGEST, 's',
+     &quot;Specify the digest algorithm when signing the raw input data&quot;},
     {&quot;pkeyopt&quot;, OPT_PKEYOPT, 's', &quot;Public key options as opt:value&quot;},
     {&quot;pkeyopt_passin&quot;, OPT_PKEYOPT_PASSIN, 's',
      &quot;Public key option that is read as a passphrase argument opt:passphrase&quot;},
+    {&quot;kdf&quot;, OPT_KDF, 's', &quot;Use KDF algorithm&quot;},
+    {&quot;kdflen&quot;, OPT_KDFLEN, 'p', &quot;KDF algorithm output length&quot;},
+
     OPT_R_OPTIONS,
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-    {&quot;engine_impl&quot;, OPT_ENGINE_IMPL, '-',
-     &quot;Also use engine given by -engine for crypto operations&quot;},
-#endif
     {NULL}
 };
 
diff --git a/apps/prime.c b/apps/prime.c
index 55cdad81a0..5df9ee0363 100644
--- a/apps/prime.c
+++ b/apps/prime.c
@@ -22,13 +22,17 @@ const OPTIONS prime_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] [number...]\n&quot;},
     {OPT_HELP_STR, 1, '-',
         &quot;  number Number to check for primality\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+    {&quot;bits&quot;, OPT_BITS, 'p', &quot;Size of number in bits&quot;},
+    {&quot;checks&quot;, OPT_CHECKS, 'p', &quot;Number of checks&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;hex&quot;, OPT_HEX, '-', &quot;Hex output&quot;},
     {&quot;generate&quot;, OPT_GENERATE, '-', &quot;Generate a prime&quot;},
-    {&quot;bits&quot;, OPT_BITS, 'p', &quot;Size of number in bits&quot;},
     {&quot;safe&quot;, OPT_SAFE, '-',
      &quot;When used with -generate, generate a safe prime&quot;},
-    {&quot;checks&quot;, OPT_CHECKS, 'p', &quot;Number of checks&quot;},
     {NULL}
 };
 
diff --git a/apps/provider.c b/apps/provider.c
index 325a7424cd..47bc056b63 100644
--- a/apps/provider.c
+++ b/apps/provider.c
@@ -28,7 +28,11 @@ typedef enum OPTION_choice {
 const OPTIONS provider_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] provider...\n&quot;},
     {OPT_HELP_STR, 1, '-', &quot;  provider... Providers to load\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;v&quot;, OPT_V, '-', &quot;List the algorithm names of specified provider&quot;},
     {&quot;vv&quot;, OPT_VV, '-', &quot;List the algorithm names of specified providers,&quot;},
     {OPT_MORE_STR, 0, '-', &quot;categorised by operation type&quot;},
diff --git a/apps/rand.c b/apps/rand.c
index b35b84ae27..8b23a03f6e 100644
--- a/apps/rand.c
+++ b/apps/rand.c
@@ -26,15 +26,19 @@ typedef enum OPTION_choice {
 
 const OPTIONS rand_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [flags] num\n&quot;},
-    {OPT_HELP_STR, 1, '-', &quot;Valid options are:\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
-    OPT_R_OPTIONS,
-    {&quot;base64&quot;, OPT_BASE64, '-', &quot;Base64 encode output&quot;},
-    {&quot;hex&quot;, OPT_HEX, '-', &quot;Hex encode output&quot;},
 #ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
 #endif
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;base64&quot;, OPT_BASE64, '-', &quot;Base64 encode output&quot;},
+    {&quot;hex&quot;, OPT_HEX, '-', &quot;Hex encode output&quot;},
+
+    OPT_R_OPTIONS,
     {NULL}
 };
 
diff --git a/apps/rehash.c b/apps/rehash.c
index a1fc37902e..ec1cf07506 100644
--- a/apps/rehash.c
+++ b/apps/rehash.c
@@ -452,12 +452,15 @@ typedef enum OPTION_choice {
 
 const OPTIONS rehash_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] [cert-directory...]\n&quot;},
-    {OPT_HELP_STR, 1, '-', &quot;Valid options are:\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
     {&quot;h&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
     {&quot;compat&quot;, OPT_COMPAT, '-', &quot;Create both new- and old-style hash links&quot;},
     {&quot;old&quot;, OPT_OLD, '-', &quot;Use old-style hash to generate links&quot;},
     {&quot;n&quot;, OPT_N, '-', &quot;Do not remove existing links&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;v&quot;, OPT_VERBOSE, '-', &quot;Verbose output&quot;},
     {NULL}
 };
diff --git a/apps/req.c b/apps/req.c
index 70b4f0d657..3667ac7bce 100644
--- a/apps/req.c
+++ b/apps/req.c
@@ -95,37 +95,26 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS req_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format - DER or PEM&quot;},
-    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format - DER or PEM&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+    {&quot;keygen_engine&quot;, OPT_KEYGEN_ENGINE, 's',
+     &quot;Specify engine to be used for key generation operations&quot;},
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
-    {&quot;key&quot;, OPT_KEY, 's', &quot;Private key to use&quot;},
-    {&quot;keyform&quot;, OPT_KEYFORM, 'f', &quot;Key file format&quot;},
-    {&quot;pubkey&quot;, OPT_PUBKEY, '-', &quot;Output public key&quot;},
+    {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format - DER or PEM&quot;},
+    {&quot;verify&quot;, OPT_VERIFY, '-', &quot;Verify signature on REQ&quot;},
+#endif
+
+    OPT_SECTION(&quot;Certificate&quot;),
     {&quot;new&quot;, OPT_NEW, '-', &quot;New request&quot;},
     {&quot;config&quot;, OPT_CONFIG, '&lt;', &quot;Request template file&quot;},
-    {&quot;keyout&quot;, OPT_KEYOUT, '&gt;', &quot;File to send the key to&quot;},
-    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Private key password source&quot;},
-    {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
-    OPT_R_OPTIONS,
-    {&quot;newkey&quot;, OPT_NEWKEY, 's', &quot;Specify as type:bits&quot;},
-    {&quot;pkeyopt&quot;, OPT_PKEYOPT, 's', &quot;Public key options as opt:value&quot;},
-    {&quot;sigopt&quot;, OPT_SIGOPT, 's', &quot;Signature parameter in n:v form&quot;},
-    {&quot;batch&quot;, OPT_BATCH, '-',
-     &quot;Do not ask anything during request generation&quot;},
-    {&quot;newhdr&quot;, OPT_NEWHDR, '-', &quot;Output \&quot;NEW\&quot; in the header lines&quot;},
-    {&quot;modulus&quot;, OPT_MODULUS, '-', &quot;RSA modulus&quot;},
-    {&quot;verify&quot;, OPT_VERIFY, '-', &quot;Verify signature on REQ&quot;},
-    {&quot;nodes&quot;, OPT_NODES, '-', &quot;Don't encrypt the output key&quot;},
-    {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Do not output REQ&quot;},
-    {&quot;verbose&quot;, OPT_VERBOSE, '-', &quot;Verbose output&quot;},
     {&quot;utf8&quot;, OPT_UTF8, '-', &quot;Input characters are UTF8 (default ASCII)&quot;},
     {&quot;nameopt&quot;, OPT_NAMEOPT, 's', &quot;Various certificate name options&quot;},
     {&quot;reqopt&quot;, OPT_REQOPT, 's', &quot;Various request text options&quot;},
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Text form of request&quot;},
     {&quot;x509&quot;, OPT_X509, '-',
-     &quot;Output a x509 structure instead of a cert request&quot;},
+     &quot;Output an x509 structure instead of a cert request&quot;},
     {OPT_MORE_STR, 1, 1, &quot;(Required by some CA's)&quot;},
     {&quot;subj&quot;, OPT_SUBJ, 's', &quot;Set or modify request subject&quot;},
     {&quot;subject&quot;, OPT_SUBJECT, '-', &quot;Output the request's subject&quot;},
@@ -140,18 +129,37 @@ const OPTIONS req_options[] = {
     {&quot;reqexts&quot;, OPT_REQEXTS, 's',
      &quot;Request extension section (override value in config file)&quot;},
     {&quot;precert&quot;, OPT_PRECERT, '-', &quot;Add a poison extension (implies -new)&quot;},
+
+    OPT_SECTION(&quot;Keys and Signing&quot;),
+    {&quot;key&quot;, OPT_KEY, 's', &quot;Private key to use&quot;},
+    {&quot;keyform&quot;, OPT_KEYFORM, 'f', &quot;Key file format&quot;},
+    {&quot;pubkey&quot;, OPT_PUBKEY, '-', &quot;Output public key&quot;},
+    {&quot;keyout&quot;, OPT_KEYOUT, '&gt;', &quot;File to send the key to&quot;},
+    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Private key password source&quot;},
+    {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
+    {&quot;newkey&quot;, OPT_NEWKEY, 's', &quot;Specify as type:bits&quot;},
+    {&quot;pkeyopt&quot;, OPT_PKEYOPT, 's', &quot;Public key options as opt:value&quot;},
+    {&quot;sigopt&quot;, OPT_SIGOPT, 's', &quot;Signature parameter in n:v form&quot;},
     {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest&quot;},
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-    {&quot;keygen_engine&quot;, OPT_KEYGEN_ENGINE, 's',
-     &quot;Specify engine to be used for key generation operations&quot;},
-#endif
 #ifndef OPENSSL_NO_SM2
     {&quot;sm2-id&quot;, OPT_SM2ID, 's',
      &quot;Specify an ID string to verify an SM2 certificate request&quot;},
     {&quot;sm2-hex-id&quot;, OPT_SM2HEXID, 's',
      &quot;Specify a hex ID string to verify an SM2 certificate request&quot;},
 #endif
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;outform&quot;, OPT_OUTFORM, 'F', &quot;Output format - DER or PEM&quot;},
+    {&quot;batch&quot;, OPT_BATCH, '-',
+     &quot;Do not ask anything during request generation&quot;},
+    {&quot;verbose&quot;, OPT_VERBOSE, '-', &quot;Verbose output&quot;},
+    {&quot;nodes&quot;, OPT_NODES, '-', &quot;Don't encrypt the output key&quot;},
+    {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Do not output REQ&quot;},
+    {&quot;newhdr&quot;, OPT_NEWHDR, '-', &quot;Output \&quot;NEW\&quot; in the header lines&quot;},
+    {&quot;modulus&quot;, OPT_MODULUS, '-', &quot;RSA modulus&quot;},
+
+    OPT_R_OPTIONS,
     {NULL}
 };
 
diff --git a/apps/rsa.c b/apps/rsa.c
index 7c0620c6f2..82b34e7ca3 100644
--- a/apps/rsa.c
+++ b/apps/rsa.c
@@ -37,29 +37,36 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS rsa_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;inform&quot;, OPT_INFORM, 'f', &quot;Input format, one of DER PEM&quot;},
-    {&quot;outform&quot;, OPT_OUTFORM, 'f', &quot;Output format, one of DER PEM PVK&quot;},
+    {&quot;check&quot;, OPT_CHECK, '-', &quot;Verify key consistency&quot;},
+    {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+# endif
+
+    OPT_SECTION(&quot;Input&quot;),
     {&quot;in&quot;, OPT_IN, 's', &quot;Input file&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;inform&quot;, OPT_INFORM, 'f', &quot;Input format, one of DER PEM&quot;},
     {&quot;pubin&quot;, OPT_PUBIN, '-', &quot;Expect a public key in input file&quot;},
-    {&quot;pubout&quot;, OPT_PUBOUT, '-', &quot;Output a public key&quot;},
-    {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
-    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
     {&quot;RSAPublicKey_in&quot;, OPT_RSAPUBKEY_IN, '-', &quot;Input is an RSAPublicKey&quot;},
+    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;outform&quot;, OPT_OUTFORM, 'f', &quot;Output format, one of DER PEM PVK&quot;},
+    {&quot;pubout&quot;, OPT_PUBOUT, '-', &quot;Output a public key&quot;},
     {&quot;RSAPublicKey_out&quot;, OPT_RSAPUBKEY_OUT, '-', &quot;Output is an RSAPublicKey&quot;},
+    {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
     {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't print key out&quot;},
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Print the key in text&quot;},
     {&quot;modulus&quot;, OPT_MODULUS, '-', &quot;Print the RSA key modulus&quot;},
-    {&quot;check&quot;, OPT_CHECK, '-', &quot;Verify key consistency&quot;},
-    {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
+
 # if !defined(OPENSSL_NO_DSA) &amp;&amp; !defined(OPENSSL_NO_RC4)
+    OPT_SECTION(&quot;PVK&quot;),
     {&quot;pvk-strong&quot;, OPT_PVK_STRONG, '-', &quot;Enable 'Strong' PVK encoding level (default)&quot;},
     {&quot;pvk-weak&quot;, OPT_PVK_WEAK, '-', &quot;Enable 'Weak' PVK encoding level&quot;},
     {&quot;pvk-none&quot;, OPT_PVK_NONE, '-', &quot;Don't enforce PVK encoding&quot;},
-# endif
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
 # endif
     {NULL}
 };
diff --git a/apps/rsautl.c b/apps/rsautl.c
index 6939e42a4d..99f1c44007 100644
--- a/apps/rsautl.c
+++ b/apps/rsautl.c
@@ -38,31 +38,37 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS rsautl_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+    {&quot;sign&quot;, OPT_SIGN, '-', &quot;Sign with private key&quot;},
+    {&quot;verify&quot;, OPT_VERIFY, '-', &quot;Verify with public key&quot;},
+    {&quot;encrypt&quot;, OPT_ENCRYPT, '-', &quot;Encrypt with public key&quot;},
+    {&quot;decrypt&quot;, OPT_DECRYPT, '-', &quot;Decrypt with private key&quot;},
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+# endif
+
+    OPT_SECTION(&quot;Input&quot;),
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
     {&quot;inkey&quot;, OPT_INKEY, 's', &quot;Input key&quot;},
     {&quot;keyform&quot;, OPT_KEYFORM, 'E', &quot;Private key format - default PEM&quot;},
     {&quot;pubin&quot;, OPT_PUBIN, '-', &quot;Input is an RSA public&quot;},
     {&quot;certin&quot;, OPT_CERTIN, '-', &quot;Input is a cert carrying an RSA public key&quot;},
+    {&quot;rev&quot;, OPT_REV, '-', &quot;Reverse the order of the input buffer&quot;},
+    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
     {&quot;ssl&quot;, OPT_SSL, '-', &quot;Use SSL v2 padding&quot;},
     {&quot;raw&quot;, OPT_RSA_RAW, '-', &quot;Use no padding&quot;},
     {&quot;pkcs&quot;, OPT_PKCS, '-', &quot;Use PKCS#1 v1.5 padding (default)&quot;},
+    {&quot;x931&quot;, OPT_X931, '-', &quot;Use ANSI X9.31 padding&quot;},
     {&quot;oaep&quot;, OPT_OAEP, '-', &quot;Use PKCS#1 OAEP&quot;},
-    {&quot;sign&quot;, OPT_SIGN, '-', &quot;Sign with private key&quot;},
-    {&quot;verify&quot;, OPT_VERIFY, '-', &quot;Verify with public key&quot;},
     {&quot;asn1parse&quot;, OPT_ASN1PARSE, '-',
      &quot;Run output through asn1parse; useful with -verify&quot;},
     {&quot;hexdump&quot;, OPT_HEXDUMP, '-', &quot;Hex dump output&quot;},
-    {&quot;x931&quot;, OPT_X931, '-', &quot;Use ANSI X9.31 padding&quot;},
-    {&quot;rev&quot;, OPT_REV, '-', &quot;Reverse the order of the input buffer&quot;},
-    {&quot;encrypt&quot;, OPT_ENCRYPT, '-', &quot;Encrypt with public key&quot;},
-    {&quot;decrypt&quot;, OPT_DECRYPT, '-', &quot;Decrypt with private key&quot;},
-    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
+
     OPT_R_OPTIONS,
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-# endif
     {NULL}
 };
 
diff --git a/apps/s_client.c b/apps/s_client.c
index fa5cb95f68..ee1951834b 100644
--- a/apps/s_client.c
+++ b/apps/s_client.c
@@ -605,7 +605,21 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS s_client_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+    {&quot;ssl_client_engine&quot;, OPT_SSL_CLIENT_ENGINE, 's',
+     &quot;Specify engine to be used for client certificate operations&quot;},
+#endif
+    {&quot;ssl_config&quot;, OPT_SSL_CONFIG, 's', &quot;Use specified configuration file&quot;},
+#ifndef OPENSSL_NO_CT
+    {&quot;ct&quot;, OPT_CT, '-', &quot;Request and parse SCTs (also enables OCSP stapling)&quot;},
+    {&quot;noct&quot;, OPT_NOCT, '-', &quot;Do not request or parse SCTs (default)&quot;},
+    {&quot;ctlogfile&quot;, OPT_CTLOG_FILE, '&lt;', &quot;CT log list CONF file&quot;},
+#endif
+
+    OPT_SECTION(&quot;Network&quot;),
     {&quot;host&quot;, OPT_HOST, 's', &quot;Use -connect instead&quot;},
     {&quot;port&quot;, OPT_PORT, 'p', &quot;Use -connect instead&quot;},
     {&quot;connect&quot;, OPT_CONNECT, 's',
@@ -622,6 +636,18 @@ const OPTIONS s_client_options[] = {
 #ifdef AF_INET6
     {&quot;6&quot;, OPT_6, '-', &quot;Use IPv6 only&quot;},
 #endif
+    {&quot;maxfraglen&quot;, OPT_MAXFRAGLEN, 'p',
+     &quot;Enable Maximum Fragment Length Negotiation (len values: 512, 1024, 2048 and 4096)&quot;},
+    {&quot;max_send_frag&quot;, OPT_MAX_SEND_FRAG, 'p', &quot;Maximum Size of send frames &quot;},
+    {&quot;split_send_frag&quot;, OPT_SPLIT_SEND_FRAG, 'p',
+     &quot;Size used to split data for encrypt pipelines&quot;},
+    {&quot;max_pipelines&quot;, OPT_MAX_PIPELINES, 'p',
+     &quot;Maximum number of encrypt/decrypt pipelines to be used&quot;},
+    {&quot;read_buf&quot;, OPT_READ_BUF, 'p',
+     &quot;Default read buffer size to be used for connections&quot;},
+    {&quot;fallback_scsv&quot;, OPT_FALLBACKSCSV, '-', &quot;Send the fallback SCSV&quot;},
+
+    OPT_SECTION(&quot;Identity&quot;),
     {&quot;verify&quot;, OPT_VERIFY, 'p', &quot;Turn on peer certificate verification&quot;},
     {&quot;cert&quot;, OPT_CERT, '&lt;', &quot;Certificate file to use, PEM format assumed&quot;},
     {&quot;certform&quot;, OPT_CERTFORM, 'F',
@@ -646,16 +672,19 @@ const OPTIONS s_client_options[] = {
      &quot;DANE TLSA rrdata presentation form&quot;},
     {&quot;dane_ee_no_namechecks&quot;, OPT_DANE_EE_NO_NAME, '-',
      &quot;Disable name checks when matching DANE-EE(3) TLSA records&quot;},
+    {&quot;psk_identity&quot;, OPT_PSK_IDENTITY, 's', &quot;PSK identity&quot;},
+    {&quot;psk&quot;, OPT_PSK, 's', &quot;PSK in hex (without 0x)&quot;},
+    {&quot;psk_session&quot;, OPT_PSK_SESS, '&lt;', &quot;File to read PSK SSL session from&quot;},
+    {&quot;name&quot;, OPT_PROTOHOST, 's',
+     &quot;Hostname to use for \&quot;-starttls lmtp\&quot;, \&quot;-starttls smtp\&quot; or \&quot;-starttls xmpp[-server]\&quot;&quot;},
+
+    OPT_SECTION(&quot;Session&quot;),
     {&quot;reconnect&quot;, OPT_RECONNECT, '-',
      &quot;Drop and re-make the connection with the same Session-ID&quot;},
-    {&quot;showcerts&quot;, OPT_SHOWCERTS, '-',
-     &quot;Show all certificates sent by the server&quot;},
-    {&quot;debug&quot;, OPT_DEBUG, '-', &quot;Extra output&quot;},
-    {&quot;msg&quot;, OPT_MSG, '-', &quot;Show protocol messages&quot;},
-    {&quot;msgfile&quot;, OPT_MSGFILE, '&gt;',
-     &quot;File to send output of -msg or -trace, instead of stdout&quot;},
-    {&quot;nbio_test&quot;, OPT_NBIO_TEST, '-', &quot;More ssl protocol testing&quot;},
-    {&quot;state&quot;, OPT_STATE, '-', &quot;Print the ssl states&quot;},
+    {&quot;sess_out&quot;, OPT_SESS_OUT, '&gt;', &quot;File to write SSL session to&quot;},
+    {&quot;sess_in&quot;, OPT_SESS_IN, '&lt;', &quot;File to read SSL session from&quot;},
+
+    OPT_SECTION(&quot;Input/Output&quot;),
     {&quot;crlf&quot;, OPT_CRLF, '-', &quot;Convert LF from terminal into CRLF&quot;},
     {&quot;quiet&quot;, OPT_QUIET, '-', &quot;No s_client output&quot;},
     {&quot;ign_eof&quot;, OPT_IGN_EOF, '-', &quot;Ignore input eof (default when -quiet)&quot;},
@@ -664,51 +693,35 @@ const OPTIONS s_client_options[] = {
      &quot;Use the appropriate STARTTLS command before starting TLS&quot;},
     {&quot;xmpphost&quot;, OPT_XMPPHOST, 's',
      &quot;Alias of -name option for \&quot;-starttls xmpp[-server]\&quot;&quot;},
-    OPT_R_OPTIONS,
-    {&quot;sess_out&quot;, OPT_SESS_OUT, '&gt;', &quot;File to write SSL session to&quot;},
-    {&quot;sess_in&quot;, OPT_SESS_IN, '&lt;', &quot;File to read SSL session from&quot;},
-#ifndef OPENSSL_NO_SRTP
-    {&quot;use_srtp&quot;, OPT_USE_SRTP, 's',
-     &quot;Offer SRTP key management with a colon-separated profile list&quot;},
-#endif
-    {&quot;keymatexport&quot;, OPT_KEYMATEXPORT, 's',
-     &quot;Export keying material using label&quot;},
-    {&quot;keymatexportlen&quot;, OPT_KEYMATEXPORTLEN, 'p',
-     &quot;Export len bytes of keying material (default 20)&quot;},
-    {&quot;maxfraglen&quot;, OPT_MAXFRAGLEN, 'p',
-     &quot;Enable Maximum Fragment Length Negotiation (len values: 512, 1024, 2048 and 4096)&quot;},
-    {&quot;fallback_scsv&quot;, OPT_FALLBACKSCSV, '-', &quot;Send the fallback SCSV&quot;},
-    {&quot;name&quot;, OPT_PROTOHOST, 's',
-     &quot;Hostname to use for \&quot;-starttls lmtp\&quot;, \&quot;-starttls smtp\&quot; or \&quot;-starttls xmpp[-server]\&quot;&quot;},
-    {&quot;CRL&quot;, OPT_CRL, '&lt;', &quot;CRL file to use&quot;},
-    {&quot;crl_download&quot;, OPT_CRL_DOWNLOAD, '-', &quot;Download CRL from distribution points&quot;},
-    {&quot;CRLform&quot;, OPT_CRLFORM, 'F', &quot;CRL format (PEM or DER) PEM is default&quot;},
-    {&quot;verify_return_error&quot;, OPT_VERIFY_RET_ERROR, '-',
-     &quot;Close connection on verification error&quot;},
-    {&quot;verify_quiet&quot;, OPT_VERIFY_QUIET, '-', &quot;Restrict verify output to errors&quot;},
     {&quot;brief&quot;, OPT_BRIEF, '-',
      &quot;Restrict output to brief summary of connection parameters&quot;},
     {&quot;prexit&quot;, OPT_PREXIT, '-',
      &quot;Print session information when the program exits&quot;},
+
+    OPT_SECTION(&quot;Debug&quot;),
+    {&quot;showcerts&quot;, OPT_SHOWCERTS, '-',
+     &quot;Show all certificates sent by the server&quot;},
+    {&quot;debug&quot;, OPT_DEBUG, '-', &quot;Extra output&quot;},
+    {&quot;msg&quot;, OPT_MSG, '-', &quot;Show protocol messages&quot;},
+    {&quot;msgfile&quot;, OPT_MSGFILE, '&gt;',
+     &quot;File to send output of -msg or -trace, instead of stdout&quot;},
+    {&quot;nbio_test&quot;, OPT_NBIO_TEST, '-', &quot;More ssl protocol testing&quot;},
+    {&quot;state&quot;, OPT_STATE, '-', &quot;Print the ssl states&quot;},
+    {&quot;keymatexport&quot;, OPT_KEYMATEXPORT, 's',
+     &quot;Export keying material using label&quot;},
+    {&quot;keymatexportlen&quot;, OPT_KEYMATEXPORTLEN, 'p',
+     &quot;Export len bytes of keying material (default 20)&quot;},
     {&quot;security_debug&quot;, OPT_SECURITY_DEBUG, '-',
      &quot;Enable security debug messages&quot;},
     {&quot;security_debug_verbose&quot;, OPT_SECURITY_DEBUG_VERBOSE, '-',
      &quot;Output more security debug output&quot;},
-    {&quot;cert_chain&quot;, OPT_CERT_CHAIN, '&lt;',
-     &quot;Certificate chain file (in PEM format)&quot;},
-    {&quot;chainCApath&quot;, OPT_CHAINCAPATH, '/',
-     &quot;Use dir as certificate store path to build CA certificate chain&quot;},
-    {&quot;verifyCApath&quot;, OPT_VERIFYCAPATH, '/',
-     &quot;Use dir as certificate store path to verify CA certificate&quot;},
-    {&quot;build_chain&quot;, OPT_BUILD_CHAIN, '-', &quot;Build certificate chain&quot;},
-    {&quot;chainCAfile&quot;, OPT_CHAINCAFILE, '&lt;',
-     &quot;CA file for certificate chain (PEM format)&quot;},
-    {&quot;verifyCAfile&quot;, OPT_VERIFYCAFILE, '&lt;',
-     &quot;CA file for certificate verification (PEM format)&quot;},
-    {&quot;chainCAstore&quot;, OPT_CHAINCASTORE, ':',
-     &quot;CA store URI for certificate chain&quot;},
-    {&quot;verifyCAstore&quot;, OPT_VERIFYCASTORE, ':',
-     &quot;CA store URI for certificate verification&quot;},
+#ifndef OPENSSL_NO_SSL_TRACE
+    {&quot;trace&quot;, OPT_TRACE, '-', &quot;Show trace output of protocol messages&quot;},
+#endif
+#ifdef WATT32
+    {&quot;wdebug&quot;, OPT_WDEBUG, '-', &quot;WATT-32 tcp debugging&quot;},
+#endif
+    {&quot;keylogfile&quot;, OPT_KEYLOG_FILE, '&gt;', &quot;Write TLS secrets to file&quot;},
     {&quot;nocommands&quot;, OPT_NOCMDS, '-', &quot;Do not use interactive command letters&quot;},
     {&quot;servername&quot;, OPT_SERVERNAME, 's',
      &quot;Set TLS extension servername (SNI) in ClientHello (default)&quot;},
@@ -724,17 +737,9 @@ const OPTIONS s_client_options[] = {
     {&quot;alpn&quot;, OPT_ALPN, 's',
      &quot;Enable ALPN extension, considering named protocols supported (comma-separated list)&quot;},
     {&quot;async&quot;, OPT_ASYNC, '-', &quot;Support asynchronous operation&quot;},
-    {&quot;ssl_config&quot;, OPT_SSL_CONFIG, 's', &quot;Use specified configuration file&quot;},
-    {&quot;max_send_frag&quot;, OPT_MAX_SEND_FRAG, 'p', &quot;Maximum Size of send frames &quot;},
-    {&quot;split_send_frag&quot;, OPT_SPLIT_SEND_FRAG, 'p',
-     &quot;Size used to split data for encrypt pipelines&quot;},
-    {&quot;max_pipelines&quot;, OPT_MAX_PIPELINES, 'p',
-     &quot;Maximum number of encrypt/decrypt pipelines to be used&quot;},
-    {&quot;read_buf&quot;, OPT_READ_BUF, 'p',
-     &quot;Default read buffer size to be used for connections&quot;},
-    OPT_S_OPTIONS,
-    OPT_V_OPTIONS,
-    OPT_X_OPTIONS,
+    {&quot;nbio&quot;, OPT_NBIO, '-', &quot;Use non-blocking IO&quot;},
+
+    OPT_SECTION(&quot;Protocol and version&quot;),
 #ifndef OPENSSL_NO_SSL3
     {&quot;ssl3&quot;, OPT_SSL3, '-', &quot;Just use SSLv3&quot;},
 #endif
@@ -766,16 +771,16 @@ const OPTIONS s_client_options[] = {
     {&quot;sctp&quot;, OPT_SCTP, '-', &quot;Use SCTP&quot;},
     {&quot;sctp_label_bug&quot;, OPT_SCTP_LABEL_BUG, '-', &quot;Enable SCTP label length bug&quot;},
 #endif
-#ifndef OPENSSL_NO_SSL_TRACE
-    {&quot;trace&quot;, OPT_TRACE, '-', &quot;Show trace output of protocol messages&quot;},
+#ifndef OPENSSL_NO_NEXTPROTONEG
+    {&quot;nextprotoneg&quot;, OPT_NEXTPROTONEG, 's',
+     &quot;Enable NPN extension, considering named protocols supported (comma-separated list)&quot;},
 #endif
-#ifdef WATT32
-    {&quot;wdebug&quot;, OPT_WDEBUG, '-', &quot;WATT-32 tcp debugging&quot;},
+    {&quot;early_data&quot;, OPT_EARLY_DATA, '&lt;', &quot;File to send as early data&quot;},
+    {&quot;enable_pha&quot;, OPT_ENABLE_PHA, '-', &quot;Enable post-handshake-authentication&quot;},
+#ifndef OPENSSL_NO_SRTP
+    {&quot;use_srtp&quot;, OPT_USE_SRTP, 's',
+     &quot;Offer SRTP key management with a colon-separated profile list&quot;},
 #endif
-    {&quot;nbio&quot;, OPT_NBIO, '-', &quot;Use non-blocking IO&quot;},
-    {&quot;psk_identity&quot;, OPT_PSK_IDENTITY, 's', &quot;PSK identity&quot;},
-    {&quot;psk&quot;, OPT_PSK, 's', &quot;PSK in hex (without 0x)&quot;},
-    {&quot;psk_session&quot;, OPT_PSK_SESS, '&lt;', &quot;File to read PSK SSL session from&quot;},
 #ifndef OPENSSL_NO_SRP
     {&quot;srpuser&quot;, OPT_SRPUSER, 's', &quot;SRP authentication for 'user'&quot;},
     {&quot;srppass&quot;, OPT_SRPPASS, 's', &quot;Password for 'user'&quot;},
@@ -785,24 +790,33 @@ const OPTIONS s_client_options[] = {
      &quot;Tolerate other than the known g N values.&quot;},
     {&quot;srp_strength&quot;, OPT_SRP_STRENGTH, 'p', &quot;Minimal length in bits for N&quot;},
 #endif
-#ifndef OPENSSL_NO_NEXTPROTONEG
-    {&quot;nextprotoneg&quot;, OPT_NEXTPROTONEG, 's',
-     &quot;Enable NPN extension, considering named protocols supported (comma-separated list)&quot;},
-#endif
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-    {&quot;ssl_client_engine&quot;, OPT_SSL_CLIENT_ENGINE, 's',
-     &quot;Specify engine to be used for client certificate operations&quot;},
-#endif
-#ifndef OPENSSL_NO_CT
-    {&quot;ct&quot;, OPT_CT, '-', &quot;Request and parse SCTs (also enables OCSP stapling)&quot;},
-    {&quot;noct&quot;, OPT_NOCT, '-', &quot;Do not request or parse SCTs (default)&quot;},
-    {&quot;ctlogfile&quot;, OPT_CTLOG_FILE, '&lt;', &quot;CT log list CONF file&quot;},
-#endif
-    {&quot;keylogfile&quot;, OPT_KEYLOG_FILE, '&gt;', &quot;Write TLS secrets to file&quot;},
-    {&quot;early_data&quot;, OPT_EARLY_DATA, '&lt;', &quot;File to send as early data&quot;},
-    {&quot;enable_pha&quot;, OPT_ENABLE_PHA, '-', &quot;Enable post-handshake-authentication&quot;},
-    {NULL, OPT_EOF, 0x00, NULL}
+
+    OPT_R_OPTIONS,
+    OPT_S_OPTIONS,
+    OPT_V_OPTIONS,
+    {&quot;CRL&quot;, OPT_CRL, '&lt;', &quot;CRL file to use&quot;},
+    {&quot;crl_download&quot;, OPT_CRL_DOWNLOAD, '-', &quot;Download CRL from distribution points&quot;},
+    {&quot;CRLform&quot;, OPT_CRLFORM, 'F', &quot;CRL format (PEM or DER) PEM is default&quot;},
+    {&quot;verify_return_error&quot;, OPT_VERIFY_RET_ERROR, '-',
+     &quot;Close connection on verification error&quot;},
+    {&quot;verify_quiet&quot;, OPT_VERIFY_QUIET, '-', &quot;Restrict verify output to errors&quot;},
+    {&quot;cert_chain&quot;, OPT_CERT_CHAIN, '&lt;',
+     &quot;Certificate chain file (in PEM format)&quot;},
+    {&quot;chainCApath&quot;, OPT_CHAINCAPATH, '/',
+     &quot;Use dir as certificate store path to build CA certificate chain&quot;},
+    {&quot;chainCAstore&quot;, OPT_CHAINCASTORE, ':',
+     &quot;CA store URI for certificate chain&quot;},
+    {&quot;verifyCAfile&quot;, OPT_VERIFYCAFILE, '&lt;',
+     &quot;CA file for certificate verification (PEM format)&quot;},
+    {&quot;verifyCApath&quot;, OPT_VERIFYCAPATH, '/',
+     &quot;Use dir as certificate store path to verify CA certificate&quot;},
+    {&quot;verifyCAstore&quot;, OPT_VERIFYCASTORE, ':',
+     &quot;CA store URI for certificate verification&quot;},
+    {&quot;build_chain&quot;, OPT_BUILD_CHAIN, '-', &quot;Build certificate chain&quot;},
+    {&quot;chainCAfile&quot;, OPT_CHAINCAFILE, '&lt;',
+     &quot;CA file for certificate chain (PEM format)&quot;},
+    OPT_X_OPTIONS,
+    {NULL}
 };
 
 typedef enum PROTOCOL_choice {
diff --git a/apps/s_server.c b/apps/s_server.c
index 03ff1b410e..5fa7c2fb42 100644
--- a/apps/s_server.c
+++ b/apps/s_server.c
@@ -761,26 +761,50 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS s_server_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+    {&quot;ssl_config&quot;, OPT_SSL_CONFIG, 's',
+     &quot;Configure SSL_CTX using the configuration 'val'&quot;},
+#ifndef OPENSSL_NO_SSL_TRACE
+    {&quot;trace&quot;, OPT_TRACE, '-', &quot;trace protocol messages&quot;},
+#endif
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#endif
+
+    OPT_SECTION(&quot;Network&quot;),
     {&quot;port&quot;, OPT_PORT, 'p',
      &quot;TCP/IP port to listen on for connections (default is &quot; PORT &quot;)&quot;},
     {&quot;accept&quot;, OPT_ACCEPT, 's',
      &quot;TCP/IP optional host and port to listen on for connections (default is *:&quot; PORT &quot;)&quot;},
 #ifdef AF_UNIX
     {&quot;unix&quot;, OPT_UNIX, 's', &quot;Unix domain socket to accept on&quot;},
+    {&quot;unlink&quot;, OPT_UNLINK, '-', &quot;For -unix, unlink existing socket first&quot;},
 #endif
     {&quot;4&quot;, OPT_4, '-', &quot;Use IPv4 only&quot;},
     {&quot;6&quot;, OPT_6, '-', &quot;Use IPv6 only&quot;},
-#ifdef AF_UNIX
-    {&quot;unlink&quot;, OPT_UNLINK, '-', &quot;For -unix, unlink existing socket first&quot;},
-#endif
+
+    OPT_SECTION(&quot;Identity&quot;),
     {&quot;context&quot;, OPT_CONTEXT, 's', &quot;Set session ID context&quot;},
+    {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;PEM format file of CA's&quot;},
+    {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;PEM format directory of CA's&quot;},
+    {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;URI to store of CA's&quot;},
+    {&quot;no-CAfile&quot;, OPT_NOCAFILE, '-',
+     &quot;Do not load the default certificates file&quot;},
+    {&quot;no-CApath&quot;, OPT_NOCAPATH, '-',
+     &quot;Do not load certificates from the default certificates directory&quot;},
+    {&quot;no-CAstore&quot;, OPT_NOCASTORE, '-',
+     &quot;Do not load certificates from the default certificates store URI&quot;},
+    {&quot;nocert&quot;, OPT_NOCERT, '-', &quot;Don't use any certificates (Anon-DH)&quot;},
     {&quot;verify&quot;, OPT_VERIFY, 'n', &quot;Turn on peer certificate verification&quot;},
     {&quot;Verify&quot;, OPT_UPPER_V_VERIFY, 'n',
      &quot;Turn on peer certificate verification, must have a cert&quot;},
     {&quot;cert&quot;, OPT_CERT, '&lt;', &quot;Certificate file to use; default is &quot; TEST_CERT},
+    {&quot;cert2&quot;, OPT_CERT2, '&lt;',
+     &quot;Certificate file to use for servername; default is&quot; TEST_CERT2},
+    {&quot;key2&quot;, OPT_KEY2, '&lt;',
+     &quot;-Private Key file to use for servername if not in -cert2&quot;},
     {&quot;nameopt&quot;, OPT_NAMEOPT, 's', &quot;Various certificate name options&quot;},
-    {&quot;naccept&quot;, OPT_NACCEPT, 'p', &quot;Terminate after #num connections&quot;},
     {&quot;serverinfo&quot;, OPT_SERVERINFO, 's',
      &quot;PEM serverinfo file for certificate&quot;},
     {&quot;certform&quot;, OPT_CERTFORM, 'F',
@@ -800,42 +824,24 @@ const OPTIONS s_server_options[] = {
     {&quot;dkeyform&quot;, OPT_DKEYFORM, 'F',
      &quot;Second key format (PEM, DER or ENGINE) PEM default&quot;},
     {&quot;dpass&quot;, OPT_DPASS, 's', &quot;Second private key file pass phrase source&quot;},
+    {&quot;servername&quot;, OPT_SERVERNAME, 's',
+     &quot;Servername for HostName TLS extension&quot;},
+    {&quot;servername_fatal&quot;, OPT_SERVERNAME_FATAL, '-',
+     &quot;mismatch send fatal alert (default warning alert)&quot;},
+
     {&quot;nbio_test&quot;, OPT_NBIO_TEST, '-', &quot;Test with the non-blocking test bio&quot;},
     {&quot;crlf&quot;, OPT_CRLF, '-', &quot;Convert LF from terminal into CRLF&quot;},
-    {&quot;debug&quot;, OPT_DEBUG, '-', &quot;Print more output&quot;},
-    {&quot;msg&quot;, OPT_MSG, '-', &quot;Show protocol messages&quot;},
-    {&quot;msgfile&quot;, OPT_MSGFILE, '&gt;',
-     &quot;File to send output of -msg or -trace, instead of stdout&quot;},
-    {&quot;state&quot;, OPT_STATE, '-', &quot;Print the SSL states&quot;},
-    {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;PEM format file of CA's&quot;},
-    {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;PEM format directory of CA's&quot;},
-    {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;URI to store of CA's&quot;},
-    {&quot;no-CAfile&quot;, OPT_NOCAFILE, '-',
-     &quot;Do not load the default certificates file&quot;},
-    {&quot;no-CApath&quot;, OPT_NOCAPATH, '-',
-     &quot;Do not load certificates from the default certificates directory&quot;},
-    {&quot;no-CAstore&quot;, OPT_NOCASTORE, '-',
-     &quot;Do not load certificates from the default certificates store URI&quot;},
-    {&quot;nocert&quot;, OPT_NOCERT, '-', &quot;Don't use any certificates (Anon-DH)&quot;},
+
     {&quot;quiet&quot;, OPT_QUIET, '-', &quot;No server output&quot;},
     {&quot;no_resume_ephemeral&quot;, OPT_NO_RESUME_EPHEMERAL, '-',
      &quot;Disable caching and tickets if ephemeral (EC)DH is used&quot;},
     {&quot;www&quot;, OPT_WWW, '-', &quot;Respond to a 'GET /' with a status page&quot;},
     {&quot;WWW&quot;, OPT_UPPER_WWW, '-', &quot;Respond to a 'GET with the file ./path&quot;},
-    {&quot;servername&quot;, OPT_SERVERNAME, 's',
-     &quot;Servername for HostName TLS extension&quot;},
-    {&quot;servername_fatal&quot;, OPT_SERVERNAME_FATAL, '-',
-     &quot;mismatch send fatal alert (default warning alert)&quot;},
-    {&quot;cert2&quot;, OPT_CERT2, '&lt;',
-     &quot;Certificate file to use for servername; default is&quot; TEST_CERT2},
-    {&quot;key2&quot;, OPT_KEY2, '&lt;',
-     &quot;-Private Key file to use for servername if not in -cert2&quot;},
     {&quot;tlsextdebug&quot;, OPT_TLSEXTDEBUG, '-',
      &quot;Hex dump of all TLS extensions received&quot;},
     {&quot;HTTP&quot;, OPT_HTTP, '-', &quot;Like -WWW but ./path includes HTTP headers&quot;},
     {&quot;id_prefix&quot;, OPT_ID_PREFIX, 's',
      &quot;Generate SSL/TLS session IDs prefixed by arg&quot;},
-    OPT_R_OPTIONS,
     {&quot;keymatexport&quot;, OPT_KEYMATEXPORT, 's',
      &quot;Export keying material using label&quot;},
     {&quot;keymatexportlen&quot;, OPT_KEYMATEXPORTLEN, 'p',
@@ -843,10 +849,6 @@ const OPTIONS s_server_options[] = {
     {&quot;CRL&quot;, OPT_CRL, '&lt;', &quot;CRL file to use&quot;},
     {&quot;crl_download&quot;, OPT_CRL_DOWNLOAD, '-',
      &quot;Download CRL from distribution points&quot;},
-    {&quot;cert_chain&quot;, OPT_CERT_CHAIN, '&lt;',
-     &quot;certificate chain file in PEM format&quot;},
-    {&quot;dcert_chain&quot;, OPT_DCERT_CHAIN, '&lt;',
-     &quot;second certificate chain file in PEM format&quot;},
     {&quot;chainCApath&quot;, OPT_CHAINCAPATH, '/',
      &quot;use dir as certificate store path to build CA certificate chain&quot;},
     {&quot;chainCAstore&quot;, OPT_CHAINCASTORE, ':',
@@ -863,14 +865,13 @@ const OPTIONS s_server_options[] = {
      &quot;Close connection on verification error&quot;},
     {&quot;verify_quiet&quot;, OPT_VERIFY_QUIET, '-',
      &quot;No verify output except verify errors&quot;},
-    {&quot;build_chain&quot;, OPT_BUILD_CHAIN, '-', &quot;Build certificate chain&quot;},
-    {&quot;chainCAfile&quot;, OPT_CHAINCAFILE, '&lt;',
-     &quot;CA file for certificate chain (PEM format)&quot;},
     {&quot;verifyCAfile&quot;, OPT_VERIFYCAFILE, '&lt;',
      &quot;CA file for certificate verification (PEM format)&quot;},
     {&quot;ign_eof&quot;, OPT_IGN_EOF, '-', &quot;ignore input eof (default when -quiet)&quot;},
     {&quot;no_ign_eof&quot;, OPT_NO_IGN_EOF, '-', &quot;Do not ignore input eof&quot;},
+
 #ifndef OPENSSL_NO_OCSP
+    OPT_SECTION(&quot;OCSP&quot;),
     {&quot;status&quot;, OPT_STATUS, '-', &quot;Request certificate status from server&quot;},
     {&quot;status_verbose&quot;, OPT_STATUS_VERBOSE, '-',
      &quot;Print more output in certificate status callback&quot;},
@@ -880,9 +881,8 @@ const OPTIONS s_server_options[] = {
     {&quot;status_file&quot;, OPT_STATUS_FILE, '&lt;',
      &quot;File containing DER encoded OCSP Response&quot;},
 #endif
-#ifndef OPENSSL_NO_SSL_TRACE
-    {&quot;trace&quot;, OPT_TRACE, '-', &quot;trace protocol messages&quot;},
-#endif
+
+    OPT_SECTION(&quot;Debug&quot;),
     {&quot;security_debug&quot;, OPT_SECURITY_DEBUG, '-',
      &quot;Print output from SSL/TLS security framework&quot;},
     {&quot;security_debug_verbose&quot;, OPT_SECURITY_DEBUG_VERBOSE, '-',
@@ -891,20 +891,28 @@ const OPTIONS s_server_options[] = {
      &quot;Restrict output to brief summary of connection parameters&quot;},
     {&quot;rev&quot;, OPT_REV, '-',
      &quot;act as a simple test server which just sends back with the received text reversed&quot;},
+    {&quot;debug&quot;, OPT_DEBUG, '-', &quot;Print more output&quot;},
+    {&quot;msg&quot;, OPT_MSG, '-', &quot;Show protocol messages&quot;},
+    {&quot;msgfile&quot;, OPT_MSGFILE, '&gt;',
+     &quot;File to send output of -msg or -trace, instead of stdout&quot;},
+    {&quot;state&quot;, OPT_STATE, '-', &quot;Print the SSL states&quot;},
     {&quot;async&quot;, OPT_ASYNC, '-', &quot;Operate in asynchronous mode&quot;},
-    {&quot;ssl_config&quot;, OPT_SSL_CONFIG, 's',
-     &quot;Configure SSL_CTX using the configuration 'val'&quot;},
-    {&quot;max_send_frag&quot;, OPT_MAX_SEND_FRAG, 'p', &quot;Maximum Size of send frames &quot;},
-    {&quot;split_send_frag&quot;, OPT_SPLIT_SEND_FRAG, 'p',
-     &quot;Size used to split data for encrypt pipelines&quot;},
     {&quot;max_pipelines&quot;, OPT_MAX_PIPELINES, 'p',
      &quot;Maximum number of encrypt/decrypt pipelines to be used&quot;},
+    {&quot;naccept&quot;, OPT_NACCEPT, 'p', &quot;Terminate after #num connections&quot;},
+    {&quot;keylogfile&quot;, OPT_KEYLOG_FILE, '&gt;', &quot;Write TLS secrets to file&quot;},
+
+    OPT_SECTION(&quot;Network&quot;),
+    {&quot;nbio&quot;, OPT_NBIO, '-', &quot;Use non-blocking IO&quot;},
+    {&quot;timeout&quot;, OPT_TIMEOUT, '-', &quot;Enable timeouts&quot;},
+    {&quot;mtu&quot;, OPT_MTU, 'p', &quot;Set link layer MTU&quot;},
     {&quot;read_buf&quot;, OPT_READ_BUF, 'p',
      &quot;Default read buffer size to be used for connections&quot;},
-    OPT_S_OPTIONS,
-    OPT_V_OPTIONS,
-    OPT_X_OPTIONS,
-    {&quot;nbio&quot;, OPT_NBIO, '-', &quot;Use non-blocking IO&quot;},
+    {&quot;split_send_frag&quot;, OPT_SPLIT_SEND_FRAG, 'p',
+     &quot;Size used to split data for encrypt pipelines&quot;},
+    {&quot;max_send_frag&quot;, OPT_MAX_SEND_FRAG, 'p', &quot;Maximum Size of send frames &quot;},
+
+    OPT_SECTION(&quot;Server identity&quot;),
     {&quot;psk_identity&quot;, OPT_PSK_IDENTITY, 's', &quot;PSK identity to expect&quot;},
 #ifndef OPENSSL_NO_PSK
     {&quot;psk_hint&quot;, OPT_PSK_HINT, 's', &quot;PSK identity hint to use&quot;},
@@ -916,6 +924,19 @@ const OPTIONS s_server_options[] = {
     {&quot;srpuserseed&quot;, OPT_SRPUSERSEED, 's',
      &quot;A seed string for a default user salt&quot;},
 #endif
+
+    OPT_SECTION(&quot;Protocol and version&quot;),
+    {&quot;max_early_data&quot;, OPT_MAX_EARLY, 'n',
+     &quot;The maximum number of bytes of early data as advertised in tickets&quot;},
+    {&quot;recv_max_early_data&quot;, OPT_RECV_MAX_EARLY, 'n',
+     &quot;The maximum number of bytes of early data (hard limit)&quot;},
+    {&quot;early_data&quot;, OPT_EARLY_DATA, '-', &quot;Attempt to read early data&quot;},
+    {&quot;num_tickets&quot;, OPT_S_NUM_TICKETS, 'n',
+     &quot;The number of TLSv1.3 session tickets that a server will automatically issue&quot; },
+    {&quot;anti_replay&quot;, OPT_ANTI_REPLAY, '-', &quot;Switch on anti-replay protection (default)&quot;},
+    {&quot;no_anti_replay&quot;, OPT_NO_ANTI_REPLAY, '-', &quot;Switch off anti-replay protection&quot;},
+    {&quot;http_server_binmode&quot;, OPT_HTTP_SERVER_BINMODE, '-', &quot;opening files in binary mode when acting as http server (-WWW and -HTTP)&quot;},
+    {&quot;stateless&quot;, OPT_STATELESS, '-', &quot;Require TLSv1.3 cookies&quot;},
 #ifndef OPENSSL_NO_SSL3
     {&quot;ssl3&quot;, OPT_SSL3, '-', &quot;Just talk SSLv3&quot;},
 #endif
@@ -933,12 +954,9 @@ const OPTIONS s_server_options[] = {
 #endif
 #ifndef OPENSSL_NO_DTLS
     {&quot;dtls&quot;, OPT_DTLS, '-', &quot;Use any DTLS version&quot;},
-    {&quot;timeout&quot;, OPT_TIMEOUT, '-', &quot;Enable timeouts&quot;},
-    {&quot;mtu&quot;, OPT_MTU, 'p', &quot;Set link layer MTU&quot;},
     {&quot;listen&quot;, OPT_LISTEN, '-',
      &quot;Listen for a DTLS ClientHello with a cookie and then connect&quot;},
 #endif
-    {&quot;stateless&quot;, OPT_STATELESS, '-', &quot;Require TLSv1.3 cookies&quot;},
 #ifndef OPENSSL_NO_DTLS1
     {&quot;dtls1&quot;, OPT_DTLS1, '-', &quot;Just talk DTLSv1&quot;},
 #endif
@@ -949,34 +967,32 @@ const OPTIONS s_server_options[] = {
     {&quot;sctp&quot;, OPT_SCTP, '-', &quot;Use SCTP&quot;},
     {&quot;sctp_label_bug&quot;, OPT_SCTP_LABEL_BUG, '-', &quot;Enable SCTP label length bug&quot;},
 #endif
+#ifndef OPENSSL_NO_SRTP
+    {&quot;use_srtp&quot;, OPT_SRTP_PROFILES, 's',
+     &quot;Offer SRTP key management with a colon-separated profile list&quot;},
+#endif
 #ifndef OPENSSL_NO_DH
     {&quot;no_dhe&quot;, OPT_NO_DHE, '-', &quot;Disable ephemeral DH&quot;},
 #endif
 #ifndef OPENSSL_NO_NEXTPROTONEG
     {&quot;nextprotoneg&quot;, OPT_NEXTPROTONEG, 's',
      &quot;Set the advertised protocols for the NPN extension (comma-separated list)&quot;},
-#endif
-#ifndef OPENSSL_NO_SRTP
-    {&quot;use_srtp&quot;, OPT_SRTP_PROFILES, 's',
-     &quot;Offer SRTP key management with a colon-separated profile list&quot;},
 #endif
     {&quot;alpn&quot;, OPT_ALPN, 's',
      &quot;Set the advertised protocols for the ALPN extension (comma-separated list)&quot;},
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-#endif
-    {&quot;keylogfile&quot;, OPT_KEYLOG_FILE, '&gt;', &quot;Write TLS secrets to file&quot;},
-    {&quot;max_early_data&quot;, OPT_MAX_EARLY, 'n',
-     &quot;The maximum number of bytes of early data as advertised in tickets&quot;},
-    {&quot;recv_max_early_data&quot;, OPT_RECV_MAX_EARLY, 'n',
-     &quot;The maximum number of bytes of early data (hard limit)&quot;},
-    {&quot;early_data&quot;, OPT_EARLY_DATA, '-', &quot;Attempt to read early data&quot;},
-    {&quot;num_tickets&quot;, OPT_S_NUM_TICKETS, 'n',
-     &quot;The number of TLSv1.3 session tickets that a server will automatically  issue&quot; },
-    {&quot;anti_replay&quot;, OPT_ANTI_REPLAY, '-', &quot;Switch on anti-replay protection (default)&quot;},
-    {&quot;no_anti_replay&quot;, OPT_NO_ANTI_REPLAY, '-', &quot;Switch off anti-replay protection&quot;},
-    {&quot;http_server_binmode&quot;, OPT_HTTP_SERVER_BINMODE, '-', &quot;opening files in binary mode when acting as http server (-WWW and -HTTP)&quot;},
-    {NULL, OPT_EOF, 0, NULL}
+
+    OPT_R_OPTIONS,
+    OPT_S_OPTIONS,
+    OPT_V_OPTIONS,
+    {&quot;cert_chain&quot;, OPT_CERT_CHAIN, '&lt;',
+     &quot;certificate chain file in PEM format&quot;},
+    {&quot;dcert_chain&quot;, OPT_DCERT_CHAIN, '&lt;',
+     &quot;second certificate chain file in PEM format&quot;},
+    {&quot;build_chain&quot;, OPT_BUILD_CHAIN, '-', &quot;Build certificate chain&quot;},
+    {&quot;chainCAfile&quot;, OPT_CHAINCAFILE, '&lt;',
+     &quot;CA file for certificate chain (PEM format)&quot;},
+    OPT_X_OPTIONS,
+    {NULL}
 };
 
 #define IS_PROT_FLAG(o) \
diff --git a/apps/s_time.c b/apps/s_time.c
index 43bec59037..d5816a1b16 100644
--- a/apps/s_time.c
+++ b/apps/s_time.c
@@ -52,31 +52,18 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS s_time_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+
+    OPT_SECTION(&quot;Connection&quot;),
     {&quot;connect&quot;, OPT_CONNECT, 's',
      &quot;Where to connect as post:port (default is &quot; SSL_CONNECT_NAME &quot;)&quot;},
-    {&quot;cipher&quot;, OPT_CIPHER, 's', &quot;TLSv1.2 and below cipher list to be used&quot;},
-    {&quot;ciphersuites&quot;, OPT_CIPHERSUITES, 's',
-     &quot;Specify TLSv1.3 ciphersuites to be used&quot;},
-    {&quot;cert&quot;, OPT_CERT, '&lt;', &quot;Cert file to use, PEM format assumed&quot;},
-    {&quot;nameopt&quot;, OPT_NAMEOPT, 's', &quot;Various certificate name options&quot;},
-    {&quot;key&quot;, OPT_KEY, '&lt;', &quot;File with key, PEM; default is -cert file&quot;},
-    {&quot;cafile&quot;, OPT_CAFILE, '&lt;', &quot;PEM format file of CA's&quot;},
-    {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;PEM format directory of CA's&quot;},
-    {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;URI to store of CA's&quot;},
-    {&quot;no-CAfile&quot;, OPT_NOCAFILE, '-',
-     &quot;Do not load the default certificates file&quot;},
-    {&quot;no-CApath&quot;, OPT_NOCAPATH, '-',
-     &quot;Do not load certificates from the default certificates directory&quot;},
-    {&quot;no-CAstore&quot;, OPT_NOCASTORE, '-',
-     &quot;Do not load certificates from the default certificates store URI&quot;},
     {&quot;new&quot;, OPT_NEW, '-', &quot;Just time new connections&quot;},
     {&quot;reuse&quot;, OPT_REUSE, '-', &quot;Just time connection reuse&quot;},
     {&quot;bugs&quot;, OPT_BUGS, '-', &quot;Turn on SSL bug compatibility&quot;},
-    {&quot;verify&quot;, OPT_VERIFY, 'p',
-     &quot;Turn on peer certificate verification, set depth&quot;},
-    {&quot;time&quot;, OPT_TIME, 'p', &quot;Seconds to collect data, default &quot; SECONDSSTR},
-    {&quot;www&quot;, OPT_WWW, 's', &quot;Fetch specified page from the site&quot;},
+    {&quot;cipher&quot;, OPT_CIPHER, 's', &quot;TLSv1.2 and below cipher list to be used&quot;},
+    {&quot;ciphersuites&quot;, OPT_CIPHERSUITES, 's',
+     &quot;Specify TLSv1.3 ciphersuites to be used&quot;},
 #ifndef OPENSSL_NO_SSL3
     {&quot;ssl3&quot;, OPT_SSL3, '-', &quot;Just use SSLv3&quot;},
 #endif
@@ -92,6 +79,25 @@ const OPTIONS s_time_options[] = {
 #ifndef OPENSSL_NO_TLS1_3
     {&quot;tls1_3&quot;, OPT_TLS1_3, '-', &quot;Just use TLSv1.3&quot;},
 #endif
+    {&quot;verify&quot;, OPT_VERIFY, 'p',
+     &quot;Turn on peer certificate verification, set depth&quot;},
+    {&quot;time&quot;, OPT_TIME, 'p', &quot;Seconds to collect data, default &quot; SECONDSSTR},
+    {&quot;www&quot;, OPT_WWW, 's', &quot;Fetch specified page from the site&quot;},
+
+    OPT_SECTION(&quot;Certificate&quot;),
+    {&quot;nameopt&quot;, OPT_NAMEOPT, 's', &quot;Various certificate name options&quot;},
+    {&quot;cert&quot;, OPT_CERT, '&lt;', &quot;Cert file to use, PEM format assumed&quot;},
+    {&quot;key&quot;, OPT_KEY, '&lt;', &quot;File with key, PEM; default is -cert file&quot;},
+    {&quot;cafile&quot;, OPT_CAFILE, '&lt;', &quot;PEM format file of CA's&quot;},
+    {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;PEM format directory of CA's&quot;},
+    {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;URI to store of CA's&quot;},
+    {&quot;no-CAfile&quot;, OPT_NOCAFILE, '-',
+     &quot;Do not load the default certificates file&quot;},
+    {&quot;no-CApath&quot;, OPT_NOCAPATH, '-',
+     &quot;Do not load certificates from the default certificates directory&quot;},
+    {&quot;no-CAstore&quot;, OPT_NOCASTORE, '-',
+     &quot;Do not load certificates from the default certificates store URI&quot;},
+
     {NULL}
 };
 
diff --git a/apps/sess_id.c b/apps/sess_id.c
index d8e1827776..5183ea93ed 100644
--- a/apps/sess_id.c
+++ b/apps/sess_id.c
@@ -25,16 +25,21 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS sess_id_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+    {&quot;context&quot;, OPT_CONTEXT, 's', &quot;Set the session ID context&quot;},
+
+    OPT_SECTION(&quot;Input&quot;),
+    {&quot;in&quot;, OPT_IN, 's', &quot;Input file - default stdin&quot;},
     {&quot;inform&quot;, OPT_INFORM, 'F', &quot;Input format - default PEM (DER or PEM)&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file - default stdout&quot;},
     {&quot;outform&quot;, OPT_OUTFORM, 'f',
      &quot;Output format - default PEM (PEM, DER or NSS)&quot;},
-    {&quot;in&quot;, OPT_IN, 's', &quot;Input file - default stdin&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file - default stdout&quot;},
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Print ssl session id details&quot;},
     {&quot;cert&quot;, OPT_CERT, '-', &quot;Output certificate &quot;},
     {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't output the encoded session info&quot;},
-    {&quot;context&quot;, OPT_CONTEXT, 's', &quot;Set the session ID context&quot;},
     {NULL}
 };
 
diff --git a/apps/smime.c b/apps/smime.c
index 26bd028bea..ec36ea1867 100644
--- a/apps/smime.c
+++ b/apps/smime.c
@@ -52,39 +52,62 @@ const OPTIONS smime_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] cert.pem...\n&quot;},
     {OPT_HELP_STR, 1, '-',
         &quot;  cert.pem... recipient certs for encryption\n&quot;},
-    {OPT_HELP_STR, 1, '-', &quot;Valid options are:\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
+    {&quot;inform&quot;, OPT_INFORM, 'c', &quot;Input format SMIME (default), PEM or DER&quot;},
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;outform&quot;, OPT_OUTFORM, 'c',
+     &quot;Output format SMIME (default), PEM or DER&quot;},
+    {&quot;inkey&quot;, OPT_INKEY, 's',
+     &quot;Input private key (if not signer or recipient)&quot;},
+    {&quot;keyform&quot;, OPT_KEYFORM, 'f', &quot;Input private key format (PEM or ENGINE)&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#endif
+    {&quot;stream&quot;, OPT_STREAM, '-', &quot;Enable CMS streaming&quot; },
+    {&quot;indef&quot;, OPT_INDEF, '-', &quot;Same as -stream&quot; },
+    {&quot;noindef&quot;, OPT_NOINDEF, '-', &quot;Disable CMS streaming&quot;},
+
+    OPT_SECTION(&quot;Action&quot;),
     {&quot;encrypt&quot;, OPT_ENCRYPT, '-', &quot;Encrypt message&quot;},
     {&quot;decrypt&quot;, OPT_DECRYPT, '-', &quot;Decrypt encrypted message&quot;},
     {&quot;sign&quot;, OPT_SIGN, '-', &quot;Sign message&quot;},
+    {&quot;resign&quot;, OPT_RESIGN, '-', &quot;Resign a signed message&quot;},
     {&quot;verify&quot;, OPT_VERIFY, '-', &quot;Verify signed message&quot;},
+
+    OPT_SECTION(&quot;Signing/Encryption&quot;),
+    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
+    {&quot;md&quot;, OPT_MD, 's', &quot;Digest algorithm to use when signing or resigning&quot;},
+    {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
     {&quot;pk7out&quot;, OPT_PK7OUT, '-', &quot;Output PKCS#7 structure&quot;},
     {&quot;nointern&quot;, OPT_NOINTERN, '-',
      &quot;Don't search certificates in message for signer&quot;},
-    {&quot;nosigs&quot;, OPT_NOSIGS, '-', &quot;Don't verify message signature&quot;},
-    {&quot;noverify&quot;, OPT_NOVERIFY, '-', &quot;Don't verify signers certificate&quot;},
-    {&quot;nocerts&quot;, OPT_NOCERTS, '-',
-     &quot;Don't include signers certificate when signing&quot;},
     {&quot;nodetach&quot;, OPT_NODETACH, '-', &quot;Use opaque signing&quot;},
     {&quot;noattr&quot;, OPT_NOATTR, '-', &quot;Don't include any signed attributes&quot;},
     {&quot;binary&quot;, OPT_BINARY, '-', &quot;Don't translate message to text&quot;},
-    {&quot;certfile&quot;, OPT_CERTFILE, '&lt;', &quot;Other certificates file&quot;},
     {&quot;signer&quot;, OPT_SIGNER, 's', &quot;Signer certificate file&quot;},
-    {&quot;recip&quot;, OPT_RECIP, '&lt;', &quot;Recipient certificate file for decryption&quot;},
-    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
-    {&quot;inform&quot;, OPT_INFORM, 'c', &quot;Input format SMIME (default), PEM or DER&quot;},
-    {&quot;inkey&quot;, OPT_INKEY, 's',
-     &quot;Input private key (if not signer or recipient)&quot;},
-    {&quot;keyform&quot;, OPT_KEYFORM, 'f', &quot;Input private key format (PEM or ENGINE)&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
-    {&quot;outform&quot;, OPT_OUTFORM, 'c',
-     &quot;Output format SMIME (default), PEM or DER&quot;},
     {&quot;content&quot;, OPT_CONTENT, '&lt;',
      &quot;Supply or override content for detached signature&quot;},
+    {&quot;nocerts&quot;, OPT_NOCERTS, '-',
+     &quot;Don't include signers certificate when signing&quot;},
+
+    OPT_SECTION(&quot;Verification/Decryption&quot;),
+    {&quot;nosigs&quot;, OPT_NOSIGS, '-', &quot;Don't verify message signature&quot;},
+    {&quot;noverify&quot;, OPT_NOVERIFY, '-', &quot;Don't verify signers certificate&quot;},
+
+    {&quot;certfile&quot;, OPT_CERTFILE, '&lt;', &quot;Other certificates file&quot;},
+    {&quot;recip&quot;, OPT_RECIP, '&lt;', &quot;Recipient certificate file for decryption&quot;},
+
+    OPT_SECTION(&quot;Email&quot;),
     {&quot;to&quot;, OPT_TO, 's', &quot;To address&quot;},
     {&quot;from&quot;, OPT_FROM, 's', &quot;From address&quot;},
     {&quot;subject&quot;, OPT_SUBJECT, 's', &quot;Subject&quot;},
     {&quot;text&quot;, OPT_TEXT, '-', &quot;Include or delete text MIME headers&quot;},
+    {&quot;nosmimecap&quot;, OPT_NOSMIMECAP, '-', &quot;Omit the SMIMECapabilities attribute&quot;},
+
+    OPT_SECTION(&quot;Certificate chain&quot;),
     {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;Trusted certificates directory&quot;},
     {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;Trusted certificates file&quot;},
     {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;Trusted certificates store URI&quot;},
@@ -94,22 +117,12 @@ const OPTIONS smime_options[] = {
      &quot;Do not load certificates from the default certificates directory&quot;},
     {&quot;no-CAstore&quot;, OPT_NOCASTORE, '-',
      &quot;Do not load certificates from the default certificates store&quot;},
-    {&quot;resign&quot;, OPT_RESIGN, '-', &quot;Resign a signed message&quot;},
     {&quot;nochain&quot;, OPT_NOCHAIN, '-',
      &quot;set PKCS7_NOCHAIN so certificates contained in the message are not used as untrusted CAs&quot; },
-    {&quot;nosmimecap&quot;, OPT_NOSMIMECAP, '-', &quot;Omit the SMIMECapabilities attribute&quot;},
-    {&quot;stream&quot;, OPT_STREAM, '-', &quot;Enable CMS streaming&quot; },
-    {&quot;indef&quot;, OPT_INDEF, '-', &quot;Same as -stream&quot; },
-    {&quot;noindef&quot;, OPT_NOINDEF, '-', &quot;Disable CMS streaming&quot;},
     {&quot;crlfeol&quot;, OPT_CRLFEOL, '-', &quot;Use CRLF as EOL termination instead of CR only&quot;},
+
     OPT_R_OPTIONS,
-    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
-    {&quot;md&quot;, OPT_MD, 's', &quot;Digest algorithm to use when signing or resigning&quot;},
-    {&quot;&quot;, OPT_CIPHER, '-', &quot;Any supported cipher&quot;},
     OPT_V_OPTIONS,
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-#endif
     {NULL}
 };
 
diff --git a/apps/speed.c b/apps/speed.c
index 75d3149ae0..45cee2c2c5 100644
--- a/apps/speed.c
+++ b/apps/speed.c
@@ -316,17 +316,9 @@ typedef enum OPTION_choice {
 
 const OPTIONS speed_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] ciphers...\n&quot;},
-    {OPT_HELP_STR, 1, '-', &quot;Valid options are:\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;evp&quot;, OPT_EVP, 's', &quot;Use EVP-named cipher or digest&quot;},
-    {&quot;hmac&quot;, OPT_HMAC, 's', &quot;HMAC using EVP-named digest&quot;},
-#ifndef OPENSSL_NO_CMAC
-    {&quot;cmac&quot;, OPT_CMAC, 's', &quot;CMAC using EVP-named cipher&quot;},
-#endif
-    {&quot;decrypt&quot;, OPT_DECRYPT, '-',
-     &quot;Time decryption instead of encryption (only EVP)&quot;},
-    {&quot;aead&quot;, OPT_AEAD, '-',
-     &quot;Benchmark EVP-named AEAD cipher in TLS-like sequence&quot;},
     {&quot;mb&quot;, OPT_MB, '-',
      &quot;Enable (tls1&gt;=1) multi-block mode on EVP-named cipher&quot;},
     {&quot;mr&quot;, OPT_MR, '-', &quot;Produce machine readable output&quot;},
@@ -337,19 +329,33 @@ const OPTIONS speed_options[] = {
     {&quot;async_jobs&quot;, OPT_ASYNCJOBS, 'p',
      &quot;Enable async mode and start specified number of jobs&quot;},
 #endif
-    OPT_R_OPTIONS,
 #ifndef OPENSSL_NO_ENGINE
     {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
 #endif
+    {&quot;primes&quot;, OPT_PRIMES, 'p', &quot;Specify number of primes (for RSA only)&quot;},
+
+    OPT_SECTION(&quot;Selection&quot;),
+    {&quot;evp&quot;, OPT_EVP, 's', &quot;Use EVP-named cipher or digest&quot;},
+    {&quot;hmac&quot;, OPT_HMAC, 's', &quot;HMAC using EVP-named digest&quot;},
+#ifndef OPENSSL_NO_CMAC
+    {&quot;cmac&quot;, OPT_CMAC, 's', &quot;CMAC using EVP-named cipher&quot;},
+#endif
+    {&quot;decrypt&quot;, OPT_DECRYPT, '-',
+     &quot;Time decryption instead of encryption (only EVP)&quot;},
+    {&quot;aead&quot;, OPT_AEAD, '-',
+     &quot;Benchmark EVP-named AEAD cipher in TLS-like sequence&quot;},
+
+    OPT_SECTION(&quot;Timing&quot;),
     {&quot;elapsed&quot;, OPT_ELAPSED, '-',
      &quot;Use wall-clock time instead of CPU user time as divisor&quot;},
-    {&quot;primes&quot;, OPT_PRIMES, 'p', &quot;Specify number of primes (for RSA only)&quot;},
     {&quot;seconds&quot;, OPT_SECONDS, 'p',
      &quot;Run benchmarks for specified amount of seconds&quot;},
     {&quot;bytes&quot;, OPT_BYTES, 'p',
      &quot;Run [non-PKI] benchmarks on custom-sized buffer&quot;},
     {&quot;misalign&quot;, OPT_MISALIGN, 'p',
      &quot;Use specified offset to mis-align buffers&quot;},
+
+    OPT_R_OPTIONS,
     {NULL}
 };
 
diff --git a/apps/spkac.c b/apps/spkac.c
index 0ac644dd20..75e246a110 100644
--- a/apps/spkac.c
+++ b/apps/spkac.c
@@ -28,22 +28,27 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS spkac_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+    {&quot;spksect&quot;, OPT_SPKSECT, 's',
+     &quot;Specify the name of an SPKAC-dedicated section of configuration&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#endif
+
+    OPT_SECTION(&quot;Input&quot;),
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
     {&quot;key&quot;, OPT_KEY, '&lt;', &quot;Create SPKAC using private key&quot;},
     {&quot;keyform&quot;, OPT_KEYFORM, 'f', &quot;Private key file format - default PEM (PEM, DER, or ENGINE)&quot;},
     {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
     {&quot;challenge&quot;, OPT_CHALLENGE, 's', &quot;Challenge string&quot;},
     {&quot;spkac&quot;, OPT_SPKAC, 's', &quot;Alternative SPKAC name&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
     {&quot;noout&quot;, OPT_NOOUT, '-', &quot;Don't print SPKAC&quot;},
     {&quot;pubkey&quot;, OPT_PUBKEY, '-', &quot;Output public key&quot;},
     {&quot;verify&quot;, OPT_VERIFY, '-', &quot;Verify SPKAC signature&quot;},
-    {&quot;spksect&quot;, OPT_SPKSECT, 's',
-     &quot;Specify the name of an SPKAC-dedicated section of configuration&quot;},
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-#endif
     {NULL}
 };
 
diff --git a/apps/srp.c b/apps/srp.c
index e9d9b67b79..b980ecbbb5 100644
--- a/apps/srp.c
+++ b/apps/srp.c
@@ -197,24 +197,29 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS srp_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
     {&quot;verbose&quot;, OPT_VERBOSE, '-', &quot;Talk a lot while doing things&quot;},
     {&quot;config&quot;, OPT_CONFIG, '&lt;', &quot;A config file&quot;},
     {&quot;name&quot;, OPT_NAME, 's', &quot;The particular srp definition to use&quot;},
-    {&quot;srpvfile&quot;, OPT_SRPVFILE, '&lt;', &quot;The srp verifier file name&quot;},
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+# endif
+
+    OPT_SECTION(&quot;Action&quot;),
     {&quot;add&quot;, OPT_ADD, '-', &quot;Add a user and srp verifier&quot;},
-    {&quot;modify&quot;, OPT_MODIFY, '-',
-     &quot;Modify the srp verifier of an existing user&quot;},
+    {&quot;modify&quot;, OPT_MODIFY, '-', &quot;Modify the srp verifier of an existing user&quot;},
     {&quot;delete&quot;, OPT_DELETE, '-', &quot;Delete user from verifier file&quot;},
     {&quot;list&quot;, OPT_LIST, '-', &quot;List users&quot;},
+
+    OPT_SECTION(&quot;Configuration&quot;),
+    {&quot;srpvfile&quot;, OPT_SRPVFILE, '&lt;', &quot;The srp verifier file name&quot;},
     {&quot;gn&quot;, OPT_GN, 's', &quot;Set g and N values to be used for new verifier&quot;},
     {&quot;userinfo&quot;, OPT_USERINFO, 's', &quot;Additional info to be set for user&quot;},
     {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
     {&quot;passout&quot;, OPT_PASSOUT, 's', &quot;Output file pass phrase source&quot;},
+
     OPT_R_OPTIONS,
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-# endif
     {NULL}
 };
 
diff --git a/apps/storeutl.c b/apps/storeutl.c
index f557f4d3ed..980120a39d 100644
--- a/apps/storeutl.c
+++ b/apps/storeutl.c
@@ -31,12 +31,16 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS storeutl_options[] = {
-    {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] uri\nValid options are:\n&quot;},
+    {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] uri\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file - default stdout&quot;},
-    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
-    {&quot;text&quot;, OPT_TEXT, '-', &quot;Print a text form of the objects&quot;},
-    {&quot;noout&quot;, OPT_NOOUT, '-', &quot;No PEM output, just status&quot;},
+    {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#endif
+
+    OPT_SECTION(&quot;Search&quot;),
     {&quot;certs&quot;, OPT_SEARCHFOR_CERTS, '-', &quot;Search for certificates only&quot;},
     {&quot;keys&quot;, OPT_SEARCHFOR_KEYS, '-', &quot;Search for keys only&quot;},
     {&quot;crls&quot;, OPT_SEARCHFOR_CRLS, '-', &quot;Search for CRLs only&quot;},
@@ -45,11 +49,15 @@ const OPTIONS storeutl_options[] = {
     {&quot;serial&quot;, OPT_CRITERION_SERIAL, 's', &quot;Search by issuer and serial, serial number&quot;},
     {&quot;fingerprint&quot;, OPT_CRITERION_FINGERPRINT, 's', &quot;Search by public key fingerprint, given in hex&quot;},
     {&quot;alias&quot;, OPT_CRITERION_ALIAS, 's', &quot;Search by alias&quot;},
-    {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest&quot;},
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-#endif
     {&quot;r&quot;, OPT_RECURSIVE, '-', &quot;Recurse through names&quot;},
+
+    OPT_SECTION(&quot;Input&quot;),
+    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file - default stdout&quot;},
+    {&quot;text&quot;, OPT_TEXT, '-', &quot;Print a text form of the objects&quot;},
+    {&quot;noout&quot;, OPT_NOOUT, '-', &quot;No PEM output, just status&quot;},
     {NULL}
 };
 
diff --git a/apps/ts.c b/apps/ts.c
index 9fdba649c1..196e97b9b0 100644
--- a/apps/ts.c
+++ b/apps/ts.c
@@ -90,39 +90,43 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS ts_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
     {&quot;config&quot;, OPT_CONFIG, '&lt;', &quot;Configuration file&quot;},
     {&quot;section&quot;, OPT_SECTION, 's', &quot;Section to use within config file&quot;},
-    {&quot;query&quot;, OPT_QUERY, '-', &quot;Generate a TS query&quot;},
-    {&quot;data&quot;, OPT_DATA, '&lt;', &quot;File to hash&quot;},
-    {&quot;digest&quot;, OPT_DIGEST, 's', &quot;Digest (as a hex string)&quot;},
-    OPT_R_OPTIONS,
-    {&quot;tspolicy&quot;, OPT_TSPOLICY, 's', &quot;Policy OID to use&quot;},
-    {&quot;no_nonce&quot;, OPT_NO_NONCE, '-', &quot;Do not include a nonce&quot;},
-    {&quot;cert&quot;, OPT_CERT, '-', &quot;Put cert request into query&quot;},
-    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
-    {&quot;token_in&quot;, OPT_TOKEN_IN, '-', &quot;Input is a PKCS#7 file&quot;},
-    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
-    {&quot;token_out&quot;, OPT_TOKEN_OUT, '-', &quot;Output is a PKCS#7 file&quot;},
-    {&quot;text&quot;, OPT_TEXT, '-', &quot;Output text (not DER)&quot;},
-    {&quot;reply&quot;, OPT_REPLY, '-', &quot;Generate a TS reply&quot;},
-    {&quot;queryfile&quot;, OPT_QUERYFILE, '&lt;', &quot;File containing a TS query&quot;},
-    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
+# ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+# endif
     {&quot;inkey&quot;, OPT_INKEY, 's', &quot;File with private key for reply&quot;},
     {&quot;signer&quot;, OPT_SIGNER, 's', &quot;Signer certificate file&quot;},
     {&quot;chain&quot;, OPT_CHAIN, '&lt;', &quot;File with signer CA chain&quot;},
-    {&quot;verify&quot;, OPT_VERIFY, '-', &quot;Verify a TS response&quot;},
     {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;Path to trusted CA files&quot;},
     {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;File with trusted CA certs&quot;},
     {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;URI to trusted CA store&quot;},
     {&quot;untrusted&quot;, OPT_UNTRUSTED, '&lt;', &quot;File with untrusted certs&quot;},
+    {&quot;token_in&quot;, OPT_TOKEN_IN, '-', &quot;Input is a PKCS#7 file&quot;},
+    {&quot;token_out&quot;, OPT_TOKEN_OUT, '-', &quot;Output is a PKCS#7 file&quot;},
+    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Input file pass phrase source&quot;},
     {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest&quot;},
-# ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-# endif
-    {OPT_HELP_STR, 1, '-', &quot;\nOptions specific to 'ts -verify': \n&quot;},
+
+    OPT_SECTION(&quot;Query&quot;),
+    {&quot;query&quot;, OPT_QUERY, '-', &quot;Generate a TS query&quot;},
+    {&quot;data&quot;, OPT_DATA, '&lt;', &quot;File to hash&quot;},
+    {&quot;digest&quot;, OPT_DIGEST, 's', &quot;Digest (as a hex string)&quot;},
+    {&quot;queryfile&quot;, OPT_QUERYFILE, '&lt;', &quot;File containing a TS query&quot;},
+    {&quot;cert&quot;, OPT_CERT, '-', &quot;Put cert request into query&quot;},
+    {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file&quot;},
+
+    OPT_SECTION(&quot;Verify&quot;),
+    {&quot;verify&quot;, OPT_VERIFY, '-', &quot;Verify a TS response&quot;},
+    {&quot;reply&quot;, OPT_REPLY, '-', &quot;Generate a TS reply&quot;},
+    {&quot;tspolicy&quot;, OPT_TSPOLICY, 's', &quot;Policy OID to use&quot;},
+    {&quot;no_nonce&quot;, OPT_NO_NONCE, '-', &quot;Do not include a nonce&quot;},
+    {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file&quot;},
+    {&quot;text&quot;, OPT_TEXT, '-', &quot;Output text (not DER)&quot;},
+
+    OPT_R_OPTIONS,
     OPT_V_OPTIONS,
-    {OPT_HELP_STR, 1, '-', &quot;\n&quot;},
     {NULL}
 };
 
@@ -130,26 +134,26 @@ const OPTIONS ts_options[] = {
  * This command is so complex, special help is needed.
  */
 static char* opt_helplist[] = {
+    &quot;&quot;,
     &quot;Typical uses:&quot;,
-    &quot;ts -query [-rand file...] [-config file] [-data file]&quot;,
-    &quot;          [-digest hexstring] [-tspolicy oid] [-no_nonce] [-cert]&quot;,
-    &quot;          [-in file] [-out file] [-text]&quot;,
-    &quot;  or&quot;,
-    &quot;ts -reply [-config file] [-section tsa_section]&quot;,
-    &quot;          [-queryfile file] [-passin password]&quot;,
-    &quot;          [-signer tsa_cert.pem] [-inkey private_key.pem]&quot;,
-    &quot;          [-chain certs_file.pem] [-tspolicy oid]&quot;,
-    &quot;          [-in file] [-token_in] [-out file] [-token_out]&quot;,
+    &quot; openssl ts -query [-rand file...] [-config file] [-data file]&quot;,
+    &quot;    [-digest hexstring] [-tspolicy oid] [-no_nonce] [-cert]&quot;,
+    &quot;    [-in file] [-out file] [-text]&quot;,
+    &quot;&quot;,
+    &quot; openssl ts -reply [-config file] [-section tsa_section]&quot;,
+    &quot;    [-queryfile file] [-passin password]&quot;,
+    &quot;    [-signer tsa_cert.pem] [-inkey private_key.pem]&quot;,
+    &quot;    [-chain certs_file.pem] [-tspolicy oid]&quot;,
+    &quot;    [-in file] [-token_in] [-out file] [-token_out]&quot;,
 # ifndef OPENSSL_NO_ENGINE
-    &quot;          [-text] [-engine id]&quot;,
+    &quot;    [-text] [-engine id]&quot;,
 # else
-    &quot;          [-text]&quot;,
+    &quot;    [-text]&quot;,
 # endif
-    &quot;  or&quot;,
-    &quot;ts -verify -CApath dir -CAfile file.pem -CAstore uri -untrusted file.pem&quot;,
-    &quot;           [-data file] [-digest hexstring]&quot;,
-    &quot;           [-queryfile file] -in file [-token_in]&quot;,
-    &quot;           [[options specific to 'ts -verify']]&quot;,
+    &quot;&quot;,
+    &quot; openssl ts -verify -CApath dir -CAfile file.pem -CAstore uri&quot;,
+    &quot;   -untrusted file.pem [-data file] [-digest hexstring]&quot;,
+    &quot;    [-queryfile file] -in file [-token_in] ...&quot;,
     NULL,
 };
 
diff --git a/apps/verify.c b/apps/verify.c
index 7b18de2bab..bb8f84c84d 100644
--- a/apps/verify.c
+++ b/apps/verify.c
@@ -36,10 +36,17 @@ typedef enum OPTION_choice {
 
 const OPTIONS verify_options[] = {
     {OPT_HELP_STR, 1, '-', &quot;Usage: %s [options] cert.pem...\n&quot;},
-    {OPT_HELP_STR, 1, '-', &quot;Valid options are:\n&quot;},
+
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#endif
     {&quot;verbose&quot;, OPT_VERBOSE, '-',
         &quot;Print extra information about the operations being performed.&quot;},
+    {&quot;nameopt&quot;, OPT_NAMEOPT, 's', &quot;Various certificate name options&quot;},
+
+    OPT_SECTION(&quot;Certificate chain&quot;),
     {&quot;CApath&quot;, OPT_CAPATH, '/', &quot;A directory of trusted certificates&quot;},
     {&quot;CAfile&quot;, OPT_CAFILE, '&lt;', &quot;A file of trusted certificates&quot;},
     {&quot;CAstore&quot;, OPT_CASTORE, ':', &quot;URI to a store of trusted certificates&quot;},
@@ -57,11 +64,8 @@ const OPTIONS verify_options[] = {
         &quot;Attempt to download CRL information for this certificate&quot;},
     {&quot;show_chain&quot;, OPT_SHOW_CHAIN, '-',
         &quot;Display information about the certificate chain&quot;},
-    {&quot;nameopt&quot;, OPT_NAMEOPT, 's', &quot;Various certificate name options&quot;},
+
     OPT_V_OPTIONS,
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-#endif
 #ifndef OPENSSL_NO_SM2
     {&quot;sm2-id&quot;, OPT_SM2ID, 's',
      &quot;Specify an ID string to verify an SM2 certificate&quot;},
diff --git a/apps/version.c b/apps/version.c
index 7350ccf78f..2b06f9221b 100644
--- a/apps/version.c
+++ b/apps/version.c
@@ -37,7 +37,10 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS version_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;a&quot;, OPT_A, '-', &quot;Show all data&quot;},
     {&quot;b&quot;, OPT_B, '-', &quot;Show build date&quot;},
     {&quot;d&quot;, OPT_D, '-', &quot;Show configuration directory&quot;},
diff --git a/apps/x509.c b/apps/x509.c
index 3a5d561293..b4ef74c0cf 100644
--- a/apps/x509.c
+++ b/apps/x509.c
@@ -65,15 +65,23 @@ typedef enum OPTION_choice {
 } OPTION_CHOICE;
 
 const OPTIONS x509_options[] = {
+    OPT_SECTION(&quot;General&quot;),
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
+#ifndef OPENSSL_NO_ENGINE
+    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
+#endif
+
     {&quot;inform&quot;, OPT_INFORM, 'f',
      &quot;Input format - default PEM (one of DER or PEM)&quot;},
     {&quot;in&quot;, OPT_IN, '&lt;', &quot;Input file - default stdin&quot;},
+    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Private key password/pass-phrase source&quot;},
     {&quot;outform&quot;, OPT_OUTFORM, 'f',
      &quot;Output format - default PEM (one of DER or PEM)&quot;},
     {&quot;out&quot;, OPT_OUT, '&gt;', &quot;Output file - default stdout&quot;},
     {&quot;keyform&quot;, OPT_KEYFORM, 'F', &quot;Private key format - default PEM&quot;},
-    {&quot;passin&quot;, OPT_PASSIN, 's', &quot;Private key password/pass-phrase source&quot;},
+    {&quot;req&quot;, OPT_REQ, '-', &quot;Input is a certificate request, sign and output&quot;},
+
+    OPT_SECTION(&quot;Output&quot;),
     {&quot;serial&quot;, OPT_SERIAL, '-', &quot;Print serial number value&quot;},
     {&quot;subject_hash&quot;, OPT_HASH, '-', &quot;Print subject hash value&quot;},
     {&quot;issuer_hash&quot;, OPT_ISSUER_HASH, '-', &quot;Print issuer hash value&quot;},
@@ -81,21 +89,37 @@ const OPTIONS x509_options[] = {
     {&quot;subject&quot;, OPT_SUBJECT, '-', &quot;Print subject DN&quot;},
     {&quot;issuer&quot;, OPT_ISSUER, '-', &quot;Print issuer DN&quot;},
     {&quot;email&quot;, OPT_EMAIL, '-', &quot;Print email address(es)&quot;},
-    {&quot;startdate&quot;, OPT_STARTDATE, '-', &quot;Set notBefore field&quot;},
-    {&quot;enddate&quot;, OPT_ENDDATE, '-', &quot;Set notAfter field&quot;},
     {&quot;purpose&quot;, OPT_PURPOSE, '-', &quot;Print out certificate purposes&quot;},
-    {&quot;dates&quot;, OPT_DATES, '-', &quot;Both Before and After dates&quot;},
     {&quot;modulus&quot;, OPT_MODULUS, '-', &quot;Print the RSA key modulus&quot;},
     {&quot;pubkey&quot;, OPT_PUBKEY, '-', &quot;Output the public key&quot;},
-    {&quot;fingerprint&quot;, OPT_FINGERPRINT, '-',
-     &quot;Print the certificate fingerprint&quot;},
+    {&quot;fingerprint&quot;, OPT_FINGERPRINT, '-', &quot;Print the certificate fingerprint&quot;},
     {&quot;alias&quot;, OPT_ALIAS, '-', &quot;Output certificate alias&quot;},
     {&quot;noout&quot;, OPT_NOOUT, '-', &quot;No output, just status&quot;},
-    {&quot;nocert&quot;, OPT_NOCERT, '-', &quot;No certificate output&quot;},
     {&quot;ocspid&quot;, OPT_OCSPID, '-',
      &quot;Print OCSP hash values for the subject name and public key&quot;},
     {&quot;ocsp_uri&quot;, OPT_OCSP_URI, '-', &quot;Print OCSP Responder URL(s)&quot;},
+    {&quot;nocert&quot;, OPT_NOCERT, '-', &quot;No certificate output&quot;},
     {&quot;trustout&quot;, OPT_TRUSTOUT, '-', &quot;Output a trusted certificate&quot;},
+    {&quot;x509toreq&quot;, OPT_X509TOREQ, '-',
+     &quot;Output a certification request object&quot;},
+    {&quot;checkend&quot;, OPT_CHECKEND, 'M',
+     &quot;Check whether the cert expires in the next arg seconds&quot;},
+    {OPT_MORE_STR, 1, 1, &quot;Exit 1 if so, 0 if not&quot;},
+    {&quot;text&quot;, OPT_TEXT, '-', &quot;Print the certificate in text form&quot;},
+    {&quot;ext&quot;, OPT_EXT, 's', &quot;Print various X509V3 extensions&quot;},
+    {&quot;C&quot;, OPT_C, '-', &quot;Print out C code forms&quot;},
+#ifndef OPENSSL_NO_MD5
+    {&quot;subject_hash_old&quot;, OPT_SUBJECT_HASH_OLD, '-',
+     &quot;Print old-style (MD5) issuer hash value&quot;},
+    {&quot;issuer_hash_old&quot;, OPT_ISSUER_HASH_OLD, '-',
+     &quot;Print old-style (MD5) subject hash value&quot;},
+#endif
+    {&quot;nameopt&quot;, OPT_NAMEOPT, 's', &quot;Various certificate name options&quot;},
+
+    OPT_SECTION(&quot;Certificate&quot;),
+    {&quot;startdate&quot;, OPT_STARTDATE, '-', &quot;Set notBefore field&quot;},
+    {&quot;enddate&quot;, OPT_ENDDATE, '-', &quot;Set notAfter field&quot;},
+    {&quot;dates&quot;, OPT_DATES, '-', &quot;Both Before and After dates&quot;},
     {&quot;clrtrust&quot;, OPT_CLRTRUST, '-', &quot;Clear all trusted purposes&quot;},
     {&quot;clrext&quot;, OPT_CLREXT, '-', &quot;Clear all certificate extensions&quot;},
     {&quot;addtrust&quot;, OPT_ADDTRUST, 's', &quot;Trust certificate for a given purpose&quot;},
@@ -104,51 +128,34 @@ const OPTIONS x509_options[] = {
     {&quot;setalias&quot;, OPT_SETALIAS, 's', &quot;Set certificate alias&quot;},
     {&quot;days&quot;, OPT_DAYS, 'n',
      &quot;How long till expiry of a signed certificate - def 30 days&quot;},
-    {&quot;checkend&quot;, OPT_CHECKEND, 'M',
-     &quot;Check whether the cert expires in the next arg seconds&quot;},
-    {OPT_MORE_STR, 1, 1, &quot;Exit 1 if so, 0 if not&quot;},
     {&quot;signkey&quot;, OPT_SIGNKEY, '&lt;', &quot;Self sign cert with arg&quot;},
-    {&quot;x509toreq&quot;, OPT_X509TOREQ, '-',
-     &quot;Output a certification request object&quot;},
-    {&quot;req&quot;, OPT_REQ, '-', &quot;Input is a certificate request, sign and output&quot;},
-    {&quot;CA&quot;, OPT_CA, '&lt;', &quot;Set the CA certificate, must be PEM format&quot;},
-    {&quot;CAkey&quot;, OPT_CAKEY, 's',
-     &quot;The CA key, must be PEM format; if not in CAfile&quot;},
-    {&quot;CAcreateserial&quot;, OPT_CACREATESERIAL, '-',
-     &quot;Create serial number file if it does not exist&quot;},
-    {&quot;CAserial&quot;, OPT_CASERIAL, 's', &quot;Serial file&quot;},
     {&quot;set_serial&quot;, OPT_SET_SERIAL, 's', &quot;Serial number to use&quot;},
-    {&quot;text&quot;, OPT_TEXT, '-', &quot;Print the certificate in text form&quot;},
-    {&quot;ext&quot;, OPT_EXT, 's', &quot;Print various X509V3 extensions&quot;},
-    {&quot;C&quot;, OPT_C, '-', &quot;Print out C code forms&quot;},
-    {&quot;extfile&quot;, OPT_EXTFILE, '&lt;', &quot;File with X509V3 extensions to add&quot;},
-    OPT_R_OPTIONS,
     {&quot;extensions&quot;, OPT_EXTENSIONS, 's', &quot;Section from config file to use&quot;},
-    {&quot;nameopt&quot;, OPT_NAMEOPT, 's', &quot;Various certificate name options&quot;},
     {&quot;certopt&quot;, OPT_CERTOPT, 's', &quot;Various certificate text options&quot;},
     {&quot;checkhost&quot;, OPT_CHECKHOST, 's', &quot;Check certificate matches host&quot;},
     {&quot;checkemail&quot;, OPT_CHECKEMAIL, 's', &quot;Check certificate matches email&quot;},
     {&quot;checkip&quot;, OPT_CHECKIP, 's', &quot;Check certificate matches ipaddr&quot;},
+    {&quot;force_pubkey&quot;, OPT_FORCE_PUBKEY, '&lt;', &quot;Force the key to put inside certificate&quot;},
+    {&quot;subj&quot;, OPT_SUBJ, 's', &quot;Set or override certificate subject (and issuer)&quot;},
+
+    OPT_SECTION(&quot;CA&quot;),
+    {&quot;CA&quot;, OPT_CA, '&lt;', &quot;Set the CA certificate, must be PEM format&quot;},
+    {&quot;CAkey&quot;, OPT_CAKEY, 's',
+     &quot;The CA key, must be PEM format; if not in CAfile&quot;},
+    {&quot;extfile&quot;, OPT_EXTFILE, '&lt;', &quot;File with X509V3 extensions to add&quot;},
+    OPT_R_OPTIONS,
     {&quot;CAform&quot;, OPT_CAFORM, 'F', &quot;CA format - default PEM&quot;},
     {&quot;CAkeyform&quot;, OPT_CAKEYFORM, 'f', &quot;CA key format - default PEM&quot;},
     {&quot;sigopt&quot;, OPT_SIGOPT, 's', &quot;Signature parameter in n:v form&quot;},
+    {&quot;CAcreateserial&quot;, OPT_CACREATESERIAL, '-',
+     &quot;Create serial number file if it does not exist&quot;},
+    {&quot;CAserial&quot;, OPT_CASERIAL, 's', &quot;Serial file&quot;},
     {&quot;new&quot;, OPT_NEW, '-', &quot;Generate a certificate from scratch&quot;},
-    {&quot;force_pubkey&quot;, OPT_FORCE_PUBKEY, '&lt;', &quot;Force the key to put inside certificate&quot;},
-    {&quot;subj&quot;, OPT_SUBJ, 's', &quot;Set or override certificate subject (and issuer)&quot;},
     {&quot;next_serial&quot;, OPT_NEXT_SERIAL, '-', &quot;Increment current certificate serial number&quot;},
     {&quot;clrreject&quot;, OPT_CLRREJECT, '-',
      &quot;Clears all the prohibited or rejected uses of the certificate&quot;},
     {&quot;badsig&quot;, OPT_BADSIG, '-', &quot;Corrupt last byte of certificate signature (for test)&quot;},
     {&quot;&quot;, OPT_MD, '-', &quot;Any supported digest&quot;},
-#ifndef OPENSSL_NO_MD5
-    {&quot;subject_hash_old&quot;, OPT_SUBJECT_HASH_OLD, '-',
-     &quot;Print old-style (MD5) issuer hash value&quot;},
-    {&quot;issuer_hash_old&quot;, OPT_ISSUER_HASH_OLD, '-',
-     &quot;Print old-style (MD5) subject hash value&quot;},
-#endif
-#ifndef OPENSSL_NO_ENGINE
-    {&quot;engine&quot;, OPT_ENGINE, 's', &quot;Use engine, possibly a hardware device&quot;},
-#endif
     {&quot;preserve_dates&quot;, OPT_PRESERVE_DATES, '-', &quot;preserve existing dates when signing&quot;},
     {NULL}
 };
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026023.html">[openssl]  master update
</A></li>
	<LI>Next message: <A HREF="026032.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26030">[ date ]</a>
              <a href="thread.html#26030">[ thread ]</a>
              <a href="subject.html#26030">[ subject ]</a>
              <a href="author.html#26030">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
