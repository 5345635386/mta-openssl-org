<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2016-March/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1456942547.238935.25191.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004815.html">
   <LINK REL="Next"  HREF="004822.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Richard Levitte</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1456942547.238935.25191.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">levitte at openssl.org
       </A><BR>
    <I>Wed Mar  2 18:15:47 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="004815.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="004822.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4818">[ date ]</a>
              <a href="thread.html#4818">[ thread ]</a>
              <a href="subject.html#4818">[ subject ]</a>
              <a href="author.html#4818">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  2ad9ef06a6aadeeb78a05ce18ace0ea5f300401b (commit)
       via  2952b9b8115bdd852fb226e918f8b6d6a4a0bea2 (commit)
       via  9c62a279fecc4ccb95ea55e1ba36470f3eab8775 (commit)
       via  8864f0de7b491b4c7f724f58200d843700c82e98 (commit)
       via  940a09bad42c673b0dccd725ae590025c9749735 (commit)
       via  98fdbce09144a8addc6682a0ffd8ac92b2ce70b1 (commit)
       via  d2b2221a04053578911d34a45026543e4c39ce0c (commit)
       via  b0b92a5bb5b40e9ee7ca751b4d9218ed8726bda0 (commit)
      from  ed49f43a0390217e1c2df0054fb7352523be9a58 (commit)


- Log -----------------------------------------------------------------
commit 2ad9ef06a6aadeeb78a05ce18ace0ea5f300401b
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Sat Feb 27 17:14:44 2016 +0100

    Document the changes in config settings
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 2952b9b8115bdd852fb226e918f8b6d6a4a0bea2
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Wed Mar 2 10:57:05 2016 +0100

    Don't copy from %target to %config so much, see %config as a complement
    
    We copied $target{cflags}, $target{defines} and a few more to %config,
    just to add to the entries.  Avoid doing so, and let the build templates
    deal with combining the two.
    
    There are a few cases where we still fiddle with %target, but that's
    acceptable.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 9c62a279fecc4ccb95ea55e1ba36470f3eab8775
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Sat Feb 27 16:51:34 2016 +0100

    Configure - Get rid of the special thread_cflag, replace with thread_scheme
    
    The thread_cflag setting filled a double role, as kinda sorta an
    indicator of thread scheme, and as cflags.  Some configs also added
    lflags and ex_libs for multithreading regardless of if threading would
    be enabled or not.
    
    Instead of this, add threading cflags among in the cflag setting,
    threading lflags in the lflag setting and so on if and only if threads
    are enabled (which they are by default).
    
    Also, for configs where there are no special cflags for threading (the
    VMS configs are of that kind), this makes it possible to still clearly
    mention what thread scheme is used.
    
    The exact value of thread scheme is currently ignored except when it's
    &quot;(unknown)&quot;, and thereby only serves as a flag to tell if we know how
    to build for multi-threading in a particular config.  Yet, the
    currently used values are &quot;(unknown)&quot;, &quot;pthreads&quot;, &quot;uithreads&quot; (a.k.a
    solaris threads) and &quot;winthreads&quot;.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 8864f0de7b491b4c7f724f58200d843700c82e98
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Wed Mar 2 19:13:26 2016 +0100

    Configure - get rid of the special debug_ and release_ settings
    
    Instead, make the build type (&quot;debug&quot; or &quot;release&quot;) available through
    $config{build_type} and let the configs themselves figure out what the
    usual settings (such as &quot;cflags&quot;, &quot;lflags&quot; and so on) should be
    accordingly.
    
    The benefit with this is that we can now have debug and release
    variants of any setting, not just those Configure supports, and may
    also involve other factors (the MSVC flags /MD[d] and /MT[d] involve
    both build type and whether threading is enabled or not)
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 940a09bad42c673b0dccd725ae590025c9749735
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Sat Feb 27 11:42:13 2016 +0100

    Minimize copied config settings
    
    $target{lflags} and $target{plib_flag} were copied to %config for no
    good reason.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 98fdbce09144a8addc6682a0ffd8ac92b2ce70b1
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Sat Feb 27 11:37:33 2016 +0100

    Configure - move the addition of the zlib / libz lib to configs
    
    Configure had the Unix centric addition of -lz when linking with zlib
    is enabled, which doesn't work on other platforms.  Therefore, we move
    it to the BASE_unix config template and add corresponding ones in the
    other BASE_* config templates.  The Windows one is probably incomplete,
    but that doesn't matter for the moment, as mk1mf does it's own thing
    anyway.
    
    This required making the %withargs table global, so perl snippets in
    the configs can use it.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit d2b2221a04053578911d34a45026543e4c39ce0c
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Sat Feb 27 11:25:33 2016 +0100

    Configure - Rename BASE to DEFAULTS and add a few inheritable BASEs
    
    These BASE templates are intended to hold values that are common for
    all configuration variants for whole families of configurations.
    
    So far, three &quot;families&quot; are identified: Unix, Windows and VMS, mostly
    characterised by the build system they currently use.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit b0b92a5bb5b40e9ee7ca751b4d9218ed8726bda0
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Sat Feb 27 11:08:21 2016 +0100

    Configure - Allow CODErefs and ARRAYrefs in configuration setting arrays
    
    This provides for more powerful lazy evaluation and buildup of the
    setting contents.  For example, something like this becomes possible:
    
        defines =&gt; [ sub { $config{thisorthat} ? &quot;FOO&quot; : () } ]
    
    Any undefined result of such functions (such as 'undef' or the empty
    list) will be ignored.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

-----------------------------------------------------------------------

Summary of changes:
 Configurations/00-base-templates.conf   |  84 +++-
 Configurations/10-main.conf             | 690 ++++++++++++++++++--------------
 Configurations/90-team.conf             |  65 +--
 Configurations/99-personal-ben.conf     |  34 +-
 Configurations/99-personal-bodo.conf    |   7 +-
 Configurations/99-personal-geoff.conf   |  14 +-
 Configurations/99-personal-levitte.conf |  16 +-
 Configurations/99-personal-rse.conf     |   2 +-
 Configurations/99-personal-steve.conf   |  21 +-
 Configurations/README                   |  37 +-
 Configurations/descrip.mms.tmpl         |   6 +-
 Configurations/unix-Makefile.tmpl       |  10 +-
 Configure                               | 247 ++++++------
 Makefile.in                             |   6 +-
 14 files changed, 707 insertions(+), 532 deletions(-)

diff --git a/Configurations/00-base-templates.conf b/Configurations/00-base-templates.conf
index 4251a6c..cf50785 100644
--- a/Configurations/00-base-templates.conf
+++ b/Configurations/00-base-templates.conf
@@ -1,15 +1,11 @@
 # -*- Mode: perl -*-
 %targets=(
-    BASE =&gt; {
+    DEFAULTS =&gt; {
 	template	=&gt; 1,
 
 	cflags		=&gt; &quot;&quot;,
 	defines		=&gt; [],
-	debug_cflags	=&gt; &quot;&quot;,
-	debug_defines	=&gt; [],
-	release_cflags	=&gt; &quot;&quot;,
-	release_defines =&gt; [],
-	thread_cflags	=&gt; &quot;&quot;,
+	thread_scheme	=&gt; &quot;(unknown)&quot;, # Assume we don't know
 	thread_defines	=&gt; [],
 
 	apps_aux_src	=&gt; &quot;&quot;,
@@ -39,8 +35,82 @@
 	shared_ldflag	=&gt; &quot;&quot;,
 	shared_rcflag	=&gt; &quot;&quot;,
 	shared_extension	=&gt; &quot;&quot;,
+
 	build_scheme	=&gt; &quot;unixmake&quot;,
-	build_file      =&gt; &quot;Makefile&quot;,
+	build_file	=&gt; &quot;Makefile&quot;,
+    },
+
+    BASE_common =&gt; {
+	template	=&gt; 1,
+	defines		=&gt;
+	    [ sub {
+		unless ($disabled{zlib}) {
+		    if (defined($disabled{&quot;zlib-dynamic&quot;})) {
+			return &quot;ZLIB&quot;;
+		    } else {
+			return &quot;ZLIB_SHARED&quot;;
+		    }
+		}
+		return (); }
+	    ],
+    },
+
+    BASE_unix =&gt; {
+        inherit_from    =&gt; [ &quot;BASE_common&quot; ],
+        template        =&gt; 1,
+
+        ex_libs         =&gt;
+            sub {
+                unless ($disabled{zlib}) {
+                    if (defined($disabled{&quot;zlib-dynamic&quot;})) {
+                        if (defined($withargs{zlib_lib})) {
+                            return &quot;-L&quot;.$withargs{zlib_lib}.&quot; -lz&quot;;
+                        } else {
+                            return &quot;-lz&quot;;
+                        }
+                    }
+                }
+                return (); },
+
+        build_scheme    =&gt; &quot;unixmake&quot;,
+        build_file      =&gt; &quot;Makefile&quot;,
+    },
+
+    BASE_Windows =&gt; {
+        inherit_from    =&gt; [ &quot;BASE_common&quot; ],
+        template        =&gt; 1,
+
+        ex_libs         =&gt;
+            sub {
+                unless ($disabled{zlib}) {
+                    if (defined($disabled{&quot;zlib-dynamic&quot;})) {
+                        return &quot;zlib1.lib&quot;;
+                    }
+                }
+                return (); },
+
+        build_scheme    =&gt; [ &quot;mk1mf&quot; ],
+    },
+
+    BASE_VMS =&gt; {
+        inherit_from    =&gt; [ &quot;BASE_common&quot; ],
+        template        =&gt; 1,
+
+        ex_libs          =&gt;
+            sub {
+                unless ($disabled{zlib}) {
+                    if (defined($disabled{&quot;zlib-dynamic&quot;})) {
+                        if (defined($withargs{zlib_lib})) {
+                            return $withargs{zlib_lib}.'GNV$LIBZSHR.EXE/SHARED'
+                        } else {
+                            return 'GNV$LIBZSHR/SHARE';
+                        }
+                    }
+                }
+                return (); },
+
+        build_file       =&gt; &quot;descrip.mms&quot;,
+        build_scheme     =&gt; [ &quot;unified&quot;, &quot;VMS&quot; ],
     },
 
     uplink_common =&gt; {
diff --git a/Configurations/10-main.conf b/Configurations/10-main.conf
index ecfbc9a..6fade98 100644
--- a/Configurations/10-main.conf
+++ b/Configurations/10-main.conf
@@ -1,30 +1,46 @@
 ## -*- mode: perl; -*-
 ## Standard openssl configuration targets.
 
+sub picker {
+    my %opts = @_;
+    return sub { add($opts{default} || (),
+                     $opts{$config{build_type}} || ())-&gt;(); }
+}
+
+sub threads {
+    my @flags = @_;
+    return sub { add($disabled{threads} ? () : @flags)-&gt;(); }
+}
+
+sub combine {
+    my @stuff = @_;
+    return sub { add(@stuff)-&gt;(); }
+}
+
 %targets = (
 
 #### Basic configs that should work on any 32-bit box
     &quot;gcc&quot; =&gt; {
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;&quot;,
-        debug_cflags     =&gt; &quot;-O0 -g&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        cflags           =&gt; picker(debug   =&gt; &quot;-O0 -g&quot;,
+                                   release =&gt; &quot;-O3&quot;),
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
     },
     &quot;cc&quot; =&gt; {
         cc               =&gt; &quot;cc&quot;,
         cflags           =&gt; &quot;-O&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
 
 #### VOS Configurations
     &quot;vos-gcc&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-Wall -DOPENSSL_SYS_VOS -D_POSIX_C_SOURCE=200112L -D_BSD -D_VOS_EXTENDED_NAMES -DB_ENDIAN&quot;,
-        debug_cflags     =&gt; &quot;-O0 -g -DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        cflags           =&gt; picker(default =&gt; &quot;-Wall -DOPENSSL_SYS_VOS -D_POSIX_C_SOURCE=200112L -D_BSD -D_VOS_EXTENDED_NAMES -DB_ENDIAN&quot;,
+                                   debug   =&gt; &quot;-O0 -g -DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG&quot;,
+                                   release =&gt; &quot;-O3&quot;),
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
         sys_id           =&gt; &quot;VOS&quot;,
         lflags           =&gt; &quot;-Wl,-map&quot;,
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
@@ -33,10 +49,12 @@
 
 #### Solaris configurations
     &quot;solaris-common&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         template         =&gt; 1,
         cflags           =&gt; &quot;-DFILIO_H&quot;,
-        ex_libs          =&gt; &quot;-lresolv -lsocket -lnsl -ldl&quot;,
+        ex_libs          =&gt; add(&quot;-lresolv -lsocket -lnsl -ldl&quot;),
         dso_scheme       =&gt; &quot;dlfcn&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         shared_target    =&gt; &quot;solaris-shared&quot;,
         shared_extension =&gt; &quot;.so.\$(SHLIB_MAJOR).\$(SHLIB_MINOR)&quot;,
     },
@@ -49,10 +67,10 @@
         # with &quot;Illegal mnemonic&quot; error message.
         inherit_from     =&gt; [ &quot;solaris-common&quot;, asm(&quot;x86_elf_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; add_before(&quot;-Wall -DL_ENDIAN -DOPENSSL_NO_INLINE_ASM&quot;),
-        debug_cflags     =&gt; &quot;-O0 -g&quot;,
-        release_cflags   =&gt; &quot;-O3 -fomit-frame-pointer&quot;,
-        thread_cflag     =&gt; &quot;-pthread&quot;,
+        cflags           =&gt; add_before(picker(default =&gt; &quot;-Wall -DL_ENDIAN -DOPENSSL_NO_INLINE_ASM&quot;,
+                                              debug   =&gt; &quot;-O0 -g&quot;,
+                                              release =&gt; &quot;-O3 -fomit-frame-pointer&quot;),
+                                       threads(&quot;-pthread&quot;)),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
         shared_ldflag    =&gt; &quot;-shared&quot;,
@@ -68,10 +86,10 @@
         #					&lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at fy.chalmers.se</A>&gt;
         inherit_from     =&gt; [ &quot;solaris-common&quot;, asm(&quot;x86_64_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; add_before(&quot;-m64 -Wall -DL_ENDIAN&quot;),
-        debug_cflags     =&gt; &quot;-O0 -g&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;-pthread&quot;,
+        cflags           =&gt; add_before(picker(default =&gt; &quot;-m64 -Wall -DL_ENDIAN&quot;,
+                                              debug   =&gt; &quot;-O0 -g&quot;,
+                                              release =&gt; &quot;-O3&quot;),
+                                       threads(&quot;-pthread&quot;)),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -83,12 +101,12 @@
     &quot;solaris-x86-cc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;solaris-common&quot; ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; add_before(&quot;-xarch=generic -xstrconst -Xa -DL_ENDIAN&quot;),
-        debug_cflags     =&gt; &quot;-g&quot;,
-        release_cflags   =&gt; &quot;-xO5 -xregs=frameptr -xdepend -xbuiltin&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        lflags           =&gt; add(&quot;-mt&quot;),
-        ex_libs          =&gt; add(&quot;-lpthread&quot;),
+        cflags           =&gt; add_before(picker(default =&gt; &quot;-xarch=generic -xstrconst -Xa -DL_ENDIAN&quot;,
+                                              debug   =&gt; &quot;-g&quot;,
+                                              release =&gt; &quot;-xO5 -xregs=frameptr -xdepend -xbuiltin&quot;),
+                                       threads(&quot;-D_REENTRANT&quot;)),
+        lflags           =&gt; add(threads(&quot;-mt&quot;)),
+        ex_libs          =&gt; add(threads(&quot;-lpthread&quot;)),
         bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
         shared_cflag     =&gt; &quot;-KPIC&quot;,
         shared_ldflag    =&gt; &quot;-G -dy -z text&quot;,
@@ -96,12 +114,13 @@
     &quot;solaris64-x86_64-cc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;solaris-common&quot;, asm(&quot;x86_64_asm&quot;) ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; add_before(&quot;-xarch=generic64 -xstrconst -Xa -DL_ENDIAN&quot;),
-        debug_cflags     =&gt; &quot;-g&quot;,
-        release_cflags   =&gt; &quot;-xO5 -xdepend -xbuiltin&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        lflags           =&gt; add(&quot;-mt&quot;),
-        ex_libs          =&gt; add(&quot;-lpthread&quot;),
+        cflags           =&gt; add_before(picker(default =&gt; &quot;-xarch=generic64 -xstrconst -Xa -DL_ENDIAN&quot;,
+                                              debug   =&gt; &quot;-g&quot;,
+                                              release =&gt; &quot;-xO5 -xdepend -xbuiltin&quot;),
+                                       threads(&quot;-D_REENTRANT&quot;)),
+        thread_scheme    =&gt; &quot;pthreads&quot;,
+        lflags           =&gt; add(threads(&quot;-mt&quot;)),
+        ex_libs          =&gt; add(threads(&quot;-lpthread&quot;)),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         shared_cflag     =&gt; &quot;-KPIC&quot;,
@@ -113,10 +132,10 @@
     &quot;solaris-sparcv7-gcc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;solaris-common&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; add_before(&quot;-Wall -DB_ENDIAN -DBN_DIV2W&quot;),
-        debug_cflags     =&gt; &quot;-O0 -g&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;-pthread&quot;,
+        cflags           =&gt; add_before(picker(default =&gt; &quot;-Wall -DB_ENDIAN -DBN_DIV2W&quot;,
+                                              debug   =&gt; &quot;-O0 -g&quot;,
+                                              release =&gt; &quot;-O3&quot;),
+                                       threads(&quot;-pthread&quot;)),
         bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
         shared_ldflag    =&gt; &quot;-shared&quot;,
@@ -129,8 +148,8 @@
         # -m32 should be safe to add as long as driver recognizes
         # -mcpu=ultrasparc
         inherit_from     =&gt; [ &quot;solaris-sparcv7-gcc&quot;, asm(&quot;sparcv9_asm&quot;) ],
-        cflags           =&gt; add_before(&quot;-m32 -mcpu=ultrasparc&quot;),
-        debug_cflags     =&gt; &quot;-DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG -DPEDANTIC -O -g -pedantic -ansi -Wshadow -Wno-long-long -D__EXTENSIONS__&quot;,
+        cflags           =&gt; add_before(picker(default =&gt; &quot;-m32 -mcpu=ultrasparc&quot;,
+                                              debug   =&gt; &quot;-DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG -DPEDANTIC -O -g -pedantic -ansi -Wshadow -Wno-long-long -D__EXTENSIONS__&quot;)),
     },
     &quot;solaris64-sparcv9-gcc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;solaris-sparcv9-gcc&quot; ],
@@ -147,12 +166,12 @@
     &quot;solaris-sparcv7-cc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;solaris-common&quot; ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; add_before(&quot;-xstrconst -Xa -DB_ENDIAN -DBN_DIV2W&quot;),
-        debug_cflags     =&gt; &quot;-g -DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG&quot;,
-        release_cflags   =&gt; &quot;-xO5 -xdepend&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        lflags           =&gt; add(&quot;-mt&quot;),
-        ex_libs          =&gt; add(&quot;-lpthread&quot;),
+        cflags           =&gt; add_before(picker(default =&gt; &quot;-xstrconst -Xa -DB_ENDIAN -DBN_DIV2W&quot;,
+                                              debug   =&gt; &quot;-g -DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG&quot;,
+                                              release =&gt; &quot;-xO5 -xdepend&quot;),
+                                       threads(&quot;-D_REENTRANT&quot;)),
+        lflags           =&gt; add(threads(&quot;-mt&quot;)),
+        ex_libs          =&gt; add(threads(&quot;-lpthread&quot;)),
         bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
         shared_cflag     =&gt; &quot;-KPIC&quot;,
         shared_ldflag    =&gt; &quot;-G -dy -z text&quot;,
@@ -177,26 +196,26 @@
 #### IRIX 5.x configs
 # -mips2 flag is added by ./config when appropriate.
     &quot;irix-gcc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;mips32_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;mips32_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DB_ENDIAN&quot;,
-        debug_cflags     =&gt; &quot;-g -O0&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        cflags           =&gt; picker(default =&gt; &quot;-DB_ENDIAN&quot;,
+                                   debug   =&gt; &quot;-g -O0&quot;,
+                                   release =&gt; &quot;-O3&quot;),
         bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
         perlasm_scheme   =&gt; &quot;o32&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;irix-shared&quot;,
         shared_extension =&gt; &quot;.so.\$(SHLIB_MAJOR).\$(SHLIB_MINOR)&quot;,
     },
     &quot;irix-cc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;mips32_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;mips32_asm&quot;) ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;-use_readonly_const -DB_ENDIAN&quot;,
-        debug_cflags     =&gt; &quot;-g -O0&quot;,
-        release_cflags   =&gt; &quot;-O2&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        cflags           =&gt; picker(default =&gt; &quot;-use_readonly_const -DB_ENDIAN&quot;,
+                                   debug   =&gt; &quot;-g -O0&quot;,
+                                   release =&gt; &quot;-O2&quot;),
         bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
         perlasm_scheme   =&gt; &quot;o32&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;irix-shared&quot;,
@@ -206,13 +225,14 @@
 # Only N32 and N64 ABIs are supported. If you need O32 ABI build, invoke
 # './Configure irix-cc -o32' manually.
     &quot;irix-mips3-gcc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;mips64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;mips64_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-mabi=n32 -DB_ENDIAN -DBN_DIV3W&quot;,
-        debug_cflags     =&gt; &quot;-g -O0&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;-D_SGI_MP_SOURCE -pthread&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-mabi=n32 -DB_ENDIAN -DBN_DIV3W&quot;,
+                                           debug   =&gt; &quot;-g -O0&quot;,
+                                           release =&gt; &quot;-O3&quot;),
+                                    threads(&quot;-D_SGI_MP_SOURCE -pthread&quot;)),
         bn_ops           =&gt; &quot;RC4_CHAR SIXTY_FOUR_BIT&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;n32&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;irix-shared&quot;,
@@ -221,14 +241,15 @@
         multilib         =&gt; &quot;32&quot;,
     },
     &quot;irix-mips3-cc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;mips64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;mips64_asm&quot;) ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;-n32 -mips3 -use_readonly_const -G0 -rdata_shared -DB_ENDIAN -DBN_DIV3W&quot;,
-        debug_cflags     =&gt; &quot;-g -O0&quot;,
-        release_cflags   =&gt; &quot;-O2&quot;,
-        thread_cflag     =&gt; &quot;-D_SGI_MP_SOURCE&quot;,
-        ex_libs          =&gt; &quot;-lpthread&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-n32 -mips3 -use_readonly_const -G0 -rdata_shared -DB_ENDIAN -DBN_DIV3W&quot;,
+                                           debug   =&gt; &quot;-g -O0&quot;,
+                                           release =&gt; &quot;-O2&quot;),
+                                    threads(&quot;-D_SGI_MP_SOURCE&quot;)),
+        ex_libs          =&gt; add(threads(&quot;-lpthread&quot;)),
         bn_ops           =&gt; &quot;RC4_CHAR SIXTY_FOUR_BIT&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;n32&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;irix-shared&quot;,
@@ -238,13 +259,14 @@
     },
     # N64 ABI builds.
     &quot;irix64-mips4-gcc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;mips64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;mips64_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-mabi=64 -mips4 -DB_ENDIAN -DBN_DIV3W&quot;,
-        debug_cflags     =&gt; &quot;-g -O0&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;-D_SGI_MP_SOURCE&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-mabi=64 -mips4 -DB_ENDIAN -DBN_DIV3W&quot;,
+                                           debug   =&gt; &quot;-g -O0&quot;,
+                                           release =&gt; &quot;-O3&quot;),
+                                    threads(&quot;-D_SGI_MP_SOURCE&quot;)),
         bn_ops           =&gt; &quot;RC4_CHAR SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;64&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;irix-shared&quot;,
@@ -253,14 +275,15 @@
         multilib         =&gt; &quot;64&quot;,
     },
     &quot;irix64-mips4-cc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;mips64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;mips64_asm&quot;) ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;-64 -mips4 -use_readonly_const -G0 -rdata_shared -DB_ENDIAN -DBN_DIV3W&quot;,
-        debug_cflags     =&gt; &quot;-g -O0&quot;,
-        release_cflags   =&gt; &quot;-O2&quot;,
-        thread_cflag     =&gt; &quot;-D_SGI_MP_SOURCE&quot;,
-        ex_libs          =&gt; &quot;-lpthread&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-64 -mips4 -use_readonly_const -G0 -rdata_shared -DB_ENDIAN -DBN_DIV3W&quot;,
+                                           debug   =&gt; &quot;-g -O0&quot;,
+                                           release =&gt; &quot;-O2&quot;),
+                                    threads(&quot;-D_SGI_MP_SOURCE&quot;)),
+        ex_libs          =&gt; add(threads(&quot;-lpthread&quot;)),
         bn_ops           =&gt; &quot;RC4_CHAR SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;64&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;irix-shared&quot;,
@@ -298,13 +321,15 @@
 #   provided. 
 #					&lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at fy.chalmers.se</A>&gt;
     &quot;hpux-parisc-gcc&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DB_ENDIAN -DBN_DIV2W&quot;,
-        debug_cflags     =&gt; &quot;-O0 -g&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;-pthread&quot;,
-        ex_libs          =&gt; &quot;-Wl,+s -ldld&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-DB_ENDIAN -DBN_DIV2W&quot;,
+                                           debug   =&gt; &quot;-O0 -g&quot;,
+                                           release =&gt; &quot;-O3&quot;),
+                                    threads(&quot;-pthread&quot;)),
+        ex_libs          =&gt; add(&quot;-Wl,+s -ldld&quot;),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dl&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -316,14 +341,15 @@
         multilib         =&gt; &quot;/pa1.1&quot;,
     },
     &quot;hpux64-parisc2-gcc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;parisc20_64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;parisc20_64_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DB_ENDIAN&quot;,
-        debug_cflags     =&gt; &quot;-O0 -g&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-DB_ENDIAN&quot;,
+                                           debug   =&gt; &quot;-O0 -g&quot;,
+                                           release =&gt; &quot;-O3&quot;),
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;-fpic&quot;,
@@ -337,13 +363,15 @@
     # Chris Ruemmler &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">ruemmler at cup.hp.com</A>&gt;
     # Kevin Steves &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">ks at hp.se</A>&gt;
     &quot;hpux-parisc-cc&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;+Optrs_strongly_typed -Ae +ESlit -DB_ENDIAN -DBN_DIV2W -DMD32_XARRAY&quot;,
-        debug_cflags      =&gt; &quot;+O0 +d -g&quot;,
-        release_cflags   =&gt; &quot;+O3&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-Wl,+s -ldld -lpthread&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;+Optrs_strongly_typed -Ae +ESlit -DB_ENDIAN -DBN_DIV2W -DMD32_XARRAY&quot;,
+                                           debug   =&gt; &quot;+O0 +d -g&quot;,
+                                           release =&gt; &quot;+O3&quot;),
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot;-Wl,+s -ldld&quot;,threads(&quot;-lpthread&quot;)),
         bn_ops           =&gt; &quot;RC4_CHAR&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dl&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;+Z&quot;,
@@ -356,14 +384,15 @@
         multilib         =&gt; &quot;/pa1.1&quot;,
     },
     &quot;hpux64-parisc2-cc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;parisc20_64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;parisc20_64_asm&quot;) ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;+DD64 +Optrs_strongly_typed -Ae +ESlit -DB_ENDIAN -DMD32_XARRAY&quot;,
-        debug_cflags      =&gt; &quot;+O0 +d -g&quot;,
-        release_cflags   =&gt; &quot;+O3&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-ldl -lpthread&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;+DD64 +Optrs_strongly_typed -Ae +ESlit -DB_ENDIAN -DMD32_XARRAY&quot;,
+                                           debug   =&gt; &quot;+O0 +d -g&quot;,
+                                           release =&gt; &quot;+O3&quot;),
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot;-ldl&quot;,threads(&quot;-lpthread&quot;)),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;+Z&quot;,
@@ -374,14 +403,15 @@
 
     # HP/UX IA-64 targets
     &quot;hpux-ia64-cc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;ia64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;ia64_asm&quot;) ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;-Ae +DD32 +Olit=all -z -DB_ENDIAN&quot;,
-        debug_cflags     =&gt; &quot;+O0 +d -g&quot;,
-        release_cflags   =&gt; &quot;+O2&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-ldl -lpthread&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-Ae +DD32 +Olit=all -z -DB_ENDIAN&quot;,
+                                           debug   =&gt; &quot;+O0 +d -g&quot;,
+                                           release =&gt; &quot;+O2&quot;),
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot;-ldl&quot;,threads(&quot;-lpthread&quot;)),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;+Z&quot;,
@@ -392,14 +422,15 @@
     # Frank Geurts &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">frank.geurts at nl.abnamro.com</A>&gt; has patiently assisted
     # with debugging of the following config.
     &quot;hpux64-ia64-cc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;ia64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;ia64_asm&quot;) ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;-Ae +DD64 +Olit=all -z -DB_ENDIAN&quot;,
-        debug_cflags     =&gt; &quot;+O0 +d -g&quot;,
-        release_cflags   =&gt; &quot;+O3&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-ldl -lpthread&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-Ae +DD64 +Olit=all -z -DB_ENDIAN&quot;,
+                                           debug   =&gt; &quot;+O0 +d -g&quot;,
+                                           release =&gt; &quot;+O3&quot;),
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot;-ldl&quot;, threads(&quot;-lpthread&quot;)),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;+Z&quot;,
@@ -409,14 +440,15 @@
     },
     # GCC builds...
     &quot;hpux-ia64-gcc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;ia64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;ia64_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DB_ENDIAN&quot;,
-        debug_cflags     =&gt; &quot;-O0 -g&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;-pthread&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-DB_ENDIAN&quot;,
+                                           debug   =&gt; &quot;-O0 -g&quot;,
+                                           release =&gt; &quot;-O3&quot;),
+                                    threads(&quot;-pthread&quot;)),
+        ex_libs          =&gt; add(&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;-fpic&quot;,
@@ -425,14 +457,15 @@
         multilib         =&gt; &quot;/hpux32&quot;,
     },
     &quot;hpux64-ia64-gcc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;ia64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;ia64_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-mlp64 -DB_ENDIAN&quot;,
-        debug_cflags     =&gt; &quot;-O0 -g&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;-pthread&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; picker(default =&gt; &quot;-mlp64 -DB_ENDIAN&quot;,
+                                   debug   =&gt; &quot;-O0 -g&quot;,
+                                   release =&gt; &quot;-O3&quot;,
+                                   threads(&quot;-pthread&quot;)),
+        ex_libs          =&gt; add(&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;-fpic&quot;,
@@ -443,41 +476,43 @@
 
 #### HP MPE/iX <A HREF="http://jazz.external.hp.com/src/openssl/">http://jazz.external.hp.com/src/openssl/</A>
     &quot;MPE/iX-gcc&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;-D_ENDIAN -DBN_DIV2W -O3 -D_POSIX_SOURCE -D_SOCKET_SOURCE -I/SYSLOG/PUB&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
         sys_id           =&gt; &quot;MPE&quot;,
-        ex_libs          =&gt; &quot;-L/SYSLOG/PUB -lsyslog -lsocket -lcurses&quot;,
+        ex_libs          =&gt; add(&quot;-L/SYSLOG/PUB -lsyslog -lsocket -lcurses&quot;),
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
     },
 
 #### DEC Alpha OSF/1/Tru64 targets.
     &quot;osf1-alpha-gcc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;alpha_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;alpha_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;alpha-osf1-shared&quot;,
         shared_extension =&gt; &quot;.so&quot;,
     },
     &quot;osf1-alpha-cc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;alpha_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;alpha_asm&quot;) ],
         cc               =&gt; &quot;cc&quot;,
         cflags           =&gt; &quot;-std1 -tune host -O4 -readonly_strings&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;alpha-osf1-shared&quot;,
         shared_extension =&gt; &quot;.so&quot;,
     },
     &quot;tru64-alpha-cc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;alpha_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;alpha_asm&quot;) ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;-std1 -tune host -fast -readonly_strings&quot;,
-        thread_cflag     =&gt; &quot;-pthread&quot;,
+        cflags           =&gt; combine(&quot;-std1 -tune host -fast -readonly_strings&quot;,
+                                    threads(&quot;-pthread&quot;)),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;alpha-osf1-shared&quot;,
         shared_ldflag    =&gt; &quot;-msym&quot;,
@@ -490,13 +525,15 @@
 # *-generic* is endian-neutral target, but ./config is free to
 # throw in -D[BL]_ENDIAN, whichever appropriate...
     &quot;linux-generic32&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-Wall&quot;,
-        debug_cflags     =&gt; &quot;-O0 -g -DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;-pthread&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-Wall&quot;,
+                                           debug   =&gt; &quot;-O0 -g -DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG&quot;,
+                                           release =&gt; &quot;-O3&quot;),
+                                    threads(&quot;-pthread&quot;)),
+        ex_libs          =&gt; add(&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -513,14 +550,14 @@
     },
     &quot;linux-ppc64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic64&quot;, asm(&quot;ppc64_asm&quot;) ],
-        cflags           =&gt; &quot;-m64 -Wall -DB_ENDIAN&quot;,
+        cflags           =&gt; add(&quot;-m64 -DB_ENDIAN&quot;),
         perlasm_scheme   =&gt; &quot;linux64&quot;,
         shared_ldflag    =&gt; &quot;-m64&quot;,
         multilib         =&gt; &quot;64&quot;,
     },
     &quot;linux-ppc64le&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic64&quot;, asm(&quot;ppc64_asm&quot;) ],
-        cflags           =&gt; &quot;-m64 -Wall -DL_ENDIAN&quot;,
+        cflags           =&gt; add(&quot;-m64 -DL_ENDIAN&quot;),
         perlasm_scheme   =&gt; &quot;linux64le&quot;,
         shared_ldflag    =&gt; &quot;-m64&quot;,
     },
@@ -566,7 +603,7 @@
     },
     &quot;linux-arm64ilp32&quot; =&gt; {  # <A HREF="https://wiki.linaro.org/Platform/arm64-ilp32">https://wiki.linaro.org/Platform/arm64-ilp32</A>
         inherit_from     =&gt; [ &quot;linux-generic32&quot;, asm(&quot;aarch64_asm&quot;) ],
-        cflags           =&gt; &quot;-mabi=ilp32 -Wall&quot;,
+        cflags           =&gt; add(&quot;-mabi=ilp32&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT RC4_CHAR&quot;,
         perlasm_scheme   =&gt; &quot;linux64&quot;,
         shared_ldflag    =&gt; &quot;-mabi=ilp32&quot;,
@@ -576,7 +613,7 @@
         # Configure script adds minimally required -march for assembly
         # support, if no -march was specified at command line.
         inherit_from     =&gt; [ &quot;linux-generic32&quot;, asm(&quot;mips32_asm&quot;) ],
-        cflags           =&gt; &quot;-mabi=32 -Wall -DBN_DIV3W&quot;,
+        cflags           =&gt; add(&quot;-mabi=32 -DBN_DIV3W&quot;),
         perlasm_scheme   =&gt; &quot;o32&quot;,
         shared_ldflag    =&gt; &quot;-mabi=32&quot;,
     },
@@ -584,7 +621,7 @@
     # specifications, MIPS32 and MIPS64, rather than to kernel bitness.
     &quot;linux-mips64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic32&quot;, asm(&quot;mips64_asm&quot;) ],
-        cflags           =&gt; &quot;-mabi=n32 -Wall -DBN_DIV3W&quot;,
+        cflags           =&gt; add(&quot;-mabi=n32 -DBN_DIV3W&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT RC4_CHAR&quot;,
         perlasm_scheme   =&gt; &quot;n32&quot;,
         shared_ldflag    =&gt; &quot;-mabi=n32&quot;,
@@ -592,7 +629,7 @@
     },
     &quot;linux64-mips64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic64&quot;, asm(&quot;mips64_asm&quot;) ],
-        cflags           =&gt; &quot;-mabi=64 -O3 -Wall -DBN_DIV3W&quot;,
+        cflags           =&gt; add(&quot;-mabi=64 -DBN_DIV3W&quot;),
         perlasm_scheme   =&gt; &quot;64&quot;,
         shared_ldflag    =&gt; &quot;-mabi=64&quot;,
         multilib         =&gt; &quot;64&quot;,
@@ -601,27 +638,25 @@
     #### IA-32 targets...
     &quot;linux-elf&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic32&quot;, asm(&quot;x86_elf_asm&quot;) ],
-        cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DL_ENDIAN -Wall&quot;,
-        debug_cflags     =&gt; &quot;-O0 -g -DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG&quot;,
-        release_cflags   =&gt; &quot;-O3 -fomit-frame-pointer&quot;,
-        debug_ex_libs    =&gt; &quot;-lefence&quot;,
+        cflags           =&gt; add(picker(default =&gt; &quot;-DL_ENDIAN&quot;,
+                                       release =&gt; &quot;-fomit-frame-pointer&quot;)),
+        ex_libs          =&gt; add(picker(debug =&gt; &quot;-lefence&quot;)),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
     },
     &quot;linux-aout&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;x86_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DL_ENDIAN -Wall&quot;,
-        debug_cflags     =&gt; &quot;-O0 -g&quot;,
-        release_cflags   =&gt; &quot;-O3 -fomit-frame-pointer&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        cflags           =&gt; add(picker(default =&gt; &quot;-DL_ENDIAN -Wall&quot;,
+                                       debug   =&gt; &quot;-O0 -g&quot;,
+                                       release =&gt; &quot;-O3 -fomit-frame-pointer&quot;)),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
         perlasm_scheme   =&gt; &quot;a.out&quot;,
     },
 
     &quot;linux-x86_64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic64&quot;, asm(&quot;x86_64_asm&quot;) ],
-        cflags           =&gt; &quot;-m64 -DL_ENDIAN -Wall&quot;,
+        cflags           =&gt; add(&quot;-m64 -DL_ENDIAN&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         shared_ldflag    =&gt; &quot;-m64&quot;,
@@ -630,11 +665,11 @@
     &quot;linux-x86_64-clang&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-x86_64&quot; ],
         cc               =&gt; &quot;clang&quot;,
-        cflags           =&gt; &quot;-m64 -DL_ENDIAN -Wall -Wextra -Qunused-arguments&quot;,
+        cflags           =&gt; add(&quot;-Wextra -Qunused-arguments&quot;),
     },
     &quot;linux-x32&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic32&quot;, asm(&quot;x86_64_asm&quot;) ],
-        cflags           =&gt; &quot;-mx32 -DL_ENDIAN -Wall&quot;,
+        cflags           =&gt; add(&quot;-mx32 -DL_ENDIAN&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         shared_ldflag    =&gt; &quot;-mx32&quot;,
@@ -648,7 +683,7 @@
 
     &quot;linux64-s390x&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic64&quot;, asm(&quot;s390x_asm&quot;) ],
-        cflags           =&gt; &quot;-m64 -Wall -DB_ENDIAN&quot;,
+        cflags           =&gt; add(&quot;-m64 -DB_ENDIAN&quot;),
         perlasm_scheme   =&gt; &quot;64&quot;,
         shared_ldflag    =&gt; &quot;-m64&quot;,
         multilib         =&gt; &quot;64&quot;,
@@ -671,7 +706,7 @@
         # sysdeps/s390/dl-procinfo.c affecting ldconfig and ld.so.1...
         #
         inherit_from     =&gt; [ &quot;linux-generic32&quot;, asm(&quot;s390x_asm&quot;) ],
-        cflags           =&gt; &quot;-m31 -Wall -Wa,-mzarch -DB_ENDIAN&quot;,
+        cflags           =&gt; add(&quot;-m31 -Wa,-mzarch -DB_ENDIAN&quot;),
         bn_obj           =&gt; sub { my $r=join(&quot; &quot;<A HREF="../../../mailman/listinfo/openssl-commits.html">, at _</A>); $r=~s/bn\-s390x/bn_asm/; $r; },
         perlasm_scheme   =&gt; &quot;31&quot;,
         shared_ldflag    =&gt; &quot;-m31&quot;,
@@ -683,19 +718,19 @@
     # patiently assisted with debugging of following two configs.
     &quot;linux-sparcv8&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic32&quot;, asm(&quot;sparcv8_asm&quot;) ],
-        cflags           =&gt; &quot;-mcpu=v8 -Wall -DB_ENDIAN -DBN_DIV2W&quot;,
+        cflags           =&gt; add(&quot;-mcpu=v8 -DB_ENDIAN -DBN_DIV2W&quot;),
     },
     &quot;linux-sparcv9&quot; =&gt; {
         # it's a real mess with -mcpu=ultrasparc option under Linux,
         # but -Wa,-Av8plus should do the trick no matter what.
         inherit_from     =&gt; [ &quot;linux-generic32&quot;, asm(&quot;sparcv9_asm&quot;) ],
-        cflags           =&gt; &quot;-m32 -mcpu=ultrasparc -Wall -Wa,-Av8plus -DB_ENDIAN -DBN_DIV2W&quot;,
+        cflags           =&gt; add(&quot;-m32 -mcpu=ultrasparc -Wa,-Av8plus -DB_ENDIAN -DBN_DIV2W&quot;),
         shared_ldflag    =&gt; &quot;-m32&quot;,
     },
     &quot;linux64-sparcv9&quot; =&gt; {
         # GCC 3.1 is a requirement
         inherit_from     =&gt; [ &quot;linux-generic64&quot;, asm(&quot;sparcv9_asm&quot;) ],
-        cflags           =&gt; &quot;-m64 -mcpu=ultrasparc -Wall -DB_ENDIAN&quot;,
+        cflags           =&gt; add(&quot;-m64 -mcpu=ultrasparc -DB_ENDIAN&quot;),
         bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
         shared_ldflag    =&gt; &quot;-m64&quot;,
         multilib         =&gt; &quot;64&quot;,
@@ -703,14 +738,15 @@
 
     &quot;linux-alpha-gcc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic64&quot;, asm(&quot;alpha_asm&quot;) ],
-        cflags           =&gt; &quot;-DL_ENDIAN&quot;,
+        cflags           =&gt; add(&quot;-DL_ENDIAN&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
     },
     &quot;linux-c64xplus&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         # TI_CGT_C6000_7.3.x is a requirement
         cc               =&gt; &quot;cl6x&quot;,
-        cflags           =&gt; &quot;--linux -ea=.s -eo=.o -mv6400+ -o2 -ox -ms -pden -DOPENSSL_SMALL_FOOTPRINT&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
+        cflags           =&gt; combine(&quot;--linux -ea=.s -eo=.o -mv6400+ -o2 -ox -ms -pden -DOPENSSL_SMALL_FOOTPRINT&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
         cpuid_asm_src    =&gt; &quot;c64xpluscpuid.s&quot;,
         bn_asm_src       =&gt; &quot;asm/bn-c64xplus.asm c64xplus-gf2m.s&quot;,
@@ -720,6 +756,7 @@
         modes_asm_src    =&gt; &quot;ghash-c64xplus.s&quot;,
         chacha_asm_src   =&gt; &quot;chacha-c64xplus.s&quot;,
         poly1305_asm_src =&gt; &quot;poly1305-c64xplus.s&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;void&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
@@ -755,15 +792,15 @@
         # systems are perfectly capable of executing binaries targeting
         # Froyo. Keep in mind that in the nutshell Android builds are
         # about JNI, i.e. shared libraries, not applications.
-        cflags           =&gt; &quot;-mandroid -fPIC --sysroot=\$(CROSS_SYSROOT) -Wa,--noexecstack -Wall&quot;,
-        debug_cflags     =&gt; &quot;-O0 -g&quot;,
+        cflags           =&gt; picker(default =&gt; &quot;-mandroid -fPIC --sysroot=\$(CROSS_SYSROOT) -Wa,--noexecstack -Wall&quot;,
+                                   debug   =&gt; &quot;-O0 -g&quot;,
+                                   release =&gt; &quot;-O3&quot;),
         lflags           =&gt; &quot;-pie&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
         shared_cflag     =&gt; &quot;&quot;,
     },
     &quot;android-x86&quot; =&gt; {
         inherit_from     =&gt; [ &quot;android&quot;, asm(&quot;x86_asm&quot;) ],
-        release_cflags   =&gt; &quot;-O3 -fomit-frame-pointer&quot;,
+        cflags           =&gt; add(picker(release =&gt; &quot;-fomit-frame-pointer&quot;)),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
         perlasm_scheme   =&gt; &quot;android&quot;,
     },
@@ -798,10 +835,10 @@
 
     &quot;android64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic64&quot; ],
-        cflags           =&gt; &quot;-mandroid -fPIC --sysroot=\$(CROSS_SYSROOT) -Wa,--noexecstack -Wall&quot;,
-        debug_cflags     =&gt; &quot;-O0 -g&quot;,
+        cflags           =&gt; picker(default =&gt; &quot;-mandroid -fPIC --sysroot=\$(CROSS_SYSROOT) -Wa,--noexecstack -Wall&quot;,
+                                   debug   =&gt; &quot;-O0 -g&quot;,
+                                   release =&gt; &quot;-O3&quot;),
         lflags           =&gt; &quot;-pie&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
         shared_cflag     =&gt; &quot;&quot;,
     },
     &quot;android64-aarch64&quot; =&gt; {
@@ -811,19 +848,21 @@
 
 #### *BSD
     &quot;BSD-generic32&quot; =&gt; {
-        # As for thread_cflag. Idea is to maintain &quot;collective&quot; set of
+        # As for thread cflag. Idea is to maintain &quot;collective&quot; set of
         # flags, which would cover all BSD flavors. -pthread applies
         # to them all, but is treated differently. OpenBSD expands is
         # as -D_POSIX_THREAD -lc_r, which is sufficient. FreeBSD 4.x
         # expands it as -lc_r, which has to be accompanied by explicit
         # -D_THREAD_SAFE and sometimes -D_REENTRANT. FreeBSD 5.x
         # expands it as -lc_r, which seems to be sufficient?
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;-Wall&quot;,
-        debug_cflags     =&gt; &quot;-O0 -g&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;-pthread -D_THREAD_SAFE -D_REENTRANT&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-Wall&quot;,
+                                           debug   =&gt; &quot;-O0 -g&quot;,
+                                           release =&gt; &quot;-O3&quot;),
+                                    threads(&quot;-pthread -D_THREAD_SAFE -D_REENTRANT&quot;)),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -836,8 +875,8 @@
 
     &quot;BSD-x86&quot; =&gt; {
         inherit_from     =&gt; [ &quot;BSD-generic32&quot;, asm(&quot;x86_asm&quot;) ],
-        cflags           =&gt; &quot;-DL_ENDIAN -Wall&quot;,
-        release_cflags   =&gt; &quot;-O3 -fomit-frame-pointer&quot;,
+        cflags           =&gt; add(picker(default =&gt; &quot;-DL_ENDIAN&quot;,
+                                       release =&gt; &quot;-fomit-frame-pointer&quot;)),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
         shared_target    =&gt; &quot;bsd-shared&quot;,
         perlasm_scheme   =&gt; &quot;a.out&quot;,
@@ -849,37 +888,37 @@
 
     &quot;BSD-sparcv8&quot; =&gt; {
         inherit_from     =&gt; [ &quot;BSD-generic32&quot;, asm(&quot;sparcv8_asm&quot;) ],
-        cflags           =&gt; &quot;-mcpu=v8 -Wall -DB_ENDIAN&quot;,
+        cflags           =&gt; add(&quot;-mcpu=v8 -DB_ENDIAN&quot;),
     },
     &quot;BSD-sparc64&quot; =&gt; {
         # -DMD32_REG_T=int doesn't actually belong in sparc64 target, it
         # simply *happens* to work around a compiler bug in gcc 3.3.3,
         # triggered by RIPEMD160 code.
         inherit_from     =&gt; [ &quot;BSD-generic64&quot;, asm(&quot;sparcv9_asm&quot;) ],
-        cflags           =&gt; &quot;-DB_ENDIAN -DMD32_REG_T=int -Wall&quot;,
+        cflags           =&gt; add(&quot;-DB_ENDIAN -DMD32_REG_T=int&quot;),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
     },
 
     &quot;BSD-ia64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;BSD-generic64&quot;, asm(&quot;ia64_asm&quot;) ],
-        cflags           =&gt; &quot;-DL_ENDIAN -Wall&quot;,
+        cflags           =&gt; add_before(&quot;-DL_ENDIAN&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
     },
 
     &quot;BSD-x86_64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;BSD-generic64&quot;, asm(&quot;x86_64_asm&quot;) ],
-        cflags           =&gt; &quot;-DL_ENDIAN -Wall&quot;,
+        cflags           =&gt; add_before(&quot;-DL_ENDIAN&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
     },
 
     &quot;bsdi-elf-gcc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;x86_elf_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_elf_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;-DPERL5 -DL_ENDIAN -fomit-frame-pointer -O3 -Wall&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        ex_libs          =&gt; add(&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -887,39 +926,43 @@
     },
 
     &quot;nextstep&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;cc&quot;,
         cflags           =&gt; &quot;-O -Wall&quot;,
         unistd           =&gt; &quot;&lt;libc.h&gt;&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
     &quot;nextstep3.3&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;cc&quot;,
         cflags           =&gt; &quot;-O3 -Wall&quot;,
         unistd           =&gt; &quot;&lt;libc.h&gt;&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
 
 # QNX
     &quot;qnx4&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;cc&quot;,
         cflags           =&gt; &quot;-DL_ENDIAN -DTERMIO&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
     &quot;QNX6&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        ex_libs          =&gt; &quot;-lsocket&quot;,
+        ex_libs          =&gt; add(&quot;-lsocket&quot;),
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
         shared_extension =&gt; &quot;.so.\$(SHLIB_MAJOR).\$(SHLIB_MINOR)&quot;,
     },
     &quot;QNX6-i386&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;x86_elf_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_elf_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;-DL_ENDIAN -O2 -Wall&quot;,
-        ex_libs          =&gt; &quot;-lsocket&quot;,
+        ex_libs          =&gt; add(&quot;-lsocket&quot;),
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -939,23 +982,28 @@
 #
 # UnixWare 2.0x fails destest with -O.
     &quot;unixware-2.0&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;-DFILIO_H -DNO_STRINGS_H&quot;,
-        thread_cflag     =&gt; &quot;-Kthread&quot;,
-        ex_libs          =&gt; &quot;-lsocket -lnsl -lresolv -lx&quot;,
+        cflags           =&gt; combine(&quot;-DFILIO_H -DNO_STRINGS_H&quot;,
+                                    threads(&quot;-Kthread&quot;)),
+        ex_libs          =&gt; add(&quot;-lsocket -lnsl -lresolv -lx&quot;),
+        thread_scheme    =&gt; &quot;uithreads&quot;,
     },
     &quot;unixware-2.1&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;-O -DFILIO_H&quot;,
-        thread_cflag     =&gt; &quot;-Kthread&quot;,
-        ex_libs          =&gt; &quot;-lsocket -lnsl -lresolv -lx&quot;,
+        cflags           =&gt; combine(&quot;-O -DFILIO_H&quot;,
+                                    threads(&quot;-Kthread&quot;)),
+        ex_libs          =&gt; add(&quot;-lsocket -lnsl -lresolv -lx&quot;),
+        thread_scheme    =&gt; &quot;uithreads&quot;,
     },
     &quot;unixware-7&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;x86_elf_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_elf_asm&quot;) ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;-O -DFILIO_H -Kalloca&quot;,
-        thread_cflag     =&gt; &quot;-Kthread&quot;,
-        ex_libs          =&gt; &quot;-lsocket -lnsl&quot;,
+        cflags           =&gt; combine(&quot;-O -DFILIO_H -Kalloca&quot;,
+                                    threads(&quot;-Kthread&quot;)),
+        ex_libs          =&gt; add(&quot;-lsocket -lnsl&quot;),
+        thread_scheme    =&gt; &quot;uithreads&quot;,
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
         perlasm_scheme   =&gt; &quot;elf-1&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
@@ -964,12 +1012,13 @@
         shared_extension =&gt; &quot;.so.\$(SHLIB_MAJOR).\$(SHLIB_MINOR)&quot;,
     },
     &quot;unixware-7-gcc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;x86_elf_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_elf_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DL_ENDIAN -DFILIO_H -O3 -fomit-frame-pointer -Wall&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-lsocket -lnsl&quot;,
+        cflags           =&gt; combine(&quot;-DL_ENDIAN -DFILIO_H -O3 -fomit-frame-pointer -Wall&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot;-lsocket -lnsl&quot;),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;elf-1&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;gnu-shared&quot;,
@@ -978,11 +1027,11 @@
     },
 # SCO 5 - Ben Laurie &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">ben at algroup.co.uk</A>&gt; says the -O breaks the SCO cc.
     &quot;sco5-cc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;x86_elf_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_elf_asm&quot;) ],
         cc               =&gt; &quot;cc&quot;,
         cflags           =&gt; &quot;-belf&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
-        ex_libs          =&gt; &quot;-lsocket -lnsl&quot;,
+        ex_libs          =&gt; add(&quot;-lsocket -lnsl&quot;),
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
         perlasm_scheme   =&gt; &quot;elf-1&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;svr3-shared&quot;,
@@ -990,12 +1039,12 @@
         shared_extension =&gt; &quot;.so.\$(SHLIB_MAJOR).\$(SHLIB_MINOR)&quot;,
     },
     &quot;sco5-gcc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;x86_elf_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_elf_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;-O3 -fomit-frame-pointer&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
-        ex_libs          =&gt; &quot;-lsocket -lnsl&quot;,
+        ex_libs          =&gt; add(&quot;-lsocket -lnsl&quot;),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
         perlasm_scheme   =&gt; &quot;elf-1&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;svr3-shared&quot;,
@@ -1005,14 +1054,15 @@
 
 #### IBM's AIX.
     &quot;aix-gcc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;ppc32_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;ppc32_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DB_ENDIAN&quot;,
-        debug_cflags     =&gt; &quot;-O0 -g&quot;,
-        release_cflags   =&gt; &quot;-O&quot;,
-        thread_cflag     =&gt; &quot;-pthread&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-DB_ENDIAN&quot;,
+                                           debug   =&gt; &quot;-O0 -g&quot;,
+                                           release =&gt; &quot;-O&quot;),
+                                    threads(&quot;-pthread&quot;)),
         sys_id           =&gt; &quot;AIX&quot;,
         bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;aix32&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;aix-shared&quot;,
@@ -1021,14 +1071,15 @@
         arflags          =&gt; &quot;-X32&quot;,
     },
     &quot;aix64-gcc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;ppc64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;ppc64_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-maix64 -DB_ENDIAN&quot;,
-        debug_cflags     =&gt; &quot;-O0 -g&quot;,
-        release_cflags   =&gt; &quot;-O&quot;,
-        thread_cflag     =&gt; &quot;-pthread&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-maix64 -DB_ENDIAN&quot;,
+                                           debug   =&gt; &quot;-O0 -g&quot;,
+                                           release =&gt; &quot;-O&quot;),
+                                    threads(&quot;-pthread&quot;)),
         sys_id           =&gt; &quot;AIX&quot;,
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;aix64&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;aix-shared&quot;,
@@ -1040,14 +1091,15 @@
     # $OBJECT_MODE at build time. $OBJECT_MODE is respected at
     # ./config stage!
     &quot;aix-cc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;ppc32_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;ppc32_asm&quot;) ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;-q32 -DB_ENDIAN -qmaxmem=16384 -qro -qroconst&quot;,
-        debug_cflags     =&gt; &quot;&quot;,
-        release_cflags   =&gt; &quot;-O&quot;,
-        thread_cflag     =&gt; &quot;-qthreaded -D_THREAD_SAFE&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-q32 -DB_ENDIAN -qmaxmem=16384 -qro -qroconst&quot;,
+                                           debug   =&gt; &quot;-O0 -g&quot;,
+                                           release =&gt; &quot;-O&quot;),
+                                    threads(&quot;-qthreaded -D_THREAD_SAFE&quot;)),
         sys_id           =&gt; &quot;AIX&quot;,
         bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;aix32&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;aix-shared&quot;,
@@ -1056,14 +1108,15 @@
         arflags          =&gt; &quot;-X 32&quot;,
     },
     &quot;aix64-cc&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;ppc64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;ppc64_asm&quot;) ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;-q64 -DB_ENDIAN -qmaxmem=16384 -qro -qroconst&quot;,
-        debug_cflags     =&gt; &quot;&quot;,
-        release_cflags   =&gt; &quot;-O&quot;,
-        thread_cflag     =&gt; &quot;-qthreaded -D_THREAD_SAFE&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-q64 -DB_ENDIAN -qmaxmem=16384 -qro -qroconst&quot;,
+                                           debug   =&gt; &quot;-O0 -g&quot;,
+                                           release =&gt; &quot;-O&quot;),
+                                    threads(&quot;-qthreaded -D_THREAD_SAFE&quot;)),
         sys_id           =&gt; &quot;AIX&quot;,
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;aix64&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;aix-shared&quot;,
@@ -1074,11 +1127,12 @@
 
 # SIEMENS BS2000/OSD: an EBCDIC-based mainframe
     &quot;BS2000-OSD&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;c89&quot;,
         cflags           =&gt; &quot;-O -XLLML -XLLMK -XL -DB_ENDIAN -DCHARSET_EBCDIC&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
-        ex_libs          =&gt; &quot;-lsocket -lnsl&quot;,
+        ex_libs          =&gt; add(&quot;-lsocket -lnsl&quot;),
         bn_ops           =&gt; &quot;THIRTY_TWO_BIT RC4_CHAR&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
 
 # OS/390 Unix an EBCDIC-based Unix system on IBM mainframe
@@ -1086,10 +1140,11 @@
 # IBM compiler does not like the -L switch after any object modules.
 #
     &quot;OS390-Unix&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;c89.sh&quot;,
         cflags           =&gt; &quot;-O -DB_ENDIAN -DCHARSET_EBCDIC -DNO_SYS_PARAM_H  -D_ALL_SOURCE&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
         bn_ops           =&gt; &quot;THIRTY_TWO_BIT RC4_CHAR&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
 
 #### Visual C targets
@@ -1101,12 +1156,12 @@
 # legitimate and false cases, but as we compile on multiple platforms,
 # we rely on other compilers to catch legitimate cases.
     &quot;VC-common&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_Windows&quot; ],
         template         =&gt; 1,
         cc               =&gt; &quot;cl&quot;,
         cflags           =&gt; &quot;-W3 -wd4090 -Gs0 -GF -Gy -nologo -DOPENSSL_SYS_WIN32 -DWIN32_LEAN_AND_MEAN -DL_ENDIAN -D_CRT_SECURE_NO_DEPRECATE&quot;,
         shared_target    =&gt; &quot;win-shared&quot;, # meaningless except it gives Configure a hint
         dso_scheme       =&gt; &quot;win32&quot;,
-	build_scheme     =&gt; &quot;mk1mf&quot;,
     },
     &quot;VC-WIN64I&quot; =&gt; {
         inherit_from     =&gt; [ &quot;VC-common&quot;, asm(&quot;ia64_asm&quot;) ],
@@ -1116,7 +1171,7 @@
         bn_obj           =&gt; sub { my $r=join(&quot; &quot;<A HREF="../../../mailman/listinfo/openssl-commits.html">, at _</A>); $r=~s/bn\-//; $r; },
         rc4_obj          =&gt; &quot;&quot;,
         perlasm_scheme   =&gt; &quot;ias&quot;,
-	build_scheme     =&gt; [ &quot;mk1mf&quot;, &quot;VC-W64&quot; ],
+        build_scheme     =&gt; add(&quot;VC-W64&quot;, { separator =&gt; undef }),
     },
     &quot;VC-WIN64A&quot; =&gt; {
         inherit_from     =&gt; [ &quot;VC-common&quot;, asm(&quot;x86_64_asm&quot;) ],
@@ -1125,7 +1180,7 @@
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT EXPORT_VAR_AS_FN&quot;,
         bn_obj           =&gt; sub { my $r=join(&quot; &quot;<A HREF="../../../mailman/listinfo/openssl-commits.html">, at _</A>); $r=~s/x86_64\-gcc/bn_asm/; $r; },
         perlasm_scheme   =&gt; &quot;auto&quot;,
-	build_scheme     =&gt; [ &quot;mk1mf&quot;, &quot;VC-W64&quot; ],
+        build_scheme     =&gt; add(&quot;VC-W64&quot;, { separator =&gt; undef }),
     },
     &quot;VC-WIN32&quot; =&gt; {
         # x86 Win32 target defaults to ANSI API, if you want UNICODE,
@@ -1134,37 +1189,40 @@
         sys_id           =&gt; &quot;WIN32&quot;,
         bn_ops           =&gt; &quot;BN_LLONG EXPORT_VAR_AS_FN&quot;,
         perlasm_scheme   =&gt; &quot;win32n&quot;,
-	build_scheme     =&gt; [ &quot;mk1mf&quot;, &quot;VC-W32&quot; ],
+        build_scheme     =&gt; add(&quot;VC-W32&quot;, { separator =&gt; undef }),
     },
     &quot;VC-CE&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_Windows&quot; ],
         cc               =&gt; &quot;cl&quot;,
         sys_id           =&gt; &quot;WINCE&quot;,
         bn_ops           =&gt; &quot;BN_LLONG EXPORT_VAR_AS_FN&quot;,
         dso_scheme       =&gt; &quot;win32&quot;,
-	build_scheme     =&gt; [ &quot;mk1mf&quot;, &quot;VC-WCE&quot; ],
+        build_scheme     =&gt; add(&quot;VC-WCE&quot;, { separator =&gt; undef }),
     },
 
 #### Borland C++ 4.5
     &quot;BC-32&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_Windows&quot; ],
         cc               =&gt; &quot;bcc32&quot;,
         sys_id           =&gt; &quot;WIN32&quot;,
         bn_ops           =&gt; &quot;BN_LLONG EXPORT_VAR_AS_FN&quot;,
         dso_scheme       =&gt; &quot;win32&quot;,
-	build_scheme     =&gt; [ &quot;mk1mf&quot;, &quot;BC&quot; ],
+        build_scheme     =&gt; add(&quot;BC&quot;, { separator =&gt; undef }),
     },
 
 #### MinGW
     &quot;mingw&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;x86_asm&quot;),
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_asm&quot;),
                               sub { $disabled{shared} ? () : &quot;x86_uplink&quot; } ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DL_ENDIAN -DWIN32_LEAN_AND_MEAN -DUNICODE -D_UNICODE -m32 -Wall&quot;,
-        debug_cflags     =&gt; &quot;-g -O0&quot;,
-        release_cflags   =&gt; &quot;-O3 -fomit-frame-pointer&quot;,
-        thread_cflag     =&gt; &quot;-D_MT&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-DL_ENDIAN -DWIN32_LEAN_AND_MEAN -DUNICODE -D_UNICODE -m32 -Wall&quot;,
+                                           debug   =&gt; &quot;-g -O0&quot;,
+                                           release =&gt; &quot;-O3 -fomit-frame-pointer&quot;),
+                                    threads(&quot;-D_MT&quot;)),
         sys_id           =&gt; &quot;MINGW32&quot;,
-        ex_libs          =&gt; &quot;-lws2_32 -lgdi32 -lcrypt32&quot;,
+        ex_libs          =&gt; add(&quot;-lws2_32 -lgdi32 -lcrypt32&quot;),
         bn_ops           =&gt; &quot;BN_LLONG EXPORT_VAR_AS_FN&quot;,
+        thread_scheme    =&gt; &quot;winthreads&quot;,
         perlasm_scheme   =&gt; &quot;coff&quot;,
         dso_scheme       =&gt; &quot;win32&quot;,
         shared_target    =&gt; &quot;mingw-shared&quot;,
@@ -1183,15 +1241,16 @@
         # consider its binaries for using with non-mingw64 run-time
         # environment. And as mingw64 is always consistent with itself,
         # Applink is never engaged and can as well be omitted.
-        inherit_from     =&gt; [ asm(&quot;x86_64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_64_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DL_ENDIAN -DWIN32_LEAN_AND_MEAN -DUNICODE -D_UNICODE -m64 -Wall&quot;,
-        debug_cflags     =&gt; &quot;-g -O0&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;-D_MT&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;-DL_ENDIAN -DWIN32_LEAN_AND_MEAN -DUNICODE -D_UNICODE -m64 -Wall&quot;,
+                                           debug   =&gt; &quot;-g -O0&quot;,
+                                           release =&gt; &quot;-O3&quot;),
+                                    threads(&quot;-D_MT&quot;)),
         sys_id           =&gt; &quot;MINGW64&quot;,
-        ex_libs          =&gt; &quot;-lws2_32 -lgdi32 -lcrypt32&quot;,
+        ex_libs          =&gt; add(&quot;-lws2_32 -lgdi32 -lcrypt32&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT EXPORT_VAR_AS_FN&quot;,
+        thread_scheme    =&gt; &quot;winthreads&quot;,
         perlasm_scheme   =&gt; &quot;mingw64&quot;,
         dso_scheme       =&gt; &quot;win32&quot;,
         shared_target    =&gt; &quot;mingw-shared&quot;,
@@ -1204,6 +1263,7 @@
 
 #### UEFI
     &quot;UEFI&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;cc&quot;,
         cflags           =&gt; &quot;-DL_ENDIAN -O&quot;,
         sys_id           =&gt; &quot;UEFI&quot;,
@@ -1211,6 +1271,7 @@
 
 #### UWIN
     &quot;UWIN&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;cc&quot;,
         cflags           =&gt; &quot;-DTERMIOS -DL_ENDIAN -O -Wall&quot;,
         sys_id           =&gt; &quot;UWIN&quot;,
@@ -1220,11 +1281,11 @@
 
 #### Cygwin
     &quot;Cygwin-x86&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;x86_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DTERMIOS -DL_ENDIAN -Wall&quot;,
-        debug_cflags     =&gt; &quot;-g -O0&quot;,
-        release_cflags   =&gt; &quot;-O3 -fomit-frame-pointer&quot;,
+        cflags           =&gt; picker(default =&gt; &quot;-DTERMIOS -DL_ENDIAN -Wall&quot;,
+                                   debug   =&gt; &quot;-g -O0&quot;,
+                                   release =&gt; &quot;-O3 -fomit-frame-pointer&quot;),
         sys_id           =&gt; &quot;CYGWIN&quot;,
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
         perlasm_scheme   =&gt; &quot;coff&quot;,
@@ -1235,11 +1296,11 @@
         shared_extension =&gt; &quot;.dll&quot;,
     },
     &quot;Cygwin-x86_64&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;x86_64_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;x86_64_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DTERMIOS -DL_ENDIAN -Wall&quot;,
-        debug_cflags     =&gt; &quot;-g -O0&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
+        cflags           =&gt; picker(default =&gt; &quot;-DTERMIOS -DL_ENDIAN -Wall&quot;,
+                                   debug   =&gt; &quot;-g -O0&quot;,
+                                   release =&gt; &quot;-O3&quot;),
         sys_id           =&gt; &quot;CYGWIN&quot;,
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;mingw64&quot;,
@@ -1273,38 +1334,46 @@
 # the builds can be configured to use BSD sockets instead.
 # netware-clib =&gt; legacy CLib c-runtime support
     &quot;netware-clib&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_Windows&quot; ],
         cc               =&gt; &quot;mwccnlm&quot;,
-	build_scheme     =&gt; [ &quot;mk1mf&quot;, &quot;netware&quot; ],
+        build_scheme     =&gt; add(&quot;netware&quot;, { separator =&gt; undef }),
     },
     &quot;netware-clib-bsdsock&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_Windows&quot; ],
         cc               =&gt; &quot;mwccnlm&quot;,
-	build_scheme     =&gt; [ &quot;mk1mf&quot;, &quot;netware&quot; ],
+        build_scheme     =&gt; add(&quot;netware&quot;, { separator =&gt; undef }),
     },
     &quot;netware-clib-gcc&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;i586-netware-gcc&quot;,
         cflags           =&gt; &quot;-nostdinc -I/ndk/nwsdk/include/nlm -I/ndk/ws295sdk/include -DL_ENDIAN -DNETWARE_CLIB -DOPENSSL_SYS_NETWARE -O2 -Wall&quot;,
     },
     &quot;netware-clib-bsdsock-gcc&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;i586-netware-gcc&quot;,
         cflags           =&gt; &quot;-nostdinc -I/ndk/nwsdk/include/nlm -DNETWARE_BSDSOCK -DNETDB_USE_INTERNET -DL_ENDIAN -DNETWARE_CLIB -DOPENSSL_SYS_NETWARE -O2 -Wall&quot;,
     },
     # netware-libc =&gt; LibC/NKS support
     &quot;netware-libc&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_Windows&quot; ],
         cc               =&gt; &quot;mwccnlm&quot;,
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
-	build_scheme     =&gt; [ &quot;mk1mf&quot;, &quot;netware&quot; ],
+        build_scheme     =&gt; add(&quot;netware&quot;, { separator =&gt; undef }),
     },
     &quot;netware-libc-bsdsock&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_Windows&quot; ],
         cc               =&gt; &quot;mwccnlm&quot;,
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
-	build_scheme     =&gt; [ &quot;mk1mf&quot;, &quot;netware&quot; ],
+        build_scheme     =&gt; add(&quot;netware&quot;, { separator =&gt; undef }),
     },
     &quot;netware-libc-gcc&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;i586-netware-gcc&quot;,
         cflags           =&gt; &quot;-nostdinc -I/ndk/libc/include -I/ndk/libc/include/winsock -DL_ENDIAN -DNETWARE_LIBC -DOPENSSL_SYS_NETWARE -DTERMIO -O2 -Wall&quot;,
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
     },
     &quot;netware-libc-bsdsock-gcc&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;i586-netware-gcc&quot;,
         cflags           =&gt; &quot;-nostdinc -I/ndk/libc/include -DNETWARE_BSDSOCK -DL_ENDIAN -DNETWARE_LIBC -DOPENSSL_SYS_NETWARE -DTERMIO -O2 -Wall&quot;,
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
@@ -1316,37 +1385,41 @@
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;-I/dev/env/WATT_ROOT/inc -DTERMIO -DL_ENDIAN -fomit-frame-pointer -O2 -Wall&quot;,
         sys_id           =&gt; &quot;MSDOS&quot;,
-        ex_libs          =&gt; &quot;-L/dev/env/WATT_ROOT/lib -lwatt&quot;,
+        ex_libs          =&gt; add(&quot;-L/dev/env/WATT_ROOT/lib -lwatt&quot;),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
         perlasm_scheme   =&gt; &quot;a.out&quot;,
     },
 
 #### Ultrix from Bernhard Simon &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">simon at zid.tuwien.ac.at</A>&gt;
     &quot;ultrix-cc&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;cc&quot;,
         cflags           =&gt; &quot;-std1 -O -Olimit 2500 -DL_ENDIAN&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
     &quot;ultrix-gcc&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;-O3 -DL_ENDIAN&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
 # K&amp;R C is no longer supported; you need gcc on old Ultrix installations
 ##&quot;ultrix&quot;,&quot;cc:-O2 -DNOPROTO -DNOCONST -DL_ENDIAN::(unknown):::::::&quot;,
 
 ##### MacOS X (a.k.a. Darwin) setup
     &quot;darwin-common&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         template         =&gt; 1,
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;&quot;,
-        debug_cflags     =&gt; &quot;-g -O0&quot;,
-        release_cflags   =&gt; &quot;-O3&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
+        cflags           =&gt; combine(picker(default =&gt; &quot;&quot;,
+                                           debug   =&gt; &quot;-g -O0&quot;,
+                                           release =&gt; &quot;-O3&quot;),
+                                   threads(&quot;-D_REENTRANT&quot;)),
         sys_id           =&gt; &quot;MACOSX&quot;,
         plib_lflags      =&gt; &quot;-Wl,-search_paths_first&quot;,
         bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;osx32&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;darwin-shared&quot;,
@@ -1356,28 +1429,28 @@
     },
     &quot;darwin-ppc-cc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;darwin-common&quot;, asm(&quot;ppc32_asm&quot;) ],
-        cflags           =&gt; &quot;-arch ppc -DB_ENDIAN -Wa,-force_cpusubtype_ALL&quot;,
+        cflags           =&gt; add(&quot;-arch ppc -DB_ENDIAN -Wa,-force_cpusubtype_ALL&quot;),
         perlasm_scheme   =&gt; &quot;osx32&quot;,
         shared_ldflag    =&gt; &quot;-arch ppc -dynamiclib&quot;,
     },
     &quot;darwin64-ppc-cc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;darwin-common&quot;, asm(&quot;ppc64_asm&quot;) ],
-        cflags           =&gt; &quot;-arch ppc64 -DB_ENDIAN&quot;,
+        cflags           =&gt; add(&quot;-arch ppc64 -DB_ENDIAN&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR&quot;,
         perlasm_scheme   =&gt; &quot;osx64&quot;,
         shared_ldflag    =&gt; &quot;-arch ppc64 -dynamiclib&quot;,
     },
     &quot;darwin-i386-cc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;darwin-common&quot;, asm(&quot;x86_asm&quot;) ],
-        cflags           =&gt; &quot;-arch i386 -DL_ENDIAN&quot;,
-        release_cflags   =&gt; &quot;-O3 -fomit-frame-pointer&quot;,
+        cflags           =&gt; add(picker(default =&gt; &quot;-arch i386 -DL_ENDIAN&quot;,
+                                       release =&gt; &quot;-fomit-frame-pointer&quot;)),
         bn_ops           =&gt; &quot;BN_LLONG RC4_INT&quot;,
         perlasm_scheme   =&gt; &quot;macosx&quot;,
         shared_ldflag    =&gt; &quot;-arch i386 -dynamiclib&quot;,
     },
     &quot;darwin64-x86_64-cc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;darwin-common&quot;, asm(&quot;x86_64_asm&quot;) ],
-        cflags           =&gt; &quot;-arch x86_64 -DL_ENDIAN -Wall&quot;,
+        cflags           =&gt; add(&quot;-arch x86_64 -DL_ENDIAN -Wall&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;macosx&quot;,
         shared_ldflag    =&gt; &quot;-arch x86_64 -dynamiclib&quot;,
@@ -1400,7 +1473,7 @@
 #
     &quot;iphoneos-cross&quot; =&gt; {
         inherit_from     =&gt; [ &quot;darwin-common&quot; ],
-        cflags           =&gt; &quot;-isysroot \$(CROSS_TOP)/SDKs/\$(CROSS_SDK) -fno-common&quot;,
+        cflags           =&gt; add(&quot;-isysroot \$(CROSS_TOP)/SDKs/\$(CROSS_SDK) -fno-common&quot;),
         sys_id           =&gt; &quot;iOS&quot;,
     },
     &quot;ios-cross&quot; =&gt; {
@@ -1408,13 +1481,13 @@
         # It should be possible to go below iOS 6 and even add -arch armv6,
         # thus targeting iPhone pre-3GS, but it's assumed to be irrelevant
         # at this point.
-        cflags           =&gt; &quot;-arch armv7 -mios-version-min=6.0.0 -isysroot \$(CROSS_TOP)/SDKs/\$(CROSS_SDK) -fno-common&quot;,
+        cflags           =&gt; add(&quot;-arch armv7 -mios-version-min=6.0.0 -isysroot \$(CROSS_TOP)/SDKs/\$(CROSS_SDK) -fno-common&quot;),
         sys_id           =&gt; &quot;iOS&quot;,
         perlasm_scheme   =&gt; &quot;ios32&quot;,
     },
     &quot;ios64-cross&quot; =&gt; {
         inherit_from     =&gt; [ &quot;darwin-common&quot;, asm(&quot;aarch64_asm&quot;) ],
-        cflags           =&gt; &quot;-arch arm64 -mios-version-min=7.0.0 -isysroot \$(CROSS_TOP)/SDKs/\$(CROSS_SDK) -fno-common&quot;,
+        cflags           =&gt; add(&quot;-arch arm64 -mios-version-min=7.0.0 -isysroot \$(CROSS_TOP)/SDKs/\$(CROSS_SDK) -fno-common&quot;),
         sys_id           =&gt; &quot;iOS&quot;,
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR&quot;,
         perlasm_scheme   =&gt; &quot;ios64&quot;,
@@ -1422,12 +1495,14 @@
 
 ##### GNU Hurd
     &quot;hurd-x86&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         inherit_from     =&gt; [ asm(&quot;x86_elf_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DL_ENDIAN -O3 -fomit-frame-pointer -Wall&quot;,
-        thread_cflag     =&gt; &quot;-pthread&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; combine(&quot;-DL_ENDIAN -O3 -fomit-frame-pointer -Wall&quot;,
+                                    threads(&quot;-pthread&quot;)),
+        ex_libs          =&gt; add(&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -1435,47 +1510,55 @@
 
 ##### OS/2 EMX
     &quot;OS2-EMX&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;gcc&quot;,
     },
 
 ##### VxWorks for various targets
     &quot;vxworks-ppc60x&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;ccppc&quot;,
         cflags           =&gt; &quot;-D_REENTRANT -mrtp -mhard-float -mstrict-align -fno-implicit-fp -DPPC32_fp60x -O2 -fstrength-reduce -fno-builtin -fno-strict-aliasing -Wall -DCPU=PPC32 -DTOOL_FAMILY=gnu -DTOOL=gnu -I\$(WIND_BASE)/target/usr/h -I\$(WIND_BASE)/target/usr/h/wrn/coreip&quot;,
         sys_id           =&gt; &quot;VXWORKS&quot;,
-        ex_libs          =&gt; &quot;-Wl,--defsym,__wrs_rtp_base=0xe0000000 -L \$(WIND_BASE)/target/usr/lib/ppc/PPC32/common&quot;,
+        ex_libs          =&gt; add(&quot;-Wl,--defsym,__wrs_rtp_base=0xe0000000 -L \$(WIND_BASE)/target/usr/lib/ppc/PPC32/common&quot;),
     },
     &quot;vxworks-ppcgen&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;ccppc&quot;,
         cflags           =&gt; &quot;-D_REENTRANT -mrtp -msoft-float -mstrict-align -O1 -fno-builtin -fno-strict-aliasing -Wall -DCPU=PPC32 -DTOOL_FAMILY=gnu -DTOOL=gnu -I\$(WIND_BASE)/target/usr/h -I\$(WIND_BASE)/target/usr/h/wrn/coreip&quot;,
         sys_id           =&gt; &quot;VXWORKS&quot;,
-        ex_libs          =&gt; &quot;-Wl,--defsym,__wrs_rtp_base=0xe0000000 -L \$(WIND_BASE)/target/usr/lib/ppc/PPC32/sfcommon&quot;,
+        ex_libs          =&gt; add(&quot;-Wl,--defsym,__wrs_rtp_base=0xe0000000 -L \$(WIND_BASE)/target/usr/lib/ppc/PPC32/sfcommon&quot;),
     },
     &quot;vxworks-ppc405&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;ccppc&quot;,
         cflags           =&gt; &quot;-g -msoft-float -mlongcall -DCPU=PPC405 -I\$(WIND_BASE)/target/h&quot;,
         sys_id           =&gt; &quot;VXWORKS&quot;,
         lflags           =&gt; &quot;-r&quot;,
     },
     &quot;vxworks-ppc750&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;ccppc&quot;,
         cflags           =&gt; &quot;-ansi -nostdinc -DPPC750 -D_REENTRANT -fvolatile -fno-builtin -fno-for-scope -fsigned-char -Wall -msoft-float -mlongcall -DCPU=PPC604 -I\$(WIND_BASE)/target/h \$(DEBUG_FLAG)&quot;,
         sys_id           =&gt; &quot;VXWORKS&quot;,
         lflags           =&gt; &quot;-r&quot;,
     },
     &quot;vxworks-ppc750-debug&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;ccppc&quot;,
         cflags           =&gt; &quot;-ansi -nostdinc -DPPC750 -D_REENTRANT -fvolatile -fno-builtin -fno-for-scope -fsigned-char -Wall -msoft-float -mlongcall -DCPU=PPC604 -I\$(WIND_BASE)/target/h -DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG -DPEDANTIC -DDEBUG_SAFESTACK -DDEBUG -g&quot;,
         sys_id           =&gt; &quot;VXWORKS&quot;,
         lflags           =&gt; &quot;-r&quot;,
     },
     &quot;vxworks-ppc860&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;ccppc&quot;,
         cflags           =&gt; &quot;-nostdinc -msoft-float -DCPU=PPC860 -DNO_STRINGS_H -I\$(WIND_BASE)/target/h&quot;,
         sys_id           =&gt; &quot;VXWORKS&quot;,
         lflags           =&gt; &quot;-r&quot;,
     },
     &quot;vxworks-simlinux&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;ccpentium&quot;,
         cflags           =&gt; &quot;-B\$(WIND_BASE)/host/\$(WIND_HOST_TYPE)/lib/gcc-lib/ -D_VSB_CONFIG_FILE=\&quot;\$(WIND_BASE)/target/lib/h/config/vsbConfig.h\&quot; -DL_ENDIAN -DCPU=SIMLINUX -DTOOL_FAMILY=gnu -DTOOL=gnu -fno-builtin -fno-defer-pop -DNO_STRINGS_H -I\$(WIND_BASE)/target/h -I\$(WIND_BASE)/target/h/wrn/coreip -DOPENSSL_NO_HW_PADLOCK&quot;,
         sys_id           =&gt; &quot;VXWORKS&quot;,
@@ -1483,24 +1566,27 @@
         ranlib           =&gt; &quot;ranlibpentium&quot;,
     },
     &quot;vxworks-mips&quot; =&gt; {
-        inherit_from     =&gt; [ asm(&quot;mips32_asm&quot;) ],
+        inherit_from     =&gt; [ &quot;BASE_unix&quot;, asm(&quot;mips32_asm&quot;) ],
         cc               =&gt; &quot;ccmips&quot;,
-        cflags           =&gt; &quot;-mrtp -mips2 -O -G 0 -B\$(WIND_BASE)/host/\$(WIND_HOST_TYPE)/lib/gcc-lib/ -D_VSB_CONFIG_FILE=\&quot;\$(WIND_BASE)/target/lib/h/config/vsbConfig.h\&quot; -DCPU=MIPS32 -msoft-float -mno-branch-likely -DTOOL_FAMILY=gnu -DTOOL=gnu -fno-builtin -fno-defer-pop -DNO_STRINGS_H -I\$(WIND_BASE)/target/usr/h -I\$(WIND_BASE)/target/h/wrn/coreip&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
+        cflags           =&gt; combine(&quot;-mrtp -mips2 -O -G 0 -B\$(WIND_BASE)/host/\$(WIND_HOST_TYPE)/lib/gcc-lib/ -D_VSB_CONFIG_FILE=\&quot;\$(WIND_BASE)/target/lib/h/config/vsbConfig.h\&quot; -DCPU=MIPS32 -msoft-float -mno-branch-likely -DTOOL_FAMILY=gnu -DTOOL=gnu -fno-builtin -fno-defer-pop -DNO_STRINGS_H -I\$(WIND_BASE)/target/usr/h -I\$(WIND_BASE)/target/h/wrn/coreip&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
         sys_id           =&gt; &quot;VXWORKS&quot;,
-        ex_libs          =&gt; &quot;-Wl,--defsym,__wrs_rtp_base=0xe0000000 -L \$(WIND_BASE)/target/usr/lib/mips/MIPSI32/sfcommon&quot;,
+        ex_libs          =&gt; add(&quot;-Wl,--defsym,__wrs_rtp_base=0xe0000000 -L \$(WIND_BASE)/target/usr/lib/mips/MIPSI32/sfcommon&quot;),
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;o32&quot;,
         ranlib           =&gt; &quot;ranlibmips&quot;,
     },
 
 #### uClinux
     &quot;uClinux-dist&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;$ENV{'CC'}&quot;,
-        cflags           =&gt; &quot;\$(CFLAGS)&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
+        cflags           =&gt; combine(&quot;\$(CFLAGS)&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
         plib_lflags      =&gt; &quot;\$(LDFLAGS)&quot;,
-        ex_libs          =&gt; &quot;\$(LDLIBS)&quot;,
+        ex_libs          =&gt; add(&quot;\$(LDLIBS)&quot;),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;$ENV{'LIBSSL_dlfcn'}&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -1509,12 +1595,14 @@
         ranlib           =&gt; &quot;$ENV{'RANLIB'}&quot;,
     },
     &quot;uClinux-dist64&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_unix&quot; ],
         cc               =&gt; &quot;$ENV{'CC'}&quot;,
-        cflags           =&gt; &quot;\$(CFLAGS)&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
+        cflags           =&gt; combine(&quot;\$(CFLAGS)&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
         plib_lflags      =&gt; &quot;\$(LDFLAGS)&quot;,
-        ex_libs          =&gt; &quot;\$(LDLIBS)&quot;,
+        ex_libs          =&gt; add(&quot;\$(LDLIBS)&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;$ENV{'LIBSSL_dlfcn'}&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -1525,19 +1613,19 @@
 
     ##### VMS
     &quot;vms-generic&quot; =&gt; {
+        inherit_from     =&gt; [ &quot;BASE_VMS&quot; ],
         template         =&gt; 1,
         cc               =&gt; &quot;CC/DECC&quot;,
-        cflags           =&gt; &quot;/STANDARD=RELAXED/NOLIST/PREFIX=ALL/NAMES=(AS_IS,SHORTENED)&quot;,
-        debug_cflags     =&gt; &quot;/NOOPTIMIZE/DEBUG&quot;,
-        release_cflags   =&gt; &quot;/OPTIMIZE/NODEBUG&quot;,
-        lflags           =&gt; &quot;/MAP&quot;,
-        debug_lflags     =&gt; &quot;/DEBUG/TRACEBACK&quot;,
-        release_lflags   =&gt; &quot;/NODEBUG/NOTRACEBACK&quot;,
+        cflags           =&gt; picker(default =&gt; &quot;/STANDARD=RELAXED/NOLIST/PREFIX=ALL/NAMES=(AS_IS,SHORTENED)&quot;,
+                                   debug   =&gt; &quot;/NOOPTIMIZE/DEBUG&quot;,
+                                   release =&gt; &quot;/OPTIMIZE/NODEBUG&quot;),
+        lflags           =&gt; picker(default =&gt; &quot;/MAP&quot;,
+                                   debug   =&gt; &quot;/DEBUG/TRACEBACK&quot;,
+                                   release =&gt; &quot;/NODEBUG/NOTRACEBACK&quot;),
         shared_target    =&gt; &quot;vms-shared&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
 
         apps_aux_src     =&gt; &quot;vms_decc_init.c&quot;,
-        build_file       =&gt; &quot;descrip.mms&quot;,
-        build_scheme     =&gt; [ &quot;unified&quot;, &quot;VMS&quot; ],
     },
 
     # VMS on VAX is *unsupported*
@@ -1562,10 +1650,12 @@
     &quot;vms-alpha-P32&quot; =&gt; {
 	inherit_from	 =&gt; [ &quot;vms-alpha&quot; ],
 	cflags		 =&gt; add(&quot;/POINTER_SIZE=32&quot;),
+	ex_libs		 =&gt; sub { join(&quot;,&quot;, map { s|SHR([\./])|SHR32$1|g; $_ } @_) },
     },
     &quot;vms-alpha-P64&quot; =&gt; {
 	inherit_from	 =&gt; [ &quot;vms-alpha&quot; ],
 	cflags		 =&gt; add(&quot;/POINTER_SIZE=64&quot;),
+	ex_libs		 =&gt; sub { join(&quot;,&quot;, map { s|SHR([\./])|SHR64$1|g; $_ } @_) },
     },
     &quot;vms-ia64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;vms-generic&quot; ],
@@ -1577,10 +1667,12 @@
     &quot;vms-ia64-P32&quot; =&gt; {
 	inherit_from	 =&gt; [ &quot;vms-ia64&quot; ],
 	cflags		 =&gt; add(&quot;/POINTER_SIZE=32&quot;),
+	ex_libs		 =&gt; sub { join(&quot;,&quot;, map { s|SHR([\./])|SHR32$1|g; $_ } @_) },
     },
     &quot;vms-ia64-P64&quot; =&gt; {
 	inherit_from	 =&gt; [ &quot;vms-ia64&quot; ],
 	cflags		 =&gt; add(&quot;/POINTER_SIZE=64&quot;),
+	ex_libs		 =&gt; sub { join(&quot;,&quot;, map { s|SHR([\./])|SHR64$1|g; $_ } @_) },
     },
 
 );
diff --git a/Configurations/90-team.conf b/Configurations/90-team.conf
index 7667464..c7f287f 100644
--- a/Configurations/90-team.conf
+++ b/Configurations/90-team.conf
@@ -1,26 +1,37 @@
 ## -*- mode: perl; -*-
 ## Build configuration targets for openssl-team members
 
+sub threads {
+    my @flags = @_;
+    return sub { add($disabled{threads} ? () : @flags)-&gt;(); }
+}
+
+sub combine {
+    my @stuff = @_;
+    return sub { add(@stuff)-&gt;(); }
+}
+
 %targets = (
     &quot;purify&quot; =&gt; {
         cc               =&gt; &quot;purify gcc&quot;,
         cflags           =&gt; &quot;-g -Wall&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
-        ex_libs          =&gt; &quot;-lsocket -lnsl&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
+        ex_libs          =&gt; add(&quot; &quot;,&quot;-lsocket -lnsl&quot;),
     },
     &quot;debug&quot; =&gt; {
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;-DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG -DOPENSSL_NO_ASM -ggdb -g2 -Wformat -Wshadow -Wmissing-prototypes -Wmissing-declarations -Werror&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
-        ex_libs          =&gt; &quot;-lefence&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
+        ex_libs          =&gt; add(&quot; &quot;,&quot;-lefence&quot;),
     },
     &quot;debug-erbridge&quot; =&gt; {
         inherit_from     =&gt; [ &quot;x86_64_asm&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;$gcc_devteam_warn -DBN_DEBUG -DCONF_DEBUG -m64 -DL_ENDIAN -DTERMIO -g&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; combine(&quot;$gcc_devteam_warn -DBN_DEBUG -DCONF_DEBUG -m64 -DL_ENDIAN -DTERMIO -g&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot; &quot;,&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
@@ -32,28 +43,31 @@
     &quot;debug-linux-pentium&quot; =&gt; {
         inherit_from     =&gt; [ &quot;x86_elf_asm&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG -DL_ENDIAN -g -mcpu=pentium -Wall&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; combine(&quot;-DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG -DL_ENDIAN -g -mcpu=pentium -Wall&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot; &quot;,&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
     },
     &quot;debug-linux-ppro&quot; =&gt; {
         inherit_from     =&gt; [ &quot;x86_elf_asm&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG -DL_ENDIAN -g -mcpu=pentiumpro -Wall&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; combine(&quot;-DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG -DL_ENDIAN -g -mcpu=pentiumpro -Wall&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot; &quot;,&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
     },
     &quot;debug-linux-elf-noefence&quot; =&gt; {
         inherit_from     =&gt; [ &quot;x86_elf_asm&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG -DL_ENDIAN -g -Wall&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; combine(&quot;-DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG -DL_ENDIAN -g -Wall&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot; &quot;,&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -61,9 +75,9 @@
     },
     &quot;debug-linux-ia32-aes&quot; =&gt; {
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DL_ENDIAN -O3 -fomit-frame-pointer -Wall&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; combine(&quot;-DL_ENDIAN -O3 -fomit-frame-pointer -Wall&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot; &quot;,&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
         cpuid_asm_src    =&gt; &quot;x86cpuid.s&quot;,
         bn_asm_src       =&gt; &quot;bn-586.s co-586.s x86-mont.s&quot;,
@@ -79,6 +93,7 @@
         wp_asm_src       =&gt; &quot;wp_block.s wp-mmx.s&quot;,
         modes_asm_src    =&gt; &quot;ghash-x86.s&quot;,
         padlock_asm_src  =&gt; &quot;e_padlock-x86.s&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
@@ -88,14 +103,15 @@
     &quot;dist&quot; =&gt; {
         cc               =&gt; &quot;cc&quot;,
         cflags           =&gt; &quot;-O&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
     &quot;debug-test-64-clang&quot; =&gt; {
         inherit_from     =&gt; [ &quot;x86_64_asm&quot; ],
         cc               =&gt; &quot;clang&quot;,
-        cflags           =&gt; &quot;$gcc_devteam_warn -Wno-error=overlength-strings -Wno-error=extended-offsetof -Wno-error=language-extension-token -Wno-error=unused-const-variable -Wstrict-overflow -Qunused-arguments -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -O3 -pipe&quot;,
-        thread_cflag     =&gt; &quot;${BSDthreads}&quot;,
+        cflags           =&gt; combine(&quot;$gcc_devteam_warn -Wno-error=overlength-strings -Wno-error=extended-offsetof -Wno-error=language-extension-token -Wno-error=unused-const-variable -Wstrict-overflow -Qunused-arguments -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -O3 -pipe&quot;,
+                                    threads(&quot;${BSDthreads}&quot;)),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
@@ -105,10 +121,11 @@
     &quot;darwin64-debug-test-64-clang&quot; =&gt; {
         inherit_from     =&gt; [ &quot;x86_64_asm&quot; ],
         cc               =&gt; &quot;clang&quot;,
-        cflags           =&gt; &quot;-arch x86_64 -DL_ENDIAN $gcc_devteam_warn -Wno-error=overlength-strings -Wno-error=extended-offsetof -Wno-error=language-extension-token -Wno-error=unused-const-variable -Wstrict-overflow -Qunused-arguments -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -O3 -pipe&quot;,
-        thread_cflag     =&gt; &quot;${BSDthreads}&quot;,
+        cflags           =&gt; combine(&quot;-arch x86_64 -DL_ENDIAN $gcc_devteam_warn -Wno-error=overlength-strings -Wno-error=extended-offsetof -Wno-error=language-extension-token -Wno-error=unused-const-variable -Wstrict-overflow -Qunused-arguments -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -O3 -pipe&quot;,
+                                    threads(&quot;${BSDthreads}&quot;)),
         sys_id           =&gt; &quot;MACOSX&quot;,
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;macosx&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;darwin-shared&quot;,
diff --git a/Configurations/99-personal-ben.conf b/Configurations/99-personal-ben.conf
index 611e3de..50b9315 100644
--- a/Configurations/99-personal-ben.conf
+++ b/Configurations/99-personal-ben.conf
@@ -5,29 +5,30 @@
     &quot;debug-ben&quot; =&gt; {
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;$gcc_devteam_warn -DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG -DDEBUG_SAFESTACK -O2 -pipe&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
     &quot;debug-ben-openbsd&quot; =&gt; {
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;-DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG -DPEDANTIC -DDEBUG_SAFESTACK -DOPENSSL_OPENBSD_DEV_CRYPTO -DOPENSSL_NO_ASM -O2 -pedantic -Wall -Wshadow -Werror -pipe&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
     &quot;debug-ben-openbsd-debug&quot; =&gt; {
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;-DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG -DPEDANTIC -DDEBUG_SAFESTACK -DOPENSSL_OPENBSD_DEV_CRYPTO -DOPENSSL_NO_ASM -g3 -O2 -pedantic -Wall -Wshadow -Werror -pipe&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
     &quot;debug-ben-debug&quot; =&gt; {
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;$gcc_devteam_warn -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DOPENSSL_NO_HW_PADLOCK -g3 -O2 -pipe&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
     &quot;debug-ben-debug-64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;x86_64_asm&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;$gcc_devteam_warn -Wno-error=overlength-strings -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -O3 -pipe&quot;,
-        thread_cflag     =&gt; &quot;${BSDthreads}&quot;,
+        cflags           =&gt; combine(&quot;$gcc_devteam_warn -Wno-error=overlength-strings -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -O3 -pipe&quot;,
+                                    threads(&quot;${BSDthreads}&quot;)),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
@@ -37,9 +38,10 @@
     &quot;debug-ben-debug-64-clang&quot; =&gt; {
         inherit_from     =&gt; [ &quot;x86_64_asm&quot; ],
         cc               =&gt; &quot;clang&quot;,
-        cflags           =&gt; &quot;$gcc_devteam_warn -Wno-error=overlength-strings -Wno-error=extended-offsetof -Wno-error=language-extension-token -Wstrict-overflow -Qunused-arguments -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -O3 -pipe&quot;,
-        thread_cflag     =&gt; &quot;${BSDthreads}&quot;,
+        cflags           =&gt; combine(&quot;$gcc_devteam_warn -Wno-error=overlength-strings -Wno-error=extended-offsetof -Wno-error=language-extension-token -Wstrict-overflow -Qunused-arguments -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -O3 -pipe&quot;,
+                                    threads(&quot;${BSDthreads}&quot;)),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
@@ -49,9 +51,10 @@
     &quot;debug-ben-debug-64-noopt&quot; =&gt; {
         inherit_from     =&gt; [ &quot;x86_64_asm&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;$gcc_devteam_warn -Wno-error=overlength-strings -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -pipe&quot;,
-        thread_cflag     =&gt; &quot;${BSDthreads}&quot;,
+        cflags           =&gt; combine(&quot;$gcc_devteam_warn -Wno-error=overlength-strings -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -pipe&quot;,
+                                    threads(&quot;${BSDthreads}&quot;)),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
@@ -61,26 +64,27 @@
     &quot;debug-ben-macos&quot; =&gt; {
         cc               =&gt; &quot;cc&quot;,
         cflags           =&gt; &quot;$gcc_devteam_warn -DOPENSSL_NO_ASM -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -arch i386 -O3 -DL_ENDIAN -g3 -pipe&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
     &quot;debug-ben-no-opt&quot; =&gt; {
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot; -Wall -Wmissing-prototypes -Wstrict-prototypes -Wmissing-declarations -DDEBUG_SAFESTACK -Werror -DL_ENDIAN -Wall -g3&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
     &quot;debug-ben-strict&quot; =&gt; {
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;-DBN_DEBUG -DREF_DEBUG -DCONF_DEBUG -DBN_CTX_DEBUG -DCONST_STRICT -O2 -Wall -Wshadow -Werror -Wpointer-arith -Wcast-qual -Wwrite-strings -pipe&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
     },
     &quot;debug-ben-darwin64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;x86_64_asm&quot; ],
         cc               =&gt; &quot;cc&quot;,
-        cflags           =&gt; &quot;$gcc_devteam_warn -Wno-language-extension-token -Wno-extended-offsetof -arch x86_64 -O3 -DL_ENDIAN -DMD32_REG_T=int -Wall&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
+        cflags           =&gt; combine(&quot;$gcc_devteam_warn -Wno-language-extension-token -Wno-extended-offsetof -arch x86_64 -O3 -DL_ENDIAN -DMD32_REG_T=int -Wall&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
         sys_id           =&gt; &quot;MACOSX&quot;,
         plib_lflags      =&gt; &quot;-Wl,-search_paths_first&quot;,
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;macosx&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;darwin-shared&quot;,
diff --git a/Configurations/99-personal-bodo.conf b/Configurations/99-personal-bodo.conf
index 24c0e1e..df9b49c 100644
--- a/Configurations/99-personal-bodo.conf
+++ b/Configurations/99-personal-bodo.conf
@@ -5,10 +5,11 @@
     &quot;debug-bodo&quot; =&gt; {
         inherit_from     =&gt; [ &quot;x86_64_asm&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;$gcc_devteam_warn -Wno-error=overlength-strings -DBN_DEBUG -DBN_DEBUG_RAND -DCONF_DEBUG -m64 -DL_ENDIAN -DTERMIO -g -DMD32_REG_T=int&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; combine(&quot;$gcc_devteam_warn -Wno-error=overlength-strings -DBN_DEBUG -DBN_DEBUG_RAND -DCONF_DEBUG -m64 -DL_ENDIAN -DTERMIO -g -DMD32_REG_T=int&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot; &quot;,&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
diff --git a/Configurations/99-personal-geoff.conf b/Configurations/99-personal-geoff.conf
index 89ba499..5bddfae 100644
--- a/Configurations/99-personal-geoff.conf
+++ b/Configurations/99-personal-geoff.conf
@@ -4,10 +4,11 @@
 %targets = (
     &quot;debug-geoff32&quot; =&gt; {
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DBN_DEBUG -DBN_DEBUG_RAND -DBN_STRICT -DOPENSSL_NO_DEPRECATED -DOPENSSL_NO_ASM -DOPENSSL_NO_INLINE_ASM -DL_ENDIAN -DTERMIO -DPEDANTIC -O1 -ggdb2 -Wall -Werror -Wundef -pedantic -Wshadow -Wpointer-arith -Wbad-function-cast -Wcast-align -Wsign-compare -Wmissing-prototypes -Wmissing-declarations -Wno-long-long&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; combine(&quot;-DBN_DEBUG -DBN_DEBUG_RAND -DBN_STRICT -DOPENSSL_NO_DEPRECATED -DOPENSSL_NO_ASM -DOPENSSL_NO_INLINE_ASM -DL_ENDIAN -DTERMIO -DPEDANTIC -O1 -ggdb2 -Wall -Werror -Wundef -pedantic -Wshadow -Wpointer-arith -Wbad-function-cast -Wcast-align -Wsign-compare -Wmissing-prototypes -Wmissing-declarations -Wno-long-long&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot; &quot;,&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -15,10 +16,11 @@
     },
     &quot;debug-geoff64&quot; =&gt; {
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;-DBN_DEBUG -DBN_DEBUG_RAND -DBN_STRICT -DOPENSSL_NO_DEPRECATED -DOPENSSL_NO_ASM -DOPENSSL_NO_INLINE_ASM -DL_ENDIAN -DTERMIO -DPEDANTIC -O1 -ggdb2 -Wall -Werror -Wundef -pedantic -Wshadow -Wpointer-arith -Wbad-function-cast -Wcast-align -Wsign-compare -Wmissing-prototypes -Wmissing-declarations -Wno-long-long&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; combine(&quot;-DBN_DEBUG -DBN_DEBUG_RAND -DBN_STRICT -DOPENSSL_NO_DEPRECATED -DOPENSSL_NO_ASM -DOPENSSL_NO_INLINE_ASM -DL_ENDIAN -DTERMIO -DPEDANTIC -O1 -ggdb2 -Wall -Werror -Wundef -pedantic -Wshadow -Wpointer-arith -Wbad-function-cast -Wcast-align -Wsign-compare -Wmissing-prototypes -Wmissing-declarations -Wno-long-long&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot; &quot;,&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
diff --git a/Configurations/99-personal-levitte.conf b/Configurations/99-personal-levitte.conf
index 9db343e..d1ddf2e 100644
--- a/Configurations/99-personal-levitte.conf
+++ b/Configurations/99-personal-levitte.conf
@@ -1,18 +1,26 @@
 ## -*- mode: perl; -*-
 ## Personal configuration targets
 
+sub picker {
+    my %opts = @_;
+    return sub { add($opts{default} || (),
+                     $opts{$config{build_type}} || ())-&gt;(); }
+}
+
 %targets = (
     &quot;levitte-linux-elf&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-elf&quot; ],
-        debug_cflags     =&gt; add(&quot;-ggdb -g3&quot;),
-        debug_defines    =&gt; add(&quot;LEVITTE_DEBUG&quot;, { separator =&gt; undef }),
+        cflags           =&gt; add(picker(debug =&gt; &quot;-ggdb -g3&quot;)),
+        defines          =&gt; add(picker(debug =&gt; &quot;LEVITTE_DEBUG&quot;),
+                                { separator =&gt; undef }),
         build_scheme     =&gt; [ &quot;unified&quot;, &quot;unix&quot; ],
         build_file       =&gt; &quot;Makefile&quot;,
     },
     &quot;levitte-linux-x86_64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-x86_64&quot; ],
-        debug_cflags     =&gt; add(&quot;-ggdb -g3&quot;),
-        debug_defines    =&gt; add(&quot;LEVITTE_DEBUG&quot;, { separator =&gt; undef }),
+        cflags           =&gt; add(picker(debug =&gt; &quot;-ggdb -g3&quot;)),
+        defines          =&gt; add(picker(debug =&gt; &quot;LEVITTE_DEBUG&quot;),
+                                { separator =&gt; undef }),
         build_scheme     =&gt; [ &quot;unified&quot;, &quot;unix&quot; ],
         build_file       =&gt; &quot;Makefile&quot;,
     },
diff --git a/Configurations/99-personal-rse.conf b/Configurations/99-personal-rse.conf
index ecb4742..9999fcd 100644
--- a/Configurations/99-personal-rse.conf
+++ b/Configurations/99-personal-rse.conf
@@ -6,7 +6,7 @@
         inherit_from     =&gt; [ &quot;x86_elf_asm&quot; ],
         cc               =&gt; &quot;cc&quot;,
         cflags           =&gt; &quot;-DL_ENDIAN -pipe -O -g -ggdb3 -Wall&quot;,
-        thread_cflag     =&gt; &quot;(unknown)&quot;,
+        thread_scheme    =&gt; &quot;(unknown)&quot;,
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
     },
 );
diff --git a/Configurations/99-personal-steve.conf b/Configurations/99-personal-steve.conf
index bf9dbf4..473fd24 100644
--- a/Configurations/99-personal-steve.conf
+++ b/Configurations/99-personal-steve.conf
@@ -5,10 +5,11 @@
     &quot;debug-steve64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;x86_64_asm&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;$gcc_devteam_warn -pthread -m64 -DL_ENDIAN -DTERMIO -DCONF_DEBUG -g&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; combine(&quot;$gcc_devteam_warn -pthread -m64 -DL_ENDIAN -DTERMIO -DCONF_DEBUG -g&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot; &quot;,&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
@@ -19,11 +20,12 @@
     &quot;debug-steve32&quot; =&gt; {
         inherit_from     =&gt; [ &quot;x86_elf_asm&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;$gcc_devteam_warn -pthread -m32 -DL_ENDIAN -DCONF_DEBUG -g&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
+        cflags           =&gt; combine(&quot;$gcc_devteam_warn -pthread -m32 -DL_ENDIAN -DCONF_DEBUG -g&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
         lflags           =&gt; &quot;-rdynamic&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        ex_libs          =&gt; add(&quot; &quot;,&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;BN_LLONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -33,10 +35,11 @@
     &quot;debug-steve-opt&quot; =&gt; {
         inherit_from     =&gt; [ &quot;x86_64_asm&quot; ],
         cc               =&gt; &quot;gcc&quot;,
-        cflags           =&gt; &quot;$gcc_devteam_warn -pthread -m64 -O3 -DL_ENDIAN -DTERMIO -DCONF_DEBUG -g&quot;,
-        thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
-        ex_libs          =&gt; &quot;-ldl&quot;,
+        cflags           =&gt; combine(&quot;$gcc_devteam_warn -pthread -m64 -O3 -DL_ENDIAN -DTERMIO -DCONF_DEBUG -g&quot;,
+                                    threads(&quot;-D_REENTRANT&quot;)),
+        ex_libs          =&gt; add(&quot; &quot;,&quot;-ldl&quot;),
         bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
+        thread_scheme    =&gt; &quot;pthreads&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
diff --git a/Configurations/README b/Configurations/README
index 1885157..afc6004 100644
--- a/Configurations/README
+++ b/Configurations/README
@@ -28,30 +28,6 @@ In each table entry, the following keys are significant:
                            given here, they MUST be as an array of the
                            string such as &quot;MACRO=value&quot;, or just
                            &quot;MACRO&quot; for definitions without value.
-        debug_cflags    =&gt; Extra compilation flags used when making a
-                           debug build (when Configure receives the
-                           --debug option).  Typically something like
-                           &quot;-g -O0&quot;.
-        debug_defines   =&gt; Similarly to `debug_cflags', this gets
-                           combined with `defines' during a debug
-                           build.  The value here MUST also be an
-                           array of the same form as for `defines'.
-        release_cflags  =&gt; Extra compilation flags used when making a
-                           release build (when Configure receives the
-                           --release option, or doesn't receive the
-                           --debug option).  Typically something like
-                           &quot;-O&quot; or &quot;-O3&quot;.
-        release_defines =&gt; Similarly to `release_cflags', this gets
-                           combined with `defines' during a release
-                           build.  The value here MUST also be an
-                           array of the same form as for `defines'.
-        thread_cflags   =&gt; Extra compilation flags used when
-                           compiling with threading enabled.
-                           Explained further below.  [2]
-        thread_defines  =&gt; Similarly to `thread_cflags', this gets
-                           combined with `defines' when threading is
-                           enabled.  The value here MUST also be an
-                           array of the same form as for `defines'.
         shared_cflag    =&gt; Extra compilation flags used when
                            compiling for shared libraries, typically
                            something like &quot;-fPIC&quot;.
@@ -70,9 +46,6 @@ In each table entry, the following keys are significant:
         ex_libs         =&gt; Extra libraries that are needed when
                            linking.
 
-        debug_lflags    =&gt; Like debug_cflags, but used when linking.
-        release_lflags  =&gt; Like release_cflags, but used when linking.
-
         ar              =&gt; The library archive command, the default is
                            &quot;ar&quot;.
                            (NOTE: this is here for future use, it's
@@ -97,6 +70,14 @@ In each table entry, the following keys are significant:
                            this is here for future use, it's not
                            implemented yet)
 
+        thread_scheme   =&gt; The type of threads is used on the
+                           configured platform.  Currently known
+                           values are &quot;(unknown)&quot;, &quot;pthreads&quot;,
+                           &quot;uithreads&quot; (a.k.a solaris threads) and
+                           &quot;winthreads&quot;.  Except for &quot;(unknown)&quot;, the
+                           actual value is currently ignored but may
+                           be used in the future.  See further notes
+                           below [2].
         dso_scheme      =&gt; The type of dynamic shared objects to build
                            for.  This mostly comes into play with
                            engines, but can be used for other purposes
@@ -265,7 +246,7 @@ In each table entry, the following keys are significant:
         }
 
 [2] OpenSSL is built with threading capabilities unless the user
-    specifies 'no-threads'.  The value of the key 'thread_cflags' may
+    specifies 'no-threads'.  The value of the key 'thread_scheme' may
     be &quot;(unknown)&quot;, in which case the user MUST give some compilation
     flags to Configure.
 
diff --git a/Configurations/descrip.mms.tmpl b/Configurations/descrip.mms.tmpl
index 5c575d0..ef59d42 100644
--- a/Configurations/descrip.mms.tmpl
+++ b/Configurations/descrip.mms.tmpl
@@ -126,10 +126,10 @@ OPENSSLDIR={- catdir($config{openssldir}) ||
 ENGINESDIR={- $osslprefix -}ENGINES:
 
 CC= {- $target{cc} -}
-CFLAGS= /DEFINE=({- join(&quot;,&quot;, @{$config{defines}},&quot;OPENSSLDIR=\&quot;\&quot;\&quot;\$(OPENSSLDIR)\&quot;\&quot;\&quot;&quot;,&quot;ENGINESDIR=\&quot;\&quot;\&quot;\$(ENGINESDIR)\&quot;\&quot;\&quot;&quot;) -}) {- $config{cflags} -}
+CFLAGS= /DEFINE=({- join(&quot;,&quot;, @{$target{defines}}, @{$config{defines}},&quot;OPENSSLDIR=\&quot;\&quot;\&quot;\$(OPENSSLDIR)\&quot;\&quot;\&quot;&quot;,&quot;ENGINESDIR=\&quot;\&quot;\&quot;\$(ENGINESDIR)\&quot;\&quot;\&quot;&quot;) -}) {- $target{cflags} -} {- $config{cflags} -}
 DEPFLAG= /DEFINE=({- join(&quot;,&quot;, @{$config{depdefines}}) -})
-LDFLAGS= {- $config{lflags} -}
-EX_LIBS= {- $config{ex_libs} ? &quot;,&quot;.$config{ex_libs} : &quot;&quot; -}
+LDFLAGS= {- $target{lflags} -}
+EX_LIBS= {- $target{ex_libs} ? &quot;,&quot;.$target{ex_libs} : &quot;&quot; -}{- $config{ex_libs} ? &quot;,&quot;.$config{ex_libs} : &quot;&quot; -}
 
 PERL={- $config{perl} -}
 
diff --git a/Configurations/unix-Makefile.tmpl b/Configurations/unix-Makefile.tmpl
index 066f3d7..8ccadbb 100644
--- a/Configurations/unix-Makefile.tmpl
+++ b/Configurations/unix-Makefile.tmpl
@@ -144,13 +144,13 @@ HTMLSUFFIX=html
 
 CROSS_COMPILE= {- $config{cross_compile_prefix} -}
 CC= $(CROSS_COMPILE){- $target{cc} -}
-CFLAGS={- our $cflags2 = join(&quot; &quot;,(map { &quot;-D&quot;.$_} @{$config{defines}}),&quot;-DOPENSSLDIR=\&quot;\\\&quot;\$(OPENSSLDIR)\\\&quot;\&quot;&quot;,&quot;-DENGINESDIR=\&quot;\\\&quot;\$(ENGINESDIR)\\\&quot;\&quot;&quot;) -} {- $config{cflags} -}
+CFLAGS={- our $cflags2 = join(&quot; &quot;,(map { &quot;-D&quot;.$_} @{$target{defines}}, @{$config{defines}}),&quot;-DOPENSSLDIR=\&quot;\\\&quot;\$(OPENSSLDIR)\\\&quot;\&quot;&quot;,&quot;-DENGINESDIR=\&quot;\\\&quot;\$(ENGINESDIR)\\\&quot;\&quot;&quot;) -} {- $target{cflags} -} {- $config{cflags} -}
 CFLAGS_Q={- $cflags2 =~ s|([\\&quot;])|\\$1|g; $cflags2 -} {- $config{cflags} -}
-LDFLAGS= {- $config{lflags} -}
-PLIB_LDFLAGS= {- $config{plib_lflags} -}
-EX_LIBS= {- $config{ex_libs} -}
+LDFLAGS= {- $target{lflags} -}
+PLIB_LDFLAGS= {- $target{plib_lflags} -}
+EX_LIBS= {- $target{ex_libs} -} {- $config{ex_libs} -}
 SHARED_CFLAGS={- $target{shared_cflag} || &quot;&quot; -}
-SHARED_LDFLAGS={- $target{shared_ldflag}
+SHARED_LDFLAGS={- $target{shared_ldflag}.&quot; &quot;.$config{shared_ldflag}
                   # Unlike other OSes (like Solaris, Linux, Tru64,
                   # IRIX) BSD run-time linkers (tested OpenBSD, NetBSD
                   # and FreeBSD) &quot;demand&quot; RPATH set on .so objects.
diff --git a/Configure b/Configure
index 96be541..28339f1 100755
--- a/Configure
+++ b/Configure
@@ -124,7 +124,7 @@ my $strict_warnings = 0;
 # which has to be accompanied by explicit -D_THREAD_SAFE and
 # sometimes -D_REENTRANT. FreeBSD 5.x expands it as -lc_r, which
 # seems to be sufficient?
-my $BSDthreads=&quot;-pthread -D_THREAD_SAFE -D_REENTRANT&quot;;
+our $BSDthreads=&quot;-pthread -D_THREAD_SAFE -D_REENTRANT&quot;;
 
 #
 # API compability name to version number mapping.
@@ -136,9 +136,9 @@ my $apitable = {
     &quot;0.9.8&quot; =&gt; &quot;0x00908000L&quot;,
 };
 
-my $base_target = &quot;BASE&quot;;   # The template that all other inherit from
 our %table = ();
 our %config = ();
+our %withargs = ();
 
 # Forward declarations ###############################################
 
@@ -208,7 +208,7 @@ $config{cross_compile_prefix}=&quot;&quot;;
 $config{fipslibdir}=&quot;/usr/local/ssl/fips-2.0/lib/&quot;;
 my $nofipscanistercheck=0;
 $config{baseaddr}=&quot;0xFB00000&quot;;
-my $threads=0;
+my $auto_threads=1;    # enable threads automatically? true by default
 my $default_ranlib;
 $config{fips}=0;
 
@@ -438,8 +438,7 @@ $config{openssl_other_defines}=[];
 my $libs=&quot;&quot;;
 my $target=&quot;&quot;;
 $config{options}=&quot;&quot;;
-my %withargs=();
-my $build_prefix = &quot;release_&quot;;
+$config{build_type} = &quot;release&quot;;
 
 my @argvcopy=@ARGV;
 
@@ -570,6 +569,8 @@ foreach (@argvcopy)
                         {
                         $disabled{$1} = &quot;option&quot;;
                         }
+		# No longer an automatic choice
+		$auto_threads = 0 if ($1 eq &quot;threads&quot;);
 		}
 	elsif (/^enable-(.+)$/)
 		{
@@ -584,7 +585,8 @@ foreach (@argvcopy)
 		my $algo = $1;
 		delete $disabled{$algo};
 
-		$threads = 1 if ($algo eq &quot;threads&quot;);
+		# No longer an automatic choice
+		$auto_threads = 0 if ($1 eq &quot;threads&quot;);
 		}
 	elsif (/^--strict-warnings$/)
 		{
@@ -592,11 +594,11 @@ foreach (@argvcopy)
 		}
 	elsif (/^--debug$/)
 		{
-		$build_prefix = &quot;debug_&quot;;
+		$config{build_type} = &quot;debug&quot;;
 		}
 	elsif (/^--release$/)
 		{
-		$build_prefix = &quot;release_&quot;;
+		$config{build_type} = &quot;release&quot;;
 		}
 	elsif (/^386$/)
 		{ $config{processor}=386; }
@@ -827,7 +829,7 @@ print &quot;Configuring for $target\n&quot;;
 # Support for legacy targets having a name starting with 'debug-'
 my ($d, $t) = $target =~ m/^(debug-)?(.*)$/;
 if ($d) {
-    $build_prefix = &quot;debug_&quot;;
+    $config{build_type} = &quot;debug&quot;;
 
     # If we do not find debug-foo in the table, the target is set to foo.
     if (!$table{$target}) {
@@ -835,13 +837,11 @@ if ($d) {
     }
 }
 $config{target} = $target;
-delete $table{$base_target}-&gt;{template}; # or the next test will fail.
 my %target = resolve_config($target);
 
 &amp;usage if (!%target || $target{template});
 
-# Set up defaults
-my %target = ( %{$table{$base_target}}, %target );
+%target = ( %{$table{DEFAULTS}}, %target );
 
 $target{exe_extension}=&quot;&quot;;
 $target{exe_extension}=&quot;.exe&quot; if ($config{target} eq &quot;DJGPP&quot;
@@ -869,20 +869,10 @@ $target{nm} =      $ENV{'NM'}      || $target{nm}      || &quot;nm&quot;;
 # For cflags, lflags, plib_lflags, ex_libs and defines, add the debug_
 # or release_ attributes.
 # Do it in such a way that no spurious space is appended (hence the grep).
-$config{defines} = [ @{$target{defines}},
-                     @{$target{$build_prefix.&quot;defines&quot;}} ];
-$config{cflags} = join(&quot; &quot;,
-		       grep { $_ ne &quot;&quot; } ($target{cflags},
-					  $target{$build_prefix.&quot;cflags&quot;}));
-$config{lflags} = join(&quot; &quot;,
-		       grep { $_ ne &quot;&quot; } ($target{lflags},
-					  $target{$build_prefix.&quot;lflags&quot;}));
-$config{plib_lflags} = join(&quot; &quot;,
-			    grep { $_  ne &quot;&quot; } ($target{plib_lflags},
-					        $target{$build_prefix.&quot;plib_lflags&quot;}));
-$config{ex_libs} = join(&quot; &quot;,
-			grep { $_  ne &quot;&quot; } ($target{ex_libs},
-					    $target{$build_prefix.&quot;ex_libs&quot;}));
+$config{defines} = [];
+$config{cflags} = &quot;&quot;;
+$config{ex_libs} = &quot;&quot;;
+$config{shared_ldflag} = &quot;&quot;;
 
 # Make sure build_scheme is consistent.
 $target{build_scheme} = [ $target{build_scheme} ]
@@ -904,7 +894,7 @@ my ($builder, $builder_platform, @builder_opts) =
 if ($target =~ /^mingw/ &amp;&amp; `$target{cc} --target-help 2&gt;&amp;1` =~ m/-mno-cygwin/m)
 	{
 	$config{cflags} .= &quot; -mno-cygwin&quot;;
-	$target{shared_ldflag} .= &quot; -mno-cygwin&quot;;
+	$config{shared_ldflag} .= &quot; -mno-cygwin&quot;;
 	}
 
 if ($target =~ /linux.*-mips/ &amp;&amp; !$disabled{asm} &amp;&amp; $user_cflags !~ /-m(ips|arch=)/) {
@@ -928,81 +918,61 @@ if (!$disabled{dso} &amp;&amp; $target{dso_scheme} ne &quot;&quot;)
 	$target{dso_scheme} =~ tr/[a-z]/[A-Z]/;
 	if ($target{dso_scheme} eq &quot;DLFCN&quot;)
 		{
-		$config{defines} = [ &quot;DSO_DLFCN&quot;, &quot;HAVE_DLFCN_H&quot;,
-				     @{$config{defines}} ]
+		unshift @{$config{defines}}, &quot;DSO_DLFCN&quot;, &quot;HAVE_DLFCN_H&quot;;
 		}
 	elsif ($target{dso_scheme} eq &quot;DLFCN_NO_H&quot;)
 		{
-		$config{defines} = [ &quot;DSO_DLFCN&quot;, @{$config{defines}} ]
+		unshift @{$config{defines}}, &quot;DSO_DLFCN&quot;;
 		}
 	else
 		{
-		$config{defines} = [ &quot;DSO_$target{dso_scheme}&quot;,
-				     @{$config{defines}} ]
+		unshift @{$config{defines}}, &quot;DSO_$target{dso_scheme}&quot;;
 		}
 	}
 
-my $thread_cflags = &quot;&quot;;
-my @thread_defines;
-if ($target{thread_cflag} ne &quot;(unknown)&quot; &amp;&amp; !$disabled{threads})
-	{
-	# If we know how to do it, support threads by default.
-	$threads = 1;
-	}
-if ($target{thread_cflag} eq &quot;(unknown)&quot; &amp;&amp; $threads)
-	{
-	# If the user asked for &quot;threads&quot;, [s]he is also expected to
-	# provide any system-dependent compiler options that are
-	# necessary.
-	if ($no_user_cflags &amp;&amp; $no_user_defines)
-		{
-		print &quot;You asked for multi-threading support, but didn't\n&quot;;
-		print &quot;provide any system-specific compiler options\n&quot;;
-		exit(1);
-		}
-	push @thread_defines, &quot;OPENSSL_THREADS&quot;;
-	}
-else
-	{
-	$thread_cflags=&quot; $target{thread_cflag}&quot;;
-	push @thread_defines, @{$target{thread_defines}}, &quot;OPENSSL_THREADS&quot;;
-	}
-
 $config{ex_libs}=&quot;$libs$config{ex_libs}&quot; if ($libs ne &quot;&quot;);
 
 if ($disabled{asm})
 	{
-	@{$config{defines}} = grep !/^[BL]_ENDIAN$/, @{$config{defines}}
-	    if ($config{fips});
-	}
-
-if ($threads)
-	{
-	$config{cflags} = &quot;$thread_cflags $config{cflags}&quot; if $thread_cflags;
-	push @{$config{defines}}, @thread_defines;
-	push @{$config{openssl_thread_defines}}, @thread_defines;
-	}
-
-unless ($disabled{zlib})
-	{
-	push @{$config{defines}}, &quot;ZLIB&quot;;
-	if (defined($disabled{&quot;zlib-dynamic&quot;}))
-		{
-		if (defined($withargs{zlib_lib}))
-			{
-			$config{ex_libs} .= &quot; -L&quot; . $withargs{zlib_lib} . &quot; -lz&quot;;
-			}
-		else
-			{
-			$config{ex_libs} .= &quot; -lz&quot;;
-			}
-		}
-	else
+	if ($config{fips})
 		{
-		push @{$config{defines}}, &quot;ZLIB_SHARED&quot;;
+		@{$config{defines}} = grep !/^[BL]_ENDIAN$/, @{$config{defines}};
+		@{$target{defines}} = grep !/^[BL]_ENDIAN$/, @{$target{defines}};
 		}
 	}
 
+# If threads aren't disabled, check how possible they are
+unless ($disabled{threads}) {
+    if ($auto_threads) {
+        # Enabled by default, disable it forcibly if unavailable
+        if ($target{thread_scheme} eq &quot;(unknown)&quot;) {
+            $disabled{threads} = &quot;unavailable&quot;;
+        }
+    } else {
+        # The user chose to enable threads explicitely, let's see
+        # if there's a chance that's possible
+        if ($target{thread_scheme} eq &quot;(unknown)&quot;) {
+            # If the user asked for &quot;threads&quot; and we don't have internal
+            # knowledge how to do it, [s]he is expected to provide any
+            # system-dependent compiler options that are necessary.  We
+            # can't truly check that the given options are correct, but
+            # we expect the user to know what [s]He is doing.
+            if ($no_user_cflags &amp;&amp; $no_user_defines) {
+                die &quot;You asked for multi-threading support, but didn't\n&quot;
+                    ,&quot;provide any system-specific compiler options\n&quot;;
+            }
+        }
+    }
+}
+
+# If threads still aren't disabled, add a C macro to ensure the source
+# code knows about it.  Any other flag is taken care of by the configs.
+unless($disabled{threads}) {
+    foreach ((&quot;defines&quot;, &quot;openssl_thread_defines&quot;)) {
+        push @{$config{$_}}, &quot;OPENSSL_THREADS&quot;;
+    }
+}
+
 # With &quot;deprecated&quot; disable all deprecated features.
 if (defined($disabled{&quot;deprecated&quot;})) {
         $config{api} = $maxapi;
@@ -1047,7 +1017,7 @@ if ($target{sys_id} ne &quot;&quot;)
 	}
 
 unless ($disabled{asm}) {
-    $target{cpuid_asm_src}=$table{BASE}-&gt;{cpuid_asm_src} if ($config{processor} eq &quot;386&quot;);
+    $target{cpuid_asm_src}=$table{DEFAULTS}-&gt;{cpuid_asm_src} if ($config{processor} eq &quot;386&quot;);
     $target{bn_asm_src} =~ s/\w+-gf2m.c// if (defined($disabled{ec2m}));
 
     # bn-586 is the only one implementing bn_*_part_words
@@ -1070,7 +1040,7 @@ unless ($disabled{asm}) {
     if ($target{md5_asm_src}) {
 	push @{$config{defines}}, &quot;MD5_ASM&quot;;
     }
-    $target{cast_asm_src}=$table{BASE}-&gt;{cast_asm_src} unless $disabled{pic}; # CAST assembler is not PIC
+    $target{cast_asm_src}=$table{DEFAULTS}-&gt;{cast_asm_src} unless $disabled{pic}; # CAST assembler is not PIC
     if ($target{rmd160_asm_src}) {
 	push @{$config{defines}}, &quot;RMD160_ASM&quot;;
     }
@@ -1087,9 +1057,9 @@ unless ($disabled{asm}) {
     }
     if ($target{wp_asm_src} =~ /mmx/) {
         if ($config{processor} eq &quot;386&quot;) {
-	    $target{wp_asm_src}=$table{BASE}-&gt;{wp_asm_src};
+	    $target{wp_asm_src}=$table{DEFAULTS}-&gt;{wp_asm_src};
 	} elsif (!$disabled{&quot;whirlpool&quot;}) {
-	    $config{cflags}.=&quot; -DWHIRLPOOL_ASM&quot;;
+	    push @{$config{defines}}, &quot;WHIRLPOOL_ASM&quot;;
 	}
     }
     if ($target{modes_asm_src} =~ /ghash-/) {
@@ -1703,11 +1673,11 @@ close(OUT);
 
 print &quot;IsMK1MF       =&quot;, ($builder eq &quot;mk1mf&quot; ? &quot;yes&quot; : &quot;no&quot;), &quot;\n&quot;;
 print &quot;CC            =$target{cc}\n&quot;;
-print &quot;CFLAG         =$config{cflags}\n&quot;;
-print &quot;DEFINES       =&quot;,join(&quot; &quot;, @{$config{defines}}),&quot;\n&quot;;
-print &quot;LFLAG         =$config{lflags}\n&quot;;
-print &quot;PLIB_LFLAG    =$config{plib_lflags}\n&quot;;
-print &quot;EX_LIBS       =$config{ex_libs}\n&quot;;
+print &quot;CFLAG         =$target{cflags} $config{cflags}\n&quot;;
+print &quot;DEFINES       =&quot;,join(&quot; &quot;, @{$target{defines}}, @{$config{defines}}),&quot;\n&quot;;
+print &quot;LFLAG         =$target{lflags}\n&quot;;
+print &quot;PLIB_LFLAG    =$target{plib_lflags}\n&quot;;
+print &quot;EX_LIBS       =$target{ex_libs} $config{ex_libs}\n&quot;;
 print &quot;APPS_OBJ      =$target{apps_obj}\n&quot;;
 print &quot;CPUID_OBJ     =$target{cpuid_obj}\n&quot;;
 print &quot;UPLINK_OBJ    =$target{uplink_obj}\n&quot;;
@@ -1867,7 +1837,7 @@ print &lt;&lt;&quot;EOF&quot;;
 Configured for $target.
 EOF
 
-print &lt;&lt;&quot;EOF&quot; if (!$disabled{threads} &amp;&amp; !$threads);
+print &lt;&lt;&quot;EOF&quot; if ($disabled{threads} eq &quot;unavailable&quot;);
 
 The library could not be configured for supporting multi-threaded
 applications as the compiler options required on this system are not known.
@@ -1937,6 +1907,7 @@ sub asm {
     }
 }
 
+our $add_called = 0;
 # Helper function to implement adding values to already existing configuration
 # values.  It handles elements that are ARRAYs, CODEs and scalars
 sub _add {
@@ -1949,18 +1920,28 @@ sub _add {
 
     my @values =
 	map {
-	    if (ref($_) eq &quot;ARRAY&quot;) {
-		$found_array = 1;
-		@$_;
+	    my $res = $_;
+	    while (ref($res) eq &quot;CODE&quot;) {
+		$res = $res-&gt;();
+	    }
+	    if (defined($res)) {
+		if (ref($res) eq &quot;ARRAY&quot;) {
+		    $found_array = 1;
+		    @$res;
+		} else {
+		    $res;
+		}
 	    } else {
-		$_;
+		();
 	    }
     } (@_);
 
+    $add_called = 1;
+
     if ($found_array) {
 	[ @values ];
     } else {
-	join($separator, @values);
+	join($separator, grep { defined($_) &amp;&amp; $_ ne &quot;&quot; } @values);
     }
 }
 sub add_before {
@@ -2025,6 +2006,8 @@ sub resolve_config {
     my $target = shift;
     my @breadcrumbs = @_;
 
+    my $extra_checks = defined($ENV{CONFIGURE_EXTRA_CHECKS});
+
     if (grep { $_ eq $target } @breadcrumbs) {
 	die &quot;inherit_from loop!  target backtrace:\n  &quot;
 	    ,$target,&quot;\n  &quot;,join(&quot;\n  &quot;, @breadcrumbs),&quot;\n&quot;;
@@ -2080,7 +2063,35 @@ sub resolve_config {
     my %all_keys =
 	map { $_ =&gt; 1 } (keys %combined_inheritance,
 			 keys %{$table{$target}});
+
+    sub process_values {
+	my $object    = shift;
+	my $inherited = shift;  # Always a [ list ]
+	my $target    = shift;
+	my $entry     = shift;
+
+        $add_called = 0;
+
+        while(ref($object) eq &quot;CODE&quot;) {
+            $object = $object-&gt;(@$inherited);
+        }
+        if (!defined($object)) {
+            return ();
+        }
+        elsif (ref($object) eq &quot;ARRAY&quot;) {
+            local $add_called;  # To make sure recursive calls don't affect it
+            return [ map { process_values($_, $inherited, $target, $entry) }
+                     @$object ];
+        } elsif (ref($object) eq &quot;&quot;) {
+            return $object;
+        } else {
+            die &quot;cannot handle reference type &quot;,ref($object)
+                ,&quot; found in target &quot;,$target,&quot; -&gt; &quot;,$entry,&quot;\n&quot;;
+        }
+    }
+
     foreach (sort keys %all_keys) {
+        my $previous = $combined_inheritance{$_};
 
 	# Current target doesn't have a value for the current key?
 	# Assign it the default combiner, the rest of this loop body
@@ -2089,20 +2100,16 @@ sub resolve_config {
 	    $table{$target}-&gt;{$_} = $default_combiner;
 	}
 
-	my $valuetype = ref($table{$target}-&gt;{$_});
-	if ($valuetype eq &quot;CODE&quot;) {
-	    # CODE reference, execute it with the inherited values as
-	    # arguments.
-	    $table{$target}-&gt;{$_} =
-		$table{$target}-&gt;{$_}-&gt;(@{$combined_inheritance{$_}});
-	} elsif ($valuetype eq &quot;ARRAY&quot; || $valuetype eq &quot;&quot;) {
-	    # ARRAY or Scalar, just leave it as is.
-	} else {
-	    # Some other type of reference that we don't handle.
-	    # Better to abort at this point.
-	    die &quot;cannot handle reference type $valuetype,&quot;
-		,&quot; found in target $target -&gt; $_\n&quot;;
-	}
+	$table{$target}-&gt;{$_} = process_values($table{$target}-&gt;{$_},
+					       $combined_inheritance{$_},
+					       $target, $_);
+        unless(defined($table{$target}-&gt;{$_})) {
+            delete $table{$target}-&gt;{$_};
+        }
+        if ($extra_checks &amp;&amp;
+            $previous &amp;&amp; !($add_called ||  $previous ~~ $table{$target}-&gt;{$_})) {
+            warn &quot;$_ got replaced in $target\n&quot;;
+        }
     }
 
     # Finally done, return the result.
@@ -2177,22 +2184,11 @@ sub print_table_entry
 	&quot;cc&quot;,
 	&quot;cflags&quot;,
 	&quot;defines&quot;,
-	&quot;debug_cflags&quot;,
-	&quot;debug_defines&quot;,
-	&quot;release_cflags&quot;,
-	&quot;release_defines&quot;,
-	&quot;thread_cflag&quot;,
 	&quot;unistd&quot;,
 	&quot;ld&quot;,
 	&quot;lflags&quot;,
 	&quot;plib_lflags&quot;,
 	&quot;ex_libs&quot;,
-	&quot;debug_lflags&quot;,
-	&quot;debug_plib_lflags&quot;,
-	&quot;debug_ex_libs&quot;,
-	&quot;release_lflags&quot;,
-	&quot;release_plib_lflags&quot;,
-	&quot;release_ex_libs&quot;,
 	&quot;bn_ops&quot;,
 	&quot;cpuid_obj&quot;,
 	&quot;bn_obj&quot;,
@@ -2210,6 +2206,7 @@ sub print_table_entry
 	&quot;cmll_obj&quot;,
 	&quot;modes_obj&quot;,
 	&quot;padlock_obj&quot;,
+	&quot;thread_scheme&quot;,
 	&quot;perlasm_scheme&quot;,
 	&quot;dso_scheme&quot;,
 	&quot;shared_target&quot;,
diff --git a/Makefile.in b/Makefile.in
index bddbfdb..4286eb9 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -93,11 +93,11 @@ ENGINESDIR={- use File::Spec::Functions;
 
 CROSS_COMPILE= {- $config{cross_compile_prefix} -}
 CC= $(CROSS_COMPILE){- $target{cc} -}
-CFLAG={- our $cflags2 = join(&quot; &quot;,(map { &quot;-D&quot;.$_} @{$config{defines}},&quot;OPENSSLDIR=\&quot;\\\&quot;\$(OPENSSLDIR)\\\&quot;\&quot;&quot;,&quot;ENGINESDIR=\&quot;\\\&quot;\$(ENGINESDIR)\\\&quot;\&quot;&quot;)) -} {- $config{cflags} -}
+CFLAG={- our $cflags2 = join(&quot; &quot;,(map { &quot;-D&quot;.$_} @{$target{defines}}, @{$config{defines}}),&quot;-DOPENSSLDIR=\&quot;\\\&quot;\$(OPENSSLDIR)\\\&quot;\&quot;&quot;,&quot;-DENGINESDIR=\&quot;\\\&quot;\$(ENGINESDIR)\\\&quot;\&quot;&quot;) -} {- $target{cflags} -} {- $config{cflags} -}
 CFLAG_Q={- $cflags2 =~ s|([\\&quot;])|\\$1|g; $cflags2 -} {- $config{cflags} -}
 LDFLAG= {- $config{lflags} -}
 PLIB_LDFLAG= {- $config{plib_lflags} -}
-EX_LIBS= {- $config{ex_libs} -}
+EX_LIBS= {- $target{ex_libs} -} {- $config{ex_libs} -}
 EXE_EXT= {- $target{exe_extension} -}
 ARFLAGS= {- $target{arflags} -}
 AR=$(CROSS_COMPILE){- $target{ar} -} $(ARFLAGS) r
@@ -196,7 +196,7 @@ SHARED_CRYPTO=libcrypto$(SHLIB_EXT)
 SHARED_SSL=libssl$(SHLIB_EXT)
 SHARED_LIBS={- $disabled{shared} ? '' : '$(SHARED_CRYPTO) $(SHARED_SSL)'  -}
 SHARED_CFLAG={- $target{shared_cflag} -}
-SHARED_LDFLAG={- $target{shared_ldflag}
+SHARED_LDFLAG={- $target{shared_ldflag}.&quot; &quot;.$config{shared_ldflag}
                  # Unlike other OSes (like Solaris, Linux, Tru64,
                  # IRIX) BSD run-time linkers (tested OpenBSD, NetBSD
                  # and FreeBSD) &quot;demand&quot; RPATH set on .so objects.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004815.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="004822.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4818">[ date ]</a>
              <a href="thread.html#4818">[ thread ]</a>
              <a href="subject.html#4818">[ subject ]</a>
              <a href="author.html#4818">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
