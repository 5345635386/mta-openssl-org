<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2016-March/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1457518177.351285.1767.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005244.html">
   <LINK REL="Next"  HREF="005246.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Richard Levitte</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1457518177.351285.1767.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">levitte at openssl.org
       </A><BR>
    <I>Wed Mar  9 10:09:37 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="005244.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="005246.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5245">[ date ]</a>
              <a href="thread.html#5245">[ thread ]</a>
              <a href="subject.html#5245">[ subject ]</a>
              <a href="author.html#5245">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  81e61d7cb51988a0cde11c3b924052213b50d979 (commit)
       via  e87e380a179d14284cd5d6cd65a52ace7a98de45 (commit)
       via  3c9d51ce8ba51a8ef7b58f1f07c8d9c9df2ca665 (commit)
       via  ac9888e5a9cc7b581323614c615b669f655512a1 (commit)
       via  fe7f8263afc2ad906ac9b834ae6dc7a2ed25c6b7 (commit)
       via  57c83b3c3a61796ecd0e2e87109176ac9f8eae30 (commit)
       via  4f0d5f1849fba056ae2e626dbce976efc4586383 (commit)
       via  3aa3af68a52ed8e6fba9c5a7659943714593ac88 (commit)
       via  6d33da3487143023b176ebe8164cf05df6f5fbf6 (commit)
       via  73d2fb66efdb63d419f0663b3f41b7db4b14fcd3 (commit)
       via  5384d1e4ebd58f31a06b2f5d1f6c4b28f63d72ed (commit)
       via  db1983980b1a8978f65ce631aae48b5769a803c6 (commit)
       via  df0cb57ca3528ed0dd5ba47e77d724dc761a454d (commit)
       via  a4b4bb086bf9de74b3fce00c32d427c003506272 (commit)
       via  0a4edb931b883b9973721ae012e60c028387dd50 (commit)
       via  184bc45f683c76531d7e065b6553ca9086564576 (commit)
       via  10eab320a5e4b585f640b5f11d21eebaebb1814a (commit)
      from  71a07ca7bf207ccc795330441da76b02c7261091 (commit)


- Log -----------------------------------------------------------------
commit 81e61d7cb51988a0cde11c3b924052213b50d979
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:50:21 2016 +0100

    Unified - adapt the generation of whirlpool assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/whrlpool/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit e87e380a179d14284cd5d6cd65a52ace7a98de45
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:49:53 2016 +0100

    Unified - adapt the generation of sha assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/sha/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 3c9d51ce8ba51a8ef7b58f1f07c8d9c9df2ca665
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:48:49 2016 +0100

    Unified - adapt the generation of rc4 assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/rc4/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit ac9888e5a9cc7b581323614c615b669f655512a1
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:49:09 2016 +0100

    Unified - adapt the generation of rc5 assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/rc5/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit fe7f8263afc2ad906ac9b834ae6dc7a2ed25c6b7
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:49:34 2016 +0100

    Unified - adapt the generation of ripemd assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/ripemd/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 57c83b3c3a61796ecd0e2e87109176ac9f8eae30
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:47:35 2016 +0100

    Unified - adapt the generation of md5 assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/md5/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 4f0d5f1849fba056ae2e626dbce976efc4586383
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:47:57 2016 +0100

    Unified - adapt the generation of modes assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/modes/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 3aa3af68a52ed8e6fba9c5a7659943714593ac88
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:48:25 2016 +0100

    Unified - adapt the generation of poly1305 assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/poly1305/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 6d33da3487143023b176ebe8164cf05df6f5fbf6
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:46:42 2016 +0100

    Unified - adapt the generation of des assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/des/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 73d2fb66efdb63d419f0663b3f41b7db4b14fcd3
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:47:09 2016 +0100

    Unified - adapt the generation of ec assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/ec/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 5384d1e4ebd58f31a06b2f5d1f6c4b28f63d72ed
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:43:26 2016 +0100

    Unified - adapt the generation of camellia assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/camellia/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit db1983980b1a8978f65ce631aae48b5769a803c6
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:45:39 2016 +0100

    Unified - adapt the generation of cast assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/cast/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit df0cb57ca3528ed0dd5ba47e77d724dc761a454d
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:46:17 2016 +0100

    Unified - adapt the generation of chacha assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/chacha/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit a4b4bb086bf9de74b3fce00c32d427c003506272
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 19:48:17 2016 +0100

    Because crypto/build.info demands CFLAGS_Q, descrip.mms.tmpl must deliver
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 0a4edb931b883b9973721ae012e60c028387dd50
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:00:45 2016 +0100

    Unified - adapt the generation of cpuid, uplink and buildinf to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 184bc45f683c76531d7e065b6553ca9086564576
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:07:35 2016 +0100

    Unified - adapt the generation of aes assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/aes/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

commit 10eab320a5e4b585f640b5f11d21eebaebb1814a
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Mar 7 15:13:01 2016 +0100

    Unified - adapt the generation of blowfish assembler to use GENERATE
    
    This gets rid of the BEGINRAW..ENDRAW sections in crypto/bf/build.info.
    
    This also moves the assembler generating perl scripts to take the
    output file name as last command line argument, where necessary.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

-----------------------------------------------------------------------

Summary of changes:
 Configurations/descrip.mms.tmpl          |   1 +
 crypto/Makefile.in                       |  12 ++--
 crypto/aes/Makefile.in                   |  20 +++---
 crypto/aes/asm/aes-586.pl                |   6 ++
 crypto/aes/asm/aesni-x86.pl              |   6 ++
 crypto/aes/asm/vpaes-x86.pl              |   6 ++
 crypto/aes/build.info                    |  81 ++++++++++-------------
 crypto/alphacpuid.pl                     |   6 ++
 crypto/bf/Makefile.in                    |   2 +-
 crypto/bf/asm/bf-586.pl                  |   5 ++
 crypto/bf/build.info                     |   8 +--
 crypto/build.info                        |  43 ++++--------
 crypto/camellia/Makefile.in              |   4 +-
 crypto/camellia/asm/cmll-x86.pl          |   5 ++
 crypto/camellia/build.info               |  13 ++--
 crypto/cast/Makefile.in                  |   2 +-
 crypto/cast/asm/cast-586.pl              |   5 ++
 crypto/cast/build.info                   |   8 +--
 crypto/chacha/Makefile.in                |   4 +-
 crypto/chacha/asm/chacha-c64xplus.pl     |   3 +
 crypto/chacha/asm/chacha-x86.pl          |   5 ++
 crypto/chacha/build.info                 |  11 ++--
 crypto/des/Makefile.in                   |   4 +-
 crypto/des/asm/crypt586.pl               |   5 ++
 crypto/des/asm/des-586.pl                |   5 ++
 crypto/des/build.info                    |  17 ++---
 crypto/ec/Makefile.in                    |   6 +-
 crypto/ec/asm/ecp_nistz256-x86.pl        |   5 ++
 crypto/ec/build.info                     |  14 ++--
 crypto/md5/Makefile.in                   |   4 +-
 crypto/md5/asm/md5-586.pl                |   5 ++
 crypto/md5/build.info                    |  12 ++--
 crypto/modes/Makefile.in                 |  10 +--
 crypto/modes/asm/ghash-alpha.pl          |   2 +-
 crypto/modes/asm/ghash-ia64.pl           |   2 +-
 crypto/modes/asm/ghash-x86.pl            |   5 ++
 crypto/modes/build.info                  |  31 +++------
 crypto/poly1305/Makefile.in              |   4 +-
 crypto/poly1305/asm/poly1305-c64xplus.pl |   3 +
 crypto/poly1305/asm/poly1305-sparcv9.pl  |   3 +
 crypto/poly1305/asm/poly1305-x86.pl      |   5 ++
 crypto/poly1305/build.info               |  17 ++---
 crypto/rc4/Makefile.in                   |   8 +--
 crypto/rc4/asm/rc4-586.pl                |   4 ++
 crypto/rc4/asm/rc4-ia64.pl               |   5 ++
 crypto/rc4/build.info                    |  18 ++----
 crypto/rc5/Makefile.in                   |   2 +-
 crypto/rc5/asm/rc5-586.pl                |   5 ++
 crypto/rc5/build.info                    |   8 +--
 crypto/ripemd/Makefile.in                |   2 +-
 crypto/ripemd/asm/rmd-586.pl             |   5 ++
 crypto/ripemd/build.info                 |   8 +--
 crypto/sha/Makefile.in                   |  20 +++---
 crypto/sha/asm/sha1-586.pl               |   5 ++
 crypto/sha/asm/sha1-ia64.pl              |   4 +-
 crypto/sha/asm/sha256-586.pl             |   5 ++
 crypto/sha/asm/sha512-586.pl             |   5 ++
 crypto/sha/asm/sha512-ia64.pl            |   2 +-
 crypto/sha/build.info                    | 108 ++++++++++++-------------------
 crypto/whrlpool/Makefile.in              |   4 +-
 crypto/whrlpool/asm/wp-mmx.pl            |   5 ++
 crypto/whrlpool/build.info               |   9 +--
 crypto/x86cpuid.pl                       |   6 ++
 ms/uplink-x86.pl                         |   5 ++
 64 files changed, 339 insertions(+), 319 deletions(-)

diff --git a/Configurations/descrip.mms.tmpl b/Configurations/descrip.mms.tmpl
index 84213cc..294c422 100644
--- a/Configurations/descrip.mms.tmpl
+++ b/Configurations/descrip.mms.tmpl
@@ -129,6 +129,7 @@ ENGINESDIR={- $osslprefix -}ENGINES:
 
 CC= {- $target{cc} -}
 CFLAGS= /DEFINE=({- join(&quot;,&quot;, @{$target{defines}}, @{$config{defines}},&quot;OPENSSLDIR=\&quot;\&quot;\&quot;\$(OPENSSLDIR)\&quot;\&quot;\&quot;&quot;,&quot;ENGINESDIR=\&quot;\&quot;\&quot;\$(ENGINESDIR)\&quot;\&quot;\&quot;&quot;) -}) {- $target{cflags} -} {- $config{cflags} -}
+CFLAGS_Q=$(CFLAGS)
 DEPFLAG= /DEFINE=({- join(&quot;,&quot;, @{$config{depdefines}}) -})
 LDFLAGS= {- $target{lflags} -}
 EX_LIBS= {- $target{ex_libs} ? &quot;,&quot;.$target{ex_libs} : &quot;&quot; -}{- $config{ex_libs} ? &quot;,&quot;.$config{ex_libs} : &quot;&quot; -}
diff --git a/crypto/Makefile.in b/crypto/Makefile.in
index 9e407df..7a5a988 100644
--- a/crypto/Makefile.in
+++ b/crypto/Makefile.in
@@ -64,7 +64,7 @@ buildinf.h: ../Makefile
 	$(PERL) $(TOP)/util/mkbuildinf.pl &quot;$(CC) $(CFLAGS_Q)&quot; &quot;$(PLATFORM)&quot; &gt;buildinf.h
 
 x86cpuid.s:	x86cpuid.pl perlasm/x86asm.pl
-	$(PERL) x86cpuid.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) x86cpuid.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 
 applink.o:	$(TOP)/ms/applink.c
 	$(CC) $(CFLAGS) -c -o $@ $(TOP)/ms/applink.c
@@ -73,18 +73,18 @@ uplink.o:	$(TOP)/ms/uplink.c applink.o
 	$(CC) $(CFLAGS) -c -o $@ $(TOP)/ms/uplink.c
 
 uplink-x86.s:	$(TOP)/ms/uplink-x86.pl
-	$(PERL) $(TOP)/ms/uplink-x86.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) $(TOP)/ms/uplink-x86.pl $(PERLASM_SCHEME) $@
 
-x86_64cpuid.s:	x86_64cpuid.pl;	$(PERL) x86_64cpuid.pl $(PERLASM_SCHEME) &gt; $@
+x86_64cpuid.s:	x86_64cpuid.pl;	$(PERL) x86_64cpuid.pl $(PERLASM_SCHEME) $@
 ia64cpuid.s:	ia64cpuid.S;	$(CC) $(CFLAGS) -E ia64cpuid.S &gt; $@
 ppccpuid.s:	ppccpuid.pl;	$(PERL) ppccpuid.pl $(PERLASM_SCHEME) $@
 pariscid.s:	pariscid.pl;	$(PERL) pariscid.pl $(PERLASM_SCHEME) $@
 alphacpuid.s:	alphacpuid.pl
 	(preproc=$$$$.$@.S; trap &quot;rm $$preproc&quot; INT; \
-	$(PERL) alphacpuid.pl &gt; $$preproc &amp;&amp; \
+	$(PERL) alphacpuid.pl $$preproc &amp;&amp; \
 	$(CC) -E -P $$preproc &gt; $@ &amp;&amp; rm $$preproc)
-arm64cpuid.S:	arm64cpuid.pl;	$(PERL) arm64cpuid.pl $(PERLASM_SCHEME) &gt; $@
-armv4cpuid.S:	armv4cpuid.pl;	$(PERL) armv4cpuid.pl $(PERLASM_SCHEME) &gt; $@
+arm64cpuid.S:	arm64cpuid.pl;	$(PERL) arm64cpuid.pl $(PERLASM_SCHEME) $@
+armv4cpuid.S:	armv4cpuid.pl;	$(PERL) armv4cpuid.pl $(PERLASM_SCHEME) $@
 
 subdirs:
 	@target=all; $(RECURSIVE_MAKE)
diff --git a/crypto/aes/Makefile.in b/crypto/aes/Makefile.in
index 6ece343..0439245 100644
--- a/crypto/aes/Makefile.in
+++ b/crypto/aes/Makefile.in
@@ -45,26 +45,26 @@ aes-ia64.s: asm/aes-ia64.S
 	$(CC) $(CFLAGS) -E asm/aes-ia64.S &gt; $@
 
 aes-586.s:	asm/aes-586.pl ../perlasm/x86asm.pl
-	$(PERL) asm/aes-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) asm/aes-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 vpaes-x86.s:	asm/vpaes-x86.pl ../perlasm/x86asm.pl
-	$(PERL) asm/vpaes-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) asm/vpaes-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 aesni-x86.s:	asm/aesni-x86.pl ../perlasm/x86asm.pl
-	$(PERL) asm/aesni-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) asm/aesni-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 
 aes-x86_64.s: asm/aes-x86_64.pl
-	$(PERL) asm/aes-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/aes-x86_64.pl $(PERLASM_SCHEME) $@
 vpaes-x86_64.s:	asm/vpaes-x86_64.pl
-	$(PERL) asm/vpaes-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/vpaes-x86_64.pl $(PERLASM_SCHEME) $@
 bsaes-x86_64.s:	asm/bsaes-x86_64.pl
-	$(PERL) asm/bsaes-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/bsaes-x86_64.pl $(PERLASM_SCHEME) $@
 aesni-x86_64.s: asm/aesni-x86_64.pl
-	$(PERL) asm/aesni-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/aesni-x86_64.pl $(PERLASM_SCHEME) $@
 aesni-sha1-x86_64.s:	asm/aesni-sha1-x86_64.pl
-	$(PERL) asm/aesni-sha1-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/aesni-sha1-x86_64.pl $(PERLASM_SCHEME) $@
 aesni-sha256-x86_64.s:	asm/aesni-sha256-x86_64.pl
-	$(PERL) asm/aesni-sha256-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/aesni-sha256-x86_64.pl $(PERLASM_SCHEME) $@
 aesni-mb-x86_64.s:	asm/aesni-mb-x86_64.pl
-	$(PERL) asm/aesni-mb-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/aesni-mb-x86_64.pl $(PERLASM_SCHEME) $@
 
 aes-sparcv9.S: asm/aes-sparcv9.pl
 	$(PERL) asm/aes-sparcv9.pl $(PERLASM_SCHEME) $@
diff --git a/crypto/aes/asm/aes-586.pl b/crypto/aes/asm/aes-586.pl
index 767f204..5a7f1b4 100755
--- a/crypto/aes/asm/aes-586.pl
+++ b/crypto/aes/asm/aes-586.pl
@@ -191,6 +191,10 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output = pop;
+open OUT,&quot;&gt;$output&quot;;
+*STDOUT=*OUT;
+
 &amp;asm_init($ARGV[0],&quot;aes-586.pl&quot;,$x86only = $ARGV[$#ARGV] eq &quot;386&quot;);
 &amp;static_label(&quot;AES_Te&quot;);
 &amp;static_label(&quot;AES_Td&quot;);
@@ -2985,3 +2989,5 @@ sub deckey()
 &amp;asciz(&quot;AES for x86, CRYPTOGAMS by &lt;appro\@openssl.org&gt;&quot;);
 
 &amp;asm_finish();
+
+close STDOUT;
diff --git a/crypto/aes/asm/aesni-x86.pl b/crypto/aes/asm/aesni-x86.pl
index 536f035..b85d0c4 100644
--- a/crypto/aes/asm/aesni-x86.pl
+++ b/crypto/aes/asm/aesni-x86.pl
@@ -67,6 +67,10 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output = pop;
+open OUT,&quot;&gt;$output&quot;;
+*STDOUT=*OUT;
+
 &amp;asm_init($ARGV[0],$0);
 
 &amp;external_label(&quot;OPENSSL_ia32cap_P&quot;);
@@ -3398,3 +3402,5 @@ my ($l_,$block,$i1,$i3,$i5) = ($rounds_,$key_,$rounds,$len,$out);
 &amp;asciz(&quot;AES for Intel AES-NI, CRYPTOGAMS by &lt;appro\@openssl.org&gt;&quot;);
 
 &amp;asm_finish();
+
+close STDOUT;
diff --git a/crypto/aes/asm/vpaes-x86.pl b/crypto/aes/asm/vpaes-x86.pl
index 2ba149c..4fcd561 100644
--- a/crypto/aes/asm/vpaes-x86.pl
+++ b/crypto/aes/asm/vpaes-x86.pl
@@ -51,6 +51,10 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output = pop;
+open OUT,&quot;&gt;$output&quot;;
+*STDOUT=*OUT;
+
 &amp;asm_init($ARGV[0],&quot;vpaes-x86.pl&quot;,$x86only = $ARGV[$#ARGV] eq &quot;386&quot;);
 
 $PREFIX=&quot;vpaes&quot;;
@@ -901,3 +905,5 @@ $k_dsbo=0x2c0;		# decryption sbox final output
 &amp;function_end(&quot;${PREFIX}_cbc_encrypt&quot;);
 
 &amp;asm_finish();
+
+close STDOUT;
diff --git a/crypto/aes/build.info b/crypto/aes/build.info
index 40e01d3..3328abc 100644
--- a/crypto/aes/build.info
+++ b/crypto/aes/build.info
@@ -3,57 +3,42 @@ SOURCE[../../libcrypto]=\
         aes_misc.c aes_ecb.c aes_cfb.c aes_ofb.c \
         aes_ige.c aes_wrap.c {- $target{aes_asm_src} -}
 
+GENERATE[aes-ia64.s]=asm/aes-ia64.S
+
+GENERATE[aes-586.s]=asm/aes-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+DEPEND[aes-586.s]=../perlasm/x86asm.pl
+GENERATE[vpaes-x86.s]=asm/vpaes-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+DEPEND[vpaes-586.s]=../perlasm/x86asm.pl
+GENERATE[aesni-x86.s]=asm/aesni-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+DEPEND[aesni-586.s]=../perlasm/x86asm.pl
+
+GENERATE[aes-x86_64.s]=asm/aes-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[vpaes-x86_64.s]=asm/vpaes-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[bsaes-x86_64.s]=asm/bsaes-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[aesni-x86_64.s]=asm/aesni-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[aesni-sha1-x86_64.s]=asm/aesni-sha1-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[aesni-sha256-x86_64.s]=asm/aesni-sha256-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[aesni-mb-x86_64.s]=asm/aesni-mb-x86_64.pl $(PERLASM_SCHEME)
+
+GENERATE[aes-sparcv9.S]=asm/aes-sparcv9.pl $(PERLASM_SCHEME)
+GENERATE[aest4-sparcv9.S]=asm/aest4-sparcv9.pl $(PERLASM_SCHEME)
+DEPEND[aest4-sparcv9.S]=../perlasm/sparcv9_modes.pl
+
+GENERATE[aes-ppc.s]=asm/aes-ppc.pl $(PERLASM_SCHEME)
+GENERATE[vpaes-ppc.s]=asm/vpaes-ppc.pl $(PERLASM_SCHEME)
+GENERATE[aesp8-ppc.s]=asm/aesp8-ppc.pl $(PERLASM_SCHEME)
+
+GENERATE[aes-parisc.s]=asm/aes-parisc.pl $(PERLASM_SCHEME)
+
+GENERATE[aes-mips.S]=asm/aes-mips.pl $(PERLASM_SCHEME)
+
+GENERATE[aesv8-armx.S]=asm/aesv8-armx.pl $(PERLASM_SCHEME)
+GENERATE[vpaes-armv8.S]=asm/vpaes-armv8.pl $(PERLASM_SCHEME)
+
+
 BEGINRAW[Makefile]
 ##### AES assembler implementations
 
-{- $builddir -}/aes-ia64.s: {- $sourcedir -}/asm/aes-ia64.S
-	$(CC) $(CFLAGS) -E asm/aes-ia64.S &gt; $@
-
-{- $builddir -}/aes-586.s:	{- $sourcedir -}/asm/aes-586.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aes-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
-{- $builddir -}/vpaes-x86.s:	{- $sourcedir -}/asm/vpaes-x86.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/vpaes-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
-{- $builddir -}/aesni-x86.s:	{- $sourcedir -}/asm/aesni-x86.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aesni-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
-
-{- $builddir -}/aes-x86_64.s: {- $sourcedir -}/asm/aes-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aes-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/vpaes-x86_64.s:	{- $sourcedir -}/asm/vpaes-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/vpaes-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/bsaes-x86_64.s:	{- $sourcedir -}/asm/bsaes-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/bsaes-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/aesni-x86_64.s: {- $sourcedir -}/asm/aesni-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aesni-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/aesni-sha1-x86_64.s:	{- $sourcedir -}/asm/aesni-sha1-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aesni-sha1-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/aesni-sha256-x86_64.s:	{- $sourcedir -}/asm/aesni-sha256-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aesni-sha256-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/aesni-mb-x86_64.s:	{- $sourcedir -}/asm/aesni-mb-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aesni-mb-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-
-{- $builddir -}/aes-sparcv9.S: {- $sourcedir -}/asm/aes-sparcv9.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aes-sparcv9.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/aest4-sparcv9.s: {- $sourcedir -}/asm/aest4-sparcv9.pl {- $sourcetop -}/crypto/perlasm/sparcv9_modes.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aest4-sparcv9.pl $(PERLASM_SCHEME) $@
-
-{- $builddir -}/aes-ppc.s:	{- $sourcedir -}/asm/aes-ppc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aes-ppc.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/vpaes-ppc.s:	{- $sourcedir -}/asm/vpaes-ppc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/vpaes-ppc.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/aesp8-ppc.s:	{- $sourcedir -}/asm/aesp8-ppc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aesp8-ppc.pl $(PERLASM_SCHEME) $@
-
-{- $builddir -}/aes-parisc.s:	{- $sourcedir -}/asm/aes-parisc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aes-parisc.pl $(PERLASM_SCHEME) $@
-
-{- $builddir -}/aes-mips.S:	{- $sourcedir -}/asm/aes-mips.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aes-mips.pl $(PERLASM_SCHEME) $@
-
-{- $builddir -}/aesv8-armx.S:	{- $sourcedir -}/asm/aesv8-armx.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aesv8-armx.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/vpaes-armv8.S:	{- $sourcedir -}/asm/vpaes-armv8.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/vpaes-armv8.pl $(PERLASM_SCHEME) $@
-
 # GNU make &quot;catch all&quot;
 {- $builddir -}/aes-%.S:	{- $sourcedir -}/asm/aes-%.pl
 	CC=&quot;$(CC)&quot; $(PERL) $&lt; $(PERLASM_SCHEME) $@
diff --git a/crypto/alphacpuid.pl b/crypto/alphacpuid.pl
index 5b0e21b..8af0f09 100644
--- a/crypto/alphacpuid.pl
+++ b/crypto/alphacpuid.pl
@@ -1,4 +1,8 @@
 #!/usr/bin/env perl
+
+$output = pop;
+open STDOUT,&quot;&gt;$stdout&quot;;
+
 print &lt;&lt;'___';
 .text
 
@@ -214,3 +218,5 @@ OPENSSL_instrument_bus2:
 .end	OPENSSL_instrument_bus2
 ___
 }
+
+close STDOUT;
diff --git a/crypto/bf/Makefile.in b/crypto/bf/Makefile.in
index ee5c259..398844a 100644
--- a/crypto/bf/Makefile.in
+++ b/crypto/bf/Makefile.in
@@ -40,7 +40,7 @@ lib:	$(LIBOBJ)
 	@touch lib
 
 bf-586.s:	asm/bf-586.pl ../perlasm/x86asm.pl ../perlasm/cbc.pl
-	$(PERL) asm/bf-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) asm/bf-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 
 files:
 	$(PERL) $(TOP)/util/files.pl Makefile &gt;&gt; $(TOP)/MINFO
diff --git a/crypto/bf/asm/bf-586.pl b/crypto/bf/asm/bf-586.pl
index b74cfba..319a638 100644
--- a/crypto/bf/asm/bf-586.pl
+++ b/crypto/bf/asm/bf-586.pl
@@ -5,6 +5,9 @@ push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 require &quot;cbc.pl&quot;;
 
+$output = pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;bf-586.pl&quot;,$ARGV[$#ARGV] eq &quot;386&quot;);
 
 $BF_ROUNDS=16;
@@ -22,6 +25,8 @@ $tmp4=&quot;edx&quot;;
 &amp;cbc(&quot;BF_cbc_encrypt&quot;,&quot;BF_encrypt&quot;,&quot;BF_decrypt&quot;,1,4,5,3,-1,-1);
 &amp;asm_finish();
 
+close STDOUT;
+
 sub BF_encrypt
 	{
 	local($name,$enc)=@_;
diff --git a/crypto/bf/build.info b/crypto/bf/build.info
index 7d208d2..466f134 100644
--- a/crypto/bf/build.info
+++ b/crypto/bf/build.info
@@ -1,9 +1,5 @@
 LIBS=../../libcrypto
 SOURCE[../../libcrypto]=bf_skey.c bf_ecb.c bf_enc.c bf_cfb64.c bf_ofb64.c 
 
-BEGINRAW[Makefile]
-##### BF assembler implementations
-
-{- $builddir -}/bf-586.s:	{- $sourcedir -}/asm/bf-586.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl {- $sourcetop -}/crypto/perlasm/cbc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/bf-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
-ENDRAW[Makefile]
+GENERATE[bf-586.s]=asm/bf-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+DEPEND[bf-586.s]=../perlasm/x86asm.pl ../perlasm/cbc.pl
diff --git a/crypto/build.info b/crypto/build.info
index 471a9fd..01d3766 100644
--- a/crypto/build.info
+++ b/crypto/build.info
@@ -11,38 +11,19 @@ EXTRA=  ../ms/uplink-x86.pl ../ms/uplink.c ../ms/applink.c \
         ppccpuid.pl pariscid.pl alphacpuid.pl arm64cpuid.pl armv4cpuid.pl
 
 DEPEND[cversion.o]=buildinf.h
+GENERATE[buildinf.h]=../util/mkbuildinf.pl &quot;$(CC) $(CFLAGS_Q)&quot; &quot;$(PLATFORM)&quot;
+DEPEND[buildinf.h]=configdata.pm
 
-BEGINRAW[descrip.mms]
-[.crypto]buildinf.h : configdata.pm
-	$(PERL) {- catfile(catdir($sourcedir, &quot;[-]&quot;), &quot;util&quot;, &quot;mkbuildinf.pl&quot;) -} &quot;$(CC) $(CFLAGS)&quot; &quot;$(PLATFORM)&quot; &gt; [.crypto]buildinf.h
-ENDRAW[descrip.mms]
+GENERATE[uplink-x86.s]=../ms/uplink-x86.pl $(PERLASM_SCHEME)
 
-BEGINRAW[Makefile]
-crypto/buildinf.h : configdata.pm
-	$(PERL) $(SRCDIR)/util/mkbuildinf.pl &quot;$(CC) $(CFLAGS_Q)&quot; &quot;$(PLATFORM)&quot; &gt; crypto/buildinf.h
+GENERATE[x86cpuid.s]=x86cpuid.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+DEPEND[x86cpuid.s]=perlasm/x86asm.pl
 
-##### APPLINK, UPLINK and CPUID assembler implementations
+GENERATE[x86_64cpuid.s]=x86_64cpuid.pl $(PERLASM_SCHEME)
 
-{- $builddir -}/uplink-x86.s:	$(SRCDIR)/ms/uplink-x86.pl
-	CC=&quot;$(CC)&quot; $(PERL) $(SRCDIR)/ms/uplink-x86.pl $(PERLASM_SCHEME) &gt; $@
-
-{- $builddir -}/x86cpuid.s:	{- $sourcedir -}/x86cpuid.pl {- $sourcedir -}/perlasm/x86asm.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/x86cpuid.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
-
-{- $builddir -}/x86_64cpuid.s:	{- $sourcedir -}/x86_64cpuid.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/x86_64cpuid.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/ia64cpuid.s:	{- $sourcedir -}/ia64cpuid.S
-	$(CC) $(CFLAGS) -E {- $sourcedir -}/ia64cpuid.S &gt; $@
-{- $builddir -}/ppccpuid.s:	{- $sourcedir -}/ppccpuid.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/ppccpuid.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/pariscid.s:	{- $sourcedir -}/pariscid.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/pariscid.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/alphacpuid.s:	{- $sourcedir -}/alphacpuid.pl
-	(preproc=$$$$.$@.S; trap &quot;rm $$preproc&quot; INT; \
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/alphacpuid.pl &gt; $$preproc &amp;&amp; \
-	$(CC) -E -P $$preproc &gt; $@ &amp;&amp; rm $$preproc)
-{- $builddir -}/arm64cpuid.S:	{- $sourcedir -}/arm64cpuid.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/arm64cpuid.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/armv4cpuid.S:	{- $sourcedir -}/armv4cpuid.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/armv4cpuid.pl $(PERLASM_SCHEME) &gt; $@
-ENDRAW[Makefile]
+GENERATE[ia64cpuid.s]=ia64cpuid.S
+GENERATE[ppccpuid.s]=ppccpuid.pl $(PERLASM_SCHEM
+GENERATE[pariscid.s]=pariscid.pl $(PERLASM_SCHEM
+GENERATE[alphacpuid.s]=alphacpuid.pl
+GENERATE[arm64cpuid.S]=arm64cpuid.pl $(PERLASM_SCHEME)
+GENERATE[armv4cpuid.S]=armv4cpuid.pl $(PERLASM_SCHEME)
diff --git a/crypto/camellia/Makefile.in b/crypto/camellia/Makefile.in
index e32a73b..e809152 100644
--- a/crypto/camellia/Makefile.in
+++ b/crypto/camellia/Makefile.in
@@ -42,9 +42,9 @@ lib:	$(LIBOBJ)
 	@touch lib
 
 cmll-x86.s:	asm/cmll-x86.pl ../perlasm/x86asm.pl
-	$(PERL) asm/cmll-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) asm/cmll-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 cmll-x86_64.s:  asm/cmll-x86_64.pl
-	$(PERL) asm/cmll-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/cmll-x86_64.pl $(PERLASM_SCHEME) $@
 cmllt4-sparcv9.S: asm/cmllt4-sparcv9.pl ../perlasm/sparcv9_modes.pl
 	$(PERL) asm/cmllt4-sparcv9.pl $(PERLASM_SCHEME) $@
 
diff --git a/crypto/camellia/asm/cmll-x86.pl b/crypto/camellia/asm/cmll-x86.pl
index 027302a..de354aa 100644
--- a/crypto/camellia/asm/cmll-x86.pl
+++ b/crypto/camellia/asm/cmll-x86.pl
@@ -42,6 +42,9 @@ require &quot;x86asm.pl&quot;;
 
 $OPENSSL=1;
 
+$output = pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;cmll-586.pl&quot;,$ARGV[$#ARGV] eq &quot;386&quot;);
 
 @T=(&quot;eax&quot;,&quot;ebx&quot;,&quot;ecx&quot;,&quot;edx&quot;);
@@ -1136,3 +1139,5 @@ my ($s0,$s1,$s2,$s3) = @T;
 &amp;asciz(&quot;Camellia for x86 by &lt;appro\@openssl.org&gt;&quot;);
 
 &amp;asm_finish();
+
+close STDOUT;
diff --git a/crypto/camellia/build.info b/crypto/camellia/build.info
index b5c1114..6f50b24 100644
--- a/crypto/camellia/build.info
+++ b/crypto/camellia/build.info
@@ -3,11 +3,8 @@ SOURCE[../../libcrypto]=\
         cmll_ecb.c cmll_ofb.c cmll_cfb.c cmll_ctr.c \
         {- $target{cmll_asm_src} -}
 
-BEGINRAW[Makefile]
-{- $builddir -}/cmll-x86.s:	{- $sourcedir -}/asm/cmll-x86.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/cmll-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
-{- $builddir -}/cmll-x86_64.s:  {- $sourcedir -}/asm/cmll-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/cmll-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/cmllt4-sparcv9.S: {- $sourcedir -}/asm/cmllt4-sparcv9.pl {- $sourcetop -}/crypto/perlasm/sparcv9_modes.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/cmllt4-sparcv9.pl $(PERLASM_SCHEME) $@
-ENDRAW[Makefile]
+GENERATE[cmll-x86.s]=asm/cmll-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+DEPEND[cmll-x86.s]=../perlasm/x86asm.pl
+GENERATE[cmll-x86_64.s]=asm/cmll-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[cmllt4-sparcv9.S]=asm/cmllt4-sparcv9.pl $(PERLASM_SCHEME)
+DEPEND[cmllt4-sparcv9.S]=../perlasm/sparcv9-modes.pl
diff --git a/crypto/cast/Makefile.in b/crypto/cast/Makefile.in
index 06f65e2..c43eecb 100644
--- a/crypto/cast/Makefile.in
+++ b/crypto/cast/Makefile.in
@@ -40,7 +40,7 @@ lib:	$(LIBOBJ)
 	@touch lib
 
 cast-586.s:	asm/cast-586.pl ../perlasm/x86asm.pl ../perlasm/cbc.pl
-	$(PERL)	asm/cast-586.pl $(PERLASM_SCHEME) $(CLAGS) $(PROCESSOR) &gt; $@
+	$(PERL)	asm/cast-586.pl $(PERLASM_SCHEME) $(CLAGS) $(PROCESSOR) $@
 
 files:
 	$(PERL) $(TOP)/util/files.pl Makefile &gt;&gt; $(TOP)/MINFO
diff --git a/crypto/cast/asm/cast-586.pl b/crypto/cast/asm/cast-586.pl
index ec2eab1..267d699 100644
--- a/crypto/cast/asm/cast-586.pl
+++ b/crypto/cast/asm/cast-586.pl
@@ -11,6 +11,9 @@ push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 require &quot;cbc.pl&quot;;
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;cast-586.pl&quot;,$ARGV[$#ARGV] eq &quot;386&quot;);
 
 $CAST_ROUNDS=16;
@@ -36,6 +39,8 @@ $S4=&quot;CAST_S_table3&quot;;
 
 &amp;asm_finish();
 
+close STDOUT;
+
 sub CAST_encrypt {
     local($name,$enc)=@_;
 
diff --git a/crypto/cast/build.info b/crypto/cast/build.info
index 84c100e..20b6f6c 100644
--- a/crypto/cast/build.info
+++ b/crypto/cast/build.info
@@ -2,9 +2,5 @@ LIBS=../../libcrypto
 SOURCE[../../libcrypto]=\
         c_skey.c c_ecb.c {- $target{cast_asm_src} -} c_cfb64.c c_ofb64.c
 
-BEGINRAW[Makefile]
-##### CAST assembler implementations
-
-{- $builddir -}/cast-586.s:	{- $sourcedir -}/asm/cast-586.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl {- $sourcetop -}/crypto/perlasm/cbc.pl
-	CC=&quot;$(CC)&quot; $(PERL)	{- $sourcedir -}/asm/cast-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
-ENDRAW[Makefile]
+GENERATE[cast-586.s]=asm/cast-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+DEPEND[cast-586.s]=../perlasm/x86asm.pl ../perlasm/cbc.pl
diff --git a/crypto/chacha/Makefile.in b/crypto/chacha/Makefile.in
index 33e41d5..c34224c 100644
--- a/crypto/chacha/Makefile.in
+++ b/crypto/chacha/Makefile.in
@@ -37,9 +37,9 @@ lib:	$(LIBOBJ)
 	@touch lib
 
 chacha-x86.s:		asm/chacha-x86.pl
-	$(PERL) asm/chacha-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) asm/chacha-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 chacha-x86_64.s:	asm/chacha-x86_64.pl
-	$(PERL) asm/chacha-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/chacha-x86_64.pl $(PERLASM_SCHEME) $@
 chacha-ppc.s:	asm/chacha-ppc.pl
 	$(PERL) asm/chacha-ppc.pl $(PERLASM_SCHEME) $@
 
diff --git a/crypto/chacha/asm/chacha-c64xplus.pl b/crypto/chacha/asm/chacha-c64xplus.pl
index 55854d0..b2ea406 100755
--- a/crypto/chacha/asm/chacha-c64xplus.pl
+++ b/crypto/chacha/asm/chacha-c64xplus.pl
@@ -17,6 +17,9 @@
 # dependent on input length. This module on the other hand is free
 # from such limiation.
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 ($OUT,$INP,$LEN,$KEYB,$COUNTERA)=(&quot;A4&quot;,&quot;B4&quot;,&quot;A6&quot;,&quot;B6&quot;,&quot;A8&quot;);
 ($KEYA,$COUNTERB,$STEP)=(&quot;A7&quot;,&quot;B7&quot;,&quot;A3&quot;);
 
diff --git a/crypto/chacha/asm/chacha-x86.pl b/crypto/chacha/asm/chacha-x86.pl
index 850c917..8b9696f 100755
--- a/crypto/chacha/asm/chacha-x86.pl
+++ b/crypto/chacha/asm/chacha-x86.pl
@@ -31,6 +31,9 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;chacha-x86.pl&quot;,$ARGV[$#ARGV] eq &quot;386&quot;);
 
 $xmm=$ymm=0;
@@ -1130,3 +1133,5 @@ sub XOPROUND {
 }
 
 &amp;asm_finish();
+
+close STDOUT;
diff --git a/crypto/chacha/build.info b/crypto/chacha/build.info
index f2db5f0..3dd1f74 100644
--- a/crypto/chacha/build.info
+++ b/crypto/chacha/build.info
@@ -1,16 +1,13 @@
 LIBS=../../libcrypto
 SOURCE[../../libcrypto]={- $target{chacha_asm_src} -}
 
+GENERATE[chacha-x86.s]=asm/chacha-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+GENERATE[chacha-x86_64.s]=asm/chacha-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[chacha-ppc.s]=asm/chacha-ppc.pl $(PERLASM_SCHEME)
+
 BEGINRAW[Makefile(unix)]
 ##### CHACHA assembler implementations
 
-{- $builddir -}/chacha-x86.s:		{- $sourcedir -}/asm/chacha-x86.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/chacha-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
-{- $builddir -}/chacha-x86_64.s:	{- $sourcedir -}/asm/chacha-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/chacha-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/chacha-ppc.s:	{- $sourcedir -}/asm/chacha-ppc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/chacha-ppc.pl $(PERLASM_SCHEME) $@
-
 {- $builddir -}/chacha-%.S:	{- $sourcedir -}/asm/chacha-%.pl
 	CC=&quot;$(CC)&quot; $(PERL) $&lt; $(PERLASM_SCHEME) $@
 ENDRAW[Makefile(unix)]
diff --git a/crypto/des/Makefile.in b/crypto/des/Makefile.in
index c056804..93a715a 100644
--- a/crypto/des/Makefile.in
+++ b/crypto/des/Makefile.in
@@ -59,9 +59,9 @@ dest4-sparcv9.S:	asm/dest4-sparcv9.pl
 	$(PERL) asm/dest4-sparcv9.pl $(PERLASM_SCHEME) $@
 
 des-586.s:	asm/des-586.pl ../perlasm/x86asm.pl ../perlasm/cbc.pl
-	$(PERL) asm/des-586.pl $(PERLASM_SCHEME) $(CFLAGS) &gt; $@
+	$(PERL) asm/des-586.pl $(PERLASM_SCHEME) $(CFLAGS) $@
 crypt586.s:	asm/crypt586.pl ../perlasm/x86asm.pl ../perlasm/cbc.pl
-	$(PERL) asm/crypt586.pl $(PERLASM_SCHEME) $(CFLAGS) &gt; $@
+	$(PERL) asm/crypt586.pl $(PERLASM_SCHEME) $(CFLAGS) $@
 
 files:
 	$(PERL) $(TOP)/util/files.pl Makefile &gt;&gt; $(TOP)/MINFO
diff --git a/crypto/des/asm/crypt586.pl b/crypto/des/asm/crypt586.pl
index e36f7d4..d94528f 100644
--- a/crypto/des/asm/crypt586.pl
+++ b/crypto/des/asm/crypt586.pl
@@ -10,6 +10,9 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;crypt586.pl&quot;);
 
 $L=&quot;edi&quot;;
@@ -19,6 +22,8 @@ $R=&quot;esi&quot;;
 &amp;fcrypt_body(&quot;fcrypt_body&quot;);
 &amp;asm_finish();
 
+close STDOUT;
+
 sub fcrypt_body
 	{
 	local($name,$do_ip)=@_;
diff --git a/crypto/des/asm/des-586.pl b/crypto/des/asm/des-586.pl
index bd6a7dd..e56eae4 100644
--- a/crypto/des/asm/des-586.pl
+++ b/crypto/des/asm/des-586.pl
@@ -15,6 +15,9 @@ require &quot;desboth.pl&quot;;
 # format.
 #
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;des-586.pl&quot;);
 
 $L=&quot;edi&quot;;
@@ -39,6 +42,8 @@ $small_footprint=1 if (grep(/\-DOPENSSL_SMALL_FOOTPRINT/<A HREF="../../../mailman/listinfo/openssl-commits.html">, at ARGV</A>));
 
 &amp;asm_finish();
 
+close STDOUT;
+
 sub DES_encrypt_internal()
 	{
 	&amp;function_begin_B(&quot;_x86_DES_encrypt&quot;);
diff --git a/crypto/des/build.info b/crypto/des/build.info
index d3c5c1f..ee2f67f 100644
--- a/crypto/des/build.info
+++ b/crypto/des/build.info
@@ -8,16 +8,11 @@ SOURCE[../../libcrypto]=\
         fcrypt.c xcbc_enc.c rpc_enc.c  cbc_cksm.c \
         read2pwd.c
 
-BEGINRAW[Makefile]
-##### DES assembler implementations
+GENERATE[des_enc-sparc.S]=asm/des_enc.m4
+GENERATE[dest4-sparcv9.S]=asm/dest4-sparcv9.pl $(PERLASM_SCHEME)
 
-{- $builddir -}/des_enc-sparc.S:	{- $sourcedir -}/asm/des_enc.m4
-	m4 -B 8192 {- $sourcedir -}/asm/des_enc.m4 &gt; $@
-{- $builddir -}/dest4-sparcv9.S:	{- $sourcedir -}/asm/dest4-sparcv9.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/dest4-sparcv9.pl $(PERLASM_SCHEME) $@
+GENERATE[des-586.s]=asm/des-586.pl $(PERLASM_SCHEME) $(CFLAGS)
+DEPEND[des-586.s]=../perlasm/x86asm.pl ../perlasm/cbc.pl
+GENERATE[crypt586.s]=asm/crypt586.pl $(PERLASM_SCHEME) $(CFLAGS)
+DEPEND[crypt586.s]=../perlasm/x86asm.pl ../perlasm/cbc.pl
 
-{- $builddir -}/des-586.s:	{- $sourcedir -}/asm/des-586.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl {- $sourcetop -}/crypto/perlasm/cbc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/des-586.pl $(PERLASM_SCHEME) $(CFLAGS) &gt; $@
-{- $builddir -}/crypt586.s:	{- $sourcedir -}/asm/crypt586.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl {- $sourcetop -}/crypto/perlasm/cbc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/crypt586.pl $(PERLASM_SCHEME) $(CFLAGS) &gt; $@
-ENDRAW[Makefile]
diff --git a/crypto/ec/Makefile.in b/crypto/ec/Makefile.in
index 342b98d..48091d2 100644
--- a/crypto/ec/Makefile.in
+++ b/crypto/ec/Makefile.in
@@ -49,13 +49,13 @@ lib:	$(LIBOBJ)
 	@touch lib
 
 ecp_nistz256-x86.s:	asm/ecp_nistz256-x86.pl
-	$(PERL) asm/ecp_nistz256-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) asm/ecp_nistz256-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 
 ecp_nistz256-x86_64.s: asm/ecp_nistz256-x86_64.pl
-	$(PERL) asm/ecp_nistz256-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/ecp_nistz256-x86_64.pl $(PERLASM_SCHEME) $@
 
 ecp_nistz256-avx2.s:   asm/ecp_nistz256-avx2.pl
-	$(PERL) asm/ecp_nistz256-avx2.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/ecp_nistz256-avx2.pl $(PERLASM_SCHEME) $@
 
 ecp_nistz256-sparcv9.S:	asm/ecp_nistz256-sparcv9.pl
 	$(PERL) asm/ecp_nistz256-sparcv9.pl $(PERLASM_SCHEME) $@
diff --git a/crypto/ec/asm/ecp_nistz256-x86.pl b/crypto/ec/asm/ecp_nistz256-x86.pl
index 4d55f82..7aa9b0f 100755
--- a/crypto/ec/asm/ecp_nistz256-x86.pl
+++ b/crypto/ec/asm/ecp_nistz256-x86.pl
@@ -35,6 +35,9 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;ecp_nistz256-x86.pl&quot;,$ARGV[$#ARGV] eq &quot;386&quot;);
 
 $sse2=0;
@@ -1829,3 +1832,5 @@ for ($i=0;$i&lt;7;$i++) {
 } &amp;function_end(&quot;ecp_nistz256_point_add_affine&quot;);
 
 &amp;asm_finish();
+
+close STDOUT;
diff --git a/crypto/ec/build.info b/crypto/ec/build.info
index 469a7dd..e8588a1 100644
--- a/crypto/ec/build.info
+++ b/crypto/ec/build.info
@@ -8,19 +8,15 @@ SOURCE[../../libcrypto]=\
         ecdsa_ossl.c ecdsa_sign.c ecdsa_vrf.c ec_25519.c curve25519.c \
         {- $target{ec_asm_src} -}
 
-BEGINRAW[Makefile]
-{- $builddir -}/ecp_nistz256-x86.s:	{- $sourcedir -}/asm/ecp_nistz256-x86.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/ecp_nistz256-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+GENERATE[ecp_nistz256-x86.s]=asm/ecp_nistz256-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
 
-{- $builddir -}/ecp_nistz256-x86_64.s: {- $sourcedir -}/asm/ecp_nistz256-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/ecp_nistz256-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+GENERATE[ecp_nistz256-x86_64.s]=asm/ecp_nistz256-x86_64.pl $(PERLASM_SCHEME)
 
-{- $builddir -}/ecp_nistz256-avx2.s:   {- $sourcedir -}/asm/ecp_nistz256-avx2.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/ecp_nistz256-avx2.pl $(PERLASM_SCHEME) &gt; $@
+GENERATE[ecp_nistz256-avx2.s]=asm/ecp_nistz256-avx2.pl $(PERLASM_SCHEME)
 
-{- $builddir -}/ecp_nistz256-sparcv9.S:	{- $sourcedir -}/asm/ecp_nistz256-sparcv9.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/ecp_nistz256-sparcv9.pl $(PERLASM_SCHEME) $@
+GENERATE[ecp_nistz256-sparcv9.S]=asm/ecp_nistz256-sparcv9.pl $(PERLASM_SCHEME)
 
+BEGINRAW[Makefile]
 {- $builddir -}/ecp_nistz256-%.S:	{- $sourcedir -}/asm/ecp_nistz256-%.pl
 	CC=&quot;$(CC)&quot; $(PERL) $&lt; $(PERLASM_SCHEME) $@
 ENDRAW[Makefile]
diff --git a/crypto/md5/Makefile.in b/crypto/md5/Makefile.in
index 625bdc8..7e13a04 100644
--- a/crypto/md5/Makefile.in
+++ b/crypto/md5/Makefile.in
@@ -40,10 +40,10 @@ lib:    $(LIBOBJ)
 	@touch lib
 
 md5-586.s:	asm/md5-586.pl ../perlasm/x86asm.pl
-	$(PERL) asm/md5-586.pl $(PERLASM_SCHEME) $(CFLAGS) &gt; $@
+	$(PERL) asm/md5-586.pl $(PERLASM_SCHEME) $(CFLAGS) $@
 
 md5-x86_64.s:	asm/md5-x86_64.pl
-	$(PERL) asm/md5-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/md5-x86_64.pl $(PERLASM_SCHEME) $@
 
 md5-ia64.s: asm/md5-ia64.S
 	$(CC) $(CFLAGS) -E asm/md5-ia64.S | \
diff --git a/crypto/md5/asm/md5-586.pl b/crypto/md5/asm/md5-586.pl
index 4971357..b3b756c 100644
--- a/crypto/md5/asm/md5-586.pl
+++ b/crypto/md5/asm/md5-586.pl
@@ -11,6 +11,9 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],$0);
 
 $A=&quot;eax&quot;;
@@ -33,6 +36,8 @@ $X=&quot;esi&quot;;
 &amp;md5_block(&quot;md5_block_asm_data_order&quot;);
 &amp;asm_finish();
 
+close STDOUT;
+
 sub Np
 	{
 	local($p)=@_;
diff --git a/crypto/md5/build.info b/crypto/md5/build.info
index 6a04f37..a10d582 100644
--- a/crypto/md5/build.info
+++ b/crypto/md5/build.info
@@ -2,17 +2,15 @@ LIBS=../../libcrypto
 SOURCE[../../libcrypto]=\
         md5_dgst.c md5_one.c {- $target{md5_asm_src} -}
 
-BEGINRAW[Makefile]
-{- $builddir -}/md5-586.s:	{- $sourcedir -}/asm/md5-586.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/md5-586.pl $(PERLASM_SCHEME) $(CFLAGS) &gt; $@
+GENERATE[md5-586.s]=asm/md5-586.pl $(PERLASM_SCHEME) $(CFLAGS)
+
+GENERATE[md5-x86_64.s]=asm/md5-x86_64.pl $(PERLASM_SCHEME)
 
-{- $builddir -}/md5-x86_64.s:	{- $sourcedir -}/asm/md5-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/md5-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+GENERATE[md5-sparcv9.S]=asm/md5-sparcv9.pl $(PERLASM_SCHEME)
 
+BEGINRAW[Makefile]
 {- $builddir -}/md5-ia64.s: {- $sourcedir -}/asm/md5-ia64.S
 	$(CC) $(CFLAGS) -E {- $sourcedir -}/asm/md5-ia64.S | \
 	$(PERL) -ne 's/;\s+/;\n/g; print;' &gt; $@
 
-{- $builddir -}/md5-sparcv9.S:	{- $sourcedir -}/asm/md5-sparcv9.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/md5-sparcv9.pl $(PERLASM_SCHEME) $@
 ENDRAW[Makefile]
diff --git a/crypto/modes/Makefile.in b/crypto/modes/Makefile.in
index a62486e..c37a8c8 100644
--- a/crypto/modes/Makefile.in
+++ b/crypto/modes/Makefile.in
@@ -41,18 +41,18 @@ lib:	$(LIBOBJ)
 	@touch lib
 
 ghash-ia64.s:	asm/ghash-ia64.pl
-	$(PERL) asm/ghash-ia64.pl $@ $(CFLAGS)
+	$(PERL) asm/ghash-ia64.pl $(CFLAGS) $@
 ghash-x86.s:	asm/ghash-x86.pl
-	$(PERL) asm/ghash-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) asm/ghash-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 ghash-x86_64.s:	asm/ghash-x86_64.pl
-	$(PERL) asm/ghash-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/ghash-x86_64.pl $(PERLASM_SCHEME) $@
 aesni-gcm-x86_64.s:	asm/aesni-gcm-x86_64.pl
-	$(PERL) asm/aesni-gcm-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/aesni-gcm-x86_64.pl $(PERLASM_SCHEME) $@
 ghash-sparcv9.S:	asm/ghash-sparcv9.pl
 	$(PERL) asm/ghash-sparcv9.pl $(PERLASM_SCHEME) $@
 ghash-alpha.s:	asm/ghash-alpha.pl
 	(preproc=$$$$.$@.S; trap &quot;rm $$preproc&quot; INT; \
-	$(PERL) asm/ghash-alpha.pl &gt; $$preproc &amp;&amp; \
+	$(PERL) asm/ghash-alpha.pl $$preproc &amp;&amp; \
 	$(CC) -E -P $$preproc &gt; $@ &amp;&amp; rm $$preproc)
 ghash-parisc.s:	asm/ghash-parisc.pl
 	$(PERL) asm/ghash-parisc.pl $(PERLASM_SCHEME) $@
diff --git a/crypto/modes/asm/ghash-alpha.pl b/crypto/modes/asm/ghash-alpha.pl
index aa36029..df6b3a3 100644
--- a/crypto/modes/asm/ghash-alpha.pl
+++ b/crypto/modes/asm/ghash-alpha.pl
@@ -454,7 +454,7 @@ rem_4bit:
 .align	4
 
 ___
-$output=shift and open STDOUT,&quot;&gt;$output&quot;;
+$output=pop and open STDOUT,&quot;&gt;$output&quot;;
 print $code;
 close STDOUT;
 
diff --git a/crypto/modes/asm/ghash-ia64.pl b/crypto/modes/asm/ghash-ia64.pl
index 0354c95..9d49143 100755
--- a/crypto/modes/asm/ghash-ia64.pl
+++ b/crypto/modes/asm/ghash-ia64.pl
@@ -32,7 +32,7 @@
 # Itanium performance should remain the same as the &quot;256B&quot; version,
 # i.e. ~8.5 cycles.
 
-$output=shift and (open STDOUT,&quot;&gt;$output&quot; or die &quot;can't open $output: $!&quot;);
+$output=pop and (open STDOUT,&quot;&gt;$output&quot; or die &quot;can't open $output: $!&quot;);
 
 if ($^O eq &quot;hpux&quot;) {
     $ADDP=&quot;addp4&quot;;
diff --git a/crypto/modes/asm/ghash-x86.pl b/crypto/modes/asm/ghash-x86.pl
index 0269169..db6eeae 100644
--- a/crypto/modes/asm/ghash-x86.pl
+++ b/crypto/modes/asm/ghash-x86.pl
@@ -129,6 +129,9 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;ghash-x86.pl&quot;,$x86only = $ARGV[$#ARGV] eq &quot;386&quot;);
 
 $sse2=0;
@@ -1369,6 +1372,8 @@ my ($Xhi,$Xi)=@_;
 &amp;asciz(&quot;GHASH for x86, CRYPTOGAMS by &lt;appro\@openssl.org&gt;&quot;);
 &amp;asm_finish();
 
+close STDOUT;
+
 # A question was risen about choice of vanilla MMX. Or rather why wasn't
 # SSE2 chosen instead? In addition to the fact that MMX runs on legacy
 # CPUs such as PIII, &quot;4-bit&quot; MMX version was observed to provide better
diff --git a/crypto/modes/build.info b/crypto/modes/build.info
index dfce733..b59780f 100644
--- a/crypto/modes/build.info
+++ b/crypto/modes/build.info
@@ -4,28 +4,17 @@ SOURCE[../../libcrypto]=\
         ccm128.c xts128.c wrap128.c ocb128.c \
         {- $target{modes_asm_src} -}
 
-BEGINRAW[Makefile]
-{- $builddir -}/ghash-ia64.s:	{- $sourcedir -}/asm/ghash-ia64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/ghash-ia64.pl $@ $(CFLAGS)
-{- $builddir -}/ghash-x86.s:	{- $sourcedir -}/asm/ghash-x86.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/ghash-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
-{- $builddir -}/ghash-x86_64.s:	{- $sourcedir -}/asm/ghash-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/ghash-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/aesni-gcm-x86_64.s:	{- $sourcedir -}/asm/aesni-gcm-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/aesni-gcm-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/ghash-sparcv9.S:	{- $sourcedir -}/asm/ghash-sparcv9.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/ghash-sparcv9.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/ghash-alpha.s:	{- $sourcedir -}/asm/ghash-alpha.pl
-	(preproc=$$$$.$@.S; trap &quot;rm $$preproc&quot; INT; \
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/ghash-alpha.pl &gt; $$preproc &amp;&amp; \
-	$(CC) -E -P $$preproc &gt; $@ &amp;&amp; rm $$preproc)
-{- $builddir -}/ghash-parisc.s:	{- $sourcedir -}/asm/ghash-parisc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/ghash-parisc.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/ghashv8-armx.S:	{- $sourcedir -}/asm/ghashv8-armx.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/ghashv8-armx.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/ghashp8-ppc.s:	{- $sourcedir -}/asm/ghashp8-ppc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/ghashp8-ppc.pl $(PERLASM_SCHEME) $@
+GENERATE[ghash-ia64.s]=asm/ghash-ia64.pl $(CFLAGS)
+GENERATE[ghash-x86.s]=asm/ghash-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+GENERATE[ghash-x86_64.s]=asm/ghash-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[aesni-gcm-x86_64.s]=asm/aesni-gcm-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[ghash-sparcv9.S]=asm/ghash-sparcv9.pl $(PERLASM_SCHEME)
+GENERATE[ghash-alpha.s]=asm/ghash-alpha.pl
+GENERATE[ghash-parisc.s]=asm/ghash-parisc.pl $(PERLASM_SCHEME)
+GENERATE[ghashv8-armx.S]=asm/ghashv8-armx.pl $(PERLASM_SCHEME)
+GENERATE[ghashp8-ppc.s]=asm/ghashp8-ppc.pl $(PERLASM_SCHEME)
 
+BEGINRAW[Makefile]
 # GNU make &quot;catch all&quot;
 {- $builddir -}/ghash-%.S:	{- $sourcedir -}/asm/ghash-%.pl
 	CC=&quot;$(CC)&quot; $(PERL) $&lt; $(PERLASM_SCHEME) $@
diff --git a/crypto/poly1305/Makefile.in b/crypto/poly1305/Makefile.in
index 2f1b256..e27fcaf 100644
--- a/crypto/poly1305/Makefile.in
+++ b/crypto/poly1305/Makefile.in
@@ -39,9 +39,9 @@ lib:	$(LIBOBJ)
 poly1305-sparcv9.S:	asm/poly1305-sparcv9.pl
 	$(PERL) asm/poly1305-sparcv9.pl $(PERLASM_SCHEME) $@
 poly1305-x86.s:		asm/poly1305-x86.pl
-	$(PERL) asm/poly1305-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) asm/poly1305-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 poly1305-x86_64.s:	asm/poly1305-x86_64.pl
-	$(PERL) asm/poly1305-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/poly1305-x86_64.pl $(PERLASM_SCHEME) $@
 poly1305-ppc.s:		asm/poly1305-ppc.pl
 	$(PERL) asm/poly1305-ppc.pl $(PERLASM_SCHEME) $@
 poly1305-ppcfp.s:	asm/poly1305-ppcfp.pl
diff --git a/crypto/poly1305/asm/poly1305-c64xplus.pl b/crypto/poly1305/asm/poly1305-c64xplus.pl
index fc765e1..f750a6e 100755
--- a/crypto/poly1305/asm/poly1305-c64xplus.pl
+++ b/crypto/poly1305/asm/poly1305-c64xplus.pl
@@ -19,6 +19,9 @@
 # time dependent on input length. This module on the other hand is free
 # from such limitation.
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 ($CTXA,$INPB,$LEN,$PADBIT)=(&quot;A4&quot;,&quot;B4&quot;,&quot;A6&quot;,&quot;B6&quot;);
 ($H0,$H1,$H2,$H3,$H4,$H4a)=(&quot;A8&quot;,&quot;B8&quot;,&quot;A10&quot;,&quot;B10&quot;,&quot;B2&quot;,$LEN);
 ($D0,$D1,$D2,$D3)=         (&quot;A9&quot;,&quot;B9&quot;,&quot;A11&quot;,&quot;B11&quot;);
diff --git a/crypto/poly1305/asm/poly1305-sparcv9.pl b/crypto/poly1305/asm/poly1305-sparcv9.pl
index f0ce259..5452887 100755
--- a/crypto/poly1305/asm/poly1305-sparcv9.pl
+++ b/crypto/poly1305/asm/poly1305-sparcv9.pl
@@ -42,6 +42,9 @@ my ($r0,$r1,$r2,$r3,$s1,$s2,$s3,$h4)	= map(&quot;%l$_&quot;,(0..7));
 my ($h0,$h1,$h2,$h3, $t0,$t1,$t2)	= map(&quot;%o$_&quot;,(0..5,7));
 my ($d0,$d1,$d2,$d3)			= map(&quot;%g$_&quot;,(1..4));
 
+my $output = pop;
+open STDOUT,&quot;&gt;$stdout&quot;;
+
 $code.=&lt;&lt;___;
 #include &quot;sparc_arch.h&quot;
 
diff --git a/crypto/poly1305/asm/poly1305-x86.pl b/crypto/poly1305/asm/poly1305-x86.pl
index fb9fa2b..4307c99 100755
--- a/crypto/poly1305/asm/poly1305-x86.pl
+++ b/crypto/poly1305/asm/poly1305-x86.pl
@@ -38,6 +38,9 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;poly1305-x86.pl&quot;,$ARGV[$#ARGV] eq &quot;386&quot;);
 
 $sse2=$avx=0;
@@ -1795,3 +1798,5 @@ sub vlazy_reduction {
 &amp;align	(4);
 
 &amp;asm_finish();
+
+close STDOUT;
diff --git a/crypto/poly1305/build.info b/crypto/poly1305/build.info
index c93c572..5b548e6 100644
--- a/crypto/poly1305/build.info
+++ b/crypto/poly1305/build.info
@@ -2,18 +2,13 @@ LIBS=../../libcrypto
 SOURCE[../../libcrypto]=\
         poly1305.c {- $target{poly1305_asm_src} -}
 
-BEGINRAW[Makefile(unix)]
-{- $builddir -}/poly1305-sparcv9.S:	{- $sourcedir -}/asm/poly1305-sparcv9.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/poly1305-sparcv9.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/poly1305-x86.s:		{- $sourcedir -}/asm/poly1305-x86.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/poly1305-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
-{- $builddir -}/poly1305-x86_64.s:	{- $sourcedir -}/asm/poly1305-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/poly1305-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/poly1305-ppc.s:		{- $sourcedir -}/asm/poly1305-ppc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/poly1305-ppc.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/poly1305-ppcfp.s:	{- $sourcedir -}/asm/poly1305-ppcfp.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/poly1305-ppcfp.pl $(PERLASM_SCHEME) $@
+GENERATE[poly1305-sparcv9.S]=asm/poly1305-sparcv9.pl $(PERLASM_SCHEME)
+GENERATE[poly1305-x86.s]=asm/poly1305-x86.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+GENERATE[poly1305-x86_64.s]=asm/poly1305-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[poly1305-ppc.s]=asm/poly1305-ppc.pl $(PERLASM_SCHEME)
+GENERATE[poly1305-ppcfp.s]=asm/poly1305-ppcfp.pl $(PERLASM_SCHEME)
 
+BEGINRAW[Makefile(unix)]
 {- $builddir -}/poly1305-%.S:	{- $sourcedir -}/asm/poly1305-%.pl
 	CC=&quot;$(CC)&quot; $(PERL) $&lt; $(PERLASM_SCHEME) $@
 ENDRAW[Makefile(unix)]
diff --git a/crypto/rc4/Makefile.in b/crypto/rc4/Makefile.in
index fe2ef7d..00e39ec 100644
--- a/crypto/rc4/Makefile.in
+++ b/crypto/rc4/Makefile.in
@@ -39,15 +39,15 @@ lib:	$(LIBOBJ)
 	@touch lib
 
 rc4-586.s:	asm/rc4-586.pl ../perlasm/x86asm.pl
-	$(PERL) asm/rc4-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) asm/rc4-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 
 rc4-x86_64.s: asm/rc4-x86_64.pl
-	$(PERL) asm/rc4-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/rc4-x86_64.pl $(PERLASM_SCHEME) $@
 rc4-md5-x86_64.s:	asm/rc4-md5-x86_64.pl
-	$(PERL) asm/rc4-md5-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/rc4-md5-x86_64.pl $(PERLASM_SCHEME) $@
 
 rc4-ia64.S: asm/rc4-ia64.pl
-	$(PERL) asm/rc4-ia64.pl $(CFLAGS) &gt; $@
+	$(PERL) asm/rc4-ia64.pl $(CFLAGS) $@
 
 rc4-parisc.s:	asm/rc4-parisc.pl
 	$(PERL) asm/rc4-parisc.pl $(PERLASM_SCHEME) $@
diff --git a/crypto/rc4/asm/rc4-586.pl b/crypto/rc4/asm/rc4-586.pl
index d04e177..a517adb 100644
--- a/crypto/rc4/asm/rc4-586.pl
+++ b/crypto/rc4/asm/rc4-586.pl
@@ -63,6 +63,9 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;rc4-586.pl&quot;,$x86only = $ARGV[$#ARGV] eq &quot;386&quot;);
 
 $xx=&quot;eax&quot;;
@@ -415,3 +418,4 @@ $idx=&quot;edx&quot;;
 
 &amp;asm_finish();
 
+close STDOUT;
diff --git a/crypto/rc4/asm/rc4-ia64.pl b/crypto/rc4/asm/rc4-ia64.pl
index 49cd5b5..b83e53a 100644
--- a/crypto/rc4/asm/rc4-ia64.pl
+++ b/crypto/rc4/asm/rc4-ia64.pl
@@ -164,6 +164,9 @@
 #     random input data).
 #
 
+$output = pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 $phases = 4;		# number of stages/phases in the pipelined-loop
 $unroll_count = 6;	# number of times we unrolled it
 $pComI = (1 &lt;&lt; 0);
@@ -753,3 +756,5 @@ $code.=&lt;&lt;___;
 ___
 
 print $code;
+
+close STDOUT;
diff --git a/crypto/rc4/build.info b/crypto/rc4/build.info
index 8d63bab..b682903 100644
--- a/crypto/rc4/build.info
+++ b/crypto/rc4/build.info
@@ -2,21 +2,17 @@ LIBS=../../libcrypto
 SOURCE[../../libcrypto]=\
         {- $target{rc4_asm_src} -}
 
-BEGINRAW[Makefile]
-{- $builddir -}/rc4-586.s:	{- $sourcedir -}/asm/rc4-586.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/rc4-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+GENERATE[rc4-586.s]=asm/rc4-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+DEPEND[rc4-586.s]=../perlasm/x86asm.pl
 
-{- $builddir -}/rc4-x86_64.s: {- $sourcedir -}/asm/rc4-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/rc4-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/rc4-md5-x86_64.s:	{- $sourcedir -}/asm/rc4-md5-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/rc4-md5-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+GENERATE[rc4-x86_64.s]=asm/rc4-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[rc4-md5-x86_64.s]=asm/rc4-md5-x86_64.pl $(PERLASM_SCHEME)
 
-{- $builddir -}/rc4-ia64.S: {- $sourcedir -}/asm/rc4-ia64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/rc4-ia64.pl $(CFLAGS) &gt; $@
+GENERATE[rc4-ia64.S]=asm/rc4-ia64.pl $(CFLAGS)
 
-{- $builddir -}/rc4-parisc.s:	{- $sourcedir -}/asm/rc4-parisc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/rc4-parisc.pl $(PERLASM_SCHEME) $@
+GENERATE[rc4-parisc.s]=asm/rc4-parisc.pl $(PERLASM_SCHEME)
 
+BEGINRAW[Makefile]
 {- $builddir -}/rc4-ia64.s: rc4-ia64.S
 	@case `awk '/^#define RC4_INT/{print$$NF}' $(SRCDIR)/include/openssl/opensslconf.h` in \
 	int)	set -x; $(CC) $(CFLAGS) -DSZ=4 -E rc4-ia64.S &gt; $@ ;; \
diff --git a/crypto/rc5/Makefile.in b/crypto/rc5/Makefile.in
index bd7a1c6..501b118 100644
--- a/crypto/rc5/Makefile.in
+++ b/crypto/rc5/Makefile.in
@@ -40,7 +40,7 @@ lib:	$(LIBOBJ)
 	@touch lib
 
 rc5-586.s: asm/rc5-586.pl ../perlasm/x86asm.pl ../perlasm/cbc.pl
-	$(PERL) asm/rc5-586.pl $(PERLASM_SCHEME) $(CFLAGS) &gt; $@
+	$(PERL) asm/rc5-586.pl $(PERLASM_SCHEME) $(CFLAGS) $@
 
 files:
 	$(PERL) $(TOP)/util/files.pl Makefile &gt;&gt; $(TOP)/MINFO
diff --git a/crypto/rc5/asm/rc5-586.pl b/crypto/rc5/asm/rc5-586.pl
index 61ac6ef..a0d85f2 100644
--- a/crypto/rc5/asm/rc5-586.pl
+++ b/crypto/rc5/asm/rc5-586.pl
@@ -5,6 +5,9 @@ push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 require &quot;cbc.pl&quot;;
 
+$output = pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;rc5-586.pl&quot;);
 
 $RC5_MAX_ROUNDS=16;
@@ -22,6 +25,8 @@ $tmp4=&quot;edx&quot;;
 &amp;cbc(&quot;RC5_32_cbc_encrypt&quot;,&quot;RC5_32_encrypt&quot;,&quot;RC5_32_decrypt&quot;,0,4,5,3,-1,-1);
 &amp;asm_finish();
 
+close STDOUT;
+
 sub RC5_32_encrypt
 	{
 	local($name,$enc)=@_;
diff --git a/crypto/rc5/build.info b/crypto/rc5/build.info
index 0cf704b..bb6e5a5 100644
--- a/crypto/rc5/build.info
+++ b/crypto/rc5/build.info
@@ -2,9 +2,5 @@ LIBS=../../libcrypto
 SOURCE[../../libcrypto]=\
         rc5_skey.c rc5_ecb.c {- $target{rc5_asm_src} -} rc5cfb64.c rc5ofb64.c
 
-BEGINRAW[Makefile]
-##### RC5 assembler implementations
-
-{- $builddir -}/rc5-586.s: {- $sourcedir -}/asm/rc5-586.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl {- $sourcetop -}/crypto/perlasm/cbc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/rc5-586.pl $(PERLASM_SCHEME) $(CFLAGS) &gt; $@
-ENDRAW[Makefile]
+GENERATE[rc5-586.s]=asm/rc5-586.pl $(PERLASM_SCHEME) $(CFLAGS)
+DEPEND[rc5-586.s]=../perlasm/x86asm.pl ../perlasm/cbc.pl
diff --git a/crypto/ripemd/Makefile.in b/crypto/ripemd/Makefile.in
index 8158a73..ba77fe4 100644
--- a/crypto/ripemd/Makefile.in
+++ b/crypto/ripemd/Makefile.in
@@ -40,7 +40,7 @@ lib:    $(LIBOBJ)
 	@touch lib
 
 rmd-586.s:	asm/rmd-586.pl ../perlasm/x86asm.pl
-	$(PERL) asm/rmd-586.pl $(PERLASM_SCHEME) $(CFLAGS) &gt; $@
+	$(PERL) asm/rmd-586.pl $(PERLASM_SCHEME) $(CFLAGS) $@
 
 files:
 	$(PERL) $(TOP)/util/files.pl Makefile &gt;&gt; $(TOP)/MINFO
diff --git a/crypto/ripemd/asm/rmd-586.pl b/crypto/ripemd/asm/rmd-586.pl
index e8b2bc2..fd32a73 100644
--- a/crypto/ripemd/asm/rmd-586.pl
+++ b/crypto/ripemd/asm/rmd-586.pl
@@ -9,6 +9,9 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],$0);
 
 $A=&quot;ecx&quot;;
@@ -60,6 +63,8 @@ $KR3=0x7A6D76E9;
 &amp;ripemd160_block(&quot;ripemd160_block_asm_data_order&quot;);
 &amp;asm_finish();
 
+close STDOUT;
+
 sub Xv
 	{
 	local($n)=@_;
diff --git a/crypto/ripemd/build.info b/crypto/ripemd/build.info
index e39f9bd..f71f313 100644
--- a/crypto/ripemd/build.info
+++ b/crypto/ripemd/build.info
@@ -2,9 +2,5 @@ LIBS=../../libcrypto
 SOURCE[../../libcrypto]=\
         rmd_dgst.c rmd_one.c {- $target{rmd160_asm_src} -}
 
-BEGINRAW[Makefile]
-##### RMD160 assembler implementations
-
-{- $builddir -}/rmd-586.s:	{- $sourcedir -}/asm/rmd-586.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/rmd-586.pl $(PERLASM_SCHEME) $(CFLAGS) &gt; $@
-ENDRAW[Makefile]
+GENERATE[rmd-586.s]=asm/rmd-586.pl $(PERLASM_SCHEME) $(CFLAGS)
+DEPEND[rmd-586.s]=../perlasm/x86asm.pl
diff --git a/crypto/sha/Makefile.in b/crypto/sha/Makefile.in
index ba06085..e2d20aa 100644
--- a/crypto/sha/Makefile.in
+++ b/crypto/sha/Makefile.in
@@ -40,32 +40,32 @@ lib:    $(LIBOBJ)
 	@touch lib
 
 sha1-586.s:	asm/sha1-586.pl ../perlasm/x86asm.pl
-	$(PERL) asm/sha1-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) asm/sha1-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 sha256-586.s:	asm/sha256-586.pl ../perlasm/x86asm.pl
-	$(PERL) asm/sha256-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) asm/sha256-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 sha512-586.s:	asm/sha512-586.pl ../perlasm/x86asm.pl
-	$(PERL) asm/sha512-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) asm/sha512-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 
 sha1-ia64.s:   asm/sha1-ia64.pl
-	(cd asm; $(PERL) sha1-ia64.pl ../$@ $(CFLAGS))
+	(cd asm; $(PERL) sha1-ia64.pl $(CFLAGS) ../$@)
 sha256-ia64.s: asm/sha512-ia64.pl
-	(cd asm; $(PERL) sha512-ia64.pl ../$@ $(CFLAGS))
+	(cd asm; $(PERL) sha512-ia64.pl $(CFLAGS) ../$@)
 sha512-ia64.s: asm/sha512-ia64.pl
-	(cd asm; $(PERL) sha512-ia64.pl ../$@ $(CFLAGS))
+	(cd asm; $(PERL) sha512-ia64.pl $(CFLAGS) ../$@)
 
 sha256-armv4.S: asm/sha256-armv4.pl
 	$(PERL) $&lt; $(PERLASM_SCHEME) $@
 
 sha1-alpha.s:	asm/sha1-alpha.pl
 	(preproc=$$$$.$@.S; trap &quot;rm $$preproc&quot; INT; \
-	$(PERL) asm/sha1-alpha.pl &gt; $$preproc &amp;&amp; \
+	$(PERL) asm/sha1-alpha.pl $$preproc &amp;&amp; \
 	$(CC) -E -P $$preproc &gt; $@ &amp;&amp; rm $$preproc)
 
 # Solaris make has to be explicitly told
-sha1-x86_64.s:	asm/sha1-x86_64.pl;	$(PERL) asm/sha1-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-sha1-mb-x86_64.s:	asm/sha1-mb-x86_64.pl;	$(PERL) asm/sha1-mb-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+sha1-x86_64.s:	asm/sha1-x86_64.pl;	$(PERL) asm/sha1-x86_64.pl $(PERLASM_SCHEME) $@
+sha1-mb-x86_64.s:	asm/sha1-mb-x86_64.pl;	$(PERL) asm/sha1-mb-x86_64.pl $(PERLASM_SCHEME) $@
 sha256-x86_64.s:asm/sha512-x86_64.pl;	$(PERL) asm/sha512-x86_64.pl $(PERLASM_SCHEME) $@
-sha256-mb-x86_64.s:	asm/sha256-mb-x86_64.pl;	$(PERL) asm/sha256-mb-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+sha256-mb-x86_64.s:	asm/sha256-mb-x86_64.pl;	$(PERL) asm/sha256-mb-x86_64.pl $(PERLASM_SCHEME) $@
 sha512-x86_64.s:asm/sha512-x86_64.pl;	$(PERL) asm/sha512-x86_64.pl $(PERLASM_SCHEME) $@
 sha1-sparcv9.S:	asm/sha1-sparcv9.pl;	$(PERL) asm/sha1-sparcv9.pl $(PERLASM_SCHEME) $@
 sha256-sparcv9.S:asm/sha512-sparcv9.pl;	$(PERL) asm/sha512-sparcv9.pl $(PERLASM_SCHEME) $@
diff --git a/crypto/sha/asm/sha1-586.pl b/crypto/sha/asm/sha1-586.pl
index e0b5d83..cd71d1c 100644
--- a/crypto/sha/asm/sha1-586.pl
+++ b/crypto/sha/asm/sha1-586.pl
@@ -113,6 +113,9 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;sha1-586.pl&quot;,$ARGV[$#ARGV] eq &quot;386&quot;);
 
 $xmm=$ymm=0;
@@ -1474,3 +1477,5 @@ sub Xtail_avx()
 &amp;asciz(&quot;SHA1 block transform for x86, CRYPTOGAMS by &lt;appro\@openssl.org&gt;&quot;);
 
 &amp;asm_finish();
+
+close STDOUT;
diff --git a/crypto/sha/asm/sha1-ia64.pl b/crypto/sha/asm/sha1-ia64.pl
index 02d35d1..a9d2b7c 100644
--- a/crypto/sha/asm/sha1-ia64.pl
+++ b/crypto/sha/asm/sha1-ia64.pl
@@ -14,6 +14,8 @@
 # Performance under big-endian OS such as HP-UX is 179MBps*1GHz, which
 # is &gt;50% better than HP C and &gt;2x better than gcc.
 
+$output = pop;
+
 $code=&lt;&lt;___;
 .ident  \&quot;sha1-ia64.s, version 1.3\&quot;
 .ident  \&quot;IA-64 ISA artwork by Andy Polyakov &lt;appro\@fy.chalmers.se&gt;\&quot;
@@ -301,5 +303,5 @@ $code.=&lt;&lt;___;
 stringz	&quot;SHA1 block transform for IA64, CRYPTOGAMS by &lt;appro\@openssl.org&gt;&quot;
 ___
 
-$output=shift and open STDOUT,&quot;&gt;$output&quot;;
+open STDOUT,&quot;&gt;$output&quot; if $output;
 print $code;
diff --git a/crypto/sha/asm/sha256-586.pl b/crypto/sha/asm/sha256-586.pl
index e907714..55d833a 100644
--- a/crypto/sha/asm/sha256-586.pl
+++ b/crypto/sha/asm/sha256-586.pl
@@ -63,6 +63,9 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;sha512-586.pl&quot;,$ARGV[$#ARGV] eq &quot;386&quot;);
 
 $xmm=$avx=0;
@@ -1279,3 +1282,5 @@ sub bodyx_00_15 () {			# +10%
 &amp;function_end_B(&quot;sha256_block_data_order&quot;);
 
 &amp;asm_finish();
+
+close STDOUT;
diff --git a/crypto/sha/asm/sha512-586.pl b/crypto/sha/asm/sha512-586.pl
index 2f6a202..d0f9101 100644
--- a/crypto/sha/asm/sha512-586.pl
+++ b/crypto/sha/asm/sha512-586.pl
@@ -50,6 +50,9 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;sha512-586.pl&quot;,$ARGV[$#ARGV] eq &quot;386&quot;);
 
 $sse2=0;
@@ -909,3 +912,5 @@ sub BODY_00_15_ssse3 {		# &quot;phase-less&quot; copy of BODY_00_15_sse2
 &amp;asciz(&quot;SHA512 block transform for x86, CRYPTOGAMS by &lt;appro\@openssl.org&gt;&quot;);
 
 &amp;asm_finish();
+
+close STDOUT;
diff --git a/crypto/sha/asm/sha512-ia64.pl b/crypto/sha/asm/sha512-ia64.pl
index 59f889a..4f472d1 100755
--- a/crypto/sha/asm/sha512-ia64.pl
+++ b/crypto/sha/asm/sha512-ia64.pl
@@ -68,7 +68,7 @@
 # To generate code, pass the file name with either 256 or 512 in its
 # name and compiler flags.
 
-$output=shift;
+$output=pop;
 
 if ($output =~ /512.*\.[s|asm]/) {
 	$SZ=8;
diff --git a/crypto/sha/build.info b/crypto/sha/build.info
index 2543414..9f095a8 100644
--- a/crypto/sha/build.info
+++ b/crypto/sha/build.info
@@ -2,74 +2,48 @@ LIBS=../../libcrypto
 SOURCE[../../libcrypto]=\
         sha1dgst.c sha1_one.c sha256.c sha512.c {- $target{sha1_asm_src} -}
 
-BEGINRAW[Makefile]
+GENERATE[sha1-586.s]=asm/sha1-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+DEPEND[sha1-586.s]=../perlasm/x86asm.pl
+GENERATE[sha256-586.s]=asm/sha256-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+DEPEND[sha256-586.s]=../perlasm/x86asm.pl
+GENERATE[sha512-586.s]=asm/sha512-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+DEPEND[sha512-586.s]=../perlasm/x86asm.pl
+
+GENERATE[sha1-ia64.s]=sha1-ia64.pl $(CFLAGS)
+GENERATE[sha256-ia64.s]=sha512-ia64.pl $(CFLAGS)
+GENERATE[sha512-ia64.s]=sha512-ia64.pl $(CFLAGS)
+
+GENERATE[sha256-armv4.S]=asm/sha256-armv4.pl $(PERLASM_SCHEME)
+
+GENERATE[sha1-alpha.s]=asm/sha1-alpha.pl
+
+GENERATE[sha1-x86_64.s]=asm/sha1-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[sha1-mb-x86_64.s]=asm/sha1-mb-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[sha256-x86_64.s]=asm/sha512-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[sha256-mb-x86_64.s]=asm/sha256-mb-x86_64.pl $(PERLASM_SCHEME)
+GENERATE[sha512-x86_64.s]=asm/sha512-x86_64.pl $(PERLASM_SCHEME)
+
+GENERATE[sha1-sparcv9.S]=asm/sha1-sparcv9.pl $(PERLASM_SCHEME)
+GENERATE[sha256-sparcv9.S]=asm/sha512-sparcv9.pl $(PERLASM_SCHEME)
+GENERATE[sha512-sparcv9.S]=asm/sha512-sparcv9.pl $(PERLASM_SCHEME)
+
+GENERATE[sha1-ppc.s]=asm/sha1-ppc.pl $(PERLASM_SCHEME)
+GENERATE[sha256-ppc.s]=asm/sha512-ppc.pl $(PERLASM_SCHEME)
+GENERATE[sha512-ppc.s]=asm/sha512-ppc.pl $(PERLASM_SCHEME)
+GENERATE[sha256p8-ppc.s]=asm/sha512p8-ppc.pl $(PERLASM_SCHEME)
+GENERATE[sha512p8-ppc.s]=asm/sha512p8-ppc.pl $(PERLASM_SCHEME)
+
+GENERATE[sha1-parisc.s]=asm/sha1-parisc.pl $(PERLASM_SCHEME)
+GENERATE[sha256-parisc.s]=asm/sha512-parisc.pl $(PERLASM_SCHEME)
+GENERATE[sha512-parisc.s]=asm/sha512-parisc.pl $(PERLASM_SCHEME)
+
+GENERATE[sha1-mips.S]=asm/sha1-mips.pl $(PERLASM_SCHEME)
+GENERATE[sha256-mips.S]=asm/sha512-mips.pl $(PERLASM_SCHEME)
+GENERATE[sha512-mips.S]=asm/sha512-mips.pl $(PERLASM_SCHEME)
+
+BEGINRAW[Makefile(unix)]
 ##### SHA assembler implementations
 
-{- $builddir -}/sha1-586.s:	{- $sourcedir -}/asm/sha1-586.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha1-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
-{- $builddir -}/sha256-586.s:	{- $sourcedir -}/asm/sha256-586.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha256-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
-{- $builddir -}/sha512-586.s:	{- $sourcedir -}/asm/sha512-586.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha512-586.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
-
-{- $builddir -}/sha1-ia64.s:   {- $sourcedir -}/asm/sha1-ia64.pl
-	(cd asm; CC=&quot;$(CC)&quot; $(PERL) sha1-ia64.pl ../$@ $(CFLAGS))
-{- $builddir -}/sha256-ia64.s: {- $sourcedir -}/asm/sha512-ia64.pl
-	(cd asm; CC=&quot;$(CC)&quot; $(PERL) sha512-ia64.pl ../$@ $(CFLAGS))
-{- $builddir -}/sha512-ia64.s: {- $sourcedir -}/asm/sha512-ia64.pl
-	(cd asm; CC=&quot;$(CC)&quot; $(PERL) sha512-ia64.pl ../$@ $(CFLAGS))
-
-{- $builddir -}/sha256-armv4.S: {- $sourcedir -}/asm/sha256-armv4.pl
-	CC=&quot;$(CC)&quot; $(PERL) $&lt; $(PERLASM_SCHEME) $@
-
-{- $builddir -}/sha1-alpha.s:	{- $sourcedir -}/asm/sha1-alpha.pl
-	(preproc=$$$$.$@.S; trap &quot;rm $$preproc&quot; INT; \
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha1-alpha.pl &gt; $$preproc &amp;&amp; \
-	$(CC) -E -P $$preproc &gt; $@ &amp;&amp; rm $$preproc)
-
-# Solaris make has to be explicitly told
-{- $builddir -}/sha1-x86_64.s:	{- $sourcedir -}/asm/sha1-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha1-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/sha1-mb-x86_64.s:	{- $sourcedir -}/asm/sha1-mb-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha1-mb-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/sha256-x86_64.s:{- $sourcedir -}/asm/sha512-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha512-x86_64.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/sha256-mb-x86_64.s:	{- $sourcedir -}/asm/sha256-mb-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha256-mb-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-{- $builddir -}/sha512-x86_64.s:{- $sourcedir -}/asm/sha512-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha512-x86_64.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/sha1-sparcv9.S:	{- $sourcedir -}/asm/sha1-sparcv9.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha1-sparcv9.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/sha256-sparcv9.S:{- $sourcedir -}/asm/sha512-sparcv9.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha512-sparcv9.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/sha512-sparcv9.S:{- $sourcedir -}/asm/sha512-sparcv9.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha512-sparcv9.pl $(PERLASM_SCHEME) $@
-
-{- $builddir -}/sha1-ppc.s:	{- $sourcedir -}/asm/sha1-ppc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha1-ppc.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/sha256-ppc.s:	{- $sourcedir -}/asm/sha512-ppc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha512-ppc.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/sha512-ppc.s:	{- $sourcedir -}/asm/sha512-ppc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha512-ppc.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/sha256p8-ppc.s:	{- $sourcedir -}/asm/sha512p8-ppc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha512p8-ppc.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/sha512p8-ppc.s:	{- $sourcedir -}/asm/sha512p8-ppc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha512p8-ppc.pl $(PERLASM_SCHEME) $@
-
-{- $builddir -}/sha1-parisc.s:	{- $sourcedir -}/asm/sha1-parisc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha1-parisc.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/sha256-parisc.s:{- $sourcedir -}/asm/sha512-parisc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha512-parisc.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/sha512-parisc.s:{- $sourcedir -}/asm/sha512-parisc.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha512-parisc.pl $(PERLASM_SCHEME) $@
-
-{- $builddir -}/sha1-mips.S:	{- $sourcedir -}/asm/sha1-mips.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha1-mips.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/sha256-mips.S:	{- $sourcedir -}/asm/sha512-mips.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha512-mips.pl $(PERLASM_SCHEME) $@
-{- $builddir -}/sha512-mips.S:	{- $sourcedir -}/asm/sha512-mips.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/sha512-mips.pl $(PERLASM_SCHEME) $@
-
 # GNU make &quot;catch all&quot;
 {- $builddir -}/sha1-%.S:	{- $sourcedir -}/asm/sha1-%.pl
 	CC=&quot;$(CC)&quot; $(PERL) $&lt; $(PERLASM_SCHEME) $@
@@ -77,4 +51,4 @@ BEGINRAW[Makefile]
 	CC=&quot;$(CC)&quot; $(PERL) $&lt; $(PERLASM_SCHEME) $@
 {- $builddir -}/sha512-%.S:	{- $sourcedir -}/asm/sha512-%.pl
 	CC=&quot;$(CC)&quot; $(PERL) $&lt; $(PERLASM_SCHEME) $@
-ENDRAW[Makefile]
+ENDRAW[Makefile(unix)]
diff --git a/crypto/whrlpool/Makefile.in b/crypto/whrlpool/Makefile.in
index a1be9fe..fa51f08 100644
--- a/crypto/whrlpool/Makefile.in
+++ b/crypto/whrlpool/Makefile.in
@@ -40,10 +40,10 @@ lib:	$(LIBOBJ)
 	@touch lib
 
 wp-mmx.s:	asm/wp-mmx.pl ../perlasm/x86asm.pl
-	$(PERL) asm/wp-mmx.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+	$(PERL) asm/wp-mmx.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) $@
 
 wp-x86_64.s: asm/wp-x86_64.pl
-	$(PERL) asm/wp-x86_64.pl $(PERLASM_SCHEME) &gt; $@
+	$(PERL) asm/wp-x86_64.pl $(PERLASM_SCHEME) $@
 
 $(LIBOBJ): $(LIBSRC)
 
diff --git a/crypto/whrlpool/asm/wp-mmx.pl b/crypto/whrlpool/asm/wp-mmx.pl
index 7725951..a71a29f 100644
--- a/crypto/whrlpool/asm/wp-mmx.pl
+++ b/crypto/whrlpool/asm/wp-mmx.pl
@@ -49,6 +49,9 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC,&quot;${dir}&quot;,&quot;${dir}../../perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output=pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;wp-mmx.pl&quot;);
 
 sub L()  { &amp;data_byte(@_); }
@@ -493,3 +496,5 @@ for($i=0;$i&lt;8;$i++) {
 
 &amp;function_end_B(&quot;whirlpool_block_mmx&quot;);
 &amp;asm_finish(); 
+
+close STDOUT;
diff --git a/crypto/whrlpool/build.info b/crypto/whrlpool/build.info
index 5cf6000..ff9d052 100644
--- a/crypto/whrlpool/build.info
+++ b/crypto/whrlpool/build.info
@@ -1,10 +1,7 @@
 LIBS=../../libcrypto
 SOURCE[../../libcrypto]=wp_dgst.c {- $target{wp_asm_src} -}
 
-BEGINRAW[Makefile]
-{- $builddir -}/wp-mmx.s:	{- $sourcedir -}/asm/wp-mmx.pl {- $sourcetop -}/crypto/perlasm/x86asm.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/wp-mmx.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
+GENERATE[wp-mmx.s]=asm/wp-mmx.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR)
+DEPEND[wp-mmx.s]=../perlasm/x86asm.pl
 
-{- $builddir -}/wp-x86_64.s: {- $sourcedir -}/asm/wp-x86_64.pl
-	CC=&quot;$(CC)&quot; $(PERL) {- $sourcedir -}/asm/wp-x86_64.pl $(PERLASM_SCHEME) &gt; $@
-ENDRAW[Makefile]
+GENERATE[wp-x86_64.s]=asm/wp-x86_64.pl $(PERLASM_SCHEME)
diff --git a/crypto/x86cpuid.pl b/crypto/x86cpuid.pl
index 8677232..48c4cf2 100644
--- a/crypto/x86cpuid.pl
+++ b/crypto/x86cpuid.pl
@@ -4,6 +4,10 @@ $0 =~ m/(.*[\/\\])[^\/\\]+$/; $dir=$1;
 push(@INC, &quot;${dir}perlasm&quot;, &quot;perlasm&quot;);
 require &quot;x86asm.pl&quot;;
 
+$output = pop;
+open OUT,&quot;&gt;$output&quot;;
+*STDOUT=*OUT;
+
 &amp;asm_init($ARGV[0],&quot;x86cpuid&quot;);
 
 for (@ARGV) { $sse2=1 if (/-DOPENSSL_IA32_SSE2/); }
@@ -487,3 +491,5 @@ my $max = &quot;ebp&quot;;
 &amp;hidden(&quot;OPENSSL_ia32cap_P&quot;);
 
 &amp;asm_finish();
+
+close STDOUT;
diff --git a/ms/uplink-x86.pl b/ms/uplink-x86.pl
index 53b998d..4a2f042 100755
--- a/ms/uplink-x86.pl
+++ b/ms/uplink-x86.pl
@@ -6,6 +6,9 @@ require &quot;x86asm.pl&quot;;
 
 require &quot;uplink-common.pl&quot;;
 
+$output = pop;
+open STDOUT,&quot;&gt;$output&quot;;
+
 &amp;asm_init($ARGV[0],&quot;uplink-x86&quot;);
 
 &amp;external_label(&quot;OPENSSL_Uplink&quot;);
@@ -31,3 +34,5 @@ for ($i=1;$i&lt;=$N;$i++) {
 &amp;data_word(&amp;label(&quot;_\$lazy${i}&quot;));
 }
 &amp;asm_finish();
+
+close OUTPUT;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005244.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="005246.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5245">[ date ]</a>
              <a href="thread.html#5245">[ thread ]</a>
              <a href="subject.html#5245">[ subject ]</a>
              <a href="author.html#5245">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
