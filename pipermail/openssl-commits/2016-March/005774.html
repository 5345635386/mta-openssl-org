<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2016-March/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1458517729.245689.16025.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005773.html">
   <LINK REL="Next"  HREF="005775.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Rich Salz</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1458517729.245689.16025.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">rsalz at openssl.org
       </A><BR>
    <I>Sun Mar 20 23:48:49 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="005773.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="005775.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5774">[ date ]</a>
              <a href="thread.html#5774">[ thread ]</a>
              <a href="subject.html#5774">[ subject ]</a>
              <a href="author.html#5774">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  3c27208fab1dc29f47f088490404df5abfcdfb05 (commit)
      from  8230f6c764f854190358cf40f0e7e7ca5647d8cd (commit)


- Log -----------------------------------------------------------------
commit 3c27208fab1dc29f47f088490404df5abfcdfb05
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
Date:   Fri Mar 18 14:30:20 2016 -0400

    Remove #error from include files.
    
    Don't have #error statements in header files, but instead wrap
    the contents of that file in #ifndef OPENSSL_NO_xxx
    This means it is now always safe to include the header file.
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;

-----------------------------------------------------------------------

Summary of changes:
 CHANGES                            |   4 ++
 apps/apps.h                        |   8 +--
 crypto/aes/aes_locl.h              |   5 --
 crypto/asn1/ameth_lib.c            |   4 +-
 crypto/asn1/d2i_pr.c               |   4 +-
 crypto/asn1/d2i_pu.c               |  12 +---
 crypto/asn1/i2d_pu.c               |  12 +---
 crypto/asn1/t_spki.c               |   8 +--
 crypto/asn1/x_pubkey.c             |   8 +--
 crypto/async/arch/async_null.c     |   2 +
 crypto/blake2/blake2_locl.h        |   4 --
 crypto/cms/cms_cd.c                |   4 +-
 crypto/conf/conf_mall.c            |   4 +-
 crypto/conf/conf_sap.c             |   4 +-
 crypto/ct/ct_locl.h                |   4 --
 crypto/dh/dh_ameth.c               |   4 +-
 crypto/dh/dh_lib.c                 |   4 +-
 crypto/dh/dh_pmeth.c               |   4 +-
 crypto/dsa/dsa_ameth.c             |   4 +-
 crypto/dsa/dsa_gen.c               |   4 +-
 crypto/dsa/dsa_lib.c               |   8 +--
 crypto/ec/ec_ameth.c               |   4 +-
 crypto/ec/ec_key.c                 |   4 +-
 crypto/ec/ec_kmeth.c               |   4 +-
 crypto/ec/ecdsa_sign.c             |   4 +-
 crypto/ec/ecdsa_vrf.c              |   4 +-
 crypto/engine/eng_cryptodev.c      |   4 +-
 crypto/engine/eng_openssl.c        |  12 +---
 crypto/err/err_all.c               |  32 +++-------
 crypto/evp/digest.c                |   4 +-
 crypto/evp/e_aes.c                 |   2 +-
 crypto/evp/evp_enc.c               |   4 +-
 crypto/evp/m_md2.c                 |   4 +-
 crypto/evp/m_md4.c                 |   4 +-
 crypto/evp/m_md5.c                 |   4 +-
 crypto/evp/m_md5_sha1.c            |   4 +-
 crypto/evp/m_mdc2.c                |   4 +-
 crypto/evp/m_ripemd.c              |   4 +-
 crypto/evp/m_sha1.c                |   4 +-
 crypto/evp/p_dec.c                 |   4 +-
 crypto/evp/p_enc.c                 |   4 +-
 crypto/evp/p_lib.c                 |  17 ++----
 crypto/evp/p_seal.c                |   4 +-
 crypto/evp/pmeth_lib.c             |   4 +-
 crypto/include/internal/chacha.h   |   4 --
 crypto/include/internal/poly1305.h |   4 --
 crypto/init.c                      |   4 --
 crypto/pem/pem_all.c               |  12 +---
 crypto/pem/pem_info.c              |   8 +--
 crypto/pem/pem_lib.c               |   8 +--
 crypto/pem/pem_pkey.c              |   8 +--
 crypto/rand/rand_lib.c             |   4 +-
 crypto/rsa/rsa_ameth.c             |   4 +-
 crypto/rsa/rsa_lib.c               |   4 +-
 crypto/rsa/rsa_pmeth.c             |   4 +-
 crypto/ts/ts_conf.c                |   4 +-
 crypto/x509/t_req.c                |   8 +--
 crypto/x509/x_all.c                |   8 +--
 include/openssl/aes.h              |  19 +++---
 include/openssl/blowfish.h         |  15 +++--
 include/openssl/bn.h               |   2 +-
 include/openssl/camellia.h         |  19 +++---
 include/openssl/cast.h             |  14 ++---
 include/openssl/cms.h              |  18 +++---
 include/openssl/comp.h             |  15 ++---
 include/openssl/ct.h               |  15 ++---
 include/openssl/des.h              |  21 +++----
 include/openssl/dh.h               |  30 +++------
 include/openssl/dsa.h              |  24 +++-----
 include/openssl/ec.h               |  22 ++-----
 include/openssl/engine.h           |  34 ++++-------
 include/openssl/idea.h             |  14 ++---
 include/openssl/lhash.h            |   4 --
 include/openssl/md2.h              |  18 +++---
 include/openssl/md4.h              |  16 ++---
 include/openssl/md5.h              |  15 +++--
 include/openssl/mdc2.h             |  15 +++--
 include/openssl/rc2.h              |  15 +++--
 include/openssl/rc4.h              |  12 ++--
 include/openssl/rc5.h              |  14 ++---
 include/openssl/ripemd.h           |  17 +++---
 include/openssl/rsa.h              |  22 +++----
 include/openssl/seed.h             |  20 +++---
 include/openssl/srp.h              |  23 +++----
 include/openssl/ssl.h              |   7 +--
 include/openssl/ssl3.h             |   4 +-
 include/openssl/ts.h               |  28 +++------
 include/openssl/whrlpool.h         |  15 ++---
 include/openssl/x509.h             |  17 ++----
 ssl/s3_lib.c                       |   4 +-
 ssl/ssl_cert.c                     |   4 +-
 ssl/ssl_ciph.c                     |   8 +--
 ssl/ssl_conf.c                     |   4 +-
 ssl/ssl_lib.c                      |  12 +---
 ssl/ssl_locl.h                     |  16 ++---
 ssl/ssl_sess.c                     |   4 +-
 ssl/statem/statem_clnt.c           |   8 +--
 ssl/statem/statem_srvr.c           |   4 +-
 ssl/t1_enc.c                       |   4 +-
 ssl/t1_ext.c                       |   4 +-
 ssl/t1_lib.c                       |  10 +--
 util/libcrypto.num                 | 122 ++++++++++++++++++-------------------
 102 files changed, 381 insertions(+), 685 deletions(-)

diff --git a/CHANGES b/CHANGES
index 16443a3..08cd0a3 100644
--- a/CHANGES
+++ b/CHANGES
@@ -4,6 +4,10 @@
 
  Changes between 1.0.2g and 1.1.0  [xx XXX xxxx]
 
+  *) Headers are now wrapped, if necessary, with OPENSSL_NO_xxx, so
+     it is always safe to #include a header now.
+     [Rich Salz]
+
   *) Removed the aged BC-32 config and all its supporting scripts
      [Richard Levitte]
 
diff --git a/apps/apps.h b/apps/apps.h
index e7ea461..7be7325 100644
--- a/apps/apps.h
+++ b/apps/apps.h
@@ -121,12 +121,8 @@
 # include &lt;openssl/lhash.h&gt;
 # include &lt;openssl/conf.h&gt;
 # include &lt;openssl/txt_db.h&gt;
-# ifndef OPENSSL_NO_ENGINE
-#  include &lt;openssl/engine.h&gt;
-# endif
-# ifndef OPENSSL_NO_OCSP
-#  include &lt;openssl/ocsp.h&gt;
-# endif
+# include &lt;openssl/engine.h&gt;
+# include &lt;openssl/ocsp.h&gt;
 # include &lt;openssl/ossl_typ.h&gt;
 # include &lt;signal.h&gt;
 
diff --git a/crypto/aes/aes_locl.h b/crypto/aes/aes_locl.h
index 7ab2d19..e49f357 100644
--- a/crypto/aes/aes_locl.h
+++ b/crypto/aes/aes_locl.h
@@ -52,11 +52,6 @@
 # define HEADER_AES_LOCL_H
 
 # include &lt;openssl/e_os2.h&gt;
-
-# ifdef OPENSSL_NO_AES
-#  error AES is disabled.
-# endif
-
 # include &lt;stdio.h&gt;
 # include &lt;stdlib.h&gt;
 # include &lt;string.h&gt;
diff --git a/crypto/asn1/ameth_lib.c b/crypto/asn1/ameth_lib.c
index 0926a4f..a0c6320 100644
--- a/crypto/asn1/ameth_lib.c
+++ b/crypto/asn1/ameth_lib.c
@@ -60,9 +60,7 @@
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;openssl/asn1t.h&gt;
 #include &lt;openssl/x509.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 #include &quot;internal/asn1_int.h&quot;
 #include &quot;internal/evp_int.h&quot;
 
diff --git a/crypto/asn1/d2i_pr.c b/crypto/asn1/d2i_pr.c
index e405b83..85567ce 100644
--- a/crypto/asn1/d2i_pr.c
+++ b/crypto/asn1/d2i_pr.c
@@ -60,9 +60,7 @@
 #include &lt;openssl/bn.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/objects.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 #include &lt;openssl/x509.h&gt;
 #include &lt;openssl/asn1.h&gt;
 #include &quot;internal/asn1_int.h&quot;
diff --git a/crypto/asn1/d2i_pu.c b/crypto/asn1/d2i_pu.c
index 9665ae6..3ebdb5d 100644
--- a/crypto/asn1/d2i_pu.c
+++ b/crypto/asn1/d2i_pu.c
@@ -61,15 +61,9 @@
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/asn1.h&gt;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DSA
-# include &lt;openssl/dsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_EC
-# include &lt;openssl/ec.h&gt;
-#endif
+#include &lt;openssl/rsa.h&gt;
+#include &lt;openssl/dsa.h&gt;
+#include &lt;openssl/ec.h&gt;
 
 #include &quot;internal/evp_int.h&quot;
 
diff --git a/crypto/asn1/i2d_pu.c b/crypto/asn1/i2d_pu.c
index db508ac..c1504d8 100644
--- a/crypto/asn1/i2d_pu.c
+++ b/crypto/asn1/i2d_pu.c
@@ -60,15 +60,9 @@
 #include &lt;openssl/bn.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/objects.h&gt;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DSA
-# include &lt;openssl/dsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_EC
-# include &lt;openssl/ec.h&gt;
-#endif
+#include &lt;openssl/rsa.h&gt;
+#include &lt;openssl/dsa.h&gt;
+#include &lt;openssl/ec.h&gt;
 
 int i2d_PublicKey(EVP_PKEY *a, unsigned char **pp)
 {
diff --git a/crypto/asn1/t_spki.c b/crypto/asn1/t_spki.c
index 206bd24..a289c7d 100644
--- a/crypto/asn1/t_spki.c
+++ b/crypto/asn1/t_spki.c
@@ -60,12 +60,8 @@
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;openssl/x509.h&gt;
 #include &lt;openssl/asn1.h&gt;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DSA
-# include &lt;openssl/dsa.h&gt;
-#endif
+#include &lt;openssl/rsa.h&gt;
+#include &lt;openssl/dsa.h&gt;
 #include &lt;openssl/bn.h&gt;
 
 /* Print out an SPKI */
diff --git a/crypto/asn1/x_pubkey.c b/crypto/asn1/x_pubkey.c
index 7c88291..158d1d2 100644
--- a/crypto/asn1/x_pubkey.c
+++ b/crypto/asn1/x_pubkey.c
@@ -61,12 +61,8 @@
 #include &lt;openssl/x509.h&gt;
 #include &quot;internal/asn1_int.h&quot;
 #include &quot;internal/evp_int.h&quot;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DSA
-# include &lt;openssl/dsa.h&gt;
-#endif
+#include &lt;openssl/rsa.h&gt;
+#include &lt;openssl/dsa.h&gt;
 
 /* Minor tweak to operation: free up EVP_PKEY */
 static int pubkey_cb(int operation, ASN1_VALUE **pval, const ASN1_ITEM *it,
diff --git a/crypto/async/arch/async_null.c b/crypto/async/arch/async_null.c
index f0b8a5c..19fb72c 100644
--- a/crypto/async/arch/async_null.c
+++ b/crypto/async/arch/async_null.c
@@ -54,6 +54,8 @@
 #include &quot;../async_locl.h&quot;
 
 #ifdef ASYNC_NULL
+# include &lt;openssl/ct.h&gt;
+# include &lt;openssl/x509v3.h&gt;
 
 int ASYNC_is_capable(void)
 {
diff --git a/crypto/blake2/blake2_locl.h b/crypto/blake2/blake2_locl.h
index ba438f4..10334b1 100644
--- a/crypto/blake2/blake2_locl.h
+++ b/crypto/blake2/blake2_locl.h
@@ -18,10 +18,6 @@
 #include &lt;stddef.h&gt;
 #include &quot;e_os.h&quot;
 
-# ifdef OPENSSL_NO_BLAKE2
-#  error BLAKE2 is disabled.
-# endif
-
 #define BLAKE2S_BLOCKBYTES    64
 #define BLAKE2S_OUTBYTES      32
 #define BLAKE2S_KEYBYTES      32
diff --git a/crypto/cms/cms_cd.c b/crypto/cms/cms_cd.c
index 4854259..9e12078 100644
--- a/crypto/cms/cms_cd.c
+++ b/crypto/cms/cms_cd.c
@@ -58,9 +58,7 @@
 #include &lt;openssl/err.h&gt;
 #include &lt;openssl/cms.h&gt;
 #include &lt;openssl/bio.h&gt;
-#ifndef OPENSSL_NO_COMP
-# include &lt;openssl/comp.h&gt;
-#endif
+#include &lt;openssl/comp.h&gt;
 #include &quot;cms_lcl.h&quot;
 
 #ifdef ZLIB
diff --git a/crypto/conf/conf_mall.c b/crypto/conf/conf_mall.c
index 0a33368..8480c2f 100644
--- a/crypto/conf/conf_mall.c
+++ b/crypto/conf/conf_mall.c
@@ -63,9 +63,7 @@
 #include &lt;openssl/dso.h&gt;
 #include &lt;openssl/x509.h&gt;
 #include &lt;openssl/asn1.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 
 /* Load all OpenSSL builtin modules */
 
diff --git a/crypto/conf/conf_sap.c b/crypto/conf/conf_sap.c
index e70fb7a..9cc7a93 100644
--- a/crypto/conf/conf_sap.c
+++ b/crypto/conf/conf_sap.c
@@ -63,9 +63,7 @@
 #include &lt;openssl/dso.h&gt;
 #include &lt;openssl/x509.h&gt;
 #include &lt;openssl/asn1.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 
 /*
  * This is the automatic configuration loader: it is called automatically by
diff --git a/crypto/ct/ct_locl.h b/crypto/ct/ct_locl.h
index 659120b..0af4b7f 100644
--- a/crypto/ct/ct_locl.h
+++ b/crypto/ct/ct_locl.h
@@ -50,10 +50,6 @@
  * ====================================================================
  */
 
-#ifdef OPENSSL_NO_CT
-# error CT is disabled.
-#endif
-
 #include &lt;stddef.h&gt;
 #include &lt;openssl/ct.h&gt;
 #include &lt;openssl/evp.h&gt;
diff --git a/crypto/dh/dh_ameth.c b/crypto/dh/dh_ameth.c
index d644c86..fc03d8f 100644
--- a/crypto/dh/dh_ameth.c
+++ b/crypto/dh/dh_ameth.c
@@ -64,9 +64,7 @@
 #include &lt;openssl/bn.h&gt;
 #include &quot;internal/asn1_int.h&quot;
 #include &quot;internal/evp_int.h&quot;
-#ifndef OPENSSL_NO_CMS
-# include &lt;openssl/cms.h&gt;
-#endif
+#include &lt;openssl/cms.h&gt;
 
 /*
  * i2d/d2i like DH parameter functions which use the appropriate routine for
diff --git a/crypto/dh/dh_lib.c b/crypto/dh/dh_lib.c
index d7aed6a..1a0c054 100644
--- a/crypto/dh/dh_lib.c
+++ b/crypto/dh/dh_lib.c
@@ -59,9 +59,7 @@
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;openssl/bn.h&gt;
 #include &lt;openssl/dh.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 
 static const DH_METHOD *default_DH_method = NULL;
 
diff --git a/crypto/dh/dh_pmeth.c b/crypto/dh/dh_pmeth.c
index a760ff5..93bada0 100644
--- a/crypto/dh/dh_pmeth.c
+++ b/crypto/dh/dh_pmeth.c
@@ -63,9 +63,7 @@
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/dh.h&gt;
 #include &lt;openssl/bn.h&gt;
-#ifndef OPENSSL_NO_DSA
-# include &lt;openssl/dsa.h&gt;
-#endif
+#include &lt;openssl/dsa.h&gt;
 #include &lt;openssl/objects.h&gt;
 #include &quot;internal/evp_int.h&quot;
 
diff --git a/crypto/dsa/dsa_ameth.c b/crypto/dsa/dsa_ameth.c
index 5661af5..f0f28bd 100644
--- a/crypto/dsa/dsa_ameth.c
+++ b/crypto/dsa/dsa_ameth.c
@@ -62,9 +62,7 @@
 #include &lt;openssl/asn1.h&gt;
 #include &lt;openssl/dsa.h&gt;
 #include &lt;openssl/bn.h&gt;
-#ifndef OPENSSL_NO_CMS
-# include &lt;openssl/cms.h&gt;
-#endif
+#include &lt;openssl/cms.h&gt;
 #include &quot;internal/asn1_int.h&quot;
 #include &quot;internal/evp_int.h&quot;
 
diff --git a/crypto/dsa/dsa_gen.c b/crypto/dsa/dsa_gen.c
index 15d5116..c278d98 100644
--- a/crypto/dsa/dsa_gen.c
+++ b/crypto/dsa/dsa_gen.c
@@ -62,15 +62,13 @@
  */
 #define xxxHASH    EVP_sha1()
 
-#include &lt;openssl/opensslconf.h&gt; /* To see if OPENSSL_NO_SHA is defined */
-
+#include &lt;openssl/opensslconf.h&gt;
 #include &lt;stdio.h&gt;
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/bn.h&gt;
 #include &lt;openssl/rand.h&gt;
 #include &lt;openssl/sha.h&gt;
-
 #include &quot;dsa_locl.h&quot;
 
 int DSA_generate_parameters_ex(DSA *ret, int bits,
diff --git a/crypto/dsa/dsa_lib.c b/crypto/dsa/dsa_lib.c
index 3b99b3c..fa8330f 100644
--- a/crypto/dsa/dsa_lib.c
+++ b/crypto/dsa/dsa_lib.c
@@ -62,12 +62,8 @@
 #include &lt;openssl/bn.h&gt;
 #include &lt;openssl/dsa.h&gt;
 #include &lt;openssl/asn1.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
+#include &lt;openssl/dh.h&gt;
 
 static const DSA_METHOD *default_DSA_method = NULL;
 
diff --git a/crypto/ec/ec_ameth.c b/crypto/ec/ec_ameth.c
index 310bfad..ca354c0 100644
--- a/crypto/ec/ec_ameth.c
+++ b/crypto/ec/ec_ameth.c
@@ -61,9 +61,7 @@
 #include &lt;openssl/x509.h&gt;
 #include &lt;openssl/ec.h&gt;
 #include &lt;openssl/bn.h&gt;
-#ifndef OPENSSL_NO_CMS
-# include &lt;openssl/cms.h&gt;
-#endif
+#include &lt;openssl/cms.h&gt;
 #include &lt;openssl/asn1t.h&gt;
 #include &quot;internal/asn1_int.h&quot;
 #include &quot;internal/evp_int.h&quot;
diff --git a/crypto/ec/ec_key.c b/crypto/ec/ec_key.c
index 0d7370e..d241154 100644
--- a/crypto/ec/ec_key.c
+++ b/crypto/ec/ec_key.c
@@ -64,9 +64,7 @@
 #include &lt;string.h&gt;
 #include &quot;ec_lcl.h&quot;
 #include &lt;openssl/err.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 
 EC_KEY *EC_KEY_new(void)
 {
diff --git a/crypto/ec/ec_kmeth.c b/crypto/ec/ec_kmeth.c
index dc097ce..003421e 100644
--- a/crypto/ec/ec_kmeth.c
+++ b/crypto/ec/ec_kmeth.c
@@ -53,9 +53,7 @@
 
 #include &lt;string.h&gt;
 #include &lt;openssl/ec.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 #include &lt;openssl/err.h&gt;
 #include &quot;ec_lcl.h&quot;
 
diff --git a/crypto/ec/ecdsa_sign.c b/crypto/ec/ecdsa_sign.c
index df90175..738c276 100644
--- a/crypto/ec/ecdsa_sign.c
+++ b/crypto/ec/ecdsa_sign.c
@@ -54,9 +54,7 @@
 
 #include &lt;openssl/ec.h&gt;
 #include &quot;ec_lcl.h&quot;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 #include &lt;openssl/rand.h&gt;
 #include &lt;openssl/err.h&gt;
 
diff --git a/crypto/ec/ecdsa_vrf.c b/crypto/ec/ecdsa_vrf.c
index 0441bc0..f519b59 100644
--- a/crypto/ec/ecdsa_vrf.c
+++ b/crypto/ec/ecdsa_vrf.c
@@ -58,9 +58,7 @@
 #include &lt;openssl/ec.h&gt;
 #include &quot;ec_lcl.h&quot;
 #include &lt;string.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 #include &lt;openssl/err.h&gt;
 
 /*-
diff --git a/crypto/engine/eng_cryptodev.c b/crypto/engine/eng_cryptodev.c
index 4acea62..34193f3 100644
--- a/crypto/engine/eng_cryptodev.c
+++ b/crypto/engine/eng_cryptodev.c
@@ -56,9 +56,7 @@
 # include &lt;errno.h&gt;
 # include &lt;string.h&gt;
 #endif
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-#endif
+#include &lt;openssl/dh.h&gt;
 #include &lt;openssl/dsa.h&gt;
 #include &lt;openssl/err.h&gt;
 #include &lt;openssl/rsa.h&gt;
diff --git a/crypto/engine/eng_openssl.c b/crypto/engine/eng_openssl.c
index 914bba5..2bf91b3 100644
--- a/crypto/engine/eng_openssl.c
+++ b/crypto/engine/eng_openssl.c
@@ -69,15 +69,9 @@
 #include &lt;openssl/pem.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/rand.h&gt;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DSA
-# include &lt;openssl/dsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-#endif
+#include &lt;openssl/rsa.h&gt;
+#include &lt;openssl/dsa.h&gt;
+#include &lt;openssl/dh.h&gt;
 
 #include &lt;openssl/hmac.h&gt;
 #include &lt;openssl/x509v3.h&gt;
diff --git a/crypto/err/err_all.c b/crypto/err/err_all.c
index 8939c08..a79a84e 100644
--- a/crypto/err/err_all.c
+++ b/crypto/err/err_all.c
@@ -59,23 +59,13 @@
 #include &lt;internal/err.h&gt;
 #include &lt;openssl/asn1.h&gt;
 #include &lt;openssl/bn.h&gt;
-#ifndef OPENSSL_NO_EC
-# include &lt;openssl/ec.h&gt;
-#endif
+#include &lt;openssl/ec.h&gt;
 #include &lt;openssl/buffer.h&gt;
 #include &lt;openssl/bio.h&gt;
-#ifndef OPENSSL_NO_COMP
-# include &lt;openssl/comp.h&gt;
-#endif
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-#endif
-#ifndef OPENSSL_NO_DSA
-# include &lt;openssl/dsa.h&gt;
-#endif
+#include &lt;openssl/comp.h&gt;
+#include &lt;openssl/rsa.h&gt;
+#include &lt;openssl/dh.h&gt;
+#include &lt;openssl/dsa.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/pem2.h&gt;
@@ -85,9 +75,7 @@
 #include &lt;openssl/pkcs12.h&gt;
 #include &lt;openssl/rand.h&gt;
 #include &lt;openssl/dso.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 #include &lt;openssl/ui.h&gt;
 #include &lt;openssl/ocsp.h&gt;
 #include &lt;openssl/err.h&gt;
@@ -95,12 +83,8 @@
 # include &lt;openssl/fips.h&gt;
 #endif
 #include &lt;openssl/ts.h&gt;
-#ifndef OPENSSL_NO_CMS
-# include &lt;openssl/cms.h&gt;
-#endif
-#ifndef OPENSSL_NO_CT
-# include &lt;openssl/ct.h&gt;
-#endif
+#include &lt;openssl/cms.h&gt;
+#include &lt;openssl/ct.h&gt;
 #include &lt;openssl/async.h&gt;
 #include &lt;openssl/kdf.h&gt;
 
diff --git a/crypto/evp/digest.c b/crypto/evp/digest.c
index 0ed8845..aee8127 100644
--- a/crypto/evp/digest.c
+++ b/crypto/evp/digest.c
@@ -112,9 +112,7 @@
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/evp.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 #include &quot;internal/evp_int.h&quot;
 #include &quot;evp_locl.h&quot;
 
diff --git a/crypto/evp/e_aes.c b/crypto/evp/e_aes.c
index 360f572..c906e6f 100644
--- a/crypto/evp/e_aes.c
+++ b/crypto/evp/e_aes.c
@@ -50,7 +50,7 @@
 
 #include &lt;openssl/opensslconf.h&gt;
 #ifndef OPENSSL_NO_AES
-#include &lt;openssl/crypto.h&gt;
+# include &lt;openssl/crypto.h&gt;
 # include &lt;openssl/evp.h&gt;
 # include &lt;openssl/err.h&gt;
 # include &lt;string.h&gt;
diff --git a/crypto/evp/evp_enc.c b/crypto/evp/evp_enc.c
index 484b024..d7cc1f4 100644
--- a/crypto/evp/evp_enc.c
+++ b/crypto/evp/evp_enc.c
@@ -60,9 +60,7 @@
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/err.h&gt;
 #include &lt;openssl/rand.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 #include &quot;internal/evp_int.h&quot;
 #include &quot;evp_locl.h&quot;
 
diff --git a/crypto/evp/m_md2.c b/crypto/evp/m_md2.c
index 5c1ac38..0e83dfe 100644
--- a/crypto/evp/m_md2.c
+++ b/crypto/evp/m_md2.c
@@ -64,9 +64,7 @@
 # include &lt;openssl/objects.h&gt;
 # include &lt;openssl/x509.h&gt;
 # include &lt;openssl/md2.h&gt;
-# ifndef OPENSSL_NO_RSA
-#  include &lt;openssl/rsa.h&gt;
-# endif
+# include &lt;openssl/rsa.h&gt;
 
 #include &quot;internal/evp_int.h&quot;
 
diff --git a/crypto/evp/m_md4.c b/crypto/evp/m_md4.c
index e63db4e..933d82a 100644
--- a/crypto/evp/m_md4.c
+++ b/crypto/evp/m_md4.c
@@ -64,9 +64,7 @@
 # include &lt;openssl/objects.h&gt;
 # include &lt;openssl/x509.h&gt;
 # include &lt;openssl/md4.h&gt;
-# ifndef OPENSSL_NO_RSA
-#  include &lt;openssl/rsa.h&gt;
-# endif
+# include &lt;openssl/rsa.h&gt;
 # include &quot;internal/evp_int.h&quot;
 
 static int init(EVP_MD_CTX *ctx)
diff --git a/crypto/evp/m_md5.c b/crypto/evp/m_md5.c
index adaa857..b28be91 100644
--- a/crypto/evp/m_md5.c
+++ b/crypto/evp/m_md5.c
@@ -64,9 +64,7 @@
 # include &lt;openssl/objects.h&gt;
 # include &lt;openssl/x509.h&gt;
 # include &lt;openssl/md5.h&gt;
-# ifndef OPENSSL_NO_RSA
-#  include &lt;openssl/rsa.h&gt;
-# endif
+# include &lt;openssl/rsa.h&gt;
 # include &quot;internal/evp_int.h&quot;
 
 static int init(EVP_MD_CTX *ctx)
diff --git a/crypto/evp/m_md5_sha1.c b/crypto/evp/m_md5_sha1.c
index 949b0e5..ae28ddc 100644
--- a/crypto/evp/m_md5_sha1.c
+++ b/crypto/evp/m_md5_sha1.c
@@ -60,9 +60,7 @@
 # include &lt;openssl/sha.h&gt;
 # include &quot;internal/cryptlib.h&quot;
 # include &quot;internal/evp_int.h&quot;
-# ifndef OPENSSL_NO_RSA
-#  include &lt;openssl/rsa.h&gt;
-# endif
+# include &lt;openssl/rsa.h&gt;
 
 struct md5_sha1_ctx {
     MD5_CTX md5;
diff --git a/crypto/evp/m_mdc2.c b/crypto/evp/m_mdc2.c
index dbe71df..f7fa600 100644
--- a/crypto/evp/m_mdc2.c
+++ b/crypto/evp/m_mdc2.c
@@ -64,9 +64,7 @@
 # include &lt;openssl/objects.h&gt;
 # include &lt;openssl/x509.h&gt;
 # include &lt;openssl/mdc2.h&gt;
-# ifndef OPENSSL_NO_RSA
-#  include &lt;openssl/rsa.h&gt;
-# endif
+# include &lt;openssl/rsa.h&gt;
 # include &quot;internal/evp_int.h&quot;
 
 static int init(EVP_MD_CTX *ctx)
diff --git a/crypto/evp/m_ripemd.c b/crypto/evp/m_ripemd.c
index 67aa3cf..d4488be 100644
--- a/crypto/evp/m_ripemd.c
+++ b/crypto/evp/m_ripemd.c
@@ -64,9 +64,7 @@
 # include &lt;openssl/evp.h&gt;
 # include &lt;openssl/objects.h&gt;
 # include &lt;openssl/x509.h&gt;
-# ifndef OPENSSL_NO_RSA
-#  include &lt;openssl/rsa.h&gt;
-# endif
+# include &lt;openssl/rsa.h&gt;
 # include &quot;internal/evp_int.h&quot;
 
 static int init(EVP_MD_CTX *ctx)
diff --git a/crypto/evp/m_sha1.c b/crypto/evp/m_sha1.c
index fb674ae..e673e41 100644
--- a/crypto/evp/m_sha1.c
+++ b/crypto/evp/m_sha1.c
@@ -61,9 +61,7 @@
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/sha.h&gt;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
+#include &lt;openssl/rsa.h&gt;
 #include &quot;internal/evp_int.h&quot;
 
 static int init(EVP_MD_CTX *ctx)
diff --git a/crypto/evp/p_dec.c b/crypto/evp/p_dec.c
index 37f6822..5729ed7 100644
--- a/crypto/evp/p_dec.c
+++ b/crypto/evp/p_dec.c
@@ -58,9 +58,7 @@
 #include &lt;stdio.h&gt;
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;openssl/rand.h&gt;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
+#include &lt;openssl/rsa.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/x509.h&gt;
diff --git a/crypto/evp/p_enc.c b/crypto/evp/p_enc.c
index d3bcaa0..f1fc818 100644
--- a/crypto/evp/p_enc.c
+++ b/crypto/evp/p_enc.c
@@ -58,9 +58,7 @@
 #include &lt;stdio.h&gt;
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;openssl/rand.h&gt;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
+#include &lt;openssl/rsa.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/x509.h&gt;
diff --git a/crypto/evp/p_lib.c b/crypto/evp/p_lib.c
index a7d6244..a8fa301 100644
--- a/crypto/evp/p_lib.c
+++ b/crypto/evp/p_lib.c
@@ -62,19 +62,10 @@
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/x509.h&gt;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DSA
-# include &lt;openssl/dsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-#endif
-
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/rsa.h&gt;
+#include &lt;openssl/dsa.h&gt;
+#include &lt;openssl/dh.h&gt;
+#include &lt;openssl/engine.h&gt;
 
 #include &quot;internal/asn1_int.h&quot;
 #include &quot;internal/evp_int.h&quot;
diff --git a/crypto/evp/p_seal.c b/crypto/evp/p_seal.c
index 52436d1..d802d84 100644
--- a/crypto/evp/p_seal.c
+++ b/crypto/evp/p_seal.c
@@ -58,9 +58,7 @@
 #include &lt;stdio.h&gt;
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;openssl/rand.h&gt;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
+#include &lt;openssl/rsa.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/x509.h&gt;
diff --git a/crypto/evp/pmeth_lib.c b/crypto/evp/pmeth_lib.c
index a285009..ff5baa7 100644
--- a/crypto/evp/pmeth_lib.c
+++ b/crypto/evp/pmeth_lib.c
@@ -59,9 +59,7 @@
 #include &lt;stdio.h&gt;
 #include &lt;stdlib.h&gt;
 #include &quot;internal/cryptlib.h&quot;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/x509v3.h&gt;
 #include &quot;internal/asn1_int.h&quot;
diff --git a/crypto/include/internal/chacha.h b/crypto/include/internal/chacha.h
index 98787d3..dacbdf5 100644
--- a/crypto/include/internal/chacha.h
+++ b/crypto/include/internal/chacha.h
@@ -57,10 +57,6 @@
 extern &quot;C&quot; {
 #endif
 
-# ifdef OPENSSL_NO_CHACHA
-#  error CHACHA is disabled.
-# endif
-
 /*
  * ChaCha20_ctr32 encrypts |len| bytes from |inp| with the given key and
  * nonce and writes the result to |out|, which may be equal to |inp|.
diff --git a/crypto/include/internal/poly1305.h b/crypto/include/internal/poly1305.h
index b6db325..8e2cac5 100644
--- a/crypto/include/internal/poly1305.h
+++ b/crypto/include/internal/poly1305.h
@@ -49,10 +49,6 @@
  */
 #include &lt;stddef.h&gt;
 
-#ifdef OPENSSL_NO_POLY1305
-# error POLY1305 is disabled.
-#endif
-
 #define POLY1305_BLOCK_SIZE 16
 
 typedef struct poly1305_context POLY1305;
diff --git a/crypto/init.c b/crypto/init.c
index fad7a85..d316780 100644
--- a/crypto/init.c
+++ b/crypto/init.c
@@ -63,12 +63,8 @@
 #include &lt;internal/evp_int.h&gt;
 #include &lt;internal/conf.h&gt;
 #include &lt;internal/async.h&gt;
-#ifndef OPENSSL_NO_ENGINE
 #include &lt;internal/engine.h&gt;
-#endif
-#ifndef OPENSSL_NO_COMP
 #include &lt;openssl/comp.h&gt;
-#endif
 #include &lt;internal/err.h&gt;
 #include &lt;stdlib.h&gt;
 #include &lt;assert.h&gt;
diff --git a/crypto/pem/pem_all.c b/crypto/pem/pem_all.c
index 9a08c02..5967b6e 100644
--- a/crypto/pem/pem_all.c
+++ b/crypto/pem/pem_all.c
@@ -115,15 +115,9 @@
 #include &lt;openssl/x509.h&gt;
 #include &lt;openssl/pkcs7.h&gt;
 #include &lt;openssl/pem.h&gt;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DSA
-# include &lt;openssl/dsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-#endif
+#include &lt;openssl/rsa.h&gt;
+#include &lt;openssl/dsa.h&gt;
+#include &lt;openssl/dh.h&gt;
 
 #ifndef OPENSSL_NO_RSA
 static RSA *pkey_get_rsa(EVP_PKEY *key, RSA **rsa);
diff --git a/crypto/pem/pem_info.c b/crypto/pem/pem_info.c
index 50a5051..1b1cde4 100644
--- a/crypto/pem/pem_info.c
+++ b/crypto/pem/pem_info.c
@@ -62,12 +62,8 @@
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/x509.h&gt;
 #include &lt;openssl/pem.h&gt;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DSA
-# include &lt;openssl/dsa.h&gt;
-#endif
+#include &lt;openssl/rsa.h&gt;
+#include &lt;openssl/dsa.h&gt;
 
 #ifndef OPENSSL_NO_STDIO
 STACK_OF(X509_INFO) *PEM_X509_INFO_read(FILE *fp, STACK_OF(X509_INFO) *sk,
diff --git a/crypto/pem/pem_lib.c b/crypto/pem/pem_lib.c
index 54ddc1e..5e7aa77 100644
--- a/crypto/pem/pem_lib.c
+++ b/crypto/pem/pem_lib.c
@@ -66,12 +66,8 @@
 #include &lt;openssl/pem.h&gt;
 #include &lt;openssl/pkcs12.h&gt;
 #include &quot;internal/asn1_int.h&quot;
-#ifndef OPENSSL_NO_DES
-# include &lt;openssl/des.h&gt;
-#endif
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/des.h&gt;
+#include &lt;openssl/engine.h&gt;
 
 #define MIN_LENGTH      4
 
diff --git a/crypto/pem/pem_pkey.c b/crypto/pem/pem_pkey.c
index 8eb398d..ef0c0e4 100644
--- a/crypto/pem/pem_pkey.c
+++ b/crypto/pem/pem_pkey.c
@@ -64,12 +64,8 @@
 #include &lt;openssl/x509.h&gt;
 #include &lt;openssl/pkcs12.h&gt;
 #include &lt;openssl/pem.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
+#include &lt;openssl/dh.h&gt;
 #include &quot;internal/asn1_int.h&quot;
 #include &quot;internal/evp_int.h&quot;
 
diff --git a/crypto/rand/rand_lib.c b/crypto/rand/rand_lib.c
index 63fd231..36b41cd 100644
--- a/crypto/rand/rand_lib.c
+++ b/crypto/rand/rand_lib.c
@@ -61,9 +61,7 @@
 #include &lt;openssl/opensslconf.h&gt;
 #include &lt;openssl/rand.h&gt;
 
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 
 #ifdef OPENSSL_FIPS
 # include &lt;openssl/fips.h&gt;
diff --git a/crypto/rsa/rsa_ameth.c b/crypto/rsa/rsa_ameth.c
index 15f2194..ad51a44 100644
--- a/crypto/rsa/rsa_ameth.c
+++ b/crypto/rsa/rsa_ameth.c
@@ -62,9 +62,7 @@
 #include &lt;openssl/x509.h&gt;
 #include &lt;openssl/rsa.h&gt;
 #include &lt;openssl/bn.h&gt;
-#ifndef OPENSSL_NO_CMS
-# include &lt;openssl/cms.h&gt;
-#endif
+#include &lt;openssl/cms.h&gt;
 #include &quot;internal/asn1_int.h&quot;
 #include &quot;internal/evp_int.h&quot;
 
diff --git a/crypto/rsa/rsa_lib.c b/crypto/rsa/rsa_lib.c
index 9cc8814..bd881ed 100644
--- a/crypto/rsa/rsa_lib.c
+++ b/crypto/rsa/rsa_lib.c
@@ -62,9 +62,7 @@
 #include &quot;internal/bn_int.h&quot;
 #include &lt;openssl/rsa.h&gt;
 #include &lt;openssl/rand.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 
 static const RSA_METHOD *default_RSA_meth = NULL;
 
diff --git a/crypto/rsa/rsa_pmeth.c b/crypto/rsa/rsa_pmeth.c
index 93c8756..22089a3 100644
--- a/crypto/rsa/rsa_pmeth.c
+++ b/crypto/rsa/rsa_pmeth.c
@@ -64,9 +64,7 @@
 #include &lt;openssl/bn.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/x509v3.h&gt;
-#ifndef OPENSSL_NO_CMS
-# include &lt;openssl/cms.h&gt;
-#endif
+#include &lt;openssl/cms.h&gt;
 #include &quot;internal/evp_int.h&quot;
 #include &quot;rsa_locl.h&quot;
 
diff --git a/crypto/ts/ts_conf.c b/crypto/ts/ts_conf.c
index 6adea58..e610691 100644
--- a/crypto/ts/ts_conf.c
+++ b/crypto/ts/ts_conf.c
@@ -61,9 +61,7 @@
 #include &lt;openssl/crypto.h&gt;
 #include &quot;internal/cryptlib.h&quot;
 #include &lt;openssl/pem.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 #include &lt;openssl/ts.h&gt;
 
 /* Macro definitions for the configuration file. */
diff --git a/crypto/x509/t_req.c b/crypto/x509/t_req.c
index 2c519f9..afe59c4 100644
--- a/crypto/x509/t_req.c
+++ b/crypto/x509/t_req.c
@@ -62,12 +62,8 @@
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/x509.h&gt;
 #include &lt;openssl/x509v3.h&gt;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DSA
-# include &lt;openssl/dsa.h&gt;
-#endif
+#include &lt;openssl/rsa.h&gt;
+#include &lt;openssl/dsa.h&gt;
 
 #ifndef OPENSSL_NO_STDIO
 int X509_REQ_print_fp(FILE *fp, X509_REQ *x)
diff --git a/crypto/x509/x_all.c b/crypto/x509/x_all.c
index f62a7c8..c370ba9 100644
--- a/crypto/x509/x_all.c
+++ b/crypto/x509/x_all.c
@@ -64,12 +64,8 @@
 #include &lt;openssl/x509.h&gt;
 #include &quot;internal/x509_int.h&quot;
 #include &lt;openssl/ocsp.h&gt;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DSA
-# include &lt;openssl/dsa.h&gt;
-#endif
+#include &lt;openssl/rsa.h&gt;
+#include &lt;openssl/dsa.h&gt;
 
 int X509_verify(X509 *a, EVP_PKEY *r)
 {
diff --git a/include/openssl/aes.h b/include/openssl/aes.h
index 8c36a4d..f81ec0d 100644
--- a/include/openssl/aes.h
+++ b/include/openssl/aes.h
@@ -53,11 +53,11 @@
 
 # include &lt;openssl/opensslconf.h&gt;
 
-# ifdef OPENSSL_NO_AES
-#  error AES is disabled.
-# endif
-
+#ifndef OPENSSL_NO_AES
 # include &lt;stddef.h&gt;
+# ifdef  __cplusplus
+extern &quot;C&quot; {
+# endif
 
 # define AES_ENCRYPT     1
 # define AES_DECRYPT     0
@@ -69,10 +69,6 @@
 # define AES_MAXNR 14
 # define AES_BLOCK_SIZE 16
 
-#ifdef  __cplusplus
-extern &quot;C&quot; {
-#endif
-
 /* This should be a hidden type, but EVP requires that the size be known */
 struct aes_key_st {
 # ifdef AES_LONG
@@ -131,8 +127,9 @@ int AES_unwrap_key(AES_KEY *key, const unsigned char *iv,
                    const unsigned char *in, unsigned int inlen);
 
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
-#endif                          /* !HEADER_AES_H */
+#endif
diff --git a/include/openssl/blowfish.h b/include/openssl/blowfish.h
index ee4afa5..5e0af53 100644
--- a/include/openssl/blowfish.h
+++ b/include/openssl/blowfish.h
@@ -58,14 +58,12 @@
 #ifndef HEADER_BLOWFISH_H
 # define HEADER_BLOWFISH_H
 
-# include &lt;openssl/e_os2.h&gt;
+# include &lt;openssl/opensslconf.h&gt;
 
-#ifdef  __cplusplus
+# ifndef OPENSSL_NO_BF
+# include &lt;openssl/e_os2.h&gt;
+# ifdef  __cplusplus
 extern &quot;C&quot; {
-#endif
-
-# ifdef OPENSSL_NO_BF
-#  error BF is disabled.
 # endif
 
 # define BF_ENCRYPT      1
@@ -103,8 +101,9 @@ void BF_ofb64_encrypt(const unsigned char *in, unsigned char *out,
                       unsigned char *ivec, int *num);
 const char *BF_options(void);
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
 #endif
diff --git a/include/openssl/bn.h b/include/openssl/bn.h
index 8d2d5a8..315b99e 100644
--- a/include/openssl/bn.h
+++ b/include/openssl/bn.h
@@ -126,7 +126,7 @@
 
 # include &lt;openssl/e_os2.h&gt;
 # ifndef OPENSSL_NO_STDIO
-#  include &lt;stdio.h&gt;            /* FILE */
+#  include &lt;stdio.h&gt;
 # endif
 # include &lt;openssl/opensslconf.h&gt;
 # include &lt;openssl/ossl_typ.h&gt;
diff --git a/include/openssl/camellia.h b/include/openssl/camellia.h
index d04d2a8..d05b392 100644
--- a/include/openssl/camellia.h
+++ b/include/openssl/camellia.h
@@ -53,11 +53,11 @@
 
 # include &lt;openssl/opensslconf.h&gt;
 
-# ifdef OPENSSL_NO_CAMELLIA
-#  error CAMELLIA is disabled.
-# endif
-
+# ifndef OPENSSL_NO_CAMELLIA
 # include &lt;stddef.h&gt;
+#ifdef  __cplusplus
+extern &quot;C&quot; {
+#endif
 
 # define CAMELLIA_ENCRYPT        1
 # define CAMELLIA_DECRYPT        0
@@ -67,10 +67,6 @@
  * Both sizes are in bytes.
  */
 
-#ifdef  __cplusplus
-extern &quot;C&quot; {
-#endif
-
 /* This should be a hidden type, but EVP requires that the size be known */
 
 # define CAMELLIA_BLOCK_SIZE 16
@@ -120,8 +116,9 @@ void Camellia_ctr128_encrypt(const unsigned char *in, unsigned char *out,
                              unsigned char ecount_buf[CAMELLIA_BLOCK_SIZE],
                              unsigned int *num);
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
-#endif                          /* !HEADER_Camellia_H */
+#endif
diff --git a/include/openssl/cast.h b/include/openssl/cast.h
index 87d1933..c54d3c9 100644
--- a/include/openssl/cast.h
+++ b/include/openssl/cast.h
@@ -58,14 +58,11 @@
 #ifndef HEADER_CAST_H
 # define HEADER_CAST_H
 
-#ifdef  __cplusplus
-extern &quot;C&quot; {
-#endif
-
 # include &lt;openssl/opensslconf.h&gt;
 
-# ifdef OPENSSL_NO_CAST
-#  error CAST is disabled.
+# ifndef OPENSSL_NO_CAST
+# ifdef  __cplusplus
+extern &quot;C&quot; {
 # endif
 
 # define CAST_ENCRYPT    1
@@ -96,8 +93,9 @@ void CAST_ofb64_encrypt(const unsigned char *in, unsigned char *out,
                         long length, const CAST_KEY *schedule,
                         unsigned char *ivec, int *num);
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
 #endif
diff --git a/include/openssl/cms.h b/include/openssl/cms.h
index f8d55d8..5ae701e 100644
--- a/include/openssl/cms.h
+++ b/include/openssl/cms.h
@@ -54,16 +54,14 @@
 #ifndef HEADER_CMS_H
 # define HEADER_CMS_H
 
+# include &lt;openssl/opensslconf.h&gt;
+
+# ifndef OPENSSL_NO_CMS
 # include &lt;openssl/x509.h&gt;
 # include &lt;openssl/x509v3.h&gt;
-
-# ifdef OPENSSL_NO_CMS
-#  error CMS is disabled.
-# endif
-
-#ifdef __cplusplus
+# ifdef __cplusplus
 extern &quot;C&quot; {
-#endif
+# endif
 
 typedef struct CMS_ContentInfo_st CMS_ContentInfo;
 typedef struct CMS_SignerInfo_st CMS_SignerInfo;
@@ -551,7 +549,9 @@ void ERR_load_CMS_strings(void);
 # define CMS_R_VERIFICATION_FAILURE                       158
 # define CMS_R_WRAP_ERROR                                 159
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
+
 #endif
diff --git a/include/openssl/comp.h b/include/openssl/comp.h
index de16a9f..de4eb32 100644
--- a/include/openssl/comp.h
+++ b/include/openssl/comp.h
@@ -56,15 +56,14 @@
 #ifndef HEADER_COMP_H
 # define HEADER_COMP_H
 
-# include &lt;openssl/crypto.h&gt;
+# include &lt;openssl/opensslconf.h&gt;
 
-# ifdef OPENSSL_NO_COMP
-#  error COMP is disabled.
+# ifndef OPENSSL_NO_COMP
+# include &lt;openssl/crypto.h&gt;
+# ifdef  __cplusplus
+extern &quot;C&quot; {
 # endif
 
-#ifdef  __cplusplus
-extern &quot;C&quot; {
-#endif
 
 
 COMP_CTX *COMP_CTX_new(COMP_METHOD *meth);
@@ -110,5 +109,7 @@ void ERR_load_COMP_strings(void);
 
 #ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
+
 #endif
diff --git a/include/openssl/ct.h b/include/openssl/ct.h
index f148a27..0da3125 100644
--- a/include/openssl/ct.h
+++ b/include/openssl/ct.h
@@ -51,21 +51,20 @@
 * ====================================================================
 */
 
-#ifdef OPENSSL_NO_CT
-# error &quot;CT is disabled&quot;
-#endif
-
 #ifndef HEADER_CT_H
 # define HEADER_CT_H
 
+# include &lt;openssl/opensslconf.h&gt;
+
+# ifndef OPENSSL_NO_CT
 # include &lt;openssl/ossl_typ.h&gt;
 # include &lt;openssl/safestack.h&gt;
 # include &lt;openssl/x509.h&gt;
-
 # ifdef  __cplusplus
 extern &quot;C&quot; {
 # endif
 
+
 /* Minimum RSA key size, from RFC6962 */
 # define SCT_MIN_RSA_BITS 2048
 
@@ -601,7 +600,9 @@ void ERR_load_CT_strings(void);
 # define CT_R_UNSUPPORTED_ENTRY_TYPE                      102
 # define CT_R_UNSUPPORTED_VERSION                         103
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
+
 #endif
diff --git a/include/openssl/des.h b/include/openssl/des.h
index 13ce232..633d070 100644
--- a/include/openssl/des.h
+++ b/include/openssl/des.h
@@ -55,14 +55,16 @@
  * [including the GNU Public Licence.]
  */
 
-#ifndef HEADER_NEW_DES_H
-# define HEADER_NEW_DES_H
+#ifndef HEADER_DES_H
+# define HEADER_DES_H
 
-# include &lt;openssl/e_os2.h&gt;
+# include &lt;openssl/opensslconf.h&gt;
 
-# ifdef OPENSSL_NO_DES
-#  error DES is disabled.
+# ifndef OPENSSL_NO_DES
+# ifdef  __cplusplus
+extern &quot;C&quot; {
 # endif
+# include &lt;openssl/e_os2.h&gt;
 
 typedef unsigned int DES_LONG;
 
@@ -71,10 +73,6 @@ typedef unsigned int DES_LONG;
 #  define OPENSSL_EXTERN OPENSSL_EXPORT
 # endif
 
-#ifdef  __cplusplus
-extern &quot;C&quot; {
-#endif
-
 typedef unsigned char DES_cblock[8];
 typedef /* const */ unsigned char const_DES_cblock[8];
 /*
@@ -228,8 +226,9 @@ int DES_read_2passwords(DES_cblock *key1, DES_cblock *key2,
 
 # define DES_fixup_key_parity DES_set_odd_parity
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
 #endif
diff --git a/include/openssl/dh.h b/include/openssl/dh.h
index e852cbe..2e021e2 100644
--- a/include/openssl/dh.h
+++ b/include/openssl/dh.h
@@ -58,13 +58,10 @@
 #ifndef HEADER_DH_H
 # define HEADER_DH_H
 
-# include &lt;openssl/e_os2.h&gt;
 # include &lt;openssl/opensslconf.h&gt;
 
-# ifdef OPENSSL_NO_DH
-#  error DH is disabled.
-# endif
-
+# ifndef OPENSSL_NO_DH
+# include &lt;openssl/e_os2.h&gt;
 # include &lt;openssl/bio.h&gt;
 # include &lt;openssl/asn1.h&gt;
 # include &lt;openssl/ossl_typ.h&gt;
@@ -72,6 +69,10 @@
 #  include &lt;openssl/bn.h&gt;
 # endif
 
+# ifdef  __cplusplus
+extern &quot;C&quot; {
+# endif
+
 # ifndef OPENSSL_DH_MAX_MODULUS_BITS
 #  define OPENSSL_DH_MAX_MODULUS_BITS    10000
 # endif
@@ -79,15 +80,6 @@
 # define OPENSSL_DH_FIPS_MIN_MODULUS_BITS 1024
 
 # define DH_FLAG_CACHE_MONT_P     0x01
-
-/*
- * new with 0.9.7h; the built-in DH
- * implementation now uses constant time
- * modular exponentiation for secret exponents
- * by default. This flag causes the
- * faster variable sliding window method to
- * be used for all exponents.
- */
 # define DH_FLAG_NO_EXP_CONSTTIME 0x02
 
 /*
@@ -107,10 +99,6 @@
 
 # define DH_FLAG_NON_FIPS_ALLOW                  0x0400
 
-#ifdef  __cplusplus
-extern &quot;C&quot; {
-#endif
-
 /* Already defined in ossl_typ.h */
 /* typedef struct dh_st DH; */
 /* typedef struct dh_method DH_METHOD; */
@@ -389,7 +377,9 @@ void ERR_load_DH_strings(void);
 # define DH_R_PEER_KEY_ERROR                              111
 # define DH_R_SHARED_INFO_ERROR                           113
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
+
 #endif
diff --git a/include/openssl/dsa.h b/include/openssl/dsa.h
index 8653449..240a1af 100644
--- a/include/openssl/dsa.h
+++ b/include/openssl/dsa.h
@@ -63,22 +63,20 @@
 #ifndef HEADER_DSA_H
 # define HEADER_DSA_H
 
-# include &lt;openssl/e_os2.h&gt;
+# include &lt;openssl/opensslconf.h&gt;
 
-# ifdef OPENSSL_NO_DSA
-#  error DSA is disabled.
+# ifndef OPENSSL_NO_DSA
+# ifdef  __cplusplus
+extern &quot;C&quot; {
 # endif
-
+# include &lt;openssl/e_os2.h&gt;
 # include &lt;openssl/bio.h&gt;
 # include &lt;openssl/crypto.h&gt;
 # include &lt;openssl/ossl_typ.h&gt;
 # include &lt;openssl/opensslconf.h&gt;
-
 # if OPENSSL_API_COMPAT &lt; 0x10100000L
 #  include &lt;openssl/bn.h&gt;
-#  ifndef OPENSSL_NO_DH
-#   include &lt;openssl/dh.h&gt;
-#  endif
+#  include &lt;openssl/dh.h&gt;
 # endif
 
 # ifndef OPENSSL_DSA_MAX_MODULUS_BITS
@@ -113,10 +111,6 @@
 # define DSA_FLAG_NON_FIPS_ALLOW                 0x0400
 # define DSA_FLAG_FIPS_CHECKED                   0x0800
 
-#ifdef  __cplusplus
-extern &quot;C&quot; {
-#endif
-
 /* Already defined in ossl_typ.h */
 /* typedef struct dsa_st DSA; */
 /* typedef struct dsa_method DSA_METHOD; */
@@ -323,7 +317,9 @@ void ERR_load_DSA_strings(void);
 # define DSA_R_PARAMETER_ENCODING_ERROR                   105
 # define DSA_R_Q_NOT_PRIME                                113
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
+
 #endif
diff --git a/include/openssl/ec.h b/include/openssl/ec.h
index 103f718..892239d 100644
--- a/include/openssl/ec.h
+++ b/include/openssl/ec.h
@@ -1,12 +1,6 @@
-
-/* crypto/ec/ec.h */
 /*
  * Originally written by Bodo Moeller for the OpenSSL project.
  */
-/**
- * \file crypto/ec/ec.h Include file for the OpenSSL EC functions
- * \author Originally written by Bodo Moeller for the OpenSSL project
- */
 /* ====================================================================
  * Copyright (c) 1998-2005 The OpenSSL Project.  All rights reserved.
  *
@@ -79,22 +73,14 @@
 
 # include &lt;openssl/opensslconf.h&gt;
 
-# ifdef OPENSSL_NO_EC
-#  error EC is disabled.
-# endif
-
+# ifndef OPENSSL_NO_EC
 # include &lt;openssl/asn1.h&gt;
 # include &lt;openssl/symhacks.h&gt;
 # if OPENSSL_API_COMPAT &lt; 0x10100000L
 #  include &lt;openssl/bn.h&gt;
 # endif
-
 # ifdef  __cplusplus
 extern &quot;C&quot; {
-# elif defined(__SUNPRO_C)
-#  if __SUNPRO_C &gt;= 0x520
-#   pragma error_messages (off,E_ARRAY_OF_INCOMPLETE_NONAME,E_ARRAY_OF_INCOMPLETE)
-#  endif
 # endif
 
 # ifndef OPENSSL_ECC_MAX_FIELD_BITS
@@ -1650,7 +1636,9 @@ void ERR_load_EC_strings(void);
 # define EC_R_WRONG_CURVE_PARAMETERS                      145
 # define EC_R_WRONG_ORDER                                 130
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
+
 #endif
diff --git a/include/openssl/engine.h b/include/openssl/engine.h
index d1cd17a..c12e027 100644
--- a/include/openssl/engine.h
+++ b/include/openssl/engine.h
@@ -66,37 +66,23 @@
 
 # include &lt;openssl/opensslconf.h&gt;
 
-# ifdef OPENSSL_NO_ENGINE
-#  error ENGINE is disabled.
-# endif
-
+# ifndef OPENSSL_NO_ENGINE
 # if OPENSSL_API_COMPAT &lt; 0x10100000L
 #  include &lt;openssl/bn.h&gt;
-#  ifndef OPENSSL_NO_RSA
-#   include &lt;openssl/rsa.h&gt;
-#  endif
-#  ifndef OPENSSL_NO_DSA
-#   include &lt;openssl/dsa.h&gt;
-#  endif
-#  ifndef OPENSSL_NO_DH
-#   include &lt;openssl/dh.h&gt;
-#  endif
-#  ifndef OPENSSL_NO_EC
-#   include &lt;openssl/ec.h&gt;
-#  endif
+#  include &lt;openssl/rsa.h&gt;
+#  include &lt;openssl/dsa.h&gt;
+#  include &lt;openssl/dh.h&gt;
+#  include &lt;openssl/ec.h&gt;
 #  include &lt;openssl/rand.h&gt;
 #  include &lt;openssl/ui.h&gt;
 #  include &lt;openssl/err.h&gt;
 # endif
-
 # include &lt;openssl/ossl_typ.h&gt;
 # include &lt;openssl/symhacks.h&gt;
-
 # include &lt;openssl/x509.h&gt;
-
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 extern &quot;C&quot; {
-#endif
+# endif
 
 /*
  * These flags are used to control combinations of algorithm (methods) by
@@ -905,7 +891,9 @@ void ERR_load_ENGINE_strings(void);
 # define ENGINE_R_UNIMPLEMENTED_PUBLIC_KEY_METHOD         101
 # define ENGINE_R_VERSION_INCOMPATIBILITY                 145
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
+
 #endif
diff --git a/include/openssl/idea.h b/include/openssl/idea.h
index 29b5094..165ee40 100644
--- a/include/openssl/idea.h
+++ b/include/openssl/idea.h
@@ -60,8 +60,9 @@
 
 # include &lt;openssl/opensslconf.h&gt;
 
-# ifdef OPENSSL_NO_IDEA
-#  error IDEA is disabled.
+# ifndef OPENSSL_NO_IDEA
+# ifdef  __cplusplus
+extern &quot;C&quot; {
 # endif
 
 typedef unsigned int IDEA_INT;
@@ -72,10 +73,6 @@ typedef unsigned int IDEA_INT;
 # define IDEA_BLOCK      8
 # define IDEA_KEY_LENGTH 16
 
-#ifdef  __cplusplus
-extern &quot;C&quot; {
-#endif
-
 typedef struct idea_key_st {
     IDEA_INT data[9][6];
 } IDEA_KEY_SCHEDULE;
@@ -95,8 +92,9 @@ void idea_ofb64_encrypt(const unsigned char *in, unsigned char *out,
                         long length, IDEA_KEY_SCHEDULE *ks, unsigned char *iv,
                         int *num);
 void idea_encrypt(unsigned long *in, IDEA_KEY_SCHEDULE *ks);
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
 #endif
diff --git a/include/openssl/lhash.h b/include/openssl/lhash.h
index 899544c..2edd738 100644
--- a/include/openssl/lhash.h
+++ b/include/openssl/lhash.h
@@ -63,10 +63,6 @@
 # define HEADER_LHASH_H
 
 # include &lt;openssl/e_os2.h&gt;
-# ifndef OPENSSL_NO_STDIO
-#  include &lt;stdio.h&gt;
-# endif
-
 # include &lt;openssl/bio.h&gt;
 
 #ifdef  __cplusplus
diff --git a/include/openssl/md2.h b/include/openssl/md2.h
index 1dba7cf..d77a4fa 100644
--- a/include/openssl/md2.h
+++ b/include/openssl/md2.h
@@ -59,20 +59,18 @@
 # define HEADER_MD2_H
 
 # include &lt;openssl/opensslconf.h&gt;
-# ifdef OPENSSL_NO_MD2
-#  error MD2 is disabled.
-# endif
+
+# ifndef OPENSSL_NO_MD2
 # include &lt;stddef.h&gt;
+# ifdef  __cplusplus
+extern &quot;C&quot; {
+# endif
 
 typedef unsigned char MD2_INT;
 
 # define MD2_DIGEST_LENGTH       16
 # define MD2_BLOCK               16
 
-#ifdef  __cplusplus
-extern &quot;C&quot; {
-#endif
-
 typedef struct MD2state_st {
     unsigned int num;
     unsigned char data[MD2_BLOCK];
@@ -85,8 +83,10 @@ int MD2_Init(MD2_CTX *c);
 int MD2_Update(MD2_CTX *c, const unsigned char *data, size_t len);
 int MD2_Final(unsigned char *md, MD2_CTX *c);
 unsigned char *MD2(const unsigned char *d, size_t n, unsigned char *md);
-#ifdef  __cplusplus
+
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
 #endif
diff --git a/include/openssl/md4.h b/include/openssl/md4.h
index c937625..b40a839 100644
--- a/include/openssl/md4.h
+++ b/include/openssl/md4.h
@@ -58,15 +58,13 @@
 #ifndef HEADER_MD4_H
 # define HEADER_MD4_H
 
+# include &lt;openssl/opensslconf.h&gt;
+
+# ifndef OPENSSL_NO_MD4
 # include &lt;openssl/e_os2.h&gt;
 # include &lt;stddef.h&gt;
-
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 extern &quot;C&quot; {
-#endif
-
-# ifdef OPENSSL_NO_MD4
-#  error MD4 is disabled.
 # endif
 
 /*-
@@ -92,8 +90,10 @@ int MD4_Update(MD4_CTX *c, const void *data, size_t len);
 int MD4_Final(unsigned char *md, MD4_CTX *c);
 unsigned char *MD4(const unsigned char *d, size_t n, unsigned char *md);
 void MD4_Transform(MD4_CTX *c, const unsigned char *b);
-#ifdef  __cplusplus
+
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
 #endif
diff --git a/include/openssl/md5.h b/include/openssl/md5.h
index 02ea76a..5b34b46 100644
--- a/include/openssl/md5.h
+++ b/include/openssl/md5.h
@@ -58,15 +58,13 @@
 #ifndef HEADER_MD5_H
 # define HEADER_MD5_H
 
+# include &lt;openssl/opensslconf.h&gt;
+
+# ifndef OPENSSL_NO_MD5
 # include &lt;openssl/e_os2.h&gt;
 # include &lt;stddef.h&gt;
-
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 extern &quot;C&quot; {
-#endif
-
-# ifdef OPENSSL_NO_MD5
-#  error MD5 is disabled.
 # endif
 
 /*
@@ -92,8 +90,9 @@ int MD5_Update(MD5_CTX *c, const void *data, size_t len);
 int MD5_Final(unsigned char *md, MD5_CTX *c);
 unsigned char *MD5(const unsigned char *d, size_t n, unsigned char *md);
 void MD5_Transform(MD5_CTX *c, const unsigned char *b);
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
 #endif
diff --git a/include/openssl/mdc2.h b/include/openssl/mdc2.h
index fc9784f..229b122 100644
--- a/include/openssl/mdc2.h
+++ b/include/openssl/mdc2.h
@@ -58,14 +58,12 @@
 #ifndef HEADER_MDC2_H
 # define HEADER_MDC2_H
 
-# include &lt;openssl/des.h&gt;
+# include &lt;openssl/opensslconf.h&gt;
 
-#ifdef  __cplusplus
+#ifndef OPENSSL_NO_MDC2
+# include &lt;openssl/des.h&gt;
+# ifdef  __cplusplus
 extern &quot;C&quot; {
-#endif
-
-# ifdef OPENSSL_NO_MDC2
-#  error MDC2 is disabled.
 # endif
 
 # define MDC2_BLOCK              8
@@ -83,8 +81,9 @@ int MDC2_Update(MDC2_CTX *c, const unsigned char *data, size_t len);
 int MDC2_Final(unsigned char *md, MDC2_CTX *c);
 unsigned char *MDC2(const unsigned char *d, size_t n, unsigned char *md);
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
 #endif
diff --git a/include/openssl/rc2.h b/include/openssl/rc2.h
index 0bf6ae3..50be22d 100644
--- a/include/openssl/rc2.h
+++ b/include/openssl/rc2.h
@@ -59,8 +59,10 @@
 # define HEADER_RC2_H
 
 # include &lt;openssl/opensslconf.h&gt;
-# ifdef OPENSSL_NO_RC2
-#  error RC2 is disabled.
+
+# ifndef OPENSSL_NO_RC2
+# ifdef  __cplusplus
+extern &quot;C&quot; {
 # endif
 
 typedef unsigned int RC2_INT;
@@ -71,10 +73,6 @@ typedef unsigned int RC2_INT;
 # define RC2_BLOCK       8
 # define RC2_KEY_LENGTH  16
 
-#ifdef  __cplusplus
-extern &quot;C&quot; {
-#endif
-
 typedef struct rc2_key_st {
     RC2_INT data[64];
 } RC2_KEY;
@@ -93,8 +91,9 @@ void RC2_ofb64_encrypt(const unsigned char *in, unsigned char *out,
                        long length, RC2_KEY *schedule, unsigned char *ivec,
                        int *num);
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
 #endif
diff --git a/include/openssl/rc4.h b/include/openssl/rc4.h
index c938fdb..a5fdbfb 100644
--- a/include/openssl/rc4.h
+++ b/include/openssl/rc4.h
@@ -58,13 +58,10 @@
 #ifndef HEADER_RC4_H
 # define HEADER_RC4_H
 
-# include &lt;openssl/opensslconf.h&gt;/* OPENSSL_NO_RC4, RC4_INT */
-# ifdef OPENSSL_NO_RC4
-#  error RC4 is disabled.
-# endif
+# include &lt;openssl/opensslconf.h&gt;
 
+# ifndef OPENSSL_NO_RC4
 # include &lt;stddef.h&gt;
-
 #ifdef  __cplusplus
 extern &quot;C&quot; {
 #endif
@@ -79,8 +76,9 @@ void RC4_set_key(RC4_KEY *key, int len, const unsigned char *data);
 void RC4(RC4_KEY *key, size_t len, const unsigned char *indata,
          unsigned char *outdata);
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
 #endif
diff --git a/include/openssl/rc5.h b/include/openssl/rc5.h
index 026a114..c1ff358 100644
--- a/include/openssl/rc5.h
+++ b/include/openssl/rc5.h
@@ -58,14 +58,11 @@
 #ifndef HEADER_RC5_H
 # define HEADER_RC5_H
 
-# include &lt;openssl/opensslconf.h&gt;/* OPENSSL_NO_RC5 */
+# include &lt;openssl/opensslconf.h&gt;
 
-#ifdef  __cplusplus
+# ifndef OPENSSL_NO_RC5
+# ifdef  __cplusplus
 extern &quot;C&quot; {
-#endif
-
-# ifdef OPENSSL_NO_RC5
-#  error RC5 is disabled.
 # endif
 
 # define RC5_ENCRYPT     1
@@ -106,8 +103,9 @@ void RC5_32_ofb64_encrypt(const unsigned char *in, unsigned char *out,
                           long length, RC5_32_KEY *schedule,
                           unsigned char *ivec, int *num);
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
 #endif
diff --git a/include/openssl/ripemd.h b/include/openssl/ripemd.h
index 8a098f6..97e5df7 100644
--- a/include/openssl/ripemd.h
+++ b/include/openssl/ripemd.h
@@ -58,15 +58,13 @@
 #ifndef HEADER_RIPEMD_H
 # define HEADER_RIPEMD_H
 
+# include &lt;openssl/opensslconf.h&gt;
+
+#ifndef OPENSSL_NO_RMD160
 # include &lt;openssl/e_os2.h&gt;
 # include &lt;stddef.h&gt;
-
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 extern &quot;C&quot; {
-#endif
-
-# ifdef OPENSSL_NO_RMD160
-#  error RMD160 is disabled.
 # endif
 
 # define RIPEMD160_LONG unsigned int
@@ -87,8 +85,11 @@ int RIPEMD160_Update(RIPEMD160_CTX *c, const void *data, size_t len);
 int RIPEMD160_Final(unsigned char *md, RIPEMD160_CTX *c);
 unsigned char *RIPEMD160(const unsigned char *d, size_t n, unsigned char *md);
 void RIPEMD160_Transform(RIPEMD160_CTX *c, const unsigned char *b);
-#ifdef  __cplusplus
+
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
+
 
 #endif
diff --git a/include/openssl/rsa.h b/include/openssl/rsa.h
index adad0f1..e7ae827 100644
--- a/include/openssl/rsa.h
+++ b/include/openssl/rsa.h
@@ -59,26 +59,18 @@
 # define HEADER_RSA_H
 
 # include &lt;openssl/opensslconf.h&gt;
-# include &lt;openssl/asn1.h&gt;
 
+# ifndef OPENSSL_NO_RSA
+# include &lt;openssl/asn1.h&gt;
 # include &lt;openssl/bio.h&gt;
 # include &lt;openssl/crypto.h&gt;
 # include &lt;openssl/ossl_typ.h&gt;
 # if OPENSSL_API_COMPAT &lt; 0x10100000L
 #  include &lt;openssl/bn.h&gt;
 # endif
-
-# ifdef OPENSSL_NO_RSA
-#  error RSA is disabled.
-# endif
-
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 extern &quot;C&quot; {
-#endif
-
-/* Declared already in ossl_typ.h */
-/* typedef struct rsa_st RSA; */
-/* typedef struct rsa_meth_st RSA_METHOD; */
+# endif
 
 struct rsa_meth_st {
     const char *name;
@@ -638,7 +630,9 @@ void ERR_load_RSA_strings(void);
 # define RSA_R_VALUE_MISSING                              147
 # define RSA_R_WRONG_SIGNATURE_LENGTH                     119
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
+
 #endif
diff --git a/include/openssl/seed.h b/include/openssl/seed.h
index 918f70c..e643e76 100644
--- a/include/openssl/seed.h
+++ b/include/openssl/seed.h
@@ -81,12 +81,14 @@
 # define HEADER_SEED_H
 
 # include &lt;openssl/opensslconf.h&gt;
+
+# ifndef OPENSSL_NO_SEED
 # include &lt;openssl/e_os2.h&gt;
 # include &lt;openssl/crypto.h&gt;
 
-# ifdef OPENSSL_NO_SEED
-#  error SEED is disabled.
-# endif
+#ifdef  __cplusplus
+extern &quot;C&quot; {
+#endif
 
 /* look whether we need 'long' to get 32 bits */
 # ifdef AES_LONG
@@ -102,11 +104,6 @@
 # define SEED_BLOCK_SIZE 16
 # define SEED_KEY_LENGTH 16
 
-
-#ifdef  __cplusplus
-extern &quot;C&quot; {
-#endif
-
 typedef struct seed_key_st {
 # ifdef SEED_LONG
     unsigned long data[32];
@@ -138,8 +135,9 @@ void SEED_ofb128_encrypt(const unsigned char *in, unsigned char *out,
                          size_t len, const SEED_KEY_SCHEDULE *ks,
                          unsigned char ivec[SEED_BLOCK_SIZE], int *num);
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
-#endif                          /* HEADER_SEED_H */
+#endif
diff --git a/include/openssl/srp.h b/include/openssl/srp.h
index 4111d51..37e7678 100644
--- a/include/openssl/srp.h
+++ b/include/openssl/srp.h
@@ -56,26 +56,22 @@
  * Hudson (<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at cryptsoft.com</A>).
  *
  */
-#ifndef __SRP_H__
-# define __SRP_H__
+#ifndef HEADER_SRP_H
+# define HEADER_SRP_H
 
 #include &lt;openssl/opensslconf.h&gt;
 
-# ifdef OPENSSL_NO_SRP
-#  error SRP is disabled.
-# endif
-
+#ifndef OPENSSL_NO_SRP
 # include &lt;stdio.h&gt;
 # include &lt;string.h&gt;
-
-#ifdef  __cplusplus
-extern &quot;C&quot; {
-#endif
-
 # include &lt;openssl/safestack.h&gt;
 # include &lt;openssl/bn.h&gt;
 # include &lt;openssl/crypto.h&gt;
 
+# ifdef  __cplusplus
+extern &quot;C&quot; {
+# endif
+
 typedef struct SRP_gN_cache_st {
     char *b64_bn;
     BIGNUM *bn;
@@ -175,8 +171,9 @@ int SRP_Verify_B_mod_N(BIGNUM *B, BIGNUM *N);
 
 # define SRP_MINIMAL_N 1024
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
+# endif
+# endif
 
 #endif
diff --git a/include/openssl/ssl.h b/include/openssl/ssl.h
index 92e0274..3d440b6 100644
--- a/include/openssl/ssl.h
+++ b/include/openssl/ssl.h
@@ -144,10 +144,7 @@
 
 # include &lt;openssl/e_os2.h&gt;
 # include &lt;openssl/opensslconf.h&gt;
-
-#ifndef OPENSSL_NO_COMP
 # include &lt;openssl/comp.h&gt;
-#endif
 # include &lt;openssl/bio.h&gt;
 # if OPENSSL_API_COMPAT &lt; 0x10100000L
 #  include &lt;openssl/x509.h&gt;
@@ -161,9 +158,7 @@
 
 # include &lt;openssl/safestack.h&gt;
 # include &lt;openssl/symhacks.h&gt;
-# ifndef OPENSSL_NO_CT
-#  include &lt;openssl/ct.h&gt;
-# endif
+# include &lt;openssl/ct.h&gt;
 
 #ifdef  __cplusplus
 extern &quot;C&quot; {
diff --git a/include/openssl/ssl3.h b/include/openssl/ssl3.h
index ecbe247..6ff00bc 100644
--- a/include/openssl/ssl3.h
+++ b/include/openssl/ssl3.h
@@ -116,9 +116,7 @@
 #ifndef HEADER_SSL3_H
 # define HEADER_SSL3_H
 
-# ifndef OPENSSL_NO_COMP
-#  include &lt;openssl/comp.h&gt;
-# endif
+# include &lt;openssl/comp.h&gt;
 # include &lt;openssl/buffer.h&gt;
 # include &lt;openssl/evp.h&gt;
 # include &lt;openssl/ssl.h&gt;
diff --git a/include/openssl/ts.h b/include/openssl/ts.h
index ca3969f..2e1514e 100644
--- a/include/openssl/ts.h
+++ b/include/openssl/ts.h
@@ -60,6 +60,7 @@
 # define HEADER_TS_H
 
 # include &lt;openssl/opensslconf.h&gt;
+
 # ifndef OPENSSL_NO_TS
 # include &lt;openssl/symhacks.h&gt;
 # include &lt;openssl/buffer.h&gt;
@@ -68,22 +69,12 @@
 # include &lt;openssl/stack.h&gt;
 # include &lt;openssl/asn1.h&gt;
 # include &lt;openssl/safestack.h&gt;
-
-# ifndef OPENSSL_NO_RSA
-#  include &lt;openssl/rsa.h&gt;
-# endif
-
-# ifndef OPENSSL_NO_DSA
-#  include &lt;openssl/dsa.h&gt;
-# endif
-
-# ifndef OPENSSL_NO_DH
-#  include &lt;openssl/dh.h&gt;
-# endif
-
-#ifdef  __cplusplus
+# include &lt;openssl/rsa.h&gt;
+# include &lt;openssl/dsa.h&gt;
+# include &lt;openssl/dh.h&gt;
+# ifdef  __cplusplus
 extern &quot;C&quot; {
-#endif
+# endif
 
 # ifdef WIN32
 /* Under Win32 this is defined in wincrypt.h */
@@ -697,8 +688,9 @@ void ERR_load_TS_strings(void);
 # define TS_R_VAR_LOOKUP_FAILURE                          136
 # define TS_R_WRONG_CONTENT_TYPE                          114
 
-#ifdef  __cplusplus
+# ifdef  __cplusplus
 }
-#endif
-#endif
+# endif
+# endif
+
 #endif
diff --git a/include/openssl/whrlpool.h b/include/openssl/whrlpool.h
index 31fc2ff..bc46035 100644
--- a/include/openssl/whrlpool.h
+++ b/include/openssl/whrlpool.h
@@ -1,12 +1,14 @@
 #ifndef HEADER_WHRLPOOL_H
 # define HEADER_WHRLPOOL_H
 
+#include &lt;openssl/opensslconf.h&gt;
+
+# ifndef OPENSSL_NO_WHIRLPOOL
 # include &lt;openssl/e_os2.h&gt;
 # include &lt;stddef.h&gt;
-
-#ifdef __cplusplus
+# ifdef __cplusplus
 extern &quot;C&quot; {
-#endif
+# endif
 
 # define WHIRLPOOL_DIGEST_LENGTH (512/8)
 # define WHIRLPOOL_BBLOCK        512
@@ -23,16 +25,15 @@ typedef struct {
     size_t bitlen[WHIRLPOOL_COUNTER / sizeof(size_t)];
 } WHIRLPOOL_CTX;
 
-# ifndef OPENSSL_NO_WHIRLPOOL
 int WHIRLPOOL_Init(WHIRLPOOL_CTX *c);
 int WHIRLPOOL_Update(WHIRLPOOL_CTX *c, const void *inp, size_t bytes);
 void WHIRLPOOL_BitUpdate(WHIRLPOOL_CTX *c, const void *inp, size_t bits);
 int WHIRLPOOL_Final(unsigned char *md, WHIRLPOOL_CTX *c);
 unsigned char *WHIRLPOOL(const void *inp, size_t bytes, unsigned char *md);
-# endif
 
-#ifdef __cplusplus
+# ifdef __cplusplus
 }
-#endif
+# endif
+# endif
 
 #endif
diff --git a/include/openssl/x509.h b/include/openssl/x509.h
index 5c138ca..d21460a 100644
--- a/include/openssl/x509.h
+++ b/include/openssl/x509.h
@@ -72,21 +72,12 @@
 # include &lt;openssl/stack.h&gt;
 # include &lt;openssl/asn1.h&gt;
 # include &lt;openssl/safestack.h&gt;
-
-# ifndef OPENSSL_NO_EC
-#  include &lt;openssl/ec.h&gt;
-# endif
+# include &lt;openssl/ec.h&gt;
 
 # if OPENSSL_API_COMPAT &lt; 0x10100000L
-#  ifndef OPENSSL_NO_RSA
-#   include &lt;openssl/rsa.h&gt;
-#  endif
-#  ifndef OPENSSL_NO_DSA
-#   include &lt;openssl/dsa.h&gt;
-#  endif
-#  ifndef OPENSSL_NO_DH
-#   include &lt;openssl/dh.h&gt;
-#  endif
+#  include &lt;openssl/rsa.h&gt;
+#  include &lt;openssl/dsa.h&gt;
+#  include &lt;openssl/dh.h&gt;
 # endif
 
 # include &lt;openssl/sha.h&gt;
diff --git a/ssl/s3_lib.c b/ssl/s3_lib.c
index 49180cd..e6cf309 100644
--- a/ssl/s3_lib.c
+++ b/ssl/s3_lib.c
@@ -151,9 +151,7 @@
 #include &lt;openssl/objects.h&gt;
 #include &quot;ssl_locl.h&quot;
 #include &lt;openssl/md5.h&gt;
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-#endif
+#include &lt;openssl/dh.h&gt;
 #include &lt;openssl/rand.h&gt;
 
 #define SSL3_NUM_CIPHERS        OSSL_NELEM(ssl3_ciphers)
diff --git a/ssl/ssl_cert.c b/ssl/ssl_cert.c
index e17cffc..4081ebe 100644
--- a/ssl/ssl_cert.c
+++ b/ssl/ssl_cert.c
@@ -125,9 +125,7 @@
 #include &lt;openssl/bio.h&gt;
 #include &lt;openssl/pem.h&gt;
 #include &lt;openssl/x509v3.h&gt;
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-#endif
+#include &lt;openssl/dh.h&gt;
 #include &lt;openssl/bn.h&gt;
 #include &quot;internal/threads.h&quot;
 #include &quot;ssl_locl.h&quot;
diff --git a/ssl/ssl_ciph.c b/ssl/ssl_ciph.c
index c62b193..938baac 100644
--- a/ssl/ssl_ciph.c
+++ b/ssl/ssl_ciph.c
@@ -141,12 +141,8 @@
 
 #include &lt;stdio.h&gt;
 #include &lt;openssl/objects.h&gt;
-#ifndef OPENSSL_NO_COMP
-# include &lt;openssl/comp.h&gt;
-#endif
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/comp.h&gt;
+#include &lt;openssl/engine.h&gt;
 #include &quot;internal/threads.h&quot;
 #include &quot;ssl_locl.h&quot;
 
diff --git a/ssl/ssl_conf.c b/ssl/ssl_conf.c
index 157bf8b..77fc437 100644
--- a/ssl/ssl_conf.c
+++ b/ssl/ssl_conf.c
@@ -59,9 +59,7 @@
 #include &quot;ssl_locl.h&quot;
 #include &lt;openssl/conf.h&gt;
 #include &lt;openssl/objects.h&gt;
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-#endif
+#include &lt;openssl/dh.h&gt;
 
 /*
  * structure holding name tables. This is used for pemitted elements in lists
diff --git a/ssl/ssl_lib.c b/ssl/ssl_lib.c
index 87e3dfa..3385bc1 100644
--- a/ssl/ssl_lib.c
+++ b/ssl/ssl_lib.c
@@ -152,16 +152,10 @@
 #include &lt;openssl/x509v3.h&gt;
 #include &lt;openssl/rand.h&gt;
 #include &lt;openssl/ocsp.h&gt;
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-#endif
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/dh.h&gt;
+#include &lt;openssl/engine.h&gt;
 #include &lt;openssl/async.h&gt;
-#ifndef OPENSSL_NO_CT
-# include &lt;openssl/ct.h&gt;
-#endif
+#include &lt;openssl/ct.h&gt;
 
 const char SSL_version_str[] = OPENSSL_VERSION_TEXT;
 
diff --git a/ssl/ssl_locl.h b/ssl/ssl_locl.h
index fa0254c..4abe7b4 100644
--- a/ssl/ssl_locl.h
+++ b/ssl/ssl_locl.h
@@ -149,24 +149,16 @@
 # include &quot;e_os.h&quot;
 
 # include &lt;openssl/buffer.h&gt;
-# ifndef OPENSSL_NO_COMP
-#  include &lt;openssl/comp.h&gt;
-# endif
+# include &lt;openssl/comp.h&gt;
 # include &lt;openssl/bio.h&gt;
 # include &lt;openssl/stack.h&gt;
-# ifndef OPENSSL_NO_RSA
-#  include &lt;openssl/rsa.h&gt;
-# endif
-# ifndef OPENSSL_NO_DSA
-#  include &lt;openssl/dsa.h&gt;
-# endif
+# include &lt;openssl/rsa.h&gt;
+# include &lt;openssl/dsa.h&gt;
 # include &lt;openssl/err.h&gt;
 # include &lt;openssl/ssl.h&gt;
 # include &lt;openssl/async.h&gt;
 # include &lt;openssl/symhacks.h&gt;
-# ifndef OPENSSL_NO_CT
-#  include &lt;openssl/ct.h&gt;
-# endif
+# include &lt;openssl/ct.h&gt;
 #include &quot;record/record.h&quot;
 #include &quot;statem/statem.h&quot;
 #include &quot;packet_locl.h&quot;
diff --git a/ssl/ssl_sess.c b/ssl/ssl_sess.c
index ebeeba0..3f030a7 100644
--- a/ssl/ssl_sess.c
+++ b/ssl/ssl_sess.c
@@ -137,9 +137,7 @@
 #include &lt;stdio.h&gt;
 #include &lt;openssl/lhash.h&gt;
 #include &lt;openssl/rand.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 #include &quot;ssl_locl.h&quot;
 
 static void SSL_SESSION_list_remove(SSL_CTX *ctx, SSL_SESSION *s);
diff --git a/ssl/statem/statem_clnt.c b/ssl/statem/statem_clnt.c
index 26c4d10..bafb90a 100644
--- a/ssl/statem/statem_clnt.c
+++ b/ssl/statem/statem_clnt.c
@@ -155,13 +155,9 @@
 #include &lt;openssl/objects.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/md5.h&gt;
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-#endif
+#include &lt;openssl/dh.h&gt;
 #include &lt;openssl/bn.h&gt;
-#ifndef OPENSSL_NO_ENGINE
-# include &lt;openssl/engine.h&gt;
-#endif
+#include &lt;openssl/engine.h&gt;
 
 static ossl_inline int cert_req_allowed(SSL *s);
 static int key_exchange_expected(SSL *s);
diff --git a/ssl/statem/statem_srvr.c b/ssl/statem/statem_srvr.c
index 526b0c5..2f2f457 100644
--- a/ssl/statem/statem_srvr.c
+++ b/ssl/statem/statem_srvr.c
@@ -158,9 +158,7 @@
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/hmac.h&gt;
 #include &lt;openssl/x509.h&gt;
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-#endif
+#include &lt;openssl/dh.h&gt;
 #include &lt;openssl/bn.h&gt;
 #include &lt;openssl/md5.h&gt;
 
diff --git a/ssl/t1_enc.c b/ssl/t1_enc.c
index f2650b0..6e56441 100644
--- a/ssl/t1_enc.c
+++ b/ssl/t1_enc.c
@@ -136,9 +136,7 @@
 
 #include &lt;stdio.h&gt;
 #include &quot;ssl_locl.h&quot;
-#ifndef OPENSSL_NO_COMP
-# include &lt;openssl/comp.h&gt;
-#endif
+#include &lt;openssl/comp.h&gt;
 #include &lt;openssl/evp.h&gt;
 #include &lt;openssl/kdf.h&gt;
 #include &lt;openssl/rand.h&gt;
diff --git a/ssl/t1_ext.c b/ssl/t1_ext.c
index eb7d8a7..7940cfc 100644
--- a/ssl/t1_ext.c
+++ b/ssl/t1_ext.c
@@ -54,9 +54,7 @@
 
 /* Custom extension utility functions */
 
-#ifndef OPENSSL_NO_CT
-# include &lt;openssl/ct.h&gt;
-#endif
+#include &lt;openssl/ct.h&gt;
 #include &quot;ssl_locl.h&quot;
 
 
diff --git a/ssl/t1_lib.c b/ssl/t1_lib.c
index fc7ebe4..26c02a0 100644
--- a/ssl/t1_lib.c
+++ b/ssl/t1_lib.c
@@ -115,14 +115,10 @@
 #include &lt;openssl/hmac.h&gt;
 #include &lt;openssl/ocsp.h&gt;
 #include &lt;openssl/rand.h&gt;
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-# include &lt;openssl/bn.h&gt;
-#endif
+#include &lt;openssl/dh.h&gt;
+#include &lt;openssl/bn.h&gt;
 #include &quot;ssl_locl.h&quot;
-#ifndef OPENSSL_NO_CT
-# include &lt;openssl/ct.h&gt;
-#endif
+#include &lt;openssl/ct.h&gt;
 
 static int tls_decrypt_ticket(SSL *s, const unsigned char *tick, int ticklen,
                               const unsigned char *sess_id, int sesslen,
diff --git a/util/libcrypto.num b/util/libcrypto.num
index fff2f84..2e2e657 100644
--- a/util/libcrypto.num
+++ b/util/libcrypto.num
@@ -30,7 +30,7 @@ X509V3_add_value_bool                   28	1_1_0	EXIST::FUNCTION:
 GENERAL_NAME_get0_otherName             29	1_1_0	EXIST::FUNCTION:
 ASN1_INTEGER_get_uint64                 30	1_1_0	EXIST::FUNCTION:
 EVP_DigestInit_ex                       31	1_1_0	EXIST::FUNCTION:
-CTLOG_new                               32	1_1_0	EXIST::FUNCTION:
+CTLOG_new                               32	1_1_0	EXIST::FUNCTION:CT
 UI_get_result_minsize                   33	1_1_0	EXIST::FUNCTION:
 EVP_PBE_alg_add_type                    34	1_1_0	EXIST::FUNCTION:
 EVP_cast5_ofb                           35	1_1_0	EXIST::FUNCTION:CAST
@@ -97,7 +97,7 @@ IPAddressRange_free                     94	1_1_0	EXIST::FUNCTION:RFC3779
 CMS_ContentInfo_free                    95	1_1_0	EXIST::FUNCTION:CMS
 BIO_accept                              96	1_1_0	EXIST::FUNCTION:DEPRECATEDIN_1_1_0
 X509_VERIFY_PARAM_set1_policies         97	1_1_0	EXIST::FUNCTION:
-SCT_set0_extensions                     98	1_1_0	EXIST::FUNCTION:
+SCT_set0_extensions                     98	1_1_0	EXIST::FUNCTION:CT
 PKCS5_pbe2_set_scrypt                   99	1_1_0	EXIST::FUNCTION:SCRYPT
 X509_find_by_subject                    100	1_1_0	EXIST::FUNCTION:
 DSAparams_print                         101	1_1_0	EXIST::FUNCTION:DSA
@@ -164,7 +164,7 @@ v3_addr_canonize                        161	1_1_0	EXIST::FUNCTION:RFC3779
 ASN1_item_ex_i2d                        162	1_1_0	EXIST::FUNCTION:
 ENGINE_set_digests                      163	1_1_0	EXIST::FUNCTION:ENGINE
 PEM_ASN1_read_bio                       164	1_1_0	EXIST::FUNCTION:
-CT_POLICY_EVAL_CTX_free                 165	1_1_0	EXIST::FUNCTION:
+CT_POLICY_EVAL_CTX_free                 165	1_1_0	EXIST::FUNCTION:CT
 CMS_RecipientInfo_kari_get0_ctx         166	1_1_0	EXIST::FUNCTION:CMS
 PKCS7_set_attributes                    167	1_1_0	EXIST::FUNCTION:
 d2i_POLICYQUALINFO                      168	1_1_0	EXIST::FUNCTION:
@@ -184,7 +184,7 @@ i2d_DISPLAYTEXT                         181	1_1_0	EXIST::FUNCTION:
 OCSP_response_status                    182	1_1_0	EXIST::FUNCTION:
 i2d_ASN1_PRINTABLESTRING                183	1_1_0	EXIST::FUNCTION:
 X509_VERIFY_PARAM_set_hostflags         184	1_1_0	EXIST::FUNCTION:
-SCT_get0_log_id                         185	1_1_0	EXIST::FUNCTION:
+SCT_get0_log_id                         185	1_1_0	EXIST::FUNCTION:CT
 ASN1_IA5STRING_it                       186	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
 ASN1_IA5STRING_it                       186	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
 PEM_write_bio_ECPrivateKey              187	1_1_0	EXIST::FUNCTION:EC
@@ -206,7 +206,7 @@ EVP_seed_cfb128                         202	1_1_0	EXIST::FUNCTION:SEED
 BASIC_CONSTRAINTS_free                  203	1_1_0	EXIST::FUNCTION:
 EVP_CIPHER_flags                        204	1_1_0	EXIST::FUNCTION:
 PEM_write_bio_ECPKParameters            205	1_1_0	EXIST::FUNCTION:EC
-SCT_set_version                         206	1_1_0	EXIST::FUNCTION:
+SCT_set_version                         206	1_1_0	EXIST::FUNCTION:CT
 CMS_add1_ReceiptRequest                 207	1_1_0	EXIST::FUNCTION:CMS
 d2i_CRL_DIST_POINTS                     208	1_1_0	EXIST::FUNCTION:
 X509_CRL_INFO_free                      209	1_1_0	EXIST::FUNCTION:
@@ -238,7 +238,7 @@ EVP_PKEY_meth_set_decrypt               233	1_1_0	EXIST::FUNCTION:
 EVP_rc2_ecb                             234	1_1_0	EXIST::FUNCTION:RC2
 i2b_PublicKey_bio                       235	1_1_0	EXIST::FUNCTION:
 d2i_ASN1_SET_ANY                        236	1_1_0	EXIST::FUNCTION:
-CT_verify_no_bad_scts                   237	1_1_0	EXIST::FUNCTION:
+CT_verify_no_bad_scts                   237	1_1_0	EXIST::FUNCTION:CT
 ASN1_item_i2d                           238	1_1_0	EXIST::FUNCTION:
 OCSP_copy_nonce                         239	1_1_0	EXIST::FUNCTION:
 OBJ_txt2nid                             240	1_1_0	EXIST::FUNCTION:
@@ -297,7 +297,7 @@ CRYPTO_gcm128_setiv                     291	1_1_0	EXIST::FUNCTION:
 ASN1_PCTX_set_oid_flags                 292	1_1_0	EXIST::FUNCTION:
 d2i_ASN1_INTEGER                        293	1_1_0	EXIST::FUNCTION:
 i2d_PKCS7_ENCRYPT                       294	1_1_0	EXIST::FUNCTION:
-CT_POLICY_EVAL_CTX_set0_issuer          295	1_1_0	EXIST::FUNCTION:
+CT_POLICY_EVAL_CTX_set0_issuer          295	1_1_0	EXIST::FUNCTION:CT
 X509_NAME_ENTRY_set                     296	1_1_0	EXIST::FUNCTION:
 PKCS8_set0_pbe                          297	1_1_0	EXIST::FUNCTION:
 PEM_write_bio_DSA_PUBKEY                298	1_1_0	EXIST::FUNCTION:DSA
@@ -350,7 +350,7 @@ DIST_POINT_it                           344	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:
 DIST_POINT_it                           344	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
 PEM_read_X509_CRL                       345	1_1_0	EXIST::FUNCTION:
 sk_sort                                 346	1_1_0	EXIST::FUNCTION:
-CTLOG_STORE_load_file                   347	1_1_0	EXIST::FUNCTION:
+CTLOG_STORE_load_file                   347	1_1_0	EXIST::FUNCTION:CT
 ASN1_SEQUENCE_it                        348	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
 ASN1_SEQUENCE_it                        348	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
 TS_RESP_CTX_get_tst_info                349	1_1_0	EXIST::FUNCTION:TS
@@ -466,7 +466,7 @@ DH_new_method                           457	1_1_0	EXIST::FUNCTION:DH
 BF_ecb_encrypt                          458	1_1_0	EXIST::FUNCTION:BF
 PEM_write_bio_DHparams                  459	1_1_0	EXIST::FUNCTION:DH
 EVP_DigestFinal                         460	1_1_0	EXIST::FUNCTION:
-CT_POLICY_EVAL_CTX_set0_log_store       461	1_1_0	EXIST::FUNCTION:
+CT_POLICY_EVAL_CTX_set0_log_store       461	1_1_0	EXIST::FUNCTION:CT
 v3_asid_add_id_or_range                 462	1_1_0	EXIST::FUNCTION:RFC3779
 X509_NAME_ENTRY_create_by_NID           463	1_1_0	EXIST::FUNCTION:
 EC_KEY_METHOD_get_init                  464	1_1_0	EXIST::FUNCTION:EC
@@ -478,7 +478,7 @@ DH_new                                  469	1_1_0	EXIST::FUNCTION:DH
 OCSP_RESPID_free                        470	1_1_0	EXIST::FUNCTION:
 PKCS5_pbe2_set                          471	1_1_0	EXIST::FUNCTION:
 CRYPTO_THREADID_get_callback            472	1_1_0	NOEXIST::FUNCTION:
-SCT_set_signature_nid                   473	1_1_0	EXIST::FUNCTION:
+SCT_set_signature_nid                   473	1_1_0	EXIST::FUNCTION:CT
 i2d_RSA_PUBKEY_fp                       474	1_1_0	EXIST::FUNCTION:RSA,STDIO
 PKCS12_BAGS_it                          475	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
 PKCS12_BAGS_it                          475	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
@@ -575,14 +575,14 @@ EC_GROUP_get_pentanomial_basis          562	1_1_0	EXIST::FUNCTION:EC,EC2M
 X509_CINF_free                          563	1_1_0	EXIST::FUNCTION:
 X509_EXTENSION_free                     564	1_1_0	EXIST::FUNCTION:
 EVP_DigestSignInit                      565	1_1_0	EXIST::FUNCTION:
-CT_POLICY_EVAL_CTX_get0_issuer          566	1_1_0	EXIST::FUNCTION:
+CT_POLICY_EVAL_CTX_get0_issuer          566	1_1_0	EXIST::FUNCTION:CT
 TLS_FEATURE_new                         567	1_1_0	EXIST::FUNCTION:
 RSA_get_default_method                  568	1_1_0	EXIST::FUNCTION:RSA
 CRYPTO_cts128_encrypt_block             569	1_1_0	EXIST::FUNCTION:
 ASN1_digest                             570	1_1_0	EXIST::FUNCTION:
 ERR_load_X509V3_strings                 571	1_1_0	EXIST::FUNCTION:
 EVP_PKEY_meth_get_cleanup               572	1_1_0	EXIST::FUNCTION:
-SCT_verify                              573	1_1_0	EXIST::FUNCTION:
+SCT_verify                              573	1_1_0	EXIST::FUNCTION:CT
 d2i_X509                                574	1_1_0	EXIST::FUNCTION:
 a2i_ASN1_STRING                         575	1_1_0	EXIST::FUNCTION:
 EC_GROUP_get_mont_data                  576	1_1_0	EXIST::FUNCTION:EC
@@ -609,7 +609,7 @@ RAND_query_egd_bytes                    596	1_1_0	EXIST::FUNCTION:EGD
 i2d_ASN1_PRINTABLE                      597	1_1_0	EXIST::FUNCTION:
 ENGINE_cmd_is_executable                598	1_1_0	EXIST::FUNCTION:ENGINE
 BIO_puts                                599	1_1_0	EXIST::FUNCTION:
-SCT_verify_v1                           600	1_1_0	EXIST::FUNCTION:
+SCT_verify_v1                           600	1_1_0	EXIST::FUNCTION:CT
 RSAPublicKey_it                         601	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:RSA
 RSAPublicKey_it                         601	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:RSA
 ISSUING_DIST_POINT_new                  602	1_1_0	EXIST::FUNCTION:
@@ -703,7 +703,7 @@ CRYPTO_ocb128_copy_ctx                  684	1_1_0	EXIST::FUNCTION:OCB
 TS_REQ_get_ext_d2i                      685	1_1_0	EXIST::FUNCTION:TS
 AES_ige_encrypt                         686	1_1_0	EXIST::FUNCTION:AES
 d2i_SXNET                               687	1_1_0	EXIST::FUNCTION:
-CTLOG_get0_log_id                       688	1_1_0	EXIST::FUNCTION:
+CTLOG_get0_log_id                       688	1_1_0	EXIST::FUNCTION:CT
 CMS_RecipientInfo_ktri_get0_signer_id   689	1_1_0	EXIST::FUNCTION:CMS
 OCSP_REQUEST_add1_ext_i2d               690	1_1_0	EXIST::FUNCTION:
 EVP_PBE_CipherInit                      691	1_1_0	EXIST::FUNCTION:
@@ -716,7 +716,7 @@ OPENSSL_isservice                       697	1_1_0	EXIST::FUNCTION:
 DH_compute_key                          698	1_1_0	EXIST::FUNCTION:DH
 TS_RESP_CTX_set_signer_key              699	1_1_0	EXIST::FUNCTION:TS
 i2d_DSAPrivateKey_bio                   700	1_1_0	EXIST::FUNCTION:DSA
-CT_verify_at_least_one_good_sct         701	1_1_0	EXIST::FUNCTION:
+CT_verify_at_least_one_good_sct         701	1_1_0	EXIST::FUNCTION:CT
 ASN1_item_d2i                           702	1_1_0	EXIST::FUNCTION:
 BIO_int_ctrl                            703	1_1_0	EXIST::FUNCTION:
 CMS_ReceiptRequest_it                   704	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:CMS
@@ -771,7 +771,7 @@ BN_nist_mod_521                         750	1_1_0	EXIST::FUNCTION:
 CRYPTO_THREAD_get_local                 751	1_1_0	EXIST::FUNCTION:
 PKCS7_to_TS_TST_INFO                    752	1_1_0	EXIST::FUNCTION:TS
 X509_STORE_CTX_new                      753	1_1_0	EXIST::FUNCTION:
-CTLOG_STORE_new                         754	1_1_0	EXIST::FUNCTION:
+CTLOG_STORE_new                         754	1_1_0	EXIST::FUNCTION:CT
 EVP_CIPHER_meth_set_cleanup             755	1_1_0	EXIST::FUNCTION:
 d2i_PKCS12_SAFEBAG                      756	1_1_0	EXIST::FUNCTION:
 EVP_MD_pkey_type                        757	1_1_0	EXIST::FUNCTION:
@@ -941,7 +941,7 @@ UI_set_result                           915	1_1_0	EXIST::FUNCTION:
 EVP_EncodeUpdate                        916	1_1_0	EXIST::FUNCTION:
 PEM_write_bio_X509_CRL                  917	1_1_0	EXIST::FUNCTION:
 BN_cmp                                  918	1_1_0	EXIST::FUNCTION:
-CT_POLICY_EVAL_CTX_get0_log_store       919	1_1_0	EXIST::FUNCTION:
+CT_POLICY_EVAL_CTX_get0_log_store       919	1_1_0	EXIST::FUNCTION:CT
 CONF_set_default_method                 920	1_1_0	EXIST::FUNCTION:
 ASN1_PCTX_get_nm_flags                  921	1_1_0	EXIST::FUNCTION:
 X509_add1_ext_i2d                       922	1_1_0	EXIST::FUNCTION:
@@ -951,7 +951,7 @@ PKCS1_MGF1                              925	1_1_0	EXIST::FUNCTION:RSA
 BIO_vsnprintf                           926	1_1_0	EXIST::FUNCTION:
 X509_STORE_CTX_get0_current_issuer      927	1_1_0	EXIST::FUNCTION:
 CRYPTO_secure_malloc_initialized        928	1_1_0	EXIST::FUNCTION:
-o2i_SCT_LIST                            929	1_1_0	EXIST::FUNCTION:
+o2i_SCT_LIST                            929	1_1_0	EXIST::FUNCTION:CT
 ASN1_PCTX_get_cert_flags                930	1_1_0	EXIST::FUNCTION:
 X509at_add1_attr_by_NID                 931	1_1_0	EXIST::FUNCTION:
 DHparams_dup                            932	1_1_0	EXIST::FUNCTION:DH
@@ -1197,7 +1197,7 @@ CMS_EncryptedData_encrypt               1160	1_1_0	EXIST::FUNCTION:CMS
 ASN1_tag2str                            1161	1_1_0	EXIST::FUNCTION:
 BN_zero_ex                              1162	1_1_0	EXIST::FUNCTION:
 X509_NAME_dup                           1163	1_1_0	EXIST::FUNCTION:
-SCT_LIST_print                          1164	1_1_0	EXIST::FUNCTION:
+SCT_LIST_print                          1164	1_1_0	EXIST::FUNCTION:CT
 NOTICEREF_it                            1165	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
 NOTICEREF_it                            1165	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
 CMS_add0_crl                            1166	1_1_0	EXIST::FUNCTION:CMS
@@ -1317,7 +1317,7 @@ CONF_dump_fp                            1278	1_1_0	EXIST::FUNCTION:STDIO
 d2i_DIST_POINT_NAME                     1279	1_1_0	EXIST::FUNCTION:
 ASN1_INTEGER_set_int64                  1280	1_1_0	EXIST::FUNCTION:
 ASN1_TIME_free                          1281	1_1_0	EXIST::FUNCTION:
-i2o_SCT_LIST                            1282	1_1_0	EXIST::FUNCTION:
+i2o_SCT_LIST                            1282	1_1_0	EXIST::FUNCTION:CT
 AES_encrypt                             1283	1_1_0	EXIST::FUNCTION:AES
 MD5_Init                                1284	1_1_0	EXIST::FUNCTION:MD5
 UI_add_error_string                     1285	1_1_0	EXIST::FUNCTION:
@@ -1368,7 +1368,7 @@ CRYPTO_ocb128_finish                    1326	1_1_0	EXIST::FUNCTION:OCB
 EVP_CIPHER_do_all                       1327	1_1_0	EXIST::FUNCTION:
 POLICY_MAPPINGS_it                      1328	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
 POLICY_MAPPINGS_it                      1328	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-SCT_set0_log_id                         1329	1_1_0	EXIST::FUNCTION:
+SCT_set0_log_id                         1329	1_1_0	EXIST::FUNCTION:CT
 CRYPTO_cfb128_encrypt                   1330	1_1_0	EXIST::FUNCTION:
 RSA_padding_add_PKCS1_type_2            1331	1_1_0	EXIST::FUNCTION:RSA
 TS_CONF_set_signer_cert                 1332	1_1_0	EXIST::FUNCTION:TS
@@ -1419,9 +1419,9 @@ EVP_PKEY_asn1_free                      1375	1_1_0	EXIST::FUNCTION:
 ENGINE_unregister_DH                    1376	1_1_0	EXIST::FUNCTION:ENGINE
 PROXY_CERT_INFO_EXTENSION_it            1377	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
 PROXY_CERT_INFO_EXTENSION_it            1377	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-CT_POLICY_EVAL_CTX_set0_cert            1378	1_1_0	EXIST::FUNCTION:
+CT_POLICY_EVAL_CTX_set0_cert            1378	1_1_0	EXIST::FUNCTION:CT
 X509_NAME_hash                          1379	1_1_0	EXIST::FUNCTION:
-SCT_set_timestamp                       1380	1_1_0	EXIST::FUNCTION:
+SCT_set_timestamp                       1380	1_1_0	EXIST::FUNCTION:CT
 UI_new                                  1381	1_1_0	EXIST::FUNCTION:
 TS_REQ_get_msg_imprint                  1382	1_1_0	EXIST::FUNCTION:TS
 i2d_PKCS12_BAGS                         1383	1_1_0	EXIST::FUNCTION:
@@ -1488,7 +1488,7 @@ HMAC_size                               1441	1_1_0	EXIST::FUNCTION:
 EVP_PKEY_get0_DH                        1442	1_1_0	EXIST::FUNCTION:DH
 d2i_OCSP_CRLID                          1443	1_1_0	EXIST::FUNCTION:
 EVP_CIPHER_CTX_set_padding              1444	1_1_0	EXIST::FUNCTION:
-CTLOG_new_from_base64                   1445	1_1_0	EXIST::FUNCTION:
+CTLOG_new_from_base64                   1445	1_1_0	EXIST::FUNCTION:CT
 AES_bi_ige_encrypt                      1446	1_1_0	EXIST::FUNCTION:AES
 ERR_pop_to_mark                         1447	1_1_0	EXIST::FUNCTION:
 DSO_METHOD_win32                        1448	1_1_0	EXIST::FUNCTION:
@@ -1536,7 +1536,7 @@ SXNET_it                                1488	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:
 BIO_indent                              1489	1_1_0	EXIST::FUNCTION:
 i2d_X509_fp                             1490	1_1_0	EXIST::FUNCTION:STDIO
 d2i_ASN1_TYPE                           1491	1_1_0	EXIST::FUNCTION:
-CTLOG_STORE_free                        1492	1_1_0	EXIST::FUNCTION:
+CTLOG_STORE_free                        1492	1_1_0	EXIST::FUNCTION:CT
 ENGINE_get_pkey_meths                   1493	1_1_0	EXIST::FUNCTION:ENGINE
 i2d_TS_REQ_bio                          1494	1_1_0	EXIST::FUNCTION:TS
 EVP_PKEY_CTX_get_operation              1495	1_1_0	EXIST::FUNCTION:
@@ -1559,7 +1559,7 @@ EVP_PKEY_asn1_find                      1511	1_1_0	EXIST::FUNCTION:
 d2i_ASN1_GENERALIZEDTIME                1512	1_1_0	EXIST::FUNCTION:
 OPENSSL_cleanup                         1513	1_1_0	EXIST::FUNCTION:
 X509_ATTRIBUTE_create                   1514	1_1_0	EXIST::FUNCTION:
-SCT_get_source                          1515	1_1_0	EXIST::FUNCTION:
+SCT_get_source                          1515	1_1_0	EXIST::FUNCTION:CT
 EVP_PKEY_verify_init                    1516	1_1_0	EXIST::FUNCTION:
 ASN1_TIME_set_string                    1517	1_1_0	EXIST::FUNCTION:
 BIO_free                                1518	1_1_0	EXIST::FUNCTION:
@@ -1637,7 +1637,7 @@ PKCS7_add0_attrib_signing_time          1589	1_1_0	EXIST::FUNCTION:
 X509_STORE_set_flags                    1590	1_1_0	EXIST::FUNCTION:
 UI_get0_output_string                   1591	1_1_0	EXIST::FUNCTION:
 ERR_get_error_line_data                 1592	1_1_0	EXIST::FUNCTION:
-CTLOG_get0_name                         1593	1_1_0	EXIST::FUNCTION:
+CTLOG_get0_name                         1593	1_1_0	EXIST::FUNCTION:CT
 ASN1_TBOOLEAN_it                        1594	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
 ASN1_TBOOLEAN_it                        1594	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
 RC2_set_key                             1595	1_1_0	EXIST::FUNCTION:RC2
@@ -1653,7 +1653,7 @@ TS_RESP_CTX_get_request                 1604	1_1_0	EXIST::FUNCTION:TS
 EVP_cast5_cbc                           1605	1_1_0	EXIST::FUNCTION:CAST
 PEM_read_bio_X509_AUX                   1606	1_1_0	EXIST::FUNCTION:
 TS_ext_print_bio                        1607	1_1_0	EXIST::FUNCTION:TS
-SCT_set1_log_id                         1608	1_1_0	EXIST::FUNCTION:
+SCT_set1_log_id                         1608	1_1_0	EXIST::FUNCTION:CT
 X509_get0_pubkey_bitstr                 1609	1_1_0	EXIST::FUNCTION:
 ENGINE_register_all_RAND                1610	1_1_0	EXIST::FUNCTION:ENGINE
 BN_BLINDING_thread_id                   1611	1_1_0	NOEXIST::FUNCTION:
@@ -1854,7 +1854,7 @@ X509_ALGOR_get0                         1798	1_1_0	EXIST::FUNCTION:
 d2i_ACCESS_DESCRIPTION                  1799	1_1_0	EXIST::FUNCTION:
 OCSP_SINGLERESP_get_ext_by_NID          1800	1_1_0	EXIST::FUNCTION:
 a2i_IPADDRESS_NC                        1801	1_1_0	EXIST::FUNCTION:
-CTLOG_STORE_load_default_file           1802	1_1_0	EXIST::FUNCTION:
+CTLOG_STORE_load_default_file           1802	1_1_0	EXIST::FUNCTION:CT
 PKCS12_SAFEBAG_create_pkcs8_encrypt     1803	1_1_0	EXIST::FUNCTION:
 RAND_screen                             1804	1_1_0	EXIST:WIN32:FUNCTION:
 CONF_get_string                         1805	1_1_0	EXIST::FUNCTION:
@@ -1935,7 +1935,7 @@ d2i_AUTHORITY_INFO_ACCESS               1874	1_1_0	EXIST::FUNCTION:
 PEM_read_RSAPrivateKey                  1875	1_1_0	EXIST::FUNCTION:RSA
 BIO_closesocket                         1876	1_1_0	EXIST::FUNCTION:
 RSA_verify_ASN1_OCTET_STRING            1877	1_1_0	EXIST::FUNCTION:RSA
-SCT_set_log_entry_type                  1878	1_1_0	EXIST::FUNCTION:
+SCT_set_log_entry_type                  1878	1_1_0	EXIST::FUNCTION:CT
 BN_new                                  1879	1_1_0	EXIST::FUNCTION:
 X509_OBJECT_retrieve_by_subject         1880	1_1_0	EXIST::FUNCTION:
 MD5_Final                               1881	1_1_0	EXIST::FUNCTION:MD5
@@ -1963,7 +1963,7 @@ AES_cfb1_encrypt                        1902	1_1_0	EXIST::FUNCTION:AES
 X509v3_get_ext                          1903	1_1_0	EXIST::FUNCTION:
 BN_BLINDING_set_thread_id               1904	1_1_0	NOEXIST::FUNCTION:
 CRYPTO_gcm128_encrypt_ctr32             1905	1_1_0	EXIST::FUNCTION:
-SCT_set1_signature                      1906	1_1_0	EXIST::FUNCTION:
+SCT_set1_signature                      1906	1_1_0	EXIST::FUNCTION:CT
 CONF_imodule_get_module                 1907	1_1_0	EXIST::FUNCTION:
 NAME_CONSTRAINTS_new                    1908	1_1_0	EXIST::FUNCTION:
 BN_usub                                 1909	1_1_0	EXIST::FUNCTION:
@@ -2082,7 +2082,7 @@ PKCS7_dup                               2018	1_1_0	EXIST::FUNCTION:
 i2d_TS_REQ_fp                           2019	1_1_0	EXIST::FUNCTION:STDIO,TS
 i2d_OTHERNAME                           2020	1_1_0	EXIST::FUNCTION:
 EC_KEY_get0_private_key                 2021	1_1_0	EXIST::FUNCTION:EC
-SCT_get0_extensions                     2022	1_1_0	EXIST::FUNCTION:
+SCT_get0_extensions                     2022	1_1_0	EXIST::FUNCTION:CT
 lh_node_stats_bio                       2023	1_1_0	EXIST::FUNCTION:
 i2d_DIRECTORYSTRING                     2024	1_1_0	EXIST::FUNCTION:
 BN_X931_derive_prime_ex                 2025	1_1_0	EXIST::FUNCTION:
@@ -2103,7 +2103,7 @@ CMS_RecipientInfo_set0_pkey             2038	1_1_0	EXIST::FUNCTION:CMS
 X509_STORE_CTX_set_default              2039	1_1_0	EXIST::FUNCTION:
 AES_wrap_key                            2040	1_1_0	EXIST::FUNCTION:AES
 EVP_md_null                             2041	1_1_0	EXIST::FUNCTION:
-i2d_SCT_LIST                            2042	1_1_0	EXIST::FUNCTION:
+i2d_SCT_LIST                            2042	1_1_0	EXIST::FUNCTION:CT
 PKCS7_get_issuer_and_serial             2043	1_1_0	EXIST::FUNCTION:
 PKCS7_SIGN_ENVELOPE_it                  2044	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
 PKCS7_SIGN_ENVELOPE_it                  2044	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
@@ -2129,7 +2129,7 @@ OBJ_length                              2062	1_1_0	EXIST::FUNCTION:
 BN_GENCB_get_arg                        2063	1_1_0	EXIST::FUNCTION:
 EVP_MD_CTX_clear_flags                  2064	1_1_0	EXIST::FUNCTION:
 EVP_PKEY_meth_get_verifyctx             2065	1_1_0	EXIST::FUNCTION:
-CT_POLICY_EVAL_CTX_get0_cert            2066	1_1_0	EXIST::FUNCTION:
+CT_POLICY_EVAL_CTX_get0_cert            2066	1_1_0	EXIST::FUNCTION:CT
 PEM_write_DHparams                      2067	1_1_0	EXIST::FUNCTION:DH
 DH_set_ex_data                          2068	1_1_0	EXIST::FUNCTION:DH
 OCSP_SIGNATURE_free                     2069	1_1_0	EXIST::FUNCTION:
@@ -2139,7 +2139,7 @@ i2d_ASN1_ENUMERATED                     2072	1_1_0	EXIST::FUNCTION:
 PEM_read_DSAparams                      2073	1_1_0	EXIST::FUNCTION:DSA
 TS_TST_INFO_set_ordering                2074	1_1_0	EXIST::FUNCTION:TS
 MDC2_Init                               2075	1_1_0	EXIST::FUNCTION:MDC2
-i2o_SCT                                 2076	1_1_0	EXIST::FUNCTION:
+i2o_SCT                                 2076	1_1_0	EXIST::FUNCTION:CT
 d2i_TS_STATUS_INFO                      2077	1_1_0	EXIST::FUNCTION:TS
 ERR_error_string_n                      2078	1_1_0	EXIST::FUNCTION:
 HMAC                                    2079	1_1_0	EXIST::FUNCTION:
@@ -2164,7 +2164,7 @@ i2d_ESS_SIGNING_CERT                    2097	1_1_0	EXIST::FUNCTION:TS
 TS_RESP_set_tst_info                    2098	1_1_0	EXIST::FUNCTION:TS
 EVP_PKEY_CTX_set_data                   2099	1_1_0	EXIST::FUNCTION:
 CMS_EnvelopedData_create                2100	1_1_0	EXIST::FUNCTION:CMS
-SCT_new                                 2101	1_1_0	EXIST::FUNCTION:
+SCT_new                                 2101	1_1_0	EXIST::FUNCTION:CT
 X509_REQ_add1_attr                      2102	1_1_0	EXIST::FUNCTION:
 X509_get_ext_count                      2103	1_1_0	EXIST::FUNCTION:
 CRYPTO_cts128_decrypt                   2104	1_1_0	EXIST::FUNCTION:
@@ -2288,7 +2288,7 @@ DSA_get_default_method                  2213	1_1_0	EXIST::FUNCTION:DSA
 lh_retrieve                             2214	1_1_0	EXIST::FUNCTION:
 CRYPTO_ccm128_decrypt_ccm64             2215	1_1_0	EXIST::FUNCTION:
 TS_RESP_CTX_set_clock_precision_digits  2216	1_1_0	EXIST::FUNCTION:TS
-SCT_LIST_validate                       2217	1_1_0	EXIST::FUNCTION:
+SCT_LIST_validate                       2217	1_1_0	EXIST::FUNCTION:CT
 X509_PURPOSE_get_id                     2218	1_1_0	EXIST::FUNCTION:
 EC_KEY_get_ex_data                      2219	1_1_0	EXIST::FUNCTION:EC
 EVP_MD_size                             2220	1_1_0	EXIST::FUNCTION:
@@ -2360,7 +2360,7 @@ BN_num_bits_word                        2282	1_1_0	EXIST::FUNCTION:
 EVP_DecodeInit                          2283	1_1_0	EXIST::FUNCTION:
 BN_ucmp                                 2284	1_1_0	EXIST::FUNCTION:
 SXNET_get_id_asc                        2285	1_1_0	EXIST::FUNCTION:
-SCT_set1_extensions                     2286	1_1_0	EXIST::FUNCTION:
+SCT_set1_extensions                     2286	1_1_0	EXIST::FUNCTION:CT
 PKCS12_SAFEBAG_new                      2287	1_1_0	EXIST::FUNCTION:
 TS_TST_INFO_set_nonce                   2288	1_1_0	EXIST::FUNCTION:TS
 PEM_read_ECPrivateKey                   2289	1_1_0	EXIST::FUNCTION:EC
@@ -2586,7 +2586,7 @@ d2i_ECPKParameters                      2501	1_1_0	EXIST::FUNCTION:EC
 idea_ofb64_encrypt                      2502	1_1_0	EXIST::FUNCTION:IDEA
 CAST_decrypt                            2503	1_1_0	EXIST::FUNCTION:CAST
 TS_STATUS_INFO_get0_failure_info        2504	1_1_0	EXIST::FUNCTION:TS
-o2i_SCT_signature                       2505	1_1_0	EXIST::FUNCTION:
+o2i_SCT_signature                       2505	1_1_0	EXIST::FUNCTION:CT
 ENGINE_unregister_pkey_meths            2506	1_1_0	EXIST::FUNCTION:ENGINE
 DISPLAYTEXT_new                         2507	1_1_0	EXIST::FUNCTION:
 CMS_final                               2508	1_1_0	EXIST::FUNCTION:CMS
@@ -2740,7 +2740,7 @@ TS_TST_INFO_get_nonce                   2649	1_1_0	EXIST::FUNCTION:TS
 MD4_Init                                2650	1_1_0	EXIST::FUNCTION:MD4
 X509_EXTENSION_create_by_OBJ            2651	1_1_0	EXIST::FUNCTION:
 EVP_aes_256_cbc_hmac_sha1               2652	1_1_0	EXIST::FUNCTION:AES
-SCT_validate                            2653	1_1_0	EXIST::FUNCTION:
+SCT_validate                            2653	1_1_0	EXIST::FUNCTION:CT
 EC_GROUP_dup                            2654	1_1_0	EXIST::FUNCTION:EC
 EVP_sha1                                2655	1_1_0	EXIST::FUNCTION:
 sk_new                                  2656	1_1_0	EXIST::FUNCTION:
@@ -2822,7 +2822,7 @@ EVP_PKEY_copy_parameters                2729	1_1_0	EXIST::FUNCTION:
 CMS_ContentInfo_print_ctx               2730	1_1_0	EXIST::FUNCTION:CMS
 d2i_PKCS7_SIGNED                        2731	1_1_0	EXIST::FUNCTION:
 GENERAL_NAMES_free                      2732	1_1_0	EXIST::FUNCTION:
-SCT_get_timestamp                       2733	1_1_0	EXIST::FUNCTION:
+SCT_get_timestamp                       2733	1_1_0	EXIST::FUNCTION:CT
 OCSP_SIGNATURE_it                       2734	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
 OCSP_SIGNATURE_it                       2734	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
 CMS_verify_receipt                      2735	1_1_0	EXIST::FUNCTION:CMS
@@ -2846,7 +2846,7 @@ PKCS7_SIGN_ENVELOPE_new                 2752	1_1_0	EXIST::FUNCTION:
 TS_REQ_get_policy_id                    2753	1_1_0	EXIST::FUNCTION:TS
 RC5_32_cbc_encrypt                      2754	1_1_0	EXIST::FUNCTION:RC5
 BN_is_zero                              2755	1_1_0	EXIST::FUNCTION:
-CT_POLICY_EVAL_CTX_new                  2756	1_1_0	EXIST::FUNCTION:
+CT_POLICY_EVAL_CTX_new                  2756	1_1_0	EXIST::FUNCTION:CT
 NETSCAPE_SPKI_it                        2757	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
 NETSCAPE_SPKI_it                        2757	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
 CRYPTO_THREAD_unlock                    2758	1_1_0	EXIST::FUNCTION:
@@ -2918,9 +2918,9 @@ i2d_IPAddressOrRange                    2818	1_1_0	EXIST::FUNCTION:RFC3779
 CRYPTO_secure_used                      2819	1_1_0	EXIST::FUNCTION:
 d2i_X509_CRL_INFO                       2820	1_1_0	EXIST::FUNCTION:
 X509_CRL_get_issuer                     2821	1_1_0	EXIST::FUNCTION:
-d2i_SCT_LIST                            2822	1_1_0	EXIST::FUNCTION:
+d2i_SCT_LIST                            2822	1_1_0	EXIST::FUNCTION:CT
 EC_GFp_nist_method                      2823	1_1_0	EXIST::FUNCTION:EC
-SCT_free                                2824	1_1_0	EXIST::FUNCTION:
+SCT_free                                2824	1_1_0	EXIST::FUNCTION:CT
 TS_TST_INFO_get_msg_imprint             2825	1_1_0	EXIST::FUNCTION:TS
 v3_addr_add_range                       2826	1_1_0	EXIST::FUNCTION:RFC3779
 PKCS12_get_friendlyname                 2827	1_1_0	EXIST::FUNCTION:
@@ -2935,7 +2935,7 @@ SRP_Calc_x                              2835	1_1_0	EXIST::FUNCTION:SRP
 a2i_ASN1_ENUMERATED                     2836	1_1_0	EXIST::FUNCTION:
 CONF_module_get_usr_data                2837	1_1_0	EXIST::FUNCTION:
 i2d_X509_NAME_ENTRY                     2838	1_1_0	EXIST::FUNCTION:
-SCT_LIST_free                           2839	1_1_0	EXIST::FUNCTION:
+SCT_LIST_free                           2839	1_1_0	EXIST::FUNCTION:CT
 PROXY_POLICY_new                        2840	1_1_0	EXIST::FUNCTION:
 X509_ALGOR_set_md                       2841	1_1_0	EXIST::FUNCTION:
 PKCS7_print_ctx                         2842	1_1_0	EXIST::FUNCTION:
@@ -2976,7 +2976,7 @@ EVP_PKEY_get0                           2874	1_1_0	EXIST::FUNCTION:
 ENGINE_set_default                      2875	1_1_0	EXIST::FUNCTION:ENGINE
 NCONF_get_number_e                      2876	1_1_0	EXIST::FUNCTION:
 OPENSSL_cleanse                         2877	1_1_0	EXIST::FUNCTION:
-SCT_set0_signature                      2878	1_1_0	EXIST::FUNCTION:
+SCT_set0_signature                      2878	1_1_0	EXIST::FUNCTION:CT
 X509_CRL_sign                           2879	1_1_0	EXIST::FUNCTION:
 X509_CINF_it                            2880	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
 X509_CINF_it                            2880	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
@@ -3291,7 +3291,7 @@ i2d_PUBKEY_fp                           3180	1_1_0	EXIST::FUNCTION:STDIO
 b2i_PrivateKey_bio                      3181	1_1_0	EXIST::FUNCTION:
 OCSP_REQUEST_add_ext                    3182	1_1_0	EXIST::FUNCTION:
 SXNET_add_id_INTEGER                    3183	1_1_0	EXIST::FUNCTION:
-CTLOG_get0_public_key                   3184	1_1_0	EXIST::FUNCTION:
+CTLOG_get0_public_key                   3184	1_1_0	EXIST::FUNCTION:CT
 OCSP_REQUEST_get_ext_by_OBJ             3185	1_1_0	EXIST::FUNCTION:
 X509_NAME_oneline                       3186	1_1_0	EXIST::FUNCTION:
 X509V3_set_nconf                        3187	1_1_0	EXIST::FUNCTION:
@@ -3304,7 +3304,7 @@ RSA_new_method                          3193	1_1_0	EXIST::FUNCTION:RSA
 OCSP_request_verify                     3194	1_1_0	EXIST::FUNCTION:
 CRYPTO_THREAD_run_once                  3195	1_1_0	EXIST::FUNCTION:
 TS_REQ_print_bio                        3196	1_1_0	EXIST::FUNCTION:TS
-SCT_get_version                         3197	1_1_0	EXIST::FUNCTION:
+SCT_get_version                         3197	1_1_0	EXIST::FUNCTION:CT
 idea_set_encrypt_key                    3198	1_1_0	EXIST::FUNCTION:IDEA
 ENGINE_get_DH                           3199	1_1_0	EXIST::FUNCTION:ENGINE
 i2d_ASIdentifierChoice                  3200	1_1_0	EXIST::FUNCTION:RFC3779
@@ -3383,7 +3383,7 @@ OCSP_REQUEST_new                        3271	1_1_0	EXIST::FUNCTION:
 BIO_lookup                              3272	1_1_0	EXIST::FUNCTION:
 EC_GROUP_get0_cofactor                  3273	1_1_0	EXIST::FUNCTION:EC
 CRYPTO_THREADID_set_numeric             3274	1_1_0	NOEXIST::FUNCTION:
-SCT_print                               3275	1_1_0	EXIST::FUNCTION:
+SCT_print                               3275	1_1_0	EXIST::FUNCTION:CT
 X509_PUBKEY_set                         3276	1_1_0	EXIST::FUNCTION:
 POLICY_CONSTRAINTS_free                 3277	1_1_0	EXIST::FUNCTION:
 EVP_aes_256_cfb8                        3278	1_1_0	EXIST::FUNCTION:AES
@@ -3434,7 +3434,7 @@ PEM_def_callback                        3321	1_1_0	EXIST::FUNCTION:
 PKCS12_add_friendlyname_uni             3322	1_1_0	EXIST::FUNCTION:
 X509_policy_tree_level_count            3323	1_1_0	EXIST::FUNCTION:
 OBJ_sn2nid                              3324	1_1_0	EXIST::FUNCTION:
-CTLOG_free                              3325	1_1_0	EXIST::FUNCTION:
+CTLOG_free                              3325	1_1_0	EXIST::FUNCTION:CT
 EVP_CIPHER_meth_dup                     3326	1_1_0	EXIST::FUNCTION:
 CMS_get1_crls                           3327	1_1_0	EXIST::FUNCTION:CMS
 X509_aux_print                          3328	1_1_0	EXIST::FUNCTION:
@@ -3471,7 +3471,7 @@ RSA_generate_key_ex                     3357	1_1_0	EXIST::FUNCTION:RSA
 CMS_SignerInfo_get0_algs                3358	1_1_0	EXIST::FUNCTION:CMS
 DIST_POINT_free                         3359	1_1_0	EXIST::FUNCTION:
 ESS_SIGNING_CERT_free                   3360	1_1_0	EXIST::FUNCTION:TS
-SCT_new_from_base64                     3361	1_1_0	EXIST::FUNCTION:
+SCT_new_from_base64                     3361	1_1_0	EXIST::FUNCTION:CT
 OpenSSL_version                         3362	1_1_0	EXIST::FUNCTION:
 OCSP_SINGLERESP_get_ext_by_OBJ          3363	1_1_0	EXIST::FUNCTION:
 ECDSA_SIG_get0                          3364	1_1_0	EXIST::FUNCTION:EC
@@ -3539,7 +3539,7 @@ BN_BLINDING_convert_ex                  3423	1_1_0	EXIST::FUNCTION:
 ASN1_GENERALIZEDTIME_print              3424	1_1_0	EXIST::FUNCTION:
 BIO_s_null                              3425	1_1_0	EXIST::FUNCTION:
 PEM_ASN1_read                           3426	1_1_0	EXIST::FUNCTION:STDIO
-SCT_get_log_entry_type                  3427	1_1_0	EXIST::FUNCTION:
+SCT_get_log_entry_type                  3427	1_1_0	EXIST::FUNCTION:CT
 EVP_CIPHER_meth_get_init                3428	1_1_0	EXIST::FUNCTION:
 X509_ALGOR_free                         3429	1_1_0	EXIST::FUNCTION:
 OCSP_SINGLERESP_get_ext_count           3430	1_1_0	EXIST::FUNCTION:
@@ -3548,7 +3548,7 @@ EVP_OpenFinal                           3432	1_1_0	EXIST::FUNCTION:RSA
 RAND_egd_bytes                          3433	1_1_0	EXIST::FUNCTION:EGD
 UI_method_get_writer                    3434	1_1_0	EXIST::FUNCTION:
 BN_secure_new                           3435	1_1_0	EXIST::FUNCTION:
-CTLOG_new_null                          3436	1_1_0	EXIST::FUNCTION:
+CTLOG_new_null                          3436	1_1_0	EXIST::FUNCTION:CT
 SHA1_Update                             3437	1_1_0	EXIST::FUNCTION:
 BIO_s_connect                           3438	1_1_0	EXIST::FUNCTION:
 EVP_MD_meth_get_init                    3439	1_1_0	EXIST::FUNCTION:
@@ -3588,7 +3588,7 @@ BN_BLINDING_invert_ex                   3472	1_1_0	EXIST::FUNCTION:
 RIPEMD160_Init                          3473	1_1_0	EXIST::FUNCTION:RMD160
 ASYNC_WAIT_CTX_get_changed_fds          3474	1_1_0	EXIST::FUNCTION:
 EVP_PKEY_save_parameters                3475	1_1_0	EXIST::FUNCTION:
-SCT_set_source                          3476	1_1_0	EXIST::FUNCTION:
+SCT_set_source                          3476	1_1_0	EXIST::FUNCTION:CT
 DES_set_odd_parity                      3477	1_1_0	EXIST::FUNCTION:DES
 CMAC_CTX_free                           3478	1_1_0	EXIST::FUNCTION:
 d2i_ESS_ISSUER_SERIAL                   3479	1_1_0	EXIST::FUNCTION:TS
@@ -3635,7 +3635,7 @@ EVP_MD_CTX_ctrl                         3518	1_1_0	EXIST::FUNCTION:
 PKCS7_final                             3519	1_1_0	EXIST::FUNCTION:
 EVP_PKEY_size                           3520	1_1_0	EXIST::FUNCTION:
 EVP_DecryptFinal_ex                     3521	1_1_0	EXIST::FUNCTION:
-SCT_get_signature_nid                   3522	1_1_0	EXIST::FUNCTION:
+SCT_get_signature_nid                   3522	1_1_0	EXIST::FUNCTION:CT
 PROXY_CERT_INFO_EXTENSION_new           3523	1_1_0	EXIST::FUNCTION:
 EVP_bf_cbc                              3524	1_1_0	EXIST::FUNCTION:BF
 DSA_do_verify                           3525	1_1_0	EXIST::FUNCTION:DSA
@@ -3655,7 +3655,7 @@ d2i_BASIC_CONSTRAINTS                   3539	1_1_0	EXIST::FUNCTION:
 X509_CERT_AUX_new                       3540	1_1_0	EXIST::FUNCTION:
 ENGINE_register_pkey_asn1_meths         3541	1_1_0	EXIST::FUNCTION:ENGINE
 CRYPTO_ocb128_tag                       3542	1_1_0	EXIST::FUNCTION:OCB
-i2o_SCT_signature                       3543	1_1_0	EXIST::FUNCTION:
+i2o_SCT_signature                       3543	1_1_0	EXIST::FUNCTION:CT
 ERR_load_OBJ_strings                    3544	1_1_0	EXIST::FUNCTION:
 BIO_ctrl_get_read_request               3545	1_1_0	EXIST::FUNCTION:
 BN_from_montgomery                      3546	1_1_0	EXIST::FUNCTION:
@@ -3756,7 +3756,7 @@ BIO_set_cipher                          3637	1_1_0	EXIST::FUNCTION:
 PEM_read_PUBKEY                         3638	1_1_0	EXIST::FUNCTION:
 RSA_PKCS1_OpenSSL                       3639	1_1_0	EXIST::FUNCTION:RSA
 AUTHORITY_INFO_ACCESS_free              3640	1_1_0	EXIST::FUNCTION:
-SCT_get0_signature                      3641	1_1_0	EXIST::FUNCTION:
+SCT_get0_signature                      3641	1_1_0	EXIST::FUNCTION:CT
 name_cmp                                3642	1_1_0	EXIST::FUNCTION:
 DISPLAYTEXT_it                          3643	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
 DISPLAYTEXT_it                          3643	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
@@ -3860,7 +3860,7 @@ SRP_Calc_u                              3738	1_1_0	EXIST::FUNCTION:SRP
 i2d_PKCS8PrivateKey_bio                 3739	1_1_0	EXIST::FUNCTION:
 X509_get_extension_flags                3740	1_1_0	EXIST::FUNCTION:
 X509V3_EXT_val_prn                      3741	1_1_0	EXIST::FUNCTION:
-SCT_get_validation_status               3742	1_1_0	EXIST::FUNCTION:
+SCT_get_validation_status               3742	1_1_0	EXIST::FUNCTION:CT
 NETSCAPE_CERT_SEQUENCE_free             3743	1_1_0	EXIST::FUNCTION:
 EVP_PBE_scrypt                          3744	1_1_0	EXIST::FUNCTION:SCRYPT
 d2i_TS_REQ_bio                          3745	1_1_0	EXIST::FUNCTION:TS
@@ -3907,7 +3907,7 @@ UI_new_method                           3783	1_1_0	EXIST::FUNCTION:
 Camellia_ofb128_encrypt                 3784	1_1_0	EXIST::FUNCTION:CAMELLIA
 X509_new                                3785	1_1_0	EXIST::FUNCTION:
 EC_KEY_get_conv_form                    3786	1_1_0	EXIST::FUNCTION:EC
-CTLOG_STORE_get0_log_by_id              3787	1_1_0	EXIST::FUNCTION:
+CTLOG_STORE_get0_log_by_id              3787	1_1_0	EXIST::FUNCTION:CT
 CMS_signed_add1_attr                    3788	1_1_0	EXIST::FUNCTION:CMS
 EVP_CIPHER_meth_set_iv_length           3789	1_1_0	EXIST::FUNCTION:
 v3_asid_validate_path                   3790	1_1_0	EXIST::FUNCTION:RFC3779
@@ -3940,7 +3940,7 @@ CMS_unsigned_add1_attr_by_txt           3814	1_1_0	EXIST::FUNCTION:CMS
 d2i_RSA_PUBKEY                          3815	1_1_0	EXIST::FUNCTION:RSA
 PKCS12_gen_mac                          3816	1_1_0	EXIST::FUNCTION:
 ERR_load_ENGINE_strings                 3817	1_1_0	EXIST::FUNCTION:ENGINE
-ERR_load_CT_strings                     3818	1_1_0	EXIST::FUNCTION:
+ERR_load_CT_strings                     3818	1_1_0	EXIST::FUNCTION:CT
 OCSP_ONEREQ_it                          3819	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
 OCSP_ONEREQ_it                          3819	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
 X509_PURPOSE_get_by_sname               3820	1_1_0	EXIST::FUNCTION:
@@ -4026,7 +4026,7 @@ OCSP_REVOKEDINFO_it                     3895	1_1_0	EXIST:!EXPORT_VAR_AS_FUNCTION
 OCSP_REVOKEDINFO_it                     3895	1_1_0	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
 X509V3_set_ctx                          3896	1_1_0	EXIST::FUNCTION:
 ASN1_ENUMERATED_set_int64               3897	1_1_0	EXIST::FUNCTION:
-o2i_SCT                                 3898	1_1_0	EXIST::FUNCTION:
+o2i_SCT                                 3898	1_1_0	EXIST::FUNCTION:CT
 CRL_DIST_POINTS_free                    3899	1_1_0	EXIST::FUNCTION:
 d2i_OCSP_SINGLERESP                     3900	1_1_0	EXIST::FUNCTION:
 EVP_CIPHER_CTX_num                      3901	1_1_0	EXIST::FUNCTION:
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005773.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="005775.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5774">[ date ]</a>
              <a href="thread.html#5774">[ thread ]</a>
              <a href="subject.html#5774">[ subject ]</a>
              <a href="author.html#5774">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
