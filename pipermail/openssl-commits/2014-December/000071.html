<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl] OpenSSL source code branch	OpenSSL_1_0_1-stable updated. OpenSSL_1_0_1j-78-gb3147fc
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2014-December/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20OpenSSL%20source%20code%20branch%0A%09OpenSSL_1_0_1-stable%20updated.%20OpenSSL_1_0_1j-78-gb3147fc&In-Reply-To=%3C20141217132758.C91771DF107%40openssl.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000070.html">
   <LINK REL="Next"  HREF="000072.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl] OpenSSL source code branch	OpenSSL_1_0_1-stable updated. OpenSSL_1_0_1j-78-gb3147fc</H1>
    <B>Richard Levitte</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20OpenSSL%20source%20code%20branch%0A%09OpenSSL_1_0_1-stable%20updated.%20OpenSSL_1_0_1j-78-gb3147fc&In-Reply-To=%3C20141217132758.C91771DF107%40openssl.net%3E"
       TITLE="[openssl-commits] [openssl] OpenSSL source code branch	OpenSSL_1_0_1-stable updated. OpenSSL_1_0_1j-78-gb3147fc">levitte at openssl.org
       </A><BR>
    <I>Wed Dec 17 13:27:58 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000070.html">[openssl-commits] [openssl] OpenSSL source code branch	OpenSSL_1_0_2-stable updated. OpenSSL_1_0_2-beta3-117-g8bc8450
</A></li>
        <LI>Next message: <A HREF="000072.html">[openssl-commits] [openssl] OpenSSL source code branch	OpenSSL_1_0_1-stable updated. OpenSSL_1_0_1j-79-g7e9d42c
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#71">[ date ]</a>
              <a href="thread.html#71">[ thread ]</a>
              <a href="subject.html#71">[ subject ]</a>
              <a href="author.html#71">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;OpenSSL source code&quot;.

The branch, OpenSSL_1_0_1-stable has been updated
       via  b3147fcbe6c4bb750c51edd28c18bd2187d5e939 (commit)
       via  feefb73ad9e5dc3f98ecdf2f1b4eee035567a185 (commit)
       via  8932b82f7d20159ca6264e811e0b67dadb26c969 (commit)
       via  a4a759acecac67d7c41fa47e724f634c709ea65c (commit)
       via  6e5a5545337c339242253b59bf079cd2d61270fd (commit)
       via  2164a17a7d85ab7953a18b1e50bc7d1e3c814b4e (commit)
      from  dc1e4938083e7c50b27a96412db9dd834737cb8b (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit b3147fcbe6c4bb750c51edd28c18bd2187d5e939
Author: Richard Levitte &lt;<A HREF="https://mta.opensslfoundation.net/mailman/listinfo/openssl-commits">levitte at openssl.org</A>&gt;
Date:   Tue Dec 16 11:04:53 2014 +0100

    Clear warnings/errors within RL_DEBUG code sections (RL_DEBUG should be renamed)
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="https://mta.opensslfoundation.net/mailman/listinfo/openssl-commits">appro at openssl.org</A>&gt;
    (cherry picked from commit 8bc8450a26329e3c890df60026f969e7caabff3d)

commit feefb73ad9e5dc3f98ecdf2f1b4eee035567a185
Author: Richard Levitte &lt;<A HREF="https://mta.opensslfoundation.net/mailman/listinfo/openssl-commits">levitte at openssl.org</A>&gt;
Date:   Tue Dec 16 11:04:19 2014 +0100

    Clear warnings/errors within TLS_DEBUG code sections
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="https://mta.opensslfoundation.net/mailman/listinfo/openssl-commits">appro at openssl.org</A>&gt;
    (cherry picked from commit bf68456f538cacc9dcfd00986962aef0e8538289)

commit 8932b82f7d20159ca6264e811e0b67dadb26c969
Author: Richard Levitte &lt;<A HREF="https://mta.opensslfoundation.net/mailman/listinfo/openssl-commits">levitte at openssl.org</A>&gt;
Date:   Tue Dec 16 04:13:41 2014 +0100

    Clear warnings/errors within KSSL_DEBUG code sections
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="https://mta.opensslfoundation.net/mailman/listinfo/openssl-commits">appro at openssl.org</A>&gt;
    (cherry picked from commit 53332a75d16a5bb3b9d90c15fcf38d2e87160a52)

commit a4a759acecac67d7c41fa47e724f634c709ea65c
Author: Richard Levitte &lt;<A HREF="https://mta.opensslfoundation.net/mailman/listinfo/openssl-commits">levitte at openssl.org</A>&gt;
Date:   Tue Dec 16 02:54:50 2014 +0100

    Clear warnings/errors within CIPHER_DEBUG code sections
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="https://mta.opensslfoundation.net/mailman/listinfo/openssl-commits">appro at openssl.org</A>&gt;
    (cherry picked from commit cd387d21daa939862e081f00be0a98dbc5a85351)

commit 6e5a5545337c339242253b59bf079cd2d61270fd
Author: Richard Levitte &lt;<A HREF="https://mta.opensslfoundation.net/mailman/listinfo/openssl-commits">levitte at openssl.org</A>&gt;
Date:   Tue Dec 16 02:54:03 2014 +0100

    Clear warnings/errors within CIPHER_DEBUG code sections
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="https://mta.opensslfoundation.net/mailman/listinfo/openssl-commits">appro at openssl.org</A>&gt;
    (cherry picked from commit 0c403e80a9952c83a38eab3c8a4ce42e17a2cee0)

commit 2164a17a7d85ab7953a18b1e50bc7d1e3c814b4e
Author: Richard Levitte &lt;<A HREF="https://mta.opensslfoundation.net/mailman/listinfo/openssl-commits">levitte at openssl.org</A>&gt;
Date:   Tue Dec 16 01:38:39 2014 +0100

    Clear warnings/errors within BN_CTX_DEBUG code sections
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="https://mta.opensslfoundation.net/mailman/listinfo/openssl-commits">appro at openssl.org</A>&gt;
    (cherry picked from commit 553affbef7bb5dd313514e06dab5cd9b1de1835f)

-----------------------------------------------------------------------

Summary of changes:
 apps/ca.c           |    2 +-
 crypto/bn/bn_ctx.c  |    2 +-
 crypto/evp/e_des3.c |   22 +++++++++-------
 ssl/kssl.c          |   72 +++++++++++++++++++++++++--------------------------
 ssl/s3_clnt.c       |   12 ++++-----
 ssl/s3_lib.c        |   14 +++++-----
 ssl/s3_srvr.c       |   15 ++++++-----
 ssl/ssl_ciph.c      |   12 ++++-----
 ssl/ssl_lib.c       |    2 +-
 ssl/t1_enc.c        |   70 ++++++++++++++++++++++++-------------------------
 10 files changed, 113 insertions(+), 110 deletions(-)

diff --git a/apps/ca.c b/apps/ca.c
index 9c25026..613f5be 100644
--- a/apps/ca.c
+++ b/apps/ca.c
@@ -703,7 +703,7 @@ bad:
 		ERR_clear_error();
 #ifdef RL_DEBUG
 	if (!p)
-		BIO_printf(bio_err, &quot;DEBUG: unique_subject undefined\n&quot;, p);
+		BIO_printf(bio_err, &quot;DEBUG: unique_subject undefined\n&quot;);
 #endif
 #ifdef RL_DEBUG
 	BIO_printf(bio_err, &quot;DEBUG: configured unique_subject is %d\n&quot;,
diff --git a/crypto/bn/bn_ctx.c b/crypto/bn/bn_ctx.c
index 3f2256f..90aa3ae 100644
--- a/crypto/bn/bn_ctx.c
+++ b/crypto/bn/bn_ctx.c
@@ -158,7 +158,7 @@ static void ctxdbg(BN_CTX *ctx)
 	unsigned int bnidx = 0, fpidx = 0;
 	BN_POOL_ITEM *item = ctx-&gt;pool.head;
 	BN_STACK *stack = &amp;ctx-&gt;stack;
-	fprintf(stderr,&quot;(%08x): &quot;, (unsigned int)ctx);
+	fprintf(stderr,&quot;(%16p): &quot;, ctx);
 	while(bnidx &lt; ctx-&gt;used)
 		{
 		fprintf(stderr,&quot;%03x &quot;, item-&gt;vals[bnidx++ % BN_CTX_POOL_SIZE].dmax);
diff --git a/crypto/evp/e_des3.c b/crypto/evp/e_des3.c
index 8d7b7de..7e1e8b3 100644
--- a/crypto/evp/e_des3.c
+++ b/crypto/evp/e_des3.c
@@ -124,12 +124,11 @@ static int des_ede_cbc_cipher(EVP_CIPHER_CTX *ctx, unsigned char *out,
 #ifdef KSSL_DEBUG
 	{
         int i;
-        char *cp;
-	printf(&quot;des_ede_cbc_cipher(ctx=%lx, buflen=%d)\n&quot;, ctx, ctx-&gt;buf_len);
-	printf(&quot;\t iv= &quot;);
+	fprintf(stderr,&quot;des_ede_cbc_cipher(ctx=%p, buflen=%d)\n&quot;, ctx, ctx-&gt;buf_len);
+	fprintf(stderr,&quot;\t iv= &quot;);
         for(i=0;i&lt;8;i++)
-                printf(&quot;%02X&quot;,ctx-&gt;iv[i]);
-	printf(&quot;\n&quot;);
+                fprintf(stderr,&quot;%02X&quot;,ctx-&gt;iv[i]);
+	fprintf(stderr,&quot;\n&quot;);
 	}
 #endif    /* KSSL_DEBUG */
 	while (inl&gt;=EVP_MAXCHUNK)
@@ -260,11 +259,14 @@ static int des_ede3_init_key(EVP_CIPHER_CTX *ctx, const unsigned char *key,
 #ifdef KSSL_DEBUG
 	{
         int i;
-        printf(&quot;des_ede3_init_key(ctx=%lx)\n&quot;, ctx);
-	printf(&quot;\tKEY= &quot;);
-        for(i=0;i&lt;24;i++) printf(&quot;%02X&quot;,key[i]); printf(&quot;\n&quot;);
-	printf(&quot;\t IV= &quot;);
-        for(i=0;i&lt;8;i++) printf(&quot;%02X&quot;,iv[i]); printf(&quot;\n&quot;);
+        fprintf(stderr,&quot;des_ede3_init_key(ctx=%p)\n&quot;, ctx);
+	fprintf(stderr,&quot;\tKEY= &quot;);
+        for(i=0;i&lt;24;i++) fprintf(stderr,&quot;%02X&quot;,key[i]); fprintf(stderr,&quot;\n&quot;);
+	if (iv) 
+		{
+		fprintf(stderr,&quot;\t IV= &quot;);
+		for(i=0;i&lt;8;i++) fprintf(stderr,&quot;%02X&quot;,iv[i]); fprintf(stderr,&quot;\n&quot;);
+		}
 	}
 #endif	/* KSSL_DEBUG */
 
diff --git a/ssl/kssl.c b/ssl/kssl.c
index fd7c67b..950a0c5 100644
--- a/ssl/kssl.c
+++ b/ssl/kssl.c
@@ -954,15 +954,15 @@ print_krb5_data(char *label, krb5_data *kdata)
         {
 	int i;
 
-	printf(&quot;%s[%d] &quot;, label, kdata-&gt;length);
+	fprintf(stderr,&quot;%s[%d] &quot;, label, kdata-&gt;length);
 	for (i=0; i &lt; (int)kdata-&gt;length; i++)
                 {
 		if (0 &amp;&amp;  isprint((int) kdata-&gt;data[i]))
-                        printf(	&quot;%c &quot;,  kdata-&gt;data[i]);
+                        fprintf(stderr,	&quot;%c &quot;,  kdata-&gt;data[i]);
 		else
-                        printf(	&quot;%02x &quot;, (unsigned char) kdata-&gt;data[i]);
+                        fprintf(stderr,	&quot;%02x &quot;, (unsigned char) kdata-&gt;data[i]);
 		}
-	printf(&quot;\n&quot;);
+	fprintf(stderr,&quot;\n&quot;);
         }
 
 
@@ -973,20 +973,20 @@ print_krb5_authdata(char *label, krb5_authdata **adata)
         {
 	if (adata == NULL)
                 {
-		printf(&quot;%s, authdata==0\n&quot;, label);
+		fprintf(stderr,&quot;%s, authdata==0\n&quot;, label);
 		return;
 		}
-	printf(&quot;%s [%p]\n&quot;, label, (void *)adata);
+	fprintf(stderr,&quot;%s [%p]\n&quot;, label, (void *)adata);
 #if 0
 	{
         int 	i;
-	printf(&quot;%s[at%d:%d] &quot;, label, adata-&gt;ad_type, adata-&gt;length);
+	fprintf(stderr,&quot;%s[at%d:%d] &quot;, label, adata-&gt;ad_type, adata-&gt;length);
 	for (i=0; i &lt; adata-&gt;length; i++)
                 {
-                printf((isprint(adata-&gt;contents[i]))? &quot;%c &quot;: &quot;%02x&quot;,
+                fprintf(stderr,(isprint(adata-&gt;contents[i]))? &quot;%c &quot;: &quot;%02x&quot;,
                         adata-&gt;contents[i]);
 		}
-	printf(&quot;\n&quot;);
+	fprintf(stderr,&quot;\n&quot;);
 	}
 #endif
 	}
@@ -1001,24 +1001,24 @@ print_krb5_keyblock(char *label, krb5_keyblock *keyblk)
 
 	if (keyblk == NULL)
                 {
-		printf(&quot;%s, keyblk==0\n&quot;, label);
+		fprintf(stderr,&quot;%s, keyblk==0\n&quot;, label);
 		return;
 		}
 #ifdef KRB5_HEIMDAL
-	printf(&quot;%s\n\t[et%d:%d]: &quot;, label, keyblk-&gt;keytype,
+	fprintf(stderr,&quot;%s\n\t[et%d:%d]: &quot;, label, keyblk-&gt;keytype,
 					   keyblk-&gt;keyvalue-&gt;length);
 	for (i=0; i &lt; (int)keyblk-&gt;keyvalue-&gt;length; i++)
                 {
-		printf(&quot;%02x&quot;,(unsigned char *)(keyblk-&gt;keyvalue-&gt;contents)[i]);
+		fprintf(stderr,&quot;%02x&quot;,(unsigned char *)(keyblk-&gt;keyvalue-&gt;contents)[i]);
 		}
-	printf(&quot;\n&quot;);
+	fprintf(stderr,&quot;\n&quot;);
 #else
-	printf(&quot;%s\n\t[et%d:%d]: &quot;, label, keyblk-&gt;enctype, keyblk-&gt;length);
+	fprintf(stderr,&quot;%s\n\t[et%d:%d]: &quot;, label, keyblk-&gt;enctype, keyblk-&gt;length);
 	for (i=0; i &lt; (int)keyblk-&gt;length; i++)
                 {
-		printf(&quot;%02x&quot;,keyblk-&gt;contents[i]);
+		fprintf(stderr,&quot;%02x&quot;,keyblk-&gt;contents[i]);
 		}
-	printf(&quot;\n&quot;);
+	fprintf(stderr,&quot;\n&quot;);
 #endif
         }
 
@@ -1031,17 +1031,17 @@ print_krb5_princ(char *label, krb5_principal_data *princ)
         {
 	int i, ui, uj;
 
-	printf(&quot;%s principal Realm: &quot;, label);
+	fprintf(stderr,&quot;%s principal Realm: &quot;, label);
 	if (princ == NULL)  return;
 	for (ui=0; ui &lt; (int)princ-&gt;realm.length; ui++)  putchar(princ-&gt;realm.data[ui]);
-	printf(&quot; (nametype %d) has %d strings:\n&quot;, princ-&gt;type,princ-&gt;length);
+	fprintf(stderr,&quot; (nametype %d) has %d strings:\n&quot;, princ-&gt;type,princ-&gt;length);
 	for (i=0; i &lt; (int)princ-&gt;length; i++)
                 {
-		printf(&quot;\t%d [%d]: &quot;, i, princ-&gt;data[i].length);
+		fprintf(stderr,&quot;\t%d [%d]: &quot;, i, princ-&gt;data[i].length);
 		for (uj=0; uj &lt; (int)princ-&gt;data[i].length; uj++)  {
 			putchar(princ-&gt;data[i].data[uj]);
 			}
-		printf(&quot;\n&quot;);
+		fprintf(stderr,&quot;\n&quot;);
 		}
 	return;
         }
@@ -1332,7 +1332,7 @@ kssl_sget_tkt(	/* UPDATE */	KSSL_CTX		*kssl_ctx,
 		}
 
 #ifdef KSSL_DEBUG
-	printf(&quot;in kssl_sget_tkt(%s)\n&quot;, kstring(kssl_ctx-&gt;service_name));
+	fprintf(stderr,&quot;in kssl_sget_tkt(%s)\n&quot;, kstring(kssl_ctx-&gt;service_name));
 #endif	/* KSSL_DEBUG */
 
 	if (!krb5context  &amp;&amp;  (krb5rc = krb5_init_context(&amp;krb5context)))
@@ -1481,18 +1481,18 @@ kssl_sget_tkt(	/* UPDATE */	KSSL_CTX		*kssl_ctx,
 #ifdef KSSL_DEBUG
 		{
 		int i; krb5_address **paddr = krb5ticket-&gt;enc_part2-&gt;caddrs;
-		printf(&quot;Decrypted ticket fields:\n&quot;);
-		printf(&quot;\tflags: %X, transit-type: %X&quot;,
+		fprintf(stderr,&quot;Decrypted ticket fields:\n&quot;);
+		fprintf(stderr,&quot;\tflags: %X, transit-type: %X&quot;,
 			krb5ticket-&gt;enc_part2-&gt;flags,
 			krb5ticket-&gt;enc_part2-&gt;transited.tr_type);
 		print_krb5_data(&quot;\ttransit-data: &quot;,
 			&amp;(krb5ticket-&gt;enc_part2-&gt;transited.tr_contents));
-		printf(&quot;\tcaddrs: %p, authdata: %p\n&quot;,
+		fprintf(stderr,&quot;\tcaddrs: %p, authdata: %p\n&quot;,
 			krb5ticket-&gt;enc_part2-&gt;caddrs,
 			krb5ticket-&gt;enc_part2-&gt;authorization_data);
 		if (paddr)
 			{
-			printf(&quot;\tcaddrs:\n&quot;);
+			fprintf(stderr,&quot;\tcaddrs:\n&quot;);
 			for (i=0; paddr[i] != NULL; i++)
 				{
 				krb5_data d;
@@ -1501,7 +1501,7 @@ kssl_sget_tkt(	/* UPDATE */	KSSL_CTX		*kssl_ctx,
 				print_krb5_data(&quot;\t\tIP: &quot;, &amp;d);
 				}
 			}
-		printf(&quot;\tstart/auth/end times: %d / %d / %d\n&quot;,
+		fprintf(stderr,&quot;\tstart/auth/end times: %d / %d / %d\n&quot;,
 			krb5ticket-&gt;enc_part2-&gt;times.starttime,
 			krb5ticket-&gt;enc_part2-&gt;times.authtime,
 			krb5ticket-&gt;enc_part2-&gt;times.endtime);
@@ -1976,7 +1976,7 @@ krb5_error_code  kssl_validate_times(	krb5_timestamp atime,
 	if ((now - ttimes-&gt;endtime) &gt; skew)  return SSL_R_KRB5_S_TKT_EXPIRED;
 
 #ifdef KSSL_DEBUG
-	printf(&quot;kssl_validate_times: %d |&lt;-  | %d - %d | &lt; %d  -&gt;| %d\n&quot;,
+	fprintf(stderr,&quot;kssl_validate_times: %d |&lt;-  | %d - %d | &lt; %d  -&gt;| %d\n&quot;,
 		start, atime, now, skew, ttimes-&gt;endtime);
 #endif	/* KSSL_DEBUG */
 
@@ -2027,10 +2027,10 @@ krb5_error_code  kssl_check_authent(
 #ifdef KSSL_DEBUG
         {
         unsigned int ui;
-	printf(&quot;kssl_check_authent: authenticator[%d]:\n&quot;,authentp-&gt;length);
+	fprintf(stderr,&quot;kssl_check_authent: authenticator[%d]:\n&quot;,authentp-&gt;length);
 	p = authentp-&gt;data; 
-	for (ui=0; ui &lt; authentp-&gt;length; ui++)  printf(&quot;%02x &quot;,p[ui]);
-	printf(&quot;\n&quot;);
+	for (ui=0; ui &lt; authentp-&gt;length; ui++)  fprintf(stderr,&quot;%02x &quot;,p[ui]);
+	fprintf(stderr,&quot;\n&quot;);
         }
 #endif	/* KSSL_DEBUG */
 
@@ -2095,9 +2095,9 @@ krb5_error_code  kssl_check_authent(
 #ifdef KSSL_DEBUG
 	{
 	int padl;
-	printf(&quot;kssl_check_authent: decrypted authenticator[%d] =\n&quot;, outl);
-	for (padl=0; padl &lt; outl; padl++) printf(&quot;%02x &quot;,unenc_authent[padl]);
-	printf(&quot;\n&quot;);
+	fprintf(stderr,&quot;kssl_check_authent: decrypted authenticator[%d] =\n&quot;, outl);
+	for (padl=0; padl &lt; outl; padl++) fprintf(stderr,&quot;%02x &quot;,unenc_authent[padl]);
+	fprintf(stderr,&quot;\n&quot;);
 	}
 #endif	/* KSSL_DEBUG */
 
@@ -2132,10 +2132,10 @@ krb5_error_code  kssl_check_authent(
  		}
 
 #ifdef KSSL_DEBUG
-	printf(&quot;kssl_check_authent: returns %d for client time &quot;, *atimep);
+	fprintf(stderr,&quot;kssl_check_authent: returns %d for client time &quot;, *atimep);
 	if (auth &amp;&amp; auth-&gt;ctime &amp;&amp; auth-&gt;ctime-&gt;length &amp;&amp; auth-&gt;ctime-&gt;data)
-		printf(&quot;%.*s\n&quot;, auth-&gt;ctime-&gt;length, auth-&gt;ctime-&gt;data);
-	else	printf(&quot;NULL\n&quot;);
+		fprintf(stderr,&quot;%.*s\n&quot;, auth-&gt;ctime-&gt;length, auth-&gt;ctime-&gt;data);
+	else	fprintf(stderr,&quot;NULL\n&quot;);
 #endif	/* KSSL_DEBUG */
 
  err:
diff --git a/ssl/s3_clnt.c b/ssl/s3_clnt.c
index f10e1aa..7a95d5a 100644
--- a/ssl/s3_clnt.c
+++ b/ssl/s3_clnt.c
@@ -1185,9 +1185,9 @@ int ssl3_get_server_certificate(SSL *s)
 	            ? 0 : 1;
 
 #ifdef KSSL_DEBUG
-	printf(&quot;pkey,x = %p, %p\n&quot;, pkey,x);
-	printf(&quot;ssl_cert_type(x,pkey) = %d\n&quot;, ssl_cert_type(x,pkey));
-	printf(&quot;cipher, alg, nc = %s, %lx, %lx, %d\n&quot;, s-&gt;s3-&gt;tmp.new_cipher-&gt;name,
+	fprintf(stderr,&quot;pkey,x = %p, %p\n&quot;, pkey,x);
+	fprintf(stderr,&quot;ssl_cert_type(x,pkey) = %d\n&quot;, ssl_cert_type(x,pkey));
+	fprintf(stderr,&quot;cipher, alg, nc = %s, %lx, %lx, %d\n&quot;, s-&gt;s3-&gt;tmp.new_cipher-&gt;name,
 		s-&gt;s3-&gt;tmp.new_cipher-&gt;algorithm_mkey, s-&gt;s3-&gt;tmp.new_cipher-&gt;algorithm_auth, need_cert);
 #endif    /* KSSL_DEBUG */
 
@@ -2433,7 +2433,7 @@ int ssl3_send_client_key_exchange(SSL *s)
 			EVP_CIPHER_CTX_init(&amp;ciph_ctx);
 
 #ifdef KSSL_DEBUG
-			printf(&quot;ssl3_send_client_key_exchange(%lx &amp; %lx)\n&quot;,
+			fprintf(stderr,&quot;ssl3_send_client_key_exchange(%lx &amp; %lx)\n&quot;,
 				alg_k, SSL_kKRB5);
 #endif	/* KSSL_DEBUG */
 
@@ -2449,9 +2449,9 @@ int ssl3_send_client_key_exchange(SSL *s)
 			    goto err;
 #ifdef KSSL_DEBUG
 			{
-			printf(&quot;kssl_cget_tkt rtn %d\n&quot;, krb5rc);
+			fprintf(stderr,&quot;kssl_cget_tkt rtn %d\n&quot;, krb5rc);
 			if (krb5rc &amp;&amp; kssl_err.text)
-			  printf(&quot;kssl_cget_tkt kssl_err=%s\n&quot;, kssl_err.text);
+			  fprintf(stderr,&quot;kssl_cget_tkt kssl_err=%s\n&quot;, kssl_err.text);
 			}
 #endif	/* KSSL_DEBUG */
 
diff --git a/ssl/s3_lib.c b/ssl/s3_lib.c
index 73852fb..e7cbef4 100644
--- a/ssl/s3_lib.c
+++ b/ssl/s3_lib.c
@@ -3810,17 +3810,17 @@ SSL_CIPHER *ssl3_choose_cipher(SSL *s, STACK_OF(SSL_CIPHER) *clnt,
 #endif
 
 #ifdef CIPHER_DEBUG
-	printf(&quot;Server has %d from %p:\n&quot;, sk_SSL_CIPHER_num(srvr), (void *)srvr);
+	fprintf(stderr, &quot;Server has %d from %p:\n&quot;, sk_SSL_CIPHER_num(srvr), (void *)srvr);
 	for(i=0 ; i &lt; sk_SSL_CIPHER_num(srvr) ; ++i)
 		{
 		c=sk_SSL_CIPHER_value(srvr,i);
-		printf(&quot;%p:%s\n&quot;,(void *)c,c-&gt;name);
+		fprintf(stderr, &quot;%p:%s\n&quot;,(void *)c,c-&gt;name);
 		}
-	printf(&quot;Client sent %d from %p:\n&quot;, sk_SSL_CIPHER_num(clnt), (void *)clnt);
+	fprintf(stderr, &quot;Client sent %d from %p:\n&quot;, sk_SSL_CIPHER_num(clnt), (void *)clnt);
 	for(i=0 ; i &lt; sk_SSL_CIPHER_num(clnt) ; ++i)
 	    {
 	    c=sk_SSL_CIPHER_value(clnt,i);
-	    printf(&quot;%p:%s\n&quot;,(void *)c,c-&gt;name);
+	    fprintf(stderr, &quot;%p:%s\n&quot;,(void *)c,c-&gt;name);
 	    }
 #endif
 
@@ -3860,7 +3860,7 @@ SSL_CIPHER *ssl3_choose_cipher(SSL *s, STACK_OF(SSL_CIPHER) *clnt,
 #endif
 
 #ifdef KSSL_DEBUG
-/*		printf(&quot;ssl3_choose_cipher %d alg= %lx\n&quot;, i,c-&gt;algorithms);*/
+/*		fprintf(stderr,&quot;ssl3_choose_cipher %d alg= %lx\n&quot;, i,c-&gt;algorithms);*/
 #endif    /* KSSL_DEBUG */
 
 		alg_k=c-&gt;algorithm_mkey;
@@ -3883,7 +3883,7 @@ SSL_CIPHER *ssl3_choose_cipher(SSL *s, STACK_OF(SSL_CIPHER) *clnt,
 			{
 			ok = (alg_k &amp; emask_k) &amp;&amp; (alg_a &amp; emask_a);
 #ifdef CIPHER_DEBUG
-			printf(&quot;%d:[%08lX:%08lX:%08lX:%08lX]%p:%s (export)\n&quot;,ok,alg_k,alg_a,emask_k,emask_a,
+			fprintf(stderr, &quot;%d:[%08lX:%08lX:%08lX:%08lX]%p:%s (export)\n&quot;,ok,alg_k,alg_a,emask_k,emask_a,
 			       (void *)c,c-&gt;name);
 #endif
 			}
@@ -3891,7 +3891,7 @@ SSL_CIPHER *ssl3_choose_cipher(SSL *s, STACK_OF(SSL_CIPHER) *clnt,
 			{
 			ok = (alg_k &amp; mask_k) &amp;&amp; (alg_a &amp; mask_a);
 #ifdef CIPHER_DEBUG
-			printf(&quot;%d:[%08lX:%08lX:%08lX:%08lX]%p:%s\n&quot;,ok,alg_k,alg_a,mask_k,mask_a,(void *)c,
+			fprintf(stderr, &quot;%d:[%08lX:%08lX:%08lX:%08lX]%p:%s\n&quot;,ok,alg_k,alg_a,mask_k,mask_a,(void *)c,
 			       c-&gt;name);
 #endif
 			}
diff --git a/ssl/s3_srvr.c b/ssl/s3_srvr.c
index b5b3ecb..ac2cc3d 100644
--- a/ssl/s3_srvr.c
+++ b/ssl/s3_srvr.c
@@ -1156,14 +1156,15 @@ int ssl3_get_client_hello(SSL *s)
 		id=s-&gt;session-&gt;cipher-&gt;id;
 
 #ifdef CIPHER_DEBUG
-		printf(&quot;client sent %d ciphers\n&quot;,sk_num(ciphers));
+		fprintf(stderr,&quot;client sent %d ciphers\n&quot;,sk_SSL_CIPHER_num(ciphers));
 #endif
 		for (i=0; i&lt;sk_SSL_CIPHER_num(ciphers); i++)
 			{
 			c=sk_SSL_CIPHER_value(ciphers,i);
 #ifdef CIPHER_DEBUG
-			printf(&quot;client [%2d of %2d]:%s\n&quot;,
-				i,sk_num(ciphers),SSL_CIPHER_get_name(c));
+			fprintf(stderr,&quot;client [%2d of %2d]:%s\n&quot;,
+				i,sk_SSL_CIPHER_num(ciphers),
+				SSL_CIPHER_get_name(c));
 #endif
 			if (c-&gt;id == id)
 				{
@@ -2484,10 +2485,10 @@ int ssl3_get_client_key_exchange(SSL *s)
 					&amp;kssl_err)) != 0)
 			{
 #ifdef KSSL_DEBUG
-			printf(&quot;kssl_sget_tkt rtn %d [%d]\n&quot;,
+			fprintf(stderr,&quot;kssl_sget_tkt rtn %d [%d]\n&quot;,
 				krb5rc, kssl_err.reason);
 			if (kssl_err.text)
-				printf(&quot;kssl_err text= %s\n&quot;, kssl_err.text);
+				fprintf(stderr,&quot;kssl_err text= %s\n&quot;, kssl_err.text);
 #endif	/* KSSL_DEBUG */
 			SSLerr(SSL_F_SSL3_GET_CLIENT_KEY_EXCHANGE,
 				kssl_err.reason);
@@ -2501,10 +2502,10 @@ int ssl3_get_client_key_exchange(SSL *s)
 					&amp;authtime, &amp;kssl_err)) != 0)
 			{
 #ifdef KSSL_DEBUG
-			printf(&quot;kssl_check_authent rtn %d [%d]\n&quot;,
+			fprintf(stderr,&quot;kssl_check_authent rtn %d [%d]\n&quot;,
 				krb5rc, kssl_err.reason);
 			if (kssl_err.text)
-				printf(&quot;kssl_err text= %s\n&quot;, kssl_err.text);
+				fprintf(stderr,&quot;kssl_err text= %s\n&quot;, kssl_err.text);
 #endif	/* KSSL_DEBUG */
 			SSLerr(SSL_F_SSL3_GET_CLIENT_KEY_EXCHANGE,
 				kssl_err.reason);
diff --git a/ssl/ssl_ciph.c b/ssl/ssl_ciph.c
index 8188ff5..b767361 100644
--- a/ssl/ssl_ciph.c
+++ b/ssl/ssl_ciph.c
@@ -814,7 +814,7 @@ static void ssl_cipher_collect_ciphers(const SSL_METHOD *ssl_method,
 			co_list[co_list_num].active = 0;
 			co_list_num++;
 #ifdef KSSL_DEBUG
-			printf(&quot;\t%d: %s %lx %lx %lx\n&quot;,i,c-&gt;name,c-&gt;id,c-&gt;algorithm_mkey,c-&gt;algorithm_auth);
+			fprintf(stderr,&quot;\t%d: %s %lx %lx %lx\n&quot;,i,c-&gt;name,c-&gt;id,c-&gt;algorithm_mkey,c-&gt;algorithm_auth);
 #endif	/* KSSL_DEBUG */
 			/*
 			if (!sk_push(ca_list,(char *)c)) goto err;
@@ -931,7 +931,7 @@ static void ssl_cipher_apply_rule(unsigned long cipher_id,
 	int reverse = 0;
 
 #ifdef CIPHER_DEBUG
-	printf(&quot;Applying rule %d with %08lx/%08lx/%08lx/%08lx/%08lx %08lx (%d)\n&quot;,
+	fprintf(stderr, &quot;Applying rule %d with %08lx/%08lx/%08lx/%08lx/%08lx %08lx (%d)\n&quot;,
 		rule, alg_mkey, alg_auth, alg_enc, alg_mac, alg_ssl, algo_strength, strength_bits);
 #endif
 
@@ -977,7 +977,7 @@ static void ssl_cipher_apply_rule(unsigned long cipher_id,
 		else
 			{
 #ifdef CIPHER_DEBUG
-			printf(&quot;\nName: %s:\nAlgo = %08lx/%08lx/%08lx/%08lx/%08lx Algo_strength = %08lx\n&quot;, cp-&gt;name, cp-&gt;algorithm_mkey, cp-&gt;algorithm_auth, cp-&gt;algorithm_enc, cp-&gt;algorithm_mac, cp-&gt;algorithm_ssl, cp-&gt;algo_strength);
+			fprintf(stderr, &quot;\nName: %s:\nAlgo = %08lx/%08lx/%08lx/%08lx/%08lx Algo_strength = %08lx\n&quot;, cp-&gt;name, cp-&gt;algorithm_mkey, cp-&gt;algorithm_auth, cp-&gt;algorithm_enc, cp-&gt;algorithm_mac, cp-&gt;algorithm_ssl, cp-&gt;algo_strength);
 #endif
 
 			if (alg_mkey &amp;&amp; !(alg_mkey &amp; cp-&gt;algorithm_mkey))
@@ -997,7 +997,7 @@ static void ssl_cipher_apply_rule(unsigned long cipher_id,
 			}
 
 #ifdef CIPHER_DEBUG
-		printf(&quot;Action = %d\n&quot;, rule);
+		fprintf(stderr, &quot;Action = %d\n&quot;, rule);
 #endif
 
 		/* add the cipher if it has not been added yet. */
@@ -1386,7 +1386,7 @@ STACK_OF(SSL_CIPHER) *ssl_create_cipher_list(const SSL_METHOD *ssl_method,
 	 */
 	num_of_ciphers = ssl_method-&gt;num_ciphers();
 #ifdef KSSL_DEBUG
-	printf(&quot;ssl_create_cipher_list() for %d ciphers\n&quot;, num_of_ciphers);
+	fprintf(stderr,&quot;ssl_create_cipher_list() for %d ciphers\n&quot;, num_of_ciphers);
 #endif    /* KSSL_DEBUG */
 	co_list = (CIPHER_ORDER *)OPENSSL_malloc(sizeof(CIPHER_ORDER) * num_of_ciphers);
 	if (co_list == NULL)
@@ -1513,7 +1513,7 @@ STACK_OF(SSL_CIPHER) *ssl_create_cipher_list(const SSL_METHOD *ssl_method,
 			{
 			sk_SSL_CIPHER_push(cipherstack, curr-&gt;cipher);
 #ifdef CIPHER_DEBUG
-			printf(&quot;&lt;%s&gt;\n&quot;,curr-&gt;cipher-&gt;name);
+			fprintf(stderr, &quot;&lt;%s&gt;\n&quot;,curr-&gt;cipher-&gt;name);
 #endif
 			}
 		}
diff --git a/ssl/ssl_lib.c b/ssl/ssl_lib.c
index 81f976a..2fab2f1 100644
--- a/ssl/ssl_lib.c
+++ b/ssl/ssl_lib.c
@@ -2094,7 +2094,7 @@ void ssl_set_cert_masks(CERT *c, const SSL_CIPHER *cipher)
 	
 
 #ifdef CIPHER_DEBUG
-	printf(&quot;rt=%d rte=%d dht=%d ecdht=%d re=%d ree=%d rs=%d ds=%d dhr=%d dhd=%d\n&quot;,
+	fprintf(stderr,&quot;rt=%d rte=%d dht=%d ecdht=%d re=%d ree=%d rs=%d ds=%d dhr=%d dhd=%d\n&quot;,
 	        rsa_tmp,rsa_tmp_export,dh_tmp,have_ecdh_tmp,
 		rsa_enc,rsa_enc_export,rsa_sign,dsa_sign,dh_rsa,dh_dsa);
 #endif
diff --git a/ssl/t1_enc.c b/ssl/t1_enc.c
index 1923cf3..1308c03 100644
--- a/ssl/t1_enc.c
+++ b/ssl/t1_enc.c
@@ -303,15 +303,15 @@ static int tls1_generate_key_block(SSL *s, unsigned char *km,
 		 s-&gt;session-&gt;master_key,s-&gt;session-&gt;master_key_length,
 		 km,tmp,num);
 #ifdef KSSL_DEBUG
-	printf(&quot;tls1_generate_key_block() ==&gt; %d byte master_key =\n\t&quot;,
+	fprintf(stderr,&quot;tls1_generate_key_block() ==&gt; %d byte master_key =\n\t&quot;,
                 s-&gt;session-&gt;master_key_length);
 	{
         int i;
         for (i=0; i &lt; s-&gt;session-&gt;master_key_length; i++)
                 {
-                printf(&quot;%02X&quot;, s-&gt;session-&gt;master_key[i]);
+                fprintf(stderr,&quot;%02X&quot;, s-&gt;session-&gt;master_key[i]);
                 }
-        printf(&quot;\n&quot;);  }
+        fprintf(stderr,&quot;\n&quot;);  }
 #endif    /* KSSL_DEBUG */
 	return ret;
 	}
@@ -349,19 +349,19 @@ int tls1_change_cipher_state(SSL *s, int which)
 #endif
 
 #ifdef KSSL_DEBUG
-	printf(&quot;tls1_change_cipher_state(which= %d) w/\n&quot;, which);
-	printf(&quot;\talg= %ld/%ld, comp= %p\n&quot;,
+	fprintf(stderr,&quot;tls1_change_cipher_state(which= %d) w/\n&quot;, which);
+	fprintf(stderr,&quot;\talg= %ld/%ld, comp= %p\n&quot;,
 	       s-&gt;s3-&gt;tmp.new_cipher-&gt;algorithm_mkey,
 	       s-&gt;s3-&gt;tmp.new_cipher-&gt;algorithm_auth,
 	       comp);
-	printf(&quot;\tevp_cipher == %p ==? &amp;d_cbc_ede_cipher3\n&quot;, c);
-	printf(&quot;\tevp_cipher: nid, blksz= %d, %d, keylen=%d, ivlen=%d\n&quot;,
+	fprintf(stderr,&quot;\tevp_cipher == %p ==? &amp;d_cbc_ede_cipher3\n&quot;, c);
+	fprintf(stderr,&quot;\tevp_cipher: nid, blksz= %d, %d, keylen=%d, ivlen=%d\n&quot;,
                 c-&gt;nid,c-&gt;block_size,c-&gt;key_len,c-&gt;iv_len);
-	printf(&quot;\tkey_block: len= %d, data= &quot;, s-&gt;s3-&gt;tmp.key_block_length);
+	fprintf(stderr,&quot;\tkey_block: len= %d, data= &quot;, s-&gt;s3-&gt;tmp.key_block_length);
 	{
         int i;
         for (i=0; i&lt;s-&gt;s3-&gt;tmp.key_block_length; i++)
-		printf(&quot;%02x&quot;, s-&gt;s3-&gt;tmp.key_block[i]);  printf(&quot;\n&quot;);
+		fprintf(stderr,&quot;%02x&quot;, s-&gt;s3-&gt;tmp.key_block[i]);  fprintf(stderr,&quot;\n&quot;);
         }
 #endif	/* KSSL_DEBUG */
 
@@ -540,11 +540,11 @@ printf(&quot;which = %04X\nmac key=&quot;,which);
 #ifdef KSSL_DEBUG
 	{
         int i;
-	printf(&quot;EVP_CipherInit_ex(dd,c,key=,iv=,which)\n&quot;);
-	printf(&quot;\tkey= &quot;); for (i=0; i&lt;c-&gt;key_len; i++) printf(&quot;%02x&quot;, key[i]);
-	printf(&quot;\n&quot;);
-	printf(&quot;\t iv= &quot;); for (i=0; i&lt;c-&gt;iv_len; i++) printf(&quot;%02x&quot;, iv[i]);
-	printf(&quot;\n&quot;);
+	fprintf(stderr,&quot;EVP_CipherInit_ex(dd,c,key=,iv=,which)\n&quot;);
+	fprintf(stderr,&quot;\tkey= &quot;); for (i=0; i&lt;c-&gt;key_len; i++) fprintf(stderr,&quot;%02x&quot;, key[i]);
+	fprintf(stderr,&quot;\n&quot;);
+	fprintf(stderr,&quot;\t iv= &quot;); for (i=0; i&lt;c-&gt;iv_len; i++) fprintf(stderr,&quot;%02x&quot;, iv[i]);
+	fprintf(stderr,&quot;\n&quot;);
 	}
 #endif	/* KSSL_DEBUG */
 
@@ -591,7 +591,7 @@ int tls1_setup_key_block(SSL *s)
 	int ret=0;
 
 #ifdef KSSL_DEBUG
-	printf (&quot;tls1_setup_key_block()\n&quot;);
+	fprintf(stderr,&quot;tls1_setup_key_block()\n&quot;);
 #endif	/* KSSL_DEBUG */
 
 	if (s-&gt;s3-&gt;tmp.key_block_length != 0)
@@ -740,7 +740,7 @@ int tls1_enc(SSL *s, int send)
 		}
 
 #ifdef KSSL_DEBUG
-	printf(&quot;tls1_enc(%d)\n&quot;, send);
+	fprintf(stderr,&quot;tls1_enc(%d)\n&quot;, send);
 #endif    /* KSSL_DEBUG */
 
 	if ((s-&gt;session == NULL) || (ds == NULL) || (enc == NULL))
@@ -812,18 +812,18 @@ int tls1_enc(SSL *s, int send)
 #ifdef KSSL_DEBUG
 		{
 		unsigned long ui;
-		printf(&quot;EVP_Cipher(ds=%p,rec-&gt;data=%p,rec-&gt;input=%p,l=%ld) ==&gt;\n&quot;,
+		fprintf(stderr,&quot;EVP_Cipher(ds=%p,rec-&gt;data=%p,rec-&gt;input=%p,l=%ld) ==&gt;\n&quot;,
 			ds,rec-&gt;data,rec-&gt;input,l);
-		printf(&quot;\tEVP_CIPHER_CTX: %d buf_len, %d key_len [%d %d], %d iv_len\n&quot;,
+		fprintf(stderr,&quot;\tEVP_CIPHER_CTX: %d buf_len, %d key_len [%lu %lu], %d iv_len\n&quot;,
 			ds-&gt;buf_len, ds-&gt;cipher-&gt;key_len,
 			DES_KEY_SZ, DES_SCHEDULE_SZ,
 			ds-&gt;cipher-&gt;iv_len);
-		printf(&quot;\t\tIV: &quot;);
-		for (i=0; i&lt;ds-&gt;cipher-&gt;iv_len; i++) printf(&quot;%02X&quot;, ds-&gt;iv[i]);
-		printf(&quot;\n&quot;);
-		printf(&quot;\trec-&gt;input=&quot;);
-		for (ui=0; ui&lt;l; ui++) printf(&quot; %02x&quot;, rec-&gt;input[ui]);
-		printf(&quot;\n&quot;);
+		fprintf(stderr,&quot;\t\tIV: &quot;);
+		for (i=0; i&lt;ds-&gt;cipher-&gt;iv_len; i++) fprintf(stderr,&quot;%02X&quot;, ds-&gt;iv[i]);
+		fprintf(stderr,&quot;\n&quot;);
+		fprintf(stderr,&quot;\trec-&gt;input=&quot;);
+		for (ui=0; ui&lt;l; ui++) fprintf(stderr,&quot; %02x&quot;, rec-&gt;input[ui]);
+		fprintf(stderr,&quot;\n&quot;);
 		}
 #endif	/* KSSL_DEBUG */
 
@@ -848,9 +848,9 @@ int tls1_enc(SSL *s, int send)
 #ifdef KSSL_DEBUG
 		{
 		unsigned long i;
-		printf(&quot;\trec-&gt;data=&quot;);
+		fprintf(stderr,&quot;\trec-&gt;data=&quot;);
 		for (i=0; i&lt;l; i++)
-			printf(&quot; %02x&quot;, rec-&gt;data[i]);  printf(&quot;\n&quot;);
+			fprintf(stderr,&quot; %02x&quot;, rec-&gt;data[i]);  fprintf(stderr,&quot;\n&quot;);
 		}
 #endif	/* KSSL_DEBUG */
 
@@ -1048,10 +1048,10 @@ int tls1_mac(SSL *ssl, unsigned char *md, int send)
 	if (!stream_mac)
 		EVP_MD_CTX_cleanup(&amp;hmac);
 #ifdef TLS_DEBUG
-printf(&quot;seq=&quot;);
-{int z; for (z=0; z&lt;8; z++) printf(&quot;%02X &quot;,seq[z]); printf(&quot;\n&quot;); }
-printf(&quot;rec=&quot;);
-{unsigned int z; for (z=0; z&lt;rec-&gt;length; z++) printf(&quot;%02X &quot;,rec-&gt;data[z]); printf(&quot;\n&quot;); }
+fprintf(stderr,&quot;seq=&quot;);
+{int z; for (z=0; z&lt;8; z++) fprintf(stderr,&quot;%02X &quot;,seq[z]); fprintf(stderr,&quot;\n&quot;); }
+fprintf(stderr,&quot;rec=&quot;);
+{unsigned int z; for (z=0; z&lt;rec-&gt;length; z++) fprintf(stderr,&quot;%02X &quot;,rec-&gt;data[z]); fprintf(stderr,&quot;\n&quot;); }
 #endif
 
 	if (ssl-&gt;version != DTLS1_VERSION &amp;&amp; ssl-&gt;version != DTLS1_BAD_VER)
@@ -1064,7 +1064,7 @@ printf(&quot;rec=&quot;);
 		}
 
 #ifdef TLS_DEBUG
-{unsigned int z; for (z=0; z&lt;md_size; z++) printf(&quot;%02X &quot;,md[z]); printf(&quot;\n&quot;); }
+{unsigned int z; for (z=0; z&lt;md_size; z++) fprintf(stderr,&quot;%02X &quot;,md[z]); fprintf(stderr,&quot;\n&quot;); }
 #endif
 	return(md_size);
 	}
@@ -1078,7 +1078,7 @@ int tls1_generate_master_secret(SSL *s, unsigned char *out, unsigned char *p,
 
 
 #ifdef KSSL_DEBUG
-	printf (&quot;tls1_generate_master_secret(%p,%p, %p, %d)\n&quot;, s,out, p,len);
+	fprintf(stderr,&quot;tls1_generate_master_secret(%p,%p, %p, %d)\n&quot;, s,out, p,len);
 #endif	/* KSSL_DEBUG */
 
 #ifdef TLSEXT_TYPE_opaque_prf_input
@@ -1113,7 +1113,7 @@ int tls1_generate_master_secret(SSL *s, unsigned char *out, unsigned char *p,
 #endif
 
 #ifdef KSSL_DEBUG
-	printf (&quot;tls1_generate_master_secret() complete\n&quot;);
+	fprintf(stderr,&quot;tls1_generate_master_secret() complete\n&quot;);
 #endif	/* KSSL_DEBUG */
 	return(SSL3_MASTER_SECRET_SIZE);
 	}
@@ -1128,7 +1128,7 @@ int tls1_export_keying_material(SSL *s, unsigned char *out, size_t olen,
 	int rv;
 
 #ifdef KSSL_DEBUG
-	printf (&quot;tls1_export_keying_material(%p,%p,%d,%s,%d,%p,%d)\n&quot;, s, out, olen, label, llen, context, contextlen);
+	fprintf(stderr,&quot;tls1_export_keying_material(%p,%p,%lu,%s,%lu,%p,%lu)\n&quot;, s, out, olen, label, llen, context, contextlen);
 #endif	/* KSSL_DEBUG */
 
 	buff = OPENSSL_malloc(olen);
@@ -1191,7 +1191,7 @@ int tls1_export_keying_material(SSL *s, unsigned char *out, size_t olen,
 		      out,buff,olen);
 
 #ifdef KSSL_DEBUG
-	printf (&quot;tls1_export_keying_material() complete\n&quot;);
+	fprintf(stderr,&quot;tls1_export_keying_material() complete\n&quot;);
 #endif	/* KSSL_DEBUG */
 	goto ret;
 err1:


hooks/post-receive
-- 
OpenSSL source code
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000070.html">[openssl-commits] [openssl] OpenSSL source code branch	OpenSSL_1_0_2-stable updated. OpenSSL_1_0_2-beta3-117-g8bc8450
</A></li>
	<LI>Next message: <A HREF="000072.html">[openssl-commits] [openssl] OpenSSL source code branch	OpenSSL_1_0_1-stable updated. OpenSSL_1_0_1j-79-g7e9d42c
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#71">[ date ]</a>
              <a href="thread.html#71">[ thread ]</a>
              <a href="subject.html#71">[ subject ]</a>
              <a href="author.html#71">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://mta.opensslfoundation.net/mailman/listinfo/openssl-commits">More information about the openssl-commits
mailing list</a><br>
</body></html>
