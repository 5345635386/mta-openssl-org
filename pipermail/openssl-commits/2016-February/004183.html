<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2016-February/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1455720382.685986.17591.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004182.html">
   <LINK REL="Next"  HREF="004184.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Rich Salz</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1455720382.685986.17591.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">rsalz at openssl.org
       </A><BR>
    <I>Wed Feb 17 14:46:22 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="004182.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="004184.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4183">[ date ]</a>
              <a href="thread.html#4183">[ thread ]</a>
              <a href="subject.html#4183">[ subject ]</a>
              <a href="author.html#4183">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  dba317774555fbd5bccdfc5270fc486e0d02d9db (commit)
      from  6a78ae2821e89a8838714496524fd39d9d21fb1b (commit)


- Log -----------------------------------------------------------------
commit dba317774555fbd5bccdfc5270fc486e0d02d9db
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at akamai.com</A>&gt;
Date:   Sun Feb 14 00:17:59 2016 -0500

    Remove JPAKE
    
    Reviewed-by: Viktor Dukhovni &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">viktor at openssl.org</A>&gt;

-----------------------------------------------------------------------

Summary of changes:
 CHANGES                      |   3 +
 Configure                    |   5 +-
 apps/apps.c                  | 226 ------------------
 apps/apps.h                  |   4 -
 apps/openssl.c               |   3 -
 apps/s_apps.h                |   3 +-
 apps/s_cb.c                  |  17 +-
 apps/s_client.c              |  31 +--
 apps/s_server.c              |  37 +--
 crypto/err/err_all.c         |   6 -
 crypto/err/openssl.ec        |   1 -
 crypto/jpake/Makefile.in     |  36 ---
 crypto/jpake/build.info      |   3 -
 crypto/jpake/jpake.c         | 543 -------------------------------------------
 crypto/jpake/jpake_err.c     | 107 ---------
 include/openssl/jpake.h      | 128 ----------
 test/Makefile.in             |  10 +-
 test/build.info              |   6 +-
 test/jpaketest.c             | 184 ---------------
 test/recipes/90-test_jpake.t |   5 -
 util/indent.pro              |   7 -
 util/libeay.num              |  21 --
 util/mk1mf.pl                |   3 -
 util/mkdef.pl                |   3 -
 util/mkfiles.pl              |   1 -
 25 files changed, 19 insertions(+), 1374 deletions(-)
 delete mode 100644 crypto/jpake/Makefile.in
 delete mode 100644 crypto/jpake/build.info
 delete mode 100644 crypto/jpake/jpake.c
 delete mode 100644 crypto/jpake/jpake_err.c
 delete mode 100644 include/openssl/jpake.h
 delete mode 100644 test/jpaketest.c
 delete mode 100644 test/recipes/90-test_jpake.t

diff --git a/CHANGES b/CHANGES
index cf7d272..ee1d374 100644
--- a/CHANGES
+++ b/CHANGES
@@ -4,6 +4,9 @@
 
  Changes between 1.0.2f and 1.1.0  [xx XXX xxxx]
 
+  *) Removed JPAKE code.  It was experimental and has no wide use.
+     [Rich Salz]
+
   *) The INSTALL_PREFIX Makefile variable has been renamed to
      DESTDIR.  That makes for less confusion on what this variable
      is for.  Also, the configuration option --install_prefix is
diff --git a/Configure b/Configure
index 0cf893e..bc75363 100755
--- a/Configure
+++ b/Configure
@@ -226,7 +226,7 @@ $config{sdirs} = [
     &quot;bn&quot;, &quot;ec&quot;, &quot;rsa&quot;, &quot;dsa&quot;, &quot;dh&quot;, &quot;dso&quot;, &quot;engine&quot;,
     &quot;buffer&quot;, &quot;bio&quot;, &quot;stack&quot;, &quot;lhash&quot;, &quot;rand&quot;, &quot;err&quot;,
     &quot;evp&quot;, &quot;asn1&quot;, &quot;pem&quot;, &quot;x509&quot;, &quot;x509v3&quot;, &quot;conf&quot;, &quot;txt_db&quot;, &quot;pkcs7&quot;, &quot;pkcs12&quot;, &quot;comp&quot;, &quot;ocsp&quot;, &quot;ui&quot;,
-    &quot;cms&quot;, &quot;ts&quot;, &quot;jpake&quot;, &quot;srp&quot;, &quot;cmac&quot;, &quot;ct&quot;, &quot;async&quot;, &quot;kdf&quot;
+    &quot;cms&quot;, &quot;ts&quot;, &quot;srp&quot;, &quot;cmac&quot;, &quot;ct&quot;, &quot;async&quot;, &quot;kdf&quot;
     ];
 
 # Known TLS and DTLS protocols
@@ -274,7 +274,6 @@ my @disablables = (
     &quot;hmac&quot;,
     &quot;hw(-.+)?&quot;,
     &quot;idea&quot;,
-    &quot;jpake&quot;,
     &quot;locking&quot;,			# Really???
     &quot;md2&quot;,
     &quot;md4&quot;,
@@ -327,7 +326,6 @@ foreach my $proto ((@tls, @dtls))
 my %disabled = ( # &quot;what&quot;         =&gt; &quot;comment&quot; [or special keyword &quot;experimental&quot;]
 		 &quot;ec_nistp_64_gcc_128&quot; =&gt; &quot;default&quot;,
 		 &quot;egd&quot;            =&gt; &quot;default&quot;,
-		 &quot;jpake&quot;          =&gt; &quot;experimental&quot;,
 		 &quot;md2&quot;            =&gt; &quot;default&quot;,
 		 &quot;rc5&quot;            =&gt; &quot;default&quot;,
 		 &quot;sctp&quot;           =&gt; &quot;default&quot;,
@@ -351,7 +349,6 @@ my @disable_cascades = (
     &quot;rijndael&quot;		=&gt; [ &quot;aes&quot; ],
     &quot;des&quot;		=&gt; [ &quot;mdc2&quot; ],
     &quot;ec&quot;		=&gt; [ &quot;ecdsa&quot;, &quot;ecdh&quot; ],
-    &quot;psk&quot;		=&gt; [ &quot;jpake&quot; ],
 
     &quot;dgram&quot;		=&gt; [ &quot;dtls&quot; ],
     &quot;dtls&quot;		=&gt; [ @dtls ],
diff --git a/apps/apps.c b/apps/apps.c
index 2a189f2..1ba8605 100644
--- a/apps/apps.c
+++ b/apps/apps.c
@@ -141,9 +141,6 @@
 # include &lt;openssl/rsa.h&gt;
 #endif
 #include &lt;openssl/bn.h&gt;
-#ifndef OPENSSL_NO_JPAKE
-# include &lt;openssl/jpake.h&gt;
-#endif
 #include &lt;openssl/ssl.h&gt;
 
 #include &quot;apps.h&quot;
@@ -1990,229 +1987,6 @@ void policies_print(X509_STORE_CTX *ctx)
     nodes_print(&quot;User&quot;, X509_policy_tree_get0_user_policies(tree));
 }
 
-#if !defined(OPENSSL_NO_JPAKE) &amp;&amp; !defined(OPENSSL_NO_PSK)
-
-static JPAKE_CTX *jpake_init(const char *us, const char *them,
-                             const char *secret)
-{
-    BIGNUM *p = NULL;
-    BIGNUM *g = NULL;
-    BIGNUM *q = NULL;
-    BIGNUM *bnsecret = BN_new();
-    JPAKE_CTX *ctx;
-
-    /* Use a safe prime for p (that we found earlier) */
-    BN_hex2bn(&amp;p,
-              &quot;F9E5B365665EA7A05A9C534502780FEE6F1AB5BD4F49947FD036DBD7E905269AF46EF28B0FC07487EE4F5D20FB3C0AF8E700F3A2FA3414970CBED44FEDFF80CE78D800F184BB82435D137AADA2C6C16523247930A63B85661D1FC817A51ACD96168E95898A1F83A79FFB529368AA7833ABD1B0C3AEDDB14D2E1A2F71D99F763F&quot;);
-    g = BN_new();
-    BN_set_word(g, 2);
-    q = BN_new();
-    BN_rshift1(q, p);
-
-    BN_bin2bn((const unsigned char *)secret, strlen(secret), bnsecret);
-
-    ctx = JPAKE_CTX_new(us, them, p, g, q, bnsecret);
-    BN_free(bnsecret);
-    BN_free(q);
-    BN_free(g);
-    BN_free(p);
-
-    return ctx;
-}
-
-static void jpake_send_part(BIO *conn, const JPAKE_STEP_PART *p)
-{
-    BN_print(conn, p-&gt;gx);
-    BIO_puts(conn, &quot;\n&quot;);
-    BN_print(conn, p-&gt;zkpx.gr);
-    BIO_puts(conn, &quot;\n&quot;);
-    BN_print(conn, p-&gt;zkpx.b);
-    BIO_puts(conn, &quot;\n&quot;);
-}
-
-static void jpake_send_step1(BIO *bconn, JPAKE_CTX *ctx)
-{
-    JPAKE_STEP1 s1;
-
-    JPAKE_STEP1_init(&amp;s1);
-    JPAKE_STEP1_generate(&amp;s1, ctx);
-    jpake_send_part(bconn, &amp;s1.p1);
-    jpake_send_part(bconn, &amp;s1.p2);
-    (void)BIO_flush(bconn);
-    JPAKE_STEP1_release(&amp;s1);
-}
-
-static void jpake_send_step2(BIO *bconn, JPAKE_CTX *ctx)
-{
-    JPAKE_STEP2 s2;
-
-    JPAKE_STEP2_init(&amp;s2);
-    JPAKE_STEP2_generate(&amp;s2, ctx);
-    jpake_send_part(bconn, &amp;s2);
-    (void)BIO_flush(bconn);
-    JPAKE_STEP2_release(&amp;s2);
-}
-
-static void jpake_send_step3a(BIO *bconn, JPAKE_CTX *ctx)
-{
-    JPAKE_STEP3A s3a;
-
-    JPAKE_STEP3A_init(&amp;s3a);
-    JPAKE_STEP3A_generate(&amp;s3a, ctx);
-    BIO_write(bconn, s3a.hhk, sizeof s3a.hhk);
-    (void)BIO_flush(bconn);
-    JPAKE_STEP3A_release(&amp;s3a);
-}
-
-static void jpake_send_step3b(BIO *bconn, JPAKE_CTX *ctx)
-{
-    JPAKE_STEP3B s3b;
-
-    JPAKE_STEP3B_init(&amp;s3b);
-    JPAKE_STEP3B_generate(&amp;s3b, ctx);
-    BIO_write(bconn, s3b.hk, sizeof s3b.hk);
-    (void)BIO_flush(bconn);
-    JPAKE_STEP3B_release(&amp;s3b);
-}
-
-static void readbn(BIGNUM **bn, BIO *bconn)
-{
-    char buf[10240];
-    int l;
-
-    l = BIO_gets(bconn, buf, sizeof buf);
-    assert(l &gt; 0);
-    assert(buf[l - 1] == '\n');
-    buf[l - 1] = '\0';
-    BN_hex2bn(bn, buf);
-}
-
-static void jpake_receive_part(JPAKE_STEP_PART *p, BIO *bconn)
-{
-    readbn(&amp;p-&gt;gx, bconn);
-    readbn(&amp;p-&gt;zkpx.gr, bconn);
-    readbn(&amp;p-&gt;zkpx.b, bconn);
-}
-
-static void jpake_receive_step1(JPAKE_CTX *ctx, BIO *bconn)
-{
-    JPAKE_STEP1 s1;
-
-    JPAKE_STEP1_init(&amp;s1);
-    jpake_receive_part(&amp;s1.p1, bconn);
-    jpake_receive_part(&amp;s1.p2, bconn);
-    if (!JPAKE_STEP1_process(ctx, &amp;s1)) {
-        ERR_print_errors(bio_err);
-        exit(1);
-    }
-    JPAKE_STEP1_release(&amp;s1);
-}
-
-static void jpake_receive_step2(JPAKE_CTX *ctx, BIO *bconn)
-{
-    JPAKE_STEP2 s2;
-
-    JPAKE_STEP2_init(&amp;s2);
-    jpake_receive_part(&amp;s2, bconn);
-    if (!JPAKE_STEP2_process(ctx, &amp;s2)) {
-        ERR_print_errors(bio_err);
-        exit(1);
-    }
-    JPAKE_STEP2_release(&amp;s2);
-}
-
-static void jpake_receive_step3a(JPAKE_CTX *ctx, BIO *bconn)
-{
-    JPAKE_STEP3A s3a;
-    int l;
-
-    JPAKE_STEP3A_init(&amp;s3a);
-    l = BIO_read(bconn, s3a.hhk, sizeof s3a.hhk);
-    assert(l == sizeof s3a.hhk);
-    if (!JPAKE_STEP3A_process(ctx, &amp;s3a)) {
-        ERR_print_errors(bio_err);
-        exit(1);
-    }
-    JPAKE_STEP3A_release(&amp;s3a);
-}
-
-static void jpake_receive_step3b(JPAKE_CTX *ctx, BIO *bconn)
-{
-    JPAKE_STEP3B s3b;
-    int l;
-
-    JPAKE_STEP3B_init(&amp;s3b);
-    l = BIO_read(bconn, s3b.hk, sizeof s3b.hk);
-    assert(l == sizeof s3b.hk);
-    if (!JPAKE_STEP3B_process(ctx, &amp;s3b)) {
-        ERR_print_errors(bio_err);
-        exit(1);
-    }
-    JPAKE_STEP3B_release(&amp;s3b);
-}
-
-void jpake_client_auth(BIO *out, BIO *conn, const char *secret)
-{
-    JPAKE_CTX *ctx;
-    BIO *bconn;
-
-    BIO_puts(out, &quot;Authenticating with JPAKE\n&quot;);
-
-    ctx = jpake_init(&quot;client&quot;, &quot;server&quot;, secret);
-
-    bconn = BIO_new(BIO_f_buffer());
-    BIO_push(bconn, conn);
-
-    jpake_send_step1(bconn, ctx);
-    jpake_receive_step1(ctx, bconn);
-    jpake_send_step2(bconn, ctx);
-    jpake_receive_step2(ctx, bconn);
-    jpake_send_step3a(bconn, ctx);
-    jpake_receive_step3b(ctx, bconn);
-
-    BIO_puts(out, &quot;JPAKE authentication succeeded, setting PSK\n&quot;);
-
-    OPENSSL_free(psk_key);
-    psk_key = BN_bn2hex(JPAKE_get_shared_key(ctx));
-
-    BIO_pop(bconn);
-    BIO_free(bconn);
-
-    JPAKE_CTX_free(ctx);
-}
-
-void jpake_server_auth(BIO *out, BIO *conn, const char *secret)
-{
-    JPAKE_CTX *ctx;
-    BIO *bconn;
-
-    BIO_puts(out, &quot;Authenticating with JPAKE\n&quot;);
-
-    ctx = jpake_init(&quot;server&quot;, &quot;client&quot;, secret);
-
-    bconn = BIO_new(BIO_f_buffer());
-    BIO_push(bconn, conn);
-
-    jpake_receive_step1(ctx, bconn);
-    jpake_send_step1(bconn, ctx);
-    jpake_receive_step2(ctx, bconn);
-    jpake_send_step2(bconn, ctx);
-    jpake_receive_step3a(ctx, bconn);
-    jpake_send_step3b(bconn, ctx);
-
-    BIO_puts(out, &quot;JPAKE authentication succeeded, setting PSK\n&quot;);
-
-    OPENSSL_free(psk_key);
-    psk_key = BN_bn2hex(JPAKE_get_shared_key(ctx));
-
-    BIO_pop(bconn);
-    BIO_free(bconn);
-
-    JPAKE_CTX_free(ctx);
-}
-
-#endif
-
 /*-
  * next_protos_parse parses a comma separated list of strings into a string
  * in a format suitable for passing to SSL_CTX_set_next_protos_advertised.
diff --git a/apps/apps.h b/apps/apps.h
index 878dc11..8f7ec18 100644
--- a/apps/apps.h
+++ b/apps/apps.h
@@ -571,10 +571,6 @@ int do_X509_CRL_sign(X509_CRL *x, EVP_PKEY *pkey, const EVP_MD *md,
 # ifndef OPENSSL_NO_PSK
 extern char *psk_key;
 # endif
-# ifndef OPENSSL_NO_JPAKE
-void jpake_client_auth(BIO *out, BIO *conn, const char *secret);
-void jpake_server_auth(BIO *out, BIO *conn, const char *secret);
-# endif
 
 unsigned char *next_protos_parse(unsigned short *outlen, const char *in);
 
diff --git a/apps/openssl.c b/apps/openssl.c
index 732cdf1..7783cc4 100644
--- a/apps/openssl.c
+++ b/apps/openssl.c
@@ -757,9 +757,6 @@ static void list_disabled(void)
 #ifdef OPENSSL_NO_IDEA
     BIO_puts(bio_out, &quot;IDEA\n&quot;);
 #endif
-#ifdef OPENSSL_NO_JPAKE
-    BIO_puts(bio_out, &quot;JPAKE\n&quot;);
-#endif
 #ifdef OPENSSL_NO_MD2
     BIO_puts(bio_out, &quot;MD2\n&quot;);
 #endif
diff --git a/apps/s_apps.h b/apps/s_apps.h
index 8e12c21..4357415 100644
--- a/apps/s_apps.h
+++ b/apps/s_apps.h
@@ -195,8 +195,7 @@ int load_excert(SSL_EXCERT **pexc);
 void print_verify_detail(SSL *s, BIO *bio);
 void print_ssl_summary(SSL *s);
 #ifdef HEADER_SSL_H
-int config_ctx(SSL_CONF_CTX *cctx, STACK_OF(OPENSSL_STRING) *str,
-               SSL_CTX *ctx, int no_jpake);
+int config_ctx(SSL_CONF_CTX *cctx, STACK_OF(OPENSSL_STRING) *str, SSL_CTX *ctx);
 int ssl_ctx_add_crls(SSL_CTX *ctx, STACK_OF(X509_CRL) *crls,
                      int crl_download);
 int ssl_load_stores(SSL_CTX *ctx, const char *vfyCApath,
diff --git a/apps/s_cb.c b/apps/s_cb.c
index 30c9147..a463dac 100644
--- a/apps/s_cb.c
+++ b/apps/s_cb.c
@@ -1198,7 +1198,7 @@ void print_ssl_summary(SSL *s)
 }
 
 int config_ctx(SSL_CONF_CTX *cctx, STACK_OF(OPENSSL_STRING) *str,
-               SSL_CTX *ctx, int no_jpake)
+               SSL_CTX *ctx)
 {
     int i;
 
@@ -1206,12 +1206,6 @@ int config_ctx(SSL_CONF_CTX *cctx, STACK_OF(OPENSSL_STRING) *str,
     for (i = 0; i &lt; sk_OPENSSL_STRING_num(str); i += 2) {
         const char *flag = sk_OPENSSL_STRING_value(str, i);
         const char *arg = sk_OPENSSL_STRING_value(str, i + 1);
-#ifndef OPENSSL_NO_JPAKE
-        if (!no_jpake &amp;&amp; (strcmp(flag, &quot;-cipher&quot;) == 0)) {
-            BIO_puts(bio_err, &quot;JPAKE sets cipher to PSK\n&quot;);
-            return 0;
-        }
-#endif
         if (SSL_CONF_cmd(cctx, flag, arg) &lt;= 0) {
             if (arg)
                 BIO_printf(bio_err, &quot;Error with command: \&quot;%s %s\&quot;\n&quot;,
@@ -1222,15 +1216,6 @@ int config_ctx(SSL_CONF_CTX *cctx, STACK_OF(OPENSSL_STRING) *str,
             return 0;
         }
     }
-#ifndef OPENSSL_NO_JPAKE
-    if (!no_jpake) {
-        if (SSL_CONF_cmd(cctx, &quot;-cipher&quot;, &quot;PSK&quot;) &lt;= 0) {
-            BIO_puts(bio_err, &quot;Error setting cipher to PSK\n&quot;);
-            ERR_print_errors(bio_err);
-            return 0;
-        }
-    }
-#endif
     if (!SSL_CONF_CTX_finish(cctx)) {
         BIO_puts(bio_err, &quot;Error finishing context\n&quot;);
         ERR_print_errors(bio_err);
diff --git a/apps/s_client.c b/apps/s_client.c
index 55d1283..e820e7c 100644
--- a/apps/s_client.c
+++ b/apps/s_client.c
@@ -648,7 +648,7 @@ typedef enum OPTION_choice {
     OPT_CERT_CHAIN, OPT_CAPATH, OPT_NOCAPATH, OPT_CHAINCAPATH, OPT_VERIFYCAPATH,
     OPT_KEY, OPT_RECONNECT, OPT_BUILD_CHAIN, OPT_CAFILE, OPT_NOCAFILE,
     OPT_CHAINCAFILE, OPT_VERIFYCAFILE, OPT_NEXTPROTONEG, OPT_ALPN,
-    OPT_SERVERINFO, OPT_STARTTLS, OPT_SERVERNAME, OPT_JPAKE,
+    OPT_SERVERINFO, OPT_STARTTLS, OPT_SERVERNAME,
     OPT_USE_SRTP, OPT_KEYMATEXPORT, OPT_KEYMATEXPORTLEN, OPT_SMTPHOST,
     OPT_ASYNC,
     OPT_V_ENUM,
@@ -780,9 +780,6 @@ OPTIONS s_client_options[] = {
 #ifndef OPENSSL_NO_PSK
     {&quot;psk_identity&quot;, OPT_PSK_IDENTITY, 's', &quot;PSK identity&quot;},
     {&quot;psk&quot;, OPT_PSK, 's', &quot;PSK in hex (without 0x)&quot;},
-# ifndef OPENSSL_NO_JPAKE
-    {&quot;jpake&quot;, OPT_JPAKE, 's', &quot;JPAKE secret to use&quot;},
-# endif
 #endif
 #ifndef OPENSSL_NO_SRP
     {&quot;srpuser&quot;, OPT_SRPUSER, 's', &quot;SRP authentification for 'user'&quot;},
@@ -853,7 +850,7 @@ int s_client_main(int argc, char **argv)
     char *inrand = NULL;
     char *passarg = NULL, *pass = NULL, *vfyCApath = NULL, *vfyCAfile = NULL;
     char *sess_in = NULL, *sess_out = NULL, *crl_file = NULL, *p;
-    char *jpake_secret = NULL, *xmpphost = NULL;
+    char *xmpphost = NULL;
     const char *ehlo = &quot;mail.example.com&quot;;
     struct sockaddr peer;
     struct timeval timeout, *timeoutp;
@@ -1316,11 +1313,6 @@ int s_client_main(int argc, char **argv)
         case OPT_SERVERNAME:
             servername = opt_arg();
             break;
-        case OPT_JPAKE:
-#ifndef OPENSSL_NO_JPAKE
-            jpake_secret = opt_arg();
-#endif
-            break;
         case OPT_USE_SRTP:
             srtp_profiles = opt_arg();
             break;
@@ -1378,15 +1370,6 @@ int s_client_main(int argc, char **argv)
                    &quot;Can't use unix sockets and datagrams together\n&quot;);
         goto end;
     }
-#if !defined(OPENSSL_NO_JPAKE) &amp;&amp; !defined(OPENSSL_NO_PSK)
-    if (jpake_secret) {
-        if (psk_key) {
-            BIO_printf(bio_err, &quot;Can't use JPAKE and PSK together\n&quot;);
-            goto end;
-        }
-        psk_identity = &quot;JPAKE&quot;;
-    }
-#endif
 
 #if !defined(OPENSSL_NO_NEXTPROTONEG)
     next_proto.status = -1;
@@ -1506,7 +1489,7 @@ int s_client_main(int argc, char **argv)
         SSL_CTX_set_mode(ctx, SSL_MODE_ASYNC);
     }
 
-    if (!config_ctx(cctx, ssl_args, ctx, jpake_secret == NULL))
+    if (!config_ctx(cctx, ssl_args, ctx))
         goto end;
 
     if (!ssl_load_stores(ctx, vfyCApath, vfyCAfile, chCApath, chCAfile,
@@ -1528,10 +1511,10 @@ int s_client_main(int argc, char **argv)
 #endif
 
 #ifndef OPENSSL_NO_PSK
-    if (psk_key != NULL || jpake_secret) {
+    if (psk_key != NULL) {
         if (c_debug)
             BIO_printf(bio_c_out,
-                       &quot;PSK key given or JPAKE in use, setting client callback\n&quot;);
+                       &quot;PSK key given, setting client callback\n&quot;);
         SSL_CTX_set_psk_client_callback(ctx, psk_client_cb);
     }
 #endif
@@ -1774,10 +1757,6 @@ int s_client_main(int argc, char **argv)
         SSL_CTX_set_tlsext_status_cb(ctx, ocsp_resp_cb);
         SSL_CTX_set_tlsext_status_arg(ctx, bio_c_out);
     }
-#ifndef OPENSSL_NO_JPAKE
-    if (jpake_secret)
-        jpake_client_auth(bio_c_out, sbio, jpake_secret);
-#endif
 
     SSL_set_bio(con, sbio, sbio);
     SSL_set_connect_state(con);
diff --git a/apps/s_server.c b/apps/s_server.c
index 3803036..3c5b422 100644
--- a/apps/s_server.c
+++ b/apps/s_server.c
@@ -785,7 +785,6 @@ static int not_resumable_sess_cb(SSL *s, int is_forward_secure)
     return is_forward_secure;
 }
 
-static char *jpake_secret = NULL;
 #ifndef OPENSSL_NO_SRP
 static srpsrvparm srp_callback_parm;
 #endif
@@ -814,7 +813,7 @@ typedef enum OPTION_choice {
     OPT_TLS1_2, OPT_TLS1_1, OPT_TLS1, OPT_DTLS, OPT_DTLS1,
     OPT_DTLS1_2, OPT_TIMEOUT, OPT_MTU, OPT_CHAIN, OPT_LISTEN,
     OPT_ID_PREFIX, OPT_RAND, OPT_SERVERNAME, OPT_SERVERNAME_FATAL,
-    OPT_CERT2, OPT_KEY2, OPT_NEXTPROTONEG, OPT_ALPN, OPT_JPAKE,
+    OPT_CERT2, OPT_KEY2, OPT_NEXTPROTONEG, OPT_ALPN,
     OPT_SRTP_PROFILES, OPT_KEYMATEXPORT, OPT_KEYMATEXPORTLEN,
     OPT_S_ENUM,
     OPT_V_ENUM,
@@ -952,9 +951,6 @@ OPTIONS s_server_options[] = {
 #ifndef OPENSSL_NO_PSK
     {&quot;psk_hint&quot;, OPT_PSK_HINT, 's', &quot;PSK identity hint to use&quot;},
     {&quot;psk&quot;, OPT_PSK, 's', &quot;PSK in hex (without 0x)&quot;},
-# ifndef OPENSSL_NO_JPAKE
-    {&quot;jpake&quot;, OPT_JPAKE, 's', &quot;JPAKE secret to use&quot;},
-# endif
 #endif
 #ifndef OPENSSL_NO_SRP
     {&quot;srpvfile&quot;, OPT_SRPVFILE, '&lt;', &quot;The verifier file for SRP&quot;},
@@ -1501,14 +1497,6 @@ int s_server_main(int argc, char *argv[])
         case OPT_ALPN:
             alpn_in = opt_arg();
             break;
-#if !defined(OPENSSL_NO_JPAKE) &amp;&amp; !defined(OPENSSL_NO_PSK)
-        case OPT_JPAKE:
-            jpake_secret = opt_arg();
-            break;
-#else
-        case OPT_JPAKE:
-            goto opthelp;
-#endif
         case OPT_SRTP_PROFILES:
             srtp_profiles = opt_arg();
             break;
@@ -1545,15 +1533,6 @@ int s_server_main(int argc, char *argv[])
         goto end;
     }
 #endif
-#if !defined(OPENSSL_NO_JPAKE) &amp;&amp; !defined(OPENSSL_NO_PSK)
-    if (jpake_secret) {
-        if (psk_key) {
-            BIO_printf(bio_err, &quot;Can't use JPAKE and PSK together\n&quot;);
-            goto end;
-        }
-        psk_identity = &quot;JPAKE&quot;;
-    }
-#endif
 
     if (!app_passwd(passarg, dpassarg, &amp;pass, &amp;dpass)) {
         BIO_printf(bio_err, &quot;Error getting password\n&quot;);
@@ -1768,7 +1747,7 @@ int s_server_main(int argc, char *argv[])
     }
 
     ssl_ctx_add_crls(ctx, crls, 0);
-    if (!config_ctx(cctx, ssl_args, ctx, jpake_secret == NULL))
+    if (!config_ctx(cctx, ssl_args, ctx))
         goto end;
 
     if (!ssl_load_stores(ctx, vfyCApath, vfyCAfile, chCApath, chCAfile,
@@ -1831,7 +1810,7 @@ int s_server_main(int argc, char *argv[])
         }
 
         ssl_ctx_add_crls(ctx2, crls, 0);
-        if (!config_ctx(cctx, ssl_args, ctx2, jpake_secret == NULL))
+        if (!config_ctx(cctx, ssl_args, ctx2))
             goto end;
     }
 #ifndef OPENSSL_NO_NEXTPROTONEG
@@ -1917,15 +1896,11 @@ int s_server_main(int argc, char *argv[])
                                                        not_resumable_sess_cb);
     }
 #ifndef OPENSSL_NO_PSK
-# ifdef OPENSSL_NO_JPAKE
     if (psk_key != NULL)
-# else
-    if (psk_key != NULL || jpake_secret)
-# endif
     {
         if (s_debug)
             BIO_printf(bio_s_out,
-                       &quot;PSK key given or JPAKE in use, setting server callback\n&quot;);
+                       &quot;PSK key given, setting server callback\n&quot;);
         SSL_CTX_set_psk_server_callback(ctx, psk_server_cb);
     }
 
@@ -2175,10 +2150,6 @@ static int sv_body(const char *hostname, int s, int stype,
         test = BIO_new(BIO_f_nbio_test());
         sbio = BIO_push(test, sbio);
     }
-#ifndef OPENSSL_NO_JPAKE
-    if (jpake_secret)
-        jpake_server_auth(bio_s_out, sbio, jpake_secret);
-#endif
 
     SSL_set_bio(con, sbio, sbio);
     SSL_set_accept_state(con);
diff --git a/crypto/err/err_all.c b/crypto/err/err_all.c
index ffb1b83..4932587 100644
--- a/crypto/err/err_all.c
+++ b/crypto/err/err_all.c
@@ -98,9 +98,6 @@
 #ifndef OPENSSL_NO_CMS
 # include &lt;openssl/cms.h&gt;
 #endif
-#ifndef OPENSSL_NO_JPAKE
-# include &lt;openssl/jpake.h&gt;
-#endif
 #include &lt;internal/ct_int.h&gt;
 #include &lt;openssl/async.h&gt;
 
@@ -154,9 +151,6 @@ void err_load_crypto_strings_intern(void)
 # ifndef OPENSSL_NO_CMS
     ERR_load_CMS_strings();
 # endif
-# ifndef OPENSSL_NO_JPAKE
-    ERR_load_JPAKE_strings();
-# endif
 # ifndef OPENSSL_NO_CT
     ERR_load_CT_strings();
 # endif
diff --git a/crypto/err/openssl.ec b/crypto/err/openssl.ec
index 1c6e96d..88d7be5 100644
--- a/crypto/err/openssl.ec
+++ b/crypto/err/openssl.ec
@@ -32,7 +32,6 @@ L STORE		include/openssl/store.h		crypto/store/str_err.c
 L TS		include/openssl/ts.h		crypto/ts/ts_err.c
 L HMAC		include/openssl/hmac.h		crypto/hmac/hmac_err.c
 L CMS		include/openssl/cms.h		crypto/cms/cms_err.c
-L JPAKE		include/openssl/jpake.h		crypto/jpake/jpake_err.c
 L FIPS		include/openssl/fips.h		crypto/fips_err.h
 L ASYNC		include/openssl/async.h		crypto/async/async_err.c
 
diff --git a/crypto/jpake/Makefile.in b/crypto/jpake/Makefile.in
deleted file mode 100644
index 9a75fae..0000000
--- a/crypto/jpake/Makefile.in
+++ /dev/null
@@ -1,36 +0,0 @@
-DIR=jpake
-TOP=../..
-
-CFLAGS= $(INCLUDES) $(CFLAG)
-
-GENERAL= Makefile
-
-LIB=$(TOP)/libcrypto.a
-LIBOBJ=jpake.o jpake_err.o
-LIBSRC=jpake.c jpake_err.c
-SRC= $(LIBSRC)
-
-HEADER=
-
-ALL= $(GENERAL) $(SRC) $(HEADER)
-
-top:
-	(cd ../..; $(MAKE) DIRS=crypto SDIRS=$(DIR) sub_all)
-
-all:	lib
-
-lib:	$(LIBOBJ)
-	$(AR) $(LIB) $(LIBOBJ)
-	$(RANLIB) $(LIB) || echo Never mind.
-	@touch lib
-
-files:
-	$(PERL) $(TOP)/util/files.pl Makefile &gt;&gt; $(TOP)/MINFO
-
-depend:
-	$(TOP)/util/domd $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(PROGS) $(LIBSRC)
-
-clean:
-	rm -f *.s *.o *.obj des lib tags core .pure .nfs* *.old *.bak fluff
-
-# DO NOT DELETE THIS LINE -- make depend depends on it.
diff --git a/crypto/jpake/build.info b/crypto/jpake/build.info
deleted file mode 100644
index 7dfcf24..0000000
--- a/crypto/jpake/build.info
+++ /dev/null
@@ -1,3 +0,0 @@
-LIBS=../../libcrypto
-SOURCE[../../libcrypto]=\
-        jpake.c jpake_err.c
diff --git a/crypto/jpake/jpake.c b/crypto/jpake/jpake.c
deleted file mode 100644
index abbcb89..0000000
--- a/crypto/jpake/jpake.c
+++ /dev/null
@@ -1,543 +0,0 @@
-#include &lt;openssl/jpake.h&gt;
-#include &lt;openssl/crypto.h&gt;
-#include &lt;openssl/sha.h&gt;
-#include &lt;openssl/err.h&gt;
-#include &lt;memory.h&gt;
-#include &lt;string.h&gt;
-
-/*
- * In the definition, (xa, xb, xc, xd) are Alice's (x1, x2, x3, x4) or
- * Bob's (x3, x4, x1, x2). If you see what I mean.
- */
-
-typedef struct {
-    char *name;                 /* Must be unique */
-    char *peer_name;
-    BIGNUM *p;
-    BIGNUM *g;
-    BIGNUM *q;
-    BIGNUM *gxc;                /* Alice's g^{x3} or Bob's g^{x1} */
-    BIGNUM *gxd;                /* Alice's g^{x4} or Bob's g^{x2} */
-} JPAKE_CTX_PUBLIC;
-
-struct JPAKE_CTX {
-    JPAKE_CTX_PUBLIC p;
-    BIGNUM *secret;             /* The shared secret */
-    BN_CTX *ctx;
-    BIGNUM *xa;                 /* Alice's x1 or Bob's x3 */
-    BIGNUM *xb;                 /* Alice's x2 or Bob's x4 */
-    BIGNUM *key;                /* The calculated (shared) key */
-};
-
-static void JPAKE_ZKP_init(JPAKE_ZKP *zkp)
-{
-    zkp-&gt;gr = BN_new();
-    zkp-&gt;b = BN_new();
-}
-
-static void JPAKE_ZKP_release(JPAKE_ZKP *zkp)
-{
-    BN_free(zkp-&gt;b);
-    BN_free(zkp-&gt;gr);
-}
-
-/* Two birds with one stone - make the global name as expected */
-#define JPAKE_STEP_PART_init    JPAKE_STEP2_init
-#define JPAKE_STEP_PART_release JPAKE_STEP2_release
-
-void JPAKE_STEP_PART_init(JPAKE_STEP_PART *p)
-{
-    p-&gt;gx = BN_new();
-    JPAKE_ZKP_init(&amp;p-&gt;zkpx);
-}
-
-void JPAKE_STEP_PART_release(JPAKE_STEP_PART *p)
-{
-    JPAKE_ZKP_release(&amp;p-&gt;zkpx);
-    BN_free(p-&gt;gx);
-}
-
-void JPAKE_STEP1_init(JPAKE_STEP1 *s1)
-{
-    JPAKE_STEP_PART_init(&amp;s1-&gt;p1);
-    JPAKE_STEP_PART_init(&amp;s1-&gt;p2);
-}
-
-void JPAKE_STEP1_release(JPAKE_STEP1 *s1)
-{
-    JPAKE_STEP_PART_release(&amp;s1-&gt;p2);
-    JPAKE_STEP_PART_release(&amp;s1-&gt;p1);
-}
-
-static void JPAKE_CTX_init(JPAKE_CTX *ctx, const char *name,
-                           const char *peer_name, const BIGNUM *p,
-                           const BIGNUM *g, const BIGNUM *q,
-                           const BIGNUM *secret)
-{
-    ctx-&gt;p.name = OPENSSL_strdup(name);
-    ctx-&gt;p.peer_name = OPENSSL_strdup(peer_name);
-    ctx-&gt;p.p = BN_dup(p);
-    ctx-&gt;p.g = BN_dup(g);
-    ctx-&gt;p.q = BN_dup(q);
-    ctx-&gt;secret = BN_dup(secret);
-
-    ctx-&gt;p.gxc = BN_new();
-    ctx-&gt;p.gxd = BN_new();
-
-    ctx-&gt;xa = BN_new();
-    ctx-&gt;xb = BN_new();
-    ctx-&gt;key = BN_new();
-    ctx-&gt;ctx = BN_CTX_new();
-}
-
-static void JPAKE_CTX_release(JPAKE_CTX *ctx)
-{
-    BN_CTX_free(ctx-&gt;ctx);
-    BN_clear_free(ctx-&gt;key);
-    BN_clear_free(ctx-&gt;xb);
-    BN_clear_free(ctx-&gt;xa);
-
-    BN_free(ctx-&gt;p.gxd);
-    BN_free(ctx-&gt;p.gxc);
-
-    BN_clear_free(ctx-&gt;secret);
-    BN_free(ctx-&gt;p.q);
-    BN_free(ctx-&gt;p.g);
-    BN_free(ctx-&gt;p.p);
-    OPENSSL_free(ctx-&gt;p.peer_name);
-    OPENSSL_free(ctx-&gt;p.name);
-
-    memset(ctx, 0, sizeof(*ctx));
-}
-
-JPAKE_CTX *JPAKE_CTX_new(const char *name, const char *peer_name,
-                         const BIGNUM *p, const BIGNUM *g, const BIGNUM *q,
-                         const BIGNUM *secret)
-{
-    JPAKE_CTX *ctx = OPENSSL_malloc(sizeof(*ctx));
-    if (ctx == NULL)
-        return NULL;
-
-    JPAKE_CTX_init(ctx, name, peer_name, p, g, q, secret);
-
-    return ctx;
-}
-
-void JPAKE_CTX_free(JPAKE_CTX *ctx)
-{
-    if (!ctx)
-        return;
-    JPAKE_CTX_release(ctx);
-    OPENSSL_free(ctx);
-}
-
-static void hashlength(SHA_CTX *sha, size_t l)
-{
-    unsigned char b[2];
-
-    OPENSSL_assert(l &lt;= 0xffff);
-    b[0] = l &gt;&gt; 8;
-    b[1] = l &amp; 0xff;
-    SHA1_Update(sha, b, 2);
-}
-
-static void hashstring(SHA_CTX *sha, const char *string)
-{
-    size_t l = strlen(string);
-
-    hashlength(sha, l);
-    SHA1_Update(sha, string, l);
-}
-
-static int hashbn(SHA_CTX *sha, const BIGNUM *bn)
-{
-    size_t l = BN_num_bytes(bn);
-    unsigned char *bin = OPENSSL_malloc(l);
-
-    if (bin == NULL)
-        return 0;
-
-    hashlength(sha, l);
-    BN_bn2bin(bn, bin);
-    SHA1_Update(sha, bin, l);
-    OPENSSL_free(bin);
-    return 1;
-}
-
-/* h=hash(g, g^r, g^x, name) */
-static int zkp_hash(BIGNUM *h, const BIGNUM *zkpg, const JPAKE_STEP_PART *p,
-                    const char *proof_name)
-{
-    unsigned char md[SHA_DIGEST_LENGTH];
-    SHA_CTX sha;
-
-    /*
-     * XXX: hash should not allow moving of the boundaries - Java code
-     * is flawed in this respect. Length encoding seems simplest.
-     */
-    SHA1_Init(&amp;sha);
-    if (!hashbn(&amp;sha, zkpg))
-        return 0;
-    OPENSSL_assert(!BN_is_zero(p-&gt;zkpx.gr));
-    if (!hashbn(&amp;sha, p-&gt;zkpx.gr))
-        return 0;
-    if (!hashbn(&amp;sha, p-&gt;gx))
-        return 0;
-    hashstring(&amp;sha, proof_name);
-    SHA1_Final(md, &amp;sha);
-    BN_bin2bn(md, SHA_DIGEST_LENGTH, h);
-    return 1;
-}
-
-/*
- * Prove knowledge of x
- * Note that p-&gt;gx has already been calculated
- */
-static int generate_zkp(JPAKE_STEP_PART *p, const BIGNUM *x,
-                        const BIGNUM *zkpg, JPAKE_CTX *ctx)
-{
-    int res = 0;
-    BIGNUM *r = BN_new();
-    BIGNUM *h = BN_new();
-    BIGNUM *t = BN_new();
-
-    if (r == NULL || h == NULL || t == NULL)
-        goto end;
-
-   /*-
-    * r in [0,q)
-    * XXX: Java chooses r in [0, 2^160) - i.e. distribution not uniform
-    */
-    BN_rand_range(r, ctx-&gt;p.q);
-    /* g^r */
-    BN_mod_exp(p-&gt;zkpx.gr, zkpg, r, ctx-&gt;p.p, ctx-&gt;ctx);
-
-    /* h=hash... */
-    if (!zkp_hash(h, zkpg, p, ctx-&gt;p.name))
-        goto end;
-
-    /* b = r - x*h */
-    BN_mod_mul(t, x, h, ctx-&gt;p.q, ctx-&gt;ctx);
-    BN_mod_sub(p-&gt;zkpx.b, r, t, ctx-&gt;p.q, ctx-&gt;ctx);
-
-    res = 1;
- end:
-    /* cleanup */
-    BN_free(t);
-    BN_free(h);
-    BN_free(r);
-    return res;
-}
-
-static int verify_zkp(const JPAKE_STEP_PART *p, const BIGNUM *zkpg,
-                      JPAKE_CTX *ctx)
-{
-    BIGNUM *h = BN_new();
-    BIGNUM *t1 = BN_new();
-    BIGNUM *t2 = BN_new();
-    BIGNUM *t3 = BN_new();
-    int ret = 0;
-
-    if (h == NULL || t1 == NULL || t2 == NULL || t3 == NULL)
-        goto end;
-
-    if (!zkp_hash(h, zkpg, p, ctx-&gt;p.peer_name))
-        goto end;
-
-    /* t1 = g^b */
-    BN_mod_exp(t1, zkpg, p-&gt;zkpx.b, ctx-&gt;p.p, ctx-&gt;ctx);
-    /* t2 = (g^x)^h = g^{hx} */
-    BN_mod_exp(t2, p-&gt;gx, h, ctx-&gt;p.p, ctx-&gt;ctx);
-    /* t3 = t1 * t2 = g^{hx} * g^b = g^{hx+b} = g^r (allegedly) */
-    BN_mod_mul(t3, t1, t2, ctx-&gt;p.p, ctx-&gt;ctx);
-
-    /* verify t3 == g^r */
-    if (BN_cmp(t3, p-&gt;zkpx.gr) == 0)
-        ret = 1;
-    else
-        JPAKEerr(JPAKE_F_VERIFY_ZKP, JPAKE_R_ZKP_VERIFY_FAILED);
-
- end:
-    /* cleanup */
-    BN_free(t3);
-    BN_free(t2);
-    BN_free(t1);
-    BN_free(h);
-
-    return ret;
-}
-
-static int generate_step_part(JPAKE_STEP_PART *p, const BIGNUM *x,
-                              const BIGNUM *g, JPAKE_CTX *ctx)
-{
-    BN_mod_exp(p-&gt;gx, g, x, ctx-&gt;p.p, ctx-&gt;ctx);
-    if (!generate_zkp(p, x, g, ctx))
-        return 0;
-    return 1;
-}
-
-/* Generate each party's random numbers. xa is in [0, q), xb is in [1, q). */
-static void genrand(JPAKE_CTX *ctx)
-{
-    BIGNUM *qm1;
-
-    /* xa in [0, q) */
-    BN_rand_range(ctx-&gt;xa, ctx-&gt;p.q);
-
-    /* q-1 */
-    qm1 = BN_new();
-    BN_copy(qm1, ctx-&gt;p.q);
-    BN_sub_word(qm1, 1);
-
-    /* ... and xb in [0, q-1) */
-    BN_rand_range(ctx-&gt;xb, qm1);
-    /* [1, q) */
-    BN_add_word(ctx-&gt;xb, 1);
-
-    /* cleanup */
-    BN_free(qm1);
-}
-
-int JPAKE_STEP1_generate(JPAKE_STEP1 *send, JPAKE_CTX *ctx)
-{
-    genrand(ctx);
-    if (!generate_step_part(&amp;send-&gt;p1, ctx-&gt;xa, ctx-&gt;p.g, ctx))
-        return 0;
-    if (!generate_step_part(&amp;send-&gt;p2, ctx-&gt;xb, ctx-&gt;p.g, ctx))
-        return 0;
-
-    return 1;
-}
-
-/* g^x is a legal value */
-static int is_legal(const BIGNUM *gx, const JPAKE_CTX *ctx)
-{
-    BIGNUM *t;
-    int res;
-
-    if (BN_is_negative(gx) || BN_is_zero(gx) || BN_cmp(gx, ctx-&gt;p.p) &gt;= 0)
-        return 0;
-
-    t = BN_new();
-    BN_mod_exp(t, gx, ctx-&gt;p.q, ctx-&gt;p.p, ctx-&gt;ctx);
-    res = BN_is_one(t);
-    BN_free(t);
-
-    return res;
-}
-
-int JPAKE_STEP1_process(JPAKE_CTX *ctx, const JPAKE_STEP1 *received)
-{
-    if (!is_legal(received-&gt;p1.gx, ctx)) {
-        JPAKEerr(JPAKE_F_JPAKE_STEP1_PROCESS,
-                 JPAKE_R_G_TO_THE_X3_IS_NOT_LEGAL);
-        return 0;
-    }
-
-    if (!is_legal(received-&gt;p2.gx, ctx)) {
-        JPAKEerr(JPAKE_F_JPAKE_STEP1_PROCESS,
-                 JPAKE_R_G_TO_THE_X4_IS_NOT_LEGAL);
-        return 0;
-    }
-
-    /* verify their ZKP(xc) */
-    if (!verify_zkp(&amp;received-&gt;p1, ctx-&gt;p.g, ctx)) {
-        JPAKEerr(JPAKE_F_JPAKE_STEP1_PROCESS, JPAKE_R_VERIFY_X3_FAILED);
-        return 0;
-    }
-
-    /* verify their ZKP(xd) */
-    if (!verify_zkp(&amp;received-&gt;p2, ctx-&gt;p.g, ctx)) {
-        JPAKEerr(JPAKE_F_JPAKE_STEP1_PROCESS, JPAKE_R_VERIFY_X4_FAILED);
-        return 0;
-    }
-
-    /* g^xd != 1 */
-    if (BN_is_one(received-&gt;p2.gx)) {
-        JPAKEerr(JPAKE_F_JPAKE_STEP1_PROCESS, JPAKE_R_G_TO_THE_X4_IS_ONE);
-        return 0;
-    }
-
-    /* Save the bits we need for later */
-    BN_copy(ctx-&gt;p.gxc, received-&gt;p1.gx);
-    BN_copy(ctx-&gt;p.gxd, received-&gt;p2.gx);
-
-    return 1;
-}
-
-int JPAKE_STEP2_generate(JPAKE_STEP2 *send, JPAKE_CTX *ctx)
-{
-    int ret;
-
-    BIGNUM *t1 = BN_new();
-    BIGNUM *t2 = BN_new();
-
-   /*-
-    * X = g^{(xa + xc + xd) * xb * s}
-    * t1 = g^xa
-    */
-    BN_mod_exp(t1, ctx-&gt;p.g, ctx-&gt;xa, ctx-&gt;p.p, ctx-&gt;ctx);
-    /* t2 = t1 * g^{xc} = g^{xa} * g^{xc} = g^{xa + xc} */
-    BN_mod_mul(t2, t1, ctx-&gt;p.gxc, ctx-&gt;p.p, ctx-&gt;ctx);
-    /* t1 = t2 * g^{xd} = g^{xa + xc + xd} */
-    BN_mod_mul(t1, t2, ctx-&gt;p.gxd, ctx-&gt;p.p, ctx-&gt;ctx);
-    /* t2 = xb * s */
-    BN_mod_mul(t2, ctx-&gt;xb, ctx-&gt;secret, ctx-&gt;p.q, ctx-&gt;ctx);
-
-   /*-
-    * ZKP(xb * s)
-    * XXX: this is kinda funky, because we're using
-    *
-    * g' = g^{xa + xc + xd}
-    *
-    * as the generator, which means X is g'^{xb * s}
-    * X = t1^{t2} = t1^{xb * s} = g^{(xa + xc + xd) * xb * s}
-    */
-    ret = generate_step_part(send, t2, t1, ctx);
-
-    /* cleanup */
-    BN_free(t1);
-    BN_free(t2);
-
-    return ret;
-}
-
-/* gx = g^{xc + xa + xb} * xd * s */
-static int compute_key(JPAKE_CTX *ctx, const BIGNUM *gx)
-{
-    BIGNUM *t1 = BN_new();
-    BIGNUM *t2 = BN_new();
-    BIGNUM *t3 = BN_new();
-
-   /*-
-    * K = (gx/g^{xb * xd * s})^{xb}
-    *   = (g^{(xc + xa + xb) * xd * s - xb * xd *s})^{xb}
-    *   = (g^{(xa + xc) * xd * s})^{xb}
-    *   = g^{(xa + xc) * xb * xd * s}
-    * [which is the same regardless of who calculates it]
-    */
-
-    /* t1 = (g^{xd})^{xb} = g^{xb * xd} */
-    BN_mod_exp(t1, ctx-&gt;p.gxd, ctx-&gt;xb, ctx-&gt;p.p, ctx-&gt;ctx);
-    /* t2 = -s = q-s */
-    BN_sub(t2, ctx-&gt;p.q, ctx-&gt;secret);
-    /* t3 = t1^t2 = g^{-xb * xd * s} */
-    BN_mod_exp(t3, t1, t2, ctx-&gt;p.p, ctx-&gt;ctx);
-    /* t1 = gx * t3 = X/g^{xb * xd * s} */
-    BN_mod_mul(t1, gx, t3, ctx-&gt;p.p, ctx-&gt;ctx);
-    /* K = t1^{xb} */
-    BN_mod_exp(ctx-&gt;key, t1, ctx-&gt;xb, ctx-&gt;p.p, ctx-&gt;ctx);
-
-    /* cleanup */
-    BN_free(t3);
-    BN_free(t2);
-    BN_free(t1);
-
-    return 1;
-}
-
-int JPAKE_STEP2_process(JPAKE_CTX *ctx, const JPAKE_STEP2 *received)
-{
-    BIGNUM *t1 = BN_new();
-    BIGNUM *t2 = BN_new();
-    int ret = 0;
-
-   /*-
-    * g' = g^{xc + xa + xb} [from our POV]
-    * t1 = xa + xb
-    */
-    BN_mod_add(t1, ctx-&gt;xa, ctx-&gt;xb, ctx-&gt;p.q, ctx-&gt;ctx);
-    /* t2 = g^{t1} = g^{xa+xb} */
-    BN_mod_exp(t2, ctx-&gt;p.g, t1, ctx-&gt;p.p, ctx-&gt;ctx);
-    /* t1 = g^{xc} * t2 = g^{xc + xa + xb} */
-    BN_mod_mul(t1, ctx-&gt;p.gxc, t2, ctx-&gt;p.p, ctx-&gt;ctx);
-
-    if (verify_zkp(received, t1, ctx))
-        ret = 1;
-    else
-        JPAKEerr(JPAKE_F_JPAKE_STEP2_PROCESS, JPAKE_R_VERIFY_B_FAILED);
-
-    compute_key(ctx, received-&gt;gx);
-
-    /* cleanup */
-    BN_free(t2);
-    BN_free(t1);
-
-    return ret;
-}
-
-static int quickhashbn(unsigned char *md, const BIGNUM *bn)
-{
-    SHA_CTX sha;
-
-    SHA1_Init(&amp;sha);
-    if (!hashbn(&amp;sha, bn))
-        return 0;
-    SHA1_Final(md, &amp;sha);
-    return 1;
-}
-
-void JPAKE_STEP3A_init(JPAKE_STEP3A *s3a)
-{
-}
-
-int JPAKE_STEP3A_generate(JPAKE_STEP3A *send, JPAKE_CTX *ctx)
-{
-    if (!quickhashbn(send-&gt;hhk, ctx-&gt;key))
-        return 0;
-    SHA1(send-&gt;hhk, sizeof send-&gt;hhk, send-&gt;hhk);
-
-    return 1;
-}
-
-int JPAKE_STEP3A_process(JPAKE_CTX *ctx, const JPAKE_STEP3A *received)
-{
-    unsigned char hhk[SHA_DIGEST_LENGTH];
-
-    if (!quickhashbn(hhk, ctx-&gt;key))
-        return 0;
-    SHA1(hhk, sizeof hhk, hhk);
-    if (memcmp(hhk, received-&gt;hhk, sizeof hhk)) {
-        JPAKEerr(JPAKE_F_JPAKE_STEP3A_PROCESS,
-                 JPAKE_R_HASH_OF_HASH_OF_KEY_MISMATCH);
-        return 0;
-    }
-    return 1;
-}
-
-void JPAKE_STEP3A_release(JPAKE_STEP3A *s3a)
-{
-}
-
-void JPAKE_STEP3B_init(JPAKE_STEP3B *s3b)
-{
-}
-
-int JPAKE_STEP3B_generate(JPAKE_STEP3B *send, JPAKE_CTX *ctx)
-{
-    if (!quickhashbn(send-&gt;hk, ctx-&gt;key))
-        return 0;
-    return 1;
-}
-
-int JPAKE_STEP3B_process(JPAKE_CTX *ctx, const JPAKE_STEP3B *received)
-{
-    unsigned char hk[SHA_DIGEST_LENGTH];
-
-    if (!quickhashbn(hk, ctx-&gt;key))
-        return 0;
-    if (memcmp(hk, received-&gt;hk, sizeof hk)) {
-        JPAKEerr(JPAKE_F_JPAKE_STEP3B_PROCESS, JPAKE_R_HASH_OF_KEY_MISMATCH);
-        return 0;
-    }
-    return 1;
-}
-
-void JPAKE_STEP3B_release(JPAKE_STEP3B *s3b)
-{
-}
-
-const BIGNUM *JPAKE_get_shared_key(JPAKE_CTX *ctx)
-{
-    return ctx-&gt;key;
-}
diff --git a/crypto/jpake/jpake_err.c b/crypto/jpake/jpake_err.c
deleted file mode 100644
index d45f86c..0000000
--- a/crypto/jpake/jpake_err.c
+++ /dev/null
@@ -1,107 +0,0 @@
-/* ====================================================================
- * Copyright (c) 1999-2015 The OpenSSL Project.  All rights reserved.
- *
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- *
- * 1. Redistributions of source code must retain the above copyright
- *    notice, this list of conditions and the following disclaimer.
- *
- * 2. Redistributions in binary form must reproduce the above copyright
- *    notice, this list of conditions and the following disclaimer in
- *    the documentation and/or other materials provided with the
- *    distribution.
- *
- * 3. All advertising materials mentioning features or use of this
- *    software must display the following acknowledgment:
- *    &quot;This product includes software developed by the OpenSSL Project
- *    for use in the OpenSSL Toolkit. (<A HREF="http://www.OpenSSL.org/">http://www.OpenSSL.org/</A>)&quot;
- *
- * 4. The names &quot;OpenSSL Toolkit&quot; and &quot;OpenSSL Project&quot; must not be used to
- *    endorse or promote products derived from this software without
- *    prior written permission. For written permission, please contact
- *    <A HREF="../../../mailman/listinfo/openssl-commits.html">openssl-core at OpenSSL.org.</A>
- *
- * 5. Products derived from this software may not be called &quot;OpenSSL&quot;
- *    nor may &quot;OpenSSL&quot; appear in their names without prior written
- *    permission of the OpenSSL Project.
- *
- * 6. Redistributions of any form whatsoever must retain the following
- *    acknowledgment:
- *    &quot;This product includes software developed by the OpenSSL Project
- *    for use in the OpenSSL Toolkit (<A HREF="http://www.OpenSSL.org/">http://www.OpenSSL.org/</A>)&quot;
- *
- * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
- * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
- * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
- * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
- * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
- * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
- * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
- * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
- * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
- * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
- * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
- * OF THE POSSIBILITY OF SUCH DAMAGE.
- * ====================================================================
- *
- * This product includes cryptographic software written by Eric Young
- * (<A HREF="../../../mailman/listinfo/openssl-commits.html">eay at cryptsoft.com</A>).  This product includes software written by Tim
- * Hudson (<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at cryptsoft.com</A>).
- *
- */
-
-/*
- * NOTE: this file was auto generated by the mkerr.pl script: any changes
- * made to it will be overwritten when the script next updates this file,
- * only reason strings will be preserved.
- */
-
-#include &lt;stdio.h&gt;
-#include &lt;openssl/err.h&gt;
-#include &lt;openssl/jpake.h&gt;
-
-/* BEGIN ERROR CODES */
-#ifndef OPENSSL_NO_ERR
-
-# define ERR_FUNC(func) ERR_PACK(ERR_LIB_JPAKE,func,0)
-# define ERR_REASON(reason) ERR_PACK(ERR_LIB_JPAKE,0,reason)
-
-static ERR_STRING_DATA JPAKE_str_functs[] = {
-    {ERR_FUNC(JPAKE_F_JPAKE_STEP1_PROCESS), &quot;JPAKE_STEP1_process&quot;},
-    {ERR_FUNC(JPAKE_F_JPAKE_STEP2_PROCESS), &quot;JPAKE_STEP2_process&quot;},
-    {ERR_FUNC(JPAKE_F_JPAKE_STEP3A_PROCESS), &quot;JPAKE_STEP3A_process&quot;},
-    {ERR_FUNC(JPAKE_F_JPAKE_STEP3B_PROCESS), &quot;JPAKE_STEP3B_process&quot;},
-    {ERR_FUNC(JPAKE_F_VERIFY_ZKP), &quot;verify_zkp&quot;},
-    {0, NULL}
-};
-
-static ERR_STRING_DATA JPAKE_str_reasons[] = {
-    {ERR_REASON(JPAKE_R_G_TO_THE_X3_IS_NOT_LEGAL),
-     &quot;g to the x3 is not legal&quot;},
-    {ERR_REASON(JPAKE_R_G_TO_THE_X4_IS_NOT_LEGAL),
-     &quot;g to the x4 is not legal&quot;},
-    {ERR_REASON(JPAKE_R_G_TO_THE_X4_IS_ONE), &quot;g to the x4 is one&quot;},
-    {ERR_REASON(JPAKE_R_HASH_OF_HASH_OF_KEY_MISMATCH),
-     &quot;hash of hash of key mismatch&quot;},
-    {ERR_REASON(JPAKE_R_HASH_OF_KEY_MISMATCH), &quot;hash of key mismatch&quot;},
-    {ERR_REASON(JPAKE_R_VERIFY_B_FAILED), &quot;verify b failed&quot;},
-    {ERR_REASON(JPAKE_R_VERIFY_X3_FAILED), &quot;verify x3 failed&quot;},
-    {ERR_REASON(JPAKE_R_VERIFY_X4_FAILED), &quot;verify x4 failed&quot;},
-    {ERR_REASON(JPAKE_R_ZKP_VERIFY_FAILED), &quot;zkp verify failed&quot;},
-    {0, NULL}
-};
-
-#endif
-
-void ERR_load_JPAKE_strings(void)
-{
-#ifndef OPENSSL_NO_ERR
-
-    if (ERR_func_error_string(JPAKE_str_functs[0].error) == NULL) {
-        ERR_load_strings(0, JPAKE_str_functs);
-        ERR_load_strings(0, JPAKE_str_reasons);
-    }
-#endif
-}
diff --git a/include/openssl/jpake.h b/include/openssl/jpake.h
deleted file mode 100644
index 371eed6..0000000
--- a/include/openssl/jpake.h
+++ /dev/null
@@ -1,128 +0,0 @@
-/*
- * Implement J-PAKE, as described in
- * <A HREF="http://grouper.ieee.org/groups/1363/Research/contributions/hao-ryan-2008.pdf">http://grouper.ieee.org/groups/1363/Research/contributions/hao-ryan-2008.pdf</A>
- *
- * With hints from <A HREF="http://www.cl.cam.ac.uk/~fh240/software/JPAKE2.java.">http://www.cl.cam.ac.uk/~fh240/software/JPAKE2.java.</A>
- */
-
-#ifndef HEADER_JPAKE_H
-# define HEADER_JPAKE_H
-
-# include &lt;openssl/opensslconf.h&gt;
-
-# ifdef OPENSSL_NO_JPAKE
-#  error JPAKE is disabled.
-# endif
-
-#ifdef  __cplusplus
-extern &quot;C&quot; {
-#endif
-
-# include &lt;openssl/bn.h&gt;
-# include &lt;openssl/sha.h&gt;
-
-typedef struct JPAKE_CTX JPAKE_CTX;
-
-/* Note that &quot;g&quot; in the ZKPs is not necessarily the J-PAKE g. */
-typedef struct {
-    BIGNUM *gr;                 /* g^r (r random) */
-    BIGNUM *b;                  /* b = r - x*h, h=hash(g, g^r, g^x, name) */
-} JPAKE_ZKP;
-
-typedef struct {
-    BIGNUM *gx;                 /* g^x in step 1, g^(xa + xc + xd) * xb * s
-                                 * in step 2 */
-    JPAKE_ZKP zkpx;             /* ZKP(x) or ZKP(xb * s) */
-} JPAKE_STEP_PART;
-
-typedef struct {
-    JPAKE_STEP_PART p1;         /* g^x3, ZKP(x3) or g^x1, ZKP(x1) */
-    JPAKE_STEP_PART p2;         /* g^x4, ZKP(x4) or g^x2, ZKP(x2) */
-} JPAKE_STEP1;
-
-typedef JPAKE_STEP_PART JPAKE_STEP2;
-
-typedef struct {
-    unsigned char hhk[SHA_DIGEST_LENGTH];
-} JPAKE_STEP3A;
-
-typedef struct {
-    unsigned char hk[SHA_DIGEST_LENGTH];
-} JPAKE_STEP3B;
-
-/* Parameters are copied */
-JPAKE_CTX *JPAKE_CTX_new(const char *name, const char *peer_name,
-                         const BIGNUM *p, const BIGNUM *g, const BIGNUM *q,
-                         const BIGNUM *secret);
-void JPAKE_CTX_free(JPAKE_CTX *ctx);
-
-/*
- * Note that JPAKE_STEP1 can be used multiple times before release
- * without another init.
- */
-void JPAKE_STEP1_init(JPAKE_STEP1 *s1);
-int JPAKE_STEP1_generate(JPAKE_STEP1 *send, JPAKE_CTX *ctx);
-int JPAKE_STEP1_process(JPAKE_CTX *ctx, const JPAKE_STEP1 *received);
-void JPAKE_STEP1_release(JPAKE_STEP1 *s1);
-
-/*
- * Note that JPAKE_STEP2 can be used multiple times before release
- * without another init.
- */
-void JPAKE_STEP2_init(JPAKE_STEP2 *s2);
-int JPAKE_STEP2_generate(JPAKE_STEP2 *send, JPAKE_CTX *ctx);
-int JPAKE_STEP2_process(JPAKE_CTX *ctx, const JPAKE_STEP2 *received);
-void JPAKE_STEP2_release(JPAKE_STEP2 *s2);
-
-/*
- * Optionally verify the shared key. If the shared secrets do not
- * match, the two ends will disagree about the shared key, but
- * otherwise the protocol will succeed.
- */
-void JPAKE_STEP3A_init(JPAKE_STEP3A *s3a);
-int JPAKE_STEP3A_generate(JPAKE_STEP3A *send, JPAKE_CTX *ctx);
-int JPAKE_STEP3A_process(JPAKE_CTX *ctx, const JPAKE_STEP3A *received);
-void JPAKE_STEP3A_release(JPAKE_STEP3A *s3a);
-
-void JPAKE_STEP3B_init(JPAKE_STEP3B *s3b);
-int JPAKE_STEP3B_generate(JPAKE_STEP3B *send, JPAKE_CTX *ctx);
-int JPAKE_STEP3B_process(JPAKE_CTX *ctx, const JPAKE_STEP3B *received);
-void JPAKE_STEP3B_release(JPAKE_STEP3B *s3b);
-
-/*
- * the return value belongs to the library and will be released when
- * ctx is released, and will change when a new handshake is performed.
- */
-const BIGNUM *JPAKE_get_shared_key(JPAKE_CTX *ctx);
-
-/* BEGIN ERROR CODES */
-/*
- * The following lines are auto generated by the script mkerr.pl. Any changes
- * made after this point may be overwritten when the script is next run.
- */
-void ERR_load_JPAKE_strings(void);
-
-/* Error codes for the JPAKE functions. */
-
-/* Function codes. */
-# define JPAKE_F_JPAKE_STEP1_PROCESS                      101
-# define JPAKE_F_JPAKE_STEP2_PROCESS                      102
-# define JPAKE_F_JPAKE_STEP3A_PROCESS                     103
-# define JPAKE_F_JPAKE_STEP3B_PROCESS                     104
-# define JPAKE_F_VERIFY_ZKP                               100
-
-/* Reason codes. */
-# define JPAKE_R_G_TO_THE_X3_IS_NOT_LEGAL                 108
-# define JPAKE_R_G_TO_THE_X4_IS_NOT_LEGAL                 109
-# define JPAKE_R_G_TO_THE_X4_IS_ONE                       105
-# define JPAKE_R_HASH_OF_HASH_OF_KEY_MISMATCH             106
-# define JPAKE_R_HASH_OF_KEY_MISMATCH                     107
-# define JPAKE_R_VERIFY_B_FAILED                          102
-# define JPAKE_R_VERIFY_X3_FAILED                         103
-# define JPAKE_R_VERIFY_X4_FAILED                         104
-# define JPAKE_R_ZKP_VERIFY_FAILED                        100
-
-#ifdef  __cplusplus
-}
-#endif
-#endif
diff --git a/test/Makefile.in b/test/Makefile.in
index 5a1839f..0a75304 100644
--- a/test/Makefile.in
+++ b/test/Makefile.in
@@ -67,7 +67,6 @@ EVPTEST=	evp_test
 EVPEXTRATEST=evp_extra_test
 P5_CRPT2_TEST=	p5_crpt2_test
 IGETEST=	igetest
-JPAKETEST=	jpaketest
 SECMEMTEST=	secmemtest
 SRPTEST=	srptest
 V3NAMETEST=	v3nametest
@@ -98,7 +97,7 @@ EXE=	$(NPTEST)$(EXE_EXT) $(MEMLEAKTEST)$(EXE_EXT) \
 	$(BFTEST)$(EXE_EXT) $(CASTTEST)$(EXE_EXT) $(SSLTEST)$(EXE_EXT) \
 	$(EXPTEST)$(EXE_EXT) $(DSATEST)$(EXE_EXT) $(RSATEST)$(EXE_EXT) \
 	$(EVPTEST)$(EXE_EXT) $(EVPEXTRATEST)$(EXE_EXT) $(IGETEST)$(EXE_EXT) \
-	$(JPAKETEST)$(EXE_EXT) $(SECMEMTEST)$(EXE_EXT) \
+	$(SECMEMTEST)$(EXE_EXT) \
 	$(SRPTEST)$(EXE_EXT) $(V3NAMETEST)$(EXE_EXT) \
 	$(HEARTBEATTEST)$(EXE_EXT) $(P5_CRPT2_TEST)$(EXE_EXT) \
 	$(CONSTTIMETEST)$(EXE_EXT) $(VERIFYEXTRATEST)$(EXE_EXT) \
@@ -117,7 +116,7 @@ OBJ=	$(NPTEST).o $(MEMLEAKTEST).o \
 	$(MDC2TEST).o $(RMDTEST).o $(DANETEST).o \
 	$(RANDTEST).o $(DHTEST).o $(ENGINETEST).o $(CASTTEST).o \
 	$(BFTEST).o  $(SSLTEST).o  $(DSATEST).o  $(EXPTEST).o $(RSATEST).o \
-	$(EVPTEST).o $(EVPEXTRATEST).o $(IGETEST).o $(JPAKETEST).o $(V3NAMETEST).o \
+	$(EVPTEST).o $(EVPEXTRATEST).o $(IGETEST).o $(V3NAMETEST).o \
 	$(HEARTBEATTEST).o $(P5_CRPT2_TEST).o \
 	$(CONSTTIMETEST).o $(VERIFYEXTRATEST).o $(CLIENTHELLOTEST).o \
 	$(PACKETTEST).o $(ASYNCTEST).o $(DTLSV1LISTENTEST).o testutil.o
@@ -131,7 +130,7 @@ SRC=	$(NPTEST).c $(MEMLEAKTEST).c \
 	$(DESTEST).c $(SHA1TEST).c $(MDC2TEST).c $(RMDTEST).c \
 	$(RANDTEST).c $(DHTEST).c $(ENGINETEST).c $(CASTTEST).c \
 	$(BFTEST).c  $(SSLTEST).c $(DSATEST).c   $(EXPTEST).c $(RSATEST).c \
-	$(EVPTEST).c $(EVPEXTRATEST).c $(IGETEST).c $(JPAKETEST).c $(V3NAMETEST).c \
+	$(EVPTEST).c $(EVPEXTRATEST).c $(IGETEST).c $(V3NAMETEST).c \
 	$(HEARTBEATTEST).c $(P5_CRPT2_TEST).c \
 	$(CONSTTIMETEST).c $(VERIFYEXTRATEST).c $(CLIENTHELLOTEST).c \
 	$(PACKETTEST).c $(ASYNCTEST).c $(DTLSV1LISTENTEST).c testutil.c
@@ -340,9 +339,6 @@ $(ECDHTEST)$(EXE_EXT): $(ECDHTEST).o $(DLIBCRYPTO)
 $(IGETEST)$(EXE_EXT): $(IGETEST).o $(DLIBCRYPTO)
 	@target=$(IGETEST); $(BUILD_CMD)
 
-$(JPAKETEST)$(EXE_EXT): $(JPAKETEST).o $(DLIBCRYPTO)
-	@target=$(JPAKETEST); $(BUILD_CMD)
-
 $(SECMEMTEST)$(EXE_EXT): $(SECMEMTEST).o $(DLIBCRYPTO)
 	@target=$(SECMEMTEST); $(BUILD_CMD)
 
diff --git a/test/build.info b/test/build.info
index a321692..39b052f 100644
--- a/test/build.info
+++ b/test/build.info
@@ -9,7 +9,7 @@ PROGRAMS=\
         mdc2test rmdtest \
         randtest dhtest enginetest casttest \
         bftest ssltest dsatest exptest rsa_test \
-        evp_test evp_extra_test igetest jpaketest v3nametest \
+        evp_test evp_extra_test igetest v3nametest \
         danetest heartbeat_test p5_crpt2_test \
         constant_time_test verify_extra_test clienthellotest \
         packettest asynctest secmemtest srptest memleaktest \
@@ -151,10 +151,6 @@ SOURCE[igetest]=igetest.c
 INCLUDE[igetest]={- rel2abs(catdir($builddir,&quot;../include&quot;)) -} .. ../include
 DEPEND[igetest]=../libcrypto
 
-SOURCE[jpaketest]=jpaketest.c
-INCLUDE[jpaketest]={- rel2abs(catdir($builddir,&quot;../include&quot;)) -} ../include
-DEPEND[jpaketest]=../libcrypto
-
 SOURCE[v3nametest]=v3nametest.c
 INCLUDE[v3nametest]={- rel2abs(catdir($builddir,&quot;../include&quot;)) -} ../include
 DEPEND[v3nametest]=../libcrypto
diff --git a/test/jpaketest.c b/test/jpaketest.c
deleted file mode 100644
index 2b61705..0000000
--- a/test/jpaketest.c
+++ /dev/null
@@ -1,184 +0,0 @@
-#include &lt;openssl/opensslconf.h&gt;
-
-#ifdef OPENSSL_NO_JPAKE
-
-# include &lt;stdio.h&gt;
-
-int main(int argc, char *argv[])
-{
-    printf(&quot;No J-PAKE support\n&quot;);
-    return (0);
-}
-
-#else
-
-# include &lt;openssl/jpake.h&gt;
-# include &lt;openssl/err.h&gt;
-
-static void showbn(const char *name, const BIGNUM *bn)
-{
-    fputs(name, stdout);
-    fputs(&quot; = &quot;, stdout);
-    BN_print_fp(stdout, bn);
-    putc('\n', stdout);
-}
-
-static int run_jpake(JPAKE_CTX *alice, JPAKE_CTX *bob)
-{
-    JPAKE_STEP1 alice_s1;
-    JPAKE_STEP1 bob_s1;
-    JPAKE_STEP2 alice_s2;
-    JPAKE_STEP2 bob_s2;
-    JPAKE_STEP3A alice_s3a;
-    JPAKE_STEP3B bob_s3b;
-
-    /* Alice -&gt; Bob: step 1 */
-    puts(&quot;A-&gt;B s1&quot;);
-    JPAKE_STEP1_init(&amp;alice_s1);
-    JPAKE_STEP1_generate(&amp;alice_s1, alice);
-    if (!JPAKE_STEP1_process(bob, &amp;alice_s1)) {
-        printf(&quot;Bob fails to process Alice's step 1\n&quot;);
-        ERR_print_errors_fp(stdout);
-        return 1;
-    }
-    JPAKE_STEP1_release(&amp;alice_s1);
-
-    /* Bob -&gt; Alice: step 1 */
-    puts(&quot;B-&gt;A s1&quot;);
-    JPAKE_STEP1_init(&amp;bob_s1);
-    JPAKE_STEP1_generate(&amp;bob_s1, bob);
-    if (!JPAKE_STEP1_process(alice, &amp;bob_s1)) {
-        printf(&quot;Alice fails to process Bob's step 1\n&quot;);
-        ERR_print_errors_fp(stdout);
-        return 2;
-    }
-    JPAKE_STEP1_release(&amp;bob_s1);
-
-    /* Alice -&gt; Bob: step 2 */
-    puts(&quot;A-&gt;B s2&quot;);
-    JPAKE_STEP2_init(&amp;alice_s2);
-    JPAKE_STEP2_generate(&amp;alice_s2, alice);
-    if (!JPAKE_STEP2_process(bob, &amp;alice_s2)) {
-        printf(&quot;Bob fails to process Alice's step 2\n&quot;);
-        ERR_print_errors_fp(stdout);
-        return 3;
-    }
-    JPAKE_STEP2_release(&amp;alice_s2);
-
-    /* Bob -&gt; Alice: step 2 */
-    puts(&quot;B-&gt;A s2&quot;);
-    JPAKE_STEP2_init(&amp;bob_s2);
-    JPAKE_STEP2_generate(&amp;bob_s2, bob);
-    if (!JPAKE_STEP2_process(alice, &amp;bob_s2)) {
-        printf(&quot;Alice fails to process Bob's step 2\n&quot;);
-        ERR_print_errors_fp(stdout);
-        return 4;
-    }
-    JPAKE_STEP2_release(&amp;bob_s2);
-
-    showbn(&quot;Alice's key&quot;, JPAKE_get_shared_key(alice));
-    showbn(&quot;Bob's key  &quot;, JPAKE_get_shared_key(bob));
-
-    /* Alice -&gt; Bob: step 3a */
-    puts(&quot;A-&gt;B s3a&quot;);
-    JPAKE_STEP3A_init(&amp;alice_s3a);
-    JPAKE_STEP3A_generate(&amp;alice_s3a, alice);
-    if (!JPAKE_STEP3A_process(bob, &amp;alice_s3a)) {
-        printf(&quot;Bob fails to process Alice's step 3a\n&quot;);
-        ERR_print_errors_fp(stdout);
-        return 5;
-    }
-    JPAKE_STEP3A_release(&amp;alice_s3a);
-
-    /* Bob -&gt; Alice: step 3b */
-    puts(&quot;B-&gt;A s3b&quot;);
-    JPAKE_STEP3B_init(&amp;bob_s3b);
-    JPAKE_STEP3B_generate(&amp;bob_s3b, bob);
-    if (!JPAKE_STEP3B_process(alice, &amp;bob_s3b)) {
-        printf(&quot;Alice fails to process Bob's step 3b\n&quot;);
-        ERR_print_errors_fp(stdout);
-        return 6;
-    }
-    JPAKE_STEP3B_release(&amp;bob_s3b);
-
-    return 0;
-}
-
-int main(int argc, char **argv)
-{
-    JPAKE_CTX *alice;
-    JPAKE_CTX *bob;
-    BIGNUM *p = NULL;
-    BIGNUM *g = NULL;
-    BIGNUM *q = NULL;
-    BIGNUM *secret = BN_new();
-#ifndef OPENSSL_NO_CRYPTO_MDEBUG
-    BIO *bio_err;
-
-    bio_err = BIO_new_fp(stderr, BIO_NOCLOSE | BIO_FP_TEXT);
-
-    CRYPTO_set_mem_debug(1);
-    CRYPTO_mem_ctrl(CRYPTO_MEM_CHECK_ON);
-#endif
-
-    /*-
-    BN_hex2bn(&amp;p, &quot;fd7f53811d75122952df4a9c2eece4e7f611b7523cef4400c31e3f80b6512669455d402251fb593d8d58fabfc5f5ba30f6cb9b556cd7813b801d346ff26660b76b9950a5a49f9fe8047b1022c24fbba9d7feb7c61bf83b57e7c6a8a6150f04fb83f6d3c51ec3023554135a169132f675f3ae2b61d72aeff22203199dd14801c7&quot;);
-    BN_hex2bn(&amp;g, &quot;f7e1a085d69b3ddecbbcab5c36b857b97994afbbfa3aea82f9574c0b3d0782675159578ebad4594fe67107108180b449167123e84c281613b7cf09328cc8a6e13c167a8b547c8d28e0a3ae1e2bb3a675916ea37f0bfa213562f1fb627a01243bcca4f1bea8519089a883dfe15ae59f06928b665e807b552564014c3bfecf492a&quot;);
-    BN_hex2bn(&amp;q, &quot;9760508f15230bccb292b982a2eb840bf0581cf5&quot;);
-    */
-    /*-
-    p = BN_new();
-    BN_generate_prime(p, 1024, 1, NULL, NULL, NULL, NULL);
-    */
-    /* Use a safe prime for p (that we found earlier) */
-    BN_hex2bn(&amp;p,
-              &quot;F9E5B365665EA7A05A9C534502780FEE6F1AB5BD4F49947FD036DBD7E905269AF46EF28B0FC07487EE4F5D20FB3C0AF8E700F3A2FA3414970CBED44FEDFF80CE78D800F184BB82435D137AADA2C6C16523247930A63B85661D1FC817A51ACD96168E95898A1F83A79FFB529368AA7833ABD1B0C3AEDDB14D2E1A2F71D99F763F&quot;);
-    showbn(&quot;p&quot;, p);
-    g = BN_new();
-    BN_set_word(g, 2);
-    showbn(&quot;g&quot;, g);
-    q = BN_new();
-    BN_rshift1(q, p);
-    showbn(&quot;q&quot;, q);
-
-    BN_rand(secret, 32, -1, 0);
-
-    /* A normal run, expect this to work... */
-    alice = JPAKE_CTX_new(&quot;Alice&quot;, &quot;Bob&quot;, p, g, q, secret);
-    bob = JPAKE_CTX_new(&quot;Bob&quot;, &quot;Alice&quot;, p, g, q, secret);
-
-    if (run_jpake(alice, bob) != 0) {
-        fprintf(stderr, &quot;Plain JPAKE run failed\n&quot;);
-        return 1;
-    }
-
-    JPAKE_CTX_free(bob);
-    JPAKE_CTX_free(alice);
-
-    /* Now give Alice and Bob different secrets */
-    alice = JPAKE_CTX_new(&quot;Alice&quot;, &quot;Bob&quot;, p, g, q, secret);
-    BN_add_word(secret, 1);
-    bob = JPAKE_CTX_new(&quot;Bob&quot;, &quot;Alice&quot;, p, g, q, secret);
-
-    if (run_jpake(alice, bob) != 5) {
-        fprintf(stderr, &quot;Mismatched secret JPAKE run failed\n&quot;);
-        return 1;
-    }
-
-    JPAKE_CTX_free(bob);
-    JPAKE_CTX_free(alice);
-
-    BN_free(secret);
-    BN_free(q);
-    BN_free(g);
-    BN_free(p);
-
-#ifndef OPENSSL_NO_CRYPTO_MDEBUG
-    if (CRYPTO_mem_leaks(bio_err) &lt;= 0)
-        return 1;
-#endif
-
-    return 0;
-}
-
-#endif
diff --git a/test/recipes/90-test_jpake.t b/test/recipes/90-test_jpake.t
deleted file mode 100644
index 519bf1e..0000000
--- a/test/recipes/90-test_jpake.t
+++ /dev/null
@@ -1,5 +0,0 @@
-#! /usr/bin/perl
-
-use OpenSSL::Test::Simple;
-
-simple_test(&quot;test_jpake&quot;, &quot;jpaketest&quot;, &quot;jpake&quot;);
diff --git a/util/indent.pro b/util/indent.pro
index abfccc7..b7958e3 100644
--- a/util/indent.pro
+++ b/util/indent.pro
@@ -297,13 +297,6 @@
 -T IPAddressOrRange
 -T IPAddressOrRanges
 -T ISSUING_DIST_POINT
--T JPAKE_CTX
--T JPAKE_STEP1
--T JPAKE_STEP2
--T JPAKE_STEP3A
--T JPAKE_STEP3B
--T JPAKE_STEP_PART
--T JPAKE_ZKP
 -T KEY_TABLE_TYPE
 -T LHASH
 -T LHASH_COMP_FN_TYPE
diff --git a/util/libeay.num b/util/libeay.num
index 4d50324..ca8e9ec 100755
--- a/util/libeay.num
+++ b/util/libeay.num
@@ -3616,27 +3616,6 @@ CRYPTO_dbg_remove_all_info              4090	1_1_0	NOEXIST::FUNCTION:
 OPENSSL_init                            4091	1_1_0	EXIST::FUNCTION:
 private_Camellia_set_key                4092	1_1_0	NOEXIST::FUNCTION:
 CRYPTO_strdup                           4093	1_1_0	EXIST::FUNCTION:
-JPAKE_STEP3A_process                    4094	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP1_release                     4095	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_get_shared_key                    4096	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP3B_init                       4097	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP1_generate                    4098	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP1_init                        4099	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP3B_process                    4100	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP2_generate                    4101	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_CTX_new                           4102	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_CTX_free                          4103	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP3B_release                    4104	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP3A_release                    4105	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP2_process                     4106	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP3B_generate                   4107	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP1_process                     4108	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP3A_generate                   4109	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP2_release                     4110	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP3A_init                       4111	1_1_0	EXIST::FUNCTION:JPAKE
-ERR_load_JPAKE_strings                  4112	1_1_0	EXIST::FUNCTION:JPAKE
-JPAKE_STEP2_init                        4113	1_1_0	EXIST::FUNCTION:JPAKE
-pqueue_size                             4114	1_1_0	NOEXIST::FUNCTION:
 i2d_TS_ACCURACY                         4115	1_1_0	EXIST::FUNCTION:
 i2d_TS_MSG_IMPRINT_fp                   4116	1_1_0	EXIST::FUNCTION:STDIO
 i2d_TS_MSG_IMPRINT                      4117	1_1_0	EXIST::FUNCTION:
diff --git a/util/mk1mf.pl b/util/mk1mf.pl
index 4b5acbe..085db5f 100755
--- a/util/mk1mf.pl
+++ b/util/mk1mf.pl
@@ -306,7 +306,6 @@ $cflags.=&quot; -DOPENSSL_NO_ASYNC&quot; if $no_async;
 $cflags.=&quot; -DOPENSSL_NO_AUTOALGINIT&quot; if $no_autoalginit;
 $cflags.=&quot; -DOPENSSL_NO_AUTOERRINIT&quot; if $no_autoerrinit;
 $cflags.=&quot; -DOPENSSL_FIPS&quot;    if $fips;
-$cflags.=&quot; -DOPENSSL_NO_JPAKE&quot;    if $no_jpake;
 $cflags.=&quot; -DOPENSSL_NO_EC2M&quot;    if $no_ec2m;
 $cflags.= &quot; -DZLIB&quot; if $zlib_opt;
 $cflags.= &quot; -DZLIB_SHARED&quot; if $zlib_opt == 2;
@@ -1037,7 +1036,6 @@ sub var_add
 	return(&quot;&quot;) if $no_dh   &amp;&amp; $dir =~ /\/dh/;
 	return(&quot;&quot;) if $no_ec   &amp;&amp; $dir =~ /\/ec/;
 	return(&quot;&quot;) if $no_cms  &amp;&amp; $dir =~ /\/cms/;
-	return(&quot;&quot;) if $no_jpake  &amp;&amp; $dir =~ /\/jpake/;
 	return(&quot;&quot;) if !$fips   &amp;&amp; $dir =~ /^fips/;
 	if ($no_des &amp;&amp; $dir =~ /\/des/)
 		{
@@ -1397,7 +1395,6 @@ sub read_options
 		&quot;no-ssl3-method&quot; =&gt; 0,
 		&quot;no-srp&quot; =&gt; \$no_srp,
 		&quot;no-cms&quot; =&gt; \$no_cms,
-		&quot;no-jpake&quot; =&gt; \$no_jpake,
 		&quot;no-ec2m&quot; =&gt; \$no_ec2m,
 		&quot;no-ec_nistp_64_gcc_128&quot; =&gt; 0,
 		&quot;no-err&quot; =&gt; \$no_err,
diff --git a/util/mkdef.pl b/util/mkdef.pl
index 2de27c0..4ada9ad 100755
--- a/util/mkdef.pl
+++ b/util/mkdef.pl
@@ -102,8 +102,6 @@ my @known_algorithms = ( &quot;RC2&quot;, &quot;RC4&quot;, &quot;RC5&quot;, &quot;IDEA&quot;, &quot;DES&quot;, &quot;BF&quot;,
 			 &quot;CAPIENG&quot;,
 			 # SSL v3 method
 			 &quot;SSL3_METHOD&quot;,
-			 # JPAKE
-			 &quot;JPAKE&quot;,
 			 # NEXTPROTONEG
 			 &quot;NEXTPROTONEG&quot;,
 			 # Deprecated functions
@@ -293,7 +291,6 @@ $crypto.=&quot; include/openssl/ocsp.h&quot;;
 $crypto.=&quot; include/openssl/ui.h&quot;;
 #$crypto.=&quot; include/openssl/store.h&quot;;
 $crypto.=&quot; include/openssl/cms.h&quot;;
-$crypto.=&quot; include/openssl/jpake.h&quot;;
 $crypto.=&quot; include/openssl/srp.h&quot;;
 $crypto.=&quot; include/openssl/modes.h&quot;;
 $crypto.=&quot; include/openssl/async.h&quot;;
diff --git a/util/mkfiles.pl b/util/mkfiles.pl
index 55dfbc6..1e5f84e 100755
--- a/util/mkfiles.pl
+++ b/util/mkfiles.pl
@@ -48,7 +48,6 @@ my @dirs = (
 &quot;crypto/x509v3&quot;,
 &quot;crypto/cms&quot;,
 &quot;crypto/conf&quot;,
-&quot;crypto/jpake&quot;,
 &quot;crypto/txt_db&quot;,
 &quot;crypto/pkcs7&quot;,
 &quot;crypto/pkcs12&quot;,
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004182.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="004184.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4183">[ date ]</a>
              <a href="thread.html#4183">[ thread ]</a>
              <a href="subject.html#4183">[ subject ]</a>
              <a href="author.html#4183">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
