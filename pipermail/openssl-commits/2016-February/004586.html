<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2016-February/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1456529768.447859.9988.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004578.html">
   <LINK REL="Next"  HREF="004594.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Matt Caswell</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1456529768.447859.9988.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">matt at openssl.org
       </A><BR>
    <I>Fri Feb 26 23:36:08 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="004578.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="004594.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4586">[ date ]</a>
              <a href="thread.html#4586">[ thread ]</a>
              <a href="subject.html#4586">[ subject ]</a>
              <a href="author.html#4586">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  766579ec893e8028288c7215090a6fa3bd424fa0 (commit)
      from  a8d177acf0bbb4da4d7c2d9dd4c645d447f8da75 (commit)


- Log -----------------------------------------------------------------
commit 766579ec893e8028288c7215090a6fa3bd424fa0
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Fri Feb 26 16:21:55 2016 +0000

    Remove Ubsec engine
    
    The ubsec engine is now considered obsolete and therefore has been
    removed.
    
    Reviewed-by: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;

-----------------------------------------------------------------------

Summary of changes:
 CHANGES                         |    2 +-
 README.ENGINE                   |    7 +-
 engines/Makefile.in             |    5 -
 engines/e_ubsec.c               | 1034 ---------------------------------------
 engines/e_ubsec.ec              |    1 -
 engines/e_ubsec_err.c           |  153 ------
 engines/e_ubsec_err.h           |  102 ----
 engines/vendor_defns/hw_ubsec.h |  124 -----
 8 files changed, 4 insertions(+), 1424 deletions(-)
 delete mode 100644 engines/e_ubsec.c
 delete mode 100644 engines/e_ubsec.ec
 delete mode 100644 engines/e_ubsec_err.c
 delete mode 100644 engines/e_ubsec_err.h
 delete mode 100644 engines/vendor_defns/hw_ubsec.h

diff --git a/CHANGES b/CHANGES
index 51e7b08..be2330d 100644
--- a/CHANGES
+++ b/CHANGES
@@ -323,7 +323,7 @@
      [Rich Salz]
 
   *) Removed obsolete engines: 4758cca, aep, atalla, cswift, nuron, gmp,
-     and sureware.
+     sureware and ubsec.
      [Matt Caswell, Rich Salz]
 
   *) New ASN.1 embed macro.
diff --git a/README.ENGINE b/README.ENGINE
index 0ff8333..530a4ed 100644
--- a/README.ENGINE
+++ b/README.ENGINE
@@ -13,11 +13,10 @@
   There are currently built-in ENGINE implementations for the following
   crypto devices:
 
-      o CryptoSwift
-      o Compaq Atalla
+      o Cryptodev
+      o Microsoft CryptoAPI
+      o VIA Padlock
       o nCipher CHIL
-      o Nuron
-      o Broadcom uBSec
 
   In addition, dynamic binding to external ENGINE implementations is now
   provided by a special ENGINE called &quot;dynamic&quot;. See the &quot;DYNAMIC ENGINE&quot;
diff --git a/engines/Makefile.in b/engines/Makefile.in
index d07cc0f..cfe550f 100644
--- a/engines/Makefile.in
+++ b/engines/Makefile.in
@@ -2,9 +2,6 @@
 # OpenSSL/engines/Makefile
 #
 
-#The following engines have been disabled as they currently do not build
-# sureware ubsec
-
 DIR=	engines
 TOP=	..
 CC=	cc
@@ -43,8 +40,6 @@ TESTLIBOBJ= e_ossltest.o
 SRC= $(LIBSRC)
 
 HEADER=	\
-	e_chil_err.c e_chil_err.h \
-	e_ubsec_err.c e_ubsec_err.h \
 	e_capi_err.c e_capi_err.h \
 	e_ossltest_err.c e_ossltest_err.h \
 	e_dasync_err.c e_dasync_err.h
diff --git a/engines/e_ubsec.c b/engines/e_ubsec.c
deleted file mode 100644
index dab8d12..0000000
--- a/engines/e_ubsec.c
+++ /dev/null
@@ -1,1034 +0,0 @@
-/*
- * Written by Geoff Thorpe (<A HREF="../../../mailman/listinfo/openssl-commits.html">geoff at geoffthorpe.net</A>) for the OpenSSL project
- * 2000. Cloned shamelessly by Joe Tardo.
- */
-/* ====================================================================
- * Copyright (c) 1999-2001 The OpenSSL Project.  All rights reserved.
- *
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- *
- * 1. Redistributions of source code must retain the above copyright
- *    notice, this list of conditions and the following disclaimer.
- *
- * 2. Redistributions in binary form must reproduce the above copyright
- *    notice, this list of conditions and the following disclaimer in
- *    the documentation and/or other materials provided with the
- *    distribution.
- *
- * 3. All advertising materials mentioning features or use of this
- *    software must display the following acknowledgment:
- *    &quot;This product includes software developed by the OpenSSL Project
- *    for use in the OpenSSL Toolkit. (<A HREF="http://www.OpenSSL.org/">http://www.OpenSSL.org/</A>)&quot;
- *
- * 4. The names &quot;OpenSSL Toolkit&quot; and &quot;OpenSSL Project&quot; must not be used to
- *    endorse or promote products derived from this software without
- *    prior written permission. For written permission, please contact
- *    <A HREF="../../../mailman/listinfo/openssl-commits.html">licensing at OpenSSL.org.</A>
- *
- * 5. Products derived from this software may not be called &quot;OpenSSL&quot;
- *    nor may &quot;OpenSSL&quot; appear in their names without prior written
- *    permission of the OpenSSL Project.
- *
- * 6. Redistributions of any form whatsoever must retain the following
- *    acknowledgment:
- *    &quot;This product includes software developed by the OpenSSL Project
- *    for use in the OpenSSL Toolkit (<A HREF="http://www.OpenSSL.org/">http://www.OpenSSL.org/</A>)&quot;
- *
- * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
- * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
- * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
- * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
- * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
- * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
- * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
- * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
- * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
- * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
- * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
- * OF THE POSSIBILITY OF SUCH DAMAGE.
- * ====================================================================
- *
- * This product includes cryptographic software written by Eric Young
- * (<A HREF="../../../mailman/listinfo/openssl-commits.html">eay at cryptsoft.com</A>).  This product includes software written by Tim
- * Hudson (<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at cryptsoft.com</A>).
- *
- */
-
-#include &lt;stdio.h&gt;
-#include &lt;string.h&gt;
-#include &lt;openssl/crypto.h&gt;
-#include &lt;openssl/buffer.h&gt;
-#include &lt;openssl/dso.h&gt;
-#include &lt;openssl/engine.h&gt;
-#ifndef OPENSSL_NO_RSA
-# include &lt;openssl/rsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DSA
-# include &lt;openssl/dsa.h&gt;
-#endif
-#ifndef OPENSSL_NO_DH
-# include &lt;openssl/dh.h&gt;
-#endif
-#include &lt;openssl/bn.h&gt;
-
-#ifndef OPENSSL_NO_HW
-# ifndef OPENSSL_NO_HW_UBSEC
-
-#  ifdef FLAT_INC
-#   include &quot;hw_ubsec.h&quot;
-#  else
-#   include &quot;vendor_defns/hw_ubsec.h&quot;
-#  endif
-
-#  define UBSEC_LIB_NAME &quot;ubsec engine&quot;
-#  include &quot;e_ubsec_err.c&quot;
-
-#  define FAIL_TO_SOFTWARE -15
-
-static int ubsec_destroy(ENGINE *e);
-static int ubsec_init(ENGINE *e);
-static int ubsec_finish(ENGINE *e);
-static int ubsec_ctrl(ENGINE *e, int cmd, long i, void *p, void (*f) (void));
-static int ubsec_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
-                         const BIGNUM *m, BN_CTX *ctx);
-#  ifndef OPENSSL_NO_RSA
-static int ubsec_mod_exp_crt(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
-                             const BIGNUM *q, const BIGNUM *dp,
-                             const BIGNUM *dq, const BIGNUM *qinv,
-                             BN_CTX *ctx);
-static int ubsec_rsa_mod_exp(BIGNUM *r0, const BIGNUM *I, RSA *rsa,
-                             BN_CTX *ctx);
-static int ubsec_mod_exp_mont(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
-                              const BIGNUM *m, BN_CTX *ctx,
-                              BN_MONT_CTX *m_ctx);
-#  endif
-#  ifndef OPENSSL_NO_DSA
-#   ifdef NOT_USED
-static int ubsec_dsa_mod_exp(DSA *dsa, BIGNUM *rr, BIGNUM *a1,
-                             BIGNUM *p1, BIGNUM *a2, BIGNUM *p2, BIGNUM *m,
-                             BN_CTX *ctx, BN_MONT_CTX *in_mont);
-static int ubsec_mod_exp_dsa(DSA *dsa, BIGNUM *r, BIGNUM *a,
-                             const BIGNUM *p, const BIGNUM *m, BN_CTX *ctx,
-                             BN_MONT_CTX *m_ctx);
-#   endif
-static DSA_SIG *ubsec_dsa_do_sign(const unsigned char *dgst, int dlen,
-                                  DSA *dsa);
-static int ubsec_dsa_verify(const unsigned char *dgst, int dgst_len,
-                            DSA_SIG *sig, DSA *dsa);
-#  endif
-#  ifndef OPENSSL_NO_DH
-static int ubsec_mod_exp_dh(const DH *dh, BIGNUM *r, const BIGNUM *a,
-                            const BIGNUM *p, const BIGNUM *m, BN_CTX *ctx,
-                            BN_MONT_CTX *m_ctx);
-static int ubsec_dh_compute_key(unsigned char *key, const BIGNUM *pub_key,
-                                DH *dh);
-static int ubsec_dh_generate_key(DH *dh);
-#  endif
-
-#  ifdef NOT_USED
-static int ubsec_rand_bytes(unsigned char *buf, int num);
-static int ubsec_rand_status(void);
-#  endif
-
-#  define UBSEC_CMD_SO_PATH               ENGINE_CMD_BASE
-static const ENGINE_CMD_DEFN ubsec_cmd_defns[] = {
-    {UBSEC_CMD_SO_PATH,
-     &quot;SO_PATH&quot;,
-     &quot;Specifies the path to the 'ubsec' shared library&quot;,
-     ENGINE_CMD_FLAG_STRING},
-    {0, NULL, NULL, 0}
-};
-
-#  ifndef OPENSSL_NO_RSA
-/* Our internal RSA_METHOD that we provide pointers to */
-static RSA_METHOD ubsec_rsa = {
-    &quot;UBSEC RSA method&quot;,
-    NULL,
-    NULL,
-    NULL,
-    NULL,
-    ubsec_rsa_mod_exp,
-    ubsec_mod_exp_mont,
-    NULL,
-    NULL,
-    0,
-    NULL,
-    NULL,
-    NULL,
-    NULL
-};
-#  endif
-
-#  ifndef OPENSSL_NO_DSA
-/* Our internal DSA_METHOD that we provide pointers to */
-static DSA_METHOD ubsec_dsa = {
-    &quot;UBSEC DSA method&quot;,
-    ubsec_dsa_do_sign,          /* dsa_do_sign */
-    NULL,                       /* dsa_sign_setup */
-    ubsec_dsa_verify,           /* dsa_do_verify */
-    NULL,                       /* ubsec_dsa_mod_exp *//* dsa_mod_exp */
-    NULL,                       /* ubsec_mod_exp_dsa *//* bn_mod_exp */
-    NULL,                       /* init */
-    NULL,                       /* finish */
-    0,                          /* flags */
-    NULL,                       /* app_data */
-    NULL,                       /* dsa_paramgen */
-    NULL                        /* dsa_keygen */
-};
-#  endif
-
-#  ifndef OPENSSL_NO_DH
-/* Our internal DH_METHOD that we provide pointers to */
-static DH_METHOD ubsec_dh = {
-    &quot;UBSEC DH method&quot;,
-    ubsec_dh_generate_key,
-    ubsec_dh_compute_key,
-    ubsec_mod_exp_dh,
-    NULL,
-    NULL,
-    0,
-    NULL,
-    NULL
-};
-#  endif
-
-/* Constants used when creating the ENGINE */
-static const char *engine_ubsec_id = &quot;ubsec&quot;;
-static const char *engine_ubsec_name = &quot;UBSEC hardware engine support&quot;;
-
-/*
- * This internal function is used by ENGINE_ubsec() and possibly by the
- * &quot;dynamic&quot; ENGINE support too
- */
-static int bind_helper(ENGINE *e)
-{
-#  ifndef OPENSSL_NO_RSA
-    const RSA_METHOD *meth1;
-#  endif
-#  ifndef OPENSSL_NO_DH
-#   ifndef HAVE_UBSEC_DH
-    const DH_METHOD *meth3;
-#   endif                       /* HAVE_UBSEC_DH */
-#  endif
-    if (!ENGINE_set_id(e, engine_ubsec_id) ||
-        !ENGINE_set_name(e, engine_ubsec_name) ||
-#  ifndef OPENSSL_NO_RSA
-        !ENGINE_set_RSA(e, &amp;ubsec_rsa) ||
-#  endif
-#  ifndef OPENSSL_NO_DSA
-        !ENGINE_set_DSA(e, &amp;ubsec_dsa) ||
-#  endif
-#  ifndef OPENSSL_NO_DH
-        !ENGINE_set_DH(e, &amp;ubsec_dh) ||
-#  endif
-        !ENGINE_set_destroy_function(e, ubsec_destroy) ||
-        !ENGINE_set_init_function(e, ubsec_init) ||
-        !ENGINE_set_finish_function(e, ubsec_finish) ||
-        !ENGINE_set_ctrl_function(e, ubsec_ctrl) ||
-        !ENGINE_set_cmd_defns(e, ubsec_cmd_defns))
-        return 0;
-
-#  ifndef OPENSSL_NO_RSA
-    /*
-     * We know that the &quot;PKCS1_OpenSSL()&quot; functions hook properly to the
-     * Broadcom-specific mod_exp and mod_exp_crt so we use those functions.
-     * NB: We don't use ENGINE_openssl() or anything &quot;more generic&quot; because
-     * something like the RSAref code may not hook properly, and if you own
-     * one of these cards then you have the right to do RSA operations on it
-     * anyway!
-     */
-    meth1 = RSA_PKCS1_OpenSSL();
-    ubsec_rsa.rsa_pub_enc = meth1-&gt;rsa_pub_enc;
-    ubsec_rsa.rsa_pub_dec = meth1-&gt;rsa_pub_dec;
-    ubsec_rsa.rsa_priv_enc = meth1-&gt;rsa_priv_enc;
-    ubsec_rsa.rsa_priv_dec = meth1-&gt;rsa_priv_dec;
-#  endif
-
-#  ifndef OPENSSL_NO_DH
-#   ifndef HAVE_UBSEC_DH
-    /* Much the same for Diffie-Hellman */
-    meth3 = DH_OpenSSL();
-    ubsec_dh.generate_key = meth3-&gt;generate_key;
-    ubsec_dh.compute_key = meth3-&gt;compute_key;
-#   endif                       /* HAVE_UBSEC_DH */
-#  endif
-
-    /* Ensure the ubsec error handling is set up */
-    ERR_load_UBSEC_strings();
-    return 1;
-}
-
-#  ifdef OPENSSL_NO_DYNAMIC_ENGINE
-static ENGINE *engine_ubsec(void)
-{
-    ENGINE *ret = ENGINE_new();
-    if (ret == NULL)
-        return NULL;
-    if (!bind_helper(ret)) {
-        ENGINE_free(ret);
-        return NULL;
-    }
-    return ret;
-}
-
-void ENGINE_load_ubsec(void)
-{
-    /* Copied from eng_[openssl|dyn].c */
-    ENGINE *toadd = engine_ubsec();
-    if (!toadd)
-        return;
-    ENGINE_add(toadd);
-    ENGINE_free(toadd);
-    ERR_clear_error();
-}
-#  endif
-
-/*
- * This is a process-global DSO handle used for loading and unloading the
- * UBSEC library. NB: This is only set (or unset) during an init() or
- * finish() call (reference counts permitting) and they're operating with
- * global locks, so this should be thread-safe implicitly.
- */
-
-static DSO *ubsec_dso = NULL;
-
-/*
- * These are the function pointers that are (un)set when the library has
- * successfully (un)loaded.
- */
-
-static t_UBSEC_ubsec_bytes_to_bits *p_UBSEC_ubsec_bytes_to_bits = NULL;
-static t_UBSEC_ubsec_bits_to_bytes *p_UBSEC_ubsec_bits_to_bytes = NULL;
-static t_UBSEC_ubsec_open *p_UBSEC_ubsec_open = NULL;
-static t_UBSEC_ubsec_close *p_UBSEC_ubsec_close = NULL;
-#  ifndef OPENSSL_NO_DH
-static t_UBSEC_diffie_hellman_generate_ioctl
-    * p_UBSEC_diffie_hellman_generate_ioctl = NULL;
-static t_UBSEC_diffie_hellman_agree_ioctl *p_UBSEC_diffie_hellman_agree_ioctl
-    = NULL;
-#  endif
-#  ifndef OPENSSL_NO_RSA
-static t_UBSEC_rsa_mod_exp_ioctl *p_UBSEC_rsa_mod_exp_ioctl = NULL;
-static t_UBSEC_rsa_mod_exp_crt_ioctl *p_UBSEC_rsa_mod_exp_crt_ioctl = NULL;
-#  endif
-#  ifndef OPENSSL_NO_DSA
-static t_UBSEC_dsa_sign_ioctl *p_UBSEC_dsa_sign_ioctl = NULL;
-static t_UBSEC_dsa_verify_ioctl *p_UBSEC_dsa_verify_ioctl = NULL;
-#  endif
-static t_UBSEC_math_accelerate_ioctl *p_UBSEC_math_accelerate_ioctl = NULL;
-static t_UBSEC_rng_ioctl *p_UBSEC_rng_ioctl = NULL;
-static t_UBSEC_max_key_len_ioctl *p_UBSEC_max_key_len_ioctl = NULL;
-
-static int max_key_len = 1024;  /* ??? */
-
-/*
- * These are the static string constants for the DSO file name and the function
- * symbol names to bind to.
- */
-
-static const char *UBSEC_LIBNAME = NULL;
-static const char *get_UBSEC_LIBNAME(void)
-{
-    if (UBSEC_LIBNAME)
-        return UBSEC_LIBNAME;
-    return &quot;ubsec&quot;;
-}
-
-static void free_UBSEC_LIBNAME(void)
-{
-    OPENSSL_free(UBSEC_LIBNAME);
-    UBSEC_LIBNAME = NULL;
-}
-
-static long set_UBSEC_LIBNAME(const char *name)
-{
-    free_UBSEC_LIBNAME();
-    return (((UBSEC_LIBNAME = OPENSSL_strdup(name)) != NULL) ? 1 : 0);
-}
-
-static const char *UBSEC_F1 = &quot;ubsec_bytes_to_bits&quot;;
-static const char *UBSEC_F2 = &quot;ubsec_bits_to_bytes&quot;;
-static const char *UBSEC_F3 = &quot;ubsec_open&quot;;
-static const char *UBSEC_F4 = &quot;ubsec_close&quot;;
-#  ifndef OPENSSL_NO_DH
-static const char *UBSEC_F5 = &quot;diffie_hellman_generate_ioctl&quot;;
-static const char *UBSEC_F6 = &quot;diffie_hellman_agree_ioctl&quot;;
-#  endif
-/* #ifndef OPENSSL_NO_RSA */
-static const char *UBSEC_F7 = &quot;rsa_mod_exp_ioctl&quot;;
-static const char *UBSEC_F8 = &quot;rsa_mod_exp_crt_ioctl&quot;;
-/* #endif */
-#  ifndef OPENSSL_NO_DSA
-static const char *UBSEC_F9 = &quot;dsa_sign_ioctl&quot;;
-static const char *UBSEC_F10 = &quot;dsa_verify_ioctl&quot;;
-#  endif
-static const char *UBSEC_F11 = &quot;math_accelerate_ioctl&quot;;
-static const char *UBSEC_F12 = &quot;rng_ioctl&quot;;
-static const char *UBSEC_F13 = &quot;ubsec_max_key_len_ioctl&quot;;
-
-/* Destructor (complements the &quot;ENGINE_ubsec()&quot; constructor) */
-static int ubsec_destroy(ENGINE *e)
-{
-    free_UBSEC_LIBNAME();
-    ERR_unload_UBSEC_strings();
-    return 1;
-}
-
-/* (de)initialisation functions. */
-static int ubsec_init(ENGINE *e)
-{
-    t_UBSEC_ubsec_bytes_to_bits *p1;
-    t_UBSEC_ubsec_bits_to_bytes *p2;
-    t_UBSEC_ubsec_open *p3;
-    t_UBSEC_ubsec_close *p4;
-#  ifndef OPENSSL_NO_DH
-    t_UBSEC_diffie_hellman_generate_ioctl *p5;
-    t_UBSEC_diffie_hellman_agree_ioctl *p6;
-#  endif
-/* #ifndef OPENSSL_NO_RSA */
-    t_UBSEC_rsa_mod_exp_ioctl *p7;
-    t_UBSEC_rsa_mod_exp_crt_ioctl *p8;
-/* #endif */
-#  ifndef OPENSSL_NO_DSA
-    t_UBSEC_dsa_sign_ioctl *p9;
-    t_UBSEC_dsa_verify_ioctl *p10;
-#  endif
-    t_UBSEC_math_accelerate_ioctl *p11;
-    t_UBSEC_rng_ioctl *p12;
-    t_UBSEC_max_key_len_ioctl *p13;
-    int fd = 0;
-
-    if (ubsec_dso != NULL) {
-        UBSECerr(UBSEC_F_UBSEC_INIT, UBSEC_R_ALREADY_LOADED);
-        goto err;
-    }
-    /*
-     * Attempt to load libubsec.so/ubsec.dll/whatever.
-     */
-    ubsec_dso = DSO_load(NULL, get_UBSEC_LIBNAME(), NULL, 0);
-    if (ubsec_dso == NULL) {
-        UBSECerr(UBSEC_F_UBSEC_INIT, UBSEC_R_DSO_FAILURE);
-        goto err;
-    }
-
-#define BINDIT(t, name) (t *)DSO_bind_func(ubsec_dso, name)
-    if ((p1 = BINDIT(t_UBSEC_ubsec_bytes_to_bits, UBSEC_F1)) == NULL
-        || (p2 = BINDIT(t_UBSEC_ubsec_bits_to_bytes, UBSEC_F2)) == NULL
-        || (p3 = BINDIT(t_UBSEC_ubsec_open, UBSEC_F3)) == NULL
-        || (p4 = BINDIT(t_UBSEC_ubsec_close, UBSEC_F4)) == NULL
-#  ifndef OPENSSL_NO_DH
-        || (p5 = BINDIT(t_UBSEC_diffie_hellman_generate_ioctl, UBSEC_F5)) == NULL
-        || (p6 = BINDIT(t_UBSEC_diffie_hellman_agree_ioctl, UBSEC_F6)) == NULL
-#  endif
-/* #ifndef OPENSSL_NO_RSA */
-        || (p7 = BINDIT(t_UBSEC_rsa_mod_exp_ioctl, UBSEC_F7)) == NULL
-        || (p8 = BINDIT(t_UBSEC_rsa_mod_exp_crt_ioctl, UBSEC_F8)) == NULL
-/* #endif */
-#  ifndef OPENSSL_NO_DSA
-        || (p9 = BINDIT(t_UBSEC_dsa_sign_ioctl, UBSEC_F9)) == NULL
-        || (p10 = BINDIT(t_UBSEC_dsa_verify_ioctl, UBSEC_F10)) == NULL
-#  endif
-        || (p11 = BINDIT(t_UBSEC_math_accelerate_ioctl, UBSEC_F11)) == NULL
-        || (p12 = BINDIT(t_UBSEC_rng_ioctl, UBSEC_F12)) == NULL
-        || (p13 = BINDIT(t_UBSEC_max_key_len_ioctl, UBSEC_F13)) == NULL) {
-        UBSECerr(UBSEC_F_UBSEC_INIT, UBSEC_R_DSO_FAILURE);
-        goto err;
-    }
-
-    /* Copy the pointers */
-    p_UBSEC_ubsec_bytes_to_bits = p1;
-    p_UBSEC_ubsec_bits_to_bytes = p2;
-    p_UBSEC_ubsec_open = p3;
-    p_UBSEC_ubsec_close = p4;
-#  ifndef OPENSSL_NO_DH
-    p_UBSEC_diffie_hellman_generate_ioctl = p5;
-    p_UBSEC_diffie_hellman_agree_ioctl = p6;
-#  endif
-#  ifndef OPENSSL_NO_RSA
-    p_UBSEC_rsa_mod_exp_ioctl = p7;
-    p_UBSEC_rsa_mod_exp_crt_ioctl = p8;
-#  endif
-#  ifndef OPENSSL_NO_DSA
-    p_UBSEC_dsa_sign_ioctl = p9;
-    p_UBSEC_dsa_verify_ioctl = p10;
-#  endif
-    p_UBSEC_math_accelerate_ioctl = p11;
-    p_UBSEC_rng_ioctl = p12;
-    p_UBSEC_max_key_len_ioctl = p13;
-
-    /* Perform an open to see if there's actually any unit running. */
-    if (((fd = p_UBSEC_ubsec_open(UBSEC_KEY_DEVICE_NAME)) &gt; 0)
-        &amp;&amp; (p_UBSEC_max_key_len_ioctl(fd, &amp;max_key_len) == 0)) {
-        p_UBSEC_ubsec_close(fd);
-        return 1;
-    } else {
-        UBSECerr(UBSEC_F_UBSEC_INIT, UBSEC_R_UNIT_FAILURE);
-    }
-
- err:
-    DSO_free(ubsec_dso);
-    ubsec_dso = NULL;
-    p_UBSEC_ubsec_bytes_to_bits = NULL;
-    p_UBSEC_ubsec_bits_to_bytes = NULL;
-    p_UBSEC_ubsec_open = NULL;
-    p_UBSEC_ubsec_close = NULL;
-#  ifndef OPENSSL_NO_DH
-    p_UBSEC_diffie_hellman_generate_ioctl = NULL;
-    p_UBSEC_diffie_hellman_agree_ioctl = NULL;
-#  endif
-#  ifndef OPENSSL_NO_RSA
-    p_UBSEC_rsa_mod_exp_ioctl = NULL;
-    p_UBSEC_rsa_mod_exp_crt_ioctl = NULL;
-#  endif
-#  ifndef OPENSSL_NO_DSA
-    p_UBSEC_dsa_sign_ioctl = NULL;
-    p_UBSEC_dsa_verify_ioctl = NULL;
-#  endif
-    p_UBSEC_math_accelerate_ioctl = NULL;
-    p_UBSEC_rng_ioctl = NULL;
-    p_UBSEC_max_key_len_ioctl = NULL;
-
-    return 0;
-}
-
-static int ubsec_finish(ENGINE *e)
-{
-    free_UBSEC_LIBNAME();
-    if (ubsec_dso == NULL) {
-        UBSECerr(UBSEC_F_UBSEC_FINISH, UBSEC_R_NOT_LOADED);
-        return 0;
-    }
-    if (!DSO_free(ubsec_dso)) {
-        UBSECerr(UBSEC_F_UBSEC_FINISH, UBSEC_R_DSO_FAILURE);
-        return 0;
-    }
-    ubsec_dso = NULL;
-    p_UBSEC_ubsec_bytes_to_bits = NULL;
-    p_UBSEC_ubsec_bits_to_bytes = NULL;
-    p_UBSEC_ubsec_open = NULL;
-    p_UBSEC_ubsec_close = NULL;
-#  ifndef OPENSSL_NO_DH
-    p_UBSEC_diffie_hellman_generate_ioctl = NULL;
-    p_UBSEC_diffie_hellman_agree_ioctl = NULL;
-#  endif
-#  ifndef OPENSSL_NO_RSA
-    p_UBSEC_rsa_mod_exp_ioctl = NULL;
-    p_UBSEC_rsa_mod_exp_crt_ioctl = NULL;
-#  endif
-#  ifndef OPENSSL_NO_DSA
-    p_UBSEC_dsa_sign_ioctl = NULL;
-    p_UBSEC_dsa_verify_ioctl = NULL;
-#  endif
-    p_UBSEC_math_accelerate_ioctl = NULL;
-    p_UBSEC_rng_ioctl = NULL;
-    p_UBSEC_max_key_len_ioctl = NULL;
-    return 1;
-}
-
-static int ubsec_ctrl(ENGINE *e, int cmd, long i, void *p, void (*f) (void))
-{
-    int initialised = ((ubsec_dso == NULL) ? 0 : 1);
-    switch (cmd) {
-    case UBSEC_CMD_SO_PATH:
-        if (p == NULL) {
-            UBSECerr(UBSEC_F_UBSEC_CTRL, ERR_R_PASSED_NULL_PARAMETER);
-            return 0;
-        }
-        if (initialised) {
-            UBSECerr(UBSEC_F_UBSEC_CTRL, UBSEC_R_ALREADY_LOADED);
-            return 0;
-        }
-        return set_UBSEC_LIBNAME((const char *)p);
-    default:
-        break;
-    }
-    UBSECerr(UBSEC_F_UBSEC_CTRL, UBSEC_R_CTRL_COMMAND_NOT_IMPLEMENTED);
-    return 0;
-}
-
-static int ubsec_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
-                         const BIGNUM *m, BN_CTX *ctx)
-{
-    int y_len = 0;
-    int fd;
-
-    if (ubsec_dso == NULL) {
-        UBSECerr(UBSEC_F_UBSEC_MOD_EXP, UBSEC_R_NOT_LOADED);
-        return 0;
-    }
-
-    /* Check if hardware can't handle this argument. */
-    y_len = BN_num_bits(m);
-    if (y_len &gt; max_key_len) {
-        UBSECerr(UBSEC_F_UBSEC_MOD_EXP, UBSEC_R_SIZE_TOO_LARGE_OR_TOO_SMALL);
-        return BN_mod_exp(r, a, p, m, ctx);
-    }
-
-    if (!bn_wexpand(r, m-&gt;top)) {
-        UBSECerr(UBSEC_F_UBSEC_MOD_EXP, UBSEC_R_BN_EXPAND_FAIL);
-        return 0;
-    }
-
-    if ((fd = p_UBSEC_ubsec_open(UBSEC_KEY_DEVICE_NAME)) &lt;= 0) {
-        fd = 0;
-        UBSECerr(UBSEC_F_UBSEC_MOD_EXP, UBSEC_R_UNIT_FAILURE);
-        return BN_mod_exp(r, a, p, m, ctx);
-    }
-
-    if (p_UBSEC_rsa_mod_exp_ioctl(fd, (unsigned char *)a-&gt;d, BN_num_bits(a),
-                                  (unsigned char *)m-&gt;d, BN_num_bits(m),
-                                  (unsigned char *)p-&gt;d, BN_num_bits(p),
-                                  (unsigned char *)r-&gt;d, &amp;y_len) != 0) {
-        UBSECerr(UBSEC_F_UBSEC_MOD_EXP, UBSEC_R_REQUEST_FAILED);
-        p_UBSEC_ubsec_close(fd);
-
-        return BN_mod_exp(r, a, p, m, ctx);
-    }
-
-    p_UBSEC_ubsec_close(fd);
-
-    r-&gt;top = (BN_num_bits(m) + BN_BITS2 - 1) / BN_BITS2;
-    return 1;
-}
-
-#  ifndef OPENSSL_NO_RSA
-static int ubsec_rsa_mod_exp(BIGNUM *r0, const BIGNUM *I, RSA *rsa,
-                             BN_CTX *ctx)
-{
-    int to_return = 0;
-
-    if (!rsa-&gt;p || !rsa-&gt;q || !rsa-&gt;dmp1 || !rsa-&gt;dmq1 || !rsa-&gt;iqmp) {
-        UBSECerr(UBSEC_F_UBSEC_RSA_MOD_EXP, UBSEC_R_MISSING_KEY_COMPONENTS);
-        goto err;
-    }
-
-    to_return = ubsec_mod_exp_crt(r0, I, rsa-&gt;p, rsa-&gt;q, rsa-&gt;dmp1,
-                                  rsa-&gt;dmq1, rsa-&gt;iqmp, ctx);
-    if (to_return == FAIL_TO_SOFTWARE) {
-        /*
-         * Do in software as hardware failed.
-         */
-        const RSA_METHOD *meth = RSA_PKCS1_OpenSSL();
-        to_return = (*meth-&gt;rsa_mod_exp) (r0, I, rsa, ctx);
-    }
- err:
-    return to_return;
-}
-
-static int ubsec_mod_exp_crt(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
-                             const BIGNUM *q, const BIGNUM *dp,
-                             const BIGNUM *dq, const BIGNUM *qinv,
-                             BN_CTX *ctx)
-{
-    int y_len, fd;
-
-    y_len = BN_num_bits(p) + BN_num_bits(q);
-
-    /* Check if hardware can't handle this argument. */
-    if (y_len &gt; max_key_len) {
-        UBSECerr(UBSEC_F_UBSEC_MOD_EXP_CRT,
-                 UBSEC_R_SIZE_TOO_LARGE_OR_TOO_SMALL);
-        return FAIL_TO_SOFTWARE;
-    }
-
-    if (!bn_wexpand(r, p-&gt;top + q-&gt;top + 1)) {
-        UBSECerr(UBSEC_F_UBSEC_MOD_EXP_CRT, UBSEC_R_BN_EXPAND_FAIL);
-        return 0;
-    }
-
-    if ((fd = p_UBSEC_ubsec_open(UBSEC_KEY_DEVICE_NAME)) &lt;= 0) {
-        fd = 0;
-        UBSECerr(UBSEC_F_UBSEC_MOD_EXP_CRT, UBSEC_R_UNIT_FAILURE);
-        return FAIL_TO_SOFTWARE;
-    }
-
-    if (p_UBSEC_rsa_mod_exp_crt_ioctl(fd,
-                                      (unsigned char *)a-&gt;d, BN_num_bits(a),
-                                      (unsigned char *)qinv-&gt;d,
-                                      BN_num_bits(qinv),
-                                      (unsigned char *)dp-&gt;d, BN_num_bits(dp),
-                                      (unsigned char *)p-&gt;d, BN_num_bits(p),
-                                      (unsigned char *)dq-&gt;d, BN_num_bits(dq),
-                                      (unsigned char *)q-&gt;d, BN_num_bits(q),
-                                      (unsigned char *)r-&gt;d, &amp;y_len) != 0) {
-        UBSECerr(UBSEC_F_UBSEC_MOD_EXP_CRT, UBSEC_R_REQUEST_FAILED);
-        p_UBSEC_ubsec_close(fd);
-        return FAIL_TO_SOFTWARE;
-    }
-
-    p_UBSEC_ubsec_close(fd);
-
-    r-&gt;top = (BN_num_bits(p) + BN_num_bits(q) + BN_BITS2 - 1) / BN_BITS2;
-    return 1;
-}
-#  endif
-
-#  ifndef OPENSSL_NO_RSA
-
-/*
- * This function is aliased to mod_exp (with the mont stuff dropped).
- */
-static int ubsec_mod_exp_mont(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
-                              const BIGNUM *m, BN_CTX *ctx,
-                              BN_MONT_CTX *m_ctx)
-{
-    int ret = 0;
-
-    /* Do in software if the key is too large for the hardware. */
-    if (BN_num_bits(m) &gt; max_key_len) {
-        const RSA_METHOD *meth = RSA_PKCS1_OpenSSL();
-        ret = (*meth-&gt;bn_mod_exp) (r, a, p, m, ctx, m_ctx);
-    } else {
-        ret = ubsec_mod_exp(r, a, p, m, ctx);
-    }
-
-    return ret;
-}
-#  endif
-
-#  ifndef OPENSSL_NO_DH
-/* This function is aliased to mod_exp (with the dh and mont dropped). */
-static int ubsec_mod_exp_dh(const DH *dh, BIGNUM *r, const BIGNUM *a,
-                            const BIGNUM *p, const BIGNUM *m, BN_CTX *ctx,
-                            BN_MONT_CTX *m_ctx)
-{
-    return ubsec_mod_exp(r, a, p, m, ctx);
-}
-#  endif
-
-#  ifndef OPENSSL_NO_DSA
-static DSA_SIG *ubsec_dsa_do_sign(const unsigned char *dgst, int dlen,
-                                  DSA *dsa)
-{
-    DSA_SIG *to_return = NULL;
-    int s_len = 160, r_len = 160, d_len, fd;
-    BIGNUM m, *r = NULL, *s = NULL;
-
-    BN_init(&amp;m);
-
-    s = BN_new();
-    r = BN_new();
-    if ((s == NULL) || (r == NULL))
-        goto err;
-
-    d_len = p_UBSEC_ubsec_bytes_to_bits((unsigned char *)dgst, dlen);
-
-    if (!bn_wexpand(r, (160 + BN_BITS2 - 1) / BN_BITS2) ||
-        (!bn_wexpand(s, (160 + BN_BITS2 - 1) / BN_BITS2))) {
-        UBSECerr(UBSEC_F_UBSEC_DSA_DO_SIGN, UBSEC_R_BN_EXPAND_FAIL);
-        goto err;
-    }
-
-    if (BN_bin2bn(dgst, dlen, &amp;m) == NULL) {
-        UBSECerr(UBSEC_F_UBSEC_DSA_DO_SIGN, UBSEC_R_BN_EXPAND_FAIL);
-        goto err;
-    }
-
-    if ((fd = p_UBSEC_ubsec_open(UBSEC_KEY_DEVICE_NAME)) &lt;= 0) {
-        const DSA_METHOD *meth;
-        fd = 0;
-        UBSECerr(UBSEC_F_UBSEC_DSA_DO_SIGN, UBSEC_R_UNIT_FAILURE);
-        meth = DSA_OpenSSL();
-        to_return = meth-&gt;dsa_do_sign(dgst, dlen, dsa);
-        goto err;
-    }
-
-    if (p_UBSEC_dsa_sign_ioctl(fd,
-                               /* compute hash before signing */
-                               0, (unsigned char *)dgst, d_len, NULL,
-                               /* compute random value */
-                               0,
-                               (unsigned char *)dsa-&gt;p-&gt;d,
-                               BN_num_bits(dsa-&gt;p),
-                               (unsigned char *)dsa-&gt;q-&gt;d,
-                               BN_num_bits(dsa-&gt;q),
-                               (unsigned char *)dsa-&gt;g-&gt;d,
-                               BN_num_bits(dsa-&gt;g),
-                               (unsigned char *)dsa-&gt;priv_key-&gt;d,
-                               BN_num_bits(dsa-&gt;priv_key),
-                               (unsigned char *)r-&gt;d, &amp;r_len,
-                               (unsigned char *)s-&gt;d, &amp;s_len) != 0) {
-        const DSA_METHOD *meth;
-
-        UBSECerr(UBSEC_F_UBSEC_DSA_DO_SIGN, UBSEC_R_REQUEST_FAILED);
-        p_UBSEC_ubsec_close(fd);
-        meth = DSA_OpenSSL();
-        to_return = meth-&gt;dsa_do_sign(dgst, dlen, dsa);
-
-        goto err;
-    }
-
-    p_UBSEC_ubsec_close(fd);
-
-    r-&gt;top = (160 + BN_BITS2 - 1) / BN_BITS2;
-    s-&gt;top = (160 + BN_BITS2 - 1) / BN_BITS2;
-
-    to_return = DSA_SIG_new();
-    if (to_return == NULL) {
-        UBSECerr(UBSEC_F_UBSEC_DSA_DO_SIGN, UBSEC_R_BN_EXPAND_FAIL);
-        goto err;
-    }
-
-    to_return-&gt;r = r;
-    to_return-&gt;s = s;
-
- err:
-    if (!to_return) {
-        BN_free(r);
-        BN_free(s);
-    }
-    BN_clear_free(&amp;m);
-    return to_return;
-}
-
-static int ubsec_dsa_verify(const unsigned char *dgst, int dgst_len,
-                            DSA_SIG *sig, DSA *dsa)
-{
-    int v_len, d_len;
-    int to_return = 0;
-    int fd;
-    BIGNUM v, *pv = &v;
-
-    BN_init(&amp;v);
-
-    if (!bn_wexpand(pv, dsa-&gt;p-&gt;top)) {
-        UBSECerr(UBSEC_F_UBSEC_DSA_VERIFY, UBSEC_R_BN_EXPAND_FAIL);
-        goto err;
-    }
-
-    v_len = BN_num_bits(dsa-&gt;p);
-
-    d_len = p_UBSEC_ubsec_bytes_to_bits((unsigned char *)dgst, dgst_len);
-
-    if ((fd = p_UBSEC_ubsec_open(UBSEC_KEY_DEVICE_NAME)) &lt;= 0) {
-        const DSA_METHOD *meth;
-        fd = 0;
-        UBSECerr(UBSEC_F_UBSEC_DSA_VERIFY, UBSEC_R_UNIT_FAILURE);
-        meth = DSA_OpenSSL();
-        to_return = meth-&gt;dsa_do_verify(dgst, dgst_len, sig, dsa);
-        goto err;
-    }
-
-    if (p_UBSEC_dsa_verify_ioctl(fd, 0, /* compute hash before signing */
-                                 (unsigned char *)dgst, d_len,
-                                 (unsigned char *)dsa-&gt;p-&gt;d,
-                                 BN_num_bits(dsa-&gt;p),
-                                 (unsigned char *)dsa-&gt;q-&gt;d,
-                                 BN_num_bits(dsa-&gt;q),
-                                 (unsigned char *)dsa-&gt;g-&gt;d,
-                                 BN_num_bits(dsa-&gt;g),
-                                 (unsigned char *)dsa-&gt;pub_key-&gt;d,
-                                 BN_num_bits(dsa-&gt;pub_key),
-                                 (unsigned char *)sig-&gt;r-&gt;d,
-                                 BN_num_bits(sig-&gt;r),
-                                 (unsigned char *)sig-&gt;s-&gt;d,
-                                 BN_num_bits(sig-&gt;s), (unsigned char *)v.d,
-                                 &amp;v_len) != 0) {
-        const DSA_METHOD *meth;
-        UBSECerr(UBSEC_F_UBSEC_DSA_VERIFY, UBSEC_R_REQUEST_FAILED);
-        p_UBSEC_ubsec_close(fd);
-
-        meth = DSA_OpenSSL();
-        to_return = meth-&gt;dsa_do_verify(dgst, dgst_len, sig, dsa);
-
-        goto err;
-    }
-
-    p_UBSEC_ubsec_close(fd);
-
-    to_return = 1;
- err:
-    BN_clear_free(&amp;v);
-    return to_return;
-}
-#  endif
-
-#  ifndef OPENSSL_NO_DH
-static int ubsec_dh_compute_key(unsigned char *key, const BIGNUM *pub_key,
-                                DH *dh)
-{
-    int ret = -1, k_len, fd;
-
-    k_len = BN_num_bits(dh-&gt;p);
-
-    if ((fd = p_UBSEC_ubsec_open(UBSEC_KEY_DEVICE_NAME)) &lt;= 0) {
-        const DH_METHOD *meth;
-        UBSECerr(UBSEC_F_UBSEC_DH_COMPUTE_KEY, UBSEC_R_UNIT_FAILURE);
-        meth = DH_OpenSSL();
-        ret = meth-&gt;compute_key(key, pub_key, dh);
-        goto err;
-    }
-
-    if (p_UBSEC_diffie_hellman_agree_ioctl(fd,
-                                           (unsigned char *)dh-&gt;priv_key-&gt;d,
-                                           BN_num_bits(dh-&gt;priv_key),
-                                           (unsigned char *)pub_key-&gt;d,
-                                           BN_num_bits(pub_key),
-                                           (unsigned char *)dh-&gt;p-&gt;d,
-                                           BN_num_bits(dh-&gt;p), key,
-                                           &amp;k_len) != 0) {
-        /* Hardware's a no go, failover to software */
-        const DH_METHOD *meth;
-        UBSECerr(UBSEC_F_UBSEC_DH_COMPUTE_KEY, UBSEC_R_REQUEST_FAILED);
-        p_UBSEC_ubsec_close(fd);
-
-        meth = DH_OpenSSL();
-        ret = meth-&gt;compute_key(key, pub_key, dh);
-
-        goto err;
-    }
-
-    p_UBSEC_ubsec_close(fd);
-
-    ret = p_UBSEC_ubsec_bits_to_bytes(k_len);
- err:
-    return ret;
-}
-
-static int ubsec_dh_generate_key(DH *dh)
-{
-    int ret = 0, random_bits = 0, pub_key_len = 0, priv_key_len = 0, fd;
-    BIGNUM *pub_key = NULL;
-    BIGNUM *priv_key = NULL;
-
-    /*
-     *  How many bits should Random x be? dh_key.c
-     *  sets the range from 0 to num_bits(modulus) ???
-     */
-
-    if (dh-&gt;priv_key == NULL) {
-        priv_key = BN_new();
-        if (priv_key == NULL)
-            goto err;
-        priv_key_len = BN_num_bits(dh-&gt;p);
-        if (bn_wexpand(priv_key, dh-&gt;p-&gt;top) == NULL)
-            goto err;
-        do
-            if (!BN_rand_range(priv_key, dh-&gt;p))
-                goto err;
-        while (BN_is_zero(priv_key)) ;
-        random_bits = BN_num_bits(priv_key);
-    } else {
-        priv_key = dh-&gt;priv_key;
-    }
-
-    if (dh-&gt;pub_key == NULL) {
-        pub_key = BN_new();
-        if (pub_key == NULL)
-            goto err;
-        pub_key_len = BN_num_bits(dh-&gt;p);
-        if (bn_wexpand(pub_key, dh-&gt;p-&gt;top) == NULL)
-            goto err;
-    } else {
-        pub_key = dh-&gt;pub_key;
-    }
-
-    if ((fd = p_UBSEC_ubsec_open(UBSEC_KEY_DEVICE_NAME)) &lt;= 0) {
-        const DH_METHOD *meth;
-        UBSECerr(UBSEC_F_UBSEC_DH_GENERATE_KEY, UBSEC_R_UNIT_FAILURE);
-        meth = DH_OpenSSL();
-        ret = meth-&gt;generate_key(dh);
-        goto err;
-    }
-
-    if (p_UBSEC_diffie_hellman_generate_ioctl(fd,
-                                              (unsigned char *)priv_key-&gt;d,
-                                              &amp;priv_key_len,
-                                              (unsigned char *)pub_key-&gt;d,
-                                              &amp;pub_key_len,
-                                              (unsigned char *)dh-&gt;g-&gt;d,
-                                              BN_num_bits(dh-&gt;g),
-                                              (unsigned char *)dh-&gt;p-&gt;d,
-                                              BN_num_bits(dh-&gt;p), 0, 0,
-                                              random_bits) != 0) {
-        /* Hardware's a no go, failover to software */
-        const DH_METHOD *meth;
-
-        UBSECerr(UBSEC_F_UBSEC_DH_GENERATE_KEY, UBSEC_R_REQUEST_FAILED);
-        p_UBSEC_ubsec_close(fd);
-
-        meth = DH_OpenSSL();
-        ret = meth-&gt;generate_key(dh);
-
-        goto err;
-    }
-
-    p_UBSEC_ubsec_close(fd);
-
-    dh-&gt;pub_key = pub_key;
-    dh-&gt;pub_key-&gt;top = (pub_key_len + BN_BITS2 - 1) / BN_BITS2;
-    dh-&gt;priv_key = priv_key;
-    dh-&gt;priv_key-&gt;top = (priv_key_len + BN_BITS2 - 1) / BN_BITS2;
-
-    ret = 1;
- err:
-    return ret;
-}
-#  endif
-
-#  ifdef NOT_USED
-static int ubsec_rand_bytes(unsigned char *buf, int num)
-{
-    int ret = 0, fd;
-
-    if ((fd = p_UBSEC_ubsec_open(UBSEC_KEY_DEVICE_NAME)) &lt;= 0) {
-        const RAND_METHOD *meth;
-        UBSECerr(UBSEC_F_UBSEC_RAND_BYTES, UBSEC_R_UNIT_FAILURE);
-        num = p_UBSEC_ubsec_bits_to_bytes(num);
-        meth = RAND_OpenSSL();
-        meth-&gt;seed(buf, num);
-        ret = meth-&gt;bytes(buf, num);
-        goto err;
-    }
-
-    num *= 8;                   /* bytes to bits */
-
-    if (p_UBSEC_rng_ioctl(fd, UBSEC_RNG_DIRECT, buf, &amp;num) != 0) {
-        /* Hardware's a no go, failover to software */
-        const RAND_METHOD *meth;
-
-        UBSECerr(UBSEC_F_UBSEC_RAND_BYTES, UBSEC_R_REQUEST_FAILED);
-        p_UBSEC_ubsec_close(fd);
-
-        num = p_UBSEC_ubsec_bits_to_bytes(num);
-        meth = RAND_OpenSSL();
-        meth-&gt;seed(buf, num);
-        ret = meth-&gt;bytes(buf, num);
-
-        goto err;
-    }
-
-    p_UBSEC_ubsec_close(fd);
-
-    ret = 1;
- err:
-    return (ret);
-}
-
-static int ubsec_rand_status(void)
-{
-    return 0;
-}
-#  endif
-
-/*
- * This stuff is needed if this ENGINE is being compiled into a
- * self-contained shared-library.
- */
-#  ifndef OPENSSL_NO_DYNAMIC_ENGINE
-static int bind_fn(ENGINE *e, const char *id)
-{
-    if (id &amp;&amp; (strcmp(id, engine_ubsec_id) != 0))
-        return 0;
-    if (!bind_helper(e))
-        return 0;
-    return 1;
-}
-
-IMPLEMENT_DYNAMIC_CHECK_FN()
-    IMPLEMENT_DYNAMIC_BIND_FN(bind_fn)
-#  endif                        /* OPENSSL_NO_DYNAMIC_ENGINE */
-# endif                         /* !OPENSSL_NO_HW_UBSEC */
-#endif                          /* !OPENSSL_NO_HW */
diff --git a/engines/e_ubsec.ec b/engines/e_ubsec.ec
deleted file mode 100644
index 99b9233..0000000
--- a/engines/e_ubsec.ec
+++ /dev/null
@@ -1 +0,0 @@
-L UBSEC		e_ubsec_err.h			e_ubsec_err.c
diff --git a/engines/e_ubsec_err.c b/engines/e_ubsec_err.c
deleted file mode 100644
index 9819f36..0000000
--- a/engines/e_ubsec_err.c
+++ /dev/null
@@ -1,153 +0,0 @@
-/* ====================================================================
- * Copyright (c) 1999-2005 The OpenSSL Project.  All rights reserved.
- *
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- *
- * 1. Redistributions of source code must retain the above copyright
- *    notice, this list of conditions and the following disclaimer.
- *
- * 2. Redistributions in binary form must reproduce the above copyright
- *    notice, this list of conditions and the following disclaimer in
- *    the documentation and/or other materials provided with the
- *    distribution.
- *
- * 3. All advertising materials mentioning features or use of this
- *    software must display the following acknowledgment:
- *    &quot;This product includes software developed by the OpenSSL Project
- *    for use in the OpenSSL Toolkit. (<A HREF="http://www.OpenSSL.org/">http://www.OpenSSL.org/</A>)&quot;
- *
- * 4. The names &quot;OpenSSL Toolkit&quot; and &quot;OpenSSL Project&quot; must not be used to
- *    endorse or promote products derived from this software without
- *    prior written permission. For written permission, please contact
- *    <A HREF="../../../mailman/listinfo/openssl-commits.html">openssl-core at OpenSSL.org.</A>
- *
- * 5. Products derived from this software may not be called &quot;OpenSSL&quot;
- *    nor may &quot;OpenSSL&quot; appear in their names without prior written
- *    permission of the OpenSSL Project.
- *
- * 6. Redistributions of any form whatsoever must retain the following
- *    acknowledgment:
- *    &quot;This product includes software developed by the OpenSSL Project
- *    for use in the OpenSSL Toolkit (<A HREF="http://www.OpenSSL.org/">http://www.OpenSSL.org/</A>)&quot;
- *
- * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
- * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
- * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
- * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
- * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
- * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
- * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
- * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
- * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
- * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
- * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
- * OF THE POSSIBILITY OF SUCH DAMAGE.
- * ====================================================================
- *
- * This product includes cryptographic software written by Eric Young
- * (<A HREF="../../../mailman/listinfo/openssl-commits.html">eay at cryptsoft.com</A>).  This product includes software written by Tim
- * Hudson (<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at cryptsoft.com</A>).
- *
- */
-
-/*
- * NOTE: this file was auto generated by the mkerr.pl script: any changes
- * made to it will be overwritten when the script next updates this file,
- * only reason strings will be preserved.
- */
-
-#include &lt;stdio.h&gt;
-#include &lt;openssl/err.h&gt;
-#include &quot;e_ubsec_err.h&quot;
-
-/* BEGIN ERROR CODES */
-#ifndef OPENSSL_NO_ERR
-
-# define ERR_FUNC(func) ERR_PACK(0,func,0)
-# define ERR_REASON(reason) ERR_PACK(0,0,reason)
-
-static ERR_STRING_DATA UBSEC_str_functs[] = {
-    {ERR_FUNC(UBSEC_F_UBSEC_CTRL), &quot;UBSEC_CTRL&quot;},
-    {ERR_FUNC(UBSEC_F_UBSEC_DH_COMPUTE_KEY), &quot;UBSEC_DH_COMPUTE_KEY&quot;},
-    {ERR_FUNC(UBSEC_F_UBSEC_DH_GENERATE_KEY), &quot;UBSEC_DH_GENERATE_KEY&quot;},
-    {ERR_FUNC(UBSEC_F_UBSEC_DSA_DO_SIGN), &quot;UBSEC_DSA_DO_SIGN&quot;},
-    {ERR_FUNC(UBSEC_F_UBSEC_DSA_VERIFY), &quot;UBSEC_DSA_VERIFY&quot;},
-    {ERR_FUNC(UBSEC_F_UBSEC_FINISH), &quot;UBSEC_FINISH&quot;},
-    {ERR_FUNC(UBSEC_F_UBSEC_INIT), &quot;UBSEC_INIT&quot;},
-    {ERR_FUNC(UBSEC_F_UBSEC_MOD_EXP), &quot;UBSEC_MOD_EXP&quot;},
-    {ERR_FUNC(UBSEC_F_UBSEC_MOD_EXP_CRT), &quot;UBSEC_MOD_EXP_CRT&quot;},
-    {ERR_FUNC(UBSEC_F_UBSEC_RAND_BYTES), &quot;UBSEC_RAND_BYTES&quot;},
-    {ERR_FUNC(UBSEC_F_UBSEC_RSA_MOD_EXP), &quot;UBSEC_RSA_MOD_EXP&quot;},
-    {ERR_FUNC(UBSEC_F_UBSEC_RSA_MOD_EXP_CRT), &quot;UBSEC_RSA_MOD_EXP_CRT&quot;},
-    {0, NULL}
-};
-
-static ERR_STRING_DATA UBSEC_str_reasons[] = {
-    {ERR_REASON(UBSEC_R_ALREADY_LOADED), &quot;already loaded&quot;},
-    {ERR_REASON(UBSEC_R_BN_EXPAND_FAIL), &quot;bn expand fail&quot;},
-    {ERR_REASON(UBSEC_R_CTRL_COMMAND_NOT_IMPLEMENTED),
-     &quot;ctrl command not implemented&quot;},
-    {ERR_REASON(UBSEC_R_DSO_FAILURE), &quot;dso failure&quot;},
-    {ERR_REASON(UBSEC_R_MISSING_KEY_COMPONENTS), &quot;missing key components&quot;},
-    {ERR_REASON(UBSEC_R_NOT_LOADED), &quot;not loaded&quot;},
-    {ERR_REASON(UBSEC_R_REQUEST_FAILED), &quot;request failed&quot;},
-    {ERR_REASON(UBSEC_R_SIZE_TOO_LARGE_OR_TOO_SMALL),
-     &quot;size too large or too small&quot;},
-    {ERR_REASON(UBSEC_R_UNIT_FAILURE), &quot;unit failure&quot;},
-    {0, NULL}
-};
-
-#endif
-
-#ifdef UBSEC_LIB_NAME
-static ERR_STRING_DATA UBSEC_lib_name[] = {
-    {0, UBSEC_LIB_NAME},
-    {0, NULL}
-};
-#endif
-
-static int UBSEC_lib_error_code = 0;
-static int UBSEC_error_init = 1;
-
-static void ERR_load_UBSEC_strings(void)
-{
-    if (UBSEC_lib_error_code == 0)
-        UBSEC_lib_error_code = ERR_get_next_error_library();
-
-    if (UBSEC_error_init) {
-        UBSEC_error_init = 0;
-#ifndef OPENSSL_NO_ERR
-        ERR_load_strings(UBSEC_lib_error_code, UBSEC_str_functs);
-        ERR_load_strings(UBSEC_lib_error_code, UBSEC_str_reasons);
-#endif
-
-#ifdef UBSEC_LIB_NAME
-        UBSEC_lib_name-&gt;error = ERR_PACK(UBSEC_lib_error_code, 0, 0);
-        ERR_load_strings(0, UBSEC_lib_name);
-#endif
-    }
-}
-
-static void ERR_unload_UBSEC_strings(void)
-{
-    if (UBSEC_error_init == 0) {
-#ifndef OPENSSL_NO_ERR
-        ERR_unload_strings(UBSEC_lib_error_code, UBSEC_str_functs);
-        ERR_unload_strings(UBSEC_lib_error_code, UBSEC_str_reasons);
-#endif
-
-#ifdef UBSEC_LIB_NAME
-        ERR_unload_strings(0, UBSEC_lib_name);
-#endif
-        UBSEC_error_init = 1;
-    }
-}
-
-static void ERR_UBSEC_error(int function, int reason, char *file, int line)
-{
-    if (UBSEC_lib_error_code == 0)
-        UBSEC_lib_error_code = ERR_get_next_error_library();
-    ERR_PUT_error(UBSEC_lib_error_code, function, reason, file, line);
-}
diff --git a/engines/e_ubsec_err.h b/engines/e_ubsec_err.h
deleted file mode 100644
index 67110ed..0000000
--- a/engines/e_ubsec_err.h
+++ /dev/null
@@ -1,102 +0,0 @@
-/* ====================================================================
- * Copyright (c) 2001 The OpenSSL Project.  All rights reserved.
- *
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- *
- * 1. Redistributions of source code must retain the above copyright
- *    notice, this list of conditions and the following disclaimer.
- *
- * 2. Redistributions in binary form must reproduce the above copyright
- *    notice, this list of conditions and the following disclaimer in
- *    the documentation and/or other materials provided with the
- *    distribution.
- *
- * 3. All advertising materials mentioning features or use of this
- *    software must display the following acknowledgment:
- *    &quot;This product includes software developed by the OpenSSL Project
- *    for use in the OpenSSL Toolkit. (<A HREF="http://www.openssl.org/">http://www.openssl.org/</A>)&quot;
- *
- * 4. The names &quot;OpenSSL Toolkit&quot; and &quot;OpenSSL Project&quot; must not be used to
- *    endorse or promote products derived from this software without
- *    prior written permission. For written permission, please contact
- *    <A HREF="../../../mailman/listinfo/openssl-commits.html">openssl-core at openssl.org.</A>
- *
- * 5. Products derived from this software may not be called &quot;OpenSSL&quot;
- *    nor may &quot;OpenSSL&quot; appear in their names without prior written
- *    permission of the OpenSSL Project.
- *
- * 6. Redistributions of any form whatsoever must retain the following
- *    acknowledgment:
- *    &quot;This product includes software developed by the OpenSSL Project
- *    for use in the OpenSSL Toolkit (<A HREF="http://www.openssl.org/">http://www.openssl.org/</A>)&quot;
- *
- * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
- * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
- * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
- * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
- * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
- * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
- * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
- * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
- * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
- * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
- * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
- * OF THE POSSIBILITY OF SUCH DAMAGE.
- * ====================================================================
- *
- * This product includes cryptographic software written by Eric Young
- * (<A HREF="../../../mailman/listinfo/openssl-commits.html">eay at cryptsoft.com</A>).  This product includes software written by Tim
- * Hudson (<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at cryptsoft.com</A>).
- *
- */
-
-#ifndef HEADER_UBSEC_ERR_H
-# define HEADER_UBSEC_ERR_H
-
-#ifdef  __cplusplus
-extern &quot;C&quot; {
-#endif
-
-/* BEGIN ERROR CODES */
-/*
- * The following lines are auto generated by the script mkerr.pl. Any changes
- * made after this point may be overwritten when the script is next run.
- */
-static void ERR_load_UBSEC_strings(void);
-static void ERR_unload_UBSEC_strings(void);
-static void ERR_UBSEC_error(int function, int reason, char *file, int line);
-# define UBSECerr(f,r) ERR_UBSEC_error((f),(r),OPENSSL_FILE,OPENSSL_LINE)
-
-/* Error codes for the UBSEC functions. */
-
-/* Function codes. */
-# define UBSEC_F_UBSEC_CTRL                               100
-# define UBSEC_F_UBSEC_DH_COMPUTE_KEY                     101
-# define UBSEC_F_UBSEC_DH_GENERATE_KEY                    111
-# define UBSEC_F_UBSEC_DSA_DO_SIGN                        102
-# define UBSEC_F_UBSEC_DSA_VERIFY                         103
-# define UBSEC_F_UBSEC_FINISH                             104
-# define UBSEC_F_UBSEC_INIT                               105
-# define UBSEC_F_UBSEC_MOD_EXP                            106
-# define UBSEC_F_UBSEC_MOD_EXP_CRT                        110
-# define UBSEC_F_UBSEC_RAND_BYTES                         107
-# define UBSEC_F_UBSEC_RSA_MOD_EXP                        108
-# define UBSEC_F_UBSEC_RSA_MOD_EXP_CRT                    109
-
-/* Reason codes. */
-# define UBSEC_R_ALREADY_LOADED                           100
-# define UBSEC_R_BN_EXPAND_FAIL                           101
-# define UBSEC_R_CTRL_COMMAND_NOT_IMPLEMENTED             102
-# define UBSEC_R_DSO_FAILURE                              103
-# define UBSEC_R_MISSING_KEY_COMPONENTS                   104
-# define UBSEC_R_NOT_LOADED                               105
-# define UBSEC_R_REQUEST_FAILED                           106
-# define UBSEC_R_SIZE_TOO_LARGE_OR_TOO_SMALL              107
-# define UBSEC_R_UNIT_FAILURE                             108
-
-#ifdef  __cplusplus
-}
-#endif
-#endif
diff --git a/engines/vendor_defns/hw_ubsec.h b/engines/vendor_defns/hw_ubsec.h
deleted file mode 100644
index a4e67fc..0000000
--- a/engines/vendor_defns/hw_ubsec.h
+++ /dev/null
@@ -1,124 +0,0 @@
-/******************************************************************************
- *
- *  Copyright 2000
- *  Broadcom Corporation
- *  16215 Alton Parkway
- *  PO Box 57013
- *  Irvine CA 92619-7013
- *
- *****************************************************************************/
-/*
- * Broadcom Corporation uBSec SDK
- */
-/*
- * Character device header file.
- */
-/*
- * Revision History:
- *
- * October 2000 JTT Created.
- */
-
-#define MAX_PUBLIC_KEY_BITS (1024)
-#define MAX_PUBLIC_KEY_BYTES (1024/8)
-#define SHA_BIT_SIZE  (160)
-#define MAX_CRYPTO_KEY_LENGTH 24
-#define MAX_MAC_KEY_LENGTH 64
-#define UBSEC_CRYPTO_DEVICE_NAME ((unsigned char *)&quot;/dev/ubscrypt&quot;)
-#define UBSEC_KEY_DEVICE_NAME ((unsigned char *)&quot;/dev/ubskey&quot;)
-
-/* Math command types. */
-#define UBSEC_MATH_MODADD 0x0001
-#define UBSEC_MATH_MODSUB 0x0002
-#define UBSEC_MATH_MODMUL 0x0004
-#define UBSEC_MATH_MODEXP 0x0008
-#define UBSEC_MATH_MODREM 0x0010
-#define UBSEC_MATH_MODINV 0x0020
-
-typedef long ubsec_MathCommand_t;
-typedef long ubsec_RNGCommand_t;
-
-typedef struct ubsec_crypto_context_s {
-    unsigned int flags;
-    unsigned char crypto[MAX_CRYPTO_KEY_LENGTH];
-    unsigned char auth[MAX_MAC_KEY_LENGTH];
-} ubsec_crypto_context_t, *ubsec_crypto_context_p;
-
-/*
- * Predeclare the function pointer types that we dynamically load from the DSO.
- */
-
-typedef int t_UBSEC_ubsec_bytes_to_bits(unsigned char *n, int bytes);
-
-typedef int t_UBSEC_ubsec_bits_to_bytes(int bits);
-
-typedef int t_UBSEC_ubsec_open(unsigned char *device);
-
-typedef int t_UBSEC_ubsec_close(int fd);
-
-typedef int t_UBSEC_diffie_hellman_generate_ioctl(int fd,
-                                                  unsigned char *x,
-                                                  int *x_len,
-                                                  unsigned char *y,
-                                                  int *y_len,
-                                                  unsigned char *g, int g_len,
-                                                  unsigned char *m, int m_len,
-                                                  unsigned char *userX,
-                                                  int userX_len,
-                                                  int random_bits);
-
-typedef int t_UBSEC_diffie_hellman_agree_ioctl(int fd,
-                                               unsigned char *x, int x_len,
-                                               unsigned char *y, int y_len,
-                                               unsigned char *m, int m_len,
-                                               unsigned char *k, int *k_len);
-
-typedef int t_UBSEC_rsa_mod_exp_ioctl(int fd,
-                                      unsigned char *x, int x_len,
-                                      unsigned char *m, int m_len,
-                                      unsigned char *e, int e_len,
-                                      unsigned char *y, int *y_len);
-
-typedef int t_UBSEC_rsa_mod_exp_crt_ioctl(int fd,
-                                          unsigned char *x, int x_len,
-                                          unsigned char *qinv, int qinv_len,
-                                          unsigned char *edq, int edq_len,
-                                          unsigned char *q, int q_len,
-                                          unsigned char *edp, int edp_len,
-                                          unsigned char *p, int p_len,
-                                          unsigned char *y, int *y_len);
-
-typedef int t_UBSEC_dsa_sign_ioctl(int fd,
-                                   int hash, unsigned char *data,
-                                   int data_len, unsigned char *rndom,
-                                   int random_len, unsigned char *p,
-                                   int p_len, unsigned char *q, int q_len,
-                                   unsigned char *g, int g_len,
-                                   unsigned char *key, int key_len,
-                                   unsigned char *r, int *r_len,
-                                   unsigned char *s, int *s_len);
-
-typedef int t_UBSEC_dsa_verify_ioctl(int fd,
-                                     int hash, unsigned char *data,
-                                     int data_len, unsigned char *p,
-                                     int p_len, unsigned char *q, int q_len,
-                                     unsigned char *g, int g_len,
-                                     unsigned char *key, int key_len,
-                                     unsigned char *r, int r_len,
-                                     unsigned char *s, int s_len,
-                                     unsigned char *v, int *v_len);
-
-typedef int t_UBSEC_math_accelerate_ioctl(int fd, ubsec_MathCommand_t command,
-                                          unsigned char *ModN, int *ModN_len,
-                                          unsigned char *ExpE, int *ExpE_len,
-                                          unsigned char *ParamA,
-                                          int *ParamA_len,
-                                          unsigned char *ParamB,
-                                          int *ParamB_len,
-                                          unsigned char *Result,
-                                          int *Result_len);
-
-typedef int t_UBSEC_rng_ioctl(int fd, ubsec_RNGCommand_t command,
-                              unsigned char *Result, int *Result_len);
-
-typedef int t_UBSEC_max_key_len_ioctl(int fd, int *max_key_len);
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004578.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="004594.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4586">[ date ]</a>
              <a href="thread.html#4586">[ thread ]</a>
              <a href="subject.html#4586">[ subject ]</a>
              <a href="author.html#4586">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
