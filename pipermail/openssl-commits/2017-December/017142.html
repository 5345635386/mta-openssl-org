<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  OpenSSL_1_1_0-stable update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2017-December/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20OpenSSL_1_1_0-stable%20update&In-Reply-To=%3C1512764282.921761.19336.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017139.html">
   <LINK REL="Next"  HREF="017154.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  OpenSSL_1_1_0-stable update</H1>
    <B>Rich Salz</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20OpenSSL_1_1_0-stable%20update&In-Reply-To=%3C1512764282.921761.19336.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  OpenSSL_1_1_0-stable update">rsalz at openssl.org
       </A><BR>
    <I>Fri Dec  8 20:18:02 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="017139.html">[openssl-commits] [openssl]  OpenSSL_1_1_0-stable update
</A></li>
        <LI>Next message: <A HREF="017154.html">[openssl-commits] [openssl]  OpenSSL_1_1_0-stable update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17142">[ date ]</a>
              <a href="thread.html#17142">[ thread ]</a>
              <a href="subject.html#17142">[ subject ]</a>
              <a href="author.html#17142">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch OpenSSL_1_1_0-stable has been updated
       via  a836f9fa951e33a5186e2421413de0b50ed2233a (commit)
      from  62f494408dc87a264ecb8e94b59dde42d52dfefd (commit)


- Log -----------------------------------------------------------------
commit a836f9fa951e33a5186e2421413de0b50ed2233a
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
Date:   Fri Dec 8 15:17:12 2017 -0500

    Standardize syntax of sizeof(foo)
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/4876">https://github.com/openssl/openssl/pull/4876</A>)

-----------------------------------------------------------------------

Summary of changes:
 apps/app_rand.c           |   4 +-
 apps/apps.c               |  48 ++++++++---------
 apps/ciphers.c            |   2 +-
 apps/dhparam.c            |   4 +-
 apps/dsaparam.c           |   6 +--
 apps/ecparam.c            |  12 ++---
 apps/enc.c                |  22 ++++----
 apps/errstr.c             |   2 +-
 apps/ocsp.c               |   4 +-
 apps/openssl.c            |   2 +-
 apps/opt.c                |  18 +++----
 apps/passwd.c             |  20 +++----
 apps/pkcs12.c             |  10 ++--
 apps/pkcs8.c              |   4 +-
 apps/rand.c               |   2 +-
 apps/req.c                |  36 ++++++-------
 apps/s_client.c           |   8 +--
 apps/s_server.c           |  10 ++--
 apps/s_time.c             |   6 +--
 apps/speed.c              |  10 ++--
 apps/vms_term_sock.c      |  12 ++---
 apps/x509.c               |   4 +-
 crypto/asn1/a_mbstr.c     |   4 +-
 crypto/asn1/a_object.c    |   4 +-
 crypto/asn1/a_strex.c     |   8 +--
 crypto/asn1/asn1_par.c    |   8 +--
 crypto/asn1/tasn_prn.c    |   2 +-
 crypto/async/async.c      |   6 +--
 crypto/async/async_wait.c |   2 +-
 crypto/bio/b_addr.c       |   2 +-
 crypto/bio/b_dump.c       |  24 ++++-----
 crypto/bio/b_print.c      |   4 +-
 crypto/bio/bio_cb.c       |   2 +-
 crypto/bio/bss_file.c     |  10 ++--
 crypto/bn/bn_print.c      |   4 +-
 crypto/conf/conf_def.c    |   2 +-
 crypto/conf/conf_mod.c    |   2 +-
 crypto/des/ecb_enc.c      |   2 +-
 crypto/des/fcrypt.c       |   2 +-
 crypto/des/set_key.c      |   2 +-
 crypto/ec/ec_mult.c       |  12 ++---
 crypto/ec/ecp_nistp224.c  |   6 +--
 crypto/ec/ecp_nistp256.c  |   6 +--
 crypto/ec/ecp_nistp521.c  |   6 +--
 crypto/ec/ecp_smpl.c      |   2 +-
 crypto/err/err_prn.c      |   2 +-
 crypto/evp/evp_enc.c      |   6 +--
 crypto/evp/evp_pbe.c      |   4 +-
 crypto/evp/p5_crpt2.c     |   2 +-
 crypto/init.c             |   2 +-
 crypto/mem_dbg.c          |   8 +--
 crypto/mem_sec.c          |   6 +--
 crypto/objects/obj_dat.c  |   2 +-
 crypto/pem/pem_info.c     |   2 +-
 crypto/pem/pem_lib.c      |   2 +-
 crypto/rand/md_rand.c     |  10 ++--
 crypto/rand/rand_egd.c    |   2 +-
 crypto/rand/rand_unix.c   |  10 ++--
 crypto/rsa/rsa_pss.c      |   4 +-
 crypto/x509/t_x509.c      |   4 +-
 crypto/x509v3/v3_alt.c    |   4 +-
 crypto/x509v3/v3_info.c   |   2 +-
 ssl/record/rec_layer_d1.c |   4 +-
 ssl/record/rec_layer_s3.c |   8 +--
 ssl/s3_lib.c              |   2 +-
 ssl/ssl_cert.c            |   6 +--
 ssl/ssl_lib.c             |   6 +--
 ssl/ssl_sess.c            |   6 +--
 ssl/statem/statem_clnt.c  |   2 +-
 test/bftest.c             |   2 +-
 test/bntest.c             |   2 +-
 test/d2i_test.c           |   2 +-
 test/dhtest.c             |   2 +-
 test/dsatest.c            |   2 +-
 test/ectest.c             |  14 ++---
 test/exptest.c            |   8 +--
 test/igetest.c            | 134 +++++++++++++++++++++++-----------------------
 test/rsa_test.c           |   2 +-
 test/sanitytest.c         |   2 +-
 test/ssltest_old.c        |  24 ++++-----
 80 files changed, 335 insertions(+), 333 deletions(-)

diff --git a/apps/app_rand.c b/apps/app_rand.c
index 0d44af9..ff0771c 100644
--- a/apps/app_rand.c
+++ b/apps/app_rand.c
@@ -20,7 +20,7 @@ int app_RAND_load_file(const char *file, int dont_warn)
     char buffer[200];
 
     if (file == NULL)
-        file = RAND_file_name(buffer, sizeof buffer);
+        file = RAND_file_name(buffer, sizeof(buffer));
 #ifndef OPENSSL_NO_EGD
     else if (RAND_egd(file) &gt; 0) {
         /*
@@ -101,7 +101,7 @@ int app_RAND_write_file(const char *file)
         return 0;
 
     if (file == NULL)
-        file = RAND_file_name(buffer, sizeof buffer);
+        file = RAND_file_name(buffer, sizeof(buffer));
     if (file == NULL || !RAND_write_file(file)) {
         BIO_printf(bio_err, &quot;unable to write 'random state'\n&quot;);
         return 0;
diff --git a/apps/apps.c b/apps/apps.c
index d93b83b..8703d0c 100644
--- a/apps/apps.c
+++ b/apps/apps.c
@@ -1388,9 +1388,9 @@ int save_serial(const char *serialfile, const char *suffix, const BIGNUM *serial
         OPENSSL_strlcpy(buf[0], serialfile, BSIZE);
     else {
 #ifndef OPENSSL_SYS_VMS
-        j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s.%s&quot;, serialfile, suffix);
+        j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s.%s&quot;, serialfile, suffix);
 #else
-        j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s-%s&quot;, serialfile, suffix);
+        j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s-%s&quot;, serialfile, suffix);
 #endif
     }
     out = BIO_new_file(buf[0], &quot;w&quot;);
@@ -1431,11 +1431,11 @@ int rotate_serial(const char *serialfile, const char *new_suffix,
         goto err;
     }
 #ifndef OPENSSL_SYS_VMS
-    j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s.%s&quot;, serialfile, new_suffix);
-    j = BIO_snprintf(buf[1], sizeof buf[1], &quot;%s.%s&quot;, serialfile, old_suffix);
+    j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s.%s&quot;, serialfile, new_suffix);
+    j = BIO_snprintf(buf[1], sizeof(buf[1]), &quot;%s.%s&quot;, serialfile, old_suffix);
 #else
-    j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s-%s&quot;, serialfile, new_suffix);
-    j = BIO_snprintf(buf[1], sizeof buf[1], &quot;%s-%s&quot;, serialfile, old_suffix);
+    j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s-%s&quot;, serialfile, new_suffix);
+    j = BIO_snprintf(buf[1], sizeof(buf[1]), &quot;%s-%s&quot;, serialfile, old_suffix);
 #endif
     if (rename(serialfile, buf[1]) &lt; 0 &amp;&amp; errno != ENOENT
 #ifdef ENOTDIR
@@ -1504,9 +1504,9 @@ CA_DB *load_index(const char *dbfile, DB_ATTR *db_attr)
         goto err;
 
 #ifndef OPENSSL_SYS_VMS
-    BIO_snprintf(buf, sizeof buf, &quot;%s.attr&quot;, dbfile);
+    BIO_snprintf(buf, sizeof(buf), &quot;%s.attr&quot;, dbfile);
 #else
-    BIO_snprintf(buf, sizeof buf, &quot;%s-attr&quot;, dbfile);
+    BIO_snprintf(buf, sizeof(buf), &quot;%s-attr&quot;, dbfile);
 #endif
     dbattr_conf = app_load_config(buf);
 
@@ -1567,13 +1567,13 @@ int save_index(const char *dbfile, const char *suffix, CA_DB *db)
         goto err;
     }
 #ifndef OPENSSL_SYS_VMS
-    j = BIO_snprintf(buf[2], sizeof buf[2], &quot;%s.attr&quot;, dbfile);
-    j = BIO_snprintf(buf[1], sizeof buf[1], &quot;%s.attr.%s&quot;, dbfile, suffix);
-    j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s.%s&quot;, dbfile, suffix);
+    j = BIO_snprintf(buf[2], sizeof(buf[2]), &quot;%s.attr&quot;, dbfile);
+    j = BIO_snprintf(buf[1], sizeof(buf[1]), &quot;%s.attr.%s&quot;, dbfile, suffix);
+    j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s.%s&quot;, dbfile, suffix);
 #else
-    j = BIO_snprintf(buf[2], sizeof buf[2], &quot;%s-attr&quot;, dbfile);
-    j = BIO_snprintf(buf[1], sizeof buf[1], &quot;%s-attr-%s&quot;, dbfile, suffix);
-    j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s-%s&quot;, dbfile, suffix);
+    j = BIO_snprintf(buf[2], sizeof(buf[2]), &quot;%s-attr&quot;, dbfile);
+    j = BIO_snprintf(buf[1], sizeof(buf[1]), &quot;%s-attr-%s&quot;, dbfile, suffix);
+    j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s-%s&quot;, dbfile, suffix);
 #endif
     out = BIO_new_file(buf[0], &quot;w&quot;);
     if (out == NULL) {
@@ -1616,17 +1616,17 @@ int rotate_index(const char *dbfile, const char *new_suffix,
         goto err;
     }
 #ifndef OPENSSL_SYS_VMS
-    j = BIO_snprintf(buf[4], sizeof buf[4], &quot;%s.attr&quot;, dbfile);
-    j = BIO_snprintf(buf[3], sizeof buf[3], &quot;%s.attr.%s&quot;, dbfile, old_suffix);
-    j = BIO_snprintf(buf[2], sizeof buf[2], &quot;%s.attr.%s&quot;, dbfile, new_suffix);
-    j = BIO_snprintf(buf[1], sizeof buf[1], &quot;%s.%s&quot;, dbfile, old_suffix);
-    j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s.%s&quot;, dbfile, new_suffix);
+    j = BIO_snprintf(buf[4], sizeof(buf[4]), &quot;%s.attr&quot;, dbfile);
+    j = BIO_snprintf(buf[3], sizeof(buf[3]), &quot;%s.attr.%s&quot;, dbfile, old_suffix);
+    j = BIO_snprintf(buf[2], sizeof(buf[2]), &quot;%s.attr.%s&quot;, dbfile, new_suffix);
+    j = BIO_snprintf(buf[1], sizeof(buf[1]), &quot;%s.%s&quot;, dbfile, old_suffix);
+    j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s.%s&quot;, dbfile, new_suffix);
 #else
-    j = BIO_snprintf(buf[4], sizeof buf[4], &quot;%s-attr&quot;, dbfile);
-    j = BIO_snprintf(buf[3], sizeof buf[3], &quot;%s-attr-%s&quot;, dbfile, old_suffix);
-    j = BIO_snprintf(buf[2], sizeof buf[2], &quot;%s-attr-%s&quot;, dbfile, new_suffix);
-    j = BIO_snprintf(buf[1], sizeof buf[1], &quot;%s-%s&quot;, dbfile, old_suffix);
-    j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s-%s&quot;, dbfile, new_suffix);
+    j = BIO_snprintf(buf[4], sizeof(buf[4]), &quot;%s-attr&quot;, dbfile);
+    j = BIO_snprintf(buf[3], sizeof(buf[3]), &quot;%s-attr-%s&quot;, dbfile, old_suffix);
+    j = BIO_snprintf(buf[2], sizeof(buf[2]), &quot;%s-attr-%s&quot;, dbfile, new_suffix);
+    j = BIO_snprintf(buf[1], sizeof(buf[1]), &quot;%s-%s&quot;, dbfile, old_suffix);
+    j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s-%s&quot;, dbfile, new_suffix);
 #endif
     if (rename(dbfile, buf[1]) &lt; 0 &amp;&amp; errno != ENOENT
 #ifdef ENOTDIR
diff --git a/apps/ciphers.c b/apps/ciphers.c
index c0f43ea..e1b5b25 100644
--- a/apps/ciphers.c
+++ b/apps/ciphers.c
@@ -225,7 +225,7 @@ int ciphers_main(int argc, char **argv)
                 BIO_printf(bio_out, &quot;%s - &quot;, nm);
             }
 #endif
-            BIO_puts(bio_out, SSL_CIPHER_description(c, buf, sizeof buf));
+            BIO_puts(bio_out, SSL_CIPHER_description(c, buf, sizeof(buf)));
         }
     }
 
diff --git a/apps/dhparam.c b/apps/dhparam.c
index 0616333..94322e3 100644
--- a/apps/dhparam.c
+++ b/apps/dhparam.c
@@ -326,9 +326,9 @@ int dhparam_main(int argc, char **argv)
                         &quot;\n&quot;
                         &quot;    if (dh == NULL)\n&quot;
                         &quot;        return NULL;\n&quot;);
-        BIO_printf(out, &quot;    dhp_bn = BN_bin2bn(dhp_%d, sizeof (dhp_%d), NULL);\n&quot;,
+        BIO_printf(out, &quot;    dhp_bn = BN_bin2bn(dhp_%d, sizeof(dhp_%d), NULL);\n&quot;,
                    bits, bits);
-        BIO_printf(out, &quot;    dhg_bn = BN_bin2bn(dhg_%d, sizeof (dhg_%d), NULL);\n&quot;,
+        BIO_printf(out, &quot;    dhg_bn = BN_bin2bn(dhg_%d, sizeof(dhg_%d), NULL);\n&quot;,
                    bits, bits);
         BIO_printf(out, &quot;    if (dhp_bn == NULL || dhg_bn == NULL\n&quot;
                         &quot;            || !DH_set0_pqg(dh, dhp_bn, NULL, dhg_bn)) {\n&quot;
diff --git a/apps/dsaparam.c b/apps/dsaparam.c
index 9258803..dd69461 100644
--- a/apps/dsaparam.c
+++ b/apps/dsaparam.c
@@ -234,11 +234,11 @@ int dsaparam_main(int argc, char **argv)
                             &quot;\n&quot;);
         BIO_printf(bio_out, &quot;    if (dsa == NULL)\n&quot;
                             &quot;        return NULL;\n&quot;);
-        BIO_printf(bio_out, &quot;    dsa-&gt;p = BN_bin2bn(dsap_%d, sizeof (dsap_%d), NULL);\n&quot;,
+        BIO_printf(bio_out, &quot;    dsa-&gt;p = BN_bin2bn(dsap_%d, sizeof(dsap_%d), NULL);\n&quot;,
                bits_p, bits_p);
-        BIO_printf(bio_out, &quot;    dsa-&gt;q = BN_bin2bn(dsaq_%d, sizeof (dsaq_%d), NULL);\n&quot;,
+        BIO_printf(bio_out, &quot;    dsa-&gt;q = BN_bin2bn(dsaq_%d, sizeof(dsaq_%d), NULL);\n&quot;,
                bits_p, bits_p);
-        BIO_printf(bio_out, &quot;    dsa-&gt;g = BN_bin2bn(dsag_%d, sizeof (dsag_%d), NULL);\n&quot;,
+        BIO_printf(bio_out, &quot;    dsa-&gt;g = BN_bin2bn(dsag_%d, sizeof(dsag_%d), NULL);\n&quot;,
                bits_p, bits_p);
         BIO_printf(bio_out, &quot;    if (!dsa-&gt;p || !dsa-&gt;q || !dsa-&gt;g) {\n&quot;
                             &quot;        DSA_free(dsa);\n&quot;
diff --git a/apps/ecparam.c b/apps/ecparam.c
index 891a0ca..086bbeb 100644
--- a/apps/ecparam.c
+++ b/apps/ecparam.c
@@ -357,24 +357,24 @@ int ecparam_main(int argc, char **argv)
                         &quot;    BIGNUM *tmp_3 = NULL;\n&quot;
                         &quot;\n&quot;);
 
-        BIO_printf(out, &quot;    if ((tmp_1 = BN_bin2bn(ec_p_%d, sizeof (ec_p_%d), NULL)) == NULL)\n&quot;
+        BIO_printf(out, &quot;    if ((tmp_1 = BN_bin2bn(ec_p_%d, sizeof(ec_p_%d), NULL)) == NULL)\n&quot;
                         &quot;        goto err;\n&quot;, len, len);
-        BIO_printf(out, &quot;    if ((tmp_2 = BN_bin2bn(ec_a_%d, sizeof (ec_a_%d), NULL)) == NULL)\n&quot;
+        BIO_printf(out, &quot;    if ((tmp_2 = BN_bin2bn(ec_a_%d, sizeof(ec_a_%d), NULL)) == NULL)\n&quot;
                         &quot;        goto err;\n&quot;, len, len);
-        BIO_printf(out, &quot;    if ((tmp_3 = BN_bin2bn(ec_b_%d, sizeof (ec_b_%d), NULL)) == NULL)\n&quot;
+        BIO_printf(out, &quot;    if ((tmp_3 = BN_bin2bn(ec_b_%d, sizeof(ec_b_%d), NULL)) == NULL)\n&quot;
                         &quot;        goto err;\n&quot;, len, len);
         BIO_printf(out, &quot;    if ((group = EC_GROUP_new_curve_GFp(tmp_1, tmp_2, tmp_3, NULL)) == NULL)\n&quot;
                         &quot;        goto err;\n&quot;
                         &quot;\n&quot;);
         BIO_printf(out, &quot;    /* build generator */\n&quot;);
-        BIO_printf(out, &quot;    if ((tmp_1 = BN_bin2bn(ec_gen_%d, sizeof (ec_gen_%d), tmp_1)) == NULL)\n&quot;
+        BIO_printf(out, &quot;    if ((tmp_1 = BN_bin2bn(ec_gen_%d, sizeof(ec_gen_%d), tmp_1)) == NULL)\n&quot;
                         &quot;        goto err;\n&quot;, len, len);
         BIO_printf(out, &quot;    point = EC_POINT_bn2point(group, tmp_1, NULL, NULL);\n&quot;);
         BIO_printf(out, &quot;    if (point == NULL)\n&quot;
                         &quot;        goto err;\n&quot;);
-        BIO_printf(out, &quot;    if ((tmp_2 = BN_bin2bn(ec_order_%d, sizeof (ec_order_%d), tmp_2)) == NULL)\n&quot;
+        BIO_printf(out, &quot;    if ((tmp_2 = BN_bin2bn(ec_order_%d, sizeof(ec_order_%d), tmp_2)) == NULL)\n&quot;
                         &quot;        goto err;\n&quot;, len, len);
-        BIO_printf(out, &quot;    if ((tmp_3 = BN_bin2bn(ec_cofactor_%d, sizeof (ec_cofactor_%d), tmp_3)) == NULL)\n&quot;
+        BIO_printf(out, &quot;    if ((tmp_3 = BN_bin2bn(ec_cofactor_%d, sizeof(ec_cofactor_%d), tmp_3)) == NULL)\n&quot;
                         &quot;        goto err;\n&quot;, len, len);
         BIO_printf(out, &quot;    if (!EC_GROUP_set_generator(group, point, tmp_2, tmp_3))\n&quot;
                         &quot;        goto err;\n&quot;
diff --git a/apps/enc.c b/apps/enc.c
index c906563..ef65606 100644
--- a/apps/enc.c
+++ b/apps/enc.c
@@ -96,7 +96,7 @@ int enc_main(int argc, char **argv)
     char *hkey = NULL, *hiv = NULL, *hsalt = NULL, *p;
     char *infile = NULL, *outfile = NULL, *prog;
     char *str = NULL, *passarg = NULL, *pass = NULL, *strbuf = NULL;
-    char mbuf[sizeof magic - 1];
+    char mbuf[sizeof(magic) - 1];
     OPTION_CHOICE o;
     int bsize = BSIZE, verbose = 0, debug = 0, olb64 = 0, nosalt = 0;
     int enc = 1, printkey = 0, i, k;
@@ -218,7 +218,7 @@ int enc_main(int argc, char **argv)
             in = bio_open_default(opt_arg(), 'r', FORMAT_TEXT);
             if (in == NULL)
                 goto opthelp;
-            i = BIO_gets(in, buf, sizeof buf);
+            i = BIO_gets(in, buf, sizeof(buf));
             BIO_free(in);
             in = NULL;
             if (i &lt;= 0) {
@@ -311,7 +311,7 @@ int enc_main(int argc, char **argv)
             for (;;) {
                 char prompt[200];
 
-                BIO_snprintf(prompt, sizeof prompt, &quot;enter %s %s password:&quot;,
+                BIO_snprintf(prompt, sizeof(prompt), &quot;enter %s %s password:&quot;,
                              OBJ_nid2ln(EVP_CIPHER_nid(cipher)),
                              (enc) ? &quot;encryption&quot; : &quot;decryption&quot;);
                 strbuf[0] = '\0';
@@ -398,31 +398,31 @@ int enc_main(int argc, char **argv)
             else {
                 if (enc) {
                     if (hsalt) {
-                        if (!set_hex(hsalt, salt, sizeof salt)) {
+                        if (!set_hex(hsalt, salt, sizeof(salt))) {
                             BIO_printf(bio_err, &quot;invalid hex salt value\n&quot;);
                             goto end;
                         }
-                    } else if (RAND_bytes(salt, sizeof salt) &lt;= 0)
+                    } else if (RAND_bytes(salt, sizeof(salt)) &lt;= 0)
                         goto end;
                     /*
                      * If -P option then don't bother writing
                      */
                     if ((printkey != 2)
                         &amp;&amp; (BIO_write(wbio, magic,
-                                      sizeof magic - 1) != sizeof magic - 1
+                                      sizeof(magic) - 1) != sizeof(magic) - 1
                             || BIO_write(wbio,
                                          (char *)salt,
-                                         sizeof salt) != sizeof salt)) {
+                                         sizeof(salt)) != sizeof(salt))) {
                         BIO_printf(bio_err, &quot;error writing output file\n&quot;);
                         goto end;
                     }
-                } else if (BIO_read(rbio, mbuf, sizeof mbuf) != sizeof mbuf
+                } else if (BIO_read(rbio, mbuf, sizeof(mbuf)) != sizeof(mbuf)
                            || BIO_read(rbio,
                                        (unsigned char *)salt,
-                                       sizeof salt) != sizeof salt) {
+                                       sizeof(salt)) != sizeof(salt)) {
                     BIO_printf(bio_err, &quot;error reading input file\n&quot;);
                     goto end;
-                } else if (memcmp(mbuf, magic, sizeof magic - 1)) {
+                } else if (memcmp(mbuf, magic, sizeof(magic) - 1)) {
                     BIO_printf(bio_err, &quot;bad magic number\n&quot;);
                     goto end;
                 }
@@ -449,7 +449,7 @@ int enc_main(int argc, char **argv)
             int siz = EVP_CIPHER_iv_length(cipher);
             if (siz == 0) {
                 BIO_printf(bio_err, &quot;warning: iv not use by this cipher\n&quot;);
-            } else if (!set_hex(hiv, iv, sizeof iv)) {
+            } else if (!set_hex(hiv, iv, sizeof(iv))) {
                 BIO_printf(bio_err, &quot;invalid hex iv value\n&quot;);
                 goto end;
             }
diff --git a/apps/errstr.c b/apps/errstr.c
index 5fda799..79d83ee 100644
--- a/apps/errstr.c
+++ b/apps/errstr.c
@@ -58,7 +58,7 @@ int errstr_main(int argc, char **argv)
              */
             OPENSSL_init_ssl(OPENSSL_INIT_LOAD_SSL_STRINGS
                              | OPENSSL_INIT_LOAD_CRYPTO_STRINGS, NULL);
-            ERR_error_string_n(l, buf, sizeof buf);
+            ERR_error_string_n(l, buf, sizeof(buf));
             BIO_printf(bio_out, &quot;%s\n&quot;, buf);
         }
     }
diff --git a/apps/ocsp.c b/apps/ocsp.c
index 41ea970..4b53334 100644
--- a/apps/ocsp.c
+++ b/apps/ocsp.c
@@ -1074,7 +1074,7 @@ static int do_responder(OCSP_REQUEST **preq, BIO **pcbio, BIO *acbio)
     *pcbio = cbio;
 
     /* Read the request line. */
-    len = BIO_gets(cbio, reqbuf, sizeof reqbuf);
+    len = BIO_gets(cbio, reqbuf, sizeof(reqbuf));
     if (len &lt;= 0)
         return 1;
     if (strncmp(reqbuf, &quot;GET &quot;, 4) == 0) {
@@ -1116,7 +1116,7 @@ static int do_responder(OCSP_REQUEST **preq, BIO **pcbio, BIO *acbio)
 
     /* Read and skip past the headers. */
     for (;;) {
-        len = BIO_gets(cbio, inbuf, sizeof inbuf);
+        len = BIO_gets(cbio, inbuf, sizeof(inbuf));
         if (len &lt;= 0)
             return 1;
         if ((inbuf[0] == '\r') || (inbuf[0] == '\n'))
diff --git a/apps/openssl.c b/apps/openssl.c
index 6e7b02c..31962cd 100644
--- a/apps/openssl.c
+++ b/apps/openssl.c
@@ -188,7 +188,7 @@ int main(int argc, char *argv[])
     for (;;) {
         ret = 0;
         /* Read a line, continue reading if line ends with \ */
-        for (p = buf, n = sizeof buf, i = 0, first = 1; n &gt; 0; first = 0) {
+        for (p = buf, n = sizeof(buf), i = 0, first = 1; n &gt; 0; first = 0) {
             prompt = first ? &quot;OpenSSL&gt; &quot; : &quot;&gt; &quot;;
             p[0] = '\0';
 #ifndef READLINE
diff --git a/apps/opt.c b/apps/opt.c
index 4c3a26e..6e40f64 100644
--- a/apps/opt.c
+++ b/apps/opt.c
@@ -60,8 +60,8 @@ char *opt_progname(const char *argv0)
         n -= 4;
 
     /* Copy over the name, in lowercase. */
-    if (n &gt; sizeof prog - 1)
-        n = sizeof prog - 1;
+    if (n &gt; sizeof(prog) - 1)
+        n = sizeof(prog) - 1;
     for (q = prog, i = 0; i &lt; n; i++, p++)
         *q++ = tolower((unsigned char)*p);
     *q = '\0';
@@ -82,9 +82,9 @@ char *opt_progname(const char *argv0)
         }
 
     q = strrchr(p, '.');
-    strncpy(prog, p, sizeof prog - 1);
-    prog[sizeof prog - 1] = '\0';
-    if (q != NULL &amp;&amp; q - p &lt; sizeof prog)
+    strncpy(prog, p, sizeof(prog) - 1);
+    prog[sizeof(prog) - 1] = '\0';
+    if (q != NULL &amp;&amp; q - p &lt; sizeof(prog))
         prog[q - p] = '\0';
     return prog;
 }
@@ -101,8 +101,8 @@ char *opt_progname(const char *argv0)
             p++;
             break;
         }
-    strncpy(prog, p, sizeof prog - 1);
-    prog[sizeof prog - 1] = '\0';
+    strncpy(prog, p, sizeof(prog) - 1);
+    prog[sizeof(prog) - 1] = '\0';
     return prog;
 }
 #endif
@@ -840,7 +840,7 @@ void opt_help(const OPTIONS *list)
             i += 1 + strlen(valtype2param(o));
         if (i &lt; MAX_OPT_HELP_WIDTH &amp;&amp; i &gt; width)
             width = i;
-        assert(i &lt; (int)sizeof start);
+        assert(i &lt; (int)sizeof(start));
     }
 
     if (standard_prolog)
@@ -857,7 +857,7 @@ void opt_help(const OPTIONS *list)
 
         /* Pad out prefix */
         memset(start, ' ', sizeof(start) - 1);
-        start[sizeof start - 1] = '\0';
+        start[sizeof(start) - 1] = '\0';
 
         if (o-&gt;name == OPT_MORE_STR) {
             /* Continuation of previous line; pad and print. */
diff --git a/apps/passwd.c b/apps/passwd.c
index 85577fa..f2b0d9a 100644
--- a/apps/passwd.c
+++ b/apps/passwd.c
@@ -249,7 +249,7 @@ int passwd_main(int argc, char **argv)
                     /* ignore rest of line */
                     char trash[BUFSIZ];
                     do
-                        r = BIO_gets(in, trash, sizeof trash);
+                        r = BIO_gets(in, trash, sizeof(trash));
                     while ((r &gt; 0) &amp;&amp; (!strchr(trash, '\n')));
                 }
 
@@ -300,9 +300,9 @@ static char *md5crypt(const char *passwd, const char *magic, const char *salt)
     if (magic_len &gt; 4)    /* assert it's  &quot;1&quot; or &quot;apr1&quot; */
         return NULL;
 
-    OPENSSL_strlcat(out_buf, magic, sizeof out_buf);
-    OPENSSL_strlcat(out_buf, &quot;$&quot;, sizeof out_buf);
-    OPENSSL_strlcat(out_buf, salt, sizeof out_buf);
+    OPENSSL_strlcat(out_buf, magic, sizeof(out_buf));
+    OPENSSL_strlcat(out_buf, &quot;$&quot;, sizeof(out_buf));
+    OPENSSL_strlcat(out_buf, salt, sizeof(out_buf));
 
     if (strlen(out_buf) &gt; 6 + 8) /* assert &quot;$apr1$..salt..&quot; */
         return NULL;
@@ -332,8 +332,8 @@ static char *md5crypt(const char *passwd, const char *magic, const char *salt)
         || !EVP_DigestFinal_ex(md2, buf, NULL))
         goto err;
 
-    for (i = passwd_len; i &gt; sizeof buf; i -= sizeof buf) {
-        if (!EVP_DigestUpdate(md, buf, sizeof buf))
+    for (i = passwd_len; i &gt; sizeof(buf); i -= sizeof(buf)) {
+        if (!EVP_DigestUpdate(md, buf, sizeof(buf)))
             goto err;
     }
     if (!EVP_DigestUpdate(md, buf, i))
@@ -353,7 +353,7 @@ static char *md5crypt(const char *passwd, const char *magic, const char *salt)
             goto err;
         if (!EVP_DigestUpdate(md2,
                               (i &amp; 1) ? (unsigned const char *)passwd : buf,
-                              (i &amp; 1) ? passwd_len : sizeof buf))
+                              (i &amp; 1) ? passwd_len : sizeof(buf)))
             goto err;
         if (i % 3) {
             if (!EVP_DigestUpdate(md2, salt_out, salt_len))
@@ -365,7 +365,7 @@ static char *md5crypt(const char *passwd, const char *magic, const char *salt)
         }
         if (!EVP_DigestUpdate(md2,
                               (i &amp; 1) ? buf : (unsigned const char *)passwd,
-                              (i &amp; 1) ? sizeof buf : passwd_len))
+                              (i &amp; 1) ? sizeof(buf) : passwd_len))
                 goto err;
         if (!EVP_DigestFinal_ex(md2, buf, NULL))
                 goto err;
@@ -377,7 +377,7 @@ static char *md5crypt(const char *passwd, const char *magic, const char *salt)
 
     {
         /* transform buf into output string */
-        unsigned char buf_perm[sizeof buf];
+        unsigned char buf_perm[sizeof(buf)];
         int dest, source;
         char *output;
 
@@ -389,7 +389,7 @@ static char *md5crypt(const char *passwd, const char *magic, const char *salt)
         buf_perm[15] = buf[11];
 #  ifndef PEDANTIC              /* Unfortunately, this generates a &quot;no
                                  * effect&quot; warning */
-        assert(16 == sizeof buf_perm);
+        assert(16 == sizeof(buf_perm));
 #  endif
 
         output = salt_out + salt_len;
diff --git a/apps/pkcs12.c b/apps/pkcs12.c
index 6c07e81..85f649d 100644
--- a/apps/pkcs12.c
+++ b/apps/pkcs12.c
@@ -323,7 +323,7 @@ int pkcs12_main(int argc, char **argv)
         if (1) {
 #ifndef OPENSSL_NO_UI
             if (EVP_read_pw_string
-                (macpass, sizeof macpass, &quot;Enter MAC Password:&quot;, export_cert)) {
+                (macpass, sizeof(macpass), &quot;Enter MAC Password:&quot;, export_cert)) {
                 BIO_printf(bio_err, &quot;Can't read Password\n&quot;);
                 goto end;
             }
@@ -440,7 +440,7 @@ int pkcs12_main(int argc, char **argv)
         if (!noprompt) {
             if (1) {
 #ifndef OPENSSL_NO_UI
-                if (EVP_read_pw_string(pass, sizeof pass, &quot;Enter Export Password:&quot;,
+                if (EVP_read_pw_string(pass, sizeof(pass), &quot;Enter Export Password:&quot;,
                                        1)) {
                     BIO_printf(bio_err, &quot;Can't read Password\n&quot;);
                     goto export_end;
@@ -453,7 +453,7 @@ int pkcs12_main(int argc, char **argv)
         }
 
         if (!twopass)
-            OPENSSL_strlcpy(macpass, pass, sizeof macpass);
+            OPENSSL_strlcpy(macpass, pass, sizeof(macpass));
 
         p12 = PKCS12_create(cpass, name, key, ucert, certs,
                             key_pbe, cert_pbe, iter, -1, keytype);
@@ -506,7 +506,7 @@ int pkcs12_main(int argc, char **argv)
     if (!noprompt) {
         if (1) {
 #ifndef OPENSSL_NO_UI
-            if (EVP_read_pw_string(pass, sizeof pass, &quot;Enter Import Password:&quot;,
+            if (EVP_read_pw_string(pass, sizeof(pass), &quot;Enter Import Password:&quot;,
                                    0)) {
                 BIO_printf(bio_err, &quot;Can't read Password\n&quot;);
                 goto end;
@@ -519,7 +519,7 @@ int pkcs12_main(int argc, char **argv)
     }
 
     if (!twopass)
-        OPENSSL_strlcpy(macpass, pass, sizeof macpass);
+        OPENSSL_strlcpy(macpass, pass, sizeof(macpass));
 
     if ((options &amp; INFO) &amp;&amp; PKCS12_mac_present(p12)) {
         const ASN1_INTEGER *tmaciter;
diff --git a/apps/pkcs8.c b/apps/pkcs8.c
index 4b3fa10..0874370 100644
--- a/apps/pkcs8.c
+++ b/apps/pkcs8.c
@@ -238,7 +238,7 @@ int pkcs8_main(int argc, char **argv)
 #ifndef OPENSSL_NO_UI
                 p8pass = pass;
                 if (EVP_read_pw_string
-                    (pass, sizeof pass, &quot;Enter Encryption Password:&quot;, 1)) {
+                    (pass, sizeof(pass), &quot;Enter Encryption Password:&quot;, 1)) {
                     X509_ALGOR_free(pbe);
                     goto end;
                 }
@@ -300,7 +300,7 @@ int pkcs8_main(int argc, char **argv)
         else if (1) {
 #ifndef OPENSSL_NO_UI
             p8pass = pass;
-            if (EVP_read_pw_string(pass, sizeof pass, &quot;Enter Password:&quot;, 0)) {
+            if (EVP_read_pw_string(pass, sizeof(pass), &quot;Enter Password:&quot;, 0)) {
                 BIO_printf(bio_err, &quot;Can't read Password\n&quot;);
                 goto end;
             }
diff --git a/apps/rand.c b/apps/rand.c
index e726180..21c9a7a 100644
--- a/apps/rand.c
+++ b/apps/rand.c
@@ -102,7 +102,7 @@ int rand_main(int argc, char **argv)
 
         chunk = num;
         if (chunk &gt; (int)sizeof(buf))
-            chunk = sizeof buf;
+            chunk = sizeof(buf);
         r = RAND_bytes(buf, chunk);
         if (r &lt;= 0)
             goto end;
diff --git a/apps/req.c b/apps/req.c
index a749925..2a21569 100644
--- a/apps/req.c
+++ b/apps/req.c
@@ -973,7 +973,7 @@ static int prompt_info(X509_REQ *req,
             /* If OBJ not recognised ignore it */
             if ((nid = OBJ_txt2nid(type)) == NID_undef)
                 goto start;
-            if (BIO_snprintf(buf, sizeof buf, &quot;%s_default&quot;, v-&gt;name)
+            if (BIO_snprintf(buf, sizeof(buf), &quot;%s_default&quot;, v-&gt;name)
                 &gt;= (int)sizeof(buf)) {
                 BIO_printf(bio_err, &quot;Name '%s' too long\n&quot;, v-&gt;name);
                 return 0;
@@ -984,19 +984,19 @@ static int prompt_info(X509_REQ *req,
                 def = &quot;&quot;;
             }
 
-            BIO_snprintf(buf, sizeof buf, &quot;%s_value&quot;, v-&gt;name);
+            BIO_snprintf(buf, sizeof(buf), &quot;%s_value&quot;, v-&gt;name);
             if ((value = NCONF_get_string(req_conf, dn_sect, buf)) == NULL) {
                 ERR_clear_error();
                 value = NULL;
             }
 
-            BIO_snprintf(buf, sizeof buf, &quot;%s_min&quot;, v-&gt;name);
+            BIO_snprintf(buf, sizeof(buf), &quot;%s_min&quot;, v-&gt;name);
             if (!NCONF_get_number(req_conf, dn_sect, buf, &amp;n_min)) {
                 ERR_clear_error();
                 n_min = -1;
             }
 
-            BIO_snprintf(buf, sizeof buf, &quot;%s_max&quot;, v-&gt;name);
+            BIO_snprintf(buf, sizeof(buf), &quot;%s_max&quot;, v-&gt;name);
             if (!NCONF_get_number(req_conf, dn_sect, buf, &amp;n_max)) {
                 ERR_clear_error();
                 n_max = -1;
@@ -1032,7 +1032,7 @@ static int prompt_info(X509_REQ *req,
                 if ((nid = OBJ_txt2nid(type)) == NID_undef)
                     goto start2;
 
-                if (BIO_snprintf(buf, sizeof buf, &quot;%s_default&quot;, type)
+                if (BIO_snprintf(buf, sizeof(buf), &quot;%s_default&quot;, type)
                     &gt;= (int)sizeof(buf)) {
                     BIO_printf(bio_err, &quot;Name '%s' too long\n&quot;, v-&gt;name);
                     return 0;
@@ -1044,20 +1044,20 @@ static int prompt_info(X509_REQ *req,
                     def = &quot;&quot;;
                 }
 
-                BIO_snprintf(buf, sizeof buf, &quot;%s_value&quot;, type);
+                BIO_snprintf(buf, sizeof(buf), &quot;%s_value&quot;, type);
                 if ((value = NCONF_get_string(req_conf, attr_sect, buf))
                     == NULL) {
                     ERR_clear_error();
                     value = NULL;
                 }
 
-                BIO_snprintf(buf, sizeof buf, &quot;%s_min&quot;, type);
+                BIO_snprintf(buf, sizeof(buf), &quot;%s_min&quot;, type);
                 if (!NCONF_get_number(req_conf, attr_sect, buf, &amp;n_min)) {
                     ERR_clear_error();
                     n_min = -1;
                 }
 
-                BIO_snprintf(buf, sizeof buf, &quot;%s_max&quot;, type);
+                BIO_snprintf(buf, sizeof(buf), &quot;%s_max&quot;, type);
                 if (!NCONF_get_number(req_conf, attr_sect, buf, &amp;n_max)) {
                     ERR_clear_error();
                     n_max = -1;
@@ -1155,13 +1155,13 @@ static int add_DN_object(X509_NAME *n, char *text, const char *def,
         BIO_printf(bio_err, &quot;%s [%s]:&quot;, text, def);
     (void)BIO_flush(bio_err);
     if (value != NULL) {
-        OPENSSL_strlcpy(buf, value, sizeof buf);
-        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        OPENSSL_strlcpy(buf, value, sizeof(buf));
+        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof(buf));
         BIO_printf(bio_err, &quot;%s\n&quot;, value);
     } else {
         buf[0] = '\0';
         if (!batch) {
-            if (!fgets(buf, sizeof buf, stdin))
+            if (!fgets(buf, sizeof(buf), stdin))
                 return 0;
         } else {
             buf[0] = '\n';
@@ -1174,8 +1174,8 @@ static int add_DN_object(X509_NAME *n, char *text, const char *def,
     else if (buf[0] == '\n') {
         if ((def == NULL) || (def[0] == '\0'))
             return (1);
-        OPENSSL_strlcpy(buf, def, sizeof buf);
-        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        OPENSSL_strlcpy(buf, def, sizeof(buf));
+        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof(buf));
     } else if ((buf[0] == '.') &amp;&amp; (buf[1] == '\n'))
         return (1);
 
@@ -1214,13 +1214,13 @@ static int add_attribute_object(X509_REQ *req, char *text, const char *def,
         BIO_printf(bio_err, &quot;%s [%s]:&quot;, text, def);
     (void)BIO_flush(bio_err);
     if (value != NULL) {
-        OPENSSL_strlcpy(buf, value, sizeof buf);
-        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        OPENSSL_strlcpy(buf, value, sizeof(buf));
+        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof(buf));
         BIO_printf(bio_err, &quot;%s\n&quot;, value);
     } else {
         buf[0] = '\0';
         if (!batch) {
-            if (!fgets(buf, sizeof buf, stdin))
+            if (!fgets(buf, sizeof(buf), stdin))
                 return 0;
         } else {
             buf[0] = '\n';
@@ -1233,8 +1233,8 @@ static int add_attribute_object(X509_REQ *req, char *text, const char *def,
     else if (buf[0] == '\n') {
         if ((def == NULL) || (def[0] == '\0'))
             return (1);
-        OPENSSL_strlcpy(buf, def, sizeof buf);
-        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        OPENSSL_strlcpy(buf, def, sizeof(buf));
+        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof(buf));
     } else if ((buf[0] == '.') &amp;&amp; (buf[1] == '\n'))
         return (1);
 
diff --git a/apps/s_client.c b/apps/s_client.c
index 2f1b228..fab007a 100644
--- a/apps/s_client.c
+++ b/apps/s_client.c
@@ -2536,10 +2536,10 @@ static void print_stuff(BIO *bio, SSL *s, int full)
             BIO_printf(bio, &quot;---\nCertificate chain\n&quot;);
             for (i = 0; i &lt; sk_X509_num(sk); i++) {
                 X509_NAME_oneline(X509_get_subject_name(sk_X509_value(sk, i)),
-                                  buf, sizeof buf);
+                                  buf, sizeof(buf));
                 BIO_printf(bio, &quot;%2d s:%s\n&quot;, i, buf);
                 X509_NAME_oneline(X509_get_issuer_name(sk_X509_value(sk, i)),
-                                  buf, sizeof buf);
+                                  buf, sizeof(buf));
                 BIO_printf(bio, &quot;   i:%s\n&quot;, buf);
                 if (c_showcerts)
                     PEM_write_bio_X509(bio, sk_X509_value(sk, i));
@@ -2554,9 +2554,9 @@ static void print_stuff(BIO *bio, SSL *s, int full)
             /* Redundant if we showed the whole chain */
             if (!(c_showcerts &amp;&amp; got_a_chain))
                 PEM_write_bio_X509(bio, peer);
-            X509_NAME_oneline(X509_get_subject_name(peer), buf, sizeof buf);
+            X509_NAME_oneline(X509_get_subject_name(peer), buf, sizeof(buf));
             BIO_printf(bio, &quot;subject=%s\n&quot;, buf);
-            X509_NAME_oneline(X509_get_issuer_name(peer), buf, sizeof buf);
+            X509_NAME_oneline(X509_get_issuer_name(peer), buf, sizeof(buf));
             BIO_printf(bio, &quot;issuer=%s\n&quot;, buf);
         } else
             BIO_printf(bio, &quot;no peer certificate available\n&quot;);
diff --git a/apps/s_server.c b/apps/s_server.c
index f6418af..09e608a 100644
--- a/apps/s_server.c
+++ b/apps/s_server.c
@@ -1853,7 +1853,7 @@ int s_server_main(int argc, char *argv[])
     SSL_CTX_set_verify(ctx, s_server_verify, verify_callback);
     if (!SSL_CTX_set_session_id_context(ctx,
                                         (void *)&amp;s_server_session_id_context,
-                                        sizeof s_server_session_id_context)) {
+                                        sizeof(s_server_session_id_context))) {
         BIO_printf(bio_err, &quot;error setting session id context\n&quot;);
         ERR_print_errors(bio_err);
         goto end;
@@ -1867,7 +1867,7 @@ int s_server_main(int argc, char *argv[])
         SSL_CTX_set_verify(ctx2, s_server_verify, verify_callback);
         if (!SSL_CTX_set_session_id_context(ctx2,
                     (void *)&amp;s_server_session_id_context,
-                    sizeof s_server_session_id_context)) {
+                    sizeof(s_server_session_id_context))) {
             BIO_printf(bio_err, &quot;error setting session id context\n&quot;);
             ERR_print_errors(bio_err);
             goto end;
@@ -2535,15 +2535,15 @@ static int init_ssl_connection(SSL *con)
     if (peer != NULL) {
         BIO_printf(bio_s_out, &quot;Client certificate\n&quot;);
         PEM_write_bio_X509(bio_s_out, peer);
-        X509_NAME_oneline(X509_get_subject_name(peer), buf, sizeof buf);
+        X509_NAME_oneline(X509_get_subject_name(peer), buf, sizeof(buf));
         BIO_printf(bio_s_out, &quot;subject=%s\n&quot;, buf);
-        X509_NAME_oneline(X509_get_issuer_name(peer), buf, sizeof buf);
+        X509_NAME_oneline(X509_get_issuer_name(peer), buf, sizeof(buf));
         BIO_printf(bio_s_out, &quot;issuer=%s\n&quot;, buf);
         X509_free(peer);
         peer = NULL;
     }
 
-    if (SSL_get_shared_ciphers(con, buf, sizeof buf) != NULL)
+    if (SSL_get_shared_ciphers(con, buf, sizeof(buf)) != NULL)
         BIO_printf(bio_s_out, &quot;Shared ciphers:%s\n&quot;, buf);
     str = SSL_CIPHER_get_name(SSL_get_current_cipher(con));
     ssl_print_sigalgs(bio_s_out, con);
diff --git a/apps/s_time.c b/apps/s_time.c
index 3459573..cb2a4fd 100644
--- a/apps/s_time.c
+++ b/apps/s_time.c
@@ -225,7 +225,7 @@ int s_time_main(int argc, char **argv)
             goto end;
 
         if (www_path != NULL) {
-            buf_len = BIO_snprintf(buf, sizeof buf,
+            buf_len = BIO_snprintf(buf, sizeof(buf),
                                    fmt_http_get_cmd, www_path);
             if (SSL_write(scon, buf, buf_len) &lt;= 0)
                 goto end;
@@ -285,7 +285,7 @@ int s_time_main(int argc, char **argv)
     }
 
     if (www_path != NULL) {
-        buf_len = BIO_snprintf(buf, sizeof buf,
+        buf_len = BIO_snprintf(buf, sizeof(buf),
                                fmt_http_get_cmd, www_path);
         if (SSL_write(scon, buf, buf_len) &lt;= 0)
             goto end;
@@ -318,7 +318,7 @@ int s_time_main(int argc, char **argv)
             goto end;
 
         if (www_path) {
-            BIO_snprintf(buf, sizeof buf, &quot;GET %s HTTP/1.0\r\n\r\n&quot;,
+            BIO_snprintf(buf, sizeof(buf), &quot;GET %s HTTP/1.0\r\n\r\n&quot;,
                          www_path);
             if (SSL_write(scon, buf, strlen(buf)) &lt;= 0)
                 goto end;
diff --git a/apps/speed.c b/apps/speed.c
index 5ee58d9..bcc5d8e 100644
--- a/apps/speed.c
+++ b/apps/speed.c
@@ -2401,7 +2401,7 @@ int speed_main(int argc, char **argv)
 
 #ifndef OPENSSL_NO_DSA
     if (RAND_status() != 1) {
-        RAND_seed(rnd_seed, sizeof rnd_seed);
+        RAND_seed(rnd_seed, sizeof(rnd_seed));
     }
     for (testnum = 0; testnum &lt; DSA_NUM; testnum++) {
         int st = 0;
@@ -2469,7 +2469,7 @@ int speed_main(int argc, char **argv)
 
 #ifndef OPENSSL_NO_EC
     if (RAND_status() != 1) {
-        RAND_seed(rnd_seed, sizeof rnd_seed);
+        RAND_seed(rnd_seed, sizeof(rnd_seed));
     }
     for (testnum = 0; testnum &lt; EC_NUM; testnum++) {
         int st = 1;
@@ -2553,7 +2553,7 @@ int speed_main(int argc, char **argv)
     }
 
     if (RAND_status() != 1) {
-        RAND_seed(rnd_seed, sizeof rnd_seed);
+        RAND_seed(rnd_seed, sizeof(rnd_seed));
     }
     for (testnum = 0; testnum &lt; EC_NUM; testnum++) {
         int ecdh_checks = 1;
@@ -2876,7 +2876,7 @@ static char *sstrsep(char **string, const char *delim)
     if (**string == 0)
         return NULL;
 
-    memset(isdelim, 0, sizeof isdelim);
+    memset(isdelim, 0, sizeof(isdelim));
     isdelim[0] = 1;
 
     while (*delim) {
@@ -2937,7 +2937,7 @@ static int do_multi(int multi)
         char *p;
 
         f = fdopen(fds[n], &quot;r&quot;);
-        while (fgets(buf, sizeof buf, f)) {
+        while (fgets(buf, sizeof(buf), f)) {
             p = strchr(buf, '\n');
             if (p)
                 *p = '\0';
diff --git a/apps/vms_term_sock.c b/apps/vms_term_sock.c
index a7d87ff..bc0c173 100644
--- a/apps/vms_term_sock.c
+++ b/apps/vms_term_sock.c
@@ -143,7 +143,7 @@ int main (int argc, char *argv[], char *envp[])
         ** Process the terminal input
         */
         LogMessage (&quot;Waiting on terminal I/O ...\n&quot;);
-        len = recv (TermSock, TermBuff, sizeof (TermBuff), 0) ;
+        len = recv (TermSock, TermBuff, sizeof(TermBuff), 0) ;
         TermBuff[len] = '\0';
         LogMessage (&quot;Received terminal I/O [%s]&quot;, TermBuff);
 
@@ -209,7 +209,7 @@ int TerminalSocket (int FunctionCode, int *ReturnSocket)
                           TerminalDeviceAst,
                           0,
                           TerminalDeviceBuff,
-                          sizeof (TerminalDeviceBuff) - 2,
+                          sizeof(TerminalDeviceBuff) - 2,
                           0, 0, 0, 0);
         if (! (status &amp; 1)) {
             LogMessage (&quot;TerminalSocket: SYS$QIO () - %08X&quot;, status);
@@ -317,7 +317,7 @@ static int CreateSocketPair (int SocketFamily,
     /*
     ** Initialize the socket information
     */
-    slen = sizeof (sin);
+    slen = sizeof(sin);
     memset ((char *) &amp;sin, 0, slen);
     sin.sin_family = SocketFamily;
     sin.sin_addr.s_addr = inet_addr (LocalHostAddr);
@@ -434,12 +434,12 @@ static int CreateSocketPair (int SocketFamily,
     /*
     ** Now issue the connect
     */
-    memset ((char *) &amp;sin, 0, sizeof (sin)) ;
+    memset ((char *) &amp;sin, 0, sizeof(sin)) ;
     sin.sin_family = SocketFamily;
     sin.sin_addr.s_addr = inet_addr (LocalHostAddr) ;
     sin.sin_port = LocalHostPort ;
 
-    status = connect (SockDesc2, (struct sockaddr *) &amp;sin, sizeof (sin));
+    status = connect (SockDesc2, (struct sockaddr *) &amp;sin, sizeof(sin));
     if (status &lt; 0 ) {
         LogMessage (&quot;CreateSocketPair: connect () - %d&quot;, errno);
         sys$cantim (&amp;sptb, 0);
@@ -528,7 +528,7 @@ static int TerminalDeviceAst (int astparm)
                       TerminalDeviceAst,
                       0,
                       TerminalDeviceBuff,
-                      sizeof (TerminalDeviceBuff) - 1,
+                      sizeof(TerminalDeviceBuff) - 1,
                       0, 0, 0, 0);
 
     /*
diff --git a/apps/x509.c b/apps/x509.c
index cc5fbca..fd39116 100644
--- a/apps/x509.c
+++ b/apps/x509.c
@@ -726,11 +726,11 @@ int x509_main(int argc, char **argv)
                 char *m;
                 int len;
 
-                X509_NAME_oneline(X509_get_subject_name(x), buf, sizeof buf);
+                X509_NAME_oneline(X509_get_subject_name(x), buf, sizeof(buf));
                 BIO_printf(out, &quot;/*\n&quot;
                                 &quot; * Subject: %s\n&quot;, buf);
 
-                X509_NAME_oneline(X509_get_issuer_name(x), buf, sizeof buf);
+                X509_NAME_oneline(X509_get_issuer_name(x), buf, sizeof(buf));
                 BIO_printf(out, &quot; * Issuer:  %s\n&quot;
                                 &quot; */\n&quot;, buf);
 
diff --git a/crypto/asn1/a_mbstr.c b/crypto/asn1/a_mbstr.c
index 5578e92..7a035af 100644
--- a/crypto/asn1/a_mbstr.c
+++ b/crypto/asn1/a_mbstr.c
@@ -100,14 +100,14 @@ int ASN1_mbstring_ncopy(ASN1_STRING **out, const unsigned char *in, int len,
 
     if ((minsize &gt; 0) &amp;&amp; (nchar &lt; minsize)) {
         ASN1err(ASN1_F_ASN1_MBSTRING_NCOPY, ASN1_R_STRING_TOO_SHORT);
-        BIO_snprintf(strbuf, sizeof strbuf, &quot;%ld&quot;, minsize);
+        BIO_snprintf(strbuf, sizeof(strbuf), &quot;%ld&quot;, minsize);
         ERR_add_error_data(2, &quot;minsize=&quot;, strbuf);
         return -1;
     }
 
     if ((maxsize &gt; 0) &amp;&amp; (nchar &gt; maxsize)) {
         ASN1err(ASN1_F_ASN1_MBSTRING_NCOPY, ASN1_R_STRING_TOO_LONG);
-        BIO_snprintf(strbuf, sizeof strbuf, &quot;%ld&quot;, maxsize);
+        BIO_snprintf(strbuf, sizeof(strbuf), &quot;%ld&quot;, maxsize);
         ERR_add_error_data(2, &quot;maxsize=&quot;, strbuf);
         return -1;
     }
diff --git a/crypto/asn1/a_object.c b/crypto/asn1/a_object.c
index 79f0ecd..1ec7a7e 100644
--- a/crypto/asn1/a_object.c
+++ b/crypto/asn1/a_object.c
@@ -42,7 +42,7 @@ int a2d_ASN1_OBJECT(unsigned char *out, int olen, const char *buf, int num)
 {
     int i, first, len = 0, c, use_bn;
     char ftmp[24], *tmp = ftmp;
-    int tmpsize = sizeof ftmp;
+    int tmpsize = sizeof(ftmp);
     const char *p;
     unsigned long l;
     BIGNUM *bl = NULL;
@@ -177,7 +177,7 @@ int i2a_ASN1_OBJECT(BIO *bp, const ASN1_OBJECT *a)
 
     if ((a == NULL) || (a-&gt;data == NULL))
         return (BIO_write(bp, &quot;NULL&quot;, 4));
-    i = i2t_ASN1_OBJECT(buf, sizeof buf, a);
+    i = i2t_ASN1_OBJECT(buf, sizeof(buf), a);
     if (i &gt; (int)(sizeof(buf) - 1)) {
         p = OPENSSL_malloc(i + 1);
         if (p == NULL)
diff --git a/crypto/asn1/a_strex.c b/crypto/asn1/a_strex.c
index 933dda9..b91266b 100644
--- a/crypto/asn1/a_strex.c
+++ b/crypto/asn1/a_strex.c
@@ -73,13 +73,13 @@ static int do_esc_char(unsigned long c, unsigned short flags, char *do_quotes,
     if (c &gt; 0xffffffffL)
         return -1;
     if (c &gt; 0xffff) {
-        BIO_snprintf(tmphex, sizeof tmphex, &quot;\\W%08lX&quot;, c);
+        BIO_snprintf(tmphex, sizeof(tmphex), &quot;\\W%08lX&quot;, c);
         if (!io_ch(arg, tmphex, 10))
             return -1;
         return 10;
     }
     if (c &gt; 0xff) {
-        BIO_snprintf(tmphex, sizeof tmphex, &quot;\\U%04lX&quot;, c);
+        BIO_snprintf(tmphex, sizeof(tmphex), &quot;\\U%04lX&quot;, c);
         if (!io_ch(arg, tmphex, 6))
             return -1;
         return 6;
@@ -183,7 +183,7 @@ static int do_buf(unsigned char *buf, int buflen,
         if (type &amp; BUF_TYPE_CONVUTF8) {
             unsigned char utfbuf[6];
             int utflen;
-            utflen = UTF8_putc(utfbuf, sizeof utfbuf, c);
+            utflen = UTF8_putc(utfbuf, sizeof(utfbuf), c);
             for (i = 0; i &lt; utflen; i++) {
                 /*
                  * We don't need to worry about setting orflags correctly
@@ -478,7 +478,7 @@ static int do_name_ex(char_io *io_ch, void *arg, const X509_NAME *n,
         if (fn_opt != XN_FLAG_FN_NONE) {
             int objlen, fld_len;
             if ((fn_opt == XN_FLAG_FN_OID) || (fn_nid == NID_undef)) {
-                OBJ_obj2txt(objtmp, sizeof objtmp, fn, 1);
+                OBJ_obj2txt(objtmp, sizeof(objtmp), fn, 1);
                 fld_len = 0;    /* XXX: what should this be? */
                 objbuf = objtmp;
             } else {
diff --git a/crypto/asn1/asn1_par.c b/crypto/asn1/asn1_par.c
index af045cb..fabc8d6 100644
--- a/crypto/asn1/asn1_par.c
+++ b/crypto/asn1/asn1_par.c
@@ -38,13 +38,13 @@ static int asn1_print_info(BIO *bp, int tag, int xclass, int constructed,
 
     p = str;
     if ((xclass &amp; V_ASN1_PRIVATE) == V_ASN1_PRIVATE)
-        BIO_snprintf(str, sizeof str, &quot;priv [ %d ] &quot;, tag);
+        BIO_snprintf(str, sizeof(str), &quot;priv [ %d ] &quot;, tag);
     else if ((xclass &amp; V_ASN1_CONTEXT_SPECIFIC) == V_ASN1_CONTEXT_SPECIFIC)
-        BIO_snprintf(str, sizeof str, &quot;cont [ %d ]&quot;, tag);
+        BIO_snprintf(str, sizeof(str), &quot;cont [ %d ]&quot;, tag);
     else if ((xclass &amp; V_ASN1_APPLICATION) == V_ASN1_APPLICATION)
-        BIO_snprintf(str, sizeof str, &quot;appl [ %d ]&quot;, tag);
+        BIO_snprintf(str, sizeof(str), &quot;appl [ %d ]&quot;, tag);
     else if (tag &gt; 30)
-        BIO_snprintf(str, sizeof str, &quot;&lt;ASN1 %d&gt;&quot;, tag);
+        BIO_snprintf(str, sizeof(str), &quot;&lt;ASN1 %d&gt;&quot;, tag);
     else
         p = ASN1_tag2str(tag);
 
diff --git a/crypto/asn1/tasn_prn.c b/crypto/asn1/tasn_prn.c
index f53e905..53a9ee8 100644
--- a/crypto/asn1/tasn_prn.c
+++ b/crypto/asn1/tasn_prn.c
@@ -409,7 +409,7 @@ static int asn1_print_oid(BIO *out, const ASN1_OBJECT *oid)
     ln = OBJ_nid2ln(OBJ_obj2nid(oid));
     if (!ln)
         ln = &quot;&quot;;
-    OBJ_obj2txt(objbuf, sizeof objbuf, oid, 1);
+    OBJ_obj2txt(objbuf, sizeof(objbuf), oid, 1);
     if (BIO_printf(out, &quot;%s (%s)&quot;, ln, objbuf) &lt;= 0)
         return 0;
     return 1;
diff --git a/crypto/async/async.c b/crypto/async/async.c
index 8c699af..9a4e6b2 100644
--- a/crypto/async/async.c
+++ b/crypto/async/async.c
@@ -36,7 +36,7 @@ static async_ctx *async_ctx_new(void)
 {
     async_ctx *nctx = NULL;
 
-    nctx = OPENSSL_malloc(sizeof (async_ctx));
+    nctx = OPENSSL_malloc(sizeof(async_ctx));
     if (nctx == NULL) {
         ASYNCerr(ASYNC_F_ASYNC_CTX_NEW, ERR_R_MALLOC_FAILURE);
         goto err;
@@ -81,7 +81,7 @@ static ASYNC_JOB *async_job_new(void)
 {
     ASYNC_JOB *job = NULL;
 
-    job = OPENSSL_zalloc(sizeof (ASYNC_JOB));
+    job = OPENSSL_zalloc(sizeof(ASYNC_JOB));
     if (job == NULL) {
         ASYNCerr(ASYNC_F_ASYNC_JOB_NEW, ERR_R_MALLOC_FAILURE);
         return NULL;
@@ -330,7 +330,7 @@ int ASYNC_init_thread(size_t max_size, size_t init_size)
         return 0;
     }
 
-    pool = OPENSSL_zalloc(sizeof *pool);
+    pool = OPENSSL_zalloc(sizeof(*pool));
     if (pool == NULL) {
         ASYNCerr(ASYNC_F_ASYNC_INIT_THREAD, ERR_R_MALLOC_FAILURE);
         return 0;
diff --git a/crypto/async/async_wait.c b/crypto/async/async_wait.c
index e115985..0a0bf87 100644
--- a/crypto/async/async_wait.c
+++ b/crypto/async/async_wait.c
@@ -47,7 +47,7 @@ int ASYNC_WAIT_CTX_set_wait_fd(ASYNC_WAIT_CTX *ctx, const void *key,
 {
     struct fd_lookup_st *fdlookup;
 
-    fdlookup = OPENSSL_zalloc(sizeof *fdlookup);
+    fdlookup = OPENSSL_zalloc(sizeof(*fdlookup));
     if (fdlookup == NULL)
         return 0;
 
diff --git a/crypto/bio/b_addr.c b/crypto/bio/b_addr.c
index 6c2b0e9..aea843a 100644
--- a/crypto/bio/b_addr.c
+++ b/crypto/bio/b_addr.c
@@ -668,7 +668,7 @@ int BIO_lookup(const char *host, const char *service,
         int gai_ret = 0;
         struct addrinfo hints;
 
-        memset(&amp;hints, 0, sizeof hints);
+        memset(&amp;hints, 0, sizeof(hints));
 
         hints.ai_family = family;
         hints.ai_socktype = socktype;
diff --git a/crypto/bio/b_dump.c b/crypto/bio/b_dump.c
index a27954f..c8601cb 100644
--- a/crypto/bio/b_dump.c
+++ b/crypto/bio/b_dump.c
@@ -54,36 +54,36 @@ int BIO_dump_indent_cb(int (*cb) (const void *data, size_t len, void *u),
     if ((rows * dump_width) &lt; len)
         rows++;
     for (i = 0; i &lt; rows; i++) {
-        OPENSSL_strlcpy(buf, str, sizeof buf);
-        BIO_snprintf(tmp, sizeof tmp, &quot;%04x - &quot;, i * dump_width);
-        OPENSSL_strlcat(buf, tmp, sizeof buf);
+        OPENSSL_strlcpy(buf, str, sizeof(buf));
+        BIO_snprintf(tmp, sizeof(tmp), &quot;%04x - &quot;, i * dump_width);
+        OPENSSL_strlcat(buf, tmp, sizeof(buf));
         for (j = 0; j &lt; dump_width; j++) {
             if (((i * dump_width) + j) &gt;= len) {
-                OPENSSL_strlcat(buf, &quot;   &quot;, sizeof buf);
+                OPENSSL_strlcat(buf, &quot;   &quot;, sizeof(buf));
             } else {
                 ch = ((unsigned char)*(s + i * dump_width + j)) &amp; 0xff;
-                BIO_snprintf(tmp, sizeof tmp, &quot;%02x%c&quot;, ch,
+                BIO_snprintf(tmp, sizeof(tmp), &quot;%02x%c&quot;, ch,
                              j == 7 ? '-' : ' ');
-                OPENSSL_strlcat(buf, tmp, sizeof buf);
+                OPENSSL_strlcat(buf, tmp, sizeof(buf));
             }
         }
-        OPENSSL_strlcat(buf, &quot;  &quot;, sizeof buf);
+        OPENSSL_strlcat(buf, &quot;  &quot;, sizeof(buf));
         for (j = 0; j &lt; dump_width; j++) {
             if (((i * dump_width) + j) &gt;= len)
                 break;
             ch = ((unsigned char)*(s + i * dump_width + j)) &amp; 0xff;
 #ifndef CHARSET_EBCDIC
-            BIO_snprintf(tmp, sizeof tmp, &quot;%c&quot;,
+            BIO_snprintf(tmp, sizeof(tmp), &quot;%c&quot;,
                          ((ch &gt;= ' ') &amp;&amp; (ch &lt;= '~')) ? ch : '.');
 #else
-            BIO_snprintf(tmp, sizeof tmp, &quot;%c&quot;,
+            BIO_snprintf(tmp, sizeof(tmp), &quot;%c&quot;,
                          ((ch &gt;= os_toascii[' ']) &amp;&amp; (ch &lt;= os_toascii['~']))
                          ? os_toebcdic[ch]
                          : '.');
 #endif
-            OPENSSL_strlcat(buf, tmp, sizeof buf);
+            OPENSSL_strlcat(buf, tmp, sizeof(buf));
         }
-        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        OPENSSL_strlcat(buf, &quot;\n&quot;, sizeof(buf));
         /*
          * if this is the last call then update the ddt_dump thing so that we
          * will move the selection point in the debug window
@@ -92,7 +92,7 @@ int BIO_dump_indent_cb(int (*cb) (const void *data, size_t len, void *u),
     }
 #ifdef TRUNCATE
     if (trc &gt; 0) {
-        BIO_snprintf(buf, sizeof buf, &quot;%s%04x - &lt;SPACES/NULS&gt;\n&quot;, str,
+        BIO_snprintf(buf, sizeof(buf), &quot;%s%04x - &lt;SPACES/NULS&gt;\n&quot;, str,
                      len + trc);
         ret += cb((void *)buf, strlen(buf), u);
     }
diff --git a/crypto/bio/b_print.c b/crypto/bio/b_print.c
index 2dbfa12..cdfe05f 100644
--- a/crypto/bio/b_print.c
+++ b/crypto/bio/b_print.c
@@ -665,7 +665,7 @@ fmtfp(char **sbuffer,
         iconvert[iplace++] = &quot;0123456789&quot;[intpart % 10];
         intpart = (intpart / 10);
     } while (intpart &amp;&amp; (iplace &lt; (int)sizeof(iconvert)));
-    if (iplace == sizeof iconvert)
+    if (iplace == sizeof(iconvert))
         iplace--;
     iconvert[iplace] = 0;
 
@@ -683,7 +683,7 @@ fmtfp(char **sbuffer,
         fracpart = (fracpart / 10);
     }
 
-    if (fplace == sizeof fconvert)
+    if (fplace == sizeof(fconvert))
         fplace--;
     fconvert[fplace] = 0;
 
diff --git a/crypto/bio/bio_cb.c b/crypto/bio/bio_cb.c
index 69ea3d0..412387b 100644
--- a/crypto/bio/bio_cb.c
+++ b/crypto/bio/bio_cb.c
@@ -27,7 +27,7 @@ long BIO_debug_callback(BIO *bio, int cmd, const char *argp,
     if (BIO_CB_RETURN &amp; cmd)
         r = ret;
 
-    len = BIO_snprintf(buf, sizeof buf, &quot;BIO[%p]: &quot;, (void *)bio);
+    len = BIO_snprintf(buf, sizeof(buf), &quot;BIO[%p]: &quot;, (void *)bio);
 
     /* Ignore errors and continue printing the other information. */
     if (len &lt; 0)
diff --git a/crypto/bio/bss_file.c b/crypto/bio/bss_file.c
index e3d8c0e..ee18ff3 100644
--- a/crypto/bio/bss_file.c
+++ b/crypto/bio/bss_file.c
@@ -267,15 +267,15 @@ static long file_ctrl(BIO *b, int cmd, long num, void *ptr)
         b-&gt;shutdown = (int)num &amp; BIO_CLOSE;
         if (num &amp; BIO_FP_APPEND) {
             if (num &amp; BIO_FP_READ)
-                OPENSSL_strlcpy(p, &quot;a+&quot;, sizeof p);
+                OPENSSL_strlcpy(p, &quot;a+&quot;, sizeof(p));
             else
-                OPENSSL_strlcpy(p, &quot;a&quot;, sizeof p);
+                OPENSSL_strlcpy(p, &quot;a&quot;, sizeof(p));
         } else if ((num &amp; BIO_FP_READ) &amp;&amp; (num &amp; BIO_FP_WRITE))
-            OPENSSL_strlcpy(p, &quot;r+&quot;, sizeof p);
+            OPENSSL_strlcpy(p, &quot;r+&quot;, sizeof(p));
         else if (num &amp; BIO_FP_WRITE)
-            OPENSSL_strlcpy(p, &quot;w&quot;, sizeof p);
+            OPENSSL_strlcpy(p, &quot;w&quot;, sizeof(p));
         else if (num &amp; BIO_FP_READ)
-            OPENSSL_strlcpy(p, &quot;r&quot;, sizeof p);
+            OPENSSL_strlcpy(p, &quot;r&quot;, sizeof(p));
         else {
             BIOerr(BIO_F_FILE_CTRL, BIO_R_BAD_FOPEN_MODE);
             ret = 0;
diff --git a/crypto/bn/bn_print.c b/crypto/bn/bn_print.c
index 8216760..5ffe2fc 100644
--- a/crypto/bn/bn_print.c
+++ b/crypto/bn/bn_print.c
@@ -332,10 +332,10 @@ char *BN_options(void)
     if (!init) {
         init++;
 #ifdef BN_LLONG
-        BIO_snprintf(data, sizeof data, &quot;bn(%d,%d)&quot;,
+        BIO_snprintf(data, sizeof(data), &quot;bn(%d,%d)&quot;,
                      (int)sizeof(BN_ULLONG) * 8, (int)sizeof(BN_ULONG) * 8);
 #else
-        BIO_snprintf(data, sizeof data, &quot;bn(%d,%d)&quot;,
+        BIO_snprintf(data, sizeof(data), &quot;bn(%d,%d)&quot;,
                      (int)sizeof(BN_ULONG) * 8, (int)sizeof(BN_ULONG) * 8);
 #endif
     }
diff --git a/crypto/conf/conf_def.c b/crypto/conf/conf_def.c
index a7b11d1..b443903 100644
--- a/crypto/conf/conf_def.c
+++ b/crypto/conf/conf_def.c
@@ -353,7 +353,7 @@ static int def_load_bio(CONF *conf, BIO *in, long *line)
     OPENSSL_free(section);
     if (line != NULL)
         *line = eline;
-    BIO_snprintf(btmp, sizeof btmp, &quot;%ld&quot;, eline);
+    BIO_snprintf(btmp, sizeof(btmp), &quot;%ld&quot;, eline);
     ERR_add_error_data(2, &quot;line &quot;, btmp);
     if (h != conf-&gt;data) {
         CONF_free(conf-&gt;data);
diff --git a/crypto/conf/conf_mod.c b/crypto/conf/conf_mod.c
index 31f838e..543a8ea 100644
--- a/crypto/conf/conf_mod.c
+++ b/crypto/conf/conf_mod.c
@@ -171,7 +171,7 @@ static int module_run(const CONF *cnf, const char *name, const char *value,
         if (!(flags &amp; CONF_MFLAGS_SILENT)) {
             char rcode[DECIMAL_SIZE(ret) + 1];
             CONFerr(CONF_F_MODULE_RUN, CONF_R_MODULE_INITIALIZATION_ERROR);
-            BIO_snprintf(rcode, sizeof rcode, &quot;%-8d&quot;, ret);
+            BIO_snprintf(rcode, sizeof(rcode), &quot;%-8d&quot;, ret);
             ERR_add_error_data(6, &quot;module=&quot;, name, &quot;, value=&quot;, value,
                                &quot;, retcode=&quot;, rcode);
         }
diff --git a/crypto/des/ecb_enc.c b/crypto/des/ecb_enc.c
index bd130c6..32df460 100644
--- a/crypto/des/ecb_enc.c
+++ b/crypto/des/ecb_enc.c
@@ -24,7 +24,7 @@ const char *DES_options(void)
             size = &quot;int&quot;;
         else
             size = &quot;long&quot;;
-        BIO_snprintf(buf, sizeof buf, &quot;des(%s)&quot;, size);
+        BIO_snprintf(buf, sizeof(buf), &quot;des(%s)&quot;, size);
         init = 0;
     }
     return (buf);
diff --git a/crypto/des/fcrypt.c b/crypto/des/fcrypt.c
index 5215ad3..baede4f 100644
--- a/crypto/des/fcrypt.c
+++ b/crypto/des/fcrypt.c
@@ -77,7 +77,7 @@ char *DES_crypt(const char *buf, const char *salt)
 
     /* Convert password to ASCII. */
     OPENSSL_strlcpy(e_buf, buf, sizeof(e_buf));
-    ebcdic2ascii(e_buf, e_buf, sizeof e_buf);
+    ebcdic2ascii(e_buf, e_buf, sizeof(e_buf));
 
     /* Encrypt it (from/to ASCII); if it worked, convert back. */
     ret = DES_fcrypt(e_buf, e_salt, buff);
diff --git a/crypto/des/set_key.c b/crypto/des/set_key.c
index 795d954..dc88b8d 100644
--- a/crypto/des/set_key.c
+++ b/crypto/des/set_key.c
@@ -319,7 +319,7 @@ void DES_set_key_unchecked(const_DES_cblock *key, DES_key_schedule *schedule)
     register int i;
 
 #ifdef OPENBSD_DEV_CRYPTO
-    memcpy(schedule-&gt;key, key, sizeof schedule-&gt;key);
+    memcpy(schedule-&gt;key, key, sizeof(schedule-&gt;key));
     schedule-&gt;session = NULL;
 #endif
     k = &amp;schedule-&gt;ks-&gt;deslong[0];
diff --git a/crypto/ec/ec_mult.c b/crypto/ec/ec_mult.c
index 0360462..b39777f 100644
--- a/crypto/ec/ec_mult.c
+++ b/crypto/ec/ec_mult.c
@@ -222,11 +222,11 @@ int ec_wNAF_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *scalar,
 
     totalnum = num + numblocks;
 
-    wsize = OPENSSL_malloc(totalnum * sizeof wsize[0]);
-    wNAF_len = OPENSSL_malloc(totalnum * sizeof wNAF_len[0]);
-    wNAF = OPENSSL_malloc((totalnum + 1) * sizeof wNAF[0]); /* includes space
-                                                             * for pivot */
-    val_sub = OPENSSL_malloc(totalnum * sizeof val_sub[0]);
+    wsize = OPENSSL_malloc(totalnum * sizeof(wsize[0]));
+    wNAF_len = OPENSSL_malloc(totalnum * sizeof(wNAF_len[0]));
+    /* include space for pivot */
+    wNAF = OPENSSL_malloc((totalnum + 1) * sizeof(wNAF[0]));
+    val_sub = OPENSSL_malloc(totalnum * sizeof(val_sub[0]));
 
     /* Ensure wNAF is initialised in case we end up going to err */
     if (wNAF != NULL)
@@ -372,7 +372,7 @@ int ec_wNAF_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *scalar,
      * 'val_sub[i]' is a pointer to the subarray for the i-th point, or to a
      * subarray of 'pre_comp-&gt;points' if we already have precomputation.
      */
-    val = OPENSSL_malloc((num_val + 1) * sizeof val[0]);
+    val = OPENSSL_malloc((num_val + 1) * sizeof(val[0]));
     if (val == NULL) {
         ECerr(EC_F_EC_WNAF_MUL, ERR_R_MALLOC_FAILURE);
         goto err;
diff --git a/crypto/ec/ecp_nistp224.c b/crypto/ec/ecp_nistp224.c
index c9bf078..1ff1344 100644
--- a/crypto/ec/ecp_nistp224.c
+++ b/crypto/ec/ecp_nistp224.c
@@ -337,7 +337,7 @@ static int BN_to_felem(felem out, const BIGNUM *bn)
     /* BN_bn2bin eats leading zeroes */
     memset(b_out, 0, sizeof(b_out));
     num_bytes = BN_num_bytes(bn);
-    if (num_bytes &gt; sizeof b_out) {
+    if (num_bytes &gt; sizeof(b_out)) {
         ECerr(EC_F_BN_TO_FELEM, EC_R_BIGNUM_OUT_OF_RANGE);
         return 0;
     }
@@ -356,8 +356,8 @@ static BIGNUM *felem_to_BN(BIGNUM *out, const felem in)
 {
     felem_bytearray b_in, b_out;
     felem_to_bin28(b_in, in);
-    flip_endian(b_out, b_in, sizeof b_out);
-    return BN_bin2bn(b_out, sizeof b_out, out);
+    flip_endian(b_out, b_in, sizeof(b_out));
+    return BN_bin2bn(b_out, sizeof(b_out), out);
 }
 
 /******************************************************************************/
diff --git a/crypto/ec/ecp_nistp256.c b/crypto/ec/ecp_nistp256.c
index 6822a4b..119be01 100644
--- a/crypto/ec/ecp_nistp256.c
+++ b/crypto/ec/ecp_nistp256.c
@@ -165,7 +165,7 @@ static int BN_to_felem(felem out, const BIGNUM *bn)
     /* BN_bn2bin eats leading zeroes */
     memset(b_out, 0, sizeof(b_out));
     num_bytes = BN_num_bytes(bn);
-    if (num_bytes &gt; sizeof b_out) {
+    if (num_bytes &gt; sizeof(b_out)) {
         ECerr(EC_F_BN_TO_FELEM, EC_R_BIGNUM_OUT_OF_RANGE);
         return 0;
     }
@@ -184,8 +184,8 @@ static BIGNUM *smallfelem_to_BN(BIGNUM *out, const smallfelem in)
 {
     felem_bytearray b_in, b_out;
     smallfelem_to_bin32(b_in, in);
-    flip_endian(b_out, b_in, sizeof b_out);
-    return BN_bin2bn(b_out, sizeof b_out, out);
+    flip_endian(b_out, b_in, sizeof(b_out));
+    return BN_bin2bn(b_out, sizeof(b_out), out);
 }
 
 /*-
diff --git a/crypto/ec/ecp_nistp521.c b/crypto/ec/ecp_nistp521.c
index 725cd92..def8f93 100644
--- a/crypto/ec/ecp_nistp521.c
+++ b/crypto/ec/ecp_nistp521.c
@@ -188,7 +188,7 @@ static int BN_to_felem(felem out, const BIGNUM *bn)
     /* BN_bn2bin eats leading zeroes */
     memset(b_out, 0, sizeof(b_out));
     num_bytes = BN_num_bytes(bn);
-    if (num_bytes &gt; sizeof b_out) {
+    if (num_bytes &gt; sizeof(b_out)) {
         ECerr(EC_F_BN_TO_FELEM, EC_R_BIGNUM_OUT_OF_RANGE);
         return 0;
     }
@@ -207,8 +207,8 @@ static BIGNUM *felem_to_BN(BIGNUM *out, const felem in)
 {
     felem_bytearray b_in, b_out;
     felem_to_bin66(b_in, in);
-    flip_endian(b_out, b_in, sizeof b_out);
-    return BN_bin2bn(b_out, sizeof b_out, out);
+    flip_endian(b_out, b_in, sizeof(b_out));
+    return BN_bin2bn(b_out, sizeof(b_out), out);
 }
 
 /*-
diff --git a/crypto/ec/ecp_smpl.c b/crypto/ec/ecp_smpl.c
index 76e0caf..abd3795 100644
--- a/crypto/ec/ecp_smpl.c
+++ b/crypto/ec/ecp_smpl.c
@@ -1221,7 +1221,7 @@ int ec_GFp_simple_points_make_affine(const EC_GROUP *group, size_t num,
     if (tmp == NULL || tmp_Z == NULL)
         goto err;
 
-    prod_Z = OPENSSL_malloc(num * sizeof prod_Z[0]);
+    prod_Z = OPENSSL_malloc(num * sizeof(prod_Z[0]));
     if (prod_Z == NULL)
         goto err;
     for (i = 0; i &lt; num; i++) {
diff --git a/crypto/err/err_prn.c b/crypto/err/err_prn.c
index c7dc1d1..6ae1251 100644
--- a/crypto/err/err_prn.c
+++ b/crypto/err/err_prn.c
@@ -35,7 +35,7 @@ void ERR_print_errors_cb(int (*cb) (const char *str, size_t len, void *u),
     tid.tid = CRYPTO_THREAD_get_current_id();
 
     while ((l = ERR_get_error_line_data(&amp;file, &amp;line, &amp;data, &amp;flags)) != 0) {
-        ERR_error_string_n(l, buf, sizeof buf);
+        ERR_error_string_n(l, buf, sizeof(buf));
         BIO_snprintf(buf2, sizeof(buf2), &quot;%lu:%s:%s:%d:%s\n&quot;, tid.ltid, buf,
                      file, line, (flags &amp; ERR_TXT_STRING) ? data : &quot;&quot;);
         if (cb(buf2, strlen(buf2), u) &lt;= 0)
diff --git a/crypto/evp/evp_enc.c b/crypto/evp/evp_enc.c
index 5ea14cd..e5807ed 100644
--- a/crypto/evp/evp_enc.c
+++ b/crypto/evp/evp_enc.c
@@ -392,7 +392,7 @@ int EVP_EncryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
     }
 
     b = ctx-&gt;cipher-&gt;block_size;
-    OPENSSL_assert(b &lt;= sizeof ctx-&gt;buf);
+    OPENSSL_assert(b &lt;= sizeof(ctx-&gt;buf));
     if (b == 1) {
         *outl = 0;
         return 1;
@@ -453,7 +453,7 @@ int EVP_DecryptUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl,
     if (ctx-&gt;flags &amp; EVP_CIPH_NO_PADDING)
         return EVP_EncryptUpdate(ctx, out, outl, in, inl);
 
-    OPENSSL_assert(b &lt;= sizeof ctx-&gt;final);
+    OPENSSL_assert(b &lt;= sizeof(ctx-&gt;final));
 
     if (ctx-&gt;final_used) {
         /* see comment about PTRDIFF_T comparison above */
@@ -525,7 +525,7 @@ int EVP_DecryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
             EVPerr(EVP_F_EVP_DECRYPTFINAL_EX, EVP_R_WRONG_FINAL_BLOCK_LENGTH);
             return (0);
         }
-        OPENSSL_assert(b &lt;= sizeof ctx-&gt;final);
+        OPENSSL_assert(b &lt;= sizeof(ctx-&gt;final));
 
         /*
          * The following assumes that the ciphertext has been authenticated.
diff --git a/crypto/evp/evp_pbe.c b/crypto/evp/evp_pbe.c
index ce7aa2c..eb7344c 100644
--- a/crypto/evp/evp_pbe.c
+++ b/crypto/evp/evp_pbe.c
@@ -90,9 +90,9 @@ int EVP_PBE_CipherInit(ASN1_OBJECT *pbe_obj, const char *pass, int passlen,
         char obj_tmp[80];
         EVPerr(EVP_F_EVP_PBE_CIPHERINIT, EVP_R_UNKNOWN_PBE_ALGORITHM);
         if (!pbe_obj)
-            OPENSSL_strlcpy(obj_tmp, &quot;NULL&quot;, sizeof obj_tmp);
+            OPENSSL_strlcpy(obj_tmp, &quot;NULL&quot;, sizeof(obj_tmp));
         else
-            i2t_ASN1_OBJECT(obj_tmp, sizeof obj_tmp, pbe_obj);
+            i2t_ASN1_OBJECT(obj_tmp, sizeof(obj_tmp), pbe_obj);
         ERR_add_error_data(2, &quot;TYPE=&quot;, obj_tmp);
         return 0;
     }
diff --git a/crypto/evp/p5_crpt2.c b/crypto/evp/p5_crpt2.c
index 365e240..6d5f289 100644
--- a/crypto/evp/p5_crpt2.c
+++ b/crypto/evp/p5_crpt2.c
@@ -215,7 +215,7 @@ int PKCS5_v2_PBKDF2_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass,
         goto err;
     }
     keylen = EVP_CIPHER_CTX_key_length(ctx);
-    OPENSSL_assert(keylen &lt;= sizeof key);
+    OPENSSL_assert(keylen &lt;= sizeof(key));
 
     /* Decode parameter */
 
diff --git a/crypto/init.c b/crypto/init.c
index cf65b14..173eac3 100644
--- a/crypto/init.c
+++ b/crypto/init.c
@@ -42,7 +42,7 @@ static struct thread_local_inits_st *ossl_init_get_thread_local(int alloc)
         CRYPTO_THREAD_get_local(&amp;threadstopkey);
 
     if (local == NULL &amp;&amp; alloc) {
-        local = OPENSSL_zalloc(sizeof *local);
+        local = OPENSSL_zalloc(sizeof(*local));
         if (local != NULL &amp;&amp; !CRYPTO_THREAD_set_local(&amp;threadstopkey, local)) {
             OPENSSL_free(local);
             return NULL;
diff --git a/crypto/mem_dbg.c b/crypto/mem_dbg.c
index dc3f8ff..c884078 100644
--- a/crypto/mem_dbg.c
+++ b/crypto/mem_dbg.c
@@ -466,7 +466,7 @@ static void print_leak(const MEM *m, MEM_LEAK *l)
     } tid;
     CRYPTO_THREAD_ID ti;
 
-#define BUF_REMAIN (sizeof buf - (size_t)(bufp - buf))
+#define BUF_REMAIN (sizeof(buf) - (size_t)(bufp - buf))
 
     lcl = localtime(&amp;m-&gt;time);
     BIO_snprintf(bufp, BUF_REMAIN, &quot;[%02d:%02d:%02d] &quot;,
@@ -505,7 +505,7 @@ static void print_leak(const MEM *m, MEM_LEAK *l)
             memset(buf, '&gt;', ami_cnt);
             tid.ltid = 0;
             tid.tid = amip-&gt;threadid;
-            BIO_snprintf(buf + ami_cnt, sizeof buf - ami_cnt,
+            BIO_snprintf(buf + ami_cnt, sizeof(buf) - ami_cnt,
                          &quot; thread=%lu, file=%s, line=%d, info=\&quot;&quot;,
                          tid.ltid, amip-&gt;file,
                          amip-&gt;line);
@@ -515,10 +515,10 @@ static void print_leak(const MEM *m, MEM_LEAK *l)
                 memcpy(buf + buf_len, amip-&gt;info, 128 - buf_len - 3);
                 buf_len = 128 - 3;
             } else {
-                OPENSSL_strlcpy(buf + buf_len, amip-&gt;info, sizeof buf - buf_len);
+                OPENSSL_strlcpy(buf + buf_len, amip-&gt;info, sizeof(buf) - buf_len);
                 buf_len = strlen(buf);
             }
-            BIO_snprintf(buf + buf_len, sizeof buf - buf_len, &quot;\&quot;\n&quot;);
+            BIO_snprintf(buf + buf_len, sizeof(buf) - buf_len, &quot;\&quot;\n&quot;);
 
             BIO_puts(l-&gt;bio, buf);
 
diff --git a/crypto/mem_sec.c b/crypto/mem_sec.c
index 2a08b21..341347b 100644
--- a/crypto/mem_sec.c
+++ b/crypto/mem_sec.c
@@ -373,7 +373,7 @@ static int sh_init(size_t size, int minsize)
     size_t pgsize;
     size_t aligned;
 
-    memset(&amp;sh, 0, sizeof sh);
+    memset(&amp;sh, 0, sizeof(sh));
 
     /* make sure size and minsize are powers of 2 */
     OPENSSL_assert(size &gt; 0);
@@ -400,7 +400,7 @@ static int sh_init(size_t size, int minsize)
     for (i = sh.bittable_size; i; i &gt;&gt;= 1)
         sh.freelist_size++;
 
-    sh.freelist = OPENSSL_zalloc(sh.freelist_size * sizeof (char *));
+    sh.freelist = OPENSSL_zalloc(sh.freelist_size * sizeof(char *));
     OPENSSL_assert(sh.freelist != NULL);
     if (sh.freelist == NULL)
         goto err;
@@ -486,7 +486,7 @@ static void sh_done()
     OPENSSL_free(sh.bitmalloc);
     if (sh.map_result != NULL &amp;&amp; sh.map_size)
         munmap(sh.map_result, sh.map_size);
-    memset(&amp;sh, 0, sizeof sh);
+    memset(&amp;sh, 0, sizeof(sh));
 }
 
 static int sh_allocated(const char *ptr)
diff --git a/crypto/objects/obj_dat.c b/crypto/objects/obj_dat.c
index eb9c470..53109ac 100644
--- a/crypto/objects/obj_dat.c
+++ b/crypto/objects/obj_dat.c
@@ -500,7 +500,7 @@ int OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no_name)
             n += i;
             OPENSSL_free(bndec);
         } else {
-            BIO_snprintf(tbuf, sizeof tbuf, &quot;.%lu&quot;, l);
+            BIO_snprintf(tbuf, sizeof(tbuf), &quot;.%lu&quot;, l);
             i = strlen(tbuf);
             if (buf &amp;&amp; (buf_len &gt; 0)) {
                 OPENSSL_strlcpy(buf, tbuf, buf_len);
diff --git a/crypto/pem/pem_info.c b/crypto/pem/pem_info.c
index dd493c8..78d4476 100644
--- a/crypto/pem/pem_info.c
+++ b/crypto/pem/pem_info.c
@@ -294,7 +294,7 @@ int PEM_X509_INFO_write_bio(BIO *bp, X509_INFO *xi, EVP_CIPHER *enc,
             /* create the right magic header stuff */
             OPENSSL_assert(strlen(objstr) + 23
                            + 2 * EVP_CIPHER_iv_length(enc) + 13 &lt;=
-                           sizeof buf);
+                           sizeof(buf));
             buf[0] = '\0';
             PEM_proc_type(buf, PEM_TYPE_ENCRYPTED);
             PEM_dek_info(buf, objstr, EVP_CIPHER_iv_length(enc),
diff --git a/crypto/pem/pem_lib.c b/crypto/pem/pem_lib.c
index 3f53fd8..e9202f4 100644
--- a/crypto/pem/pem_lib.c
+++ b/crypto/pem/pem_lib.c
@@ -357,7 +357,7 @@ int PEM_ASN1_write_bio(i2d_of_void *i2d, const char *name, BIO *bp,
             OPENSSL_cleanse(buf, PEM_BUFSIZE);
 
         OPENSSL_assert(strlen(objstr) + 23 + 2 * EVP_CIPHER_iv_length(enc) + 13
-                       &lt;= sizeof buf);
+                       &lt;= sizeof(buf));
 
         buf[0] = '\0';
         PEM_proc_type(buf, PEM_TYPE_ENCRYPTED);
diff --git a/crypto/rand/md_rand.c b/crypto/rand/md_rand.c
index fee722a..7d5fcb7 100644
--- a/crypto/rand/md_rand.c
+++ b/crypto/rand/md_rand.c
@@ -169,7 +169,7 @@ static int rand_add(const void *buf, int num, double add)
     md_c[0] = md_count[0];
     md_c[1] = md_count[1];
 
-    memcpy(local_md, md, sizeof md);
+    memcpy(local_md, md, sizeof(md));
 
     /* state_index &lt;= state_num &lt;= STATE_SIZE */
     state_index += num;
@@ -416,7 +416,7 @@ static int rand_bytes(unsigned char *buf, int num, int pseudo)
     st_num = state_num;
     md_c[0] = md_count[0];
     md_c[1] = md_count[1];
-    memcpy(local_md, md, sizeof md);
+    memcpy(local_md, md, sizeof(md));
 
     state_index += num_ceil;
     if (state_index &gt; state_num)
@@ -442,15 +442,15 @@ static int rand_bytes(unsigned char *buf, int num, int pseudo)
             goto err;
 #ifndef GETPID_IS_MEANINGLESS
         if (curr_pid) {         /* just in the first iteration to save time */
-            if (!MD_Update(m, (unsigned char *)&amp;curr_pid, sizeof curr_pid))
+            if (!MD_Update(m, (unsigned char *)&amp;curr_pid, sizeof(curr_pid)))
                 goto err;
             curr_pid = 0;
         }
 #endif
         if (curr_time) {        /* just in the first iteration to save time */
-            if (!MD_Update(m, (unsigned char *)&amp;curr_time, sizeof curr_time))
+            if (!MD_Update(m, (unsigned char *)&amp;curr_time, sizeof(curr_time)))
                 goto err;
-            if (!MD_Update(m, (unsigned char *)&amp;tv, sizeof tv))
+            if (!MD_Update(m, (unsigned char *)&amp;tv, sizeof(tv)))
                 goto err;
             curr_time = 0;
             if (!rand_hw_seed(m))
diff --git a/crypto/rand/rand_egd.c b/crypto/rand/rand_egd.c
index dd58b21..50963b8 100644
--- a/crypto/rand/rand_egd.c
+++ b/crypto/rand/rand_egd.c
@@ -102,7 +102,7 @@ int RAND_query_egd_bytes(const char *path, unsigned char *buf, int bytes)
     addr.sun_family = AF_UNIX;
     if (strlen(path) &gt;= sizeof(addr.sun_path))
         return (-1);
-    OPENSSL_strlcpy(addr.sun_path, path, sizeof addr.sun_path);
+    OPENSSL_strlcpy(addr.sun_path, path, sizeof(addr.sun_path));
     len = offsetof(struct sockaddr_un, sun_path) + strlen(path);
     fd = socket(AF_UNIX, SOCK_STREAM, 0);
     if (fd == -1)
diff --git a/crypto/rand/rand_unix.c b/crypto/rand/rand_unix.c
index ecba2dc..7a5a948 100644
--- a/crypto/rand/rand_unix.c
+++ b/crypto/rand/rand_unix.c
@@ -80,15 +80,15 @@ int RAND_poll(void)
      */
 
     curr_gid = getgid();
-    RAND_add(&amp;curr_gid, sizeof curr_gid, 1);
+    RAND_add(&amp;curr_gid, sizeof(curr_gid), 1);
     curr_gid = 0;
 
     curr_pid = getpid();
-    RAND_add(&amp;curr_pid, sizeof curr_pid, 1);
+    RAND_add(&amp;curr_pid, sizeof(curr_pid), 1);
     curr_pid = 0;
 
     curr_uid = getuid();
-    RAND_add(&amp;curr_uid, sizeof curr_uid, 1);
+    RAND_add(&amp;curr_uid, sizeof(curr_uid), 1);
     curr_uid = 0;
 
     for (i = 0; i &lt; (ENTROPY_NEEDED * 4); i++) {
@@ -116,7 +116,7 @@ int RAND_poll(void)
 
         /* take 8 bits */
         v = (unsigned char)(ts.tv_nsec % 256);
-        RAND_add(&amp;v, sizeof v, 1);
+        RAND_add(&amp;v, sizeof(v), 1);
         v = 0;
     }
     return 1;
@@ -289,7 +289,7 @@ int RAND_poll(void)
 
 #  if defined(DEVRANDOM) || (!defined(OPENSSL_NO_EGD) &amp;&amp; defined(DEVRANDOM_EGD))
     if (n &gt; 0) {
-        RAND_add(tmpbuf, sizeof tmpbuf, (double)n);
+        RAND_add(tmpbuf, sizeof(tmpbuf), (double)n);
         OPENSSL_cleanse(tmpbuf, n);
     }
 #  endif
diff --git a/crypto/rsa/rsa_pss.c b/crypto/rsa/rsa_pss.c
index 2aebbe9..f814338 100644
--- a/crypto/rsa/rsa_pss.c
+++ b/crypto/rsa/rsa_pss.c
@@ -111,7 +111,7 @@ int RSA_verify_PKCS1_PSS_mgf1(RSA *rsa, const unsigned char *mHash,
         goto err;
     }
     if (!EVP_DigestInit_ex(ctx, Hash, NULL)
-        || !EVP_DigestUpdate(ctx, zeroes, sizeof zeroes)
+        || !EVP_DigestUpdate(ctx, zeroes, sizeof(zeroes))
         || !EVP_DigestUpdate(ctx, mHash, hLen))
         goto err;
     if (maskedDBLen - i) {
@@ -207,7 +207,7 @@ int RSA_padding_add_PKCS1_PSS_mgf1(RSA *rsa, unsigned char *EM,
     if (ctx == NULL)
         goto err;
     if (!EVP_DigestInit_ex(ctx, Hash, NULL)
-        || !EVP_DigestUpdate(ctx, zeroes, sizeof zeroes)
+        || !EVP_DigestUpdate(ctx, zeroes, sizeof(zeroes))
         || !EVP_DigestUpdate(ctx, mHash, hLen))
         goto err;
     if (sLen &amp;&amp; !EVP_DigestUpdate(ctx, salt, sLen))
diff --git a/crypto/x509/t_x509.c b/crypto/x509/t_x509.c
index eb65d88..c7ced67 100644
--- a/crypto/x509/t_x509.c
+++ b/crypto/x509/t_x509.c
@@ -340,7 +340,7 @@ int X509_aux_print(BIO *out, X509 *x, int indent)
                 BIO_puts(out, &quot;, &quot;);
             else
                 first = 0;
-            OBJ_obj2txt(oidstr, sizeof oidstr,
+            OBJ_obj2txt(oidstr, sizeof(oidstr),
                         sk_ASN1_OBJECT_value(trust, i), 0);
             BIO_puts(out, oidstr);
         }
@@ -355,7 +355,7 @@ int X509_aux_print(BIO *out, X509 *x, int indent)
                 BIO_puts(out, &quot;, &quot;);
             else
                 first = 0;
-            OBJ_obj2txt(oidstr, sizeof oidstr,
+            OBJ_obj2txt(oidstr, sizeof(oidstr),
                         sk_ASN1_OBJECT_value(reject, i), 0);
             BIO_puts(out, oidstr);
         }
diff --git a/crypto/x509v3/v3_alt.c b/crypto/x509v3/v3_alt.c
index 93f8c25..a35d337 100644
--- a/crypto/x509v3/v3_alt.c
+++ b/crypto/x509v3/v3_alt.c
@@ -108,12 +108,12 @@ STACK_OF(CONF_VALUE) *i2v_GENERAL_NAME(X509V3_EXT_METHOD *method,
     case GEN_IPADD:
         p = gen-&gt;d.ip-&gt;data;
         if (gen-&gt;d.ip-&gt;length == 4)
-            BIO_snprintf(oline, sizeof oline,
+            BIO_snprintf(oline, sizeof(oline),
                          &quot;%d.%d.%d.%d&quot;, p[0], p[1], p[2], p[3]);
         else if (gen-&gt;d.ip-&gt;length == 16) {
             oline[0] = 0;
             for (i = 0; i &lt; 8; i++) {
-                BIO_snprintf(htmp, sizeof htmp, &quot;%X&quot;, p[0] &lt;&lt; 8 | p[1]);
+                BIO_snprintf(htmp, sizeof(htmp), &quot;%X&quot;, p[0] &lt;&lt; 8 | p[1]);
                 p += 2;
                 strcat(oline, htmp);
                 if (i != 7)
diff --git a/crypto/x509v3/v3_info.c b/crypto/x509v3/v3_info.c
index c29c7e2..a0bca5f 100644
--- a/crypto/x509v3/v3_info.c
+++ b/crypto/x509v3/v3_info.c
@@ -77,7 +77,7 @@ static STACK_OF(CONF_VALUE) *i2v_AUTHORITY_INFO_ACCESS(
             goto err;
         tret = tmp;
         vtmp = sk_CONF_VALUE_value(tret, i);
-        i2t_ASN1_OBJECT(objtmp, sizeof objtmp, desc-&gt;method);
+        i2t_ASN1_OBJECT(objtmp, sizeof(objtmp), desc-&gt;method);
         nlen = strlen(objtmp) + strlen(vtmp-&gt;name) + 5;
         ntmp = OPENSSL_malloc(nlen);
         if (ntmp == NULL)
diff --git a/ssl/record/rec_layer_d1.c b/ssl/record/rec_layer_d1.c
index 1686edd..f674b79 100644
--- a/ssl/record/rec_layer_d1.c
+++ b/ssl/record/rec_layer_d1.c
@@ -541,7 +541,7 @@ int dtls1_read_bytes(SSL *s, int type, int *recvd_type, unsigned char *buf,
         unsigned int *dest_len = NULL;
 
         if (SSL3_RECORD_get_type(rr) == SSL3_RT_HANDSHAKE) {
-            dest_maxlen = sizeof s-&gt;rlayer.d-&gt;handshake_fragment;
+            dest_maxlen = sizeof(s-&gt;rlayer.d-&gt;handshake_fragment);
             dest = s-&gt;rlayer.d-&gt;handshake_fragment;
             dest_len = &amp;s-&gt;rlayer.d-&gt;handshake_fragment_len;
         } else if (SSL3_RECORD_get_type(rr) == SSL3_RT_ALERT) {
@@ -770,7 +770,7 @@ int dtls1_read_bytes(SSL *s, int type, int *recvd_type, unsigned char *buf,
             s-&gt;rwstate = SSL_NOTHING;
             s-&gt;s3-&gt;fatal_alert = alert_descr;
             SSLerr(SSL_F_DTLS1_READ_BYTES, SSL_AD_REASON_OFFSET + alert_descr);
-            BIO_snprintf(tmp, sizeof tmp, &quot;%d&quot;, alert_descr);
+            BIO_snprintf(tmp, sizeof(tmp), &quot;%d&quot;, alert_descr);
             ERR_add_error_data(2, &quot;SSL alert number &quot;, tmp);
             s-&gt;shutdown |= SSL_RECEIVED_SHUTDOWN;
             SSL_CTX_remove_session(s-&gt;session_ctx, s-&gt;session);
diff --git a/ssl/record/rec_layer_s3.c b/ssl/record/rec_layer_s3.c
index 95026c6..ce3f93d 100644
--- a/ssl/record/rec_layer_s3.c
+++ b/ssl/record/rec_layer_s3.c
@@ -757,7 +757,7 @@ int do_ssl3_write(SSL *s, int type, const unsigned char *buf,
 
     totlen = 0;
     /* Clear our SSL3_RECORD structures */
-    memset(wr, 0, sizeof wr);
+    memset(wr, 0, sizeof(wr));
     for (j = 0; j &lt; numpipes; j++) {
         /* write the header */
         *(outbuf[j]++) = type &amp; 0xff;
@@ -1230,11 +1230,11 @@ int ssl3_read_bytes(SSL *s, int type, int *recvd_type, unsigned char *buf,
         unsigned int *dest_len = NULL;
 
         if (SSL3_RECORD_get_type(rr) == SSL3_RT_HANDSHAKE) {
-            dest_maxlen = sizeof s-&gt;rlayer.handshake_fragment;
+            dest_maxlen = sizeof(s-&gt;rlayer.handshake_fragment);
             dest = s-&gt;rlayer.handshake_fragment;
             dest_len = &amp;s-&gt;rlayer.handshake_fragment_len;
         } else if (SSL3_RECORD_get_type(rr) == SSL3_RT_ALERT) {
-            dest_maxlen = sizeof s-&gt;rlayer.alert_fragment;
+            dest_maxlen = sizeof(s-&gt;rlayer.alert_fragment);
             dest = s-&gt;rlayer.alert_fragment;
             dest_len = &amp;s-&gt;rlayer.alert_fragment_len;
         }
@@ -1405,7 +1405,7 @@ int ssl3_read_bytes(SSL *s, int type, int *recvd_type, unsigned char *buf,
             s-&gt;rwstate = SSL_NOTHING;
             s-&gt;s3-&gt;fatal_alert = alert_descr;
             SSLerr(SSL_F_SSL3_READ_BYTES, SSL_AD_REASON_OFFSET + alert_descr);
-            BIO_snprintf(tmp, sizeof tmp, &quot;%d&quot;, alert_descr);
+            BIO_snprintf(tmp, sizeof(tmp), &quot;%d&quot;, alert_descr);
             ERR_add_error_data(2, &quot;SSL alert number &quot;, tmp);
             s-&gt;shutdown |= SSL_RECEIVED_SHUTDOWN;
             SSL3_RECORD_set_read(rr);
diff --git a/ssl/s3_lib.c b/ssl/s3_lib.c
index 9ea02dc..9ec50d0 100644
--- a/ssl/s3_lib.c
+++ b/ssl/s3_lib.c
@@ -2732,7 +2732,7 @@ static int cipher_compare(const void *a, const void *b)
 
 void ssl_sort_cipher_list(void)
 {
-    qsort(ssl3_ciphers, OSSL_NELEM(ssl3_ciphers), sizeof ssl3_ciphers[0],
+    qsort(ssl3_ciphers, OSSL_NELEM(ssl3_ciphers), sizeof(ssl3_ciphers[0]),
           cipher_compare);
 }
 
diff --git a/ssl/ssl_cert.c b/ssl/ssl_cert.c
index 8699487..deaaeb0 100644
--- a/ssl/ssl_cert.c
+++ b/ssl/ssl_cert.c
@@ -705,15 +705,15 @@ int SSL_add_dir_cert_subjects_to_stack(STACK_OF(X509_NAME) *stack,
         char buf[1024];
         int r;
 
-        if (strlen(dir) + strlen(filename) + 2 &gt; sizeof buf) {
+        if (strlen(dir) + strlen(filename) + 2 &gt; sizeof(buf)) {
             SSLerr(SSL_F_SSL_ADD_DIR_CERT_SUBJECTS_TO_STACK,
                    SSL_R_PATH_TOO_LONG);
             goto err;
         }
 #ifdef OPENSSL_SYS_VMS
-        r = BIO_snprintf(buf, sizeof buf, &quot;%s%s&quot;, dir, filename);
+        r = BIO_snprintf(buf, sizeof(buf), &quot;%s%s&quot;, dir, filename);
 #else
-        r = BIO_snprintf(buf, sizeof buf, &quot;%s/%s&quot;, dir, filename);
+        r = BIO_snprintf(buf, sizeof(buf), &quot;%s/%s&quot;, dir, filename);
 #endif
         if (r &lt;= 0 || r &gt;= (int)sizeof(buf))
             goto err;
diff --git a/ssl/ssl_lib.c b/ssl/ssl_lib.c
index 6908f16..d259ff4 100644
--- a/ssl/ssl_lib.c
+++ b/ssl/ssl_lib.c
@@ -669,7 +669,7 @@ SSL *SSL_new(SSL_CTX *ctx)
     s-&gt;verify_mode = ctx-&gt;verify_mode;
     s-&gt;not_resumable_session_cb = ctx-&gt;not_resumable_session_cb;
     s-&gt;sid_ctx_length = ctx-&gt;sid_ctx_length;
-    OPENSSL_assert(s-&gt;sid_ctx_length &lt;= sizeof s-&gt;sid_ctx);
+    OPENSSL_assert(s-&gt;sid_ctx_length &lt;= sizeof(s-&gt;sid_ctx));
     memcpy(&amp;s-&gt;sid_ctx, &amp;ctx-&gt;sid_ctx, sizeof(s-&gt;sid_ctx));
     s-&gt;verify_callback = ctx-&gt;default_verify_callback;
     s-&gt;generate_session_id = ctx-&gt;generate_session_id;
@@ -793,7 +793,7 @@ int SSL_up_ref(SSL *s)
 int SSL_CTX_set_session_id_context(SSL_CTX *ctx, const unsigned char *sid_ctx,
                                    unsigned int sid_ctx_len)
 {
-    if (sid_ctx_len &gt; sizeof ctx-&gt;sid_ctx) {
+    if (sid_ctx_len &gt; sizeof(ctx-&gt;sid_ctx)) {
         SSLerr(SSL_F_SSL_CTX_SET_SESSION_ID_CONTEXT,
                SSL_R_SSL_SESSION_ID_CONTEXT_TOO_LONG);
         return 0;
@@ -846,7 +846,7 @@ int SSL_has_matching_session_id(const SSL *ssl, const unsigned char *id,
      */
     SSL_SESSION r, *p;
 
-    if (id_len &gt; sizeof r.session_id)
+    if (id_len &gt; sizeof(r.session_id))
         return 0;
 
     r.ssl_version = ssl-&gt;version;
diff --git a/ssl/ssl_sess.c b/ssl/ssl_sess.c
index f0274cf..0dea8b5 100644
--- a/ssl/ssl_sess.c
+++ b/ssl/ssl_sess.c
@@ -415,7 +415,7 @@ int ssl_get_new_session(SSL *s, int session)
         ss-&gt;session_id_length = 0;
     }
 
-    if (s-&gt;sid_ctx_length &gt; sizeof ss-&gt;sid_ctx) {
+    if (s-&gt;sid_ctx_length &gt; sizeof(ss-&gt;sid_ctx)) {
         SSLerr(SSL_F_SSL_GET_NEW_SESSION, ERR_R_INTERNAL_ERROR);
         SSL_SESSION_free(ss);
         return 0;
@@ -759,8 +759,8 @@ void SSL_SESSION_free(SSL_SESSION *ss)
 
     CRYPTO_free_ex_data(CRYPTO_EX_INDEX_SSL_SESSION, ss, &amp;ss-&gt;ex_data);
 
-    OPENSSL_cleanse(ss-&gt;master_key, sizeof ss-&gt;master_key);
-    OPENSSL_cleanse(ss-&gt;session_id, sizeof ss-&gt;session_id);
+    OPENSSL_cleanse(ss-&gt;master_key, sizeof(ss-&gt;master_key));
+    OPENSSL_cleanse(ss-&gt;session_id, sizeof(ss-&gt;session_id));
     X509_free(ss-&gt;peer);
     sk_X509_pop_free(ss-&gt;peer_chain, X509_free);
     sk_SSL_CIPHER_free(ss-&gt;ciphers);
diff --git a/ssl/statem/statem_clnt.c b/ssl/statem/statem_clnt.c
index 6606c65..6fa3f1d 100644
--- a/ssl/statem/statem_clnt.c
+++ b/ssl/statem/statem_clnt.c
@@ -935,7 +935,7 @@ MSG_PROCESS_RETURN tls_process_server_hello(SSL *s, PACKET *pkt)
         goto f_err;
     }
     session_id_len = PACKET_remaining(&amp;session_id);
-    if (session_id_len &gt; sizeof s-&gt;session-&gt;session_id
+    if (session_id_len &gt; sizeof(s-&gt;session-&gt;session_id)
         || session_id_len &gt; SSL3_SESSION_ID_SIZE) {
         al = SSL_AD_ILLEGAL_PARAMETER;
         SSLerr(SSL_F_TLS_PROCESS_SERVER_HELLO, SSL_R_SSL3_SESSION_ID_TOO_LONG);
diff --git a/test/bftest.c b/test/bftest.c
index eb8d8a6..a513660 100644
--- a/test/bftest.c
+++ b/test/bftest.c
@@ -410,7 +410,7 @@ static int test(void)
     BF_set_key(&amp;key, 16, cbc_key);
     memset(cbc_in, 0, sizeof(cbc_in));
     memset(cbc_out, 0, sizeof(cbc_out));
-    memcpy(iv, cbc_iv, sizeof iv);
+    memcpy(iv, cbc_iv, sizeof(iv));
     BF_cbc_encrypt((unsigned char *)cbc_data, cbc_out, len,
                    &amp;key, iv, BF_ENCRYPT);
     if (memcmp(cbc_out, cbc_ok, 32) != 0) {
diff --git a/test/bntest.c b/test/bntest.c
index 3af2b83..686eab8 100644
--- a/test/bntest.c
+++ b/test/bntest.c
@@ -113,7 +113,7 @@ int main(int argc, char *argv[])
 
     results = 0;
 
-    RAND_seed(rnd_seed, sizeof rnd_seed); /* or BN_generate_prime may fail */
+    RAND_seed(rnd_seed, sizeof(rnd_seed)); /* or BN_generate_prime may fail */
 
     argc--;
     argv++;
diff --git a/test/d2i_test.c b/test/d2i_test.c
index 13efba9..5274270 100644
--- a/test/d2i_test.c
+++ b/test/d2i_test.c
@@ -81,7 +81,7 @@ static int execute_test(D2I_TEST_FIXTURE fixture)
      * performs sanity checks on the input and can reject it before the
      * decoder is called.
      */
-    len = BIO_read(bio, buf, sizeof buf);
+    len = BIO_read(bio, buf, sizeof(buf));
     if (len &lt; 0)
         goto err;
 
diff --git a/test/dhtest.c b/test/dhtest.c
index 8181fac..ecf2d9d 100644
--- a/test/dhtest.c
+++ b/test/dhtest.c
@@ -55,7 +55,7 @@ int main(int argc, char *argv[])
     CRYPTO_set_mem_debug(1);
     CRYPTO_mem_ctrl(CRYPTO_MEM_CHECK_ON);
 
-    RAND_seed(rnd_seed, sizeof rnd_seed);
+    RAND_seed(rnd_seed, sizeof(rnd_seed));
 
     out = BIO_new(BIO_s_file());
     if (out == NULL)
diff --git a/test/dsatest.c b/test/dsatest.c
index 1085422..3a62eb6 100644
--- a/test/dsatest.c
+++ b/test/dsatest.c
@@ -93,7 +93,7 @@ int main(int argc, char **argv)
     CRYPTO_set_mem_debug(1);
     CRYPTO_mem_ctrl(CRYPTO_MEM_CHECK_ON);
 
-    RAND_seed(rnd_seed, sizeof rnd_seed);
+    RAND_seed(rnd_seed, sizeof(rnd_seed));
 
     BIO_printf(bio_err, &quot;test generation of DSA parameters\n&quot;);
 
diff --git a/test/ectest.c b/test/ectest.c
index 0dd0ab8..d7b1432 100644
--- a/test/ectest.c
+++ b/test/ectest.c
@@ -332,7 +332,7 @@ static void prime_field_tests(void)
 
     len =
         EC_POINT_point2oct(group, Q, POINT_CONVERSION_COMPRESSED, buf,
-                           sizeof buf, ctx);
+                           sizeof(buf), ctx);
     if (len == 0)
         ABORT;
     if (!EC_POINT_oct2point(group, P, buf, len, ctx))
@@ -345,7 +345,7 @@ static void prime_field_tests(void)
 
     len =
         EC_POINT_point2oct(group, Q, POINT_CONVERSION_UNCOMPRESSED, buf,
-                           sizeof buf, ctx);
+                           sizeof(buf), ctx);
     if (len == 0)
         ABORT;
     if (!EC_POINT_oct2point(group, P, buf, len, ctx))
@@ -357,7 +357,7 @@ static void prime_field_tests(void)
         fprintf(stdout, &quot;%02X&quot;, buf[i]);
 
     len =
-        EC_POINT_point2oct(group, Q, POINT_CONVERSION_HYBRID, buf, sizeof buf,
+        EC_POINT_point2oct(group, Q, POINT_CONVERSION_HYBRID, buf, sizeof(buf),
                            ctx);
     if (len == 0)
         ABORT;
@@ -1113,7 +1113,7 @@ static void char2_field_tests(void)
 #  ifdef OPENSSL_EC_BIN_PT_COMP
     len =
         EC_POINT_point2oct(group, Q, POINT_CONVERSION_COMPRESSED, buf,
-                           sizeof buf, ctx);
+                           sizeof(buf), ctx);
     if (len == 0)
         ABORT;
     if (!EC_POINT_oct2point(group, P, buf, len, ctx))
@@ -1127,7 +1127,7 @@ static void char2_field_tests(void)
 
     len =
         EC_POINT_point2oct(group, Q, POINT_CONVERSION_UNCOMPRESSED, buf,
-                           sizeof buf, ctx);
+                           sizeof(buf), ctx);
     if (len == 0)
         ABORT;
     if (!EC_POINT_oct2point(group, P, buf, len, ctx))
@@ -1141,7 +1141,7 @@ static void char2_field_tests(void)
 /* Change test based on whether binary point compression is enabled or not. */
 #  ifdef OPENSSL_EC_BIN_PT_COMP
     len =
-        EC_POINT_point2oct(group, Q, POINT_CONVERSION_HYBRID, buf, sizeof buf,
+        EC_POINT_point2oct(group, Q, POINT_CONVERSION_HYBRID, buf, sizeof(buf),
                            ctx);
     if (len == 0)
         ABORT;
@@ -1751,7 +1751,7 @@ int main(int argc, char *argv[])
         CRYPTO_set_mem_debug(1);
     CRYPTO_mem_ctrl(CRYPTO_MEM_CHECK_ON);
 
-    RAND_seed(rnd_seed, sizeof rnd_seed); /* or BN_generate_prime may fail */
+    RAND_seed(rnd_seed, sizeof(rnd_seed)); /* or BN_generate_prime may fail */
 
     prime_field_tests();
     puts(&quot;&quot;);
diff --git a/test/exptest.c b/test/exptest.c
index e58e0c2..4221c1b 100644
--- a/test/exptest.c
+++ b/test/exptest.c
@@ -142,9 +142,11 @@ int main(int argc, char *argv[])
     unsigned char c;
     BIGNUM *r_mont, *r_mont_const, *r_recp, *r_simple, *a, *b, *m;
 
-    RAND_seed(rnd_seed, sizeof rnd_seed); /* or BN_rand may fail, and we
-                                           * don't even check its return
-                                           * value (which we should) */
+    /*
+     * See or BN_rand may fail, and we don't even check its return
+     * value (which we should)
+     */
+    RAND_seed(rnd_seed, sizeof(rnd_seed));
 
     ctx = BN_CTX_new();
     if (ctx == NULL)
diff --git a/test/igetest.c b/test/igetest.c
index 1245860..fe5bbf1 100644
--- a/test/igetest.c
+++ b/test/igetest.c
@@ -159,16 +159,16 @@ static int run_test_vectors(void)
         assert(v-&gt;length &lt;= MAX_VECTOR_SIZE);
 
         if (v-&gt;encrypt == AES_ENCRYPT)
-            AES_set_encrypt_key(v-&gt;key, 8 * sizeof v-&gt;key, &amp;key);
+            AES_set_encrypt_key(v-&gt;key, 8 * sizeof(v-&gt;key), &amp;key);
         else
-            AES_set_decrypt_key(v-&gt;key, 8 * sizeof v-&gt;key, &amp;key);
-        memcpy(iv, v-&gt;iv, sizeof iv);
+            AES_set_decrypt_key(v-&gt;key, 8 * sizeof(v-&gt;key), &amp;key);
+        memcpy(iv, v-&gt;iv, sizeof(iv));
         AES_ige_encrypt(v-&gt;in, buf, v-&gt;length, &amp;key, iv, v-&gt;encrypt);
 
         if (memcmp(v-&gt;out, buf, v-&gt;length)) {
             printf(&quot;IGE test vector %d failed\n&quot;, n);
-            hexdump(stdout, &quot;key&quot;, v-&gt;key, sizeof v-&gt;key);
-            hexdump(stdout, &quot;iv&quot;, v-&gt;iv, sizeof v-&gt;iv);
+            hexdump(stdout, &quot;key&quot;, v-&gt;key, sizeof(v-&gt;key));
+            hexdump(stdout, &quot;iv&quot;, v-&gt;iv, sizeof(v-&gt;iv));
             hexdump(stdout, &quot;in&quot;, v-&gt;in, v-&gt;length);
             hexdump(stdout, &quot;expected&quot;, v-&gt;out, v-&gt;length);
             hexdump(stdout, &quot;got&quot;, buf, v-&gt;length);
@@ -177,14 +177,14 @@ static int run_test_vectors(void)
         }
 
         /* try with in == out */
-        memcpy(iv, v-&gt;iv, sizeof iv);
+        memcpy(iv, v-&gt;iv, sizeof(iv));
         memcpy(buf, v-&gt;in, v-&gt;length);
         AES_ige_encrypt(buf, buf, v-&gt;length, &amp;key, iv, v-&gt;encrypt);
 
         if (memcmp(v-&gt;out, buf, v-&gt;length)) {
             printf(&quot;IGE test vector %d failed (with in == out)\n&quot;, n);
-            hexdump(stdout, &quot;key&quot;, v-&gt;key, sizeof v-&gt;key);
-            hexdump(stdout, &quot;iv&quot;, v-&gt;iv, sizeof v-&gt;iv);
+            hexdump(stdout, &quot;key&quot;, v-&gt;key, sizeof(v-&gt;key));
+            hexdump(stdout, &quot;iv&quot;, v-&gt;iv, sizeof(v-&gt;iv));
             hexdump(stdout, &quot;in&quot;, v-&gt;in, v-&gt;length);
             hexdump(stdout, &quot;expected&quot;, v-&gt;out, v-&gt;length);
             hexdump(stdout, &quot;got&quot;, buf, v-&gt;length);
@@ -214,9 +214,9 @@ static int run_test_vectors(void)
 
         if (memcmp(v-&gt;out, buf, v-&gt;length)) {
             printf(&quot;Bidirectional IGE test vector %d failed\n&quot;, n);
-            hexdump(stdout, &quot;key 1&quot;, v-&gt;key1, sizeof v-&gt;key1);
-            hexdump(stdout, &quot;key 2&quot;, v-&gt;key2, sizeof v-&gt;key2);
-            hexdump(stdout, &quot;iv&quot;, v-&gt;iv, sizeof v-&gt;iv);
+            hexdump(stdout, &quot;key 1&quot;, v-&gt;key1, sizeof(v-&gt;key1));
+            hexdump(stdout, &quot;key 2&quot;, v-&gt;key2, sizeof(v-&gt;key2));
+            hexdump(stdout, &quot;iv&quot;, v-&gt;iv, sizeof(v-&gt;iv));
             hexdump(stdout, &quot;in&quot;, v-&gt;in, v-&gt;length);
             hexdump(stdout, &quot;expected&quot;, v-&gt;out, v-&gt;length);
             hexdump(stdout, &quot;got&quot;, buf, v-&gt;length);
@@ -245,19 +245,19 @@ int main(int argc, char **argv)
 
     assert(BIG_TEST_SIZE &gt;= TEST_SIZE);
 
-    RAND_bytes(rkey, sizeof rkey);
-    RAND_bytes(plaintext, sizeof plaintext);
-    RAND_bytes(iv, sizeof iv);
-    memcpy(saved_iv, iv, sizeof saved_iv);
+    RAND_bytes(rkey, sizeof(rkey));
+    RAND_bytes(plaintext, sizeof(plaintext));
+    RAND_bytes(iv, sizeof(iv));
+    memcpy(saved_iv, iv, sizeof(saved_iv));
 
     /* Forward IGE only... */
 
     /* Straight encrypt/decrypt */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
     AES_ige_encrypt(plaintext, ciphertext, TEST_SIZE, &amp;key, iv, AES_ENCRYPT);
 
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    memcpy(iv, saved_iv, sizeof iv);
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    memcpy(iv, saved_iv, sizeof(iv));
     AES_ige_encrypt(ciphertext, checktext, TEST_SIZE, &amp;key, iv, AES_DECRYPT);
 
     if (memcmp(checktext, plaintext, TEST_SIZE)) {
@@ -268,16 +268,16 @@ int main(int argc, char **argv)
     }
 
     /* Now check encrypt chaining works */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    memcpy(iv, saved_iv, sizeof iv);
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    memcpy(iv, saved_iv, sizeof(iv));
     AES_ige_encrypt(plaintext, ciphertext, TEST_SIZE / 2, &amp;key, iv,
                     AES_ENCRYPT);
     AES_ige_encrypt(plaintext + TEST_SIZE / 2,
                     ciphertext + TEST_SIZE / 2, TEST_SIZE / 2,
                     &amp;key, iv, AES_ENCRYPT);
 
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    memcpy(iv, saved_iv, sizeof iv);
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    memcpy(iv, saved_iv, sizeof(iv));
     AES_ige_encrypt(ciphertext, checktext, TEST_SIZE, &amp;key, iv, AES_DECRYPT);
 
     if (memcmp(checktext, plaintext, TEST_SIZE)) {
@@ -288,16 +288,16 @@ int main(int argc, char **argv)
     }
 
     /* And check decrypt chaining */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    memcpy(iv, saved_iv, sizeof iv);
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    memcpy(iv, saved_iv, sizeof(iv));
     AES_ige_encrypt(plaintext, ciphertext, TEST_SIZE / 2, &amp;key, iv,
                     AES_ENCRYPT);
     AES_ige_encrypt(plaintext + TEST_SIZE / 2,
                     ciphertext + TEST_SIZE / 2, TEST_SIZE / 2,
                     &amp;key, iv, AES_ENCRYPT);
 
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    memcpy(iv, saved_iv, sizeof iv);
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    memcpy(iv, saved_iv, sizeof(iv));
     AES_ige_encrypt(ciphertext, checktext, TEST_SIZE / 2, &amp;key, iv,
                     AES_DECRYPT);
     AES_ige_encrypt(ciphertext + TEST_SIZE / 2,
@@ -312,29 +312,29 @@ int main(int argc, char **argv)
     }
 
     /* make sure garble extends forwards only */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    memcpy(iv, saved_iv, sizeof iv);
-    AES_ige_encrypt(plaintext, ciphertext, sizeof plaintext, &amp;key, iv,
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey),&amp;key);
+    memcpy(iv, saved_iv, sizeof(iv));
+    AES_ige_encrypt(plaintext, ciphertext, sizeof(plaintext), &amp;key, iv,
                     AES_ENCRYPT);
 
     /* corrupt halfway through */
-    ++ciphertext[sizeof ciphertext / 2];
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    memcpy(iv, saved_iv, sizeof iv);
-    AES_ige_encrypt(ciphertext, checktext, sizeof checktext, &amp;key, iv,
+    ++ciphertext[sizeof(ciphertext) / 2];
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    memcpy(iv, saved_iv, sizeof(iv));
+    AES_ige_encrypt(ciphertext, checktext, sizeof(checktext), &amp;key, iv,
                     AES_DECRYPT);
 
     matches = 0;
-    for (n = 0; n &lt; sizeof checktext; ++n)
+    for (n = 0; n &lt; sizeof(checktext); ++n)
         if (checktext[n] == plaintext[n])
             ++matches;
 
-    if (matches &gt; sizeof checktext / 2 + sizeof checktext / 100) {
+    if (matches &gt; sizeof(checktext) / 2 + sizeof(checktext) / 100) {
         printf(&quot;More than 51%% matches after garbling\n&quot;);
         ++err;
     }
 
-    if (matches &lt; sizeof checktext / 2) {
+    if (matches &lt; sizeof(checktext) / 2) {
         printf(&quot;Garble extends backwards!\n&quot;);
         ++err;
     }
@@ -346,16 +346,16 @@ int main(int argc, char **argv)
      */
     /* possible with biIGE, so the IV is not updated. */
 
-    RAND_bytes(rkey2, sizeof rkey2);
+    RAND_bytes(rkey2, sizeof(rkey2));
 
     /* Straight encrypt/decrypt */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_encrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_encrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
     AES_bi_ige_encrypt(plaintext, ciphertext, TEST_SIZE, &amp;key, &amp;key2, iv,
                        AES_ENCRYPT);
 
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_decrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_decrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
     AES_bi_ige_encrypt(ciphertext, checktext, TEST_SIZE, &amp;key, &amp;key2, iv,
                        AES_DECRYPT);
 
@@ -367,70 +367,70 @@ int main(int argc, char **argv)
     }
 
     /* make sure garble extends both ways */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_encrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
-    AES_ige_encrypt(plaintext, ciphertext, sizeof plaintext, &amp;key, iv,
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_encrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
+    AES_ige_encrypt(plaintext, ciphertext, sizeof(plaintext), &amp;key, iv,
                     AES_ENCRYPT);
 
     /* corrupt halfway through */
-    ++ciphertext[sizeof ciphertext / 2];
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_decrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
-    AES_ige_encrypt(ciphertext, checktext, sizeof checktext, &amp;key, iv,
+    ++ciphertext[sizeof(ciphertext) / 2];
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_decrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
+    AES_ige_encrypt(ciphertext, checktext, sizeof(checktext), &amp;key, iv,
                     AES_DECRYPT);
 
     matches = 0;
-    for (n = 0; n &lt; sizeof checktext; ++n)
+    for (n = 0; n &lt; sizeof(checktext); ++n)
         if (checktext[n] == plaintext[n])
             ++matches;
 
-    if (matches &gt; sizeof checktext / 100) {
+    if (matches &gt; sizeof(checktext) / 100) {
         printf(&quot;More than 1%% matches after bidirectional garbling\n&quot;);
         ++err;
     }
 
     /* make sure garble extends both ways (2) */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_encrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
-    AES_ige_encrypt(plaintext, ciphertext, sizeof plaintext, &amp;key, iv,
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_encrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
+    AES_ige_encrypt(plaintext, ciphertext, sizeof(plaintext), &amp;key, iv,
                     AES_ENCRYPT);
 
     /* corrupt right at the end */
-    ++ciphertext[sizeof ciphertext - 1];
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_decrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
-    AES_ige_encrypt(ciphertext, checktext, sizeof checktext, &amp;key, iv,
+    ++ciphertext[sizeof(ciphertext) - 1];
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_decrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
+    AES_ige_encrypt(ciphertext, checktext, sizeof(checktext), &amp;key, iv,
                     AES_DECRYPT);
 
     matches = 0;
-    for (n = 0; n &lt; sizeof checktext; ++n)
+    for (n = 0; n &lt; sizeof(checktext); ++n)
         if (checktext[n] == plaintext[n])
             ++matches;
 
-    if (matches &gt; sizeof checktext / 100) {
+    if (matches &gt; sizeof(checktext) / 100) {
         printf(&quot;More than 1%% matches after bidirectional garbling (2)\n&quot;);
         ++err;
     }
 
     /* make sure garble extends both ways (3) */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_encrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
-    AES_ige_encrypt(plaintext, ciphertext, sizeof plaintext, &amp;key, iv,
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_encrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
+    AES_ige_encrypt(plaintext, ciphertext, sizeof(plaintext), &amp;key, iv,
                     AES_ENCRYPT);
 
     /* corrupt right at the start */
     ++ciphertext[0];
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_decrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
-    AES_ige_encrypt(ciphertext, checktext, sizeof checktext, &amp;key, iv,
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_decrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
+    AES_ige_encrypt(ciphertext, checktext, sizeof(checktext), &amp;key, iv,
                     AES_DECRYPT);
 
     matches = 0;
-    for (n = 0; n &lt; sizeof checktext; ++n)
+    for (n = 0; n &lt; sizeof(checktext); ++n)
         if (checktext[n] == plaintext[n])
             ++matches;
 
-    if (matches &gt; sizeof checktext / 100) {
+    if (matches &gt; sizeof(checktext) / 100) {
         printf(&quot;More than 1%% matches after bidirectional garbling (3)\n&quot;);
         ++err;
     }
diff --git a/test/rsa_test.c b/test/rsa_test.c
index 7d06394..01e8374 100644
--- a/test/rsa_test.c
+++ b/test/rsa_test.c
@@ -237,7 +237,7 @@ int main(int argc, char *argv[])
     CRYPTO_set_mem_debug(1);
     CRYPTO_mem_ctrl(CRYPTO_MEM_CHECK_ON);
 
-    RAND_seed(rnd_seed, sizeof rnd_seed); /* or OAEP may fail */
+    RAND_seed(rnd_seed, sizeof(rnd_seed)); /* or OAEP may fail */
 
     plen = sizeof(ptext_ex) - 1;
 
diff --git a/test/sanitytest.c b/test/sanitytest.c
index 9c968f4..f1228f1 100644
--- a/test/sanitytest.c
+++ b/test/sanitytest.c
@@ -44,7 +44,7 @@ int main()
 
     /* Is NULL equivalent to all-bytes-zero? */
     p = NULL;
-    memset(bytes, 0, sizeof bytes);
+    memset(bytes, 0, sizeof(bytes));
     TEST(memcmp(&amp;p, bytes, sizeof(bytes)) == 0);
 
     /* Enum size */
diff --git a/test/ssltest_old.c b/test/ssltest_old.c
index 8f7e1e0..83e3e73 100644
--- a/test/ssltest_old.c
+++ b/test/ssltest_old.c
@@ -1014,7 +1014,7 @@ int main(int argc, char *argv[])
         CRYPTO_set_mem_debug(1);
     CRYPTO_mem_ctrl(CRYPTO_MEM_CHECK_ON);
 
-    RAND_seed(rnd_seed, sizeof rnd_seed);
+    RAND_seed(rnd_seed, sizeof(rnd_seed));
 
     bio_stdout = BIO_new_fp(stdout, BIO_NOCLOSE | BIO_FP_TEXT);
 
@@ -1580,9 +1580,9 @@ int main(int argc, char *argv[])
     {
         int session_id_context = 0;
         if (!SSL_CTX_set_session_id_context(s_ctx, (void *)&amp;session_id_context,
-                                            sizeof session_id_context) ||
+                                            sizeof(session_id_context)) ||
             !SSL_CTX_set_session_id_context(s_ctx2, (void *)&amp;session_id_context,
-                                            sizeof session_id_context)) {
+                                            sizeof(session_id_context))) {
             ERR_print_errors(bio_err);
             goto end;
         }
@@ -2049,8 +2049,8 @@ int doit_localhost(SSL *s_ssl, SSL *c_ssl, int family, long count,
             if (cw_num &gt; 0) {
                 /* Write to server. */
 
-                if (cw_num &gt; (long)sizeof cbuf)
-                    i = sizeof cbuf;
+                if (cw_num &gt; (long)sizeof(cbuf))
+                    i = sizeof(cbuf);
                 else
                     i = (int)cw_num;
                 r = BIO_write(c_ssl_bio, cbuf, i);
@@ -2128,8 +2128,8 @@ int doit_localhost(SSL *s_ssl, SSL *c_ssl, int family, long count,
             if (sw_num &gt; 0) {
                 /* Write to client. */
 
-                if (sw_num &gt; (long)sizeof sbuf)
-                    i = sizeof sbuf;
+                if (sw_num &gt; (long)sizeof(sbuf))
+                    i = sizeof(sbuf);
                 else
                     i = (int)sw_num;
                 r = BIO_write(s_ssl_bio, sbuf, i);
@@ -2320,8 +2320,8 @@ int doit_biopair(SSL *s_ssl, SSL *c_ssl, long count,
             if (cw_num &gt; 0) {
                 /* Write to server. */
 
-                if (cw_num &gt; (long)sizeof cbuf)
-                    i = sizeof cbuf;
+                if (cw_num &gt; (long)sizeof(cbuf))
+                    i = sizeof(cbuf);
                 else
                     i = (int)cw_num;
                 r = BIO_write(c_ssl_bio, cbuf, i);
@@ -2399,8 +2399,8 @@ int doit_biopair(SSL *s_ssl, SSL *c_ssl, long count,
             if (sw_num &gt; 0) {
                 /* Write to client. */
 
-                if (sw_num &gt; (long)sizeof sbuf)
-                    i = sizeof sbuf;
+                if (sw_num &gt; (long)sizeof(sbuf))
+                    i = sizeof(sbuf);
                 else
                     i = (int)sw_num;
                 r = BIO_write(s_ssl_bio, sbuf, i);
@@ -2916,7 +2916,7 @@ static int verify_callback(int ok, X509_STORE_CTX *ctx)
     char *s, buf[256];
 
     s = X509_NAME_oneline(X509_get_subject_name(X509_STORE_CTX_get_current_cert(ctx)),
-                          buf, sizeof buf);
+                          buf, sizeof(buf));
     if (s != NULL) {
         if (ok)
             printf(&quot;depth=%d %s\n&quot;, X509_STORE_CTX_get_error_depth(ctx), buf);
</PRE>





































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017139.html">[openssl-commits] [openssl]  OpenSSL_1_1_0-stable update
</A></li>
	<LI>Next message: <A HREF="017154.html">[openssl-commits] [openssl]  OpenSSL_1_1_0-stable update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17142">[ date ]</a>
              <a href="thread.html#17142">[ thread ]</a>
              <a href="subject.html#17142">[ subject ]</a>
              <a href="author.html#17142">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
