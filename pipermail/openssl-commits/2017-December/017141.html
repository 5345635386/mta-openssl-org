<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  OpenSSL_1_0_2-stable update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2017-December/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20OpenSSL_1_0_2-stable%20update&In-Reply-To=%3C1512763749.513941.17886.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017134.html">
   <LINK REL="Next"  HREF="017152.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  OpenSSL_1_0_2-stable update</H1>
    <B>Rich Salz</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20OpenSSL_1_0_2-stable%20update&In-Reply-To=%3C1512763749.513941.17886.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  OpenSSL_1_0_2-stable update">rsalz at openssl.org
       </A><BR>
    <I>Fri Dec  8 20:09:09 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="017134.html">[openssl-commits] [openssl]  OpenSSL_1_0_2-stable update
</A></li>
        <LI>Next message: <A HREF="017152.html">[openssl-commits] [openssl]  OpenSSL_1_0_2-stable update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17141">[ date ]</a>
              <a href="thread.html#17141">[ thread ]</a>
              <a href="subject.html#17141">[ subject ]</a>
              <a href="author.html#17141">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch OpenSSL_1_0_2-stable has been updated
       via  c6738fd208c143939b6bb7f7ac2061c0f5ff3272 (commit)
      from  a1daedd88445397a4aebf22ba63e92c3f1977870 (commit)


- Log -----------------------------------------------------------------
commit c6738fd208c143939b6bb7f7ac2061c0f5ff3272
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
Date:   Fri Dec 8 15:08:43 2017 -0500

    Standardize syntax around sizeof(foo)
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/4875">https://github.com/openssl/openssl/pull/4875</A>)

-----------------------------------------------------------------------

Summary of changes:
 MacOS/Randomizer.cpp                |  14 ++--
 apps/app_rand.c                     |   4 +-
 apps/apps.c                         |  62 ++++++++---------
 apps/ciphers.c                      |   2 +-
 apps/dgst.c                         |   2 +-
 apps/enc.c                          |  24 +++----
 apps/errstr.c                       |   2 +-
 apps/ocsp.c                         |   2 +-
 apps/openssl.c                      |   6 +-
 apps/passwd.c                       |  14 ++--
 apps/pkcs12.c                       |  10 +--
 apps/pkcs8.c                        |   4 +-
 apps/rand.c                         |   2 +-
 apps/req.c                          |  36 +++++-----
 apps/s_client.c                     |  10 +--
 apps/s_server.c                     |  10 +--
 apps/s_socket.c                     |   6 +-
 apps/s_time.c                       |   6 +-
 apps/speed.c                        |  12 ++--
 apps/vms_term_sock.c                |  12 ++--
 apps/winrand.c                      |   2 +-
 apps/x509.c                         |   4 +-
 crypto/asn1/a_gentm.c               |   2 +-
 crypto/asn1/a_mbstr.c               |   4 +-
 crypto/asn1/a_object.c              |   4 +-
 crypto/asn1/a_strex.c               |   8 +--
 crypto/asn1/a_time.c                |   2 +-
 crypto/asn1/a_utctm.c               |   4 +-
 crypto/asn1/asn1_lib.c              |   4 +-
 crypto/asn1/asn1_par.c              |   8 +--
 crypto/asn1/t_x509a.c               |   4 +-
 crypto/asn1/tasn_prn.c              |   2 +-
 crypto/bf/bftest.c                  |   6 +-
 crypto/bio/b_dump.c                 |  24 +++----
 crypto/bio/b_print.c                |   4 +-
 crypto/bio/bio_cb.c                 |   2 +-
 crypto/bio/bss_bio.c                |   2 +-
 crypto/bio/bss_conn.c               |   4 +-
 crypto/bio/bss_file.c               |  10 +--
 crypto/bn/bn_print.c                |   4 +-
 crypto/bn/bntest.c                  |   2 +-
 crypto/bn/expspeed.c                |   2 +-
 crypto/bn/exptest.c                 |   8 ++-
 crypto/conf/conf_def.c              |   2 +-
 crypto/conf/conf_mod.c              |   2 +-
 crypto/des/destest.c                |   4 +-
 crypto/des/ecb_enc.c                |   2 +-
 crypto/des/fcrypt.c                 |   4 +-
 crypto/des/read_pwd.c               |   2 +-
 crypto/des/set_key.c                |   2 +-
 crypto/dh/dhtest.c                  |   2 +-
 crypto/dsa/dsatest.c                |   2 +-
 crypto/ec/ec_lib.c                  |  10 +--
 crypto/ec/ec_mult.c                 |  16 ++---
 crypto/ec/ecp_nistp224.c            |  14 ++--
 crypto/ec/ecp_nistp256.c            |  12 ++--
 crypto/ec/ecp_nistp521.c            |   8 +--
 crypto/ec/ecp_nistz256.c            |   2 +-
 crypto/ec/ecp_smpl.c                |   2 +-
 crypto/ec/ectest.c                  |  14 ++--
 crypto/ecdh/ecdhtest.c              |   2 +-
 crypto/engine/eng_cryptodev.c       |  10 +--
 crypto/err/err.c                    |   4 +-
 crypto/err/err_prn.c                |   2 +-
 crypto/evp/digest.c                 |   8 +--
 crypto/evp/evp_enc.c                |  10 +--
 crypto/evp/evp_pbe.c                |   4 +-
 crypto/evp/evp_test.c               |   2 +-
 crypto/evp/openbsd_hw.c             |   6 +-
 crypto/evp/p5_crpt2.c               |   2 +-
 crypto/hmac/hmac.c                  |   2 +-
 crypto/jpake/jpake.c                |  12 ++--
 crypto/md2/md2_dgst.c               |   6 +-
 crypto/md4/md4.c                    |   2 +-
 crypto/mem_dbg.c                    |   8 +--
 crypto/o_time.c                     |   4 +-
 crypto/objects/o_names.c            |   4 +-
 crypto/objects/obj_dat.c            |   2 +-
 crypto/pem/pem_info.c               |   2 +-
 crypto/pem/pem_lib.c                |   2 +-
 crypto/rand/md_rand.c               |   6 +-
 crypto/rand/rand_egd.c              |   2 +-
 crypto/rand/rand_unix.c             |  10 +--
 crypto/rsa/rsa_crpt.c               |   2 +-
 crypto/rsa/rsa_pss.c                |   4 +-
 crypto/rsa/rsa_test.c               |   2 +-
 crypto/srp/srp_grps.h               |  28 ++++----
 crypto/threads/mttest.c             |   2 +-
 crypto/ui/ui_openssl.c              |   2 +-
 crypto/x509/x509_txt.c              |   2 +-
 crypto/x509/x509_vpm.c              |   2 +-
 crypto/x509v3/v3_alt.c              |   4 +-
 crypto/x509v3/v3_info.c             |   2 +-
 demos/easy_tls/easy-tls.c           |  62 ++++++++---------
 demos/easy_tls/test.c               |  12 ++--
 demos/engines/zencod/hw_zencod.c    |   8 +--
 demos/spkigen.c                     |   2 +-
 demos/ssl/serv.cpp                  |   2 +-
 demos/state_machine/state_machine.c |  20 +++---
 engines/e_atalla.c                  |   2 +-
 ssl/d1_lib.c                        |   4 +-
 ssl/d1_pkt.c                        |   4 +-
 ssl/kssl.c                          |   2 +-
 ssl/s23_srvr.c                      |   4 +-
 ssl/s2_clnt.c                       |   6 +-
 ssl/s2_enc.c                        |   2 +-
 ssl/s2_lib.c                        |   8 +--
 ssl/s2_srvr.c                       |   8 +--
 ssl/s3_clnt.c                       |  24 +++----
 ssl/s3_lib.c                        |   8 +--
 ssl/s3_pkt.c                        |   6 +-
 ssl/s3_srvr.c                       |   4 +-
 ssl/ssl_cert.c                      |  10 +--
 ssl/ssl_lib.c                       |   6 +-
 ssl/ssl_sess.c                      |   8 +--
 ssl/ssltest.c                       |  22 +++---
 ssl/t1_enc.c                        |  10 +--
 test/igetest.c                      | 134 ++++++++++++++++++------------------
 118 files changed, 499 insertions(+), 497 deletions(-)

diff --git a/MacOS/Randomizer.cpp b/MacOS/Randomizer.cpp
index cceb6bd..52dc884 100644
--- a/MacOS/Randomizer.cpp
+++ b/MacOS/Randomizer.cpp
@@ -266,7 +266,7 @@ void CRandomizer::AddCurrentMouse (void)
 	
 	if (labs (mLastMouse.h - mouseLoc.h) &gt; kMouseResolution/2 &amp;&amp;
 	    labs (mLastMouse.v - mouseLoc.v) &gt; kMouseResolution/2)
-		AddBytes (&amp;mouseLoc, sizeof (mouseLoc),
+		AddBytes (&amp;mouseLoc, sizeof(mouseLoc),
 				kMousePositionEntropy);
 	
 	if (mLastMouse.h == mouseLoc.h &amp;&amp; mLastMouse.v == mouseLoc.v)
@@ -286,7 +286,7 @@ void CRandomizer::AddCurrentMouse (void)
 			(kTypicalMouseIdleTicks/(double)lastCheck);
 		if (entropy &lt; 0.0)
 			entropy = 0.0;
-		AddBytes (&amp;mMouseStill, sizeof (mMouseStill), entropy);
+		AddBytes (&amp;mMouseStill, sizeof(mMouseStill), entropy);
 		mMouseStill = 0;
 	}
 	mLastMouse = mouseLoc;
@@ -299,7 +299,7 @@ void CRandomizer::AddAbsoluteSystemStartupTime (void)
 	GetDateTime (&amp;now);
 	now -= TickCount() / 60;	// Time in ticks since machine
 					// startup
-	AddBytes (&amp;now, sizeof (now), kSysStartupEntropy);
+	AddBytes (&amp;now, sizeof(now), kSysStartupEntropy);
 }
 
 void CRandomizer::AddTimeSinceMachineStartup (void)
@@ -314,7 +314,7 @@ void CRandomizer::AddAppRunningTime (void)
 	ProcessSerialNumber PSN;
 	ProcessInfoRec		ProcessInfo;
 	
-	ProcessInfo.processInfoLength = sizeof (ProcessInfoRec);
+	ProcessInfo.processInfoLength = sizeof(ProcessInfoRec);
 	ProcessInfo.processName = nil;
 	ProcessInfo.processAppSpec = nil;
 	
@@ -324,7 +324,7 @@ void CRandomizer::AddAppRunningTime (void)
 	// Now add the amount of time in ticks that the current process
 	// has been active
 
-	AddBytes (&amp;ProcessInfo, sizeof (ProcessInfoRec),
+	AddBytes (&amp;ProcessInfo, sizeof(ProcessInfoRec),
 			kApplicationUpTimeEntropy);
 }
 
@@ -353,7 +353,7 @@ void CRandomizer::AddStartupVolumeInfo (void)
 	// unpredictable, so might as well toss the whole block in. See
 	// comments for entropy estimate justifications.
 
-	AddBytes (&amp;pb, sizeof (pb),
+	AddBytes (&amp;pb, sizeof(pb),
 		kVolumeBytesEntropy +
 		log2l (((pb.ioVTotalBytes.hi - pb.ioVFreeBytes.hi)
 				* 4294967296.0D +
@@ -419,7 +419,7 @@ void CRandomizer::AddBytes (void *data, long size, double entropy)
 void CRandomizer::AddNow (double millisecondUncertainty)
 {
 	long time = SysTimer();
-	AddBytes (&amp;time, sizeof (time), log2l (millisecondUncertainty *
+	AddBytes (&amp;time, sizeof(time), log2l (millisecondUncertainty *
 			mTimebaseTicksPerMillisec));
 }
 
diff --git a/apps/app_rand.c b/apps/app_rand.c
index 7f40bba..0bbf342 100644
--- a/apps/app_rand.c
+++ b/apps/app_rand.c
@@ -128,7 +128,7 @@ int app_RAND_load_file(const char *file, BIO *bio_e, int dont_warn)
 #endif
 
     if (file == NULL)
-        file = RAND_file_name(buffer, sizeof buffer);
+        file = RAND_file_name(buffer, sizeof(buffer));
     else if (RAND_egd(file) &gt; 0) {
         /*
          * we try if the given filename is an EGD socket. if it is, we don't
@@ -203,7 +203,7 @@ int app_RAND_write_file(const char *file, BIO *bio_e)
         return 0;
 
     if (file == NULL)
-        file = RAND_file_name(buffer, sizeof buffer);
+        file = RAND_file_name(buffer, sizeof(buffer));
     if (file == NULL || !RAND_write_file(file)) {
         BIO_printf(bio_e, &quot;unable to write 'random state'\n&quot;);
         return 0;
diff --git a/apps/apps.c b/apps/apps.c
index 29de1b7..c5a5152 100644
--- a/apps/apps.c
+++ b/apps/apps.c
@@ -1738,9 +1738,9 @@ int save_serial(char *serialfile, char *suffix, BIGNUM *serial,
         BUF_strlcpy(buf[0], serialfile, BSIZE);
     else {
 #ifndef OPENSSL_SYS_VMS
-        j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s.%s&quot;, serialfile, suffix);
+        j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s.%s&quot;, serialfile, suffix);
 #else
-        j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s-%s&quot;, serialfile, suffix);
+        j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s-%s&quot;, serialfile, suffix);
 #endif
     }
 #ifdef RL_DEBUG
@@ -1789,14 +1789,14 @@ int rotate_serial(char *serialfile, char *new_suffix, char *old_suffix)
         goto err;
     }
 #ifndef OPENSSL_SYS_VMS
-    j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s.%s&quot;, serialfile, new_suffix);
+    j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s.%s&quot;, serialfile, new_suffix);
 #else
-    j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s-%s&quot;, serialfile, new_suffix);
+    j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s-%s&quot;, serialfile, new_suffix);
 #endif
 #ifndef OPENSSL_SYS_VMS
-    j = BIO_snprintf(buf[1], sizeof buf[1], &quot;%s.%s&quot;, serialfile, old_suffix);
+    j = BIO_snprintf(buf[1], sizeof(buf[1]), &quot;%s.%s&quot;, serialfile, old_suffix);
 #else
-    j = BIO_snprintf(buf[1], sizeof buf[1], &quot;%s-%s&quot;, serialfile, old_suffix);
+    j = BIO_snprintf(buf[1], sizeof(buf[1]), &quot;%s-%s&quot;, serialfile, old_suffix);
 #endif
 #ifdef RL_DEBUG
     BIO_printf(bio_err, &quot;DEBUG: renaming \&quot;%s\&quot; to \&quot;%s\&quot;\n&quot;,
@@ -1877,9 +1877,9 @@ CA_DB *load_index(char *dbfile, DB_ATTR *db_attr)
         goto err;
 
 #ifndef OPENSSL_SYS_VMS
-    BIO_snprintf(buf[0], sizeof buf[0], &quot;%s.attr&quot;, dbfile);
+    BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s.attr&quot;, dbfile);
 #else
-    BIO_snprintf(buf[0], sizeof buf[0], &quot;%s-attr&quot;, dbfile);
+    BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s-attr&quot;, dbfile);
 #endif
     dbattr_conf = NCONF_new(NULL);
     if (NCONF_load(dbattr_conf, buf[0], &amp;errorline) &lt;= 0) {
@@ -1967,19 +1967,19 @@ int save_index(const char *dbfile, const char *suffix, CA_DB *db)
         goto err;
     }
 #ifndef OPENSSL_SYS_VMS
-    j = BIO_snprintf(buf[2], sizeof buf[2], &quot;%s.attr&quot;, dbfile);
+    j = BIO_snprintf(buf[2], sizeof(buf[2]), &quot;%s.attr&quot;, dbfile);
 #else
-    j = BIO_snprintf(buf[2], sizeof buf[2], &quot;%s-attr&quot;, dbfile);
+    j = BIO_snprintf(buf[2], sizeof(buf[2]), &quot;%s-attr&quot;, dbfile);
 #endif
 #ifndef OPENSSL_SYS_VMS
-    j = BIO_snprintf(buf[1], sizeof buf[1], &quot;%s.attr.%s&quot;, dbfile, suffix);
+    j = BIO_snprintf(buf[1], sizeof(buf[1]), &quot;%s.attr.%s&quot;, dbfile, suffix);
 #else
-    j = BIO_snprintf(buf[1], sizeof buf[1], &quot;%s-attr-%s&quot;, dbfile, suffix);
+    j = BIO_snprintf(buf[1], sizeof(buf[1]), &quot;%s-attr-%s&quot;, dbfile, suffix);
 #endif
 #ifndef OPENSSL_SYS_VMS
-    j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s.%s&quot;, dbfile, suffix);
+    j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s.%s&quot;, dbfile, suffix);
 #else
-    j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s-%s&quot;, dbfile, suffix);
+    j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s-%s&quot;, dbfile, suffix);
 #endif
 #ifdef RL_DEBUG
     BIO_printf(bio_err, &quot;DEBUG: writing \&quot;%s\&quot;\n&quot;, buf[0]);
@@ -2028,29 +2028,29 @@ int rotate_index(const char *dbfile, const char *new_suffix,
         goto err;
     }
 #ifndef OPENSSL_SYS_VMS
-    j = BIO_snprintf(buf[4], sizeof buf[4], &quot;%s.attr&quot;, dbfile);
+    j = BIO_snprintf(buf[4], sizeof(buf[4]), &quot;%s.attr&quot;, dbfile);
 #else
-    j = BIO_snprintf(buf[4], sizeof buf[4], &quot;%s-attr&quot;, dbfile);
+    j = BIO_snprintf(buf[4], sizeof(buf[4]), &quot;%s-attr&quot;, dbfile);
 #endif
 #ifndef OPENSSL_SYS_VMS
-    j = BIO_snprintf(buf[2], sizeof buf[2], &quot;%s.attr.%s&quot;, dbfile, new_suffix);
+    j = BIO_snprintf(buf[2], sizeof(buf[2]), &quot;%s.attr.%s&quot;, dbfile, new_suffix);
 #else
-    j = BIO_snprintf(buf[2], sizeof buf[2], &quot;%s-attr-%s&quot;, dbfile, new_suffix);
+    j = BIO_snprintf(buf[2], sizeof(buf[2]), &quot;%s-attr-%s&quot;, dbfile, new_suffix);
 #endif
 #ifndef OPENSSL_SYS_VMS
-    j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s.%s&quot;, dbfile, new_suffix);
+    j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s.%s&quot;, dbfile, new_suffix);
 #else
-    j = BIO_snprintf(buf[0], sizeof buf[0], &quot;%s-%s&quot;, dbfile, new_suffix);
+    j = BIO_snprintf(buf[0], sizeof(buf[0]), &quot;%s-%s&quot;, dbfile, new_suffix);
 #endif
 #ifndef OPENSSL_SYS_VMS
-    j = BIO_snprintf(buf[1], sizeof buf[1], &quot;%s.%s&quot;, dbfile, old_suffix);
+    j = BIO_snprintf(buf[1], sizeof(buf[1]), &quot;%s.%s&quot;, dbfile, old_suffix);
 #else
-    j = BIO_snprintf(buf[1], sizeof buf[1], &quot;%s-%s&quot;, dbfile, old_suffix);
+    j = BIO_snprintf(buf[1], sizeof(buf[1]), &quot;%s-%s&quot;, dbfile, old_suffix);
 #endif
 #ifndef OPENSSL_SYS_VMS
-    j = BIO_snprintf(buf[3], sizeof buf[3], &quot;%s.attr.%s&quot;, dbfile, old_suffix);
+    j = BIO_snprintf(buf[3], sizeof(buf[3]), &quot;%s.attr.%s&quot;, dbfile, old_suffix);
 #else
-    j = BIO_snprintf(buf[3], sizeof buf[3], &quot;%s-attr-%s&quot;, dbfile, old_suffix);
+    j = BIO_snprintf(buf[3], sizeof(buf[3]), &quot;%s-attr-%s&quot;, dbfile, old_suffix);
 #endif
 #ifdef RL_DEBUG
     BIO_printf(bio_err, &quot;DEBUG: renaming \&quot;%s\&quot; to \&quot;%s\&quot;\n&quot;, dbfile, buf[1]);
@@ -2604,7 +2604,7 @@ static void jpake_send_step3a(BIO *bconn, JPAKE_CTX *ctx)
 
     JPAKE_STEP3A_init(&amp;s3a);
     JPAKE_STEP3A_generate(&amp;s3a, ctx);
-    BIO_write(bconn, s3a.hhk, sizeof s3a.hhk);
+    BIO_write(bconn, s3a.hhk, sizeof(s3a.hhk));
     (void)BIO_flush(bconn);
     JPAKE_STEP3A_release(&amp;s3a);
 }
@@ -2615,7 +2615,7 @@ static void jpake_send_step3b(BIO *bconn, JPAKE_CTX *ctx)
 
     JPAKE_STEP3B_init(&amp;s3b);
     JPAKE_STEP3B_generate(&amp;s3b, ctx);
-    BIO_write(bconn, s3b.hk, sizeof s3b.hk);
+    BIO_write(bconn, s3b.hk, sizeof(s3b.hk));
     (void)BIO_flush(bconn);
     JPAKE_STEP3B_release(&amp;s3b);
 }
@@ -2625,7 +2625,7 @@ static void readbn(BIGNUM **bn, BIO *bconn)
     char buf[10240];
     int l;
 
-    l = BIO_gets(bconn, buf, sizeof buf);
+    l = BIO_gets(bconn, buf, sizeof(buf));
     assert(l &gt; 0);
     assert(buf[l - 1] == '\n');
     buf[l - 1] = '\0';
@@ -2672,8 +2672,8 @@ static void jpake_receive_step3a(JPAKE_CTX *ctx, BIO *bconn)
     int l;
 
     JPAKE_STEP3A_init(&amp;s3a);
-    l = BIO_read(bconn, s3a.hhk, sizeof s3a.hhk);
-    assert(l == sizeof s3a.hhk);
+    l = BIO_read(bconn, s3a.hhk, sizeof(s3a.hhk));
+    assert(l == sizeof(s3a.hhk));
     if (!JPAKE_STEP3A_process(ctx, &amp;s3a)) {
         ERR_print_errors(bio_err);
         exit(1);
@@ -2687,8 +2687,8 @@ static void jpake_receive_step3b(JPAKE_CTX *ctx, BIO *bconn)
     int l;
 
     JPAKE_STEP3B_init(&amp;s3b);
-    l = BIO_read(bconn, s3b.hk, sizeof s3b.hk);
-    assert(l == sizeof s3b.hk);
+    l = BIO_read(bconn, s3b.hk, sizeof(s3b.hk));
+    assert(l == sizeof(s3b.hk));
     if (!JPAKE_STEP3B_process(ctx, &amp;s3b)) {
         ERR_print_errors(bio_err);
         exit(1);
diff --git a/apps/ciphers.c b/apps/ciphers.c
index 66636d2..4856141 100644
--- a/apps/ciphers.c
+++ b/apps/ciphers.c
@@ -217,7 +217,7 @@ int MAIN(int argc, char **argv)
                 BIO_printf(STDout, &quot;%s - &quot;, nm);
             }
 #endif
-            BIO_puts(STDout, SSL_CIPHER_description(c, buf, sizeof buf));
+            BIO_puts(STDout, SSL_CIPHER_description(c, buf, sizeof(buf)));
         }
     }
 
diff --git a/apps/dgst.c b/apps/dgst.c
index bc2601e..686fe34 100644
--- a/apps/dgst.c
+++ b/apps/dgst.c
@@ -145,7 +145,7 @@ int MAIN(int argc, char **argv)
         goto end;
 
     /* first check the program name */
-    program_name(argv[0], pname, sizeof pname);
+    program_name(argv[0], pname, sizeof(pname));
 
     md = EVP_get_digestbyname(pname);
 
diff --git a/apps/enc.c b/apps/enc.c
index 66145b3..3b7e1ee 100644
--- a/apps/enc.c
+++ b/apps/enc.c
@@ -114,7 +114,7 @@ int MAIN(int, char **);
 int MAIN(int argc, char **argv)
 {
     static const char magic[] = &quot;Salted__&quot;;
-    char mbuf[sizeof magic - 1];
+    char mbuf[sizeof(magic) - 1];
     char *strbuf = NULL;
     unsigned char *buff = NULL, *bufsize = NULL;
     int bsize = BSIZE, verbose = 0;
@@ -154,7 +154,7 @@ int MAIN(int argc, char **argv)
         goto end;
 
     /* first check the program name */
-    program_name(argv[0], pname, sizeof pname);
+    program_name(argv[0], pname, sizeof(pname));
     if (strcmp(pname, &quot;base64&quot;) == 0)
         base64 = 1;
 #ifdef ZLIB
@@ -247,7 +247,7 @@ int MAIN(int argc, char **argv)
                 goto bad;
             }
             buf[0] = '\0';
-            if (!fgets(buf, sizeof buf, infile)) {
+            if (!fgets(buf, sizeof(buf), infile)) {
                 BIO_printf(bio_err, &quot;unable to read key from '%s'\n&quot;, file);
                 goto bad;
             }
@@ -432,7 +432,7 @@ int MAIN(int argc, char **argv)
         for (;;) {
             char buf[200];
 
-            BIO_snprintf(buf, sizeof buf, &quot;enter %s %s password:&quot;,
+            BIO_snprintf(buf, sizeof(buf), &quot;enter %s %s password:&quot;,
                          OBJ_nid2ln(EVP_CIPHER_nid(cipher)),
                          (enc) ? &quot;encryption&quot; : &quot;decryption&quot;);
             strbuf[0] = '\0';
@@ -517,31 +517,31 @@ int MAIN(int argc, char **argv)
             else {
                 if (enc) {
                     if (hsalt) {
-                        if (!set_hex(hsalt, salt, sizeof salt)) {
+                        if (!set_hex(hsalt, salt, sizeof(salt))) {
                             BIO_printf(bio_err, &quot;invalid hex salt value\n&quot;);
                             goto end;
                         }
-                    } else if (RAND_bytes(salt, sizeof salt) &lt;= 0)
+                    } else if (RAND_bytes(salt, sizeof(salt)) &lt;= 0)
                         goto end;
                     /*
                      * If -P option then don't bother writing
                      */
                     if ((printkey != 2)
                         &amp;&amp; (BIO_write(wbio, magic,
-                                      sizeof magic - 1) != sizeof magic - 1
+                                      sizeof(magic) - 1) != sizeof(magic) - 1
                             || BIO_write(wbio,
                                          (char *)salt,
-                                         sizeof salt) != sizeof salt)) {
+                                         sizeof(salt)) != sizeof(salt))) {
                         BIO_printf(bio_err, &quot;error writing output file\n&quot;);
                         goto end;
                     }
-                } else if (BIO_read(rbio, mbuf, sizeof mbuf) != sizeof mbuf
+                } else if (BIO_read(rbio, mbuf, sizeof(mbuf)) != sizeof(mbuf)
                            || BIO_read(rbio,
                                        (unsigned char *)salt,
-                                       sizeof salt) != sizeof salt) {
+                                       sizeof(salt)) != sizeof(salt)) {
                     BIO_printf(bio_err, &quot;error reading input file\n&quot;);
                     goto end;
-                } else if (memcmp(mbuf, magic, sizeof magic - 1)) {
+                } else if (memcmp(mbuf, magic, sizeof(magic) - 1)) {
                     BIO_printf(bio_err, &quot;bad magic number\n&quot;);
                     goto end;
                 }
@@ -564,7 +564,7 @@ int MAIN(int argc, char **argv)
             int siz = EVP_CIPHER_iv_length(cipher);
             if (siz == 0) {
                 BIO_printf(bio_err, &quot;warning: iv not use by this cipher\n&quot;);
-            } else if (!set_hex(hiv, iv, sizeof iv)) {
+            } else if (!set_hex(hiv, iv, sizeof(iv))) {
                 BIO_printf(bio_err, &quot;invalid hex iv value\n&quot;);
                 goto end;
             }
diff --git a/apps/errstr.c b/apps/errstr.c
index c2d4fde..c3fef61 100644
--- a/apps/errstr.c
+++ b/apps/errstr.c
@@ -108,7 +108,7 @@ int MAIN(int argc, char **argv)
 
     for (i = 1; i &lt; argc; i++) {
         if (sscanf(argv[i], &quot;%lx&quot;, &amp;l)) {
-            ERR_error_string_n(l, buf, sizeof buf);
+            ERR_error_string_n(l, buf, sizeof(buf));
             printf(&quot;%s\n&quot;, buf);
         } else {
             printf(&quot;%s: bad error code\n&quot;, argv[i]);
diff --git a/apps/ocsp.c b/apps/ocsp.c
index 5da51df..654eebc 100644
--- a/apps/ocsp.c
+++ b/apps/ocsp.c
@@ -1195,7 +1195,7 @@ static int do_responder(OCSP_REQUEST **preq, BIO **pcbio, BIO *acbio,
     *pcbio = cbio;
 
     for (;;) {
-        len = BIO_gets(cbio, inbuf, sizeof inbuf);
+        len = BIO_gets(cbio, inbuf, sizeof(inbuf));
         if (len &lt;= 0)
             return 1;
         /* Look for &quot;POST&quot; signalling start of query */
diff --git a/apps/openssl.c b/apps/openssl.c
index 6873145..c3da5d6 100644
--- a/apps/openssl.c
+++ b/apps/openssl.c
@@ -351,7 +351,7 @@ int main(int Argc, char *ARGV[])
     prog = prog_init();
 
     /* first check the program name */
-    program_name(Argv[0], pname, sizeof pname);
+    program_name(Argv[0], pname, sizeof(pname));
 
     f.name = pname;
     fp = lh_FUNCTION_retrieve(prog, &amp;f);
@@ -379,7 +379,7 @@ int main(int Argc, char *ARGV[])
     for (;;) {
         ret = 0;
         p = buf;
-        n = sizeof buf;
+        n = sizeof(buf);
         i = 0;
         for (;;) {
             p[0] = '\0';
@@ -685,7 +685,7 @@ static LHASH_OF(FUNCTION) *prog_init(void)
 
     /* Purely so it looks nice when the user hits ? */
     for (i = 0, f = functions; f-&gt;name != NULL; ++f, ++i) ;
-    qsort(functions, i, sizeof *functions, SortFnByName);
+    qsort(functions, i, sizeof(*functions), SortFnByName);
 
     if ((ret = lh_FUNCTION_new()) == NULL)
         return (NULL);
diff --git a/apps/passwd.c b/apps/passwd.c
index 798a6d5..56e10ad 100644
--- a/apps/passwd.c
+++ b/apps/passwd.c
@@ -252,7 +252,7 @@ int MAIN(int argc, char **argv)
                     /* ignore rest of line */
                     char trash[BUFSIZ];
                     do
-                        r = BIO_gets(in, trash, sizeof trash);
+                        r = BIO_gets(in, trash, sizeof(trash));
                     while ((r &gt; 0) &amp;&amp; (!strchr(trash, '\n')));
                 }
 
@@ -329,8 +329,8 @@ static char *md5crypt(const char *passwd, const char *magic, const char *salt)
     EVP_DigestUpdate(&amp;md2, passwd, passwd_len);
     EVP_DigestFinal_ex(&amp;md2, buf, NULL);
 
-    for (i = passwd_len; i &gt; sizeof buf; i -= sizeof buf)
-        EVP_DigestUpdate(&amp;md, buf, sizeof buf);
+    for (i = passwd_len; i &gt; sizeof(buf); i -= sizeof(buf))
+        EVP_DigestUpdate(&amp;md, buf, sizeof(buf));
     EVP_DigestUpdate(&amp;md, buf, i);
 
     n = passwd_len;
@@ -343,13 +343,13 @@ static char *md5crypt(const char *passwd, const char *magic, const char *salt)
     for (i = 0; i &lt; 1000; i++) {
         EVP_DigestInit_ex(&amp;md2, EVP_md5(), NULL);
         EVP_DigestUpdate(&amp;md2, (i &amp; 1) ? (unsigned const char *)passwd : buf,
-                         (i &amp; 1) ? passwd_len : sizeof buf);
+                         (i &amp; 1) ? passwd_len : sizeof(buf));
         if (i % 3)
             EVP_DigestUpdate(&amp;md2, salt_out, salt_len);
         if (i % 7)
             EVP_DigestUpdate(&amp;md2, passwd, passwd_len);
         EVP_DigestUpdate(&amp;md2, (i &amp; 1) ? buf : (unsigned const char *)passwd,
-                         (i &amp; 1) ? sizeof buf : passwd_len);
+                         (i &amp; 1) ? sizeof(buf) : passwd_len);
         EVP_DigestFinal_ex(&amp;md2, buf, NULL);
     }
     EVP_MD_CTX_cleanup(&amp;md2);
@@ -357,7 +357,7 @@ static char *md5crypt(const char *passwd, const char *magic, const char *salt)
     {
         /* transform buf into output string */
 
-        unsigned char buf_perm[sizeof buf];
+        unsigned char buf_perm[sizeof(buf)];
         int dest, source;
         char *output;
 
@@ -369,7 +369,7 @@ static char *md5crypt(const char *passwd, const char *magic, const char *salt)
         buf_perm[15] = buf[11];
 #  ifndef PEDANTIC              /* Unfortunately, this generates a &quot;no
                                  * effect&quot; warning */
-        assert(16 == sizeof buf_perm);
+        assert(16 == sizeof(buf_perm));
 #  endif
 
         output = salt_out + salt_len;
diff --git a/apps/pkcs12.c b/apps/pkcs12.c
index d0bd97a..0ba4c9a 100644
--- a/apps/pkcs12.c
+++ b/apps/pkcs12.c
@@ -481,7 +481,7 @@ int MAIN(int argc, char **argv)
         CRYPTO_push_info(&quot;read MAC password&quot;);
 # endif
         if (EVP_read_pw_string
-            (macpass, sizeof macpass, &quot;Enter MAC Password:&quot;, export_cert)) {
+            (macpass, sizeof(macpass), &quot;Enter MAC Password:&quot;, export_cert)) {
             BIO_printf(bio_err, &quot;Can't read Password\n&quot;);
             goto end;
         }
@@ -629,13 +629,13 @@ int MAIN(int argc, char **argv)
 # endif
 
         if (!noprompt &amp;&amp;
-            EVP_read_pw_string(pass, sizeof pass, &quot;Enter Export Password:&quot;,
+            EVP_read_pw_string(pass, sizeof(pass), &quot;Enter Export Password:&quot;,
                                1)) {
             BIO_printf(bio_err, &quot;Can't read Password\n&quot;);
             goto export_end;
         }
         if (!twopass)
-            BUF_strlcpy(macpass, pass, sizeof macpass);
+            BUF_strlcpy(macpass, pass, sizeof(macpass));
 
 # ifdef CRYPTO_MDEBUG
         CRYPTO_pop_info();
@@ -698,7 +698,7 @@ int MAIN(int argc, char **argv)
     CRYPTO_push_info(&quot;read import password&quot;);
 # endif
     if (!noprompt
-        &amp;&amp; EVP_read_pw_string(pass, sizeof pass, &quot;Enter Import Password:&quot;,
+        &amp;&amp; EVP_read_pw_string(pass, sizeof(pass), &quot;Enter Import Password:&quot;,
                               0)) {
         BIO_printf(bio_err, &quot;Can't read Password\n&quot;);
         goto end;
@@ -708,7 +708,7 @@ int MAIN(int argc, char **argv)
 # endif
 
     if (!twopass)
-        BUF_strlcpy(macpass, pass, sizeof macpass);
+        BUF_strlcpy(macpass, pass, sizeof(macpass));
 
     if ((options &amp; INFO) &amp;&amp; p12-&gt;mac)
         BIO_printf(bio_err, &quot;MAC Iteration %ld\n&quot;,
diff --git a/apps/pkcs8.c b/apps/pkcs8.c
index 71e3168..d7f0720 100644
--- a/apps/pkcs8.c
+++ b/apps/pkcs8.c
@@ -277,7 +277,7 @@ int MAIN(int argc, char **argv)
             else {
                 p8pass = pass;
                 if (EVP_read_pw_string
-                    (pass, sizeof pass, &quot;Enter Encryption Password:&quot;, 1))
+                    (pass, sizeof(pass), &quot;Enter Encryption Password:&quot;, 1))
                     goto end;
             }
             app_RAND_load_file(NULL, bio_err, 0);
@@ -331,7 +331,7 @@ int MAIN(int argc, char **argv)
             p8pass = passin;
         else {
             p8pass = pass;
-            EVP_read_pw_string(pass, sizeof pass, &quot;Enter Password:&quot;, 0);
+            EVP_read_pw_string(pass, sizeof(pass), &quot;Enter Password:&quot;, 0);
         }
         p8inf = PKCS8_decrypt(p8, p8pass, strlen(p8pass));
     }
diff --git a/apps/rand.c b/apps/rand.c
index 96dcb72..eddb8af 100644
--- a/apps/rand.c
+++ b/apps/rand.c
@@ -198,7 +198,7 @@ int MAIN(int argc, char **argv)
 
         chunk = num;
         if (chunk &gt; (int)sizeof(buf))
-            chunk = sizeof buf;
+            chunk = sizeof(buf);
         r = RAND_bytes(buf, chunk);
         if (r &lt;= 0)
             goto err;
diff --git a/apps/req.c b/apps/req.c
index ede1d32..7fcab18 100644
--- a/apps/req.c
+++ b/apps/req.c
@@ -1193,7 +1193,7 @@ static int prompt_info(X509_REQ *req,
             /* If OBJ not recognised ignore it */
             if ((nid = OBJ_txt2nid(type)) == NID_undef)
                 goto start;
-            if (BIO_snprintf(buf, sizeof buf, &quot;%s_default&quot;, v-&gt;name)
+            if (BIO_snprintf(buf, sizeof(buf), &quot;%s_default&quot;, v-&gt;name)
                 &gt;= (int)sizeof(buf)) {
                 BIO_printf(bio_err, &quot;Name '%s' too long\n&quot;, v-&gt;name);
                 return 0;
@@ -1204,19 +1204,19 @@ static int prompt_info(X509_REQ *req,
                 def = &quot;&quot;;
             }
 
-            BIO_snprintf(buf, sizeof buf, &quot;%s_value&quot;, v-&gt;name);
+            BIO_snprintf(buf, sizeof(buf), &quot;%s_value&quot;, v-&gt;name);
             if ((value = NCONF_get_string(req_conf, dn_sect, buf)) == NULL) {
                 ERR_clear_error();
                 value = NULL;
             }
 
-            BIO_snprintf(buf, sizeof buf, &quot;%s_min&quot;, v-&gt;name);
+            BIO_snprintf(buf, sizeof(buf), &quot;%s_min&quot;, v-&gt;name);
             if (!NCONF_get_number(req_conf, dn_sect, buf, &amp;n_min)) {
                 ERR_clear_error();
                 n_min = -1;
             }
 
-            BIO_snprintf(buf, sizeof buf, &quot;%s_max&quot;, v-&gt;name);
+            BIO_snprintf(buf, sizeof(buf), &quot;%s_max&quot;, v-&gt;name);
             if (!NCONF_get_number(req_conf, dn_sect, buf, &amp;n_max)) {
                 ERR_clear_error();
                 n_max = -1;
@@ -1252,7 +1252,7 @@ static int prompt_info(X509_REQ *req,
                 if ((nid = OBJ_txt2nid(type)) == NID_undef)
                     goto start2;
 
-                if (BIO_snprintf(buf, sizeof buf, &quot;%s_default&quot;, type)
+                if (BIO_snprintf(buf, sizeof(buf), &quot;%s_default&quot;, type)
                     &gt;= (int)sizeof(buf)) {
                     BIO_printf(bio_err, &quot;Name '%s' too long\n&quot;, v-&gt;name);
                     return 0;
@@ -1264,20 +1264,20 @@ static int prompt_info(X509_REQ *req,
                     def = &quot;&quot;;
                 }
 
-                BIO_snprintf(buf, sizeof buf, &quot;%s_value&quot;, type);
+                BIO_snprintf(buf, sizeof(buf), &quot;%s_value&quot;, type);
                 if ((value = NCONF_get_string(req_conf, attr_sect, buf))
                     == NULL) {
                     ERR_clear_error();
                     value = NULL;
                 }
 
-                BIO_snprintf(buf, sizeof buf, &quot;%s_min&quot;, type);
+                BIO_snprintf(buf, sizeof(buf), &quot;%s_min&quot;, type);
                 if (!NCONF_get_number(req_conf, attr_sect, buf, &amp;n_min)) {
                     ERR_clear_error();
                     n_min = -1;
                 }
 
-                BIO_snprintf(buf, sizeof buf, &quot;%s_max&quot;, type);
+                BIO_snprintf(buf, sizeof(buf), &quot;%s_max&quot;, type);
                 if (!NCONF_get_number(req_conf, attr_sect, buf, &amp;n_max)) {
                     ERR_clear_error();
                     n_max = -1;
@@ -1372,13 +1372,13 @@ static int add_DN_object(X509_NAME *n, char *text, const char *def,
         BIO_printf(bio_err, &quot;%s [%s]:&quot;, text, def);
     (void)BIO_flush(bio_err);
     if (value != NULL) {
-        BUF_strlcpy(buf, value, sizeof buf);
-        BUF_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        BUF_strlcpy(buf, value, sizeof(buf));
+        BUF_strlcat(buf, &quot;\n&quot;, sizeof(buf));
         BIO_printf(bio_err, &quot;%s\n&quot;, value);
     } else {
         buf[0] = '\0';
         if (!batch) {
-            if (!fgets(buf, sizeof buf, stdin))
+            if (!fgets(buf, sizeof(buf), stdin))
                 return 0;
         } else {
             buf[0] = '\n';
@@ -1391,8 +1391,8 @@ static int add_DN_object(X509_NAME *n, char *text, const char *def,
     else if (buf[0] == '\n') {
         if ((def == NULL) || (def[0] == '\0'))
             return (1);
-        BUF_strlcpy(buf, def, sizeof buf);
-        BUF_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        BUF_strlcpy(buf, def, sizeof(buf));
+        BUF_strlcat(buf, &quot;\n&quot;, sizeof(buf));
     } else if ((buf[0] == '.') &amp;&amp; (buf[1] == '\n'))
         return (1);
 
@@ -1431,13 +1431,13 @@ static int add_attribute_object(X509_REQ *req, char *text, const char *def,
         BIO_printf(bio_err, &quot;%s [%s]:&quot;, text, def);
     (void)BIO_flush(bio_err);
     if (value != NULL) {
-        BUF_strlcpy(buf, value, sizeof buf);
-        BUF_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        BUF_strlcpy(buf, value, sizeof(buf));
+        BUF_strlcat(buf, &quot;\n&quot;, sizeof(buf));
         BIO_printf(bio_err, &quot;%s\n&quot;, value);
     } else {
         buf[0] = '\0';
         if (!batch) {
-            if (!fgets(buf, sizeof buf, stdin))
+            if (!fgets(buf, sizeof(buf), stdin))
                 return 0;
         } else {
             buf[0] = '\n';
@@ -1450,8 +1450,8 @@ static int add_attribute_object(X509_REQ *req, char *text, const char *def,
     else if (buf[0] == '\n') {
         if ((def == NULL) || (def[0] == '\0'))
             return (1);
-        BUF_strlcpy(buf, def, sizeof buf);
-        BUF_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        BUF_strlcpy(buf, def, sizeof(buf));
+        BUF_strlcat(buf, &quot;\n&quot;, sizeof(buf));
     } else if ((buf[0] == '.') &amp;&amp; (buf[1] == '\n'))
         return (1);
 
diff --git a/apps/s_client.c b/apps/s_client.c
index 2a0ead7..c855668 100644
--- a/apps/s_client.c
+++ b/apps/s_client.c
@@ -2166,10 +2166,10 @@ static void print_stuff(BIO *bio, SSL *s, int full)
             BIO_printf(bio, &quot;---\nCertificate chain\n&quot;);
             for (i = 0; i &lt; sk_X509_num(sk); i++) {
                 X509_NAME_oneline(X509_get_subject_name(sk_X509_value(sk, i)),
-                                  buf, sizeof buf);
+                                  buf, sizeof(buf));
                 BIO_printf(bio, &quot;%2d s:%s\n&quot;, i, buf);
                 X509_NAME_oneline(X509_get_issuer_name(sk_X509_value(sk, i)),
-                                  buf, sizeof buf);
+                                  buf, sizeof(buf));
                 BIO_printf(bio, &quot;   i:%s\n&quot;, buf);
                 if (c_showcerts)
                     PEM_write_bio_X509(bio, sk_X509_value(sk, i));
@@ -2184,9 +2184,9 @@ static void print_stuff(BIO *bio, SSL *s, int full)
             /* Redundant if we showed the whole chain */
             if (!(c_showcerts &amp;&amp; got_a_chain))
                 PEM_write_bio_X509(bio, peer);
-            X509_NAME_oneline(X509_get_subject_name(peer), buf, sizeof buf);
+            X509_NAME_oneline(X509_get_subject_name(peer), buf, sizeof(buf));
             BIO_printf(bio, &quot;subject=%s\n&quot;, buf);
-            X509_NAME_oneline(X509_get_issuer_name(peer), buf, sizeof buf);
+            X509_NAME_oneline(X509_get_issuer_name(peer), buf, sizeof(buf));
             BIO_printf(bio, &quot;issuer=%s\n&quot;, buf);
         } else
             BIO_printf(bio, &quot;no peer certificate available\n&quot;);
@@ -2203,7 +2203,7 @@ static void print_stuff(BIO *bio, SSL *s, int full)
         } else {
             BIO_printf(bio, &quot;---\nNo client certificate CA names sent\n&quot;);
         }
-        p = SSL_get_shared_ciphers(s, buf, sizeof buf);
+        p = SSL_get_shared_ciphers(s, buf, sizeof(buf));
         if (p != NULL) {
             /*
              * This works only for SSL 2.  In later protocol versions, the
diff --git a/apps/s_server.c b/apps/s_server.c
index 98ffc09..83918fb 100644
--- a/apps/s_server.c
+++ b/apps/s_server.c
@@ -2008,7 +2008,7 @@ int MAIN(int argc, char *argv[])
 
     SSL_CTX_set_verify(ctx, s_server_verify, verify_callback);
     SSL_CTX_set_session_id_context(ctx, (void *)&amp;s_server_session_id_context,
-                                   sizeof s_server_session_id_context);
+                                   sizeof(s_server_session_id_context));
 
     /* Set DTLS cookie generation and verification callbacks */
     SSL_CTX_set_cookie_generate_cb(ctx, generate_cookie_callback);
@@ -2019,7 +2019,7 @@ int MAIN(int argc, char *argv[])
         SSL_CTX_set_verify(ctx2, s_server_verify, verify_callback);
         SSL_CTX_set_session_id_context(ctx2,
                                        (void *)&amp;s_server_session_id_context,
-                                       sizeof s_server_session_id_context);
+                                       sizeof(s_server_session_id_context));
 
         tlsextcbp.biodebug = bio_s_out;
         SSL_CTX_set_tlsext_servername_callback(ctx2, ssl_servername_cb);
@@ -2666,14 +2666,14 @@ static int init_ssl_connection(SSL *con)
     if (peer != NULL) {
         BIO_printf(bio_s_out, &quot;Client certificate\n&quot;);
         PEM_write_bio_X509(bio_s_out, peer);
-        X509_NAME_oneline(X509_get_subject_name(peer), buf, sizeof buf);
+        X509_NAME_oneline(X509_get_subject_name(peer), buf, sizeof(buf));
         BIO_printf(bio_s_out, &quot;subject=%s\n&quot;, buf);
-        X509_NAME_oneline(X509_get_issuer_name(peer), buf, sizeof buf);
+        X509_NAME_oneline(X509_get_issuer_name(peer), buf, sizeof(buf));
         BIO_printf(bio_s_out, &quot;issuer=%s\n&quot;, buf);
         X509_free(peer);
     }
 
-    if (SSL_get_shared_ciphers(con, buf, sizeof buf) != NULL)
+    if (SSL_get_shared_ciphers(con, buf, sizeof(buf)) != NULL)
         BIO_printf(bio_s_out, &quot;Shared ciphers:%s\n&quot;, buf);
     str = SSL_CIPHER_get_name(SSL_get_current_cipher(con));
     ssl_print_sigalgs(bio_s_out, con);
diff --git a/apps/s_socket.c b/apps/s_socket.c
index 77a7688..83624ca 100644
--- a/apps/s_socket.c
+++ b/apps/s_socket.c
@@ -235,7 +235,7 @@ int init_client(int *sock, char *host, int port, int type)
 {
     unsigned char ip[4];
 
-    memset(ip, '\0', sizeof ip);
+    memset(ip, '\0', sizeof(ip));
     if (!host_ip(host, &amp;(ip[0])))
         return 0;
     return init_client_ip(sock, ip, port, type);
@@ -360,7 +360,7 @@ static int init_server_long(int *sock, int port, char *ip, int type)
 # if defined SOL_SOCKET &amp;&amp; defined SO_REUSEADDR
     {
         int j = 1;
-        setsockopt(s, SOL_SOCKET, SO_REUSEADDR, (void *)&amp;j, sizeof j);
+        setsockopt(s, SOL_SOCKET, SO_REUSEADDR, (void *)&amp;j, sizeof(j));
     }
 # endif
     if (bind(s, (struct sockaddr *)&amp;server, sizeof(server)) == -1) {
@@ -595,7 +595,7 @@ static struct hostent *GetHostByName(char *name)
         if (ret == NULL)
             return (NULL);
         /* else add to cache */
-        if (strlen(name) &lt; sizeof ghbn_cache[0].name) {
+        if (strlen(name) &lt; sizeof(ghbn_cache[0].name)) {
             strcpy(ghbn_cache[lowi].name, name);
             memcpy((char *)&amp;(ghbn_cache[lowi].ent), ret,
                    sizeof(struct hostent));
diff --git a/apps/s_time.c b/apps/s_time.c
index 38788f7..0bb2f8c 100644
--- a/apps/s_time.c
+++ b/apps/s_time.c
@@ -422,7 +422,7 @@ int MAIN(int argc, char **argv)
             goto end;
 
         if (s_www_path != NULL) {
-            BIO_snprintf(buf, sizeof buf, &quot;GET %s HTTP/1.0\r\n\r\n&quot;,
+            BIO_snprintf(buf, sizeof(buf), &quot;GET %s HTTP/1.0\r\n\r\n&quot;,
                          s_www_path);
             SSL_write(scon, buf, strlen(buf));
             while ((i = SSL_read(scon, buf, sizeof(buf))) &gt; 0)
@@ -481,7 +481,7 @@ int MAIN(int argc, char **argv)
     }
 
     if (s_www_path != NULL) {
-        BIO_snprintf(buf, sizeof buf, &quot;GET %s HTTP/1.0\r\n\r\n&quot;, s_www_path);
+        BIO_snprintf(buf, sizeof(buf), &quot;GET %s HTTP/1.0\r\n\r\n&quot;, s_www_path);
         SSL_write(scon, buf, strlen(buf));
         while (SSL_read(scon, buf, sizeof(buf)) &gt; 0) ;
     }
@@ -517,7 +517,7 @@ int MAIN(int argc, char **argv)
             goto end;
 
         if (s_www_path) {
-            BIO_snprintf(buf, sizeof buf, &quot;GET %s HTTP/1.0\r\n\r\n&quot;,
+            BIO_snprintf(buf, sizeof(buf), &quot;GET %s HTTP/1.0\r\n\r\n&quot;,
                          s_www_path);
             SSL_write(scon, buf, strlen(buf));
             while ((i = SSL_read(scon, buf, sizeof(buf))) &gt; 0)
diff --git a/apps/speed.c b/apps/speed.c
index 5383678..aaa982e 100644
--- a/apps/speed.c
+++ b/apps/speed.c
@@ -2091,7 +2091,7 @@ int MAIN(int argc, char **argv)
     RAND_pseudo_bytes(buf, 20);
 # ifndef OPENSSL_NO_DSA
     if (RAND_status() != 1) {
-        RAND_seed(rnd_seed, sizeof rnd_seed);
+        RAND_seed(rnd_seed, sizeof(rnd_seed));
         rnd_fake = 1;
     }
     for (j = 0; j &lt; DSA_NUM; j++) {
@@ -2170,7 +2170,7 @@ int MAIN(int argc, char **argv)
 
 # ifndef OPENSSL_NO_ECDSA
     if (RAND_status() != 1) {
-        RAND_seed(rnd_seed, sizeof rnd_seed);
+        RAND_seed(rnd_seed, sizeof(rnd_seed));
         rnd_fake = 1;
     }
     for (j = 0; j &lt; EC_NUM; j++) {
@@ -2265,7 +2265,7 @@ int MAIN(int argc, char **argv)
 
 # ifndef OPENSSL_NO_ECDH
     if (RAND_status() != 1) {
-        RAND_seed(rnd_seed, sizeof rnd_seed);
+        RAND_seed(rnd_seed, sizeof(rnd_seed));
         rnd_fake = 1;
     }
     for (j = 0; j &lt; EC_NUM; j++) {
@@ -2588,7 +2588,7 @@ static char *sstrsep(char **string, const char *delim)
     if (**string == 0)
         return NULL;
 
-    memset(isdelim, 0, sizeof isdelim);
+    memset(isdelim, 0, sizeof(isdelim));
     isdelim[0] = 1;
 
     while (*delim) {
@@ -2615,7 +2615,7 @@ static int do_multi(int multi)
     int *fds;
     static char sep[] = &quot;:&quot;;
 
-    fds = malloc(multi * sizeof *fds);
+    fds = malloc(multi * sizeof(*fds));
     if (fds == NULL) {
         fprintf(stderr, &quot;Out of memory in speed (do_multi)\n&quot;);
         exit(1);
@@ -2653,7 +2653,7 @@ static int do_multi(int multi)
         char *p;
 
         f = fdopen(fds[n], &quot;r&quot;);
-        while (fgets(buf, sizeof buf, f)) {
+        while (fgets(buf, sizeof(buf), f)) {
             p = strchr(buf, '\n');
             if (p)
                 *p = '\0';
diff --git a/apps/vms_term_sock.c b/apps/vms_term_sock.c
index a7d87ff..bc0c173 100755
--- a/apps/vms_term_sock.c
+++ b/apps/vms_term_sock.c
@@ -143,7 +143,7 @@ int main (int argc, char *argv[], char *envp[])
         ** Process the terminal input
         */
         LogMessage (&quot;Waiting on terminal I/O ...\n&quot;);
-        len = recv (TermSock, TermBuff, sizeof (TermBuff), 0) ;
+        len = recv (TermSock, TermBuff, sizeof(TermBuff), 0) ;
         TermBuff[len] = '\0';
         LogMessage (&quot;Received terminal I/O [%s]&quot;, TermBuff);
 
@@ -209,7 +209,7 @@ int TerminalSocket (int FunctionCode, int *ReturnSocket)
                           TerminalDeviceAst,
                           0,
                           TerminalDeviceBuff,
-                          sizeof (TerminalDeviceBuff) - 2,
+                          sizeof(TerminalDeviceBuff) - 2,
                           0, 0, 0, 0);
         if (! (status &amp; 1)) {
             LogMessage (&quot;TerminalSocket: SYS$QIO () - %08X&quot;, status);
@@ -317,7 +317,7 @@ static int CreateSocketPair (int SocketFamily,
     /*
     ** Initialize the socket information
     */
-    slen = sizeof (sin);
+    slen = sizeof(sin);
     memset ((char *) &amp;sin, 0, slen);
     sin.sin_family = SocketFamily;
     sin.sin_addr.s_addr = inet_addr (LocalHostAddr);
@@ -434,12 +434,12 @@ static int CreateSocketPair (int SocketFamily,
     /*
     ** Now issue the connect
     */
-    memset ((char *) &amp;sin, 0, sizeof (sin)) ;
+    memset ((char *) &amp;sin, 0, sizeof(sin)) ;
     sin.sin_family = SocketFamily;
     sin.sin_addr.s_addr = inet_addr (LocalHostAddr) ;
     sin.sin_port = LocalHostPort ;
 
-    status = connect (SockDesc2, (struct sockaddr *) &amp;sin, sizeof (sin));
+    status = connect (SockDesc2, (struct sockaddr *) &amp;sin, sizeof(sin));
     if (status &lt; 0 ) {
         LogMessage (&quot;CreateSocketPair: connect () - %d&quot;, errno);
         sys$cantim (&amp;sptb, 0);
@@ -528,7 +528,7 @@ static int TerminalDeviceAst (int astparm)
                       TerminalDeviceAst,
                       0,
                       TerminalDeviceBuff,
-                      sizeof (TerminalDeviceBuff) - 1,
+                      sizeof(TerminalDeviceBuff) - 1,
                       0, 0, 0, 0);
 
     /*
diff --git a/apps/winrand.c b/apps/winrand.c
index 44f57a3..fd5cf3b 100644
--- a/apps/winrand.c
+++ b/apps/winrand.c
@@ -77,7 +77,7 @@ int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance,
     char buffer[200];
 
     if (cmdline[0] == '\0')
-        filename = RAND_file_name(buffer, sizeof buffer);
+        filename = RAND_file_name(buffer, sizeof(buffer));
     else
         filename = cmdline;
 
diff --git a/apps/x509.c b/apps/x509.c
index ad9fc98..add74d5 100644
--- a/apps/x509.c
+++ b/apps/x509.c
@@ -817,10 +817,10 @@ int MAIN(int argc, char **argv)
                 char *m;
                 int y, z;
 
-                X509_NAME_oneline(X509_get_subject_name(x), buf, sizeof buf);
+                X509_NAME_oneline(X509_get_subject_name(x), buf, sizeof(buf));
                 BIO_printf(STDout, &quot;/* subject:%s */\n&quot;, buf);
                 m = X509_NAME_oneline(X509_get_issuer_name(x), buf,
-                                      sizeof buf);
+                                      sizeof(buf));
                 BIO_printf(STDout, &quot;/* issuer :%s */\n&quot;, buf);
 
                 z = i2d_X509(x, NULL);
diff --git a/crypto/asn1/a_gentm.c b/crypto/asn1/a_gentm.c
index 8511813..cb44815 100644
--- a/crypto/asn1/a_gentm.c
+++ b/crypto/asn1/a_gentm.c
@@ -78,7 +78,7 @@ int i2d_ASN1_GENERALIZEDTIME(ASN1_GENERALIZEDTIME *a, unsigned char **pp)
     ASN1_STRING tmpstr = *(ASN1_STRING *)a;
 
     len = tmpstr.length;
-    ebcdic2ascii(tmp, tmpstr.data, (len &gt;= sizeof tmp) ? sizeof tmp : len);
+    ebcdic2ascii(tmp, tmpstr.data, (len &gt;= sizeof(tmp)) ? sizeof(tmp) : len);
     tmpstr.data = tmp;
 
     a = (ASN1_GENERALIZEDTIME *)&tmpstr;
diff --git a/crypto/asn1/a_mbstr.c b/crypto/asn1/a_mbstr.c
index 6935efe..5b8028a 100644
--- a/crypto/asn1/a_mbstr.c
+++ b/crypto/asn1/a_mbstr.c
@@ -149,14 +149,14 @@ int ASN1_mbstring_ncopy(ASN1_STRING **out, const unsigned char *in, int len,
 
     if ((minsize &gt; 0) &amp;&amp; (nchar &lt; minsize)) {
         ASN1err(ASN1_F_ASN1_MBSTRING_NCOPY, ASN1_R_STRING_TOO_SHORT);
-        BIO_snprintf(strbuf, sizeof strbuf, &quot;%ld&quot;, minsize);
+        BIO_snprintf(strbuf, sizeof(strbuf), &quot;%ld&quot;, minsize);
         ERR_add_error_data(2, &quot;minsize=&quot;, strbuf);
         return -1;
     }
 
     if ((maxsize &gt; 0) &amp;&amp; (nchar &gt; maxsize)) {
         ASN1err(ASN1_F_ASN1_MBSTRING_NCOPY, ASN1_R_STRING_TOO_LONG);
-        BIO_snprintf(strbuf, sizeof strbuf, &quot;%ld&quot;, maxsize);
+        BIO_snprintf(strbuf, sizeof(strbuf), &quot;%ld&quot;, maxsize);
         ERR_add_error_data(2, &quot;maxsize=&quot;, strbuf);
         return -1;
     }
diff --git a/crypto/asn1/a_object.c b/crypto/asn1/a_object.c
index 229a40f..ad6b12a 100644
--- a/crypto/asn1/a_object.c
+++ b/crypto/asn1/a_object.c
@@ -89,7 +89,7 @@ int a2d_ASN1_OBJECT(unsigned char *out, int olen, const char *buf, int num)
 {
     int i, first, len = 0, c, use_bn;
     char ftmp[24], *tmp = ftmp;
-    int tmpsize = sizeof ftmp;
+    int tmpsize = sizeof(ftmp);
     const char *p;
     unsigned long l;
     BIGNUM *bl = NULL;
@@ -226,7 +226,7 @@ int i2a_ASN1_OBJECT(BIO *bp, ASN1_OBJECT *a)
 
     if ((a == NULL) || (a-&gt;data == NULL))
         return (BIO_write(bp, &quot;NULL&quot;, 4));
-    i = i2t_ASN1_OBJECT(buf, sizeof buf, a);
+    i = i2t_ASN1_OBJECT(buf, sizeof(buf), a);
     if (i &gt; (int)(sizeof(buf) - 1)) {
         p = OPENSSL_malloc(i + 1);
         if (!p)
diff --git a/crypto/asn1/a_strex.c b/crypto/asn1/a_strex.c
index 2d562f9..95f0416 100644
--- a/crypto/asn1/a_strex.c
+++ b/crypto/asn1/a_strex.c
@@ -130,13 +130,13 @@ static int do_esc_char(unsigned long c, unsigned char flags, char *do_quotes,
     if (c &gt; 0xffffffffL)
         return -1;
     if (c &gt; 0xffff) {
-        BIO_snprintf(tmphex, sizeof tmphex, &quot;\\W%08lX&quot;, c);
+        BIO_snprintf(tmphex, sizeof(tmphex), &quot;\\W%08lX&quot;, c);
         if (!io_ch(arg, tmphex, 10))
             return -1;
         return 10;
     }
     if (c &gt; 0xff) {
-        BIO_snprintf(tmphex, sizeof tmphex, &quot;\\U%04lX&quot;, c);
+        BIO_snprintf(tmphex, sizeof(tmphex), &quot;\\U%04lX&quot;, c);
         if (!io_ch(arg, tmphex, 6))
             return -1;
         return 6;
@@ -236,7 +236,7 @@ static int do_buf(unsigned char *buf, int buflen,
         if (type &amp; BUF_TYPE_CONVUTF8) {
             unsigned char utfbuf[6];
             int utflen;
-            utflen = UTF8_putc(utfbuf, sizeof utfbuf, c);
+            utflen = UTF8_putc(utfbuf, sizeof(utfbuf), c);
             for (i = 0; i &lt; utflen; i++) {
                 /*
                  * We don't need to worry about setting orflags correctly
@@ -533,7 +533,7 @@ static int do_name_ex(char_io *io_ch, void *arg, X509_NAME *n,
         if (fn_opt != XN_FLAG_FN_NONE) {
             int objlen, fld_len;
             if ((fn_opt == XN_FLAG_FN_OID) || (fn_nid == NID_undef)) {
-                OBJ_obj2txt(objtmp, sizeof objtmp, fn, 1);
+                OBJ_obj2txt(objtmp, sizeof(objtmp), fn, 1);
                 fld_len = 0;    /* XXX: what should this be? */
                 objbuf = objtmp;
             } else {
diff --git a/crypto/asn1/a_time.c b/crypto/asn1/a_time.c
index 0eeb79c..28831d6 100644
--- a/crypto/asn1/a_time.c
+++ b/crypto/asn1/a_time.c
@@ -86,7 +86,7 @@ int i2d_ASN1_TIME(ASN1_TIME *a, unsigned char **pp)
         tmpstr = *(ASN1_STRING *)a;
         len = tmpstr.length;
         ebcdic2ascii(tmp, tmpstr.data,
-                     (len &gt;= sizeof tmp) ? sizeof tmp : len);
+                     (len &gt;= sizeof(tmp)) ? sizeof(tmp) : len);
         tmpstr.data = tmp;
         a = (ASN1_GENERALIZEDTIME *)&tmpstr;
     }
diff --git a/crypto/asn1/a_utctm.c b/crypto/asn1/a_utctm.c
index 0344482..9cbad7c 100644
--- a/crypto/asn1/a_utctm.c
+++ b/crypto/asn1/a_utctm.c
@@ -76,7 +76,7 @@ int i2d_ASN1_UTCTIME(ASN1_UTCTIME *a, unsigned char **pp)
     ASN1_STRING x = *(ASN1_STRING *)a;
 
     len = x.length;
-    ebcdic2ascii(tmp, x.data, (len &gt;= sizeof tmp) ? sizeof tmp : len);
+    ebcdic2ascii(tmp, x.data, (len &gt;= sizeof(tmp)) ? sizeof(tmp) : len);
     x.data = tmp;
     return i2d_ASN1_bytes(&amp;x, pp, V_ASN1_UTCTIME, V_ASN1_UNIVERSAL);
 # endif
@@ -317,7 +317,7 @@ time_t ASN1_UTCTIME_get(const ASN1_UTCTIME *s)
     struct tm tm;
     int offset;
 
-    memset(&amp;tm, '\0', sizeof tm);
+    memset(&amp;tm, '\0', sizeof(tm));
 
 # define g2(p) (((p)[0]-'0')*10+(p)[1]-'0')
     tm.tm_year = g2(s-&gt;data);
diff --git a/crypto/asn1/asn1_lib.c b/crypto/asn1/asn1_lib.c
index e63e82a..b52c3e1 100644
--- a/crypto/asn1/asn1_lib.c
+++ b/crypto/asn1/asn1_lib.c
@@ -456,8 +456,8 @@ void asn1_add_error(const unsigned char *address, int offset)
 {
     char buf1[DECIMAL_SIZE(address) + 1], buf2[DECIMAL_SIZE(offset) + 1];
 
-    BIO_snprintf(buf1, sizeof buf1, &quot;%lu&quot;, (unsigned long)address);
-    BIO_snprintf(buf2, sizeof buf2, &quot;%d&quot;, offset);
+    BIO_snprintf(buf1, sizeof(buf1), &quot;%lu&quot;, (unsigned long)address);
+    BIO_snprintf(buf2, sizeof(buf2), &quot;%d&quot;, offset);
     ERR_add_error_data(4, &quot;address=&quot;, buf1, &quot; offset=&quot;, buf2);
 }
 
diff --git a/crypto/asn1/asn1_par.c b/crypto/asn1/asn1_par.c
index e85e339..0b1a689 100644
--- a/crypto/asn1/asn1_par.c
+++ b/crypto/asn1/asn1_par.c
@@ -87,13 +87,13 @@ static int asn1_print_info(BIO *bp, int tag, int xclass, int constructed,
 
     p = str;
     if ((xclass &amp; V_ASN1_PRIVATE) == V_ASN1_PRIVATE)
-        BIO_snprintf(str, sizeof str, &quot;priv [ %d ] &quot;, tag);
+        BIO_snprintf(str, sizeof(str), &quot;priv [ %d ] &quot;, tag);
     else if ((xclass &amp; V_ASN1_CONTEXT_SPECIFIC) == V_ASN1_CONTEXT_SPECIFIC)
-        BIO_snprintf(str, sizeof str, &quot;cont [ %d ]&quot;, tag);
+        BIO_snprintf(str, sizeof(str), &quot;cont [ %d ]&quot;, tag);
     else if ((xclass &amp; V_ASN1_APPLICATION) == V_ASN1_APPLICATION)
-        BIO_snprintf(str, sizeof str, &quot;appl [ %d ]&quot;, tag);
+        BIO_snprintf(str, sizeof(str), &quot;appl [ %d ]&quot;, tag);
     else if (tag &gt; 30)
-        BIO_snprintf(str, sizeof str, &quot;&lt;ASN1 %d&gt;&quot;, tag);
+        BIO_snprintf(str, sizeof(str), &quot;&lt;ASN1 %d&gt;&quot;, tag);
     else
         p = ASN1_tag2str(tag);
 
diff --git a/crypto/asn1/t_x509a.c b/crypto/asn1/t_x509a.c
index f4b8f94..d1b897a 100644
--- a/crypto/asn1/t_x509a.c
+++ b/crypto/asn1/t_x509a.c
@@ -81,7 +81,7 @@ int X509_CERT_AUX_print(BIO *out, X509_CERT_AUX *aux, int indent)
                 BIO_puts(out, &quot;, &quot;);
             else
                 first = 0;
-            OBJ_obj2txt(oidstr, sizeof oidstr,
+            OBJ_obj2txt(oidstr, sizeof(oidstr),
                         sk_ASN1_OBJECT_value(aux-&gt;trust, i), 0);
             BIO_puts(out, oidstr);
         }
@@ -96,7 +96,7 @@ int X509_CERT_AUX_print(BIO *out, X509_CERT_AUX *aux, int indent)
                 BIO_puts(out, &quot;, &quot;);
             else
                 first = 0;
-            OBJ_obj2txt(oidstr, sizeof oidstr,
+            OBJ_obj2txt(oidstr, sizeof(oidstr),
                         sk_ASN1_OBJECT_value(aux-&gt;reject, i), 0);
             BIO_puts(out, oidstr);
         }
diff --git a/crypto/asn1/tasn_prn.c b/crypto/asn1/tasn_prn.c
index f628cad..e93fd11 100644
--- a/crypto/asn1/tasn_prn.c
+++ b/crypto/asn1/tasn_prn.c
@@ -463,7 +463,7 @@ static int asn1_print_oid_ctx(BIO *out, const ASN1_OBJECT *oid,
     ln = OBJ_nid2ln(OBJ_obj2nid(oid));
     if (!ln)
         ln = &quot;&quot;;
-    OBJ_obj2txt(objbuf, sizeof objbuf, oid, 1);
+    OBJ_obj2txt(objbuf, sizeof(objbuf), oid, 1);
     if (BIO_printf(out, &quot;%s (%s)&quot;, ln, objbuf) &lt;= 0)
         return 0;
     return 1;
diff --git a/crypto/bf/bftest.c b/crypto/bf/bftest.c
index 0b008f0..bd20a8e 100644
--- a/crypto/bf/bftest.c
+++ b/crypto/bf/bftest.c
@@ -462,9 +462,9 @@ static int test(void)
     len = strlen(cbc_data) + 1;
 
     BF_set_key(&amp;key, 16, cbc_key);
-    memset(cbc_in, 0, sizeof cbc_in);
-    memset(cbc_out, 0, sizeof cbc_out);
-    memcpy(iv, cbc_iv, sizeof iv);
+    memset(cbc_in, 0, sizeof(cbc_in));
+    memset(cbc_out, 0, sizeof(cbc_out));
+    memcpy(iv, cbc_iv, sizeof(iv));
     BF_cbc_encrypt((unsigned char *)cbc_data, cbc_out, len,
                    &amp;key, iv, BF_ENCRYPT);
     if (memcmp(cbc_out, cbc_ok, 32) != 0) {
diff --git a/crypto/bio/b_dump.c b/crypto/bio/b_dump.c
index ccf0e28..86a98e1 100644
--- a/crypto/bio/b_dump.c
+++ b/crypto/bio/b_dump.c
@@ -104,36 +104,36 @@ int BIO_dump_indent_cb(int (*cb) (const void *data, size_t len, void *u),
     if ((rows * dump_width) &lt; len)
         rows++;
     for (i = 0; i &lt; rows; i++) {
-        BUF_strlcpy(buf, str, sizeof buf);
-        BIO_snprintf(tmp, sizeof tmp, &quot;%04x - &quot;, i * dump_width);
-        BUF_strlcat(buf, tmp, sizeof buf);
+        BUF_strlcpy(buf, str, sizeof(buf));
+        BIO_snprintf(tmp, sizeof(tmp), &quot;%04x - &quot;, i * dump_width);
+        BUF_strlcat(buf, tmp, sizeof(buf));
         for (j = 0; j &lt; dump_width; j++) {
             if (((i * dump_width) + j) &gt;= len) {
-                BUF_strlcat(buf, &quot;   &quot;, sizeof buf);
+                BUF_strlcat(buf, &quot;   &quot;, sizeof(buf));
             } else {
                 ch = ((unsigned char)*(s + i * dump_width + j)) &amp; 0xff;
-                BIO_snprintf(tmp, sizeof tmp, &quot;%02x%c&quot;, ch,
+                BIO_snprintf(tmp, sizeof(tmp), &quot;%02x%c&quot;, ch,
                              j == 7 ? '-' : ' ');
-                BUF_strlcat(buf, tmp, sizeof buf);
+                BUF_strlcat(buf, tmp, sizeof(buf));
             }
         }
-        BUF_strlcat(buf, &quot;  &quot;, sizeof buf);
+        BUF_strlcat(buf, &quot;  &quot;, sizeof(buf));
         for (j = 0; j &lt; dump_width; j++) {
             if (((i * dump_width) + j) &gt;= len)
                 break;
             ch = ((unsigned char)*(s + i * dump_width + j)) &amp; 0xff;
 #ifndef CHARSET_EBCDIC
-            BIO_snprintf(tmp, sizeof tmp, &quot;%c&quot;,
+            BIO_snprintf(tmp, sizeof(tmp), &quot;%c&quot;,
                          ((ch &gt;= ' ') &amp;&amp; (ch &lt;= '~')) ? ch : '.');
 #else
-            BIO_snprintf(tmp, sizeof tmp, &quot;%c&quot;,
+            BIO_snprintf(tmp, sizeof(tmp), &quot;%c&quot;,
                          ((ch &gt;= os_toascii[' ']) &amp;&amp; (ch &lt;= os_toascii['~']))
                          ? os_toebcdic[ch]
                          : '.');
 #endif
-            BUF_strlcat(buf, tmp, sizeof buf);
+            BUF_strlcat(buf, tmp, sizeof(buf));
         }
-        BUF_strlcat(buf, &quot;\n&quot;, sizeof buf);
+        BUF_strlcat(buf, &quot;\n&quot;, sizeof(buf));
         /*
          * if this is the last call then update the ddt_dump thing so that we
          * will move the selection point in the debug window
@@ -142,7 +142,7 @@ int BIO_dump_indent_cb(int (*cb) (const void *data, size_t len, void *u),
     }
 #ifdef TRUNCATE
     if (trc &gt; 0) {
-        BIO_snprintf(buf, sizeof buf, &quot;%s%04x - &lt;SPACES/NULS&gt;\n&quot;, str,
+        BIO_snprintf(buf, sizeof(buf), &quot;%s%04x - &lt;SPACES/NULS&gt;\n&quot;, str,
                      len + trc);
         ret += cb((void *)buf, strlen(buf), u);
     }
diff --git a/crypto/bio/b_print.c b/crypto/bio/b_print.c
index 1c82f53..47654f8 100644
--- a/crypto/bio/b_print.c
+++ b/crypto/bio/b_print.c
@@ -663,7 +663,7 @@ fmtfp(char **sbuffer,
         iconvert[iplace++] = &quot;0123456789&quot;[intpart % 10];
         intpart = (intpart / 10);
     } while (intpart &amp;&amp; (iplace &lt; (int)sizeof(iconvert)));
-    if (iplace == sizeof iconvert)
+    if (iplace == sizeof(iconvert))
         iplace--;
     iconvert[iplace] = 0;
 
@@ -672,7 +672,7 @@ fmtfp(char **sbuffer,
         fconvert[fplace++] = &quot;0123456789&quot;[fracpart % 10];
         fracpart = (fracpart / 10);
     } while (fplace &lt; max);
-    if (fplace == sizeof fconvert)
+    if (fplace == sizeof(fconvert))
         fplace--;
     fconvert[fplace] = 0;
 
diff --git a/crypto/bio/bio_cb.c b/crypto/bio/bio_cb.c
index f96294b..2ff5263 100644
--- a/crypto/bio/bio_cb.c
+++ b/crypto/bio/bio_cb.c
@@ -76,7 +76,7 @@ long MS_CALLBACK BIO_debug_callback(BIO *bio, int cmd, const char *argp,
     if (BIO_CB_RETURN &amp; cmd)
         r = ret;
 
-    len = BIO_snprintf(buf,sizeof buf,&quot;BIO[%p]: &quot;,(void *)bio);
+    len = BIO_snprintf(buf,sizeof(buf),&quot;BIO[%p]: &quot;,(void *)bio);
 
     /* Ignore errors and continue printing the other information. */
     if (len &lt; 0)
diff --git a/crypto/bio/bss_bio.c b/crypto/bio/bss_bio.c
index 3dd8187..096ea41 100644
--- a/crypto/bio/bss_bio.c
+++ b/crypto/bio/bss_bio.c
@@ -144,7 +144,7 @@ static int bio_new(BIO *bio)
 {
     struct bio_bio_st *b;
 
-    b = OPENSSL_malloc(sizeof *b);
+    b = OPENSSL_malloc(sizeof(*b));
     if (b == NULL)
         return 0;
 
diff --git a/crypto/bio/bss_conn.c b/crypto/bio/bss_conn.c
index 7d15ad2..bbc6d5a 100644
--- a/crypto/bio/bss_conn.c
+++ b/crypto/bio/bss_conn.c
@@ -481,7 +481,7 @@ static long conn_ctrl(BIO *b, int cmd, long num, void *ptr)
                 char buf[16];
                 unsigned char *p = ptr;
 
-                BIO_snprintf(buf, sizeof buf, &quot;%d.%d.%d.%d&quot;,
+                BIO_snprintf(buf, sizeof(buf), &quot;%d.%d.%d.%d&quot;,
                              p[0], p[1], p[2], p[3]);
                 if (data-&gt;param_hostname != NULL)
                     OPENSSL_free(data-&gt;param_hostname);
@@ -490,7 +490,7 @@ static long conn_ctrl(BIO *b, int cmd, long num, void *ptr)
             } else if (num == 3) {
                 char buf[DECIMAL_SIZE(int) + 1];
 
-                BIO_snprintf(buf, sizeof buf, &quot;%d&quot;, *(int *)ptr);
+                BIO_snprintf(buf, sizeof(buf), &quot;%d&quot;, *(int *)ptr);
                 if (data-&gt;param_port != NULL)
                     OPENSSL_free(data-&gt;param_port);
                 data-&gt;param_port = BUF_strdup(buf);
diff --git a/crypto/bio/bss_file.c b/crypto/bio/bss_file.c
index 0cf67e5..bbf906f 100644
--- a/crypto/bio/bss_file.c
+++ b/crypto/bio/bss_file.c
@@ -375,15 +375,15 @@ static long MS_CALLBACK file_ctrl(BIO *b, int cmd, long num, void *ptr)
         b-&gt;shutdown = (int)num &amp; BIO_CLOSE;
         if (num &amp; BIO_FP_APPEND) {
             if (num &amp; BIO_FP_READ)
-                BUF_strlcpy(p, &quot;a+&quot;, sizeof p);
+                BUF_strlcpy(p, &quot;a+&quot;, sizeof(p));
             else
-                BUF_strlcpy(p, &quot;a&quot;, sizeof p);
+                BUF_strlcpy(p, &quot;a&quot;, sizeof(p));
         } else if ((num &amp; BIO_FP_READ) &amp;&amp; (num &amp; BIO_FP_WRITE))
-            BUF_strlcpy(p, &quot;r+&quot;, sizeof p);
+            BUF_strlcpy(p, &quot;r+&quot;, sizeof(p));
         else if (num &amp; BIO_FP_WRITE)
-            BUF_strlcpy(p, &quot;w&quot;, sizeof p);
+            BUF_strlcpy(p, &quot;w&quot;, sizeof(p));
         else if (num &amp; BIO_FP_READ)
-            BUF_strlcpy(p, &quot;r&quot;, sizeof p);
+            BUF_strlcpy(p, &quot;r&quot;, sizeof(p));
         else {
             BIOerr(BIO_F_FILE_CTRL, BIO_R_BAD_FOPEN_MODE);
             ret = 0;
diff --git a/crypto/bn/bn_print.c b/crypto/bn/bn_print.c
index f85a655..c0b029d 100644
--- a/crypto/bn/bn_print.c
+++ b/crypto/bn/bn_print.c
@@ -391,10 +391,10 @@ char *BN_options(void)
     if (!init) {
         init++;
 #ifdef BN_LLONG
-        BIO_snprintf(data, sizeof data, &quot;bn(%d,%d)&quot;,
+        BIO_snprintf(data, sizeof(data), &quot;bn(%d,%d)&quot;,
                      (int)sizeof(BN_ULLONG) * 8, (int)sizeof(BN_ULONG) * 8);
 #else
-        BIO_snprintf(data, sizeof data, &quot;bn(%d,%d)&quot;,
+        BIO_snprintf(data, sizeof(data), &quot;bn(%d,%d)&quot;,
                      (int)sizeof(BN_ULONG) * 8, (int)sizeof(BN_ULONG) * 8);
 #endif
     }
diff --git a/crypto/bn/bntest.c b/crypto/bn/bntest.c
index a327b1a..abe5dbe 100644
--- a/crypto/bn/bntest.c
+++ b/crypto/bn/bntest.c
@@ -148,7 +148,7 @@ int main(int argc, char *argv[])
 
     results = 0;
 
-    RAND_seed(rnd_seed, sizeof rnd_seed); /* or BN_generate_prime may fail */
+    RAND_seed(rnd_seed, sizeof(rnd_seed)); /* or BN_generate_prime may fail */
 
     argc--;
     argv++;
diff --git a/crypto/bn/expspeed.c b/crypto/bn/expspeed.c
index 513a568..8ea980c 100644
--- a/crypto/bn/expspeed.c
+++ b/crypto/bn/expspeed.c
@@ -198,7 +198,7 @@ static int mul_c[NUM_SIZES] =
  * static int sizes[NUM_SIZES]={59,179,299,419,539};
  */
 
-#define RAND_SEED(string) { const char str[] = string; RAND_seed(string, sizeof str); }
+#define RAND_SEED(string) { const char str[] = string; RAND_seed(string, sizeof(str)); }
 
 void do_mul_exp(BIGNUM *r, BIGNUM *a, BIGNUM *b, BIGNUM *c, BN_CTX *ctx);
 
diff --git a/crypto/bn/exptest.c b/crypto/bn/exptest.c
index ac611c2..779ee90 100644
--- a/crypto/bn/exptest.c
+++ b/crypto/bn/exptest.c
@@ -183,9 +183,11 @@ int main(int argc, char *argv[])
     unsigned char c;
     BIGNUM *r_mont, *r_mont_const, *r_recp, *r_simple, *a, *b, *m;
 
-    RAND_seed(rnd_seed, sizeof rnd_seed); /* or BN_rand may fail, and we
-                                           * don't even check its return
-                                           * value (which we should) */
+    /*
+     * Seed or BN_rand may fail, and we don't even check its return
+     * value (which we should)
+     */
+    RAND_seed(rnd_seed, sizeof(rnd_seed));
 
     ERR_load_BN_strings();
 
diff --git a/crypto/conf/conf_def.c b/crypto/conf/conf_def.c
index 75e309a..6237f6a 100644
--- a/crypto/conf/conf_def.c
+++ b/crypto/conf/conf_def.c
@@ -423,7 +423,7 @@ static int def_load_bio(CONF *conf, BIO *in, long *line)
         OPENSSL_free(section);
     if (line != NULL)
         *line = eline;
-    BIO_snprintf(btmp, sizeof btmp, &quot;%ld&quot;, eline);
+    BIO_snprintf(btmp, sizeof(btmp), &quot;%ld&quot;, eline);
     ERR_add_error_data(2, &quot;line &quot;, btmp);
     if ((h != conf-&gt;data) &amp;&amp; (conf-&gt;data != NULL)) {
         CONF_free(conf-&gt;data);
diff --git a/crypto/conf/conf_mod.c b/crypto/conf/conf_mod.c
index e0c9a67..e2a9a81 100644
--- a/crypto/conf/conf_mod.c
+++ b/crypto/conf/conf_mod.c
@@ -221,7 +221,7 @@ static int module_run(const CONF *cnf, char *name, char *value,
         if (!(flags &amp; CONF_MFLAGS_SILENT)) {
             char rcode[DECIMAL_SIZE(ret) + 1];
             CONFerr(CONF_F_MODULE_RUN, CONF_R_MODULE_INITIALIZATION_ERROR);
-            BIO_snprintf(rcode, sizeof rcode, &quot;%-8d&quot;, ret);
+            BIO_snprintf(rcode, sizeof(rcode), &quot;%-8d&quot;, ret);
             ERR_add_error_data(6, &quot;module=&quot;, name, &quot;, value=&quot;, value,
                                &quot;, retcode=&quot;, rcode);
         }
diff --git a/crypto/des/destest.c b/crypto/des/destest.c
index c6be342..f2041c1 100644
--- a/crypto/des/destest.c
+++ b/crypto/des/destest.c
@@ -398,7 +398,7 @@ int main(int argc, char *argv[])
     i = strlen((char *)cbc_data) + 1;
     /* i=((i+7)/8)*8; */
     memcpy(iv3, cbc_iv, sizeof(cbc_iv));
-    memset(iv2, '\0', sizeof iv2);
+    memset(iv2, '\0', sizeof(iv2));
 
     DES_ede3_cbcm_encrypt(cbc_data, cbc_out, 16L, &amp;ks, &amp;ks2, &amp;ks3, &amp;iv3, &amp;iv2,
                           DES_ENCRYPT);
@@ -412,7 +412,7 @@ int main(int argc, char *argv[])
         }
 */
     memcpy(iv3, cbc_iv, sizeof(cbc_iv));
-    memset(iv2, '\0', sizeof iv2);
+    memset(iv2, '\0', sizeof(iv2));
     DES_ede3_cbcm_encrypt(cbc_out, cbc_in, i, &amp;ks, &amp;ks2, &amp;ks3, &amp;iv3, &amp;iv2,
                           DES_DECRYPT);
     if (memcmp(cbc_in, cbc_data, strlen((char *)cbc_data) + 1) != 0) {
diff --git a/crypto/des/ecb_enc.c b/crypto/des/ecb_enc.c
index f97fd97..60470d6 100644
--- a/crypto/des/ecb_enc.c
+++ b/crypto/des/ecb_enc.c
@@ -96,7 +96,7 @@ const char *DES_options(void)
             size = &quot;int&quot;;
         else
             size = &quot;long&quot;;
-        BIO_snprintf(buf, sizeof buf, &quot;des(%s,%s,%s,%s)&quot;, ptr, risc, unroll,
+        BIO_snprintf(buf, sizeof(buf), &quot;des(%s,%s,%s,%s)&quot;, ptr, risc, unroll,
                      size);
         init = 0;
     }
diff --git a/crypto/des/fcrypt.c b/crypto/des/fcrypt.c
index 111f1e4..09f5792 100644
--- a/crypto/des/fcrypt.c
+++ b/crypto/des/fcrypt.c
@@ -80,10 +80,10 @@ char *DES_crypt(const char *buf, const char *salt)
     e_salt[sizeof(e_salt) - 1] = e_buf[sizeof(e_buf) - 1] = '\0';
 
     /* Convert the e_salt to ASCII, as that's what DES_fcrypt works on */
-    ebcdic2ascii(e_salt, e_salt, sizeof e_salt);
+    ebcdic2ascii(e_salt, e_salt, sizeof(e_salt));
 
     /* Convert the cleartext password to ASCII */
-    ebcdic2ascii(e_buf, e_buf, sizeof e_buf);
+    ebcdic2ascii(e_buf, e_buf, sizeof(e_buf));
 
     /* Encrypt it (from/to ASCII) */
     ret = DES_fcrypt(e_buf, e_salt, buff);
diff --git a/crypto/des/read_pwd.c b/crypto/des/read_pwd.c
index 514a706..080d3e8 100644
--- a/crypto/des/read_pwd.c
+++ b/crypto/des/read_pwd.c
@@ -434,7 +434,7 @@ static void pushsig(void)
 # ifdef SIGACTION
     struct sigaction sa;
 
-    memset(&amp;sa, 0, sizeof sa);
+    memset(&amp;sa, 0, sizeof(sa));
     sa.sa_handler = recsig;
 # endif
 
diff --git a/crypto/des/set_key.c b/crypto/des/set_key.c
index d9c5e7f..0a9ddb4 100644
--- a/crypto/des/set_key.c
+++ b/crypto/des/set_key.c
@@ -377,7 +377,7 @@ void private_DES_set_key_unchecked(const_DES_cblock *key,
     register int i;
 
 #ifdef OPENBSD_DEV_CRYPTO
-    memcpy(schedule-&gt;key, key, sizeof schedule-&gt;key);
+    memcpy(schedule-&gt;key, key, sizeof(schedule-&gt;key));
     schedule-&gt;session = NULL;
 #endif
     k = &amp;schedule-&gt;ks-&gt;deslong[0];
diff --git a/crypto/dh/dhtest.c b/crypto/dh/dhtest.c
index c5d3d87..cb83109 100644
--- a/crypto/dh/dhtest.c
+++ b/crypto/dh/dhtest.c
@@ -116,7 +116,7 @@ int main(int argc, char *argv[])
     CRYPTO_malloc_init();
 # endif
 
-    RAND_seed(rnd_seed, sizeof rnd_seed);
+    RAND_seed(rnd_seed, sizeof(rnd_seed));
 
     out = BIO_new(BIO_s_file());
     if (out == NULL)
diff --git a/crypto/dsa/dsatest.c b/crypto/dsa/dsatest.c
index 8a224a8..bee9543 100644
--- a/crypto/dsa/dsatest.c
+++ b/crypto/dsa/dsatest.c
@@ -157,7 +157,7 @@ int main(int argc, char **argv)
     CRYPTO_mem_ctrl(CRYPTO_MEM_CHECK_ON);
 
     ERR_load_crypto_strings();
-    RAND_seed(rnd_seed, sizeof rnd_seed);
+    RAND_seed(rnd_seed, sizeof(rnd_seed));
 
     BIO_printf(bio_err, &quot;test generation of DSA parameters\n&quot;);
 
diff --git a/crypto/ec/ec_lib.c b/crypto/ec/ec_lib.c
index 3ffa112..3241aa5 100644
--- a/crypto/ec/ec_lib.c
+++ b/crypto/ec/ec_lib.c
@@ -85,7 +85,7 @@ EC_GROUP *EC_GROUP_new(const EC_METHOD *meth)
         return NULL;
     }
 
-    ret = OPENSSL_malloc(sizeof *ret);
+    ret = OPENSSL_malloc(sizeof(*ret));
     if (ret == NULL) {
         ECerr(EC_F_EC_GROUP_NEW, ERR_R_MALLOC_FAILURE);
         return NULL;
@@ -164,7 +164,7 @@ void EC_GROUP_clear_free(EC_GROUP *group)
         OPENSSL_free(group-&gt;seed);
     }
 
-    OPENSSL_cleanse(group, sizeof *group);
+    OPENSSL_cleanse(group, sizeof(*group));
     OPENSSL_free(group);
 }
 
@@ -575,7 +575,7 @@ int EC_EX_DATA_set_data(EC_EXTRA_DATA **ex_data, void *data,
         /* no explicit entry needed */
         return 1;
 
-    d = OPENSSL_malloc(sizeof *d);
+    d = OPENSSL_malloc(sizeof(*d));
     if (d == NULL)
         return 0;
 
@@ -712,7 +712,7 @@ EC_POINT *EC_POINT_new(const EC_GROUP *group)
         return NULL;
     }
 
-    ret = OPENSSL_malloc(sizeof *ret);
+    ret = OPENSSL_malloc(sizeof(*ret));
     if (ret == NULL) {
         ECerr(EC_F_EC_POINT_NEW, ERR_R_MALLOC_FAILURE);
         return NULL;
@@ -747,7 +747,7 @@ void EC_POINT_clear_free(EC_POINT *point)
         point-&gt;meth-&gt;point_clear_finish(point);
     else if (point-&gt;meth-&gt;point_finish != 0)
         point-&gt;meth-&gt;point_finish(point);
-    OPENSSL_cleanse(point, sizeof *point);
+    OPENSSL_cleanse(point, sizeof(*point));
     OPENSSL_free(point);
 }
 
diff --git a/crypto/ec/ec_mult.c b/crypto/ec/ec_mult.c
index 24ca67a..2231f99 100644
--- a/crypto/ec/ec_mult.c
+++ b/crypto/ec/ec_mult.c
@@ -169,11 +169,11 @@ static void ec_pre_comp_clear_free(void *pre_)
 
         for (p = pre-&gt;points; *p != NULL; p++) {
             EC_POINT_clear_free(*p);
-            OPENSSL_cleanse(p, sizeof *p);
+            OPENSSL_cleanse(p, sizeof(*p));
         }
         OPENSSL_free(pre-&gt;points);
     }
-    OPENSSL_cleanse(pre, sizeof *pre);
+    OPENSSL_cleanse(pre, sizeof(*pre));
     OPENSSL_free(pre);
 }
 
@@ -430,11 +430,11 @@ int ec_wNAF_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *scalar,
 
     totalnum = num + numblocks;
 
-    wsize = OPENSSL_malloc(totalnum * sizeof wsize[0]);
-    wNAF_len = OPENSSL_malloc(totalnum * sizeof wNAF_len[0]);
-    wNAF = OPENSSL_malloc((totalnum + 1) * sizeof wNAF[0]); /* includes space
-                                                             * for pivot */
-    val_sub = OPENSSL_malloc(totalnum * sizeof val_sub[0]);
+    wsize = OPENSSL_malloc(totalnum * sizeof(wsize[0]));
+    wNAF_len = OPENSSL_malloc(totalnum * sizeof(wNAF_len[0]));
+    /* include space for pivot */
+    wNAF = OPENSSL_malloc((totalnum + 1) * sizeof(wNAF[0]));
+    val_sub = OPENSSL_malloc(totalnum * sizeof(val_sub[0]));
 
     /* Ensure wNAF is initialised in case we end up going to err */
     if (wNAF)
@@ -580,7 +580,7 @@ int ec_wNAF_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *scalar,
      * 'val_sub[i]' is a pointer to the subarray for the i-th point, or to a
      * subarray of 'pre_comp-&gt;points' if we already have precomputation.
      */
-    val = OPENSSL_malloc((num_val + 1) * sizeof val[0]);
+    val = OPENSSL_malloc((num_val + 1) * sizeof(val[0]));
     if (val == NULL) {
         ECerr(EC_F_EC_WNAF_MUL, ERR_R_MALLOC_FAILURE);
         goto err;
diff --git a/crypto/ec/ecp_nistp224.c b/crypto/ec/ecp_nistp224.c
index fcd754e..03c556b 100644
--- a/crypto/ec/ecp_nistp224.c
+++ b/crypto/ec/ecp_nistp224.c
@@ -351,9 +351,9 @@ static int BN_to_felem(felem out, const BIGNUM *bn)
     unsigned num_bytes;
 
     /* BN_bn2bin eats leading zeroes */
-    memset(b_out, 0, sizeof b_out);
+    memset(b_out, 0, sizeof(b_out));
     num_bytes = BN_num_bytes(bn);
-    if (num_bytes &gt; sizeof b_out) {
+    if (num_bytes &gt; sizeof(b_out)) {
         ECerr(EC_F_BN_TO_FELEM, EC_R_BIGNUM_OUT_OF_RANGE);
         return 0;
     }
@@ -372,8 +372,8 @@ static BIGNUM *felem_to_BN(BIGNUM *out, const felem in)
 {
     felem_bytearray b_in, b_out;
     felem_to_bin28(b_in, in);
-    flip_endian(b_out, b_in, sizeof b_out);
-    return BN_bin2bn(b_out, sizeof b_out, out);
+    flip_endian(b_out, b_in, sizeof(b_out));
+    return BN_bin2bn(b_out, sizeof(b_out), out);
 }
 
 /******************************************************************************/
@@ -1234,7 +1234,7 @@ static void batch_mul(felem x_out, felem y_out, felem z_out,
 static NISTP224_PRE_COMP *nistp224_pre_comp_new()
 {
     NISTP224_PRE_COMP *ret = NULL;
-    ret = (NISTP224_PRE_COMP *) OPENSSL_malloc(sizeof *ret);
+    ret = (NISTP224_PRE_COMP *) OPENSSL_malloc(sizeof(*ret));
     if (!ret) {
         ECerr(EC_F_NISTP224_PRE_COMP_NEW, ERR_R_MALLOC_FAILURE);
         return ret;
@@ -1281,7 +1281,7 @@ static void nistp224_pre_comp_clear_free(void *pre_)
     if (i &gt; 0)
         return;
 
-    OPENSSL_cleanse(pre, sizeof *pre);
+    OPENSSL_cleanse(pre, sizeof(*pre));
     OPENSSL_free(pre);
 }
 
@@ -1568,7 +1568,7 @@ int ec_GFp_nistp224_points_mul(const EC_GROUP *group, EC_POINT *r,
 
     /* the scalar for the generator */
     if ((scalar != NULL) &amp;&amp; (have_pre_comp)) {
-        memset(g_secret, 0, sizeof g_secret);
+        memset(g_secret, 0, sizeof(g_secret));
         /* reduce scalar to 0 &lt;= scalar &lt; 2^224 */
         if ((BN_num_bits(scalar) &gt; 224) || (BN_is_negative(scalar))) {
             /*
diff --git a/crypto/ec/ecp_nistp256.c b/crypto/ec/ecp_nistp256.c
index 1272966..42be712 100644
--- a/crypto/ec/ecp_nistp256.c
+++ b/crypto/ec/ecp_nistp256.c
@@ -161,9 +161,9 @@ static int BN_to_felem(felem out, const BIGNUM *bn)
     unsigned num_bytes;
 
     /* BN_bn2bin eats leading zeroes */
-    memset(b_out, 0, sizeof b_out);
+    memset(b_out, 0, sizeof(b_out));
     num_bytes = BN_num_bytes(bn);
-    if (num_bytes &gt; sizeof b_out) {
+    if (num_bytes &gt; sizeof(b_out)) {
         ECerr(EC_F_BN_TO_FELEM, EC_R_BIGNUM_OUT_OF_RANGE);
         return 0;
     }
@@ -182,8 +182,8 @@ static BIGNUM *smallfelem_to_BN(BIGNUM *out, const smallfelem in)
 {
     felem_bytearray b_in, b_out;
     smallfelem_to_bin32(b_in, in);
-    flip_endian(b_out, b_in, sizeof b_out);
-    return BN_bin2bn(b_out, sizeof b_out, out);
+    flip_endian(b_out, b_in, sizeof(b_out));
+    return BN_bin2bn(b_out, sizeof(b_out), out);
 }
 
 /*-
@@ -1820,7 +1820,7 @@ const EC_METHOD *EC_GFp_nistp256_method(void)
 static NISTP256_PRE_COMP *nistp256_pre_comp_new()
 {
     NISTP256_PRE_COMP *ret = NULL;
-    ret = (NISTP256_PRE_COMP *) OPENSSL_malloc(sizeof *ret);
+    ret = (NISTP256_PRE_COMP *) OPENSSL_malloc(sizeof(*ret));
     if (!ret) {
         ECerr(EC_F_NISTP256_PRE_COMP_NEW, ERR_R_MALLOC_FAILURE);
         return ret;
@@ -1867,7 +1867,7 @@ static void nistp256_pre_comp_clear_free(void *pre_)
     if (i &gt; 0)
         return;
 
-    OPENSSL_cleanse(pre, sizeof *pre);
+    OPENSSL_cleanse(pre, sizeof(*pre));
     OPENSSL_free(pre);
 }
 
diff --git a/crypto/ec/ecp_nistp521.c b/crypto/ec/ecp_nistp521.c
index a1dc994..4bc116d 100644
--- a/crypto/ec/ecp_nistp521.c
+++ b/crypto/ec/ecp_nistp521.c
@@ -185,9 +185,9 @@ static int BN_to_felem(felem out, const BIGNUM *bn)
     unsigned num_bytes;
 
     /* BN_bn2bin eats leading zeroes */
-    memset(b_out, 0, sizeof b_out);
+    memset(b_out, 0, sizeof(b_out));
     num_bytes = BN_num_bytes(bn);
-    if (num_bytes &gt; sizeof b_out) {
+    if (num_bytes &gt; sizeof(b_out)) {
         ECerr(EC_F_BN_TO_FELEM, EC_R_BIGNUM_OUT_OF_RANGE);
         return 0;
     }
@@ -206,8 +206,8 @@ static BIGNUM *felem_to_BN(BIGNUM *out, const felem in)
 {
     felem_bytearray b_in, b_out;
     felem_to_bin66(b_in, in);
-    flip_endian(b_out, b_in, sizeof b_out);
-    return BN_bin2bn(b_out, sizeof b_out, out);
+    flip_endian(b_out, b_in, sizeof(b_out));
+    return BN_bin2bn(b_out, sizeof(b_out), out);
 }
 
 /*-
diff --git a/crypto/ec/ecp_nistz256.c b/crypto/ec/ecp_nistz256.c
index 99b8d61..9a53a39 100644
--- a/crypto/ec/ecp_nistz256.c
+++ b/crypto/ec/ecp_nistz256.c
@@ -1504,7 +1504,7 @@ static void ecp_nistz256_pre_comp_clear_free(void *pre_)
                         32 * sizeof(unsigned char) * (1 &lt;&lt; pre-&gt;w) * 2 * 37);
         OPENSSL_free(pre-&gt;precomp_storage);
     }
-    OPENSSL_cleanse(pre, sizeof *pre);
+    OPENSSL_cleanse(pre, sizeof(*pre));
     OPENSSL_free(pre);
 }
 
diff --git a/crypto/ec/ecp_smpl.c b/crypto/ec/ecp_smpl.c
index 2b84821..e94a7d4 100644
--- a/crypto/ec/ecp_smpl.c
+++ b/crypto/ec/ecp_smpl.c
@@ -1270,7 +1270,7 @@ int ec_GFp_simple_points_make_affine(const EC_GROUP *group, size_t num,
     if (tmp == NULL || tmp_Z == NULL)
         goto err;
 
-    prod_Z = OPENSSL_malloc(num * sizeof prod_Z[0]);
+    prod_Z = OPENSSL_malloc(num * sizeof(prod_Z[0]));
     if (prod_Z == NULL)
         goto err;
     for (i = 0; i &lt; num; i++) {
diff --git a/crypto/ec/ectest.c b/crypto/ec/ectest.c
index 40a1f00..5e1ef50 100644
--- a/crypto/ec/ectest.c
+++ b/crypto/ec/ectest.c
@@ -469,7 +469,7 @@ static void prime_field_tests(void)
 
     len =
         EC_POINT_point2oct(group, Q, POINT_CONVERSION_COMPRESSED, buf,
-                           sizeof buf, ctx);
+                           sizeof(buf), ctx);
     if (len == 0)
         ABORT;
     if (!EC_POINT_oct2point(group, P, buf, len, ctx))
@@ -482,7 +482,7 @@ static void prime_field_tests(void)
 
     len =
         EC_POINT_point2oct(group, Q, POINT_CONVERSION_UNCOMPRESSED, buf,
-                           sizeof buf, ctx);
+                           sizeof(buf), ctx);
     if (len == 0)
         ABORT;
     if (!EC_POINT_oct2point(group, P, buf, len, ctx))
@@ -494,7 +494,7 @@ static void prime_field_tests(void)
         fprintf(stdout, &quot;%02X&quot;, buf[i]);
 
     len =
-        EC_POINT_point2oct(group, Q, POINT_CONVERSION_HYBRID, buf, sizeof buf,
+        EC_POINT_point2oct(group, Q, POINT_CONVERSION_HYBRID, buf, sizeof(buf),
                            ctx);
     if (len == 0)
         ABORT;
@@ -1206,7 +1206,7 @@ static void char2_field_tests(void)
 #  ifdef OPENSSL_EC_BIN_PT_COMP
     len =
         EC_POINT_point2oct(group, Q, POINT_CONVERSION_COMPRESSED, buf,
-                           sizeof buf, ctx);
+                           sizeof(buf), ctx);
     if (len == 0)
         ABORT;
     if (!EC_POINT_oct2point(group, P, buf, len, ctx))
@@ -1220,7 +1220,7 @@ static void char2_field_tests(void)
 
     len =
         EC_POINT_point2oct(group, Q, POINT_CONVERSION_UNCOMPRESSED, buf,
-                           sizeof buf, ctx);
+                           sizeof(buf), ctx);
     if (len == 0)
         ABORT;
     if (!EC_POINT_oct2point(group, P, buf, len, ctx))
@@ -1234,7 +1234,7 @@ static void char2_field_tests(void)
 /* Change test based on whether binary point compression is enabled or not. */
 #  ifdef OPENSSL_EC_BIN_PT_COMP
     len =
-        EC_POINT_point2oct(group, Q, POINT_CONVERSION_HYBRID, buf, sizeof buf,
+        EC_POINT_point2oct(group, Q, POINT_CONVERSION_HYBRID, buf, sizeof(buf),
                            ctx);
     if (len == 0)
         ABORT;
@@ -1844,7 +1844,7 @@ int main(int argc, char *argv[])
     CRYPTO_mem_ctrl(CRYPTO_MEM_CHECK_ON);
     ERR_load_crypto_strings();
 
-    RAND_seed(rnd_seed, sizeof rnd_seed); /* or BN_generate_prime may fail */
+    RAND_seed(rnd_seed, sizeof(rnd_seed)); /* or BN_generate_prime may fail */
 
     prime_field_tests();
     puts(&quot;&quot;);
diff --git a/crypto/ecdh/ecdhtest.c b/crypto/ecdh/ecdhtest.c
index 2fe2c66..3febf10 100644
--- a/crypto/ecdh/ecdhtest.c
+++ b/crypto/ecdh/ecdhtest.c
@@ -490,7 +490,7 @@ int main(int argc, char *argv[])
     CRYPTO_malloc_init();
 # endif
 
-    RAND_seed(rnd_seed, sizeof rnd_seed);
+    RAND_seed(rnd_seed, sizeof(rnd_seed));
 
     out = BIO_new(BIO_s_file());
     if (out == NULL)
diff --git a/crypto/engine/eng_cryptodev.c b/crypto/engine/eng_cryptodev.c
index af59471..7aae5ab 100644
--- a/crypto/engine/eng_cryptodev.c
+++ b/crypto/engine/eng_cryptodev.c
@@ -1133,7 +1133,7 @@ cryptodev_bn_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
         return (ret);
     }
 
-    memset(&amp;kop, 0, sizeof kop);
+    memset(&amp;kop, 0, sizeof(kop));
     kop.crk_op = CRK_MOD_EXP;
 
     /* inputs: a^p % m */
@@ -1184,7 +1184,7 @@ cryptodev_rsa_mod_exp(BIGNUM *r0, const BIGNUM *I, RSA *rsa, BN_CTX *ctx)
         return (0);
     }
 
-    memset(&amp;kop, 0, sizeof kop);
+    memset(&amp;kop, 0, sizeof(kop));
     kop.crk_op = CRK_MOD_EXP_CRT;
     /* inputs: rsa-&gt;p rsa-&gt;q I rsa-&gt;dmp1 rsa-&gt;dmq1 rsa-&gt;iqmp */
     if (bn2crparam(rsa-&gt;p, &amp;kop.crk_param[0]))
@@ -1287,7 +1287,7 @@ static DSA_SIG *cryptodev_dsa_do_sign(const unsigned char *dgst, int dlen,
         goto err;
     }
 
-    memset(&amp;kop, 0, sizeof kop);
+    memset(&amp;kop, 0, sizeof(kop));
     kop.crk_op = CRK_DSA_SIGN;
 
     /* inputs: dgst dsa-&gt;p dsa-&gt;q dsa-&gt;g dsa-&gt;priv_key */
@@ -1330,7 +1330,7 @@ cryptodev_dsa_verify(const unsigned char *dgst, int dlen,
     struct crypt_kop kop;
     int dsaret = 1;
 
-    memset(&amp;kop, 0, sizeof kop);
+    memset(&amp;kop, 0, sizeof(kop));
     kop.crk_op = CRK_DSA_VERIFY;
 
     /* inputs: dgst dsa-&gt;p dsa-&gt;q dsa-&gt;g dsa-&gt;pub_key sig-&gt;r sig-&gt;s */
@@ -1403,7 +1403,7 @@ cryptodev_dh_compute_key(unsigned char *key, const BIGNUM *pub_key, DH *dh)
 
     keylen = BN_num_bits(dh-&gt;p);
 
-    memset(&amp;kop, 0, sizeof kop);
+    memset(&amp;kop, 0, sizeof(kop));
     kop.crk_op = CRK_DH_COMPUTE_KEY;
 
     /* inputs: dh-&gt;priv_key pub_key dh-&gt;p key */
diff --git a/crypto/err/err.c b/crypto/err/err.c
index cfe0e80..e9ef215 100644
--- a/crypto/err/err.c
+++ b/crypto/err/err.c
@@ -602,8 +602,8 @@ static void build_SYS_str_reasons(void)
             char (*dest)[LEN_SYS_STR_REASON] = &amp;(strerror_tab[i - 1]);
             char *src = strerror(i);
             if (src != NULL) {
-                strncpy(*dest, src, sizeof *dest);
-                (*dest)[sizeof *dest - 1] = '\0';
+                strncpy(*dest, src, sizeof(*dest));
+                (*dest)[sizeof(*dest) - 1] = '\0';
                 str-&gt;string = *dest;
             }
         }
diff --git a/crypto/err/err_prn.c b/crypto/err/err_prn.c
index 6e352ef..25c808e 100644
--- a/crypto/err/err_prn.c
+++ b/crypto/err/err_prn.c
@@ -77,7 +77,7 @@ void ERR_print_errors_cb(int (*cb) (const char *str, size_t len, void *u),
     CRYPTO_THREADID_current(&amp;cur);
     es = CRYPTO_THREADID_hash(&amp;cur);
     while ((l = ERR_get_error_line_data(&amp;file, &amp;line, &amp;data, &amp;flags)) != 0) {
-        ERR_error_string_n(l, buf, sizeof buf);
+        ERR_error_string_n(l, buf, sizeof(buf));
         BIO_snprintf(buf2, sizeof(buf2), &quot;%lu:%s:%s:%d:%s\n&quot;, es, buf,
                      file, line, (flags &amp; ERR_TXT_STRING) ? data : &quot;&quot;);
         if (cb(buf2, strlen(buf2), u) &lt;= 0)
diff --git a/crypto/evp/digest.c b/crypto/evp/digest.c
index 4db1796..d4274c5 100644
--- a/crypto/evp/digest.c
+++ b/crypto/evp/digest.c
@@ -124,12 +124,12 @@
 
 void EVP_MD_CTX_init(EVP_MD_CTX *ctx)
 {
-    memset(ctx, '\0', sizeof *ctx);
+    memset(ctx, '\0', sizeof(*ctx));
 }
 
 EVP_MD_CTX *EVP_MD_CTX_create(void)
 {
-    EVP_MD_CTX *ctx = OPENSSL_malloc(sizeof *ctx);
+    EVP_MD_CTX *ctx = OPENSSL_malloc(sizeof(*ctx));
 
     if (ctx)
         EVP_MD_CTX_init(ctx);
@@ -316,7 +316,7 @@ int EVP_MD_CTX_copy_ex(EVP_MD_CTX *out, const EVP_MD_CTX *in)
     } else
         tmp_buf = NULL;
     EVP_MD_CTX_cleanup(out);
-    memcpy(out, in, sizeof *out);
+    memcpy(out, in, sizeof(*out));
 
     if (in-&gt;md_data &amp;&amp; out-&gt;digest-&gt;ctx_size) {
         if (tmp_buf)
@@ -402,7 +402,7 @@ int EVP_MD_CTX_cleanup(EVP_MD_CTX *ctx)
 #ifdef OPENSSL_FIPS
     FIPS_md_ctx_cleanup(ctx);
 #endif
-    memset(ctx, '\0', sizeof *ctx);
+    memset(ctx, '\0', sizeof(*ctx));
 
     return 1;
 }
diff --git a/crypto/evp/evp_enc.c b/crypto/evp/evp_enc.c
index be577ba..0c740d1 100644
--- a/crypto/evp/evp_enc.c
+++ b/crypto/evp/evp_enc.c
@@ -85,7 +85,7 @@ void EVP_CIPHER_CTX_init(EVP_CIPHER_CTX *ctx)
 
 EVP_CIPHER_CTX *EVP_CIPHER_CTX_new(void)
 {
-    EVP_CIPHER_CTX *ctx = OPENSSL_malloc(sizeof *ctx);
+    EVP_CIPHER_CTX *ctx = OPENSSL_malloc(sizeof(*ctx));
     if (ctx)
         EVP_CIPHER_CTX_init(ctx);
     return ctx;
@@ -402,7 +402,7 @@ int EVP_EncryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
     }
 
     b = ctx-&gt;cipher-&gt;block_size;
-    OPENSSL_assert(b &lt;= sizeof ctx-&gt;buf);
+    OPENSSL_assert(b &lt;= sizeof(ctx-&gt;buf));
     if (b == 1) {
         *outl = 0;
         return 1;
@@ -454,7 +454,7 @@ int EVP_DecryptUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl,
         return EVP_EncryptUpdate(ctx, out, outl, in, inl);
 
     b = ctx-&gt;cipher-&gt;block_size;
-    OPENSSL_assert(b &lt;= sizeof ctx-&gt;final);
+    OPENSSL_assert(b &lt;= sizeof(ctx-&gt;final));
 
     if (ctx-&gt;final_used) {
         memcpy(out, ctx-&gt;final, b);
@@ -520,7 +520,7 @@ int EVP_DecryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
             EVPerr(EVP_F_EVP_DECRYPTFINAL_EX, EVP_R_WRONG_FINAL_BLOCK_LENGTH);
             return (0);
         }
-        OPENSSL_assert(b &lt;= sizeof ctx-&gt;final);
+        OPENSSL_assert(b &lt;= sizeof(ctx-&gt;final));
 
         /*
          * The following assumes that the ciphertext has been authenticated.
@@ -651,7 +651,7 @@ int EVP_CIPHER_CTX_copy(EVP_CIPHER_CTX *out, const EVP_CIPHER_CTX *in)
 #endif
 
     EVP_CIPHER_CTX_cleanup(out);
-    memcpy(out, in, sizeof *out);
+    memcpy(out, in, sizeof(*out));
 
     if (in-&gt;cipher_data &amp;&amp; in-&gt;cipher-&gt;ctx_size) {
         out-&gt;cipher_data = OPENSSL_malloc(in-&gt;cipher-&gt;ctx_size);
diff --git a/crypto/evp/evp_pbe.c b/crypto/evp/evp_pbe.c
index 7934c95..5d2f04b 100644
--- a/crypto/evp/evp_pbe.c
+++ b/crypto/evp/evp_pbe.c
@@ -161,9 +161,9 @@ int EVP_PBE_CipherInit(ASN1_OBJECT *pbe_obj, const char *pass, int passlen,
         char obj_tmp[80];
         EVPerr(EVP_F_EVP_PBE_CIPHERINIT, EVP_R_UNKNOWN_PBE_ALGORITHM);
         if (!pbe_obj)
-            BUF_strlcpy(obj_tmp, &quot;NULL&quot;, sizeof obj_tmp);
+            BUF_strlcpy(obj_tmp, &quot;NULL&quot;, sizeof(obj_tmp));
         else
-            i2t_ASN1_OBJECT(obj_tmp, sizeof obj_tmp, pbe_obj);
+            i2t_ASN1_OBJECT(obj_tmp, sizeof(obj_tmp), pbe_obj);
         ERR_add_error_data(2, &quot;TYPE=&quot;, obj_tmp);
         return 0;
     }
diff --git a/crypto/evp/evp_test.c b/crypto/evp/evp_test.c
index 9879642..97a2083 100755
--- a/crypto/evp/evp_test.c
+++ b/crypto/evp/evp_test.c
@@ -506,7 +506,7 @@ int main(int argc, char **argv)
         int an = 0;
         int tn = 0;
 
-        if (!fgets((char *)line, sizeof line, f))
+        if (!fgets((char *)line, sizeof(line), f))
             break;
         if (line[0] == '#' || line[0] == '\n')
             continue;
diff --git a/crypto/evp/openbsd_hw.c b/crypto/evp/openbsd_hw.c
index 07decf2..24a358e 100644
--- a/crypto/evp/openbsd_hw.c
+++ b/crypto/evp/openbsd_hw.c
@@ -111,7 +111,7 @@ static int dev_crypto_init(session_op *ses)
         close(cryptodev_fd);
     }
     assert(ses);
-    memset(ses, '\0', sizeof *ses);
+    memset(ses, '\0', sizeof(*ses));
 
     return 1;
 }
@@ -164,7 +164,7 @@ static int dev_crypto_cipher(EVP_CIPHER_CTX *ctx, unsigned char *out,
     assert(CDATA(ctx));
     assert(!dev_failed);
 
-    memset(&amp;cryp, '\0', sizeof cryp);
+    memset(&amp;cryp, '\0', sizeof(cryp));
     cryp.ses = CDATA(ctx)-&gt;ses;
     cryp.op = ctx-&gt;encrypt ? COP_ENCRYPT : COP_DECRYPT;
     cryp.flags = 0;
@@ -329,7 +329,7 @@ static int do_digest(int ses, unsigned char *md, const void *data, int len)
         return 1;
     }
 
-    memset(&amp;cryp, '\0', sizeof cryp);
+    memset(&amp;cryp, '\0', sizeof(cryp));
     cryp.ses = ses;
     cryp.op = COP_ENCRYPT;      /* required to do the MAC rather than check
                                  * it */
diff --git a/crypto/evp/p5_crpt2.c b/crypto/evp/p5_crpt2.c
index f2ae1e5..46fefa9 100644
--- a/crypto/evp/p5_crpt2.c
+++ b/crypto/evp/p5_crpt2.c
@@ -262,7 +262,7 @@ int PKCS5_v2_PBKDF2_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass,
         goto err;
     }
     keylen = EVP_CIPHER_CTX_key_length(ctx);
-    OPENSSL_assert(keylen &lt;= sizeof key);
+    OPENSSL_assert(keylen &lt;= sizeof(key));
 
     /* Decode parameter */
 
diff --git a/crypto/hmac/hmac.c b/crypto/hmac/hmac.c
index 213504e..023ec45 100644
--- a/crypto/hmac/hmac.c
+++ b/crypto/hmac/hmac.c
@@ -234,7 +234,7 @@ void HMAC_CTX_cleanup(HMAC_CTX *ctx)
     EVP_MD_CTX_cleanup(&amp;ctx-&gt;i_ctx);
     EVP_MD_CTX_cleanup(&amp;ctx-&gt;o_ctx);
     EVP_MD_CTX_cleanup(&amp;ctx-&gt;md_ctx);
-    OPENSSL_cleanse(ctx, sizeof *ctx);
+    OPENSSL_cleanse(ctx, sizeof(*ctx));
 }
 
 unsigned char *HMAC(const EVP_MD *evp_md, const void *key, int key_len,
diff --git a/crypto/jpake/jpake.c b/crypto/jpake/jpake.c
index 2ba75f0..daf2722 100644
--- a/crypto/jpake/jpake.c
+++ b/crypto/jpake/jpake.c
@@ -108,14 +108,14 @@ static void JPAKE_CTX_release(JPAKE_CTX *ctx)
     OPENSSL_free(ctx-&gt;p.peer_name);
     OPENSSL_free(ctx-&gt;p.name);
 
-    memset(ctx, '\0', sizeof *ctx);
+    memset(ctx, '\0', sizeof(*ctx));
 }
 
 JPAKE_CTX *JPAKE_CTX_new(const char *name, const char *peer_name,
                          const BIGNUM *p, const BIGNUM *g, const BIGNUM *q,
                          const BIGNUM *secret)
 {
-    JPAKE_CTX *ctx = OPENSSL_malloc(sizeof *ctx);
+    JPAKE_CTX *ctx = OPENSSL_malloc(sizeof(*ctx));
     if (ctx == NULL)
         return NULL;
 
@@ -460,7 +460,7 @@ void JPAKE_STEP3A_init(JPAKE_STEP3A *s3a)
 int JPAKE_STEP3A_generate(JPAKE_STEP3A *send, JPAKE_CTX *ctx)
 {
     quickhashbn(send-&gt;hhk, ctx-&gt;key);
-    SHA1(send-&gt;hhk, sizeof send-&gt;hhk, send-&gt;hhk);
+    SHA1(send-&gt;hhk, sizeof(send-&gt;hhk), send-&gt;hhk);
 
     return 1;
 }
@@ -470,8 +470,8 @@ int JPAKE_STEP3A_process(JPAKE_CTX *ctx, const JPAKE_STEP3A *received)
     unsigned char hhk[SHA_DIGEST_LENGTH];
 
     quickhashbn(hhk, ctx-&gt;key);
-    SHA1(hhk, sizeof hhk, hhk);
-    if (memcmp(hhk, received-&gt;hhk, sizeof hhk)) {
+    SHA1(hhk, sizeof(hhk), hhk);
+    if (memcmp(hhk, received-&gt;hhk, sizeof(hhk))) {
         JPAKEerr(JPAKE_F_JPAKE_STEP3A_PROCESS,
                  JPAKE_R_HASH_OF_HASH_OF_KEY_MISMATCH);
         return 0;
@@ -499,7 +499,7 @@ int JPAKE_STEP3B_process(JPAKE_CTX *ctx, const JPAKE_STEP3B *received)
     unsigned char hk[SHA_DIGEST_LENGTH];
 
     quickhashbn(hk, ctx-&gt;key);
-    if (memcmp(hk, received-&gt;hk, sizeof hk)) {
+    if (memcmp(hk, received-&gt;hk, sizeof(hk))) {
         JPAKEerr(JPAKE_F_JPAKE_STEP3B_PROCESS, JPAKE_R_HASH_OF_KEY_MISMATCH);
         return 0;
     }
diff --git a/crypto/md2/md2_dgst.c b/crypto/md2/md2_dgst.c
index 7f5d9ba..44193e2 100644
--- a/crypto/md2/md2_dgst.c
+++ b/crypto/md2/md2_dgst.c
@@ -122,9 +122,9 @@ const char *MD2_options(void)
 fips_md_init(MD2)
 {
     c-&gt;num = 0;
-    memset(c-&gt;state, 0, sizeof c-&gt;state);
-    memset(c-&gt;cksm, 0, sizeof c-&gt;cksm);
-    memset(c-&gt;data, 0, sizeof c-&gt;data);
+    memset(c-&gt;state, 0, sizeof(c-&gt;state));
+    memset(c-&gt;cksm, 0, sizeof(c-&gt;cksm));
+    memset(c-&gt;data, 0, sizeof(c-&gt;data));
     return 1;
 }
 
diff --git a/crypto/md4/md4.c b/crypto/md4/md4.c
index c9fab66..a79997f 100644
--- a/crypto/md4/md4.c
+++ b/crypto/md4/md4.c
@@ -102,7 +102,7 @@ void do_fp(FILE *f)
     fd = fileno(f);
     MD4_Init(&amp;c);
     for (;;) {
-        i = read(fd, buf, sizeof buf);
+        i = read(fd, buf, sizeof(buf));
         if (i &lt;= 0)
             break;
         MD4_Update(&amp;c, buf, (unsigned long)i);
diff --git a/crypto/mem_dbg.c b/crypto/mem_dbg.c
index 8525ded..6b69b53 100644
--- a/crypto/mem_dbg.c
+++ b/crypto/mem_dbg.c
@@ -635,7 +635,7 @@ static void print_leak_doall_arg(const MEM *m, MEM_LEAK *l)
     struct tm *lcl = NULL;
     CRYPTO_THREADID ti;
 
-#define BUF_REMAIN (sizeof buf - (size_t)(bufp - buf))
+#define BUF_REMAIN (sizeof(buf) - (size_t)(bufp - buf))
 
     if (m-&gt;addr == (char *)l-&gt;bio)
         return;
@@ -679,7 +679,7 @@ static void print_leak_doall_arg(const MEM *m, MEM_LEAK *l)
 
         ami_cnt++;
         memset(buf, '&gt;', ami_cnt);
-        BIO_snprintf(buf + ami_cnt, sizeof buf - ami_cnt,
+        BIO_snprintf(buf + ami_cnt, sizeof(buf) - ami_cnt,
                      &quot; thread=%lu, file=%s, line=%d, info=\&quot;&quot;,
                      CRYPTO_THREADID_hash(&amp;amip-&gt;threadid), amip-&gt;file,
                      amip-&gt;line);
@@ -689,10 +689,10 @@ static void print_leak_doall_arg(const MEM *m, MEM_LEAK *l)
             memcpy(buf + buf_len, amip-&gt;info, 128 - buf_len - 3);
             buf_len = 128 - 3;
         } else {
-            BUF_strlcpy(buf + buf_len, amip-&gt;info, sizeof buf - buf_len);
+            BUF_strlcpy(buf + buf_len, amip-&gt;info, sizeof(buf) - buf_len);
             buf_len = strlen(buf);
         }
-        BIO_snprintf(buf + buf_len, sizeof buf - buf_len, &quot;\&quot;\n&quot;);
+        BIO_snprintf(buf + buf_len, sizeof(buf) - buf_len, &quot;\&quot;\n&quot;);
 
         BIO_puts(l-&gt;bio, buf);
 
diff --git a/crypto/o_time.c b/crypto/o_time.c
index 04d805d..d6828a6 100755
--- a/crypto/o_time.c
+++ b/crypto/o_time.c
@@ -141,14 +141,14 @@ struct tm *OPENSSL_gmtime(const time_t *timer, struct tm *result)
         pitem-&gt;ileb_64$w_mbo = 1;
         pitem-&gt;ileb_64$w_code = LNM$_STRING;
         pitem-&gt;ileb_64$l_mbmo = -1;
-        pitem-&gt;ileb_64$q_length = sizeof (logvalue);
+        pitem-&gt;ileb_64$q_length = sizeof(logvalue);
         pitem-&gt;ileb_64$pq_bufaddr = logvalue;
         pitem-&gt;ileb_64$pq_retlen_addr = (unsigned __int64 *) &reslen;
         pitem++;
         /* Last item of the item list is null terminated */
         pitem-&gt;ileb_64$q_length = pitem-&gt;ileb_64$w_code = 0;
 # else
-        pitem-&gt;ile3$w_length = sizeof (logvalue);
+        pitem-&gt;ile3$w_length = sizeof(logvalue);
         pitem-&gt;ile3$w_code = LNM$_STRING;
         pitem-&gt;ile3$ps_bufaddr = logvalue;
         pitem-&gt;ile3$ps_retlen_addr = (unsigned short int *) &reslen;
diff --git a/crypto/objects/o_names.c b/crypto/objects/o_names.c
index f106905..b8bdc5c 100644
--- a/crypto/objects/o_names.c
+++ b/crypto/objects/o_names.c
@@ -312,13 +312,13 @@ void OBJ_NAME_do_all_sorted(int type,
 
     d.type = type;
     d.names =
-        OPENSSL_malloc(lh_OBJ_NAME_num_items(names_lh) * sizeof *d.names);
+        OPENSSL_malloc(lh_OBJ_NAME_num_items(names_lh) * sizeof(*d.names));
     /* Really should return an error if !d.names...but its a void function! */
     if (d.names) {
         d.n = 0;
         OBJ_NAME_do_all(type, do_all_sorted_fn, &amp;d);
 
-        qsort((void *)d.names, d.n, sizeof *d.names, do_all_sorted_cmp);
+        qsort((void *)d.names, d.n, sizeof(*d.names), do_all_sorted_cmp);
 
         for (n = 0; n &lt; d.n; ++n)
             fn(d.names[n], arg);
diff --git a/crypto/objects/obj_dat.c b/crypto/objects/obj_dat.c
index 8dae9e8..c43d86e 100644
--- a/crypto/objects/obj_dat.c
+++ b/crypto/objects/obj_dat.c
@@ -591,7 +591,7 @@ int OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no_name)
             n += i;
             OPENSSL_free(bndec);
         } else {
-            BIO_snprintf(tbuf, sizeof tbuf, &quot;.%lu&quot;, l);
+            BIO_snprintf(tbuf, sizeof(tbuf), &quot;.%lu&quot;, l);
             i = strlen(tbuf);
             if (buf &amp;&amp; (buf_len &gt; 0)) {
                 BUF_strlcpy(buf, tbuf, buf_len);
diff --git a/crypto/pem/pem_info.c b/crypto/pem/pem_info.c
index 4d736a1..0994020 100644
--- a/crypto/pem/pem_info.c
+++ b/crypto/pem/pem_info.c
@@ -354,7 +354,7 @@ int PEM_X509_INFO_write_bio(BIO *bp, X509_INFO *xi, EVP_CIPHER *enc,
 
             /* create the right magic header stuff */
             OPENSSL_assert(strlen(objstr) + 23 + 2 * enc-&gt;iv_len + 13 &lt;=
-                           sizeof buf);
+                           sizeof(buf));
             buf[0] = '\0';
             PEM_proc_type(buf, PEM_TYPE_ENCRYPTED);
             PEM_dek_info(buf, objstr, enc-&gt;iv_len, (char *)iv);
diff --git a/crypto/pem/pem_lib.c b/crypto/pem/pem_lib.c
index 865976b..4d5f053 100644
--- a/crypto/pem/pem_lib.c
+++ b/crypto/pem/pem_lib.c
@@ -406,7 +406,7 @@ int PEM_ASN1_write_bio(i2d_of_void *i2d, const char *name, BIO *bp,
             OPENSSL_cleanse(buf, PEM_BUFSIZE);
 
         OPENSSL_assert(strlen(objstr) + 23 + 2 * enc-&gt;iv_len + 13 &lt;=
-                       sizeof buf);
+                       sizeof(buf));
 
         buf[0] = '\0';
         PEM_proc_type(buf, PEM_TYPE_ENCRYPTED);
diff --git a/crypto/rand/md_rand.c b/crypto/rand/md_rand.c
index 29e465b..a7af9f9 100644
--- a/crypto/rand/md_rand.c
+++ b/crypto/rand/md_rand.c
@@ -238,7 +238,7 @@ static void ssleay_rand_add(const void *buf, int num, double add)
     md_c[0] = md_count[0];
     md_c[1] = md_count[1];
 
-    memcpy(local_md, md, sizeof md);
+    memcpy(local_md, md, sizeof(md));
 
     /* state_index &lt;= state_num &lt;= STATE_SIZE */
     state_index += num;
@@ -454,7 +454,7 @@ int ssleay_rand_bytes(unsigned char *buf, int num, int pseudo, int lock)
     st_num = state_num;
     md_c[0] = md_count[0];
     md_c[1] = md_count[1];
-    memcpy(local_md, md, sizeof md);
+    memcpy(local_md, md, sizeof(md));
 
     state_index += num_ceil;
     if (state_index &gt; state_num)
@@ -480,7 +480,7 @@ int ssleay_rand_bytes(unsigned char *buf, int num, int pseudo, int lock)
            goto err;
 #ifndef GETPID_IS_MEANINGLESS
         if (curr_pid) {         /* just in the first iteration to save time */
-            if (!MD_Update(&amp;m, (unsigned char *)&amp;curr_pid, sizeof curr_pid))
+            if (!MD_Update(&amp;m, (unsigned char *)&amp;curr_pid, sizeof(curr_pid)))
                 goto err;
             curr_pid = 0;
         }
diff --git a/crypto/rand/rand_egd.c b/crypto/rand/rand_egd.c
index 737aebf..66fb14c 100644
--- a/crypto/rand/rand_egd.c
+++ b/crypto/rand/rand_egd.c
@@ -148,7 +148,7 @@ int RAND_query_egd_bytes(const char *path, unsigned char *buf, int bytes)
     addr.sun_family = AF_UNIX;
     if (strlen(path) &gt;= sizeof(addr.sun_path))
         return (-1);
-    BUF_strlcpy(addr.sun_path, path, sizeof addr.sun_path);
+    BUF_strlcpy(addr.sun_path, path, sizeof(addr.sun_path));
     len = offsetof(struct sockaddr_un, sun_path) + strlen(path);
     fd = socket(AF_UNIX, SOCK_STREAM, 0);
     if (fd == -1)
diff --git a/crypto/rand/rand_unix.c b/crypto/rand/rand_unix.c
index 6c5b65d..097e409 100644
--- a/crypto/rand/rand_unix.c
+++ b/crypto/rand/rand_unix.c
@@ -181,15 +181,15 @@ int RAND_poll(void)
      */
 
     curr_gid = getgid();
-    RAND_add(&amp;curr_gid, sizeof curr_gid, 1);
+    RAND_add(&amp;curr_gid, sizeof(curr_gid), 1);
     curr_gid = 0;
 
     curr_pid = getpid();
-    RAND_add(&amp;curr_pid, sizeof curr_pid, 1);
+    RAND_add(&amp;curr_pid, sizeof(curr_pid), 1);
     curr_pid = 0;
 
     curr_uid = getuid();
-    RAND_add(&amp;curr_uid, sizeof curr_uid, 1);
+    RAND_add(&amp;curr_uid, sizeof(curr_uid), 1);
     curr_uid = 0;
 
     for (i = 0; i &lt; (ENTROPY_NEEDED * 4); i++) {
@@ -217,7 +217,7 @@ int RAND_poll(void)
 
         /* take 8 bits */
         v = (unsigned char)(ts.tv_nsec % 256);
-        RAND_add(&amp;v, sizeof v, 1);
+        RAND_add(&amp;v, sizeof(v), 1);
         v = 0;
     }
     return 1;
@@ -402,7 +402,7 @@ int RAND_poll(void)
 
 #  if defined(DEVRANDOM) || defined(DEVRANDOM_EGD)
     if (n &gt; 0) {
-        RAND_add(tmpbuf, sizeof tmpbuf, (double)n);
+        RAND_add(tmpbuf, sizeof(tmpbuf), (double)n);
         OPENSSL_cleanse(tmpbuf, n);
     }
 #  endif
diff --git a/crypto/rsa/rsa_crpt.c b/crypto/rsa/rsa_crpt.c
index 5c416b5..68f2981 100644
--- a/crypto/rsa/rsa_crpt.c
+++ b/crypto/rsa/rsa_crpt.c
@@ -219,7 +219,7 @@ BN_BLINDING *RSA_setup_blinding(RSA *rsa, BN_CTX *in_ctx)
          * if PRNG is not properly seeded, resort to secret exponent as
          * unpredictable seed
          */
-        RAND_add(rsa-&gt;d-&gt;d, rsa-&gt;d-&gt;dmax * sizeof rsa-&gt;d-&gt;d[0], 0.0);
+        RAND_add(rsa-&gt;d-&gt;d, rsa-&gt;d-&gt;dmax * sizeof(rsa-&gt;d-&gt;d[0]), 0.0);
     }
 
     if (!(rsa-&gt;flags &amp; RSA_FLAG_NO_CONSTTIME)) {
diff --git a/crypto/rsa/rsa_pss.c b/crypto/rsa/rsa_pss.c
index 2c3fd73..3c9250b 100644
--- a/crypto/rsa/rsa_pss.c
+++ b/crypto/rsa/rsa_pss.c
@@ -157,7 +157,7 @@ int RSA_verify_PKCS1_PSS_mgf1(RSA *rsa, const unsigned char *mHash,
         goto err;
     }
     if (!EVP_DigestInit_ex(&amp;ctx, Hash, NULL)
-        || !EVP_DigestUpdate(&amp;ctx, zeroes, sizeof zeroes)
+        || !EVP_DigestUpdate(&amp;ctx, zeroes, sizeof(zeroes))
         || !EVP_DigestUpdate(&amp;ctx, mHash, hLen))
         goto err;
     if (maskedDBLen - i) {
@@ -252,7 +252,7 @@ int RSA_padding_add_PKCS1_PSS_mgf1(RSA *rsa, unsigned char *EM,
     H = EM + maskedDBLen;
     EVP_MD_CTX_init(&amp;ctx);
     if (!EVP_DigestInit_ex(&amp;ctx, Hash, NULL)
-        || !EVP_DigestUpdate(&amp;ctx, zeroes, sizeof zeroes)
+        || !EVP_DigestUpdate(&amp;ctx, zeroes, sizeof(zeroes))
         || !EVP_DigestUpdate(&amp;ctx, mHash, hLen))
         goto err;
     if (sLen &amp;&amp; !EVP_DigestUpdate(&amp;ctx, salt, sLen))
diff --git a/crypto/rsa/rsa_test.c b/crypto/rsa/rsa_test.c
index 85c7440..ed78f01 100644
--- a/crypto/rsa/rsa_test.c
+++ b/crypto/rsa/rsa_test.c
@@ -226,7 +226,7 @@ int main(int argc, char *argv[])
     CRYPTO_dbg_set_options(V_CRYPTO_MDEBUG_ALL);
     CRYPTO_mem_ctrl(CRYPTO_MEM_CHECK_ON);
 
-    RAND_seed(rnd_seed, sizeof rnd_seed); /* or OAEP may fail */
+    RAND_seed(rnd_seed, sizeof(rnd_seed)); /* or OAEP may fail */
 
     plen = sizeof(ptext_ex) - 1;
 
diff --git a/crypto/srp/srp_grps.h b/crypto/srp/srp_grps.h
index 31312de..f76652c 100644
--- a/crypto/srp/srp_grps.h
+++ b/crypto/srp/srp_grps.h
@@ -21,8 +21,8 @@ static BN_ULONG bn_group_1024_value[] = {
 
 static BIGNUM bn_group_1024 = {
     bn_group_1024_value,
-    (sizeof bn_group_1024_value) / sizeof(BN_ULONG),
-    (sizeof bn_group_1024_value) / sizeof(BN_ULONG),
+    (sizeof(bn_group_1024_value)) / sizeof(BN_ULONG),
+    (sizeof(bn_group_1024_value)) / sizeof(BN_ULONG),
     0,
     BN_FLG_STATIC_DATA
 };
@@ -56,8 +56,8 @@ static BN_ULONG bn_group_1536_value[] = {
 
 static BIGNUM bn_group_1536 = {
     bn_group_1536_value,
-    (sizeof bn_group_1536_value) / sizeof(BN_ULONG),
-    (sizeof bn_group_1536_value) / sizeof(BN_ULONG),
+    (sizeof(bn_group_1536_value)) / sizeof(BN_ULONG),
+    (sizeof(bn_group_1536_value)) / sizeof(BN_ULONG),
     0,
     BN_FLG_STATIC_DATA
 };
@@ -99,8 +99,8 @@ static BN_ULONG bn_group_2048_value[] = {
 
 static BIGNUM bn_group_2048 = {
     bn_group_2048_value,
-    (sizeof bn_group_2048_value) / sizeof(BN_ULONG),
-    (sizeof bn_group_2048_value) / sizeof(BN_ULONG),
+    (sizeof(bn_group_2048_value)) / sizeof(BN_ULONG),
+    (sizeof(bn_group_2048_value)) / sizeof(BN_ULONG),
     0,
     BN_FLG_STATIC_DATA
 };
@@ -158,8 +158,8 @@ static BN_ULONG bn_group_3072_value[] = {
 
 static BIGNUM bn_group_3072 = {
     bn_group_3072_value,
-    (sizeof bn_group_3072_value) / sizeof(BN_ULONG),
-    (sizeof bn_group_3072_value) / sizeof(BN_ULONG),
+    (sizeof(bn_group_3072_value)) / sizeof(BN_ULONG),
+    (sizeof(bn_group_3072_value)) / sizeof(BN_ULONG),
     0,
     BN_FLG_STATIC_DATA
 };
@@ -233,8 +233,8 @@ static BN_ULONG bn_group_4096_value[] = {
 
 static BIGNUM bn_group_4096 = {
     bn_group_4096_value,
-    (sizeof bn_group_4096_value) / sizeof(BN_ULONG),
-    (sizeof bn_group_4096_value) / sizeof(BN_ULONG),
+    (sizeof(bn_group_4096_value)) / sizeof(BN_ULONG),
+    (sizeof(bn_group_4096_value)) / sizeof(BN_ULONG),
     0,
     BN_FLG_STATIC_DATA
 };
@@ -340,8 +340,8 @@ static BN_ULONG bn_group_6144_value[] = {
 
 static BIGNUM bn_group_6144 = {
     bn_group_6144_value,
-    (sizeof bn_group_6144_value) / sizeof(BN_ULONG),
-    (sizeof bn_group_6144_value) / sizeof(BN_ULONG),
+    (sizeof(bn_group_6144_value)) / sizeof(BN_ULONG),
+    (sizeof(bn_group_6144_value)) / sizeof(BN_ULONG),
     0,
     BN_FLG_STATIC_DATA
 };
@@ -479,8 +479,8 @@ static BN_ULONG bn_group_8192_value[] = {
 
 static BIGNUM bn_group_8192 = {
     bn_group_8192_value,
-    (sizeof bn_group_8192_value) / sizeof(BN_ULONG),
-    (sizeof bn_group_8192_value) / sizeof(BN_ULONG),
+    (sizeof(bn_group_8192_value)) / sizeof(BN_ULONG),
+    (sizeof(bn_group_8192_value)) / sizeof(BN_ULONG),
     0,
     BN_FLG_STATIC_DATA
 };
diff --git a/crypto/threads/mttest.c b/crypto/threads/mttest.c
index dbff4a6..b26ed28 100644
--- a/crypto/threads/mttest.c
+++ b/crypto/threads/mttest.c
@@ -190,7 +190,7 @@ int main(int argc, char *argv[])
     char *ccert = TEST_CLIENT_CERT;
     const SSL_METHOD *ssl_method = SSLv23_method();
 
-    RAND_seed(rnd_seed, sizeof rnd_seed);
+    RAND_seed(rnd_seed, sizeof(rnd_seed));
 
     if (bio_err == NULL)
         bio_err = BIO_new_fd(2, BIO_NOCLOSE);
diff --git a/crypto/ui/ui_openssl.c b/crypto/ui/ui_openssl.c
index 17d14f5..8a43590 100644
--- a/crypto/ui/ui_openssl.c
+++ b/crypto/ui/ui_openssl.c
@@ -614,7 +614,7 @@ static void pushsig(void)
 # ifdef SIGACTION
     struct sigaction sa;
 
-    memset(&amp;sa, 0, sizeof sa);
+    memset(&amp;sa, 0, sizeof(sa));
     sa.sa_handler = recsig;
 # endif
 
diff --git a/crypto/x509/x509_txt.c b/crypto/x509/x509_txt.c
index 35db095..594031e 100644
--- a/crypto/x509/x509_txt.c
+++ b/crypto/x509/x509_txt.c
@@ -212,7 +212,7 @@ const char *X509_verify_cert_error_string(long n)
         return (&quot;proxy subject name violation&quot;);
 
     default:
-        BIO_snprintf(buf, sizeof buf, &quot;error number %ld&quot;, n);
+        BIO_snprintf(buf, sizeof(buf), &quot;error number %ld&quot;, n);
         return (buf);
     }
 }
diff --git a/crypto/x509/x509_vpm.c b/crypto/x509/x509_vpm.c
index 1ac15a8..7d68a4a 100644
--- a/crypto/x509/x509_vpm.c
+++ b/crypto/x509/x509_vpm.c
@@ -173,7 +173,7 @@ X509_VERIFY_PARAM *X509_VERIFY_PARAM_new(void)
     X509_VERIFY_PARAM *param;
     X509_VERIFY_PARAM_ID *paramid;
 
-    param = OPENSSL_malloc(sizeof *param);
+    param = OPENSSL_malloc(sizeof(*param));
     if (!param)
         return NULL;
     memset(param, 0, sizeof(*param));
diff --git a/crypto/x509v3/v3_alt.c b/crypto/x509v3/v3_alt.c
index a0351fa..d4d024c 100644
--- a/crypto/x509v3/v3_alt.c
+++ b/crypto/x509v3/v3_alt.c
@@ -157,12 +157,12 @@ STACK_OF(CONF_VALUE) *i2v_GENERAL_NAME(X509V3_EXT_METHOD *method,
     case GEN_IPADD:
         p = gen-&gt;d.ip-&gt;data;
         if (gen-&gt;d.ip-&gt;length == 4)
-            BIO_snprintf(oline, sizeof oline,
+            BIO_snprintf(oline, sizeof(oline),
                          &quot;%d.%d.%d.%d&quot;, p[0], p[1], p[2], p[3]);
         else if (gen-&gt;d.ip-&gt;length == 16) {
             oline[0] = 0;
             for (i = 0; i &lt; 8; i++) {
-                BIO_snprintf(htmp, sizeof htmp, &quot;%X&quot;, p[0] &lt;&lt; 8 | p[1]);
+                BIO_snprintf(htmp, sizeof(htmp), &quot;%X&quot;, p[0] &lt;&lt; 8 | p[1]);
                 p += 2;
                 strcat(oline, htmp);
                 if (i != 7)
diff --git a/crypto/x509v3/v3_info.c b/crypto/x509v3/v3_info.c
index 7064c72..0c64b0a 100644
--- a/crypto/x509v3/v3_info.c
+++ b/crypto/x509v3/v3_info.c
@@ -126,7 +126,7 @@ static STACK_OF(CONF_VALUE) *i2v_AUTHORITY_INFO_ACCESS(
             goto err;
         tret = tmp;
         vtmp = sk_CONF_VALUE_value(tret, i);
-        i2t_ASN1_OBJECT(objtmp, sizeof objtmp, desc-&gt;method);
+        i2t_ASN1_OBJECT(objtmp, sizeof(objtmp), desc-&gt;method);
         nlen = strlen(objtmp) + strlen(vtmp-&gt;name) + 5;
         ntmp = OPENSSL_malloc(nlen);
         if (ntmp == NULL)
diff --git a/demos/easy_tls/easy-tls.c b/demos/easy_tls/easy-tls.c
index 45063a4..717b81a 100644
--- a/demos/easy_tls/easy-tls.c
+++ b/demos/easy_tls/easy-tls.c
@@ -295,9 +295,9 @@ static void tls_errflush(void *apparg)
     if (errbuf_i == 0)
         return;
 
-    assert(errbuf_i &lt; sizeof errbuf);
+    assert(errbuf_i &lt; sizeof(errbuf));
     assert(errbuf[errbuf_i] == 0);
-    if (errbuf_i == sizeof errbuf - 1) {
+    if (errbuf_i == sizeof(errbuf) - 1) {
         /* make sure we have a newline, even if string has been truncated */
         errbuf[errbuf_i - 1] = '\n';
     }
@@ -316,11 +316,11 @@ static void tls_errprintf(int flush, void *apparg, const char *fmt, ...)
     va_list args;
     int r;
 
-    if (errbuf_i &lt; sizeof errbuf - 1) {
+    if (errbuf_i &lt; sizeof(errbuf) - 1) {
         size_t n;
 
         va_start(args, fmt);
-        n = (sizeof errbuf) - errbuf_i;
+        n = (sizeof(errbuf)) - errbuf_i;
         r = vsnprintf(errbuf + errbuf_i, n, fmt, args);
         va_end(args);
         if (r &gt;= n)
@@ -328,10 +328,10 @@ static void tls_errprintf(int flush, void *apparg, const char *fmt, ...)
         if (r &gt;= 0) {
             errbuf_i += r;
         } else {
-            errbuf_i = sizeof errbuf - 1;
+            errbuf_i = sizeof(errbuf) - 1;
             errbuf[errbuf_i] = '\0';
         }
-        assert(errbuf_i &lt; sizeof errbuf);
+        assert(errbuf_i &lt; sizeof(errbuf));
         assert(errbuf[errbuf_i] == 0);
     }
 #ifndef TLS_CUMULATE_ERRORS
@@ -369,11 +369,11 @@ static char *tls_openssl_errors(const char *app_prefix_1,
         default_text = &quot;?&quot; &quot;?&quot; &quot;?&quot;;
 
     while ((err = ERR_get_error_line_data(&amp;file, &amp;line, &amp;data, &amp;flags)) != 0) {
-        if (reasons_i &lt; sizeof reasons) {
+        if (reasons_i &lt; sizeof(reasons)) {
             size_t n;
             int r;
 
-            n = (sizeof reasons) - reasons_i;
+            n = (sizeof(reasons)) - reasons_i;
             r = snprintf(reasons + reasons_i, n, &quot;%s%s&quot;,
                          (reasons_i &gt; 0 ? &quot;, &quot; : &quot;&quot;),
                          ERR_reason_error_string(err));
@@ -382,9 +382,9 @@ static char *tls_openssl_errors(const char *app_prefix_1,
             if (r &gt;= 0) {
                 reasons_i += r;
             } else {
-                reasons_i = sizeof reasons;
+                reasons_i = sizeof(reasons);
             }
-            assert(reasons_i &lt;= sizeof reasons);
+            assert(reasons_i &lt;= sizeof(reasons));
         }
 
         errstring = ERR_error_string(err, NULL);
@@ -397,7 +397,7 @@ static char *tls_openssl_errors(const char *app_prefix_1,
 
     if (!printed_something) {
         assert(reasons_i == 0);
-        snprintf(reasons, sizeof reasons, &quot;%s&quot;, default_text);
+        snprintf(reasons, sizeof(reasons), &quot;%s&quot;, default_text);
         tls_errprintf(0, apparg, &quot;OpenSSL error%s%s: %s\n&quot;, app_prefix_1,
                       app_prefix_2, default_text);
     }
@@ -442,7 +442,7 @@ static void tls_rand_seed_uniquely(void)
     data.time = time(NULL);
     data.stack = (void *)&data;
 
-    RAND_seed((const void *)&amp;data, sizeof data);
+    RAND_seed((const void *)&amp;data, sizeof(data));
 }
 
 void tls_rand_seed(void)
@@ -465,7 +465,7 @@ void tls_rand_seed(void)
     data.gid = getgid();
     data.egid = getegid();
 
-    RAND_seed((const void *)&amp;data, sizeof data);
+    RAND_seed((const void *)&amp;data, sizeof(data));
     tls_rand_seed_uniquely();
 }
 
@@ -543,7 +543,7 @@ tls_get_x509_subject_name_oneline(X509 *cert,
     name = X509_get_subject_name(cert); /* does not increment any reference
                                          * counter */
 
-    assert(sizeof namestring-&gt;str &gt;= 4); /* &quot;?&quot; or &quot;...&quot;, plus 0 */
+    assert(sizeof(namestring-&gt;str) &gt;= 4); /* &quot;?&quot; or &quot;...&quot;, plus 0 */
 
     if (name == NULL) {
         namestring-&gt;str[0] = '?';
@@ -551,12 +551,12 @@ tls_get_x509_subject_name_oneline(X509 *cert,
     } else {
         size_t len;
 
-        X509_NAME_oneline(name, namestring-&gt;str, sizeof namestring-&gt;str);
+        X509_NAME_oneline(name, namestring-&gt;str, sizeof(namestring-&gt;str));
         len = strlen(namestring-&gt;str);
         assert(namestring-&gt;str[len] == 0);
-        assert(len &lt; sizeof namestring-&gt;str);
+        assert(len &lt; sizeof(namestring-&gt;str));
 
-        if (len + 1 == sizeof namestring-&gt;str) {
+        if (len + 1 == sizeof(namestring-&gt;str)) {
             /*
              * (Probably something was cut off.) Does not really work --
              * X509_NAME_oneline truncates after name components, we cannot
@@ -617,7 +617,7 @@ void tls_set_dhe1024(int i, void *apparg)
 
     tls_init(apparg);
     if (i &gt;= 0) {
-        i %= sizeof seed / sizeof seed[0];
+        i %= sizeof(seed) / sizeof(seed[0]);
         assert(strlen(seed[i]) == 20);
         memcpy(seedbuf, seed[i], 20);
         dsaparams =
@@ -711,7 +711,7 @@ SSL_CTX *tls_create_ctx(struct tls_create_ctx_args a, void *apparg)
     if ((a.ca_file != NULL) || (a.verify_depth &gt; 0)) {
         context_num++;
         r = SSL_CTX_set_session_id_context(ret, (const void *)&amp;context_num,
-                                           (unsigned int)sizeof context_num);
+                                           (unsigned int)sizeof(context_num));
         if (!r)
             goto err;
 
@@ -762,7 +762,7 @@ SSL_CTX *tls_create_ctx(struct tls_create_ctx_args a, void *apparg)
         if (tls_dhe1024 == NULL) {
             int i;
 
-            if (RAND_bytes((unsigned char *)&amp;i, sizeof i) &lt;= 0)
+            if (RAND_bytes((unsigned char *)&amp;i, sizeof(i)) &lt;= 0)
                 goto err_return;
             /*
              * make sure that i is non-negative -- pick one of the provided
@@ -955,11 +955,11 @@ static void write_info(SSL *ssl, int *info_fd)
             /* should not happen, but make sure */
             *strchr(peer.str, '\n') = '\0';
         }
-        r = snprintf(infobuf, sizeof infobuf, &quot;%c:%s\n%s\n&quot;, v_ok,
+        r = snprintf(infobuf, sizeof(infobuf), &quot;%c:%s\n%s\n&quot;, v_ok,
                      X509_verify_cert_error_string(v), peer.str);
         DEBUG_MSG2(&quot;snprintf&quot;, r);
-        if (r == -1 || r &gt;= sizeof infobuf)
-            r = sizeof infobuf - 1;
+        if (r == -1 || r &gt;= sizeof(infobuf))
+            r = sizeof(infobuf) - 1;
         write(*info_fd, infobuf, r);
         close(*info_fd);
         *info_fd = -1;
@@ -1082,7 +1082,7 @@ tls_proxy(int clear_fd, int tls_fd, int info_fd, SSL_CTX *ctx, int client_p)
 
         if (!closed) {
             if (clear_to_tls.offset + clear_to_tls.len &lt;
-                sizeof clear_to_tls.buf) {
+                sizeof(clear_to_tls.buf)) {
                 r = read_attempt(clear_fd, &amp;clear_to_tls, &amp;clear_read_select,
                                  &amp;closed, &amp;progress);
                 if (r != 0)
@@ -1096,7 +1096,7 @@ tls_proxy(int clear_fd, int tls_fd, int info_fd, SSL_CTX *ctx, int client_p)
 
         if (!closed &amp;&amp; !in_handshake) {
             if (tls_to_clear.offset + tls_to_clear.len &lt;
-                sizeof tls_to_clear.buf) {
+                sizeof(tls_to_clear.buf)) {
                 r = tls_read_attempt(ssl, &amp;tls_to_clear, &amp;tls_write_select,
                                      &amp;tls_read_select, &amp;closed, &amp;progress,
                                      &amp;err_pref_1);
@@ -1231,13 +1231,13 @@ tls_read_attempt(SSL *ssl, struct tunnelbuf *buf, int *write_select,
 
     DEBUG_MSG(&quot;tls_read_attempt&quot;);
     total = buf-&gt;offset + buf-&gt;len;
-    assert(total &lt; sizeof buf-&gt;buf);
-    n = SSL_read(ssl, buf-&gt;buf + total, (sizeof buf-&gt;buf) - total);
+    assert(total &lt; sizeof(buf-&gt;buf));
+    n = SSL_read(ssl, buf-&gt;buf + total, sizeof(buf-&gt;buf) - total);
     DEBUG_MSG2(&quot;SSL_read&quot;, n);
     r = tls_get_error(ssl, n, write_select, read_select, closed, progress);
     if (n &gt; 0) {
         buf-&gt;len += n;
-        assert(buf-&gt;offset + buf-&gt;len &lt;= sizeof buf-&gt;buf);
+        assert(buf-&gt;offset + buf-&gt;len &lt;= sizeof(buf-&gt;buf));
     }
     if (r == -1)
         *err_pref = &quot; during SSL_read&quot;;
@@ -1297,13 +1297,13 @@ read_attempt(int fd, struct tunnelbuf *buf, int *select, int *closed,
 
     DEBUG_MSG(&quot;read_attempt&quot;);
     total = buf-&gt;offset + buf-&gt;len;
-    assert(total &lt; sizeof buf-&gt;buf);
-    n = read(fd, buf-&gt;buf + total, (sizeof buf-&gt;buf) - total);
+    assert(total &lt; sizeof(buf-&gt;buf));
+    n = read(fd, buf-&gt;buf + total, sizeof(buf-&gt;buf) - total);
     DEBUG_MSG2(&quot;read&quot;, n);
     r = get_error(n, select, closed, progress);
     if (n &gt; 0) {
         buf-&gt;len += n;
-        assert(buf-&gt;offset + buf-&gt;len &lt;= sizeof buf-&gt;buf);
+        assert(buf-&gt;offset + buf-&gt;len &lt;= sizeof(buf-&gt;buf));
     }
     if (r == -1)
         tls_errprintf(1, tls_child_apparg, &quot;read error: %s\n&quot;,
diff --git a/demos/easy_tls/test.c b/demos/easy_tls/test.c
index d1dd53d..3877370 100644
--- a/demos/easy_tls/test.c
+++ b/demos/easy_tls/test.c
@@ -78,7 +78,7 @@ int main(int argc, char *argv[])
 
     if (client_p) {
         struct sockaddr_in addr;
-        size_t addr_len = sizeof addr;
+        size_t addr_len = sizeof(addr);
 
         addr.sin_family = AF_INET;
         assert(argc &gt; 1);
@@ -101,7 +101,7 @@ int main(int argc, char *argv[])
         {
             int i = 1;
 
-            r = setsockopt(s, SOL_SOCKET, SO_REUSEADDR, (void *)&amp;i, sizeof i);
+            r = setsockopt(s, SOL_SOCKET, SO_REUSEADDR, (void *)&amp;i, sizeof(i));
             if (r == -1) {
                 perror(&quot;setsockopt&quot;);
                 exit(1);
@@ -110,7 +110,7 @@ int main(int argc, char *argv[])
 
         {
             struct sockaddr_in addr;
-            size_t addr_len = sizeof addr;
+            size_t addr_len = sizeof(addr);
 
             if (argc &gt; 1)
                 sscanf(argv[1], &quot;%d&quot;, &amp;port);
@@ -158,7 +158,7 @@ int main(int argc, char *argv[])
     setvbuf(conn_in, NULL, _IOLBF, 256);
     setvbuf(conn_out, NULL, _IOLBF, 256);
 
-    while (fgets(buf, sizeof buf, stdin) != NULL) {
+    while (fgets(buf, sizeof(buf), stdin) != NULL) {
         if (buf[0] == 'W') {
             fprintf(conn_out, &quot;%.*s\r\n&quot;, (int)(strlen(buf + 1) - 1),
                     buf + 1);
@@ -174,7 +174,7 @@ int main(int argc, char *argv[])
 
             sscanf(buf + 1, &quot;%d&quot;, &amp;lines);
             do {
-                if (fgets(buf, sizeof buf, conn_in) == NULL) {
+                if (fgets(buf, sizeof(buf), conn_in) == NULL) {
                     if (ferror(conn_in)) {
                         fprintf(stderr, &quot;ERROR\n&quot;);
                         exit(1);
@@ -225,7 +225,7 @@ int main(int argc, char *argv[])
                 exit(1);
             }
 
-            r = read(infofd, infobuf, sizeof infobuf - 1);
+            r = read(infofd, infobuf, sizeof(infobuf) - 1);
             if (r &gt; 0) {
                 const char *info = infobuf;
                 const char *eol;
diff --git a/demos/engines/zencod/hw_zencod.c b/demos/engines/zencod/hw_zencod.c
index daf0aef..dfbe7d1 100644
--- a/demos/engines/zencod/hw_zencod.c
+++ b/demos/engines/zencod/hw_zencod.c
@@ -1289,10 +1289,10 @@ static const EVP_MD engine_sha1_md = {
     engine_md_cleanup,          /* dev_crypto_sha_cleanup */
     EVP_PKEY_RSA_method,
     SHA_CBLOCK,
-    /* sizeof ( EVP_MD * ) + sizeof ( SHA_CTX ) */
+    /* sizeof(EVP_MD *) + sizeof(SHA_CTX) */
     sizeof(ZEN_MD_DATA)
         /*
-         * sizeof ( MD_CTX_DATA ) The message digest data structure ...
+         * sizeof(MD_CTX_DATA) The message digest data structure ...
          */
 };
 
@@ -1315,10 +1315,10 @@ static const EVP_MD engine_md5_md = {
     engine_md_cleanup,          /* dev_crypto_md5_cleanup */
     EVP_PKEY_RSA_method,
     MD5_CBLOCK,
-    /* sizeof ( EVP_MD * ) + sizeof ( MD5_CTX ) */
+    /* sizeof(EVP_MD *) + sizeof(MD5_CTX) */
     sizeof(ZEN_MD_DATA)
         /*
-         * sizeof ( MD_CTX_DATA ) The message digest data structure ...
+         * sizeof(MD_CTX_DATA) The message digest data structure ...
          */
 };
 
diff --git a/demos/spkigen.c b/demos/spkigen.c
index c272a8c..9ccb34a 100644
--- a/demos/spkigen.c
+++ b/demos/spkigen.c
@@ -73,7 +73,7 @@ char *argv[];
     fprintf(stderr, &quot;please enter challenge string:&quot;);
     fflush(stderr);
     buf[0] = '\0';
-    fgets(buf, sizeof buf, stdin);
+    fgets(buf, sizeof(buf), stdin);
     i = strlen(buf);
     if (i &gt; 0)
         buf[--i] = '\0';
diff --git a/demos/ssl/serv.cpp b/demos/ssl/serv.cpp
index b142c75..bccce2b 100644
--- a/demos/ssl/serv.cpp
+++ b/demos/ssl/serv.cpp
@@ -87,7 +87,7 @@ void main ()
   sa_serv.sin_port        = htons (1111);          /* Server Port number */
   
   err = bind(listen_sd, (struct sockaddr*) &amp;sa_serv,
-	     sizeof (sa_serv));                   CHK_ERR(err, &quot;bind&quot;);
+	     sizeof(sa_serv));                    CHK_ERR(err, &quot;bind&quot;);
 	     
   /* Receive a TCP connection. */
 	     
diff --git a/demos/state_machine/state_machine.c b/demos/state_machine/state_machine.c
index 2ec196a..aca9cd8 100644
--- a/demos/state_machine/state_machine.c
+++ b/demos/state_machine/state_machine.c
@@ -106,7 +106,7 @@ void SSLStateMachine_print_error(SSLStateMachine * pMachine,
     while ((l = ERR_get_error())) {
         char buf[1024];
 
-        ERR_error_string_n(l, buf, sizeof buf);
+        ERR_error_string_n(l, buf, sizeof(buf));
         fprintf(stderr, &quot;Error %lx: %s\n&quot;, l, buf);
     }
 }
@@ -114,7 +114,7 @@ void SSLStateMachine_print_error(SSLStateMachine * pMachine,
 SSLStateMachine *SSLStateMachine_new(const char *szCertificateFile,
                                      const char *szKeyFile)
 {
-    SSLStateMachine *pMachine = malloc(sizeof *pMachine);
+    SSLStateMachine *pMachine = malloc(sizeof(*pMachine));
     int n;
 
     die_unless(pMachine);
@@ -252,15 +252,15 @@ int OpenSocket(int nPort)
     }
 
     if (setsockopt
-        (nSocket, SOL_SOCKET, SO_REUSEADDR, (char *)&amp;one, sizeof one) &lt; 0) {
+        (nSocket, SOL_SOCKET, SO_REUSEADDR, (char *)&amp;one, sizeof(one)) &lt; 0) {
         perror(&quot;setsockopt&quot;);
         exit(2);
     }
 
-    memset(&amp;saServer, 0, sizeof saServer);
+    memset(&amp;saServer, 0, sizeof(saServer));
     saServer.sin_family = AF_INET;
     saServer.sin_port = htons(nPort);
-    nSize = sizeof saServer;
+    nSize = sizeof(saServer);
     if (bind(nSocket, (struct sockaddr *)&amp;saServer, nSize) &lt; 0) {
         perror(&quot;bind&quot;);
         exit(3);
@@ -271,7 +271,7 @@ int OpenSocket(int nPort)
         exit(4);
     }
 
-    nLen = sizeof saClient;
+    nLen = sizeof(saClient);
     nFD = accept(nSocket, (struct sockaddr *)&amp;saClient, &amp;nLen);
     if (nFD &lt; 0) {
         perror(&quot;accept&quot;);
@@ -343,7 +343,7 @@ int main(int argc, char **argv)
 
         /* Socket is ready for input */
         if (FD_ISSET(nFD, &amp;rfds)) {
-            n = read(nFD, buf, sizeof buf);
+            n = read(nFD, buf, sizeof(buf));
             if (n == 0) {
                 fprintf(stderr, &quot;Got EOF on socket\n&quot;);
                 exit(0);
@@ -360,7 +360,7 @@ int main(int argc, char **argv)
             nrbuf = 0;
 
             n = SSLStateMachine_read_extract(pMachine, buf + 1,
-                                             sizeof buf - 1);
+                                             sizeof(buf) - 1);
             if (n &lt; 0) {
                 SSLStateMachine_print_error(pMachine, &quot;read extract failed&quot;);
                 break;
@@ -382,7 +382,7 @@ int main(int argc, char **argv)
         if (FD_ISSET(nFD, &amp;wfds)) {
             int w;
 
-            n = SSLStateMachine_write_extract(pMachine, buf, sizeof buf);
+            n = SSLStateMachine_write_extract(pMachine, buf, sizeof(buf));
             assert(n &gt; 0);
 
             w = write(nFD, buf, n);
@@ -392,7 +392,7 @@ int main(int argc, char **argv)
 
         /* Stdin is ready for input */
         if (FD_ISSET(0, &amp;rfds)) {
-            n = read(0, buf, sizeof buf);
+            n = read(0, buf, sizeof(buf));
             if (n == 0) {
                 fprintf(stderr, &quot;Got EOF on stdin\n&quot;);
                 exit(0);
diff --git a/engines/e_atalla.c b/engines/e_atalla.c
index 6a324e6..7d136ff 100644
--- a/engines/e_atalla.c
+++ b/engines/e_atalla.c
@@ -494,7 +494,7 @@ static int atalla_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
         goto err;
     }
     /* Prepare the key-data */
-    memset(&amp;keydata, 0, sizeof keydata);
+    memset(&amp;keydata, 0, sizeof(keydata));
     numbytes = BN_num_bytes(m);
     memset(exponent-&gt;d, 0, numbytes);
     memset(modulus-&gt;d, 0, numbytes);
diff --git a/ssl/d1_lib.c b/ssl/d1_lib.c
index debd4fd..95b5033 100644
--- a/ssl/d1_lib.c
+++ b/ssl/d1_lib.c
@@ -126,9 +126,9 @@ int dtls1_new(SSL *s)
 
     if (!ssl3_new(s))
         return (0);
-    if ((d1 = OPENSSL_malloc(sizeof *d1)) == NULL)
+    if ((d1 = OPENSSL_malloc(sizeof(*d1))) == NULL)
         return (0);
-    memset(d1, 0, sizeof *d1);
+    memset(d1, 0, sizeof(*d1));
 
     /* d1-&gt;handshake_epoch=0; */
 
diff --git a/ssl/d1_pkt.c b/ssl/d1_pkt.c
index 10586fe..f196b8f 100644
--- a/ssl/d1_pkt.c
+++ b/ssl/d1_pkt.c
@@ -1061,7 +1061,7 @@ int dtls1_read_bytes(SSL *s, int type, unsigned char *buf, int len, int peek)
         unsigned int *dest_len = NULL;
 
         if (rr-&gt;type == SSL3_RT_HANDSHAKE) {
-            dest_maxlen = sizeof s-&gt;d1-&gt;handshake_fragment;
+            dest_maxlen = sizeof(s-&gt;d1-&gt;handshake_fragment);
             dest = s-&gt;d1-&gt;handshake_fragment;
             dest_len = &amp;s-&gt;d1-&gt;handshake_fragment_len;
         } else if (rr-&gt;type == SSL3_RT_ALERT) {
@@ -1286,7 +1286,7 @@ int dtls1_read_bytes(SSL *s, int type, unsigned char *buf, int len, int peek)
             s-&gt;s3-&gt;fatal_alert = alert_descr;
             SSLerr(SSL_F_DTLS1_READ_BYTES,
                    SSL_AD_REASON_OFFSET + alert_descr);
-            BIO_snprintf(tmp, sizeof tmp, &quot;%d&quot;, alert_descr);
+            BIO_snprintf(tmp, sizeof(tmp), &quot;%d&quot;, alert_descr);
             ERR_add_error_data(2, &quot;SSL alert number &quot;, tmp);
             s-&gt;shutdown |= SSL_RECEIVED_SHUTDOWN;
             SSL_CTX_remove_session(s-&gt;session_ctx, s-&gt;session);
diff --git a/ssl/kssl.c b/ssl/kssl.c
index f2839bd..54e960d 100644
--- a/ssl/kssl.c
+++ b/ssl/kssl.c
@@ -2082,7 +2082,7 @@ krb5_error_code kssl_check_authent(
     }
 # endif
     enc = kssl_map_enc(enctype);
-    memset(iv, 0, sizeof iv);   /* per RFC 1510 */
+    memset(iv, 0, sizeof(iv));   /* per RFC 1510 */
 
     if (enc == NULL) {
         /*
diff --git a/ssl/s23_srvr.c b/ssl/s23_srvr.c
index d3f6db1..d2017e7 100644
--- a/ssl/s23_srvr.c
+++ b/ssl/s23_srvr.c
@@ -268,8 +268,8 @@ int ssl23_get_client_hello(SSL *s)
         if (!ssl3_setup_buffers(s))
             goto err;
 
-        n = ssl23_read_bytes(s, sizeof buf_space);
-        if (n != sizeof buf_space)
+        n = ssl23_read_bytes(s, sizeof(buf_space));
+        if (n != sizeof(buf_space))
             return (n);         /* n == -1 || n == 0 */
 
         p = s-&gt;packet;
diff --git a/ssl/s2_clnt.c b/ssl/s2_clnt.c
index 20de1a8..3a8345b 100644
--- a/ssl/s2_clnt.c
+++ b/ssl/s2_clnt.c
@@ -523,7 +523,7 @@ static int get_server_hello(SSL *s)
     }
 
     s-&gt;s2-&gt;conn_id_length = s-&gt;s2-&gt;tmp.conn_id_length;
-    if (s-&gt;s2-&gt;conn_id_length &gt; sizeof s-&gt;s2-&gt;conn_id) {
+    if (s-&gt;s2-&gt;conn_id_length &gt; sizeof(s-&gt;s2-&gt;conn_id)) {
         ssl2_return_error(s, SSL2_PE_UNDEFINED_ERROR);
         SSLerr(SSL_F_GET_SERVER_HELLO, SSL_R_SSL2_CONNECTION_ID_TOO_LONG);
         return -1;
@@ -708,7 +708,7 @@ static int client_finished(SSL *s)
     if (s-&gt;state == SSL2_ST_SEND_CLIENT_FINISHED_A) {
         p = (unsigned char *)s-&gt;init_buf-&gt;data;
         *(p++) = SSL2_MT_CLIENT_FINISHED;
-        if (s-&gt;s2-&gt;conn_id_length &gt; sizeof s-&gt;s2-&gt;conn_id) {
+        if (s-&gt;s2-&gt;conn_id_length &gt; sizeof(s-&gt;s2-&gt;conn_id)) {
             SSLerr(SSL_F_CLIENT_FINISHED, ERR_R_INTERNAL_ERROR);
             return -1;
         }
@@ -981,7 +981,7 @@ static int get_server_finished(SSL *s)
     } else {
         if (!(s-&gt;options &amp; SSL_OP_MICROSOFT_SESS_ID_BUG)) {
             if ((s-&gt;session-&gt;session_id_length &gt;
-                 sizeof s-&gt;session-&gt;session_id)
+                 sizeof(s-&gt;session-&gt;session_id))
                 || (0 !=
                     memcmp(buf + 1, s-&gt;session-&gt;session_id,
                            (unsigned int)s-&gt;session-&gt;session_id_length))) {
diff --git a/ssl/s2_enc.c b/ssl/s2_enc.c
index 23eef72..0115d20 100644
--- a/ssl/s2_enc.c
+++ b/ssl/s2_enc.c
@@ -99,7 +99,7 @@ int ssl2_enc_init(SSL *s, int client)
 
     num = c-&gt;key_len;
     s-&gt;s2-&gt;key_material_length = num * 2;
-    OPENSSL_assert(s-&gt;s2-&gt;key_material_length &lt;= sizeof s-&gt;s2-&gt;key_material);
+    OPENSSL_assert(s-&gt;s2-&gt;key_material_length &lt;= sizeof(s-&gt;s2-&gt;key_material));
 
     if (ssl2_generate_key_material(s) &lt;= 0)
         return 0;
diff --git a/ssl/s2_lib.c b/ssl/s2_lib.c
index cc13603..f03fe69 100644
--- a/ssl/s2_lib.c
+++ b/ssl/s2_lib.c
@@ -326,9 +326,9 @@ int ssl2_new(SSL *s)
 {
     SSL2_STATE *s2;
 
-    if ((s2 = OPENSSL_malloc(sizeof *s2)) == NULL)
+    if ((s2 = OPENSSL_malloc(sizeof(*s2))) == NULL)
         goto err;
-    memset(s2, 0, sizeof *s2);
+    memset(s2, 0, sizeof(*s2));
 
 # if SSL2_MAX_RECORD_LENGTH_3_BYTE_HEADER + 3 &gt; SSL2_MAX_RECORD_LENGTH_2_BYTE_HEADER + 2
 #  error &quot;assertion failed&quot;
@@ -371,7 +371,7 @@ void ssl2_free(SSL *s)
         OPENSSL_free(s2-&gt;rbuf);
     if (s2-&gt;wbuf != NULL)
         OPENSSL_free(s2-&gt;wbuf);
-    OPENSSL_cleanse(s2, sizeof *s2);
+    OPENSSL_cleanse(s2, sizeof(*s2));
     OPENSSL_free(s2);
     s-&gt;s2 = NULL;
 }
@@ -386,7 +386,7 @@ void ssl2_clear(SSL *s)
     rbuf = s2-&gt;rbuf;
     wbuf = s2-&gt;wbuf;
 
-    memset(s2, 0, sizeof *s2);
+    memset(s2, 0, sizeof(*s2));
 
     s2-&gt;rbuf = rbuf;
     s2-&gt;wbuf = wbuf;
diff --git a/ssl/s2_srvr.c b/ssl/s2_srvr.c
index d3b243c..c301611 100644
--- a/ssl/s2_srvr.c
+++ b/ssl/s2_srvr.c
@@ -724,7 +724,7 @@ static int get_client_hello(SSL *s)
     p += s-&gt;s2-&gt;tmp.session_id_length;
 
     /* challenge */
-    if (s-&gt;s2-&gt;challenge_length &gt; sizeof s-&gt;s2-&gt;challenge) {
+    if (s-&gt;s2-&gt;challenge_length &gt; sizeof(s-&gt;s2-&gt;challenge)) {
         ssl2_return_error(s, SSL2_PE_UNDEFINED_ERROR);
         SSLerr(SSL_F_GET_CLIENT_HELLO, ERR_R_INTERNAL_ERROR);
         return -1;
@@ -872,7 +872,7 @@ static int get_client_finished(SSL *s)
     }
 
     /* SSL2_ST_GET_CLIENT_FINISHED_B */
-    if (s-&gt;s2-&gt;conn_id_length &gt; sizeof s-&gt;s2-&gt;conn_id) {
+    if (s-&gt;s2-&gt;conn_id_length &gt; sizeof(s-&gt;s2-&gt;conn_id)) {
         ssl2_return_error(s, SSL2_PE_UNDEFINED_ERROR);
         SSLerr(SSL_F_GET_CLIENT_FINISHED, ERR_R_INTERNAL_ERROR);
         return -1;
@@ -903,7 +903,7 @@ static int server_verify(SSL *s)
     if (s-&gt;state == SSL2_ST_SEND_SERVER_VERIFY_A) {
         p = (unsigned char *)s-&gt;init_buf-&gt;data;
         *(p++) = SSL2_MT_SERVER_VERIFY;
-        if (s-&gt;s2-&gt;challenge_length &gt; sizeof s-&gt;s2-&gt;challenge) {
+        if (s-&gt;s2-&gt;challenge_length &gt; sizeof(s-&gt;s2-&gt;challenge)) {
             SSLerr(SSL_F_SERVER_VERIFY, ERR_R_INTERNAL_ERROR);
             return -1;
         }
@@ -925,7 +925,7 @@ static int server_finish(SSL *s)
         p = (unsigned char *)s-&gt;init_buf-&gt;data;
         *(p++) = SSL2_MT_SERVER_FINISHED;
 
-        if (s-&gt;session-&gt;session_id_length &gt; sizeof s-&gt;session-&gt;session_id) {
+        if (s-&gt;session-&gt;session_id_length &gt; sizeof(s-&gt;session-&gt;session_id)) {
             SSLerr(SSL_F_SERVER_FINISH, ERR_R_INTERNAL_ERROR);
             return -1;
         }
diff --git a/ssl/s3_clnt.c b/ssl/s3_clnt.c
index 5b8b2da..bd0929d 100644
--- a/ssl/s3_clnt.c
+++ b/ssl/s3_clnt.c
@@ -984,7 +984,7 @@ int ssl3_get_server_hello(SSL *s)
     /* get the session-id */
     j = *(p++);
 
-    if ((j &gt; sizeof s-&gt;session-&gt;session_id) || (j &gt; SSL3_SESSION_ID_SIZE)) {
+    if ((j &gt; sizeof(s-&gt;session-&gt;session_id)) || (j &gt; SSL3_SESSION_ID_SIZE)) {
         al = SSL_AD_ILLEGAL_PARAMETER;
         SSLerr(SSL_F_SSL3_GET_SERVER_HELLO, SSL_R_SSL3_SESSION_ID_TOO_LONG);
         goto f_err;
@@ -2561,16 +2561,16 @@ int ssl3_send_client_key_exchange(SSL *s)
 
             tmp_buf[0] = s-&gt;client_version &gt;&gt; 8;
             tmp_buf[1] = s-&gt;client_version &amp; 0xff;
-            if (RAND_bytes(&amp;(tmp_buf[2]), sizeof tmp_buf - 2) &lt;= 0)
+            if (RAND_bytes(&amp;(tmp_buf[2]), sizeof(tmp_buf) - 2) &lt;= 0)
                 goto err;
 
-            s-&gt;session-&gt;master_key_length = sizeof tmp_buf;
+            s-&gt;session-&gt;master_key_length = sizeof(tmp_buf);
 
             q = p;
             /* Fix buf for TLS and beyond */
             if (s-&gt;version &gt; SSL3_VERSION)
                 p += 2;
-            n = RSA_public_encrypt(sizeof tmp_buf,
+            n = RSA_public_encrypt(sizeof(tmp_buf),
                                    tmp_buf, p, rsa, RSA_PKCS1_PADDING);
 # ifdef PKCS1_CHECK
             if (s-&gt;options &amp; SSL_OP_PKCS1_CHECK_1)
@@ -2595,8 +2595,8 @@ int ssl3_send_client_key_exchange(SSL *s)
                                                             s-&gt;
                                                             session-&gt;master_key,
                                                             tmp_buf,
-                                                            sizeof tmp_buf);
-            OPENSSL_cleanse(tmp_buf, sizeof tmp_buf);
+                                                            sizeof(tmp_buf));
+            OPENSSL_cleanse(tmp_buf, sizeof(tmp_buf));
         }
 #endif
 #ifndef OPENSSL_NO_KRB5
@@ -2688,7 +2688,7 @@ int ssl3_send_client_key_exchange(SSL *s)
 
             tmp_buf[0] = s-&gt;client_version &gt;&gt; 8;
             tmp_buf[1] = s-&gt;client_version &amp; 0xff;
-            if (RAND_bytes(&amp;(tmp_buf[2]), sizeof tmp_buf - 2) &lt;= 0)
+            if (RAND_bytes(&amp;(tmp_buf[2]), sizeof(tmp_buf) - 2) &lt;= 0)
                 goto err;
 
             /*-
@@ -2699,13 +2699,13 @@ int ssl3_send_client_key_exchange(SSL *s)
              *      EVP_EncryptInit_ex(&amp;ciph_ctx,NULL, key,iv);
              */
 
-            memset(iv, 0, sizeof iv); /* per RFC 1510 */
+            memset(iv, 0, sizeof(iv)); /* per RFC 1510 */
             EVP_EncryptInit_ex(&amp;ciph_ctx, enc, NULL, kssl_ctx-&gt;key, iv);
             EVP_EncryptUpdate(&amp;ciph_ctx, epms, &amp;outl, tmp_buf,
-                              sizeof tmp_buf);
+                              sizeof(tmp_buf));
             EVP_EncryptFinal_ex(&amp;ciph_ctx, &amp;(epms[outl]), &amp;padl);
             outl += padl;
-            if (outl &gt; (int)sizeof epms) {
+            if (outl &gt; (int)sizeof(epms)) {
                 SSLerr(SSL_F_SSL3_SEND_CLIENT_KEY_EXCHANGE,
                        ERR_R_INTERNAL_ERROR);
                 goto err;
@@ -2723,9 +2723,9 @@ int ssl3_send_client_key_exchange(SSL *s)
                                                             s-&gt;
                                                             session-&gt;master_key,
                                                             tmp_buf,
-                                                            sizeof tmp_buf);
+                                                            sizeof(tmp_buf));
 
-            OPENSSL_cleanse(tmp_buf, sizeof tmp_buf);
+            OPENSSL_cleanse(tmp_buf, sizeof(tmp_buf));
             OPENSSL_cleanse(epms, outl);
         }
 #endif
diff --git a/ssl/s3_lib.c b/ssl/s3_lib.c
index 1014a3f..7e27dae 100644
--- a/ssl/s3_lib.c
+++ b/ssl/s3_lib.c
@@ -3018,9 +3018,9 @@ int ssl3_new(SSL *s)
 {
     SSL3_STATE *s3;
 
-    if ((s3 = OPENSSL_malloc(sizeof *s3)) == NULL)
+    if ((s3 = OPENSSL_malloc(sizeof(*s3))) == NULL)
         goto err;
-    memset(s3, 0, sizeof *s3);
+    memset(s3, 0, sizeof(*s3));
     memset(s3-&gt;rrec.seq_num, 0, sizeof(s3-&gt;rrec.seq_num));
     memset(s3-&gt;wrec.seq_num, 0, sizeof(s3-&gt;wrec.seq_num));
 
@@ -3078,7 +3078,7 @@ void ssl3_free(SSL *s)
 #ifndef OPENSSL_NO_SRP
     SSL_SRP_CTX_free(s);
 #endif
-    OPENSSL_cleanse(s-&gt;s3, sizeof *s-&gt;s3);
+    OPENSSL_cleanse(s-&gt;s3, sizeof(*s-&gt;s3));
     OPENSSL_free(s-&gt;s3);
     s-&gt;s3 = NULL;
 }
@@ -3142,7 +3142,7 @@ void ssl3_clear(SSL *s)
         s-&gt;s3-&gt;alpn_selected = NULL;
     }
 #endif
-    memset(s-&gt;s3, 0, sizeof *s-&gt;s3);
+    memset(s-&gt;s3, 0, sizeof(*s-&gt;s3));
     s-&gt;s3-&gt;rbuf.buf = rp;
     s-&gt;s3-&gt;wbuf.buf = wp;
     s-&gt;s3-&gt;rbuf.len = rlen;
diff --git a/ssl/s3_pkt.c b/ssl/s3_pkt.c
index b914568..b2373dc 100644
--- a/ssl/s3_pkt.c
+++ b/ssl/s3_pkt.c
@@ -1314,11 +1314,11 @@ int ssl3_read_bytes(SSL *s, int type, unsigned char *buf, int len, int peek)
         unsigned int *dest_len = NULL;
 
         if (rr-&gt;type == SSL3_RT_HANDSHAKE) {
-            dest_maxlen = sizeof s-&gt;s3-&gt;handshake_fragment;
+            dest_maxlen = sizeof(s-&gt;s3-&gt;handshake_fragment);
             dest = s-&gt;s3-&gt;handshake_fragment;
             dest_len = &amp;s-&gt;s3-&gt;handshake_fragment_len;
         } else if (rr-&gt;type == SSL3_RT_ALERT) {
-            dest_maxlen = sizeof s-&gt;s3-&gt;alert_fragment;
+            dest_maxlen = sizeof(s-&gt;s3-&gt;alert_fragment);
             dest = s-&gt;s3-&gt;alert_fragment;
             dest_len = &amp;s-&gt;s3-&gt;alert_fragment_len;
         }
@@ -1498,7 +1498,7 @@ int ssl3_read_bytes(SSL *s, int type, unsigned char *buf, int len, int peek)
             s-&gt;rwstate = SSL_NOTHING;
             s-&gt;s3-&gt;fatal_alert = alert_descr;
             SSLerr(SSL_F_SSL3_READ_BYTES, SSL_AD_REASON_OFFSET + alert_descr);
-            BIO_snprintf(tmp, sizeof tmp, &quot;%d&quot;, alert_descr);
+            BIO_snprintf(tmp, sizeof(tmp), &quot;%d&quot;, alert_descr);
             ERR_add_error_data(2, &quot;SSL alert number &quot;, tmp);
             s-&gt;shutdown |= SSL_RECEIVED_SHUTDOWN;
             SSL_CTX_remove_session(s-&gt;session_ctx, s-&gt;session);
diff --git a/ssl/s3_srvr.c b/ssl/s3_srvr.c
index 0fb4845..96d973c 100644
--- a/ssl/s3_srvr.c
+++ b/ssl/s3_srvr.c
@@ -2510,7 +2510,7 @@ int ssl3_get_client_key_exchange(SSL *s)
         /*
          * Note that the length is checked again below, ** after decryption
          */
-        if (enc_pms.length &gt; sizeof pms) {
+        if (enc_pms.length &gt; sizeof(pms)) {
             SSLerr(SSL_F_SSL3_GET_CLIENT_KEY_EXCHANGE,
                    SSL_R_DATA_LENGTH_TOO_LONG);
             goto err;
@@ -2563,7 +2563,7 @@ int ssl3_get_client_key_exchange(SSL *s)
         if (enc == NULL)
             goto err;
 
-        memset(iv, 0, sizeof iv); /* per RFC 1510 */
+        memset(iv, 0, sizeof(iv)); /* per RFC 1510 */
 
         if (!EVP_DecryptInit_ex(&amp;ciph_ctx, enc, NULL, kssl_ctx-&gt;key, iv)) {
             SSLerr(SSL_F_SSL3_GET_CLIENT_KEY_EXCHANGE,
diff --git a/ssl/ssl_cert.c b/ssl/ssl_cert.c
index 155728d..363d2b2 100644
--- a/ssl/ssl_cert.c
+++ b/ssl/ssl_cert.c
@@ -636,13 +636,13 @@ SESS_CERT *ssl_sess_cert_new(void)
 {
     SESS_CERT *ret;
 
-    ret = OPENSSL_malloc(sizeof *ret);
+    ret = OPENSSL_malloc(sizeof(*ret));
     if (ret == NULL) {
         SSLerr(SSL_F_SSL_SESS_CERT_NEW, ERR_R_MALLOC_FAILURE);
         return NULL;
     }
 
-    memset(ret, 0, sizeof *ret);
+    memset(ret, 0, sizeof(*ret));
     ret-&gt;peer_key = &amp;(ret-&gt;peer_pkeys[SSL_PKEY_RSA_ENC]);
     ret-&gt;references = 1;
 
@@ -1018,15 +1018,15 @@ int SSL_add_dir_cert_subjects_to_stack(STACK_OF(X509_NAME) *stack,
         char buf[1024];
         int r;
 
-        if (strlen(dir) + strlen(filename) + 2 &gt; sizeof buf) {
+        if (strlen(dir) + strlen(filename) + 2 &gt; sizeof(buf)) {
             SSLerr(SSL_F_SSL_ADD_DIR_CERT_SUBJECTS_TO_STACK,
                    SSL_R_PATH_TOO_LONG);
             goto err;
         }
 #ifdef OPENSSL_SYS_VMS
-        r = BIO_snprintf(buf, sizeof buf, &quot;%s%s&quot;, dir, filename);
+        r = BIO_snprintf(buf, sizeof(buf), &quot;%s%s&quot;, dir, filename);
 #else
-        r = BIO_snprintf(buf, sizeof buf, &quot;%s/%s&quot;, dir, filename);
+        r = BIO_snprintf(buf, sizeof(buf), &quot;%s/%s&quot;, dir, filename);
 #endif
         if (r &lt;= 0 || r &gt;= (int)sizeof(buf))
             goto err;
diff --git a/ssl/ssl_lib.c b/ssl/ssl_lib.c
index 3539f4b..3a6c1b1 100644
--- a/ssl/ssl_lib.c
+++ b/ssl/ssl_lib.c
@@ -343,7 +343,7 @@ SSL *SSL_new(SSL_CTX *ctx)
     s-&gt;verify_depth = ctx-&gt;verify_depth;
 #endif
     s-&gt;sid_ctx_length = ctx-&gt;sid_ctx_length;
-    OPENSSL_assert(s-&gt;sid_ctx_length &lt;= sizeof s-&gt;sid_ctx);
+    OPENSSL_assert(s-&gt;sid_ctx_length &lt;= sizeof(s-&gt;sid_ctx));
     memcpy(&amp;s-&gt;sid_ctx, &amp;ctx-&gt;sid_ctx, sizeof(s-&gt;sid_ctx));
     s-&gt;verify_callback = ctx-&gt;default_verify_callback;
     s-&gt;generate_session_id = ctx-&gt;generate_session_id;
@@ -437,7 +437,7 @@ SSL *SSL_new(SSL_CTX *ctx)
 int SSL_CTX_set_session_id_context(SSL_CTX *ctx, const unsigned char *sid_ctx,
                                    unsigned int sid_ctx_len)
 {
-    if (sid_ctx_len &gt; sizeof ctx-&gt;sid_ctx) {
+    if (sid_ctx_len &gt; sizeof(ctx-&gt;sid_ctx)) {
         SSLerr(SSL_F_SSL_CTX_SET_SESSION_ID_CONTEXT,
                SSL_R_SSL_SESSION_ID_CONTEXT_TOO_LONG);
         return 0;
@@ -490,7 +490,7 @@ int SSL_has_matching_session_id(const SSL *ssl, const unsigned char *id,
      */
     SSL_SESSION r, *p;
 
-    if (id_len &gt; sizeof r.session_id)
+    if (id_len &gt; sizeof(r.session_id))
         return 0;
 
     r.ssl_version = ssl-&gt;version;
diff --git a/ssl/ssl_sess.c b/ssl/ssl_sess.c
index 23dd3e7..6a5ad53 100644
--- a/ssl/ssl_sess.c
+++ b/ssl/ssl_sess.c
@@ -529,7 +529,7 @@ int ssl_get_new_session(SSL *s, int session)
         ss-&gt;session_id_length = 0;
     }
 
-    if (s-&gt;sid_ctx_length &gt; sizeof ss-&gt;sid_ctx) {
+    if (s-&gt;sid_ctx_length &gt; sizeof(ss-&gt;sid_ctx)) {
         SSLerr(SSL_F_SSL_GET_NEW_SESSION, ERR_R_INTERNAL_ERROR);
         SSL_SESSION_free(ss);
         return 0;
@@ -870,9 +870,9 @@ void SSL_SESSION_free(SSL_SESSION *ss)
 
     CRYPTO_free_ex_data(CRYPTO_EX_INDEX_SSL_SESSION, ss, &amp;ss-&gt;ex_data);
 
-    OPENSSL_cleanse(ss-&gt;key_arg, sizeof ss-&gt;key_arg);
-    OPENSSL_cleanse(ss-&gt;master_key, sizeof ss-&gt;master_key);
-    OPENSSL_cleanse(ss-&gt;session_id, sizeof ss-&gt;session_id);
+    OPENSSL_cleanse(ss-&gt;key_arg, sizeof(ss-&gt;key_arg));
+    OPENSSL_cleanse(ss-&gt;master_key, sizeof(ss-&gt;master_key));
+    OPENSSL_cleanse(ss-&gt;session_id, sizeof(ss-&gt;session_id));
     if (ss-&gt;sess_cert != NULL)
         ssl_sess_cert_free(ss-&gt;sess_cert);
     if (ss-&gt;peer != NULL)
diff --git a/ssl/ssltest.c b/ssl/ssltest.c
index f6a8f19..b861e49 100644
--- a/ssl/ssltest.c
+++ b/ssl/ssltest.c
@@ -1102,7 +1102,7 @@ int main(int argc, char *argv[])
     }
     CRYPTO_mem_ctrl(CRYPTO_MEM_CHECK_ON);
 
-    RAND_seed(rnd_seed, sizeof rnd_seed);
+    RAND_seed(rnd_seed, sizeof(rnd_seed));
 
     bio_stdout = BIO_new_fp(stdout, BIO_NOCLOSE | BIO_FP_TEXT);
 
@@ -1673,9 +1673,9 @@ int main(int argc, char *argv[])
     {
         int session_id_context = 0;
         SSL_CTX_set_session_id_context(s_ctx, (void *)&amp;session_id_context,
-                                       sizeof session_id_context);
+                                       sizeof(session_id_context));
         SSL_CTX_set_session_id_context(s_ctx2, (void *)&amp;session_id_context,
-                                       sizeof session_id_context);
+                                       sizeof(session_id_context));
     }
 
     /* Use PSK only if PSK key is given */
@@ -1861,9 +1861,9 @@ int main(int argc, char *argv[])
     if (c_ssl &amp;&amp; c_ssl-&gt;kssl_ctx) {
         char localhost[MAXHOSTNAMELEN + 2];
 
-        if (gethostname(localhost, sizeof localhost - 1) == 0) {
-            localhost[sizeof localhost - 1] = '\0';
-            if (strlen(localhost) == sizeof localhost - 1) {
+        if (gethostname(localhost, sizeof(localhost) - 1) == 0) {
+            localhost[sizeof(localhost) - 1] = '\0';
+            if (strlen(localhost) == sizeof(localhost) - 1) {
                 BIO_printf(bio_err, &quot;localhost name too long\n&quot;);
                 goto end;
             }
@@ -2041,8 +2041,8 @@ int doit_biopair(SSL *s_ssl, SSL *c_ssl, long count,
             if (cw_num &gt; 0) {
                 /* Write to server. */
 
-                if (cw_num &gt; (long)sizeof cbuf)
-                    i = sizeof cbuf;
+                if (cw_num &gt; (long)sizeof(cbuf))
+                    i = sizeof(cbuf);
                 else
                     i = (int)cw_num;
                 r = BIO_write(c_ssl_bio, cbuf, i);
@@ -2118,8 +2118,8 @@ int doit_biopair(SSL *s_ssl, SSL *c_ssl, long count,
             if (sw_num &gt; 0) {
                 /* Write to client. */
 
-                if (sw_num &gt; (long)sizeof sbuf)
-                    i = sizeof sbuf;
+                if (sw_num &gt; (long)sizeof(sbuf))
+                    i = sizeof(sbuf);
                 else
                     i = (int)sw_num;
                 r = BIO_write(s_ssl_bio, sbuf, i);
@@ -2630,7 +2630,7 @@ static int MS_CALLBACK verify_callback(int ok, X509_STORE_CTX *ctx)
     char *s, buf[256];
 
     s = X509_NAME_oneline(X509_get_subject_name(ctx-&gt;current_cert), buf,
-                          sizeof buf);
+                          sizeof(buf));
     if (s != NULL) {
         if (ok)
             fprintf(stderr, &quot;depth=%d %s\n&quot;, ctx-&gt;error_depth, buf);
diff --git a/ssl/t1_enc.c b/ssl/t1_enc.c
index b6d1ee9..50491ff 100644
--- a/ssl/t1_enc.c
+++ b/ssl/t1_enc.c
@@ -972,7 +972,7 @@ int tls1_final_finish_mac(SSL *s,
             int hashsize = EVP_MD_size(md);
             EVP_MD_CTX *hdgst = s-&gt;s3-&gt;handshake_dgst[idx];
             if (!hdgst || hashsize &lt; 0
-                || hashsize &gt; (int)(sizeof buf - (size_t)(q - buf))) {
+                || hashsize &gt; (int)(sizeof(buf) - (size_t)(q - buf))) {
                 /*
                  * internal error: 'buf' is too small for this cipersuite!
                  */
@@ -990,7 +990,7 @@ int tls1_final_finish_mac(SSL *s,
     if (!tls1_PRF(ssl_get_algorithm2(s),
                   str, slen, buf, (int)(q - buf), NULL, 0, NULL, 0, NULL, 0,
                   s-&gt;session-&gt;master_key, s-&gt;session-&gt;master_key_length,
-                  out, buf2, sizeof buf2))
+                  out, buf2, sizeof(buf2)))
         err = 1;
     EVP_MD_CTX_cleanup(&amp;ctx);
 
@@ -999,7 +999,7 @@ int tls1_final_finish_mac(SSL *s,
     if (err)
         return 0;
     else
-        return sizeof buf2;
+        return sizeof(buf2);
 }
 
 int tls1_mac(SSL *ssl, unsigned char *md, int send)
@@ -1165,8 +1165,8 @@ int tls1_generate_master_secret(SSL *s, unsigned char *out, unsigned char *p,
              s-&gt;s3-&gt;client_random, SSL3_RANDOM_SIZE,
              co, col,
              s-&gt;s3-&gt;server_random, SSL3_RANDOM_SIZE,
-             so, sol, p, len, s-&gt;session-&gt;master_key, buff, sizeof buff);
-    OPENSSL_cleanse(buff, sizeof buff);
+             so, sol, p, len, s-&gt;session-&gt;master_key, buff, sizeof(buff));
+    OPENSSL_cleanse(buff, sizeof(buff));
 #ifdef SSL_DEBUG
     fprintf(stderr, &quot;Premaster Secret:\n&quot;);
     BIO_dump_fp(stderr, (char *)p, len);
diff --git a/test/igetest.c b/test/igetest.c
index 08f361a..748685d 100644
--- a/test/igetest.c
+++ b/test/igetest.c
@@ -200,16 +200,16 @@ static int run_test_vectors(void)
         assert(v-&gt;length &lt;= MAX_VECTOR_SIZE);
 
         if (v-&gt;encrypt == AES_ENCRYPT)
-            AES_set_encrypt_key(v-&gt;key, 8 * sizeof v-&gt;key, &amp;key);
+            AES_set_encrypt_key(v-&gt;key, 8 * sizeof(v-&gt;key), &amp;key);
         else
-            AES_set_decrypt_key(v-&gt;key, 8 * sizeof v-&gt;key, &amp;key);
-        memcpy(iv, v-&gt;iv, sizeof iv);
+            AES_set_decrypt_key(v-&gt;key, 8 * sizeof(v-&gt;key), &amp;key);
+        memcpy(iv, v-&gt;iv, sizeof(iv));
         AES_ige_encrypt(v-&gt;in, buf, v-&gt;length, &amp;key, iv, v-&gt;encrypt);
 
         if (memcmp(v-&gt;out, buf, v-&gt;length)) {
             printf(&quot;IGE test vector %d failed\n&quot;, n);
-            hexdump(stdout, &quot;key&quot;, v-&gt;key, sizeof v-&gt;key);
-            hexdump(stdout, &quot;iv&quot;, v-&gt;iv, sizeof v-&gt;iv);
+            hexdump(stdout, &quot;key&quot;, v-&gt;key, sizeof(v-&gt;key));
+            hexdump(stdout, &quot;iv&quot;, v-&gt;iv, sizeof(v-&gt;iv));
             hexdump(stdout, &quot;in&quot;, v-&gt;in, v-&gt;length);
             hexdump(stdout, &quot;expected&quot;, v-&gt;out, v-&gt;length);
             hexdump(stdout, &quot;got&quot;, buf, v-&gt;length);
@@ -218,14 +218,14 @@ static int run_test_vectors(void)
         }
 
         /* try with in == out */
-        memcpy(iv, v-&gt;iv, sizeof iv);
+        memcpy(iv, v-&gt;iv, sizeof(iv));
         memcpy(buf, v-&gt;in, v-&gt;length);
         AES_ige_encrypt(buf, buf, v-&gt;length, &amp;key, iv, v-&gt;encrypt);
 
         if (memcmp(v-&gt;out, buf, v-&gt;length)) {
             printf(&quot;IGE test vector %d failed (with in == out)\n&quot;, n);
-            hexdump(stdout, &quot;key&quot;, v-&gt;key, sizeof v-&gt;key);
-            hexdump(stdout, &quot;iv&quot;, v-&gt;iv, sizeof v-&gt;iv);
+            hexdump(stdout, &quot;key&quot;, v-&gt;key, sizeof(v-&gt;key));
+            hexdump(stdout, &quot;iv&quot;, v-&gt;iv, sizeof(v-&gt;iv));
             hexdump(stdout, &quot;in&quot;, v-&gt;in, v-&gt;length);
             hexdump(stdout, &quot;expected&quot;, v-&gt;out, v-&gt;length);
             hexdump(stdout, &quot;got&quot;, buf, v-&gt;length);
@@ -257,9 +257,9 @@ static int run_test_vectors(void)
 
         if (memcmp(v-&gt;out, buf, v-&gt;length)) {
             printf(&quot;Bidirectional IGE test vector %d failed\n&quot;, n);
-            hexdump(stdout, &quot;key 1&quot;, v-&gt;key1, sizeof v-&gt;key1);
-            hexdump(stdout, &quot;key 2&quot;, v-&gt;key2, sizeof v-&gt;key2);
-            hexdump(stdout, &quot;iv&quot;, v-&gt;iv, sizeof v-&gt;iv);
+            hexdump(stdout, &quot;key 1&quot;, v-&gt;key1, sizeof(v-&gt;key1));
+            hexdump(stdout, &quot;key 2&quot;, v-&gt;key2, sizeof(v-&gt;key2));
+            hexdump(stdout, &quot;iv&quot;, v-&gt;iv, sizeof(v-&gt;iv));
             hexdump(stdout, &quot;in&quot;, v-&gt;in, v-&gt;length);
             hexdump(stdout, &quot;expected&quot;, v-&gt;out, v-&gt;length);
             hexdump(stdout, &quot;got&quot;, buf, v-&gt;length);
@@ -288,19 +288,19 @@ int main(int argc, char **argv)
 
     assert(BIG_TEST_SIZE &gt;= TEST_SIZE);
 
-    RAND_pseudo_bytes(rkey, sizeof rkey);
-    RAND_pseudo_bytes(plaintext, sizeof plaintext);
-    RAND_pseudo_bytes(iv, sizeof iv);
-    memcpy(saved_iv, iv, sizeof saved_iv);
+    RAND_pseudo_bytes(rkey, sizeof(rkey));
+    RAND_pseudo_bytes(plaintext, sizeof(plaintext));
+    RAND_pseudo_bytes(iv, sizeof(iv));
+    memcpy(saved_iv, iv, sizeof(saved_iv));
 
     /* Forward IGE only... */
 
     /* Straight encrypt/decrypt */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
     AES_ige_encrypt(plaintext, ciphertext, TEST_SIZE, &amp;key, iv, AES_ENCRYPT);
 
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    memcpy(iv, saved_iv, sizeof iv);
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    memcpy(iv, saved_iv, sizeof(iv));
     AES_ige_encrypt(ciphertext, checktext, TEST_SIZE, &amp;key, iv, AES_DECRYPT);
 
     if (memcmp(checktext, plaintext, TEST_SIZE)) {
@@ -311,16 +311,16 @@ int main(int argc, char **argv)
     }
 
     /* Now check encrypt chaining works */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    memcpy(iv, saved_iv, sizeof iv);
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    memcpy(iv, saved_iv, sizeof(iv));
     AES_ige_encrypt(plaintext, ciphertext, TEST_SIZE / 2, &amp;key, iv,
                     AES_ENCRYPT);
     AES_ige_encrypt(plaintext + TEST_SIZE / 2,
                     ciphertext + TEST_SIZE / 2, TEST_SIZE / 2,
                     &amp;key, iv, AES_ENCRYPT);
 
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    memcpy(iv, saved_iv, sizeof iv);
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    memcpy(iv, saved_iv, sizeof(iv));
     AES_ige_encrypt(ciphertext, checktext, TEST_SIZE, &amp;key, iv, AES_DECRYPT);
 
     if (memcmp(checktext, plaintext, TEST_SIZE)) {
@@ -331,16 +331,16 @@ int main(int argc, char **argv)
     }
 
     /* And check decrypt chaining */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    memcpy(iv, saved_iv, sizeof iv);
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    memcpy(iv, saved_iv, sizeof(iv));
     AES_ige_encrypt(plaintext, ciphertext, TEST_SIZE / 2, &amp;key, iv,
                     AES_ENCRYPT);
     AES_ige_encrypt(plaintext + TEST_SIZE / 2,
                     ciphertext + TEST_SIZE / 2, TEST_SIZE / 2,
                     &amp;key, iv, AES_ENCRYPT);
 
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    memcpy(iv, saved_iv, sizeof iv);
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    memcpy(iv, saved_iv, sizeof(iv));
     AES_ige_encrypt(ciphertext, checktext, TEST_SIZE / 2, &amp;key, iv,
                     AES_DECRYPT);
     AES_ige_encrypt(ciphertext + TEST_SIZE / 2,
@@ -355,29 +355,29 @@ int main(int argc, char **argv)
     }
 
     /* make sure garble extends forwards only */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    memcpy(iv, saved_iv, sizeof iv);
-    AES_ige_encrypt(plaintext, ciphertext, sizeof plaintext, &amp;key, iv,
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    memcpy(iv, saved_iv, sizeof(iv));
+    AES_ige_encrypt(plaintext, ciphertext, sizeof(plaintext), &amp;key, iv,
                     AES_ENCRYPT);
 
     /* corrupt halfway through */
-    ++ciphertext[sizeof ciphertext / 2];
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    memcpy(iv, saved_iv, sizeof iv);
-    AES_ige_encrypt(ciphertext, checktext, sizeof checktext, &amp;key, iv,
+    ++ciphertext[sizeof(ciphertext) / 2];
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    memcpy(iv, saved_iv, sizeof(iv));
+    AES_ige_encrypt(ciphertext, checktext, sizeof(checktext), &amp;key, iv,
                     AES_DECRYPT);
 
     matches = 0;
-    for (n = 0; n &lt; sizeof checktext; ++n)
+    for (n = 0; n &lt; sizeof(checktext); ++n)
         if (checktext[n] == plaintext[n])
             ++matches;
 
-    if (matches &gt; sizeof checktext / 2 + sizeof checktext / 100) {
+    if (matches &gt; sizeof(checktext) / 2 + sizeof(checktext) / 100) {
         printf(&quot;More than 51%% matches after garbling\n&quot;);
         ++err;
     }
 
-    if (matches &lt; sizeof checktext / 2) {
+    if (matches &lt; sizeof(checktext) / 2) {
         printf(&quot;Garble extends backwards!\n&quot;);
         ++err;
     }
@@ -389,16 +389,16 @@ int main(int argc, char **argv)
      */
     /* possible with biIGE, so the IV is not updated. */
 
-    RAND_pseudo_bytes(rkey2, sizeof rkey2);
+    RAND_pseudo_bytes(rkey2, sizeof(rkey2));
 
     /* Straight encrypt/decrypt */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_encrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_encrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
     AES_bi_ige_encrypt(plaintext, ciphertext, TEST_SIZE, &amp;key, &amp;key2, iv,
                        AES_ENCRYPT);
 
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_decrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_decrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
     AES_bi_ige_encrypt(ciphertext, checktext, TEST_SIZE, &amp;key, &amp;key2, iv,
                        AES_DECRYPT);
 
@@ -410,70 +410,70 @@ int main(int argc, char **argv)
     }
 
     /* make sure garble extends both ways */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_encrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
-    AES_ige_encrypt(plaintext, ciphertext, sizeof plaintext, &amp;key, iv,
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_encrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
+    AES_ige_encrypt(plaintext, ciphertext, sizeof(plaintext), &amp;key, iv,
                     AES_ENCRYPT);
 
     /* corrupt halfway through */
-    ++ciphertext[sizeof ciphertext / 2];
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_decrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
-    AES_ige_encrypt(ciphertext, checktext, sizeof checktext, &amp;key, iv,
+    ++ciphertext[sizeof(ciphertext) / 2];
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_decrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
+    AES_ige_encrypt(ciphertext, checktext, sizeof(checktext), &amp;key, iv,
                     AES_DECRYPT);
 
     matches = 0;
-    for (n = 0; n &lt; sizeof checktext; ++n)
+    for (n = 0; n &lt; sizeof(checktext); ++n)
         if (checktext[n] == plaintext[n])
             ++matches;
 
-    if (matches &gt; sizeof checktext / 100) {
+    if (matches &gt; sizeof(checktext) / 100) {
         printf(&quot;More than 1%% matches after bidirectional garbling\n&quot;);
         ++err;
     }
 
     /* make sure garble extends both ways (2) */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_encrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
-    AES_ige_encrypt(plaintext, ciphertext, sizeof plaintext, &amp;key, iv,
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_encrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
+    AES_ige_encrypt(plaintext, ciphertext, sizeof(plaintext), &amp;key, iv,
                     AES_ENCRYPT);
 
     /* corrupt right at the end */
-    ++ciphertext[sizeof ciphertext - 1];
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_decrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
-    AES_ige_encrypt(ciphertext, checktext, sizeof checktext, &amp;key, iv,
+    ++ciphertext[sizeof(ciphertext) - 1];
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_decrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
+    AES_ige_encrypt(ciphertext, checktext, sizeof(checktext), &amp;key, iv,
                     AES_DECRYPT);
 
     matches = 0;
-    for (n = 0; n &lt; sizeof checktext; ++n)
+    for (n = 0; n &lt; sizeof(checktext); ++n)
         if (checktext[n] == plaintext[n])
             ++matches;
 
-    if (matches &gt; sizeof checktext / 100) {
+    if (matches &gt; sizeof(checktext) / 100) {
         printf(&quot;More than 1%% matches after bidirectional garbling (2)\n&quot;);
         ++err;
     }
 
     /* make sure garble extends both ways (3) */
-    AES_set_encrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_encrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
-    AES_ige_encrypt(plaintext, ciphertext, sizeof plaintext, &amp;key, iv,
+    AES_set_encrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_encrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
+    AES_ige_encrypt(plaintext, ciphertext, sizeof(plaintext), &amp;key, iv,
                     AES_ENCRYPT);
 
     /* corrupt right at the start */
     ++ciphertext[0];
-    AES_set_decrypt_key(rkey, 8 * sizeof rkey, &amp;key);
-    AES_set_decrypt_key(rkey2, 8 * sizeof rkey2, &amp;key2);
-    AES_ige_encrypt(ciphertext, checktext, sizeof checktext, &amp;key, iv,
+    AES_set_decrypt_key(rkey, 8 * sizeof(rkey), &amp;key);
+    AES_set_decrypt_key(rkey2, 8 * sizeof(rkey2), &amp;key2);
+    AES_ige_encrypt(ciphertext, checktext, sizeof(checktext), &amp;key, iv,
                     AES_DECRYPT);
 
     matches = 0;
-    for (n = 0; n &lt; sizeof checktext; ++n)
+    for (n = 0; n &lt; sizeof(checktext); ++n)
         if (checktext[n] == plaintext[n])
             ++matches;
 
-    if (matches &gt; sizeof checktext / 100) {
+    if (matches &gt; sizeof(checktext) / 100) {
         printf(&quot;More than 1%% matches after bidirectional garbling (3)\n&quot;);
         ++err;
     }
</PRE>



























































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017134.html">[openssl-commits] [openssl]  OpenSSL_1_0_2-stable update
</A></li>
	<LI>Next message: <A HREF="017152.html">[openssl-commits] [openssl]  OpenSSL_1_0_2-stable update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17141">[ date ]</a>
              <a href="thread.html#17141">[ thread ]</a>
              <a href="subject.html#17141">[ subject ]</a>
              <a href="author.html#17141">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
