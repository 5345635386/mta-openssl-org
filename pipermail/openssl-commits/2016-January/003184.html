<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2016-January/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1453753878.687600.32248.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003181.html">
   <LINK REL="Next"  HREF="003186.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Richard Levitte</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1453753878.687600.32248.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">levitte at openssl.org
       </A><BR>
    <I>Mon Jan 25 20:31:18 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="003181.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="003186.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3184">[ date ]</a>
              <a href="thread.html#3184">[ thread ]</a>
              <a href="subject.html#3184">[ subject ]</a>
              <a href="author.html#3184">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  9ab6fc5936be62f6fee1c433938eae4c89aa23da (commit)
      from  52cdc9970de5f0e884d829d8dfa23c89c51527f9 (commit)


- Log -----------------------------------------------------------------
commit 9ab6fc5936be62f6fee1c433938eae4c89aa23da
Author: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
Date:   Mon Jan 25 21:19:59 2016 +0100

    Generate warning text
    
    Now that we're using templates, we should warn people not to edit the
    resulting file.  We do it through util/dofile.pl, which is enhanced
    with an option to tell what file it was called from.  We also change
    the calls so the template files are on the command line instead of
    being redirected through standard input.  That way, we can display
    something like this (example taken from include/openssl/opensslconf.h):
    
        /* WARNING: do not edit! */
        /* Generated by Configure from include/openssl/opensslconf.h.in */
    
    Reviewed-by: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;

-----------------------------------------------------------------------

Summary of changes:
 Configure                             |  2 +-
 Makefile.in                           |  1 +
 apps/CA.pl.in                         |  4 ++--
 apps/Makefile.in                      |  2 +-
 crypto/include/internal/bf_conf.h.in  |  1 +
 crypto/include/internal/bn_conf.h.in  |  1 +
 crypto/include/internal/des_conf.h.in |  1 +
 crypto/include/internal/rc4_conf.h.in |  1 +
 include/openssl/opensslconf.h.in      |  2 +-
 tools/Makefile.in                     |  2 +-
 tools/c_rehash.in                     |  2 ++
 util/dofile.pl                        | 16 ++++++++++++++++
 12 files changed, 29 insertions(+), 6 deletions(-)

diff --git a/Configure b/Configure
index 2e88a73..d563740 100755
--- a/Configure
+++ b/Configure
@@ -1752,7 +1752,7 @@ sub run_dofile()
     my $out = shift;
 
     # should we remove $out ?
-    system(&quot;$config{perl} -I. -Mconfigdata util/dofile.pl &lt;$in &gt;$out.new&quot;);
+    system(&quot;$config{perl} -I. -Mconfigdata util/dofile.pl -o\&quot;Configure\&quot; $in &gt; $out.new&quot;);
     exit 1 if $? != 0;
     rename(&quot;$out.new&quot;, $out) || die &quot;Can't rename $out.new, $!&quot;;
 }
diff --git a/Makefile.in b/Makefile.in
index e875f43..7db430d 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -1,6 +1,7 @@
 ##
 ## Makefile for OpenSSL
 ##
+## {- join(&quot;\n## &quot;, @autowarntext) -}
 
 VERSION={- $config{version} -}
 MAJOR={- $config{major} -}
diff --git a/apps/CA.pl.in b/apps/CA.pl.in
index b54df5e..52a97d7 100644
--- a/apps/CA.pl.in
+++ b/apps/CA.pl.in
@@ -1,8 +1,8 @@
 #!{- $config{perl} -}
 #
 # Wrapper around the ca to make it easier to use
-# Edit CA.pl.in not CA.pl!
-
+#
+# {- join(&quot;\n# &quot;, @autowarntext) -}
 
 use strict;
 use warnings;
diff --git a/apps/Makefile.in b/apps/Makefile.in
index 290dff6..8d2433b 100644
--- a/apps/Makefile.in
+++ b/apps/Makefile.in
@@ -140,7 +140,7 @@ progs.h: progs.pl Makefile
 	$(RM) openssl.o
 
 CA.pl: CA.pl.in
-	$(PERL) -I$(TOP) -Mconfigdata $(TOP)/util/dofile.pl &lt; CA.pl.in &gt; CA.pl.new
+	$(PERL) -I$(TOP) -Mconfigdata $(TOP)/util/dofile.pl -oapps/Makefile CA.pl.in &gt; CA.pl.new
 	mv CA.pl.new CA.pl
 
 
diff --git a/crypto/include/internal/bf_conf.h.in b/crypto/include/internal/bf_conf.h.in
index 5b6e5e7..552faae 100644
--- a/crypto/include/internal/bf_conf.h.in
+++ b/crypto/include/internal/bf_conf.h.in
@@ -1,3 +1,4 @@
+{- join(&quot;\n&quot;,map { &quot;/* $_ */&quot; } @autowarntext) -}
 /* ====================================================================
  * Copyright (c) 2016 The OpenSSL Project.  All rights reserved.
  *
diff --git a/crypto/include/internal/bn_conf.h.in b/crypto/include/internal/bn_conf.h.in
index a75e964..5ebd55d 100644
--- a/crypto/include/internal/bn_conf.h.in
+++ b/crypto/include/internal/bn_conf.h.in
@@ -1,3 +1,4 @@
+{- join(&quot;\n&quot;,map { &quot;/* $_ */&quot; } @autowarntext) -}
 /* ====================================================================
  * Copyright (c) 2016 The OpenSSL Project.  All rights reserved.
  *
diff --git a/crypto/include/internal/des_conf.h.in b/crypto/include/internal/des_conf.h.in
index 43ab5eb..2c4369b 100644
--- a/crypto/include/internal/des_conf.h.in
+++ b/crypto/include/internal/des_conf.h.in
@@ -1,3 +1,4 @@
+{- join(&quot;\n&quot;,map { &quot;/* $_ */&quot; } @autowarntext) -}
 /* ====================================================================
  * Copyright (c) 2016 The OpenSSL Project.  All rights reserved.
  *
diff --git a/crypto/include/internal/rc4_conf.h.in b/crypto/include/internal/rc4_conf.h.in
index 5f23357..b5b2bd3 100644
--- a/crypto/include/internal/rc4_conf.h.in
+++ b/crypto/include/internal/rc4_conf.h.in
@@ -1,3 +1,4 @@
+{- join(&quot;\n&quot;,map { &quot;/* $_ */&quot; } @autowarntext) -}
 /* ====================================================================
  * Copyright (c) 2016 The OpenSSL Project.  All rights reserved.
  *
diff --git a/include/openssl/opensslconf.h.in b/include/openssl/opensslconf.h.in
index 3d7137e..f54043a 100644
--- a/include/openssl/opensslconf.h.in
+++ b/include/openssl/opensslconf.h.in
@@ -1,5 +1,5 @@
 /* opensslconf.h */
-/* WARNING: Generated automatically from opensslconf.h.in by Configure. */
+{- join(&quot;\n&quot;,map { &quot;/* $_ */&quot; } @autowarntext) -}
 
 #ifdef  __cplusplus
 extern &quot;C&quot; {
diff --git a/tools/Makefile.in b/tools/Makefile.in
index b52b45f..d0c5ca2 100644
--- a/tools/Makefile.in
+++ b/tools/Makefile.in
@@ -59,7 +59,7 @@ clean:
 errors:
 
 c_rehash: c_rehash.in
-	$(PERL) -I$(TOP) -Mconfigdata $(TOP)/util/dofile.pl &lt; c_rehash.in &gt; c_rehash.new
+	$(PERL) -I$(TOP) -Mconfigdata $(TOP)/util/dofile.pl -otools/Makefile c_rehash.in &gt; c_rehash.new
 	mv c_rehash.new c_rehash
 
 # DO NOT DELETE THIS LINE -- make depend depends on it.
diff --git a/tools/c_rehash.in b/tools/c_rehash.in
index 912618c..dc66a9d 100644
--- a/tools/c_rehash.in
+++ b/tools/c_rehash.in
@@ -1,5 +1,7 @@
 #!{- $config{perl} -}
 
+# {- join(&quot;\n# &quot;, @autowarntext) -}
+
 # Perl c_rehash script, scan all files in a directory
 # and add symbolic links to their hash values.
 
diff --git a/util/dofile.pl b/util/dofile.pl
index a6b0905..780759b 100644
--- a/util/dofile.pl
+++ b/util/dofile.pl
@@ -8,6 +8,8 @@
 use strict;
 use warnings;
 
+use Getopt::Std;
+
 # Because we know that Text::Template isn't a core Perl module, we use
 # a fallback in case it's not installed on the system
 use File::Basename;
@@ -74,6 +76,19 @@ sub broken {
     undef;
 }
 
+# Check options ######################################################
+
+my %opts = ();
+
+# -o ORIGINATOR
+#		declares ORIGINATOR as the originating script.
+getopt('o', \%opts);
+
+my @autowarntext = (&quot;WARNING: do not edit!&quot;,
+		    &quot;Generated&quot;
+		    . (defined($opts{o}) ? &quot; by &quot;.$opts{o} : &quot;&quot;)
+		    . (scalar(@ARGV) &gt; 0 ? &quot; from &quot;.join(&quot;, &quot;<A HREF="../../../mailman/listinfo/openssl-commits.html">, at ARGV</A>) : &quot;&quot;));
+
 # Template reading ###################################################
 
 # Read in all the templates into $text, while keeping track of each
@@ -100,6 +115,7 @@ $template-&gt;fill_in(OUTPUT =&gt; \*STDOUT,
                    HASH =&gt; { config =&gt; \%config,
                              target =&gt; \%target,
                              withargs =&gt; \%withargs,
+                             autowarntext =&gt; \@autowarntext,
                              quotify1 =&gt; \&amp;quotify1,
                              quotify_l =&gt; \&amp;quotify_l },
                    DELIMITERS =&gt; [ &quot;{-&quot;, &quot;-}&quot; ],
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003181.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="003186.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3184">[ date ]</a>
              <a href="thread.html#3184">[ thread ]</a>
              <a href="subject.html#3184">[ subject ]</a>
              <a href="author.html#3184">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
