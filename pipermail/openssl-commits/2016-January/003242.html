<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2016-January/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1453939579.558395.21210.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003239.html">
   <LINK REL="Next"  HREF="003243.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Rich Salz</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1453939579.558395.21210.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">rsalz at openssl.org
       </A><BR>
    <I>Thu Jan 28 00:06:19 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="003239.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="003243.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3242">[ date ]</a>
              <a href="thread.html#3242">[ thread ]</a>
              <a href="subject.html#3242">[ subject ]</a>
              <a href="author.html#3242">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  3e9e810f2e047effb1056211794d2d12ec2b04e7 (commit)
      from  8ed40b83ec19aab146a3df701c83066c8788a7a8 (commit)


- Log -----------------------------------------------------------------
commit 3e9e810f2e047effb1056211794d2d12ec2b04e7
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at akamai.com</A>&gt;
Date:   Wed Jan 27 18:43:25 2016 -0500

    Remove outdated legacy crypto options
    
    Many options for supporting optimizations for legacy crypto on legacy
    platforms have been removed.  This simplifies the source code and
    does not really penalize anyone.
            DES_PTR (always on)
            DES_RISC1, DES_RISC2 (always off)
            DES_INT (always 'unsigned int')
            DES_UNROLL (always on)
            BF_PTR (always on) BF_PTR2 (removed)
            MD2_CHAR, MD2_LONG (always 'unsigned char')
            IDEA_SHORT, IDEA_LONG (always 'unsigned int')
            RC2_SHORT, RC2_LONG (always 'unsigned int')
            RC4_LONG (only int and char (for assembler) are supported)
            RC4_CHUNK (always long), RC_CHUNK_LL (removed)
            RC4_INDEX (always on)
    And also make D_ENCRYPT macro more clear (@appro)
    
    This is done in consultation with Andy.
    
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

-----------------------------------------------------------------------

Summary of changes:
 CHANGES                                 |   8 ++
 Configurations/10-main.conf             | 116 ++++++++--------
 Configurations/90-team.conf             |   6 +-
 Configurations/99-personal-ben.conf     |   8 +-
 Configurations/99-personal-bodo.conf    |   2 +-
 Configurations/99-personal-geoff.conf   |   2 +-
 Configurations/99-personal-levitte.conf |   8 +-
 Configurations/99-personal-steve.conf   |   4 +-
 Configurations/README                   |  41 +-----
 Configure                               |  72 +---------
 apps/openssl-vms.cnf                    |   1 -
 crypto/bf/bf_ecb.c                      |   6 -
 crypto/bf/bf_enc.c                      |  80 +----------
 crypto/bf/bf_locl.h                     | 113 +---------------
 crypto/des/des_enc.c                    |  40 ------
 crypto/des/des_locl.h                   | 171 ++----------------------
 crypto/des/ecb_enc.c                    |  25 +---
 crypto/des/fcrypt_b.c                   |  21 +--
 crypto/idea/i_ecb.c                     |   5 +-
 crypto/include/internal/bf_conf.h.in    |  69 ----------
 crypto/include/internal/des_conf.h.in   | 130 ------------------
 crypto/include/internal/rc4_conf.h.in   |  75 -----------
 crypto/rc4/rc4_enc.c                    | 229 +++-----------------------------
 crypto/rc4/rc4_locl.h                   |   3 +-
 crypto/rc4/rc4_skey.c                   |  11 +-
 include/openssl/des.h                   |   5 +-
 include/openssl/idea.h                  |   4 +-
 include/openssl/md2.h                   |   4 +-
 include/openssl/opensslconf.h.in        |   5 -
 include/openssl/rc2.h                   |   4 +-
 makevms.com                             |  22 +--
 31 files changed, 138 insertions(+), 1152 deletions(-)
 delete mode 100644 crypto/include/internal/bf_conf.h.in
 delete mode 100644 crypto/include/internal/des_conf.h.in
 delete mode 100644 crypto/include/internal/rc4_conf.h.in

diff --git a/CHANGES b/CHANGES
index 0114269..75ddadc 100644
--- a/CHANGES
+++ b/CHANGES
@@ -4,6 +4,14 @@
 
  Changes between 1.0.2e and 1.1.0  [xx XXX xxxx]
 
+  *) Removed many obsolete configuration items, including
+        DES_PTR, DES_RISC1, DES_RISC2, DES_INT
+        MD2_CHAR, MD2_INT, MD2_LONG
+        BF_PTR, BF_PTR2
+        IDEA_SHORT, IDEA_LONG
+        RC2_SHORT, RC2_LONG, RC4_LONG, RC4_CHUNK, RC4_INDEX
+     [Rich Salz, with advice from Andy Polyakov]
+
   *) Configuration and writing out the results from it has changed.
      Files such as Makefile include/openssl/opensslconf.h and are now
      produced through general templates, such as Makefile.in and
diff --git a/Configurations/10-main.conf b/Configurations/10-main.conf
index c5ae594..ff115be 100644
--- a/Configurations/10-main.conf
+++ b/Configurations/10-main.conf
@@ -76,7 +76,7 @@
         debug_cflags     =&gt; &quot;-O0 -g&quot;,
         release_cflags   =&gt; &quot;-O3&quot;,
         thread_cflag     =&gt; &quot;-pthread&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
         shared_ldflag    =&gt; &quot;-m64 -shared -static-libgcc&quot;,
@@ -92,7 +92,7 @@
         release_cflags   =&gt; &quot;-xO5 -xregs=frameptr -xdepend -xbuiltin&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; sub { join(&quot; &quot;<A HREF="../../../mailman/listinfo/openssl-commits.html">, at _</A>,&quot;-mt -lpthread&quot;) },
-        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR RC4_CHUNK DES_PTR DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
         shared_cflag     =&gt; &quot;-KPIC&quot;,
         shared_ldflag    =&gt; &quot;-G -dy -z text&quot;,
     },
@@ -104,7 +104,7 @@
         release_cflags   =&gt; &quot;-xO5 -xdepend -xbuiltin&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; sub { join(&quot; &quot;<A HREF="../../../mailman/listinfo/openssl-commits.html">, at _</A>,&quot;-mt -lpthread&quot;) },
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         shared_cflag     =&gt; &quot;-KPIC&quot;,
         shared_ldflag    =&gt; &quot;-xarch=generic64 -G -dy -z text&quot;,
@@ -119,7 +119,7 @@
         debug_cflags     =&gt; &quot;-O0 -g&quot;,
         release_cflags   =&gt; &quot;-O3&quot;,
         thread_cflag     =&gt; &quot;-pthread&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR RC4_CHUNK DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
         shared_ldflag    =&gt; &quot;-shared&quot;,
     },
@@ -137,7 +137,7 @@
     &quot;solaris64-sparcv9-gcc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;solaris-sparcv9-gcc&quot; ],
         cflags           =&gt; sub { my $f=join(&quot; &quot;<A HREF="../../../mailman/listinfo/openssl-commits.html">, at _</A>); $f =~ s/\-m32/-m64/; $f; },
-        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR RC4_CHUNK DES_INT DES_PTR DES_RISC1 DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
         shared_ldflag    =&gt; &quot;-m64 -shared&quot;,
         multilib         =&gt; &quot;/64&quot;,
     },
@@ -154,7 +154,7 @@
         release_cflags   =&gt; &quot;-xO5 -xdepend&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; sub { join(&quot; &quot;<A HREF="../../../mailman/listinfo/openssl-commits.html">, at _</A>,&quot;-mt -lpthread&quot;) },
-        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR RC4_CHUNK DES_PTR DES_RISC1 DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
         shared_cflag     =&gt; &quot;-KPIC&quot;,
         shared_ldflag    =&gt; &quot;-G -dy -z text&quot;,
     },
@@ -170,7 +170,7 @@
     &quot;solaris64-sparcv9-cc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;solaris-sparcv7-cc&quot;, asm(&quot;sparcv9_asm&quot;) ],
         cflags           =&gt; add_before(&quot; &quot;, &quot;-xarch=v9 -xtarget=ultra&quot;),
-        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR RC4_CHUNK DES_INT DES_PTR DES_RISC1 DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
         shared_ldflag    =&gt; &quot;-xarch=v9 -G -dy -z text&quot;,
         multilib         =&gt; &quot;/64&quot;,
     },
@@ -184,7 +184,7 @@
         debug_cflags     =&gt; &quot;-g -O0&quot;,
         release_cflags   =&gt; &quot;-O3&quot;,
         thread_cflag     =&gt; &quot;(unknown)&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG MD2_CHAR RC4_INDEX RC4_CHAR RC4_CHUNK DES_UNROLL DES_RISC2 DES_PTR BF_PTR&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
         perlasm_scheme   =&gt; &quot;o32&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;irix-shared&quot;,
@@ -197,7 +197,7 @@
         debug_cflags     =&gt; &quot;-g -O0&quot;,
         release_cflags   =&gt; &quot;-O2&quot;,
         thread_cflag     =&gt; &quot;(unknown)&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR RC4_CHUNK DES_PTR DES_RISC2 DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
         perlasm_scheme   =&gt; &quot;o32&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;irix-shared&quot;,
@@ -213,7 +213,7 @@
         debug_cflags     =&gt; &quot;-g -O0&quot;,
         release_cflags   =&gt; &quot;-O3&quot;,
         thread_cflag     =&gt; &quot;-D_SGI_MP_SOURCE -pthread&quot;,
-        bn_ops           =&gt; &quot;MD2_CHAR RC4_INDEX RC4_CHAR RC4_CHUNK_LL DES_UNROLL DES_RISC2 DES_PTR BF_PTR SIXTY_FOUR_BIT&quot;,
+        bn_ops           =&gt; &quot;RC4_CHAR SIXTY_FOUR_BIT&quot;,
         perlasm_scheme   =&gt; &quot;n32&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;irix-shared&quot;,
@@ -229,7 +229,7 @@
         release_cflags   =&gt; &quot;-O2&quot;,
         thread_cflag     =&gt; &quot;-D_SGI_MP_SOURCE&quot;,
         lflags           =&gt; &quot;-lpthread&quot;,
-        bn_ops           =&gt; &quot;DES_PTR RC4_CHAR RC4_CHUNK_LL DES_RISC2 DES_UNROLL BF_PTR SIXTY_FOUR_BIT&quot;,
+        bn_ops           =&gt; &quot;RC4_CHAR SIXTY_FOUR_BIT&quot;,
         perlasm_scheme   =&gt; &quot;n32&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;irix-shared&quot;,
@@ -245,7 +245,7 @@
         debug_cflags     =&gt; &quot;-g -O0&quot;,
         release_cflags   =&gt; &quot;-O3&quot;,
         thread_cflag     =&gt; &quot;-D_SGI_MP_SOURCE&quot;,
-        bn_ops           =&gt; &quot;RC4_CHAR RC4_CHUNK DES_RISC2 DES_UNROLL SIXTY_FOUR_BIT_LONG&quot;,
+        bn_ops           =&gt; &quot;RC4_CHAR SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;64&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;irix-shared&quot;,
@@ -261,7 +261,7 @@
         release_cflags   =&gt; &quot;-O2&quot;,
         thread_cflag     =&gt; &quot;-D_SGI_MP_SOURCE&quot;,
         lflags           =&gt; &quot;-lpthread&quot;,
-        bn_ops           =&gt; &quot;RC4_CHAR RC4_CHUNK DES_RISC2 DES_UNROLL SIXTY_FOUR_BIT_LONG&quot;,
+        bn_ops           =&gt; &quot;RC4_CHAR SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;64&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;irix-shared&quot;,
@@ -305,7 +305,7 @@
         release_cflags   =&gt; &quot;-O3&quot;,
         thread_cflag     =&gt; &quot;-pthread&quot;,
         lflags           =&gt; &quot;-Wl,+s -ldld&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG DES_PTR DES_UNROLL DES_RISC1&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG&quot;,
         dso_scheme       =&gt; &quot;dl&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -324,7 +324,7 @@
         release_cflags   =&gt; &quot;-O3&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; &quot;-ldl&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG MD2_CHAR RC4_INDEX RC4_CHAR DES_UNROLL DES_RISC1 DES_INT&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;-fpic&quot;,
@@ -344,7 +344,7 @@
         release_cflags   =&gt; &quot;+O3&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; &quot;-Wl,+s -ldld -lpthread&quot;,
-        bn_ops           =&gt; &quot;MD2_CHAR RC4_INDEX RC4_CHAR DES_UNROLL DES_RISC1 DES_INT&quot;,
+        bn_ops           =&gt; &quot;RC4_CHAR&quot;,
         dso_scheme       =&gt; &quot;dl&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;+Z&quot;,
@@ -364,7 +364,7 @@
         release_cflags   =&gt; &quot;+O3&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; &quot;-ldl -lpthread&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG MD2_CHAR RC4_INDEX RC4_CHAR DES_UNROLL DES_RISC1 DES_INT&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;+Z&quot;,
@@ -382,7 +382,7 @@
         release_cflags   =&gt; &quot;+O2&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; &quot;-ldl -lpthread&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT MD2_CHAR RC4_INDEX DES_UNROLL DES_RISC1 DES_INT&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;+Z&quot;,
@@ -400,7 +400,7 @@
         release_cflags   =&gt; &quot;+O3&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; &quot;-ldl -lpthread&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG MD2_CHAR RC4_INDEX DES_UNROLL DES_RISC1 DES_INT&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;+Z&quot;,
@@ -417,7 +417,7 @@
         release_cflags   =&gt; &quot;-O3&quot;,
         thread_cflag     =&gt; &quot;-pthread&quot;,
         lflags           =&gt; &quot;-ldl&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT MD2_CHAR RC4_INDEX DES_UNROLL DES_RISC1 DES_INT&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;-fpic&quot;,
@@ -433,7 +433,7 @@
         release_cflags   =&gt; &quot;-O3&quot;,
         thread_cflag     =&gt; &quot;-pthread&quot;,
         lflags           =&gt; &quot;-ldl&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG MD2_CHAR RC4_INDEX DES_UNROLL DES_RISC1 DES_INT&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;hpux-shared&quot;,
         shared_cflag     =&gt; &quot;-fpic&quot;,
@@ -449,24 +449,16 @@
         thread_cflag     =&gt; &quot;(unknown)&quot;,
         sys_id           =&gt; &quot;MPE&quot;,
         lflags           =&gt; &quot;-L/SYSLOG/PUB -lsyslog -lsocket -lcurses&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG DES_PTR DES_UNROLL DES_RISC1&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG&quot;,
     },
 
 #### DEC Alpha OSF/1/Tru64 targets.
-#
-#	&quot;What's in a name? That which we call a rose
-#	 By any other word would smell as sweet.&quot;
-#
-# - William Shakespeare, &quot;Romeo &amp; Juliet&quot;, Act II, scene II.
-#
-# For gcc, the following gave a %50 speedup on a 164 over the 'DES_INT' version
-#
     &quot;osf1-alpha-gcc&quot; =&gt; {
         inherit_from     =&gt; [ asm(&quot;alpha_asm&quot;) ],
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;-O3&quot;,
         thread_cflag     =&gt; &quot;(unknown)&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_UNROLL DES_RISC1&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;alpha-osf1-shared&quot;,
         shared_extension =&gt; &quot;.so&quot;,
@@ -476,7 +468,7 @@
         cc               =&gt; &quot;cc&quot;,
         cflags           =&gt; &quot;-std1 -tune host -O4 -readonly_strings&quot;,
         thread_cflag     =&gt; &quot;(unknown)&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;alpha-osf1-shared&quot;,
         shared_extension =&gt; &quot;.so&quot;,
@@ -486,7 +478,7 @@
         cc               =&gt; &quot;cc&quot;,
         cflags           =&gt; &quot;-std1 -tune host -fast -readonly_strings&quot;,
         thread_cflag     =&gt; &quot;-pthread&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;alpha-osf1-shared&quot;,
         shared_ldflag    =&gt; &quot;-msym&quot;,
@@ -505,7 +497,7 @@
         release_cflags   =&gt; &quot;-O3&quot;,
         thread_cflag     =&gt; &quot;-pthread&quot;,
         lflags           =&gt; &quot;-ldl&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR RC4_CHUNK DES_INT DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -513,7 +505,7 @@
     },
     &quot;linux-generic64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic32&quot; ],
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR RC4_CHUNK DES_INT DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR&quot;,
     },
 
     &quot;linux-ppc&quot; =&gt; {
@@ -576,7 +568,7 @@
     &quot;linux-arm64ilp32&quot; =&gt; {  # <A HREF="https://wiki.linaro.org/Platform/arm64-ilp32">https://wiki.linaro.org/Platform/arm64-ilp32</A>
         inherit_from     =&gt; [ &quot;linux-generic32&quot;, asm(&quot;aarch64_asm&quot;) ],
         cflags           =&gt; &quot;-mabi=ilp32 -Wall&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT RC4_CHAR RC4_CHUNK DES_INT DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT RC4_CHAR&quot;,
         perlasm_scheme   =&gt; &quot;linux64&quot;,
         shared_ldflag    =&gt; &quot;-mabi=ilp32&quot;,
     },
@@ -594,7 +586,7 @@
     &quot;linux-mips64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic32&quot;, asm(&quot;mips64_asm&quot;) ],
         cflags           =&gt; &quot;-mabi=n32 -Wall -DBN_DIV3W&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT RC4_CHAR RC4_CHUNK DES_INT DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT RC4_CHAR&quot;,
         perlasm_scheme   =&gt; &quot;n32&quot;,
         shared_ldflag    =&gt; &quot;-mabi=n32&quot;,
         multilib         =&gt; &quot;32&quot;,
@@ -631,7 +623,7 @@
     &quot;linux-x86_64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic64&quot;, asm(&quot;x86_64_asm&quot;) ],
         cflags           =&gt; &quot;-m64 -DL_ENDIAN -Wall&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         shared_ldflag    =&gt; &quot;-m64&quot;,
         multilib         =&gt; &quot;64&quot;,
@@ -644,7 +636,7 @@
     &quot;linux-x32&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic32&quot;, asm(&quot;x86_64_asm&quot;) ],
         cflags           =&gt; &quot;-mx32 -DL_ENDIAN -Wall&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT RC4_CHUNK_LL DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         shared_ldflag    =&gt; &quot;-mx32&quot;,
         multilib         =&gt; &quot;x32&quot;,
@@ -652,7 +644,7 @@
 
     &quot;linux-ia64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic64&quot;, asm(&quot;ia64_asm&quot;) ],
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_UNROLL DES_INT&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
     },
 
     &quot;linux64-s390x&quot; =&gt; {
@@ -705,7 +697,7 @@
         # GCC 3.1 is a requirement
         inherit_from     =&gt; [ &quot;linux-generic64&quot;, asm(&quot;sparcv9_asm&quot;) ],
         cflags           =&gt; &quot;-m64 -mcpu=ultrasparc -Wall -DB_ENDIAN&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR RC4_CHUNK DES_INT DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
         shared_ldflag    =&gt; &quot;-m64&quot;,
         multilib         =&gt; &quot;64&quot;,
     },
@@ -713,7 +705,7 @@
     &quot;linux-alpha-gcc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;linux-generic64&quot;, asm(&quot;alpha_asm&quot;) ],
         cflags           =&gt; &quot;-DL_ENDIAN&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_RISC1 DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
     },
     &quot;linux-c64xplus&quot; =&gt; {
         # TI_CGT_C6000_7.3.x is a requirement
@@ -832,7 +824,7 @@
         debug_cflags     =&gt; &quot;-O0 -g&quot;,
         release_cflags   =&gt; &quot;-O3&quot;,
         thread_cflag     =&gt; &quot;-pthread -D_THREAD_SAFE -D_REENTRANT&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG RC2_CHAR RC4_INDEX DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -840,7 +832,7 @@
     },
     &quot;BSD-generic64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;BSD-generic32&quot; ],
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
     },
 
     &quot;BSD-x86&quot; =&gt; {
@@ -866,19 +858,19 @@
         # triggered by RIPEMD160 code.
         inherit_from     =&gt; [ &quot;BSD-generic64&quot;, asm(&quot;sparcv9_asm&quot;) ],
         cflags           =&gt; &quot;-DB_ENDIAN -DMD32_REG_T=int -Wall&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG RC2_CHAR RC4_CHUNK DES_INT DES_PTR DES_RISC2 BF_PTR&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG&quot;,
     },
 
     &quot;BSD-ia64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;BSD-generic64&quot;, asm(&quot;ia64_asm&quot;) ],
         cflags           =&gt; &quot;-DL_ENDIAN -Wall&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_UNROLL DES_INT&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
     },
 
     &quot;BSD-x86_64&quot; =&gt; {
         inherit_from     =&gt; [ &quot;BSD-generic64&quot;, asm(&quot;x86_64_asm&quot;) ],
         cflags           =&gt; &quot;-DL_ENDIAN -Wall&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
     },
 
@@ -969,7 +961,7 @@
         cflags           =&gt; &quot;-O -DFILIO_H -Kalloca&quot;,
         thread_cflag     =&gt; &quot;-Kthread&quot;,
         lflags           =&gt; &quot;-lsocket -lnsl&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG MD2_CHAR RC4_INDEX ${x86_gcc_des}&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG ${x86_gcc_des}&quot;,
         perlasm_scheme   =&gt; &quot;elf-1&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;svr5-shared&quot;,
@@ -1092,7 +1084,7 @@
         cflags           =&gt; &quot;-O -XLLML -XLLMK -XL -DB_ENDIAN -DCHARSET_EBCDIC&quot;,
         thread_cflag     =&gt; &quot;(unknown)&quot;,
         lflags           =&gt; &quot;-lsocket -lnsl&quot;,
-        bn_ops           =&gt; &quot;THIRTY_TWO_BIT DES_PTR DES_UNROLL MD2_CHAR RC4_INDEX RC4_CHAR BF_PTR&quot;,
+        bn_ops           =&gt; &quot;THIRTY_TWO_BIT RC4_CHAR&quot;,
     },
 
 # OS/390 Unix an EBCDIC-based Unix system on IBM mainframe
@@ -1103,7 +1095,7 @@
         cc               =&gt; &quot;c89.sh&quot;,
         cflags           =&gt; &quot;-O -DB_ENDIAN -DCHARSET_EBCDIC -DNO_SYS_PARAM_H  -D_ALL_SOURCE&quot;,
         thread_cflag     =&gt; &quot;(unknown)&quot;,
-        bn_ops           =&gt; &quot;THIRTY_TWO_BIT DES_PTR DES_UNROLL MD2_CHAR RC4_INDEX RC4_CHAR BF_PTR&quot;,
+        bn_ops           =&gt; &quot;THIRTY_TWO_BIT RC4_CHAR&quot;,
     },
 
 #### Visual C targets
@@ -1125,7 +1117,7 @@
         inherit_from     =&gt; [ &quot;VC-common&quot;, asm(&quot;ia64_asm&quot;) ],
         cflags           =&gt; add(&quot; &quot;, &quot;-DUNICODE -D_UNICODE&quot;),
         sys_id           =&gt; &quot;WIN64I&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT RC4_CHUNK_LL DES_INT EXPORT_VAR_AS_FN&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT EXPORT_VAR_AS_FN&quot;,
         bn_obj           =&gt; sub { my $r=join(&quot; &quot;<A HREF="../../../mailman/listinfo/openssl-commits.html">, at _</A>); $r=~s/bn\-//; $r; },
         rc4_obj          =&gt; &quot;&quot;,
         perlasm_scheme   =&gt; &quot;ias&quot;,
@@ -1135,7 +1127,7 @@
         inherit_from     =&gt; [ &quot;VC-common&quot;, asm(&quot;x86_64_asm&quot;) ],
         cflags           =&gt; add(&quot; &quot;, &quot;-DUNICODE -D_UNICODE&quot;),
         sys_id           =&gt; &quot;WIN64A&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT RC4_CHUNK_LL DES_INT EXPORT_VAR_AS_FN&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT EXPORT_VAR_AS_FN&quot;,
         bn_obj           =&gt; sub { my $r=join(&quot; &quot;<A HREF="../../../mailman/listinfo/openssl-commits.html">, at _</A>); $r=~s/x86_64\-gcc/bn_asm/; $r; },
         perlasm_scheme   =&gt; &quot;auto&quot;,
 	build_scheme     =&gt; [ &quot;mk1mf&quot;, &quot;VC-W64&quot; ],
@@ -1145,14 +1137,14 @@
         # configure with 'perl Configure VC-WIN32 -DUNICODE -D_UNICODE'
         inherit_from     =&gt; [ &quot;VC-common&quot;, asm(&quot;x86_asm&quot;) ],
         sys_id           =&gt; &quot;WIN32&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG RC4_INDEX EXPORT_VAR_AS_FN ${x86_gcc_opts}&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG EXPORT_VAR_AS_FN ${x86_gcc_opts}&quot;,
         perlasm_scheme   =&gt; &quot;win32n&quot;,
 	build_scheme     =&gt; [ &quot;mk1mf&quot;, &quot;VC-W32&quot; ],
     },
     &quot;VC-CE&quot; =&gt; {
         cc               =&gt; &quot;cl&quot;,
         sys_id           =&gt; &quot;WINCE&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG RC4_INDEX EXPORT_VAR_AS_FN ${x86_gcc_opts}&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG EXPORT_VAR_AS_FN ${x86_gcc_opts}&quot;,
         dso_scheme       =&gt; &quot;win32&quot;,
 	build_scheme     =&gt; [ &quot;mk1mf&quot;, &quot;VC-WCE&quot; ],
     },
@@ -1161,7 +1153,7 @@
     &quot;BC-32&quot; =&gt; {
         cc               =&gt; &quot;bcc32&quot;,
         sys_id           =&gt; &quot;WIN32&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG DES_PTR RC4_INDEX EXPORT_VAR_AS_FN&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG EXPORT_VAR_AS_FN&quot;,
         dso_scheme       =&gt; &quot;win32&quot;,
 	build_scheme     =&gt; [ &quot;mk1mf&quot;, &quot;BC&quot; ],
     },
@@ -1201,7 +1193,7 @@
         thread_cflag     =&gt; &quot;-D_MT&quot;,
         sys_id           =&gt; &quot;MINGW64&quot;,
         lflags           =&gt; &quot;-lws2_32 -lgdi32 -lcrypt32&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT RC4_CHUNK_LL DES_INT EXPORT_VAR_AS_FN&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT EXPORT_VAR_AS_FN&quot;,
         perlasm_scheme   =&gt; &quot;mingw64&quot;,
         dso_scheme       =&gt; &quot;win32&quot;,
         shared_target    =&gt; &quot;cygwin-shared&quot;,
@@ -1249,7 +1241,7 @@
         debug_cflags     =&gt; &quot;-g -O0&quot;,
         release_cflags   =&gt; &quot;-O3&quot;,
         sys_id           =&gt; &quot;CYGWIN&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;mingw64&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;cygwin-shared&quot;,
@@ -1358,7 +1350,7 @@
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         sys_id           =&gt; &quot;MACOSX&quot;,
         lflags           =&gt; &quot;-Wl,-search_paths_first%&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR RC4_CHUNK DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG RC4_CHAR&quot;,
         perlasm_scheme   =&gt; &quot;osx32&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;darwin-shared&quot;,
@@ -1375,7 +1367,7 @@
     &quot;darwin64-ppc-cc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;darwin-common&quot;, asm(&quot;ppc64_asm&quot;) ],
         cflags           =&gt; &quot;-arch ppc64 -DB_ENDIAN&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR RC4_CHUNK DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR&quot;,
         perlasm_scheme   =&gt; &quot;osx64&quot;,
         shared_ldflag    =&gt; &quot;-arch ppc64 -dynamiclib&quot;,
     },
@@ -1383,14 +1375,14 @@
         inherit_from     =&gt; [ &quot;darwin-common&quot;, asm(&quot;x86_asm&quot;) ],
         cflags           =&gt; &quot;-arch i386 -DL_ENDIAN&quot;,
         release_cflags   =&gt; &quot;-O3 -fomit-frame-pointer&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG RC4_INT RC4_CHUNK DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG RC4_INT&quot;,
         perlasm_scheme   =&gt; &quot;macosx&quot;,
         shared_ldflag    =&gt; &quot;-arch i386 -dynamiclib&quot;,
     },
     &quot;darwin64-x86_64-cc&quot; =&gt; {
         inherit_from     =&gt; [ &quot;darwin-common&quot;, asm(&quot;x86_64_asm&quot;) ],
         cflags           =&gt; &quot;-arch x86_64 -DL_ENDIAN -Wall&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;macosx&quot;,
         shared_ldflag    =&gt; &quot;-arch x86_64 -dynamiclib&quot;,
     },
@@ -1428,7 +1420,7 @@
         inherit_from     =&gt; [ &quot;darwin-common&quot;, asm(&quot;aarch64_asm&quot;) ],
         cflags           =&gt; &quot;-arch arm64 -mios-version-min=7.0.0 -isysroot \$(CROSS_TOP)/SDKs/\$(CROSS_SDK) -fno-common&quot;,
         sys_id           =&gt; &quot;iOS&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR RC4_CHUNK DES_INT DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR&quot;,
         perlasm_scheme   =&gt; &quot;ios64&quot;,
     },
 
diff --git a/Configurations/90-team.conf b/Configurations/90-team.conf
index bf27587..b91ce88 100644
--- a/Configurations/90-team.conf
+++ b/Configurations/90-team.conf
@@ -24,7 +24,7 @@
         cflags           =&gt; &quot;$gcc_devteam_warn -DBN_DEBUG -DCONF_DEBUG -m64 -DL_ENDIAN -DTERMIO -g&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; &quot;-ldl&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
@@ -99,7 +99,7 @@
         cc               =&gt; &quot;clang&quot;,
         cflags           =&gt; &quot;$gcc_devteam_warn -Wno-error=overlength-strings -Wno-error=extended-offsetof -Wno-error=language-extension-token -Wno-error=unused-const-variable -Wstrict-overflow -Qunused-arguments -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -O3 -pipe&quot;,
         thread_cflag     =&gt; &quot;${BSDthreads}&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
@@ -112,7 +112,7 @@
         cflags           =&gt; &quot;-arch x86_64 -DL_ENDIAN $gcc_devteam_warn -Wno-error=overlength-strings -Wno-error=extended-offsetof -Wno-error=language-extension-token -Wno-error=unused-const-variable -Wstrict-overflow -Qunused-arguments -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -O3 -pipe&quot;,
         thread_cflag     =&gt; &quot;${BSDthreads}&quot;,
         sys_id           =&gt; &quot;MACOSX&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;macosx&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;darwin-shared&quot;,
diff --git a/Configurations/99-personal-ben.conf b/Configurations/99-personal-ben.conf
index afaa988..0bebb04 100644
--- a/Configurations/99-personal-ben.conf
+++ b/Configurations/99-personal-ben.conf
@@ -31,7 +31,7 @@
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;$gcc_devteam_warn -Wno-error=overlength-strings -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -O3 -pipe&quot;,
         thread_cflag     =&gt; &quot;${BSDthreads}&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
@@ -43,7 +43,7 @@
         cc               =&gt; &quot;clang&quot;,
         cflags           =&gt; &quot;$gcc_devteam_warn -Wno-error=overlength-strings -Wno-error=extended-offsetof -Wno-error=language-extension-token -Wstrict-overflow -Qunused-arguments -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -O3 -pipe&quot;,
         thread_cflag     =&gt; &quot;${BSDthreads}&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
@@ -55,7 +55,7 @@
         cc               =&gt; &quot;gcc&quot;,
         cflags           =&gt; &quot;$gcc_devteam_warn -Wno-error=overlength-strings -DBN_DEBUG -DCONF_DEBUG -DDEBUG_SAFESTACK -DDEBUG_UNUSED -g3 -pipe&quot;,
         thread_cflag     =&gt; &quot;${BSDthreads}&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;bsd-gcc-shared&quot;,
@@ -84,7 +84,7 @@
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         sys_id           =&gt; &quot;MACOSX&quot;,
         lflags           =&gt; &quot;-Wl,-search_paths_first%&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;macosx&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;darwin-shared&quot;,
diff --git a/Configurations/99-personal-bodo.conf b/Configurations/99-personal-bodo.conf
index 854fd79..603fc2b 100644
--- a/Configurations/99-personal-bodo.conf
+++ b/Configurations/99-personal-bodo.conf
@@ -12,7 +12,7 @@
         cflags           =&gt; &quot;$gcc_devteam_warn -Wno-error=overlength-strings -DBN_DEBUG -DBN_DEBUG_RAND -DCONF_DEBUG -DBIO_PAIR_DEBUG -m64 -DL_ENDIAN -DTERMIO -g -DMD32_REG_T=int&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; &quot;-ldl&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
diff --git a/Configurations/99-personal-geoff.conf b/Configurations/99-personal-geoff.conf
index 7f847fe..72787f9 100644
--- a/Configurations/99-personal-geoff.conf
+++ b/Configurations/99-personal-geoff.conf
@@ -22,7 +22,7 @@
         cflags           =&gt; &quot;-DBN_DEBUG -DBN_DEBUG_RAND -DBN_STRICT -DPURIFY -DOPENSSL_NO_DEPRECATED -DOPENSSL_NO_ASM -DOPENSSL_NO_INLINE_ASM -DL_ENDIAN -DTERMIO -DPEDANTIC -O1 -ggdb2 -Wall -Werror -Wundef -pedantic -Wshadow -Wpointer-arith -Wbad-function-cast -Wcast-align -Wsign-compare -Wmissing-prototypes -Wmissing-declarations -Wno-long-long&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; &quot;-ldl&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR RC4_CHUNK DES_INT DES_UNROLL BF_PTR&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHAR&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
diff --git a/Configurations/99-personal-levitte.conf b/Configurations/99-personal-levitte.conf
index d4a87b6..4bfcbbe 100644
--- a/Configurations/99-personal-levitte.conf
+++ b/Configurations/99-personal-levitte.conf
@@ -13,7 +13,7 @@
         debug_cflags     =&gt; &quot;-DLEVITTE_DEBUG -DBN_DEBUG -DREF_CHECK -DCONF_DEBUG -ggdb -g3&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; &quot;-ldl&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG DES_PTR DES_RISC1 DES_UNROLL RC4_INDEX MD2_INT&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -24,7 +24,7 @@
         cflags           =&gt; &quot;-DLEVITTE_DEBUG -DBN_DEBUG -DREF_CHECK -DCONF_DEBUG -DOPENSSL_NO_ASM -DL_ENDIAN -ggdb -g3 -Wall&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; &quot;-ldl&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG DES_PTR DES_RISC1 DES_UNROLL RC4_INDEX MD2_INT&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
         shared_cflag     =&gt; &quot;-fPIC&quot;,
@@ -36,7 +36,7 @@
         cflags           =&gt; &quot;-DLEVITTE_DEBUG -DREF_CHECK -DCONF_DEBUG -DBN_DEBUG -DBN_DEBUG_RAND -DENGINE_CONF_DEBUG -DL_ENDIAN -DPEDANTIC -ggdb -g3 -pedantic -ansi -Wall -W -Wundef -Wshadow -Wcast-align -Wstrict-prototypes -Wmissing-prototypes -Wno-long-long -Wundef -Wconversion -pipe&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; &quot;-ldl&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG DES_PTR DES_RISC1 DES_UNROLL RC4_INDEX MD2_INT&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
@@ -48,7 +48,7 @@
         cflags           =&gt; &quot;-DLEVITTE_DEBUG -DREF_CHECK -DCONF_DEBUG -DBN_DEBUG -DBN_DEBUG_RAND -DENGINE_CONF_DEBUG -DOPENSSL_NO_ASM -DL_ENDIAN -DPEDANTIC -ggdb -g3 -pedantic -ansi -Wall -W -Wundef -Wshadow -Wcast-align -Wstrict-prototypes -Wmissing-prototypes -Wno-long-long -Wundef -Wconversion -pipe&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; &quot;-ldl&quot;,
-        bn_ops           =&gt; &quot;BN_LLONG DES_PTR DES_RISC1 DES_UNROLL RC4_INDEX MD2_INT&quot;,
+        bn_ops           =&gt; &quot;BN_LLONG&quot;,
         perlasm_scheme   =&gt; &quot;void&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
diff --git a/Configurations/99-personal-steve.conf b/Configurations/99-personal-steve.conf
index 3234576..10f9eb7 100644
--- a/Configurations/99-personal-steve.conf
+++ b/Configurations/99-personal-steve.conf
@@ -12,7 +12,7 @@
         cflags           =&gt; &quot;$gcc_devteam_warn -pthread -m64 -DL_ENDIAN -DTERMIO -DCONF_DEBUG -g&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; &quot;-ldl&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
@@ -39,7 +39,7 @@
         cflags           =&gt; &quot;$gcc_devteam_warn -pthread -m64 -O3 -DL_ENDIAN -DTERMIO -DCONF_DEBUG -g&quot;,
         thread_cflag     =&gt; &quot;-D_REENTRANT&quot;,
         lflags           =&gt; &quot;-ldl&quot;,
-        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG RC4_CHUNK DES_INT DES_UNROLL&quot;,
+        bn_ops           =&gt; &quot;SIXTY_FOUR_BIT_LONG&quot;,
         perlasm_scheme   =&gt; &quot;elf&quot;,
         dso_scheme       =&gt; &quot;dlfcn&quot;,
         shared_target    =&gt; &quot;linux-shared&quot;,
diff --git a/Configurations/README b/Configurations/README
index c4a7413..5e544b1 100644
--- a/Configurations/README
+++ b/Configurations/README
@@ -126,52 +126,13 @@ In each table entry, the following keys are significant:
                            source.
                            The valid words are:
 
-                           DES_PTR      use a pointer to DES_SPtrans
-                                        rather that DES_SPtrans
-                                        directly in D_ENCRYPT.
-                           DES_RISC1    Alternate implementations of
-                           DES_RISC2    D_ENCRYPT for certain RISC
-                                        processors.
-                           DES_UNROLL   do not loop around calls to
-                                        D_ENCRYPT.
-                           DES_INT      have unsigned int as the
-                                        integer type for DES rather
-                                        than unsigned long.
                            BN_LLONG     use 'unsigned long long' in
                                         some bignum calculations.
                                         This has no value when
                                         SIXTY_FOUR_BIT or
                                         SIXTY_FOUR_BIT_LONG is given.
-                           RC4_CHAR     makes the basic RC4 unif of
+                           RC4_CHAR     makes the basic RC4 unit of
                                         calculation an unsigned char.
-                           RC4_LONG     makes the basic RC4 unif of
-                                        calculation an unsigned long.
-                           RC4_INDEX    go through input and output
-                                        data by indexing into them
-                                        rather than incrementing the
-                                        pointer.
-                           RC4_CHUNK    sets the chunk type to
-                                        unsigned long.
-                           RC4_CHUNK_LL sets the chunk type to
-                                        unsigned long long.
-                                        both these chunk sizes are for
-                                        handling data in chunks on
-                                        processors that do not have
-                                        byte load/store instructions.
-                           MD2_CHAR     makes the basic MD2 unit of
-                                        calculation an unsigned char.
-                           MD2_LONG     makes the basic MD2 unit of
-                                        calculation an unsigned long.
-                           IDEA_SHORT   makes the basic IDEA unit of
-                                        calculation an unsigned short.
-                           IDEA_LONG    makes the basic IDEA unit of
-                                        calculation an unsigned long.
-                           RC2_SHORT    makes the basic RC2 unit of
-                                        calculation an unsigned short.
-                           RC2_LONG     makes the basic RC2 unit of
-                                        calculation an unsigned long.
-                           BF_PTR       use different pointer based
-                           BF_PTR2      versions of BF_ENC.
                            SIXTY_FOUR_BIT       processor registers
                                                 are 64 bits, long is
                                                 32 bits, long long is
diff --git a/Configure b/Configure
index e52eecd..3d2e3cd 100755
--- a/Configure
+++ b/Configure
@@ -65,32 +65,8 @@ my $usage=&quot;Usage: Configure [no-&lt;cipher&gt; ...] [enable-&lt;cipher&gt; ...] [experimenta
 # DEBUG_SAFESTACK use type-safe stacks to enforce type-safety on stack items
 #		provided to stack calls. Generates unique stack functions for
 #		each possible stack type.
-# DES_PTR	use pointer lookup vs arrays in the DES in crypto/des/des_locl.h
-# DES_RISC1	use different DES_ENCRYPT macro that helps reduce register
-#		dependancies but needs to more registers, good for RISC CPU's
-# DES_RISC2	A different RISC variant.
-# DES_UNROLL	unroll the inner DES loop, sometimes helps, somtimes hinders.
-# DES_INT	use 'int' instead of 'long' for DES_LONG in crypto/des/des.h
-#		This is used on the DEC Alpha where long is 8 bytes
-#		and int is 4
 # BN_LLONG	use the type 'long long' in crypto/bn/bn.h
-# MD2_CHAR	use 'char' instead of 'int' for MD2_INT in crypto/md2/md2.h
-# MD2_LONG	use 'long' instead of 'int' for MD2_INT in crypto/md2/md2.h
-# IDEA_SHORT	use 'short' instead of 'int' for IDEA_INT in crypto/idea/idea.h
-# IDEA_LONG	use 'long' instead of 'int' for IDEA_INT in crypto/idea/idea.h
-# RC2_SHORT	use 'short' instead of 'int' for RC2_INT in crypto/rc2/rc2.h
-# RC2_LONG	use 'long' instead of 'int' for RC2_INT in crypto/rc2/rc2.h
 # RC4_CHAR	use 'char' instead of 'int' for RC4_INT in crypto/rc4/rc4.h
-# RC4_LONG	use 'long' instead of 'int' for RC4_INT in crypto/rc4/rc4.h
-# RC4_INDEX	define RC4_INDEX in crypto/rc4/rc4_locl.h.  This turns on
-#		array lookups instead of pointer use.
-# RC4_CHUNK	enables code that handles data aligned at long (natural CPU
-#		word) boundary.
-# RC4_CHUNK_LL	enables code that handles data aligned at long long boundary
-#		(intended for 64-bit CPUs running 32-bit OS).
-# BF_PTR	use 'pointer arithmatic' for Blowfish (unsafe on Alpha).
-# BF_PTR2	intel specific version (generic version is more efficient).
-#
 # Following are set automatically by this script
 #
 # MD5_ASM	use some extra md5 assember,
@@ -124,10 +100,8 @@ my $memleak_devteam_backtrace = &quot;-rdynamic -DCRYPTO_MDEBUG_BACKTRACE&quot;;
 
 my $strict_warnings = 0;
 
-my $x86_gcc_des=&quot;DES_PTR DES_RISC1 DES_UNROLL&quot;;
-
-# MD2_CHAR slags pentium pros
-my $x86_gcc_opts=&quot;RC4_INDEX MD2_INT&quot;;
+my $x86_gcc_des=&quot;&quot;;
+my $x86_gcc_opts=&quot;&quot;;
 
 # As for $BSDthreads. Idea is to maintain &quot;collective&quot; set of flags,
 # which would cover all BSD flavors. -pthread applies to them all,
@@ -1152,44 +1126,16 @@ $config{depflags} =~ s/^\s*//;
 
 # Deal with bn_ops ###################################################
 
-$config{des_ptr}		=0;
-$config{des_risc1}		=0;
-$config{des_risc2}		=0;
-$config{des_unroll}		=0;
 $config{bn_ll}			=0;
-$config{rc4_idx}		=0;
-$config{bf_ptr}			=0;
 $config{export_var_as_fn}	=0;
 my $def_int=&quot;unsigned int&quot;;
 $config{rc4_int}		=$def_int;
-$config{rc4_chunk}		=&quot;&quot;;
-$config{md2_int}		=$def_int;
-$config{idea_int}		=$def_int;
 $config{rc2_int}		=$def_int;
 ($config{b64l},$config{b64},$config{b32},$config{b16},$config{b8})=(0,0,1,0,0);
 
-$config{des_int} = &quot;unsigned long&quot;;
-
 foreach (sort split(/\s+/,$target{bn_ops})) {
-    $config{des_ptr}=1				if /DES_PTR/;
-    $config{des_risc1}=1			if /DES_RISC1/;
-    $config{des_risc2}=1			if /DES_RISC2/;
-    $config{des_unroll}=1			if /DES_UNROLL/;
-    $config{des_int}=&quot;unsigned int&quot;		if /DES_INT/;
     $config{bn_ll}=1				if /BN_LLONG/;
     $config{rc4_int}=&quot;unsigned char&quot;		if /RC4_CHAR/;
-    $config{rc4_int}=&quot;unsigned long&quot;		if /RC4_LONG/;
-    $config{rc4_idx}=1				if /RC4_INDEX/;
-    $config{rc4_chunk}=&quot;unsigned long&quot;		if /RC4_CHUNK/;
-    $config{rc4_chunk}=&quot;unsigned long long&quot;	if /RC4_CHUNK_LL/;
-    $config{md2_int}=&quot;unsigned char&quot;		if /MD2_CHAR/;
-    $config{md2_int}=&quot;unsigned long&quot;		if /MD2_LONG/;
-    $config{idea_int}=&quot;unsigned char&quot;		if /IDEA_CHAR/;
-    $config{idea_int}=&quot;unsigned long&quot;		if /IDEA_LONG/;
-    $config{rc2_int}=&quot;unsigned char&quot;		if /RC2_CHAR/;
-    $config{rc2_int}=&quot;unsigned long&quot;		if /RC2_LONG/;
-    $config{bf_ptr}=1				if $_ eq &quot;BF_PTR&quot;;
-    $config{bf_ptr}=2				if $_ eq &quot;BF_PTR2&quot;;
     ($config{b64l},$config{b64},$config{b32},$config{b16},$config{b8})
 	=(0,1,0,0,0)				if /SIXTY_FOUR_BIT/;
     ($config{b64l},$config{b64},$config{b32},$config{b16},$config{b8})
@@ -1351,27 +1297,15 @@ print &quot;SIXTY_FOUR_BIT mode\n&quot; if $config{b64};
 print &quot;THIRTY_TWO_BIT mode\n&quot; if $config{b32};
 print &quot;SIXTEEN_BIT mode\n&quot; if $config{b16};
 print &quot;EIGHT_BIT mode\n&quot; if $config{b8};
-print &quot;DES_PTR used\n&quot; if $config{des_ptr};
-print &quot;DES_RISC1 used\n&quot; if $config{des_risc1};
-print &quot;DES_RISC2 used\n&quot; if $config{des_risc2};
-print &quot;DES_UNROLL used\n&quot; if $config{des_unroll};
-print &quot;DES_INT used\n&quot; if $config{des_int} =~ / int$/;
 print &quot;BN_LLONG mode\n&quot; if $config{bn_ll};
 print &quot;RC4 uses $config{rc4_int}\n&quot; if $config{rc4_int} != $def_int;
-print &quot;RC4_INDEX mode\n&quot; if $config{rc4_idx};
-print &quot;RC4_CHUNK is undefined\n&quot; unless $config{rc4_chunk};
-print &quot;RC4_CHUNK is $config{rc4_chunk}\n&quot; if $config{rc4_chunk};
-print &quot;MD2 uses $config{md2_int}\n&quot; if $config{md2_int} != $def_int;
-print &quot;IDEA uses $config{idea_int}\n&quot; if $config{idea_int} != $def_int;
 print &quot;RC2 uses $config{rc2_int}\n&quot; if $config{rc2_int} != $def_int;
-print &quot;BF_PTR used\n&quot; if $config{bf_ptr} == 1;
-print &quot;BF_PTR2 used\n&quot; if $config{bf_ptr} == 2;
 
 run_dofile(&quot;$Makefile.in&quot;,&quot;$Makefile&quot;);
 
 run_dofile(&quot;include/openssl/opensslconf.h.in&quot;, &quot;include/openssl/opensslconf.h&quot;);
 
-foreach my $alg ( 'bf', 'bn', 'des', 'rc4' ) {
+foreach my $alg ( 'bn' ) {
     run_dofile(&quot;crypto/include/internal/${alg}_conf.h.in&quot;,
 	       &quot;crypto/include/internal/${alg}_conf.h&quot;);
 }
diff --git a/apps/openssl-vms.cnf b/apps/openssl-vms.cnf
index 94caf45..5b3a27f 100644
--- a/apps/openssl-vms.cnf
+++ b/apps/openssl-vms.cnf
@@ -336,7 +336,6 @@ certs		= $dir.cacert.pem]	# Certificate chain to include in reply
 					# (optional)
 signer_key	= $dir/private/tsakey.pem # The TSA private key (optional)
 signer_digest  = sha256			# Signing digest to use. (Optional)
-
 default_policy	= tsa_policy1		# Policy if request did not specify it
 					# (optional)
 other_policies	= tsa_policy2, tsa_policy3	# acceptable policies (optional)
diff --git a/crypto/bf/bf_ecb.c b/crypto/bf/bf_ecb.c
index dfee789..a7640d8 100644
--- a/crypto/bf/bf_ecb.c
+++ b/crypto/bf/bf_ecb.c
@@ -67,13 +67,7 @@
 
 const char *BF_options(void)
 {
-#ifdef BF_PTR
     return (&quot;blowfish(ptr)&quot;);
-#elif defined(BF_PTR2)
-    return (&quot;blowfish(ptr2)&quot;);
-#else
-    return (&quot;blowfish(idx)&quot;);
-#endif
 }
 
 void BF_ecb_encrypt(const unsigned char *in, unsigned char *out,
diff --git a/crypto/bf/bf_enc.c b/crypto/bf/bf_enc.c
index 76d4270..04eb391 100644
--- a/crypto/bf/bf_enc.c
+++ b/crypto/bf/bf_enc.c
@@ -71,7 +71,6 @@ to modify the code.
 
 void BF_encrypt(BF_LONG *data, const BF_KEY *key)
 {
-#ifndef BF_PTR2
     register BF_LONG l, r;
     register const BF_LONG *p, *s;
 
@@ -105,50 +104,14 @@ void BF_encrypt(BF_LONG *data, const BF_KEY *key)
 # endif
     r ^= p[BF_ROUNDS + 1];
 
-    data[1] = l &amp; 0xffffffffL;
-    data[0] = r &amp; 0xffffffffL;
-#else
-    register BF_LONG l, r, t, *k;
-
-    l = data[0];
-    r = data[1];
-    k = (BF_LONG *)key;
-
-    l ^= k[0];
-    BF_ENC(r, l, k, 1);
-    BF_ENC(l, r, k, 2);
-    BF_ENC(r, l, k, 3);
-    BF_ENC(l, r, k, 4);
-    BF_ENC(r, l, k, 5);
-    BF_ENC(l, r, k, 6);
-    BF_ENC(r, l, k, 7);
-    BF_ENC(l, r, k, 8);
-    BF_ENC(r, l, k, 9);
-    BF_ENC(l, r, k, 10);
-    BF_ENC(r, l, k, 11);
-    BF_ENC(l, r, k, 12);
-    BF_ENC(r, l, k, 13);
-    BF_ENC(l, r, k, 14);
-    BF_ENC(r, l, k, 15);
-    BF_ENC(l, r, k, 16);
-# if BF_ROUNDS == 20
-    BF_ENC(r, l, k, 17);
-    BF_ENC(l, r, k, 18);
-    BF_ENC(r, l, k, 19);
-    BF_ENC(l, r, k, 20);
-# endif
-    r ^= k[BF_ROUNDS + 1];
-
-    data[1] = l &amp; 0xffffffffL;
-    data[0] = r &amp; 0xffffffffL;
-#endif
+    data[1] = l &amp; 0xffffffffU;
+    data[0] = r &amp; 0xffffffffU;
 }
 
 #ifndef BF_DEFAULT_OPTIONS
 
 void BF_decrypt(BF_LONG *data, const BF_KEY *key)
 {
-# ifndef BF_PTR2
     register BF_LONG l, r;
     register const BF_LONG *p, *s;
 
@@ -182,43 +145,8 @@ void BF_decrypt(BF_LONG *data, const BF_KEY *key)
     BF_ENC(l, r, s, p[1]);
     r ^= p[0];
 
-    data[1] = l &amp; 0xffffffffL;
-    data[0] = r &amp; 0xffffffffL;
-# else
-    register BF_LONG l, r, t, *k;
-
-    l = data[0];
-    r = data[1];
-    k = (BF_LONG *)key;
-
-    l ^= k[BF_ROUNDS + 1];
-#  if BF_ROUNDS == 20
-    BF_ENC(r, l, k, 20);
-    BF_ENC(l, r, k, 19);
-    BF_ENC(r, l, k, 18);
-    BF_ENC(l, r, k, 17);
-#  endif
-    BF_ENC(r, l, k, 16);
-    BF_ENC(l, r, k, 15);
-    BF_ENC(r, l, k, 14);
-    BF_ENC(l, r, k, 13);
-    BF_ENC(r, l, k, 12);
-    BF_ENC(l, r, k, 11);
-    BF_ENC(r, l, k, 10);
-    BF_ENC(l, r, k, 9);
-    BF_ENC(r, l, k, 8);
-    BF_ENC(l, r, k, 7);
-    BF_ENC(r, l, k, 6);
-    BF_ENC(l, r, k, 5);
-    BF_ENC(r, l, k, 4);
-    BF_ENC(l, r, k, 3);
-    BF_ENC(r, l, k, 2);
-    BF_ENC(l, r, k, 1);
-    r ^= k[0];
-
-    data[1] = l &amp; 0xffffffffL;
-    data[0] = r &amp; 0xffffffffL;
-# endif
+    data[1] = l &amp; 0xffffffffU;
+    data[0] = r &amp; 0xffffffffU;
 }
 
 void BF_cbc_encrypt(const unsigned char *in, unsigned char *out, long length,
diff --git a/crypto/bf/bf_locl.h b/crypto/bf/bf_locl.h
index ecdf388..5ad9ec2 100644
--- a/crypto/bf/bf_locl.h
+++ b/crypto/bf/bf_locl.h
@@ -58,52 +58,6 @@
 #ifndef HEADER_BF_LOCL_H
 # define HEADER_BF_LOCL_H
 # include &lt;openssl/opensslconf.h&gt;
-# include &quot;internal/bf_conf.h&quot;
-
-# undef c2l
-# define c2l(c,l)        (l =((unsigned long)(*((c)++)))    , \
-                         l|=((unsigned long)(*((c)++)))&lt;&lt; 8L, \
-                         l|=((unsigned long)(*((c)++)))&lt;&lt;16L, \
-                         l|=((unsigned long)(*((c)++)))&lt;&lt;24L)
-
-/* NOTE - c is not incremented as per c2l */
-# undef c2ln
-# define c2ln(c,l1,l2,n) { \
-                        c+=n; \
-                        l1=l2=0; \
-                        switch (n) { \
-                        case 8: l2 =((unsigned long)(*(--(c))))&lt;&lt;24L; \
-                        case 7: l2|=((unsigned long)(*(--(c))))&lt;&lt;16L; \
-                        case 6: l2|=((unsigned long)(*(--(c))))&lt;&lt; 8L; \
-                        case 5: l2|=((unsigned long)(*(--(c))));     \
-                        case 4: l1 =((unsigned long)(*(--(c))))&lt;&lt;24L; \
-                        case 3: l1|=((unsigned long)(*(--(c))))&lt;&lt;16L; \
-                        case 2: l1|=((unsigned long)(*(--(c))))&lt;&lt; 8L; \
-                        case 1: l1|=((unsigned long)(*(--(c))));     \
-                                } \
-                        }
-
-# undef l2c
-# define l2c(l,c)        (*((c)++)=(unsigned char)(((l)     )&amp;0xff), \
-                         *((c)++)=(unsigned char)(((l)&gt;&gt; 8L)&amp;0xff), \
-                         *((c)++)=(unsigned char)(((l)&gt;&gt;16L)&amp;0xff), \
-                         *((c)++)=(unsigned char)(((l)&gt;&gt;24L)&amp;0xff))
-
-/* NOTE - c is not incremented as per l2c */
-# undef l2cn
-# define l2cn(l1,l2,c,n) { \
-                        c+=n; \
-                        switch (n) { \
-                        case 8: *(--(c))=(unsigned char)(((l2)&gt;&gt;24L)&amp;0xff); \
-                        case 7: *(--(c))=(unsigned char)(((l2)&gt;&gt;16L)&amp;0xff); \
-                        case 6: *(--(c))=(unsigned char)(((l2)&gt;&gt; 8L)&amp;0xff); \
-                        case 5: *(--(c))=(unsigned char)(((l2)     )&amp;0xff); \
-                        case 4: *(--(c))=(unsigned char)(((l1)&gt;&gt;24L)&amp;0xff); \
-                        case 3: *(--(c))=(unsigned char)(((l1)&gt;&gt;16L)&amp;0xff); \
-                        case 2: *(--(c))=(unsigned char)(((l1)&gt;&gt; 8L)&amp;0xff); \
-                        case 1: *(--(c))=(unsigned char)(((l1)     )&amp;0xff); \
-                                } \
-                        }
 
 /* NOTE - c is not incremented as per n2l */
 # define n2ln(c,l1,l2,n) { \
@@ -153,69 +107,12 @@
  * to lookup array 0
  */
 
-# if defined(BF_PTR2)
-
-/*
- * This is basically a special Intel version. Point is that Intel
- * doesn't have many registers, but offers a reach choice of addressing
- * modes. So we spare some registers by directly traversing BF_KEY
- * structure and hiring the most decorated addressing mode. The code
- * generated by EGCS is *perfectly* competitive with assembler
- * implementation!
- */
-#  define BF_ENC(LL,R,KEY,Pi) (\
-        LL^=KEY[Pi], \
-        t=  KEY[BF_ROUNDS+2 +   0 + ((R&gt;&gt;24)&amp;0xFF)], \
-        t+= KEY[BF_ROUNDS+2 + 256 + ((R&gt;&gt;16)&amp;0xFF)], \
-        t^= KEY[BF_ROUNDS+2 + 512 + ((R&gt;&gt;8 )&amp;0xFF)], \
-        t+= KEY[BF_ROUNDS+2 + 768 + ((R    )&amp;0xFF)], \
-        LL^=t \
-        )
-
-# elif defined(BF_PTR)
-
-#  ifndef BF_LONG_LOG2
-#   define BF_LONG_LOG2  2      /* default to BF_LONG being 32 bits */
-#  endif
-#  define BF_M  (0xFF&lt;&lt;BF_LONG_LOG2)
-#  define BF_0  (24-BF_LONG_LOG2)
-#  define BF_1  (16-BF_LONG_LOG2)
-#  define BF_2  ( 8-BF_LONG_LOG2)
-#  define BF_3  BF_LONG_LOG2    /* left shift */
-
-/*
- * This is normally very good on RISC platforms where normally you
- * have to explicitly &quot;multiply&quot; array index by sizeof(BF_LONG)
- * in order to calculate the effective address. This implementation
- * excuses CPU from this extra work. Power[PC] uses should have most
- * fun as (R&gt;&gt;BF_i)&amp;BF_M gets folded into a single instruction, namely
- * rlwinm. So let'em double-check if their compiler does it.
- */
-
-#  define BF_ENC(LL,R,S,P) ( \
-        LL^=P, \
-        LL^= (((*(BF_LONG *)((unsigned char *)&amp;(S[  0])+((R&gt;&gt;BF_0)&amp;BF_M))+ \
-                *(BF_LONG *)((unsigned char *)&amp;(S[256])+((R&gt;&gt;BF_1)&amp;BF_M)))^ \
-                *(BF_LONG *)((unsigned char *)&amp;(S[512])+((R&gt;&gt;BF_2)&amp;BF_M)))+ \
-                *(BF_LONG *)((unsigned char *)&amp;(S[768])+((R&lt;&lt;BF_3)&amp;BF_M))) \
-        )
-# else
-
-/*
- * This is a *generic* version. Seem to perform best on platforms that
- * offer explicit support for extraction of 8-bit nibbles preferably
- * complemented with &quot;multiplying&quot; of array index by sizeof(BF_LONG).
- * For the moment of this writing the list comprises Alpha CPU featuring
- * extbl and s[48]addq instructions.
- */
-
-#  define BF_ENC(LL,R,S,P) ( \
+# define BF_ENC(LL,R,S,P) ( \
         LL^=P, \
-        LL^=((( S[       ((int)(R&gt;&gt;24)&amp;0xff)] + \
-                S[0x0100+((int)(R&gt;&gt;16)&amp;0xff)])^ \
-                S[0x0200+((int)(R&gt;&gt; 8)&amp;0xff)])+ \
-                S[0x0300+((int)(R    )&amp;0xff)])&amp;0xffffffffL \
+        LL^=((( S[       ((R&gt;&gt;24)&amp;0xff)] + \
+                S[0x0100+((R&gt;&gt;16)&amp;0xff)])^ \
+                S[0x0200+((R&gt;&gt; 8)&amp;0xff)])+ \
+                S[0x0300+((R    )&amp;0xff)])&amp;0xffffffffU \
         )
-# endif
 
 #endif
diff --git a/crypto/des/des_enc.c b/crypto/des/des_enc.c
index 6137351..1f827f2 100644
--- a/crypto/des/des_enc.c
+++ b/crypto/des/des_enc.c
@@ -62,12 +62,6 @@
 void DES_encrypt1(DES_LONG *data, DES_key_schedule *ks, int enc)
 {
     register DES_LONG l, r, t, u;
-#ifdef DES_PTR
-    register const unsigned char *des_SP = (const unsigned char *)DES_SPtrans;
-#endif
-#ifndef DES_UNROLL
-    register int i;
-#endif
     register DES_LONG *s;
 
     r = data[0];
@@ -92,7 +86,6 @@ void DES_encrypt1(DES_LONG *data, DES_key_schedule *ks, int enc)
      * loop
      */
     if (enc) {
-#ifdef DES_UNROLL
         D_ENCRYPT(l, r, 0);     /* 1 */
         D_ENCRYPT(r, l, 2);     /* 2 */
         D_ENCRYPT(l, r, 4);     /* 3 */
@@ -109,14 +102,7 @@ void DES_encrypt1(DES_LONG *data, DES_key_schedule *ks, int enc)
         D_ENCRYPT(r, l, 26);    /* 14 */
         D_ENCRYPT(l, r, 28);    /* 15 */
         D_ENCRYPT(r, l, 30);    /* 16 */
-#else
-        for (i = 0; i &lt; 32; i += 4) {
-            D_ENCRYPT(l, r, i + 0); /* 1 */
-            D_ENCRYPT(r, l, i + 2); /* 2 */
-        }
-#endif
     } else {
-#ifdef DES_UNROLL
         D_ENCRYPT(l, r, 30);    /* 16 */
         D_ENCRYPT(r, l, 28);    /* 15 */
         D_ENCRYPT(l, r, 26);    /* 14 */
@@ -133,12 +119,6 @@ void DES_encrypt1(DES_LONG *data, DES_key_schedule *ks, int enc)
         D_ENCRYPT(r, l, 4);     /* 3 */
         D_ENCRYPT(l, r, 2);     /* 2 */
         D_ENCRYPT(r, l, 0);     /* 1 */
-#else
-        for (i = 30; i &gt; 0; i -= 4) {
-            D_ENCRYPT(l, r, i - 0); /* 16 */
-            D_ENCRYPT(r, l, i - 2); /* 15 */
-        }
-#endif
     }
 
     /* rotate and clear the top bits on machines with 8byte longs */
@@ -154,12 +134,6 @@ void DES_encrypt1(DES_LONG *data, DES_key_schedule *ks, int enc)
 void DES_encrypt2(DES_LONG *data, DES_key_schedule *ks, int enc)
 {
     register DES_LONG l, r, t, u;
-#ifdef DES_PTR
-    register const unsigned char *des_SP = (const unsigned char *)DES_SPtrans;
-#endif
-#ifndef DES_UNROLL
-    register int i;
-#endif
     register DES_LONG *s;
 
     r = data[0];
@@ -182,7 +156,6 @@ void DES_encrypt2(DES_LONG *data, DES_key_schedule *ks, int enc)
      * loop
      */
     if (enc) {
-#ifdef DES_UNROLL
         D_ENCRYPT(l, r, 0);     /* 1 */
         D_ENCRYPT(r, l, 2);     /* 2 */
         D_ENCRYPT(l, r, 4);     /* 3 */
@@ -199,14 +172,7 @@ void DES_encrypt2(DES_LONG *data, DES_key_schedule *ks, int enc)
         D_ENCRYPT(r, l, 26);    /* 14 */
         D_ENCRYPT(l, r, 28);    /* 15 */
         D_ENCRYPT(r, l, 30);    /* 16 */
-#else
-        for (i = 0; i &lt; 32; i += 4) {
-            D_ENCRYPT(l, r, i + 0); /* 1 */
-            D_ENCRYPT(r, l, i + 2); /* 2 */
-        }
-#endif
     } else {
-#ifdef DES_UNROLL
         D_ENCRYPT(l, r, 30);    /* 16 */
         D_ENCRYPT(r, l, 28);    /* 15 */
         D_ENCRYPT(l, r, 26);    /* 14 */
@@ -223,12 +189,6 @@ void DES_encrypt2(DES_LONG *data, DES_key_schedule *ks, int enc)
         D_ENCRYPT(r, l, 4);     /* 3 */
         D_ENCRYPT(l, r, 2);     /* 2 */
         D_ENCRYPT(r, l, 0);     /* 1 */
-#else
-        for (i = 30; i &gt; 0; i -= 4) {
-            D_ENCRYPT(l, r, i - 0); /* 16 */
-            D_ENCRYPT(r, l, i - 2); /* 15 */
-        }
-#endif
     }
     /* rotate and clear the top bits on machines with 8byte longs */
     data[0] = ROTATE(l, 3) &amp; 0xffffffffL;
diff --git a/crypto/des/des_locl.h b/crypto/des/des_locl.h
index 651eb3a..7ed783c 100644
--- a/crypto/des/des_locl.h
+++ b/crypto/des/des_locl.h
@@ -60,8 +60,6 @@
 
 # include &lt;openssl/e_os2.h&gt;
 
-# include &quot;internal/des_conf.h&quot;
-
 # if defined(OPENSSL_SYS_WIN32)
 #  ifndef OPENSSL_SYS_MSDOS
 #   define OPENSSL_SYS_MSDOS
@@ -205,171 +203,23 @@
 # endif
 
 /*
- * The changes to this macro may help or hinder, depending on the compiler
- * and the architecture.  gcc2 always seems to do well :-). Inspired by Dana
- * How &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">how at isl.stanford.edu</A>&gt; DO NOT use the alternative version on machines
- * with 8 byte longs. It does not seem to work on the Alpha, even when
- * DES_LONG is 4 bytes, probably an issue of accessing non-word aligned
- * objects :-(
- */
-# ifdef DES_PTR
-
-/*
  * It recently occurred to me that 0^0^0^0^0^0^0 == 0, so there is no reason
  * to not xor all the sub items together.  This potentially saves a register
  * since things can be xored directly into L
  */
 
-#  if defined(DES_RISC1) || defined(DES_RISC2)
-#   ifdef DES_RISC1
-#    define D_ENCRYPT(LL,R,S) { \
-        unsigned int u1,u2,u3; \
-        LOAD_DATA(R,S,u,t,E0,E1,u1); \
-        u2=(int)u&gt;&gt;8L; \
-        u1=(int)u&amp;0xfc; \
-        u2&amp;=0xfc; \
-        t=ROTATE(t,4); \
-        u&gt;&gt;=16L; \
-        LL^= *(const DES_LONG *)(des_SP      +u1); \
-        LL^= *(const DES_LONG *)(des_SP+0x200+u2); \
-        u3=(int)(u&gt;&gt;8L); \
-        u1=(int)u&amp;0xfc; \
-        u3&amp;=0xfc; \
-        LL^= *(const DES_LONG *)(des_SP+0x400+u1); \
-        LL^= *(const DES_LONG *)(des_SP+0x600+u3); \
-        u2=(int)t&gt;&gt;8L; \
-        u1=(int)t&amp;0xfc; \
-        u2&amp;=0xfc; \
-        t&gt;&gt;=16L; \
-        LL^= *(const DES_LONG *)(des_SP+0x100+u1); \
-        LL^= *(const DES_LONG *)(des_SP+0x300+u2); \
-        u3=(int)t&gt;&gt;8L; \
-        u1=(int)t&amp;0xfc; \
-        u3&amp;=0xfc; \
-        LL^= *(const DES_LONG *)(des_SP+0x500+u1); \
-        LL^= *(const DES_LONG *)(des_SP+0x700+u3); }
-#   endif
-#   ifdef DES_RISC2
-#    define D_ENCRYPT(LL,R,S) { \
-        unsigned int u1,u2,s1,s2; \
-        LOAD_DATA(R,S,u,t,E0,E1,u1); \
-        u2=(int)u&gt;&gt;8L; \
-        u1=(int)u&amp;0xfc; \
-        u2&amp;=0xfc; \
-        t=ROTATE(t,4); \
-        LL^= *(const DES_LONG *)(des_SP      +u1); \
-        LL^= *(const DES_LONG *)(des_SP+0x200+u2); \
-        s1=(int)(u&gt;&gt;16L); \
-        s2=(int)(u&gt;&gt;24L); \
-        s1&amp;=0xfc; \
-        s2&amp;=0xfc; \
-        LL^= *(const DES_LONG *)(des_SP+0x400+s1); \
-        LL^= *(const DES_LONG *)(des_SP+0x600+s2); \
-        u2=(int)t&gt;&gt;8L; \
-        u1=(int)t&amp;0xfc; \
-        u2&amp;=0xfc; \
-        LL^= *(const DES_LONG *)(des_SP+0x100+u1); \
-        LL^= *(const DES_LONG *)(des_SP+0x300+u2); \
-        s1=(int)(t&gt;&gt;16L); \
-        s2=(int)(t&gt;&gt;24L); \
-        s1&amp;=0xfc; \
-        s2&amp;=0xfc; \
-        LL^= *(const DES_LONG *)(des_SP+0x500+s1); \
-        LL^= *(const DES_LONG *)(des_SP+0x700+s2); }
-#   endif
-#  else
-#   define D_ENCRYPT(LL,R,S) { \
+# define D_ENCRYPT(LL,R,S) { \
         LOAD_DATA_tmp(R,S,u,t,E0,E1); \
         t=ROTATE(t,4); \
         LL^= \
-        *(const DES_LONG *)(des_SP      +((u     )&amp;0xfc))^ \
-        *(const DES_LONG *)(des_SP+0x200+((u&gt;&gt; 8L)&amp;0xfc))^ \
-        *(const DES_LONG *)(des_SP+0x400+((u&gt;&gt;16L)&amp;0xfc))^ \
-        *(const DES_LONG *)(des_SP+0x600+((u&gt;&gt;24L)&amp;0xfc))^ \
-        *(const DES_LONG *)(des_SP+0x100+((t     )&amp;0xfc))^ \
-        *(const DES_LONG *)(des_SP+0x300+((t&gt;&gt; 8L)&amp;0xfc))^ \
-        *(const DES_LONG *)(des_SP+0x500+((t&gt;&gt;16L)&amp;0xfc))^ \
-        *(const DES_LONG *)(des_SP+0x700+((t&gt;&gt;24L)&amp;0xfc)); }
-#  endif
-
-# else                          /* original version */
-
-#  if defined(DES_RISC1) || defined(DES_RISC2)
-#   ifdef DES_RISC1
-#    define D_ENCRYPT(LL,R,S) {\
-        unsigned int u1,u2,u3; \
-        LOAD_DATA(R,S,u,t,E0,E1,u1); \
-        u&gt;&gt;=2L; \
-        t=ROTATE(t,6); \
-        u2=(int)u&gt;&gt;8L; \
-        u1=(int)u&amp;0x3f; \
-        u2&amp;=0x3f; \
-        u&gt;&gt;=16L; \
-        LL^=DES_SPtrans[0][u1]; \
-        LL^=DES_SPtrans[2][u2]; \
-        u3=(int)u&gt;&gt;8L; \
-        u1=(int)u&amp;0x3f; \
-        u3&amp;=0x3f; \
-        LL^=DES_SPtrans[4][u1]; \
-        LL^=DES_SPtrans[6][u3]; \
-        u2=(int)t&gt;&gt;8L; \
-        u1=(int)t&amp;0x3f; \
-        u2&amp;=0x3f; \
-        t&gt;&gt;=16L; \
-        LL^=DES_SPtrans[1][u1]; \
-        LL^=DES_SPtrans[3][u2]; \
-        u3=(int)t&gt;&gt;8L; \
-        u1=(int)t&amp;0x3f; \
-        u3&amp;=0x3f; \
-        LL^=DES_SPtrans[5][u1]; \
-        LL^=DES_SPtrans[7][u3]; }
-#   endif
-#   ifdef DES_RISC2
-#    define D_ENCRYPT(LL,R,S) {\
-        unsigned int u1,u2,s1,s2; \
-        LOAD_DATA(R,S,u,t,E0,E1,u1); \
-        u&gt;&gt;=2L; \
-        t=ROTATE(t,6); \
-        u2=(int)u&gt;&gt;8L; \
-        u1=(int)u&amp;0x3f; \
-        u2&amp;=0x3f; \
-        LL^=DES_SPtrans[0][u1]; \
-        LL^=DES_SPtrans[2][u2]; \
-        s1=(int)u&gt;&gt;16L; \
-        s2=(int)u&gt;&gt;24L; \
-        s1&amp;=0x3f; \
-        s2&amp;=0x3f; \
-        LL^=DES_SPtrans[4][s1]; \
-        LL^=DES_SPtrans[6][s2]; \
-        u2=(int)t&gt;&gt;8L; \
-        u1=(int)t&amp;0x3f; \
-        u2&amp;=0x3f; \
-        LL^=DES_SPtrans[1][u1]; \
-        LL^=DES_SPtrans[3][u2]; \
-        s1=(int)t&gt;&gt;16; \
-        s2=(int)t&gt;&gt;24L; \
-        s1&amp;=0x3f; \
-        s2&amp;=0x3f; \
-        LL^=DES_SPtrans[5][s1]; \
-        LL^=DES_SPtrans[7][s2]; }
-#   endif
-
-#  else
-
-#   define D_ENCRYPT(LL,R,S) {\
-        LOAD_DATA_tmp(R,S,u,t,E0,E1); \
-        t=ROTATE(t,4); \
-        LL^=\
-                DES_SPtrans[0][(u&gt;&gt; 2L)&amp;0x3f]^ \
-                DES_SPtrans[2][(u&gt;&gt;10L)&amp;0x3f]^ \
-                DES_SPtrans[4][(u&gt;&gt;18L)&amp;0x3f]^ \
-                DES_SPtrans[6][(u&gt;&gt;26L)&amp;0x3f]^ \
-                DES_SPtrans[1][(t&gt;&gt; 2L)&amp;0x3f]^ \
-                DES_SPtrans[3][(t&gt;&gt;10L)&amp;0x3f]^ \
-                DES_SPtrans[5][(t&gt;&gt;18L)&amp;0x3f]^ \
-                DES_SPtrans[7][(t&gt;&gt;26L)&amp;0x3f]; }
-#  endif
-# endif
+            DES_SPtrans[0][(u&gt;&gt; 2L)&amp;0x3f]^ \
+            DES_SPtrans[2][(u&gt;&gt;10L)&amp;0x3f]^ \
+            DES_SPtrans[4][(u&gt;&gt;18L)&amp;0x3f]^ \
+            DES_SPtrans[6][(u&gt;&gt;26L)&amp;0x3f]^ \
+            DES_SPtrans[1][(t&gt;&gt; 2L)&amp;0x3f]^ \
+            DES_SPtrans[3][(t&gt;&gt;10L)&amp;0x3f]^ \
+            DES_SPtrans[5][(t&gt;&gt;18L)&amp;0x3f]^ \
+            DES_SPtrans[7][(t&gt;&gt;26L)&amp;0x3f]; }
 
         /*-
          * IP and FP
@@ -438,7 +288,4 @@ extern const DES_LONG DES_SPtrans[8][64];
 void fcrypt_body(DES_LONG *out, DES_key_schedule *ks,
                  DES_LONG Eswap0, DES_LONG Eswap1);
 
-# ifdef OPENSSL_SMALL_FOOTPRINT
-#  undef DES_UNROLL
-# endif
 #endif
diff --git a/crypto/des/ecb_enc.c b/crypto/des/ecb_enc.c
index 56a6a0b..109ffd4 100644
--- a/crypto/des/ecb_enc.c
+++ b/crypto/des/ecb_enc.c
@@ -66,34 +66,13 @@ const char *DES_options(void)
     static char buf[32];
 
     if (init) {
-        const char *ptr, *unroll, *risc, *size;
+        const char *size;
 
-#ifdef DES_PTR
-        ptr = &quot;ptr&quot;;
-#else
-        ptr = &quot;idx&quot;;
-#endif
-#if defined(DES_RISC1) || defined(DES_RISC2)
-# ifdef DES_RISC1
-        risc = &quot;risc1&quot;;
-# endif
-# ifdef DES_RISC2
-        risc = &quot;risc2&quot;;
-# endif
-#else
-        risc = &quot;cisc&quot;;
-#endif
-#ifdef DES_UNROLL
-        unroll = &quot;16&quot;;
-#else
-        unroll = &quot;2&quot;;
-#endif
         if (sizeof(DES_LONG) != sizeof(long))
             size = &quot;int&quot;;
         else
             size = &quot;long&quot;;
-        BIO_snprintf(buf, sizeof buf, &quot;des(%s,%s,%s,%s)&quot;, ptr, risc, unroll,
-                     size);
+        BIO_snprintf(buf, sizeof buf, &quot;des(%s)&quot;, size);
         init = 0;
     }
     return (buf);
diff --git a/crypto/des/fcrypt_b.c b/crypto/des/fcrypt_b.c
index 8fb9350..6e02ac7 100644
--- a/crypto/des/fcrypt_b.c
+++ b/crypto/des/fcrypt_b.c
@@ -80,9 +80,6 @@ void fcrypt_body(DES_LONG *out, DES_key_schedule *ks, DES_LONG Eswap0,
                  DES_LONG Eswap1)
 {
     register DES_LONG l, r, t, u;
-#ifdef DES_PTR
-    register const unsigned char *des_SP = (const unsigned char *)DES_SPtrans;
-#endif
     register DES_LONG *s;
     register int j;
     register DES_LONG E0, E1;
@@ -95,14 +92,6 @@ void fcrypt_body(DES_LONG *out, DES_key_schedule *ks, DES_LONG Eswap0,
     E1 = Eswap1;
 
     for (j = 0; j &lt; 25; j++) {
-#ifndef DES_UNROLL
-        register int i;
-
-        for (i = 0; i &lt; 32; i += 4) {
-            D_ENCRYPT(l, r, i + 0); /* 1 */
-            D_ENCRYPT(r, l, i + 2); /* 2 */
-        }
-#else
         D_ENCRYPT(l, r, 0);     /* 1 */
         D_ENCRYPT(r, l, 2);     /* 2 */
         D_ENCRYPT(l, r, 4);     /* 3 */
@@ -119,8 +108,6 @@ void fcrypt_body(DES_LONG *out, DES_key_schedule *ks, DES_LONG Eswap0,
         D_ENCRYPT(r, l, 26);    /* 14 */
         D_ENCRYPT(l, r, 28);    /* 15 */
         D_ENCRYPT(r, l, 30);    /* 16 */
-#endif
-
         t = l;
         l = r;
         r = t;
@@ -128,11 +115,11 @@ void fcrypt_body(DES_LONG *out, DES_key_schedule *ks, DES_LONG Eswap0,
     l = ROTATE(l, 3) &amp; 0xffffffffL;
     r = ROTATE(r, 3) &amp; 0xffffffffL;
 
-    PERM_OP(l, r, t, 1, 0x55555555L);
-    PERM_OP(r, l, t, 8, 0x00ff00ffL);
-    PERM_OP(l, r, t, 2, 0x33333333L);
+    PERM_OP(l, r, t,  1, 0x55555555L);
+    PERM_OP(r, l, t,  8, 0x00ff00ffL);
+    PERM_OP(l, r, t,  2, 0x33333333L);
     PERM_OP(r, l, t, 16, 0x0000ffffL);
-    PERM_OP(l, r, t, 4, 0x0f0f0f0fL);
+    PERM_OP(l, r, t,  4, 0x0f0f0f0fL);
 
     out[0] = r;
     out[1] = l;
diff --git a/crypto/idea/i_ecb.c b/crypto/idea/i_ecb.c
index c018c15..e7eeb4f 100644
--- a/crypto/idea/i_ecb.c
+++ b/crypto/idea/i_ecb.c
@@ -61,10 +61,7 @@
 
 const char *idea_options(void)
 {
-    if (sizeof(short) != sizeof(IDEA_INT))
-        return (&quot;idea(int)&quot;);
-    else
-        return (&quot;idea(short)&quot;);
+    return (&quot;idea(int)&quot;);
 }
 
 void idea_ecb_encrypt(const unsigned char *in, unsigned char *out,
diff --git a/crypto/include/internal/bf_conf.h.in b/crypto/include/internal/bf_conf.h.in
deleted file mode 100644
index 552faae..0000000
--- a/crypto/include/internal/bf_conf.h.in
+++ /dev/null
@@ -1,69 +0,0 @@
-{- join(&quot;\n&quot;,map { &quot;/* $_ */&quot; } @autowarntext) -}
-/* ====================================================================
- * Copyright (c) 2016 The OpenSSL Project.  All rights reserved.
- *
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- *
- * 1. Redistributions of source code must retain the above copyright
- *    notice, this list of conditions and the following disclaimer.
- *
- * 2. Redistributions in binary form must reproduce the above copyright
- *    notice, this list of conditions and the following disclaimer in
- *    the documentation and/or other materials provided with the
- *    distribution.
- *
- * 3. All advertising materials mentioning features or use of this
- *    software must display the following acknowledgment:
- *    &quot;This product includes software developed by the OpenSSL Project
- *    for use in the OpenSSL Toolkit. (<A HREF="http://www.openssl.org/">http://www.openssl.org/</A>)&quot;
- *
- * 4. The names &quot;OpenSSL Toolkit&quot; and &quot;OpenSSL Project&quot; must not be used to
- *    endorse or promote products derived from this software without
- *    prior written permission. For written permission, please contact
- *    <A HREF="../../../mailman/listinfo/openssl-commits.html">openssl-core at openssl.org.</A>
- *
- * 5. Products derived from this software may not be called &quot;OpenSSL&quot;
- *    nor may &quot;OpenSSL&quot; appear in their names without prior written
- *    permission of the OpenSSL Project.
- *
- * 6. Redistributions of any form whatsoever must retain the following
- *    acknowledgment:
- *    &quot;This product includes software developed by the OpenSSL Project
- *    for use in the OpenSSL Toolkit (<A HREF="http://www.openssl.org/">http://www.openssl.org/</A>)&quot;
- *
- * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
- * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
- * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
- * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
- * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
- * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
- * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
- * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
- * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
- * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
- * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
- * OF THE POSSIBILITY OF SUCH DAMAGE.
- * ====================================================================
- *
- * This product includes cryptographic software written by Eric Young
- * (<A HREF="../../../mailman/listinfo/openssl-commits.html">eay at cryptsoft.com</A>).  This product includes software written by Tim
- * Hudson (<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at cryptsoft.com</A>).
- *
- */
-
-#ifndef HEADER_BF_CONF_H
-# define HEADER_BF_CONF_H
-
-{-
-    if ($config{bf_ptr} == 0) {
-      &quot;#undef BF_PTR&quot;;
-    } elsif ($config{bf_ptr} == 1) {
-      &quot;#define BF_PTR&quot;;
-    } elsif ($config{bf_ptr} == 2) {
-      &quot;#define BF_PTR2&quot;;
-    }
--}
-
-#endif
diff --git a/crypto/include/internal/des_conf.h.in b/crypto/include/internal/des_conf.h.in
deleted file mode 100644
index 2c4369b..0000000
--- a/crypto/include/internal/des_conf.h.in
+++ /dev/null
@@ -1,130 +0,0 @@
-{- join(&quot;\n&quot;,map { &quot;/* $_ */&quot; } @autowarntext) -}
-/* ====================================================================
- * Copyright (c) 2016 The OpenSSL Project.  All rights reserved.
- *
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- *
- * 1. Redistributions of source code must retain the above copyright
- *    notice, this list of conditions and the following disclaimer.
- *
- * 2. Redistributions in binary form must reproduce the above copyright
- *    notice, this list of conditions and the following disclaimer in
- *    the documentation and/or other materials provided with the
- *    distribution.
- *
- * 3. All advertising materials mentioning features or use of this
- *    software must display the following acknowledgment:
- *    &quot;This product includes software developed by the OpenSSL Project
- *    for use in the OpenSSL Toolkit. (<A HREF="http://www.openssl.org/">http://www.openssl.org/</A>)&quot;
- *
- * 4. The names &quot;OpenSSL Toolkit&quot; and &quot;OpenSSL Project&quot; must not be used to
- *    endorse or promote products derived from this software without
- *    prior written permission. For written permission, please contact
- *    <A HREF="../../../mailman/listinfo/openssl-commits.html">openssl-core at openssl.org.</A>
- *
- * 5. Products derived from this software may not be called &quot;OpenSSL&quot;
- *    nor may &quot;OpenSSL&quot; appear in their names without prior written
- *    permission of the OpenSSL Project.
- *
- * 6. Redistributions of any form whatsoever must retain the following
- *    acknowledgment:
- *    &quot;This product includes software developed by the OpenSSL Project
- *    for use in the OpenSSL Toolkit (<A HREF="http://www.openssl.org/">http://www.openssl.org/</A>)&quot;
- *
- * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
- * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
- * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
- * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
- * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
- * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
- * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
- * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
- * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
- * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
- * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
- * OF THE POSSIBILITY OF SUCH DAMAGE.
- * ====================================================================
- *
- * This product includes cryptographic software written by Eric Young
- * (<A HREF="../../../mailman/listinfo/openssl-commits.html">eay at cryptsoft.com</A>).  This product includes software written by Tim
- * Hudson (<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at cryptsoft.com</A>).
- *
- */
-
-#ifndef HEADER_DES_CONF_H
-# define HEADER_DES_CONF_H
-
-/* the following is tweaked from a config script, that is why it is a
- * protected undef/define */
-# ifndef DES_PTR
-{- $config{des_ptr} ? &quot;#define&quot; : &quot;#undef&quot; -} DES_PTR
-# endif
-
-/* This helps C compiler generate the correct code for multiple functional
- * units.  It reduces register dependancies at the expense of 2 more
- * registers */
-# ifndef DES_RISC1
-{- $config{des_risc1} ? &quot;#define&quot; : &quot;#undef&quot; -} DES_RISC1
-# endif
-
-# ifndef DES_RISC2
-{- $config{des_risc2} ? &quot;#define&quot; : &quot;#undef&quot; -} DES_RISC2
-# endif
-
-# if defined(DES_RISC1) &amp;&amp; defined(DES_RISC2)
-#  error YOU SHOULD NOT HAVE BOTH DES_RISC1 AND DES_RISC2 DEFINED!!!!!
-# endif
-
-/* Unroll the inner loop, this sometimes helps, sometimes hinders.
- * Very mucy CPU dependant */
-# ifndef DES_UNROLL
-{- $config{des_unroll} ? &quot;#define&quot; : &quot;#undef&quot; -} DES_UNROLL
-# endif
-
-/*
- * These default values were supplied by
- * Peter Gutman &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pgut001 at cs.auckland.ac.nz</A>&gt;
- * They are only used if nothing else has been defined
- */
-# if !defined(DES_PTR) &amp;&amp; !defined(DES_RISC1) &amp;&amp; !defined(DES_RISC2) &amp;&amp; !defined(DES_UNROLL)
-
-/*
- * Special defines which change the way the code is built depending on the
- * CPU and OS.  For SGI machines you can use _MIPS_SZLONG (32 or 64) to find
- * even newer MIPS CPU's, but at the moment one size fits all for
- * optimization options.  Older Sparc's work better with only UNROLL, but
- * there's no way to tell at compile time what it is you're running on.
- */
- 
-#  if defined(sparc) || defined(__sparc__)	/* Newer Sparc's */
-#   define DES_PTR
-#   define DES_RISC1
-#   define DES_UNROLL
-#  elif defined( __ultrix )	/* Older MIPS */
-#   define DES_PTR
-#   define DES_RISC2
-#   define DES_UNROLL
-#  elif defined( __osf1__ )	/* Alpha */
-#   define DES_PTR
-#   define DES_RISC2
-#  elif defined ( _AIX )	/* RS6000 */
-  /* Unknown */
-#  elif defined( __hpux )	/* HP-PA */
-  /* Unknown */
-#  elif defined( __aux )	/* 68K */
-  /* Unknown */
-#  elif defined( __sgi )	/* Newer MIPS */
-#   define DES_PTR
-#   define DES_RISC2
-#   define DES_UNROLL
-#  elif defined(i386) || defined(__i386__)	/* x86 boxes, should be gcc */
-#   define DES_PTR
-#   define DES_RISC1
-#   define DES_UNROLL
-# endif
-
-# endif
-
-#endif
diff --git a/crypto/include/internal/rc4_conf.h.in b/crypto/include/internal/rc4_conf.h.in
deleted file mode 100644
index b5b2bd3..0000000
--- a/crypto/include/internal/rc4_conf.h.in
+++ /dev/null
@@ -1,75 +0,0 @@
-{- join(&quot;\n&quot;,map { &quot;/* $_ */&quot; } @autowarntext) -}
-/* ====================================================================
- * Copyright (c) 2016 The OpenSSL Project.  All rights reserved.
- *
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- *
- * 1. Redistributions of source code must retain the above copyright
- *    notice, this list of conditions and the following disclaimer.
- *
- * 2. Redistributions in binary form must reproduce the above copyright
- *    notice, this list of conditions and the following disclaimer in
- *    the documentation and/or other materials provided with the
- *    distribution.
- *
- * 3. All advertising materials mentioning features or use of this
- *    software must display the following acknowledgment:
- *    &quot;This product includes software developed by the OpenSSL Project
- *    for use in the OpenSSL Toolkit. (<A HREF="http://www.openssl.org/">http://www.openssl.org/</A>)&quot;
- *
- * 4. The names &quot;OpenSSL Toolkit&quot; and &quot;OpenSSL Project&quot; must not be used to
- *    endorse or promote products derived from this software without
- *    prior written permission. For written permission, please contact
- *    <A HREF="../../../mailman/listinfo/openssl-commits.html">openssl-core at openssl.org.</A>
- *
- * 5. Products derived from this software may not be called &quot;OpenSSL&quot;
- *    nor may &quot;OpenSSL&quot; appear in their names without prior written
- *    permission of the OpenSSL Project.
- *
- * 6. Redistributions of any form whatsoever must retain the following
- *    acknowledgment:
- *    &quot;This product includes software developed by the OpenSSL Project
- *    for use in the OpenSSL Toolkit (<A HREF="http://www.openssl.org/">http://www.openssl.org/</A>)&quot;
- *
- * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
- * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
- * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
- * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
- * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
- * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
- * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
- * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
- * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
- * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
- * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
- * OF THE POSSIBILITY OF SUCH DAMAGE.
- * ====================================================================
- *
- * This product includes cryptographic software written by Eric Young
- * (<A HREF="../../../mailman/listinfo/openssl-commits.html">eay at cryptsoft.com</A>).  This product includes software written by Tim
- * Hudson (<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at cryptsoft.com</A>).
- *
- */
-
-#ifndef HEADER_RC4_CONF_H
-# define HEADER_RC4_CONF_H
-
-# if !defined(RC4_CHUNK)
-/*
- * This enables code handling data aligned at natural CPU word
- * boundary. See crypto/rc4/rc4_enc.c for further details.
- */
-{-
-    $config{rc4_chunk}
-      ? &quot;#define RC4_CHUNK &quot;.$config{rc4_chunk}
-      : &quot;#undef RC4_CHUNK&quot;;
--}
-# endif
-
-/* if this is defined data[i] is used instead of *data, this is a %20
- * speedup on x86 */
-{- $config{rc4_idx} ? &quot;#define&quot; : &quot;#undef&quot; -} RC4_INDEX
-
-#endif
diff --git a/crypto/rc4/rc4_enc.c b/crypto/rc4/rc4_enc.c
index 79f00e7..e7397b4 100644
--- a/crypto/rc4/rc4_enc.c
+++ b/crypto/rc4/rc4_enc.c
@@ -78,197 +78,6 @@ void RC4(RC4_KEY *key, size_t len, const unsigned char *indata,
     y = key-&gt;y;
     d = key-&gt;data;
 
-#if defined(RC4_CHUNK) &amp;&amp; !defined(PEDANTIC)
-    /*-
-     * The original reason for implementing this(*) was the fact that
-     * pre-21164a Alpha CPUs don't have byte load/store instructions
-     * and e.g. a byte store has to be done with 64-bit load, shift,
-     * and, or and finally 64-bit store. Peaking data and operating
-     * at natural word size made it possible to reduce amount of
-     * instructions as well as to perform early read-ahead without
-     * suffering from RAW (read-after-write) hazard. This resulted
-     * in ~40%(**) performance improvement on 21064 box with gcc.
-     * But it's not only Alpha users who win here:-) Thanks to the
-     * early-n-wide read-ahead this implementation also exhibits
-     * &gt;40% speed-up on SPARC and 20-30% on 64-bit MIPS (depending
-     * on sizeof(RC4_INT)).
-     *
-     * (*)  &quot;this&quot; means code which recognizes the case when input
-     *      and output pointers appear to be aligned at natural CPU
-     *      word boundary
-     * (**) i.e. according to 'apps/openssl speed rc4' benchmark,
-     *      crypto/rc4/rc4speed.c exhibits almost 70% speed-up...
-     *
-     * Cavets.
-     *
-     * - RC4_CHUNK=&quot;unsigned long long&quot; should be a #1 choice for
-     *   UltraSPARC. Unfortunately gcc generates very slow code
-     *   (2.5-3 times slower than one generated by Sun's WorkShop
-     *   C) and therefore gcc (at least 2.95 and earlier) should
-     *   always be told that RC4_CHUNK=&quot;unsigned long&quot;.
-     *
-     *                                      &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at fy.chalmers.se</A>&gt;
-     */
-
-# define RC4_STEP       ( \
-                        x=(x+1) &amp;0xff,  \
-                        tx=d[x],        \
-                        y=(tx+y)&amp;0xff,  \
-                        ty=d[y],        \
-                        d[y]=tx,        \
-                        d[x]=ty,        \
-                        (RC4_CHUNK)d[(tx+ty)&amp;0xff]\
-                        )
-
-    if ((((size_t)indata &amp; (sizeof(RC4_CHUNK) - 1)) |
-         ((size_t)outdata &amp; (sizeof(RC4_CHUNK) - 1))) == 0) {
-        RC4_CHUNK ichunk, otp;
-        const union {
-            long one;
-            char little;
-        } is_endian = {
-            1
-        };
-
-        /*-
-         * I reckon we can afford to implement both endian
-         * cases and to decide which way to take at run-time
-         * because the machine code appears to be very compact
-         * and redundant 1-2KB is perfectly tolerable (i.e.
-         * in case the compiler fails to eliminate it:-). By
-         * suggestion from Terrel Larson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">terr at terralogic.net</A>&gt;
-         * who also stands for the is_endian union:-)
-         *
-         * Special notes.
-         *
-         * - is_endian is declared automatic as doing otherwise
-         *   (declaring static) prevents gcc from eliminating
-         *   the redundant code;
-         * - compilers (those I've tried) don't seem to have
-         *   problems eliminating either the operators guarded
-         *   by &quot;if (sizeof(RC4_CHUNK)==8)&quot; or the condition
-         *   expressions themselves so I've got 'em to replace
-         *   corresponding #ifdefs from the previous version;
-         * - I chose to let the redundant switch cases when
-         *   sizeof(RC4_CHUNK)!=8 be (were also #ifdefed
-         *   before);
-         * - in case you wonder &quot;&amp;(sizeof(RC4_CHUNK)*8-1)&quot; in
-         *   [LB]ESHFT guards against &quot;shift is out of range&quot;
-         *   warnings when sizeof(RC4_CHUNK)!=8
-         *
-         *                      &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at fy.chalmers.se</A>&gt;
-         */
-        if (!is_endian.little) { /* BIG-ENDIAN CASE */
-# define BESHFT(c)      (((sizeof(RC4_CHUNK)-(c)-1)*8)&amp;(sizeof(RC4_CHUNK)*8-1))
-            for (; len &amp; (0 - sizeof(RC4_CHUNK)); len -= sizeof(RC4_CHUNK)) {
-                ichunk = *(RC4_CHUNK *) indata;
-                otp = RC4_STEP &lt;&lt; BESHFT(0);
-                otp |= RC4_STEP &lt;&lt; BESHFT(1);
-                otp |= RC4_STEP &lt;&lt; BESHFT(2);
-                otp |= RC4_STEP &lt;&lt; BESHFT(3);
-                if (sizeof(RC4_CHUNK) == 8) {
-                    otp |= RC4_STEP &lt;&lt; BESHFT(4);
-                    otp |= RC4_STEP &lt;&lt; BESHFT(5);
-                    otp |= RC4_STEP &lt;&lt; BESHFT(6);
-                    otp |= RC4_STEP &lt;&lt; BESHFT(7);
-                }
-                *(RC4_CHUNK *) outdata = otp ^ ichunk;
-                indata += sizeof(RC4_CHUNK);
-                outdata += sizeof(RC4_CHUNK);
-            }
-            if (len) {
-                RC4_CHUNK mask = (RC4_CHUNK) - 1, ochunk;
-
-                ichunk = *(RC4_CHUNK *) indata;
-                ochunk = *(RC4_CHUNK *) outdata;
-                otp = 0;
-                i = BESHFT(0);
-                mask &lt;&lt;= (sizeof(RC4_CHUNK) - len) &lt;&lt; 3;
-                switch (len &amp; (sizeof(RC4_CHUNK) - 1)) {
-                case 7:
-                    otp = RC4_STEP &lt;&lt; i, i -= 8;
-                case 6:
-                    otp |= RC4_STEP &lt;&lt; i, i -= 8;
-                case 5:
-                    otp |= RC4_STEP &lt;&lt; i, i -= 8;
-                case 4:
-                    otp |= RC4_STEP &lt;&lt; i, i -= 8;
-                case 3:
-                    otp |= RC4_STEP &lt;&lt; i, i -= 8;
-                case 2:
-                    otp |= RC4_STEP &lt;&lt; i, i -= 8;
-                case 1:
-                    otp |= RC4_STEP &lt;&lt; i, i -= 8;
-                case 0:;       /*
-                                 * it's never the case,
-                                 * but it has to be here
-                                 * for ultrix?
-                                 */
-                }
-                ochunk &amp;= ~mask;
-                ochunk |= (otp ^ ichunk) &amp; mask;
-                *(RC4_CHUNK *) outdata = ochunk;
-            }
-            key-&gt;x = x;
-            key-&gt;y = y;
-            return;
-        } else {                /* LITTLE-ENDIAN CASE */
-# define LESHFT(c)      (((c)*8)&amp;(sizeof(RC4_CHUNK)*8-1))
-            for (; len &amp; (0 - sizeof(RC4_CHUNK)); len -= sizeof(RC4_CHUNK)) {
-                ichunk = *(RC4_CHUNK *) indata;
-                otp = RC4_STEP;
-                otp |= RC4_STEP &lt;&lt; 8;
-                otp |= RC4_STEP &lt;&lt; 16;
-                otp |= RC4_STEP &lt;&lt; 24;
-                if (sizeof(RC4_CHUNK) == 8) {
-                    otp |= RC4_STEP &lt;&lt; LESHFT(4);
-                    otp |= RC4_STEP &lt;&lt; LESHFT(5);
-                    otp |= RC4_STEP &lt;&lt; LESHFT(6);
-                    otp |= RC4_STEP &lt;&lt; LESHFT(7);
-                }
-                *(RC4_CHUNK *) outdata = otp ^ ichunk;
-                indata += sizeof(RC4_CHUNK);
-                outdata += sizeof(RC4_CHUNK);
-            }
-            if (len) {
-                RC4_CHUNK mask = (RC4_CHUNK) - 1, ochunk;
-
-                ichunk = *(RC4_CHUNK *) indata;
-                ochunk = *(RC4_CHUNK *) outdata;
-                otp = 0;
-                i = 0;
-                mask &gt;&gt;= (sizeof(RC4_CHUNK) - len) &lt;&lt; 3;
-                switch (len &amp; (sizeof(RC4_CHUNK) - 1)) {
-                case 7:
-                    otp = RC4_STEP, i += 8;
-                case 6:
-                    otp |= RC4_STEP &lt;&lt; i, i += 8;
-                case 5:
-                    otp |= RC4_STEP &lt;&lt; i, i += 8;
-                case 4:
-                    otp |= RC4_STEP &lt;&lt; i, i += 8;
-                case 3:
-                    otp |= RC4_STEP &lt;&lt; i, i += 8;
-                case 2:
-                    otp |= RC4_STEP &lt;&lt; i, i += 8;
-                case 1:
-                    otp |= RC4_STEP &lt;&lt; i, i += 8;
-                case 0:;       /*
-                                 * it's never the case,
-                                 * but it has to be here
-                                 * for ultrix?
-                                 */
-                }
-                ochunk &amp;= ~mask;
-                ochunk |= (otp ^ ichunk) &amp; mask;
-                *(RC4_CHUNK *) outdata = ochunk;
-            }
-            key-&gt;x = x;
-            key-&gt;y = y;
-            return;
-        }
-    }
-#endif
 #define LOOP(in,out) \
                 x=((x+1)&amp;0xff); \
                 tx=d[x]; \
@@ -277,27 +86,19 @@ void RC4(RC4_KEY *key, size_t len, const unsigned char *indata,
                 d[y]=tx; \
                 (out) = d[(tx+ty)&amp;0xff]^ (in);
 
-#ifndef RC4_INDEX
-# define RC4_LOOP(a,b,i) LOOP(*((a)++),*((b)++))
-#else
-# define RC4_LOOP(a,b,i) LOOP(a[i],b[i])
-#endif
-
     i = len &gt;&gt; 3;
     if (i) {
         for (;;) {
-            RC4_LOOP(indata, outdata, 0);
-            RC4_LOOP(indata, outdata, 1);
-            RC4_LOOP(indata, outdata, 2);
-            RC4_LOOP(indata, outdata, 3);
-            RC4_LOOP(indata, outdata, 4);
-            RC4_LOOP(indata, outdata, 5);
-            RC4_LOOP(indata, outdata, 6);
-            RC4_LOOP(indata, outdata, 7);
-#ifdef RC4_INDEX
+            LOOP(indata[0], outdata[0]);
+            LOOP(indata[1], outdata[1]);
+            LOOP(indata[2], outdata[2]);
+            LOOP(indata[3], outdata[3]);
+            LOOP(indata[4], outdata[4]);
+            LOOP(indata[5], outdata[5]);
+            LOOP(indata[6], outdata[6]);
+            LOOP(indata[7], outdata[7]);
             indata += 8;
             outdata += 8;
-#endif
             if (--i == 0)
                 break;
         }
@@ -305,25 +106,25 @@ void RC4(RC4_KEY *key, size_t len, const unsigned char *indata,
     i = len &amp; 0x07;
     if (i) {
         for (;;) {
-            RC4_LOOP(indata, outdata, 0);
+            LOOP(indata[0], outdata[0]);
             if (--i == 0)
                 break;
-            RC4_LOOP(indata, outdata, 1);
+            LOOP(indata[1], outdata[1]);
             if (--i == 0)
                 break;
-            RC4_LOOP(indata, outdata, 2);
+            LOOP(indata[2], outdata[2]);
             if (--i == 0)
                 break;
-            RC4_LOOP(indata, outdata, 3);
+            LOOP(indata[3], outdata[3]);
             if (--i == 0)
                 break;
-            RC4_LOOP(indata, outdata, 4);
+            LOOP(indata[4], outdata[4]);
             if (--i == 0)
                 break;
-            RC4_LOOP(indata, outdata, 5);
+            LOOP(indata[5], outdata[5]);
             if (--i == 0)
                 break;
-            RC4_LOOP(indata, outdata, 6);
+            LOOP(indata[6], outdata[6]);
             if (--i == 0)
                 break;
         }
diff --git a/crypto/rc4/rc4_locl.h b/crypto/rc4/rc4_locl.h
index 3ed48d8..3ab2570 100644
--- a/crypto/rc4/rc4_locl.h
+++ b/crypto/rc4/rc4_locl.h
@@ -1,6 +1,7 @@
 #ifndef HEADER_RC4_LOCL_H
 # define HEADER_RC4_LOCL_H
+
 # include &lt;openssl/opensslconf.h&gt;
 # include &quot;internal/cryptlib.h&quot;
-# include &quot;internal/rc4_conf.h&quot;
+
 #endif
diff --git a/crypto/rc4/rc4_skey.c b/crypto/rc4/rc4_skey.c
index 2e6cc2d..9931a61 100644
--- a/crypto/rc4/rc4_skey.c
+++ b/crypto/rc4/rc4_skey.c
@@ -61,17 +61,10 @@
 
 const char *RC4_options(void)
 {
-#ifdef RC4_INDEX
     if (sizeof(RC4_INT) == 1)
-        return (&quot;rc4(idx,char)&quot;);
+        return (&quot;rc4(char)&quot;);
     else
-        return (&quot;rc4(idx,int)&quot;);
-#else
-    if (sizeof(RC4_INT) == 1)
-        return (&quot;rc4(ptr,char)&quot;);
-    else
-        return (&quot;rc4(ptr,int)&quot;);
-#endif
+        return (&quot;rc4(int)&quot;);
 }
 
 /*-
diff --git a/include/openssl/des.h b/include/openssl/des.h
index 3d784fa..649bc79 100644
--- a/include/openssl/des.h
+++ b/include/openssl/des.h
@@ -58,14 +58,13 @@
 #ifndef HEADER_NEW_DES_H
 # define HEADER_NEW_DES_H
 
-# include &lt;openssl/e_os2.h&gt;     /* OPENSSL_EXTERN, OPENSSL_NO_DES, DES_LONG
-                                 * (via openssl/opensslconf.h */
+# include &lt;openssl/e_os2.h&gt;
 
 # ifdef OPENSSL_NO_DES
 #  error DES is disabled.
 # endif
 
-# define DES_LONG OSSL_DES_LONG
+typedef unsigned int DES_LONG;
 
 # ifdef OPENSSL_BUILD_SHLIBCRYPTO
 #  undef OPENSSL_EXTERN
diff --git a/include/openssl/idea.h b/include/openssl/idea.h
index b92d979..29b5094 100644
--- a/include/openssl/idea.h
+++ b/include/openssl/idea.h
@@ -58,12 +58,14 @@
 #ifndef HEADER_IDEA_H
 # define HEADER_IDEA_H
 
-# include &lt;openssl/opensslconf.h&gt;/* IDEA_INT, OPENSSL_NO_IDEA */
+# include &lt;openssl/opensslconf.h&gt;
 
 # ifdef OPENSSL_NO_IDEA
 #  error IDEA is disabled.
 # endif
 
+typedef unsigned int IDEA_INT;
+
 # define IDEA_ENCRYPT    1
 # define IDEA_DECRYPT    0
 
diff --git a/include/openssl/md2.h b/include/openssl/md2.h
index 4b42f7e..4104d0e 100644
--- a/include/openssl/md2.h
+++ b/include/openssl/md2.h
@@ -58,12 +58,14 @@
 #ifndef HEADER_MD2_H
 # define HEADER_MD2_H
 
-# include &lt;openssl/opensslconf.h&gt;/* OPENSSL_NO_MD2, MD2_INT */
+# include &lt;openssl/opensslconf.h&gt;
 # ifdef OPENSSL_NO_MD2
 #  error MD2 is disabled.
 # endif
 # include &lt;stddef.h&gt;
 
+typdef unsigned char MD2_INT;
+
 # define MD2_DIGEST_LENGTH       16
 # define MD2_BLOCK               16
 
diff --git a/include/openssl/opensslconf.h.in b/include/openssl/opensslconf.h.in
index 58fb20e..22dc0c9 100644
--- a/include/openssl/opensslconf.h.in
+++ b/include/openssl/opensslconf.h.in
@@ -151,8 +151,6 @@ extern &quot;C&quot; {
  * The following are cipher-specific, but are part of the public API.
  */
 
-#define OSSL_DES_LONG {- $config{des_int} -}
-
 #if !defined(OPENSSL_SYS_UEFI)
 {- $config{bn_ll} ? &quot;#define&quot; : &quot;#undef&quot; -} BN_LLONG
     
@@ -162,9 +160,6 @@ extern &quot;C&quot; {
 {- $config{b32}  ? &quot;#define&quot; : &quot;#undef&quot; -} THIRTY_TWO_BIT
 #endif
 
-# define RC2_INT {- $config{rc2_int} -}
-# define IDEA_INT {- $config{idea_int} -}
-# define MD2_INT {- $config{md2_int} -}
 # define RC4_INT {- $config{rc4_int} -}
 
 #ifdef  __cplusplus
diff --git a/include/openssl/rc2.h b/include/openssl/rc2.h
index 0a433e9..0bf6ae3 100644
--- a/include/openssl/rc2.h
+++ b/include/openssl/rc2.h
@@ -58,11 +58,13 @@
 #ifndef HEADER_RC2_H
 # define HEADER_RC2_H
 
-# include &lt;openssl/opensslconf.h&gt;/* OPENSSL_NO_RC2, RC2_INT */
+# include &lt;openssl/opensslconf.h&gt;
 # ifdef OPENSSL_NO_RC2
 #  error RC2 is disabled.
 # endif
 
+typedef unsigned int RC2_INT;
+
 # define RC2_ENCRYPT     1
 # define RC2_DECRYPT     0
 
diff --git a/makevms.com b/makevms.com
index ed0ac04..02e0cf2 100755
--- a/makevms.com
+++ b/makevms.com
@@ -580,20 +580,10 @@ $!
 $   WRITE H_FILE &quot;#if defined(HEADER_RC4_H)&quot;
 $   WRITE H_FILE &quot;#undef RC4_INT&quot;
 $   WRITE H_FILE &quot;#define RC4_INT unsigned int&quot;
-$   WRITE H_FILE &quot;#undef RC4_CHUNK&quot;
-$   WRITE H_FILE &quot;#define RC4_CHUNK unsigned long long&quot;
 $   WRITE H_FILE &quot;#endif&quot;
 $!
 $   WRITE H_FILE &quot;#if defined(HEADER_DES_LOCL_H)&quot;
-$   WRITE H_FILE &quot;#undef OSSL_DES_LONG&quot;
-$   WRITE H_FILE &quot;#define OSSL_DES_LONG unsigned int&quot;
-$   WRITE H_FILE &quot;#undef DES_PTR&quot;
-$   WRITE H_FILE &quot;#define DES_PTR&quot;
-$   WRITE H_FILE &quot;#undef DES_RISC1&quot;
-$   WRITE H_FILE &quot;#undef DES_RISC2&quot;
-$   WRITE H_FILE &quot;#define DES_RISC1&quot;
-$   WRITE H_FILE &quot;#undef DES_UNROLL&quot;
-$   WRITE H_FILE &quot;#define DES_UNROLL&quot;
+$   WRITE H_FILE &quot;typedef unsigned int OSSL_DES_LONG;&quot;
 $   WRITE H_FILE &quot;#endif&quot;
 $!
 $   WRITE H_FILE &quot;#if defined(HEADER_BN_H)&quot;
@@ -617,18 +607,10 @@ $!
 $   WRITE H_FILE &quot;#if defined(HEADER_RC4_H)&quot;
 $   WRITE H_FILE &quot;#undef RC4_INT&quot;
 $   WRITE H_FILE &quot;#define RC4_INT unsigned char&quot;
-$   WRITE H_FILE &quot;#undef RC4_CHUNK&quot;
-$   WRITE H_FILE &quot;#define RC4_CHUNK unsigned long&quot;
 $   WRITE H_FILE &quot;#endif&quot;
 $!
 $   WRITE H_FILE &quot;#if defined(HEADER_DES_LOCL_H)&quot;
-$   WRITE H_FILE &quot;#undef OSSL_DES_LONG&quot;
-$   WRITE H_FILE &quot;#define OSSL_DES_LONG unsigned long&quot;
-$   WRITE H_FILE &quot;#undef DES_PTR&quot;
-$   WRITE H_FILE &quot;#define DES_PTR&quot;
-$   WRITE H_FILE &quot;#undef DES_RISC1&quot;
-$   WRITE H_FILE &quot;#undef DES_RISC2&quot;
-$   WRITE H_FILE &quot;#undef DES_UNROLL&quot;
+$   WRITE H_FILE &quot;typedef unsigned int OSSL_DES_LONG;&quot;
 $   WRITE H_FILE &quot;#endif&quot;
 $!
 $   WRITE H_FILE &quot;#if defined(HEADER_BN_H)&quot;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003239.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="003243.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3242">[ date ]</a>
              <a href="thread.html#3242">[ thread ]</a>
              <a href="subject.html#3242">[ subject ]</a>
              <a href="author.html#3242">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
