<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2020-February/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1582316528.885956.9462.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027620.html">
   <LINK REL="Next"  HREF="027623.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl]  master update</H1>
    <B>Matt Caswell</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1582316528.885956.9462.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl]  master update">matt at openssl.org
       </A><BR>
    <I>Fri Feb 21 20:22:08 UTC 2020</I>
    <P><UL>
        <LI>Previous message: <A HREF="027620.html">[openssl]  master update
</A></li>
        <LI>Next message: <A HREF="027623.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27622">[ date ]</a>
              <a href="thread.html#27622">[ thread ]</a>
              <a href="subject.html#27622">[ subject ]</a>
              <a href="author.html#27622">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  745fc918e7eeb86b2ac541325a8ae5c6e374ee56 (commit)
      from  980a880ee5a85b94caac3049c7d3be0b765d97d3 (commit)


- Log -----------------------------------------------------------------
commit 745fc918e7eeb86b2ac541325a8ae5c6e374ee56
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Fri Feb 14 22:49:26 2020 +0000

    Introduce the provider property
    
    Replace the properties default, fips and legacy with a single property
    called &quot;provider&quot;. So, for example, instead of writing &quot;default=yes&quot; to
    get algorithms from the default provider you would instead write
    &quot;provider=default&quot;. We also have a new &quot;fips&quot; property to indicate that
    an algorithm is compatible with FIPS mode. This applies to all the
    algorithms in the FIPS provider, as well as any non-cryptographic
    algorithms (currently only serializers).
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tmraz at fedoraproject.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/11097">https://github.com/openssl/openssl/pull/11097</A>)

-----------------------------------------------------------------------

Summary of changes:
 crypto/property/property_parse.c      |   7 +-
 doc/man7/EVP_MAC-BLAKE2.pod           |   4 +-
 doc/man7/EVP_MAC-CMAC.pod             |   2 +-
 doc/man7/EVP_MAC-GMAC.pod             |   2 +-
 doc/man7/EVP_MAC-HMAC.pod             |   2 +-
 doc/man7/EVP_MAC-KMAC.pod             |   4 +-
 doc/man7/EVP_MAC-Poly1305.pod         |   2 +-
 doc/man7/EVP_MAC-Siphash.pod          |   2 +-
 doc/man7/property.pod                 |  12 +--
 doc/man7/provider.pod                 |  26 +++---
 providers/defltprov.c                 | 157 ++++++++++++++++++----------------
 providers/fips/fipsprov.c             |  60 ++++++-------
 providers/legacyprov.c                |  10 +--
 test/evp_fetch_prov_test.c            |   2 +-
 test/recipes/30-test_evp_fetch_prov.t |  68 +++++++++------
 15 files changed, 194 insertions(+), 166 deletions(-)

diff --git a/crypto/property/property_parse.c b/crypto/property/property_parse.c
index 6476f65bc7..5af67a7a0b 100644
--- a/crypto/property/property_parse.c
+++ b/crypto/property/property_parse.c
@@ -562,12 +562,9 @@ OSSL_PROPERTY_LIST *ossl_property_merge(const OSSL_PROPERTY_LIST *a,
 int ossl_property_parse_init(OPENSSL_CTX *ctx)
 {
     static const char *const predefined_names[] = {
-        &quot;default&quot;,      /* Being provided by the default built-in provider */
-        &quot;legacy&quot;,       /* Provided by the legacy provider */
-        &quot;provider&quot;,     /* Name of provider (default, fips) */
+        &quot;provider&quot;,     /* Name of provider (default, legacy, fips) */
         &quot;version&quot;,      /* Version number of this provider */
-        &quot;fips&quot;,         /* FIPS supporting provider */
-        &quot;engine&quot;,       /* An old style engine masquerading as a provider */
+        &quot;fips&quot;,         /* FIPS validated or FIPS supporting algorithm */
         &quot;format&quot;,       /* output format for serializers */
         &quot;type&quot;,         /* output type for serializers */
     };
diff --git a/doc/man7/EVP_MAC-BLAKE2.pod b/doc/man7/EVP_MAC-BLAKE2.pod
index 99b20bdc76..1a18ed7d10 100644
--- a/doc/man7/EVP_MAC-BLAKE2.pod
+++ b/doc/man7/EVP_MAC-BLAKE2.pod
@@ -16,9 +16,9 @@ properties, to be used with EVP_MAC_fetch():
 
 =over 4
 
-=item &quot;BLAKE2BMAC&quot;, &quot;default=yes&quot;
+=item &quot;BLAKE2BMAC&quot;, &quot;provider=default&quot;
 
-=item &quot;BLAKE2SMAC&quot;, &quot;default=yes&quot;
+=item &quot;BLAKE2SMAC&quot;, &quot;provider=default&quot;
 
 =back
 
diff --git a/doc/man7/EVP_MAC-CMAC.pod b/doc/man7/EVP_MAC-CMAC.pod
index af6face8a7..5e570ce854 100644
--- a/doc/man7/EVP_MAC-CMAC.pod
+++ b/doc/man7/EVP_MAC-CMAC.pod
@@ -15,7 +15,7 @@ used with EVP_MAC_fetch():
 
 =over 4
 
-=item &quot;CMAC&quot;, &quot;default=yes&quot;
+=item &quot;CMAC&quot;, &quot;provider=default&quot; or &quot;provider=fips&quot;
 
 =back
 
diff --git a/doc/man7/EVP_MAC-GMAC.pod b/doc/man7/EVP_MAC-GMAC.pod
index dbc5fb2570..3994868c04 100644
--- a/doc/man7/EVP_MAC-GMAC.pod
+++ b/doc/man7/EVP_MAC-GMAC.pod
@@ -15,7 +15,7 @@ used with EVP_MAC_fetch():
 
 =over 4
 
-=item &quot;GMAC&quot;, &quot;default=yes&quot;
+=item &quot;GMAC&quot;, &quot;provider=default&quot; or &quot;provider=fips&quot;
 
 =back
 
diff --git a/doc/man7/EVP_MAC-HMAC.pod b/doc/man7/EVP_MAC-HMAC.pod
index cc6c993b7b..452606dea1 100644
--- a/doc/man7/EVP_MAC-HMAC.pod
+++ b/doc/man7/EVP_MAC-HMAC.pod
@@ -15,7 +15,7 @@ used with EVP_MAC_fetch():
 
 =over 4
 
-=item &quot;HMAC&quot;, &quot;default=yes&quot;
+=item &quot;HMAC&quot;, &quot;provider=default&quot; or &quot;provider=fips&quot;
 
 =back
 
diff --git a/doc/man7/EVP_MAC-KMAC.pod b/doc/man7/EVP_MAC-KMAC.pod
index ac5dddfa41..5a70c0dd38 100644
--- a/doc/man7/EVP_MAC-KMAC.pod
+++ b/doc/man7/EVP_MAC-KMAC.pod
@@ -16,9 +16,9 @@ properties, to be used with EVP_MAC_fetch():
 
 =over 4
 
-=item &quot;KMAC-128&quot;, &quot;default=yes&quot;
+=item &quot;KMAC-128&quot;, &quot;provider=default&quot; or &quot;provider=fips&quot;
 
-=item &quot;KMAC-256&quot;, &quot;default=yes&quot;
+=item &quot;KMAC-256&quot;, &quot;provider=default&quot; or &quot;provider=fips&quot;
 
 =back
 
diff --git a/doc/man7/EVP_MAC-Poly1305.pod b/doc/man7/EVP_MAC-Poly1305.pod
index c54e30e141..fab5379b19 100644
--- a/doc/man7/EVP_MAC-Poly1305.pod
+++ b/doc/man7/EVP_MAC-Poly1305.pod
@@ -15,7 +15,7 @@ used with EVP_MAC_fetch():
 
 =over 4
 
-=item &quot;POLY1305&quot;, &quot;default=yes&quot;
+=item &quot;POLY1305&quot;, &quot;provider=default&quot;
 
 =back
 
diff --git a/doc/man7/EVP_MAC-Siphash.pod b/doc/man7/EVP_MAC-Siphash.pod
index 50d09c159b..4c41ca6ab2 100644
--- a/doc/man7/EVP_MAC-Siphash.pod
+++ b/doc/man7/EVP_MAC-Siphash.pod
@@ -15,7 +15,7 @@ used with EVP_MAC_fetch():
 
 =over 4
 
-=item &quot;SIPHASH&quot;, &quot;default=yes&quot;
+=item &quot;SIPHASH&quot;, &quot;provider=default&quot;
 
 =back
 
diff --git a/doc/man7/property.pod b/doc/man7/property.pod
index 5b329ee6f3..bc45afb279 100644
--- a/doc/man7/property.pod
+++ b/doc/man7/property.pod
@@ -52,15 +52,15 @@ The full syntax for property definitions appears below.
 
 Each implementation of an algorithm can define any number of
 properties.
-For example, the default provider defines the property I&lt;default=yes&gt;
+For example, the default provider defines the property I&lt;provider=default&gt;
 for all of its algorithms.
-Likewise, the FIPS provider defines I&lt;fips=yes&gt; and the legacy provider
-defines I&lt;legacy=yes&gt; for all of their algorithms.
+Likewise, OpenSSL's FIPS provider defines I&lt;provider=fips&gt; and the legacy
+provider defines I&lt;provider=legacy&gt; for all of their algorithms.
 
 =head2 Queries
 
 A I&lt;property query clause&gt; is a single conditional test.
-For example, &quot;fips=yes&quot;, &quot;default!=yes&quot; or &quot;?iteration.count!=3&quot;.
+For example, &quot;fips=yes&quot;, &quot;provider!=default&quot; or &quot;?iteration.count!=3&quot;.
 The first two represent mandatory clauses, such clauses B&lt;must&gt; match
 for any algorithm to even be under consideration.
 The third clause represents an optional clause.
@@ -117,8 +117,8 @@ Ordering of optional clauses is not significant.
 =head2 Shortcut
 
 In order to permit a more concise expression of boolean properties, there
-is one short cut: a property name alone (e.g. &quot;default&quot;) is
-exactly equivalent to &quot;default=yes&quot; in both definitions and queries.
+is one short cut: a property name alone (e.g. &quot;my.property&quot;) is
+exactly equivalent to &quot;my.property=yes&quot; in both definitions and queries.
 
 =head2 Global and Local
 
diff --git a/doc/man7/provider.pod b/doc/man7/provider.pod
index d2fef9beee..de8e2499d9 100644
--- a/doc/man7/provider.pod
+++ b/doc/man7/provider.pod
@@ -260,8 +260,12 @@ algorithm identifier to the appropriate fetching function.
 
 The default provider is built in as part of the F&lt;libcrypto&gt; library.
 Should it be needed (if other providers are loaded and offer
-implementations of the same algorithms), the property &quot;default=yes&quot;
-can be used as a search criterion for these implementations.
+implementations of the same algorithms), the property &quot;provider=default&quot;
+can be used as a search criterion for these implementations. Some
+non-cryptographic algorithms (such as serializers for loading keys and
+parameters from files) are not FIPS algorithm implementations in themselves but
+support algorithms from the FIPS provider and are allowed for use in &quot;FIPS
+mode&quot;. The property &quot;fips=yes&quot; can be used to select such algorithms.
 
 =head2 FIPS provider
 
@@ -269,8 +273,10 @@ The FIPS provider is a dynamically loadable module, and must therefore
 be loaded explicitly, either in code or through OpenSSL configuration
 (see L&lt;config(5)&gt;).
 Should it be needed (if other providers are loaded and offer
-implementations of the same algorithms), the property &quot;fips=yes&quot; can
-be used as a search criterion for these implementations.
+implementations of the same algorithms), the property &quot;provider=fips&quot; can
+be used as a search criterion for these implementations. All algorithm
+implementations in the FIPS provider can also be selected with the property
+&quot;fips=yes&quot;.
 
 =head2 Legacy provider
 
@@ -278,7 +284,7 @@ The legacy provider is a dynamically loadable module, and must therefore
 be loaded explicitly, either in code or through OpenSSL configuration
 (see L&lt;config(5)&gt;).
 Should it be needed (if other providers are loaded and offer
-implementations of the same algorithms), the property &quot;legacy=yes&quot; can be
+implementations of the same algorithms), the property &quot;provider=legacy&quot; can be
 used as a search criterion for these implementations.
 
 =head1 EXAMPLES
@@ -300,21 +306,21 @@ Fetch any available implementation of AES-128-CBC in the default context:
 Fetch an implementation of SHA2-256 from the default provider in the default
 context:
 
- EVP_MD *md = EVP_MD_fetch(NULL, &quot;SHA2-256&quot;, &quot;default=yes&quot;);
+ EVP_MD *md = EVP_MD_fetch(NULL, &quot;SHA2-256&quot;, &quot;provider=default&quot;);
  ...
  EVP_MD_meth_free(md);
 
 Fetch an implementation of SHA2-256 that is not from the default provider in the
 default context:
 
- EVP_MD *md = EVP_MD_fetch(NULL, &quot;SHA2-256&quot;, &quot;default=no&quot;);
+ EVP_MD *md = EVP_MD_fetch(NULL, &quot;SHA2-256&quot;, &quot;provider!=default&quot;);
  ...
  EVP_MD_meth_free(md);
 
 Fetch an implementation of SHA2-256 from the default provider in the specified
 context:
 
- EVP_MD *md = EVP_MD_fetch(ctx, &quot;SHA2-256&quot;, &quot;default=yes&quot;);
+ EVP_MD *md = EVP_MD_fetch(ctx, &quot;SHA2-256&quot;, &quot;provider=default&quot;);
  ...
  EVP_MD_meth_free(md);
 
@@ -324,11 +330,11 @@ implementation of WHIRLPOOL from it:
  /* This only needs to be done once - usually at application start up */
  OSSL_PROVIDER *legacy = OSSL_PROVIDER_load(NULL, &quot;legacy&quot;);
 
- EVP_MD *md = EVP_MD_fetch(NULL, &quot;WHIRLPOOL&quot;, &quot;legacy=yes&quot;);
+ EVP_MD *md = EVP_MD_fetch(NULL, &quot;WHIRLPOOL&quot;, &quot;provider=legacy&quot;);
  ...
  EVP_MD_meth_free(md);
 
-Note that in the above example the property string &quot;legacy=yes&quot; is optional
+Note that in the above example the property string &quot;provider=legacy&quot; is optional
 since, assuming no other providers have been loaded, the only implementation of
 the &quot;whirlpool&quot; algorithm is in the &quot;legacy&quot; provider. Also note that the
 default provider should be explicitly loaded if it is required in addition to
diff --git a/providers/defltprov.c b/providers/defltprov.c
index 3819c61659..0b2390a291 100644
--- a/providers/defltprov.c
+++ b/providers/defltprov.c
@@ -20,7 +20,7 @@
 #include &quot;prov/provider_util.h&quot;
 #include &quot;internal/nelem.h&quot;
 
-#define ALGC(NAMES, FUNC, CHECK) { { NAMES, &quot;default=yes&quot;, FUNC }, CHECK }
+#define ALGC(NAMES, FUNC, CHECK) { { NAMES, &quot;provider=default&quot;, FUNC }, CHECK }
 #define ALG(NAMES, FUNC) ALGC(NAMES, FUNC, NULL)
 
 /* Functions provided by the core */
@@ -86,32 +86,32 @@ static int deflt_get_params(const OSSL_PROVIDER *prov, OSSL_PARAM params[])
  */
 static const OSSL_ALGORITHM deflt_digests[] = {
     /* Our primary name:NIST name[:our older names] */
-    { &quot;SHA1:SHA-1&quot;, &quot;default=yes&quot;, sha1_functions },
-    { &quot;SHA2-224:SHA-224:SHA224&quot;, &quot;default=yes&quot;, sha224_functions },
-    { &quot;SHA2-256:SHA-256:SHA256&quot;, &quot;default=yes&quot;, sha256_functions },
-    { &quot;SHA2-384:SHA-384:SHA384&quot;, &quot;default=yes&quot;, sha384_functions },
-    { &quot;SHA2-512:SHA-512:SHA512&quot;, &quot;default=yes&quot;, sha512_functions },
-    { &quot;SHA2-512/224:SHA-512/224:SHA512-224&quot;, &quot;default=yes&quot;,
+    { &quot;SHA1:SHA-1&quot;, &quot;provider=default&quot;, sha1_functions },
+    { &quot;SHA2-224:SHA-224:SHA224&quot;, &quot;provider=default&quot;, sha224_functions },
+    { &quot;SHA2-256:SHA-256:SHA256&quot;, &quot;provider=default&quot;, sha256_functions },
+    { &quot;SHA2-384:SHA-384:SHA384&quot;, &quot;provider=default&quot;, sha384_functions },
+    { &quot;SHA2-512:SHA-512:SHA512&quot;, &quot;provider=default&quot;, sha512_functions },
+    { &quot;SHA2-512/224:SHA-512/224:SHA512-224&quot;, &quot;provider=default&quot;,
       sha512_224_functions },
-    { &quot;SHA2-512/256:SHA-512/256:SHA512-256&quot;, &quot;default=yes&quot;,
+    { &quot;SHA2-512/256:SHA-512/256:SHA512-256&quot;, &quot;provider=default&quot;,
       sha512_256_functions },
 
     /* We agree with NIST here, so one name only */
-    { &quot;SHA3-224&quot;, &quot;default=yes&quot;, sha3_224_functions },
-    { &quot;SHA3-256&quot;, &quot;default=yes&quot;, sha3_256_functions },
-    { &quot;SHA3-384&quot;, &quot;default=yes&quot;, sha3_384_functions },
-    { &quot;SHA3-512&quot;, &quot;default=yes&quot;, sha3_512_functions },
+    { &quot;SHA3-224&quot;, &quot;provider=default&quot;, sha3_224_functions },
+    { &quot;SHA3-256&quot;, &quot;provider=default&quot;, sha3_256_functions },
+    { &quot;SHA3-384&quot;, &quot;provider=default&quot;, sha3_384_functions },
+    { &quot;SHA3-512&quot;, &quot;provider=default&quot;, sha3_512_functions },
 
     /*
      * KECCAK-KMAC-128 and KECCAK-KMAC-256 as hashes are mostly useful for
      * the KMAC-128 and KMAC-256.
      */
-    { &quot;KECCAK-KMAC-128:KECCAK-KMAC128&quot;, &quot;default=yes&quot;, keccak_kmac_128_functions },
-    { &quot;KECCAK-KMAC-256:KECCAK-KMAC256&quot;, &quot;default=yes&quot;, keccak_kmac_256_functions },
+    { &quot;KECCAK-KMAC-128:KECCAK-KMAC128&quot;, &quot;provider=default&quot;, keccak_kmac_128_functions },
+    { &quot;KECCAK-KMAC-256:KECCAK-KMAC256&quot;, &quot;provider=default&quot;, keccak_kmac_256_functions },
 
     /* Our primary name:NIST name */
-    { &quot;SHAKE-128:SHAKE128&quot;, &quot;default=yes&quot;, shake_128_functions },
-    { &quot;SHAKE-256:SHAKE256&quot;, &quot;default=yes&quot;, shake_256_functions },
+    { &quot;SHAKE-128:SHAKE128&quot;, &quot;provider=default&quot;, shake_128_functions },
+    { &quot;SHAKE-256:SHAKE256&quot;, &quot;provider=default&quot;, shake_256_functions },
 
 #ifndef OPENSSL_NO_BLAKE2
     /*
@@ -121,17 +121,17 @@ static const OSSL_ALGORITHM deflt_digests[] = {
      * If we assume that &quot;2b&quot; and &quot;2s&quot; are versions, that pattern
      * fits with ours.  We also add our historical names.
      */
-    { &quot;BLAKE2S-256:BLAKE2s256&quot;, &quot;default=yes&quot;, blake2s256_functions },
-    { &quot;BLAKE2B-512:BLAKE2b512&quot;, &quot;default=yes&quot;, blake2b512_functions },
+    { &quot;BLAKE2S-256:BLAKE2s256&quot;, &quot;provider=default&quot;, blake2s256_functions },
+    { &quot;BLAKE2B-512:BLAKE2b512&quot;, &quot;provider=default&quot;, blake2b512_functions },
 #endif /* OPENSSL_NO_BLAKE2 */
 
 #ifndef OPENSSL_NO_SM3
-    { &quot;SM3&quot;, &quot;default=yes&quot;, sm3_functions },
+    { &quot;SM3&quot;, &quot;provider=default&quot;, sm3_functions },
 #endif /* OPENSSL_NO_SM3 */
 
 #ifndef OPENSSL_NO_MD5
-    { &quot;MD5&quot;, &quot;default=yes&quot;, md5_functions },
-    { &quot;MD5-SHA1&quot;, &quot;default=yes&quot;, md5_sha1_functions },
+    { &quot;MD5&quot;, &quot;provider=default&quot;, md5_functions },
+    { &quot;MD5-SHA1&quot;, &quot;provider=default&quot;, md5_sha1_functions },
 #endif /* OPENSSL_NO_MD5 */
 
     { NULL, NULL, NULL }
@@ -331,136 +331,141 @@ static OSSL_ALGORITHM exported_ciphers[OSSL_NELEM(deflt_ciphers)];
 
 static const OSSL_ALGORITHM deflt_macs[] = {
 #ifndef OPENSSL_NO_BLAKE2
-    { &quot;BLAKE2BMAC&quot;, &quot;default=yes&quot;, blake2bmac_functions },
-    { &quot;BLAKE2SMAC&quot;, &quot;default=yes&quot;, blake2smac_functions },
+    { &quot;BLAKE2BMAC&quot;, &quot;provider=default&quot;, blake2bmac_functions },
+    { &quot;BLAKE2SMAC&quot;, &quot;provider=default&quot;, blake2smac_functions },
 #endif
 #ifndef OPENSSL_NO_CMAC
-    { &quot;CMAC&quot;, &quot;default=yes&quot;, cmac_functions },
+    { &quot;CMAC&quot;, &quot;provider=default&quot;, cmac_functions },
 #endif
-    { &quot;GMAC&quot;, &quot;default=yes&quot;, gmac_functions },
-    { &quot;HMAC&quot;, &quot;default=yes&quot;, hmac_functions },
-    { &quot;KMAC-128:KMAC128&quot;, &quot;default=yes&quot;, kmac128_functions },
-    { &quot;KMAC-256:KMAC256&quot;, &quot;default=yes&quot;, kmac256_functions },
+    { &quot;GMAC&quot;, &quot;provider=default&quot;, gmac_functions },
+    { &quot;HMAC&quot;, &quot;provider=default&quot;, hmac_functions },
+    { &quot;KMAC-128:KMAC128&quot;, &quot;provider=default&quot;, kmac128_functions },
+    { &quot;KMAC-256:KMAC256&quot;, &quot;provider=default&quot;, kmac256_functions },
 #ifndef OPENSSL_NO_SIPHASH
-    { &quot;SIPHASH&quot;, &quot;default=yes&quot;, siphash_functions },
+    { &quot;SIPHASH&quot;, &quot;provider=default&quot;, siphash_functions },
 #endif
 #ifndef OPENSSL_NO_POLY1305
-    { &quot;POLY1305&quot;, &quot;default=yes&quot;, poly1305_functions },
+    { &quot;POLY1305&quot;, &quot;provider=default&quot;, poly1305_functions },
 #endif
     { NULL, NULL, NULL }
 };
 
 static const OSSL_ALGORITHM deflt_kdfs[] = {
-    { &quot;HKDF&quot;, &quot;default=yes&quot;, kdf_hkdf_functions },
-    { &quot;SSKDF&quot;, &quot;default=yes&quot;, kdf_sskdf_functions },
-    { &quot;PBKDF2&quot;, &quot;default=yes&quot;, kdf_pbkdf2_functions },
-    { &quot;SSHKDF&quot;, &quot;default=yes&quot;, kdf_sshkdf_functions },
-    { &quot;X963KDF&quot;, &quot;default=yes&quot;, kdf_x963_kdf_functions },
-    { &quot;TLS1-PRF&quot;, &quot;default=yes&quot;, kdf_tls1_prf_functions },
-    { &quot;KBKDF&quot;, &quot;default=yes&quot;, kdf_kbkdf_functions },
+    { &quot;HKDF&quot;, &quot;provider=default&quot;, kdf_hkdf_functions },
+    { &quot;SSKDF&quot;, &quot;provider=default&quot;, kdf_sskdf_functions },
+    { &quot;PBKDF2&quot;, &quot;provider=default&quot;, kdf_pbkdf2_functions },
+    { &quot;SSHKDF&quot;, &quot;provider=default&quot;, kdf_sshkdf_functions },
+    { &quot;X963KDF&quot;, &quot;provider=default&quot;, kdf_x963_kdf_functions },
+    { &quot;TLS1-PRF&quot;, &quot;provider=default&quot;, kdf_tls1_prf_functions },
+    { &quot;KBKDF&quot;, &quot;provider=default&quot;, kdf_kbkdf_functions },
 #ifndef OPENSSL_NO_CMS
-    { &quot;X942KDF&quot;, &quot;default=yes&quot;, kdf_x942_kdf_functions },
+    { &quot;X942KDF&quot;, &quot;provider=default&quot;, kdf_x942_kdf_functions },
 #endif
 #ifndef OPENSSL_NO_SCRYPT
-    { &quot;SCRYPT:id-scrypt&quot;, &quot;default=yes&quot;, kdf_scrypt_functions },
+    { &quot;SCRYPT:id-scrypt&quot;, &quot;provider=default&quot;, kdf_scrypt_functions },
 #endif
-    { &quot;KRB5KDF&quot;, &quot;default=yes&quot;, kdf_krb5kdf_functions },
+    { &quot;KRB5KDF&quot;, &quot;provider=default&quot;, kdf_krb5kdf_functions },
     { NULL, NULL, NULL }
 };
 
 static const OSSL_ALGORITHM deflt_keyexch[] = {
 #ifndef OPENSSL_NO_DH
-    { &quot;DH:dhKeyAgreement&quot;, &quot;default=yes&quot;, dh_keyexch_functions },
+    { &quot;DH:dhKeyAgreement&quot;, &quot;provider=default&quot;, dh_keyexch_functions },
 #endif
 #ifndef OPENSSL_NO_EC
-    { &quot;ECDH:id-ecPublicKey&quot;, &quot;default=yes&quot;, ecdh_keyexch_functions },
-    { &quot;X25519&quot;, &quot;default=yes&quot;, x25519_keyexch_functions },
-    { &quot;X448&quot;, &quot;default=yes&quot;, x448_keyexch_functions },
+    { &quot;ECDH:id-ecPublicKey&quot;, &quot;provider=default&quot;, ecdh_keyexch_functions },
+    { &quot;X25519&quot;, &quot;provider=default&quot;, x25519_keyexch_functions },
+    { &quot;X448&quot;, &quot;provider=default&quot;, x448_keyexch_functions },
 #endif
     { NULL, NULL, NULL }
 };
 
 static const OSSL_ALGORITHM deflt_signature[] = {
 #ifndef OPENSSL_NO_DSA
-    { &quot;DSA:dsaEncryption&quot;, &quot;default=yes&quot;, dsa_signature_functions },
+    { &quot;DSA:dsaEncryption&quot;, &quot;provider=default&quot;, dsa_signature_functions },
 #endif
     { NULL, NULL, NULL }
 };
 
 static const OSSL_ALGORITHM deflt_asym_cipher[] = {
-    { &quot;RSA:rsaEncryption&quot;, &quot;default=yes&quot;, rsa_asym_cipher_functions },
+    { &quot;RSA:rsaEncryption&quot;, &quot;provider=default&quot;, rsa_asym_cipher_functions },
     { NULL, NULL, NULL }
 };
 
 static const OSSL_ALGORITHM deflt_keymgmt[] = {
 #ifndef OPENSSL_NO_DH
-    { &quot;DH:dhKeyAgreement&quot;, &quot;default=yes&quot;, dh_keymgmt_functions },
+    { &quot;DH:dhKeyAgreement&quot;, &quot;provider=default&quot;, dh_keymgmt_functions },
 #endif
 #ifndef OPENSSL_NO_DSA
-    { &quot;DSA:dsaEncryption&quot;, &quot;default=yes&quot;, dsa_keymgmt_functions },
+    { &quot;DSA:dsaEncryption&quot;, &quot;provider=default&quot;, dsa_keymgmt_functions },
 #endif
-    { &quot;RSA:rsaEncryption&quot;, &quot;default=yes&quot;, rsa_keymgmt_functions },
+    { &quot;RSA:rsaEncryption&quot;, &quot;provider=default&quot;, rsa_keymgmt_functions },
 #ifndef OPENSSL_NO_EC
-    { &quot;EC:id-ecPublicKey&quot;, &quot;default=yes&quot;, ec_keymgmt_functions },
-    { &quot;X25519&quot;, &quot;default=yes&quot;, x25519_keymgmt_functions },
-    { &quot;X448&quot;, &quot;default=yes&quot;, x448_keymgmt_functions },
+    { &quot;EC:id-ecPublicKey&quot;, &quot;provider=default&quot;, ec_keymgmt_functions },
+    { &quot;X25519&quot;, &quot;provider=default&quot;, x25519_keymgmt_functions },
+    { &quot;X448&quot;, &quot;provider=default&quot;, x448_keymgmt_functions },
 #endif
     { NULL, NULL, NULL }
 };
 
+/*
+ * Unlike most algorithms in the default provider, the serializers are allowed
+ * for use in FIPS mode because they are not FIPS relevant, and therefore have
+ * the &quot;fips=yes&quot; property.
+ */
 static const OSSL_ALGORITHM deflt_serializer[] = {
-    { &quot;RSA&quot;, &quot;default=yes,format=text,type=private&quot;,
+    { &quot;RSA&quot;, &quot;provider=default,fips=yes,format=text,type=private&quot;,
       rsa_priv_text_serializer_functions },
-    { &quot;RSA&quot;, &quot;default=yes,format=text,type=public&quot;,
+    { &quot;RSA&quot;, &quot;provider=default,fips=yes,format=text,type=public&quot;,
       rsa_pub_text_serializer_functions },
-    { &quot;RSA&quot;, &quot;default=yes,format=der,type=private&quot;,
+    { &quot;RSA&quot;, &quot;provider=default,fips=yes,format=der,type=private&quot;,
       rsa_priv_der_serializer_functions },
-    { &quot;RSA&quot;, &quot;default=yes,format=der,type=public&quot;,
+    { &quot;RSA&quot;, &quot;provider=default,fips=yes,format=der,type=public&quot;,
       rsa_pub_der_serializer_functions },
-    { &quot;RSA&quot;, &quot;default=yes,format=pem,type=private&quot;,
+    { &quot;RSA&quot;, &quot;provider=default,fips=yes,format=pem,type=private&quot;,
       rsa_priv_pem_serializer_functions },
-    { &quot;RSA&quot;, &quot;default=yes,format=pem,type=public&quot;,
+    { &quot;RSA&quot;, &quot;provider=default,fips=yes,format=pem,type=public&quot;,
       rsa_pub_pem_serializer_functions },
 
 #ifndef OPENSSL_NO_DH
-    { &quot;DH&quot;, &quot;default=yes,format=text,type=private&quot;,
+    { &quot;DH&quot;, &quot;provider=default,fips=yes,format=text,type=private&quot;,
       dh_priv_text_serializer_functions },
-    { &quot;DH&quot;, &quot;default=yes,format=text,type=public&quot;,
+    { &quot;DH&quot;, &quot;provider=default,fips=yes,format=text,type=public&quot;,
       dh_pub_text_serializer_functions },
-    { &quot;DH&quot;, &quot;default=yes,format=text,type=parameters&quot;,
+    { &quot;DH&quot;, &quot;provider=default,fips=yes,format=text,type=parameters&quot;,
       dh_param_text_serializer_functions },
-    { &quot;DH&quot;, &quot;default=yes,format=der,type=private&quot;,
+    { &quot;DH&quot;, &quot;provider=default,fips=yes,format=der,type=private&quot;,
       dh_priv_der_serializer_functions },
-    { &quot;DH&quot;, &quot;default=yes,format=der,type=public&quot;,
+    { &quot;DH&quot;, &quot;provider=default,fips=yes,format=der,type=public&quot;,
       dh_pub_der_serializer_functions },
-    { &quot;DH&quot;, &quot;default=yes,format=der,type=parameters&quot;,
+    { &quot;DH&quot;, &quot;provider=default,fips=yes,format=der,type=parameters&quot;,
       dh_param_der_serializer_functions },
-    { &quot;DH&quot;, &quot;default=yes,format=pem,type=private&quot;,
+    { &quot;DH&quot;, &quot;provider=default,fips=yes,format=pem,type=private&quot;,
       dh_priv_pem_serializer_functions },
-    { &quot;DH&quot;, &quot;default=yes,format=pem,type=public&quot;,
+    { &quot;DH&quot;, &quot;provider=default,fips=yes,format=pem,type=public&quot;,
       dh_pub_pem_serializer_functions },
-    { &quot;DH&quot;, &quot;default=yes,format=pem,type=parameters&quot;,
+    { &quot;DH&quot;, &quot;provider=default,fips=yes,format=pem,type=parameters&quot;,
       dh_param_pem_serializer_functions },
 #endif
 
 #ifndef OPENSSL_NO_DSA
-    { &quot;DSA&quot;, &quot;default=yes,format=text,type=private&quot;,
+    { &quot;DSA&quot;, &quot;provider=default,fips=yes,format=text,type=private&quot;,
       dsa_priv_text_serializer_functions },
-    { &quot;DSA&quot;, &quot;default=yes,format=text,type=public&quot;,
+    { &quot;DSA&quot;, &quot;provider=default,fips=yes,format=text,type=public&quot;,
       dsa_pub_text_serializer_functions },
-    { &quot;DSA&quot;, &quot;default=yes,format=text,type=parameters&quot;,
+    { &quot;DSA&quot;, &quot;provider=default,fips=yes,format=text,type=parameters&quot;,
       dsa_param_text_serializer_functions },
-    { &quot;DSA&quot;, &quot;default=yes,format=der,type=private&quot;,
+    { &quot;DSA&quot;, &quot;provider=default,fips=yes,format=der,type=private&quot;,
       dsa_priv_der_serializer_functions },
-    { &quot;DSA&quot;, &quot;default=yes,format=der,type=public&quot;,
+    { &quot;DSA&quot;, &quot;provider=default,fips=yes,format=der,type=public&quot;,
       dsa_pub_der_serializer_functions },
-    { &quot;DSA&quot;, &quot;default=yes,format=der,type=parameters&quot;,
+    { &quot;DSA&quot;, &quot;provider=default,fips=yes,format=der,type=parameters&quot;,
       dsa_param_der_serializer_functions },
-    { &quot;DSA&quot;, &quot;default=yes,format=pem,type=private&quot;,
+    { &quot;DSA&quot;, &quot;provider=default,fips=yes,format=pem,type=private&quot;,
       dsa_priv_pem_serializer_functions },
-    { &quot;DSA&quot;, &quot;default=yes,format=pem,type=public&quot;,
+    { &quot;DSA&quot;, &quot;provider=default,fips=yes,format=pem,type=public&quot;,
       dsa_pub_pem_serializer_functions },
-    { &quot;DSA&quot;, &quot;default=yes,format=pem,type=parameters&quot;,
+    { &quot;DSA&quot;, &quot;provider=default,fips=yes,format=pem,type=parameters&quot;,
       dsa_param_pem_serializer_functions },
 #endif
 
diff --git a/providers/fips/fipsprov.c b/providers/fips/fipsprov.c
index 596ece5235..0ff0408a26 100644
--- a/providers/fips/fipsprov.c
+++ b/providers/fips/fipsprov.c
@@ -34,7 +34,7 @@
 #include &quot;prov/provider_util.h&quot;
 #include &quot;self_test.h&quot;
 
-#define ALGC(NAMES, FUNC, CHECK) { { NAMES, &quot;fips=yes&quot;, FUNC }, CHECK }
+#define ALGC(NAMES, FUNC, CHECK) { { NAMES, &quot;provider=fips,fips=yes&quot;, FUNC }, CHECK }
 #define ALG(NAMES, FUNC) ALGC(NAMES, FUNC, NULL)
 
 extern OSSL_core_thread_start_fn *c_thread_start;
@@ -702,27 +702,27 @@ const char *ossl_prov_util_nid_to_name(int nid)
  */
 static const OSSL_ALGORITHM fips_digests[] = {
     /* Our primary name:NiST name[:our older names] */
-    { &quot;SHA1:SHA-1&quot;, &quot;fips=yes&quot;, sha1_functions },
-    { &quot;SHA2-224:SHA-224:SHA224&quot;, &quot;fips=yes&quot;, sha224_functions },
-    { &quot;SHA2-256:SHA-256:SHA256&quot;, &quot;fips=yes&quot;, sha256_functions },
-    { &quot;SHA2-384:SHA-384:SHA384&quot;, &quot;fips=yes&quot;, sha384_functions },
-    { &quot;SHA2-512:SHA-512:SHA512&quot;, &quot;fips=yes&quot;, sha512_functions },
-    { &quot;SHA2-512/224:SHA-512/224:SHA512-224&quot;, &quot;fips=yes&quot;,
+    { &quot;SHA1:SHA-1&quot;, &quot;provider=fips,fips=yes&quot;, sha1_functions },
+    { &quot;SHA2-224:SHA-224:SHA224&quot;, &quot;provider=fips,fips=yes&quot;, sha224_functions },
+    { &quot;SHA2-256:SHA-256:SHA256&quot;, &quot;provider=fips,fips=yes&quot;, sha256_functions },
+    { &quot;SHA2-384:SHA-384:SHA384&quot;, &quot;provider=fips,fips=yes&quot;, sha384_functions },
+    { &quot;SHA2-512:SHA-512:SHA512&quot;, &quot;provider=fips,fips=yes&quot;, sha512_functions },
+    { &quot;SHA2-512/224:SHA-512/224:SHA512-224&quot;, &quot;provider=fips,fips=yes&quot;,
       sha512_224_functions },
-    { &quot;SHA2-512/256:SHA-512/256:SHA512-256&quot;, &quot;fips=yes&quot;,
+    { &quot;SHA2-512/256:SHA-512/256:SHA512-256&quot;, &quot;provider=fips,fips=yes&quot;,
       sha512_256_functions },
 
     /* We agree with NIST here, so one name only */
-    { &quot;SHA3-224&quot;, &quot;fips=yes&quot;, sha3_224_functions },
-    { &quot;SHA3-256&quot;, &quot;fips=yes&quot;, sha3_256_functions },
-    { &quot;SHA3-384&quot;, &quot;fips=yes&quot;, sha3_384_functions },
-    { &quot;SHA3-512&quot;, &quot;fips=yes&quot;, sha3_512_functions },
+    { &quot;SHA3-224&quot;, &quot;provider=fips,fips=yes&quot;, sha3_224_functions },
+    { &quot;SHA3-256&quot;, &quot;provider=fips,fips=yes&quot;, sha3_256_functions },
+    { &quot;SHA3-384&quot;, &quot;provider=fips,fips=yes&quot;, sha3_384_functions },
+    { &quot;SHA3-512&quot;, &quot;provider=fips,fips=yes&quot;, sha3_512_functions },
     /*
      * KECCAK-KMAC-128 and KECCAK-KMAC-256 as hashes are mostly useful for
      * KMAC128 and KMAC256.
      */
-    { &quot;KECCAK-KMAC-128:KECCAK-KMAC128&quot;, &quot;fips=yes&quot;, keccak_kmac_128_functions },
-    { &quot;KECCAK-KMAC-256:KECCAK-KMAC256&quot;, &quot;fips=yes&quot;, keccak_kmac_256_functions },
+    { &quot;KECCAK-KMAC-128:KECCAK-KMAC128&quot;, &quot;provider=fips,fips=yes&quot;, keccak_kmac_128_functions },
+    { &quot;KECCAK-KMAC-256:KECCAK-KMAC256&quot;, &quot;provider=fips,fips=yes&quot;, keccak_kmac_256_functions },
 
     { NULL, NULL, NULL }
 };
@@ -773,51 +773,51 @@ static OSSL_ALGORITHM exported_fips_ciphers[OSSL_NELEM(fips_ciphers)];
 
 static const OSSL_ALGORITHM fips_macs[] = {
 #ifndef OPENSSL_NO_CMAC
-    { &quot;CMAC&quot;, &quot;fips=yes&quot;, cmac_functions },
+    { &quot;CMAC&quot;, &quot;provider=fips,fips=yes&quot;, cmac_functions },
 #endif
-    { &quot;GMAC&quot;, &quot;fips=yes&quot;, gmac_functions },
-    { &quot;HMAC&quot;, &quot;fips=yes&quot;, hmac_functions },
-    { &quot;KMAC-128:KMAC128&quot;, &quot;fips=yes&quot;, kmac128_functions },
-    { &quot;KMAC-256:KMAC256&quot;, &quot;fips=yes&quot;, kmac256_functions },
+    { &quot;GMAC&quot;, &quot;provider=fips,fips=yes&quot;, gmac_functions },
+    { &quot;HMAC&quot;, &quot;provider=fips,fips=yes&quot;, hmac_functions },
+    { &quot;KMAC-128:KMAC128&quot;, &quot;provider=fips,fips=yes&quot;, kmac128_functions },
+    { &quot;KMAC-256:KMAC256&quot;, &quot;provider=fips,fips=yes&quot;, kmac256_functions },
     { NULL, NULL, NULL }
 };
 
 static const OSSL_ALGORITHM fips_kdfs[] = {
-    { &quot;HKDF&quot;, &quot;fips=yes&quot;, kdf_hkdf_functions },
-    { &quot;SSKDF&quot;, &quot;fips=yes&quot;, kdf_sskdf_functions },
-    { &quot;PBKDF2&quot;, &quot;fips=yes&quot;, kdf_pbkdf2_functions },
-    { &quot;TLS1-PRF&quot;, &quot;fips=yes&quot;, kdf_tls1_prf_functions },
-    { &quot;KBKDF&quot;, &quot;fips=yes&quot;, kdf_kbkdf_functions },
+    { &quot;HKDF&quot;, &quot;provider=fips,fips=yes&quot;, kdf_hkdf_functions },
+    { &quot;SSKDF&quot;, &quot;provider=fips,fips=yes&quot;, kdf_sskdf_functions },
+    { &quot;PBKDF2&quot;, &quot;provider=fips,fips=yes&quot;, kdf_pbkdf2_functions },
+    { &quot;TLS1-PRF&quot;, &quot;provider=fips,fips=yes&quot;, kdf_tls1_prf_functions },
+    { &quot;KBKDF&quot;, &quot;provider=fips,fips=yes&quot;, kdf_kbkdf_functions },
     { NULL, NULL, NULL }
 };
 
 static const OSSL_ALGORITHM fips_keyexch[] = {
 #ifndef OPENSSL_NO_DH
-    { &quot;DH:dhKeyAgreement&quot;, &quot;fips=yes&quot;, dh_keyexch_functions },
+    { &quot;DH:dhKeyAgreement&quot;, &quot;provider=fips,fips=yes&quot;, dh_keyexch_functions },
 #endif
     { NULL, NULL, NULL }
 };
 
 static const OSSL_ALGORITHM fips_signature[] = {
 #ifndef OPENSSL_NO_DSA
-    { &quot;DSA:dsaEncryption&quot;, &quot;fips=yes&quot;, dsa_signature_functions },
+    { &quot;DSA:dsaEncryption&quot;, &quot;provider=fips,fips=yes&quot;, dsa_signature_functions },
 #endif
     { NULL, NULL, NULL }
 };
 
 static const OSSL_ALGORITHM fips_asym_cipher[] = {
-    { &quot;RSA:rsaEncryption&quot;, &quot;fips=yes&quot;, rsa_asym_cipher_functions },
+    { &quot;RSA:rsaEncryption&quot;, &quot;provider=fips,fips=yes&quot;, rsa_asym_cipher_functions },
     { NULL, NULL, NULL }
 };
 
 static const OSSL_ALGORITHM fips_keymgmt[] = {
 #ifndef OPENSSL_NO_DH
-    { &quot;DH:dhKeyAgreement&quot;, &quot;fips=yes&quot;, dh_keymgmt_functions },
+    { &quot;DH:dhKeyAgreement&quot;, &quot;provider=fips,fips=yes&quot;, dh_keymgmt_functions },
 #endif
 #ifndef OPENSSL_NO_DSA
-    { &quot;DSA&quot;, &quot;fips=yes&quot;, dsa_keymgmt_functions },
+    { &quot;DSA&quot;, &quot;provider=fips,fips=yes&quot;, dsa_keymgmt_functions },
 #endif
-    { &quot;RSA:rsaEncryption&quot;, &quot;default=yes&quot;, rsa_keymgmt_functions },
+    { &quot;RSA:rsaEncryption&quot;, &quot;provider=fips,fips=yes&quot;, rsa_keymgmt_functions },
     { NULL, NULL, NULL }
 };
 
diff --git a/providers/legacyprov.c b/providers/legacyprov.c
index 5937328638..3494a8801c 100644
--- a/providers/legacyprov.c
+++ b/providers/legacyprov.c
@@ -56,23 +56,23 @@ static int legacy_get_params(const OSSL_PROVIDER *prov, OSSL_PARAM params[])
 
 static const OSSL_ALGORITHM legacy_digests[] = {
 #ifndef OPENSSL_NO_MD2
-    { &quot;MD2&quot;, &quot;legacy=yes&quot;, md2_functions },
+    { &quot;MD2&quot;, &quot;provider=legacy&quot;, md2_functions },
 #endif
 
 #ifndef OPENSSL_NO_MD4
-    { &quot;MD4&quot;, &quot;legacy=yes&quot;, md4_functions },
+    { &quot;MD4&quot;, &quot;provider=legacy&quot;, md4_functions },
 #endif
 
 #ifndef OPENSSL_NO_MDC2
-    { &quot;MDC2&quot;, &quot;legacy=yes&quot;, mdc2_functions },
+    { &quot;MDC2&quot;, &quot;provider=legacy&quot;, mdc2_functions },
 #endif /* OPENSSL_NO_MDC2 */
 
 #ifndef OPENSSL_NO_WHIRLPOOL
-    { &quot;WHIRLPOOL&quot;, &quot;legacy=yes&quot;, wp_functions },
+    { &quot;WHIRLPOOL&quot;, &quot;provider=legacy&quot;, wp_functions },
 #endif /* OPENSSL_NO_WHIRLPOOL */
 
 #ifndef OPENSSL_NO_RMD160
-    { &quot;RIPEMD-160:RIPEMD160:RIPEMD:RMD160&quot;, &quot;legacy=yes&quot;, ripemd160_functions },
+    { &quot;RIPEMD-160:RIPEMD160:RIPEMD:RMD160&quot;, &quot;provider=legacy&quot;, ripemd160_functions },
 #endif /* OPENSSL_NO_RMD160 */
 
     { NULL, NULL, NULL }
diff --git a/test/evp_fetch_prov_test.c b/test/evp_fetch_prov_test.c
index 15d2bfc4b0..ca39236cd6 100644
--- a/test/evp_fetch_prov_test.c
+++ b/test/evp_fetch_prov_test.c
@@ -40,7 +40,7 @@ const OPTIONS *test_get_options(void)
     static const OPTIONS test_options[] = {
         OPT_TEST_OPTIONS_WITH_EXTRA_USAGE(&quot;[provname...]\n&quot;),
         { &quot;type&quot;, OPT_ALG_FETCH_TYPE, 's', &quot;The fetch type to test&quot; },
-        { &quot;property&quot;, OPT_FETCH_PROPERTY, 's', &quot;The fetch property e.g. fips=yes&quot; },
+        { &quot;property&quot;, OPT_FETCH_PROPERTY, 's', &quot;The fetch property e.g. provider=fips&quot; },
         { &quot;fetchfail&quot;, OPT_FETCH_FAILURE, '-', &quot;fetch is expected to fail&quot; },
         { &quot;defaultctx&quot;, OPT_USE_DEFAULTCTX, '-',
           &quot;Use the default context if this is set&quot; },
diff --git a/test/recipes/30-test_evp_fetch_prov.t b/test/recipes/30-test_evp_fetch_prov.t
index 82d984353b..ce7c834039 100644
--- a/test/recipes/30-test_evp_fetch_prov.t
+++ b/test/recipes/30-test_evp_fetch_prov.t
@@ -33,16 +33,16 @@ my @testdata = (
       providers =&gt; [ 'default' ],
       tests  =&gt; [ { providers =&gt; [] },
                   { },
-                  { args      =&gt; [ '-property', 'default=yes' ],
-                    message   =&gt; 'using property &quot;default=yes&quot;' },
-                  { args      =&gt; [ '-property', 'fips=no' ],
-                    message   =&gt; 'using property &quot;fips=no&quot;' },
-                  { args      =&gt; [ '-property', 'default=no', '-fetchfail' ],
+                  { args      =&gt; [ '-property', 'provider=default' ],
+                    message   =&gt; 'using property &quot;provider=default&quot;' },
+                  { args      =&gt; [ '-property', 'provider!=fips' ],
+                    message   =&gt; 'using property &quot;provider!=fips&quot;' },
+                  { args      =&gt; [ '-property', 'provider!=default', '-fetchfail' ],
                     message   =&gt;
-                        'using property &quot;default=no&quot; is expected to fail' },
-                  { args      =&gt; [ '-property', 'fips=yes', '-fetchfail' ],
+                        'using property &quot;provider!=default&quot; is expected to fail' },
+                  { args      =&gt; [ '-property', 'provider=fips', '-fetchfail' ],
                     message   =&gt;
-                        'using property &quot;fips=yes&quot; is expected to fail' } ] }
+                        'using property &quot;provider=fips&quot; is expected to fail' } ] }
 );
 
 unless ($no_fips) {
@@ -60,28 +60,48 @@ unless ($no_fips) {
           providers =&gt; [ 'fips' ],
           tests     =&gt; [
               { args    =&gt; [ '-property', '' ] },
-              { args    =&gt; [ '-property', 'fips=yes' ],
-                message =&gt; 'using property &quot;fips=yes&quot;' },
-              { args    =&gt; [ '-property', 'default=no' ],
-                message =&gt; 'using property &quot;default = no&quot;' },
-              { args      =&gt; [ '-property', 'default=yes', '-fetchfail' ],
+              { args    =&gt; [ '-property', 'provider=fips' ],
+                message =&gt; 'using property &quot;provider=fips&quot;' },
+              { args    =&gt; [ '-property', 'provider!=default' ],
+                message =&gt; 'using property &quot;provider!=default&quot;' },
+              { args      =&gt; [ '-property', 'provider=default', '-fetchfail' ],
                 message   =&gt;
-                    'using property &quot;default=yes&quot; is expected to fail' },
-              { args      =&gt; [ '-property', 'fips=no', '-fetchfail' ],
+                    'using property &quot;provider=default&quot; is expected to fail' },
+              { args      =&gt; [ '-property', 'provider!=fips', '-fetchfail' ],
                 message   =&gt;
-                    'using property &quot;fips=no&quot; is expected to fail' } ] },
+                    'using property &quot;provider!=fips&quot; is expected to fail' },
+              { args    =&gt; [ '-property', 'fips=yes' ],
+                message =&gt; 'using property &quot;fips=yes&quot;' },
+              { args    =&gt; [ '-property', 'fips!=no' ],
+                message =&gt; 'using property &quot;fips!=no&quot;' },
+              { args    =&gt; [ '-property', '-fips' ],
+                message =&gt; 'using property &quot;-fips&quot;' },
+              { args    =&gt; [ '-property', 'fips=no', '-fetchfail' ],
+                message =&gt; 'using property &quot;fips=no is expected to fail&quot;' },
+              { args    =&gt; [ '-property', 'fips!=yes', '-fetchfail' ],
+                message =&gt; 'using property &quot;fips!=yes is expected to fail&quot;' } ] },
         { config    =&gt; srctop_file(&quot;test&quot;, &quot;default-and-fips.cnf&quot;),
           providers =&gt; [ 'default', 'fips' ],
           tests     =&gt; [
               { args    =&gt; [ '-property', '' ] },
-              { args      =&gt; [ '-property', 'default=no' ],
-                message   =&gt; 'using property &quot;default=no&quot;' },
-              { args      =&gt; [ '-property', 'default=yes' ],
-                message   =&gt; 'using property &quot;default=yes&quot;' },
-              { args      =&gt; [ '-property', 'fips=no' ],
-                message   =&gt; 'using property &quot;fips=no&quot;' },
-              { args      =&gt; [ '-property', 'fips=yes' ],
-                message   =&gt; 'using property &quot;fips=yes&quot;' } ] }
+              { args      =&gt; [ '-property', 'provider!=default' ],
+                message   =&gt; 'using property &quot;provider!=default&quot;' },
+              { args      =&gt; [ '-property', 'provider=default' ],
+                message   =&gt; 'using property &quot;provider=default&quot;' },
+              { args      =&gt; [ '-property', 'provider!=fips' ],
+                message   =&gt; 'using property &quot;provider!=fips&quot;' },
+              { args      =&gt; [ '-property', 'provider=fips' ],
+                message   =&gt; 'using property &quot;provider=fips&quot;' },
+              { args    =&gt; [ '-property', 'fips=yes' ],
+                message =&gt; 'using property &quot;fips=yes&quot;' },
+              { args    =&gt; [ '-property', 'fips!=no' ],
+                message =&gt; 'using property &quot;fips!=no&quot;' },
+              { args    =&gt; [ '-property', '-fips' ],
+                message =&gt; 'using property &quot;-fips&quot;' },
+              { args    =&gt; [ '-property', 'fips=no' ],
+                message =&gt; 'using property &quot;fips=no&quot;' },
+              { args    =&gt; [ '-property', 'fips!=yes' ],
+                message =&gt; 'using property &quot;fips!=yes&quot;' } ] },
     );
 }
 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027620.html">[openssl]  master update
</A></li>
	<LI>Next message: <A HREF="027623.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27622">[ date ]</a>
              <a href="thread.html#27622">[ thread ]</a>
              <a href="subject.html#27622">[ subject ]</a>
              <a href="author.html#27622">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
