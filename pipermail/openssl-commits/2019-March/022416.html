<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2019-March/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1552929911.672796.2911.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022411.html">
   <LINK REL="Next"  HREF="022418.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl]  master update</H1>
    <B>Matt Caswell</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1552929911.672796.2911.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl]  master update">matt at openssl.org
       </A><BR>
    <I>Mon Mar 18 17:25:11 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="022411.html">[openssl]  master update
</A></li>
        <LI>Next message: <A HREF="022418.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22416">[ date ]</a>
              <a href="thread.html#22416">[ thread ]</a>
              <a href="subject.html#22416">[ subject ]</a>
              <a href="author.html#22416">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  5743d1268d455859ed94be8749c4aaac6333c01b (commit)
       via  0742eb9f6675e2dde7b437f3d6d9aa37e7a5919e (commit)
       via  86afd005fb8184e37c41d85128a01b58ac152d60 (commit)
       via  a4c467c96aeae3d52e2f16b8b829749ed6c55fe7 (commit)
      from  c13d2ab439a9dcbbf22ef85a00603142b0a37779 (commit)


- Log -----------------------------------------------------------------
commit 5743d1268d455859ed94be8749c4aaac6333c01b
Author: David von Oheimb &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">David.von.Oheimb at siemens.com</A>&gt;
Date:   Fri May 11 14:52:51 2018 +0200

    add 'Signature Value:' line and correct indentation when printing X.509 signature value
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/6226">https://github.com/openssl/openssl/pull/6226</A>)

commit 0742eb9f6675e2dde7b437f3d6d9aa37e7a5919e
Author: David von Oheimb &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">David.von.Oheimb at siemens.com</A>&gt;
Date:   Fri May 11 12:01:49 2018 +0200

    update reference output of test_x509 in test/certs/cyrillic.*
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/6226">https://github.com/openssl/openssl/pull/6226</A>)

commit 86afd005fb8184e37c41d85128a01b58ac152d60
Author: David von Oheimb &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">David.von.Oheimb at siemens.com</A>&gt;
Date:   Mon Jan 29 16:58:07 2018 +0100

    remove 'keyid:' when printing simple X509 authority keyID (without issuer and serial)
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/6226">https://github.com/openssl/openssl/pull/6226</A>)

commit a4c467c96aeae3d52e2f16b8b829749ed6c55fe7
Author: David von Oheimb &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">David.von.Oheimb at siemens.com</A>&gt;
Date:   Mon Jan 29 16:54:40 2018 +0100

    remove needless empty lines when printing certificates
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/6226">https://github.com/openssl/openssl/pull/6226</A>)

-----------------------------------------------------------------------

Summary of changes:
 crypto/dsa/dsa_ameth.c       |  2 ++
 crypto/rsa/rsa_ameth.c       |  2 +-
 crypto/x509/t_x509.c         | 15 +++++++++------
 crypto/x509v3/v3_akey.c      |  2 +-
 crypto/x509v3/v3_alt.c       |  1 -
 crypto/x509v3/v3_cpols.c     | 21 ++++++++++++++-------
 crypto/x509v3/v3_crld.c      |  6 ++++--
 crypto/x509v3/v3_ncons.c     |  5 ++++-
 crypto/x509v3/v3_pci.c       |  3 +--
 crypto/x509v3/v3_prn.c       |  7 ++++---
 test/certs/cyrillic.msb      | 34 +++++++++++++++++-----------------
 test/certs/cyrillic.utf8     | 34 +++++++++++++++++-----------------
 test/certs/cyrillic_crl.utf8 | 31 ++++++++++++++++---------------
 13 files changed, 90 insertions(+), 73 deletions(-)

diff --git a/crypto/dsa/dsa_ameth.c b/crypto/dsa/dsa_ameth.c
index f28021d..756ee74 100644
--- a/crypto/dsa/dsa_ameth.c
+++ b/crypto/dsa/dsa_ameth.c
@@ -458,6 +458,8 @@ static int dsa_sig_print(BIO *bp, const X509_ALGOR *sigalg,
         DSA_SIG_free(dsa_sig);
         return rv;
     }
+    if (BIO_puts(bp, &quot;\n&quot;) &lt;= 0)
+        return 0;
     return X509_signature_dump(bp, sig, indent);
 }
 
diff --git a/crypto/rsa/rsa_ameth.c b/crypto/rsa/rsa_ameth.c
index c6ae8a4..139415e 100644
--- a/crypto/rsa/rsa_ameth.c
+++ b/crypto/rsa/rsa_ameth.c
@@ -447,7 +447,7 @@ static int rsa_sig_print(BIO *bp, const X509_ALGOR *sigalg,
         RSA_PSS_PARAMS_free(pss);
         if (!rv)
             return 0;
-    } else if (!sig &amp;&amp; BIO_puts(bp, &quot;\n&quot;) &lt;= 0) {
+    } else if (BIO_puts(bp, &quot;\n&quot;) &lt;= 0) {
         return 0;
     }
     if (sig)
diff --git a/crypto/x509/t_x509.c b/crypto/x509/t_x509.c
index 29e2093..3367228 100644
--- a/crypto/x509/t_x509.c
+++ b/crypto/x509/t_x509.c
@@ -284,7 +284,7 @@ int X509_signature_dump(BIO *bp, const ASN1_STRING *sig, int indent)
     s = sig-&gt;data;
     for (i = 0; i &lt; n; i++) {
         if ((i % 18) == 0) {
-            if (BIO_write(bp, &quot;\n&quot;, 1) &lt;= 0)
+            if (i &gt; 0 &amp;&amp; BIO_write(bp, &quot;\n&quot;, 1) &lt;= 0)
                 return 0;
             if (BIO_indent(bp, indent, indent) &lt;= 0)
                 return 0;
@@ -302,11 +302,14 @@ int X509_signature_print(BIO *bp, const X509_ALGOR *sigalg,
                          const ASN1_STRING *sig)
 {
     int sig_nid;
-    if (BIO_puts(bp, &quot;    Signature Algorithm: &quot;) &lt;= 0)
+    int indent = 4;
+    if (BIO_printf(bp, &quot;%*sSignature Algorithm: &quot;, indent, &quot;&quot;) &lt;= 0)
         return 0;
     if (i2a_ASN1_OBJECT(bp, sigalg-&gt;algorithm) &lt;= 0)
         return 0;
 
+    if (sig &amp;&amp; BIO_printf(bp, &quot;\n%*sSignature Value:&quot;, indent, &quot;&quot;) &lt;= 0)
+        return 0;
     sig_nid = OBJ_obj2nid(sigalg-&gt;algorithm);
     if (sig_nid != NID_undef) {
         int pkey_nid, dig_nid;
@@ -314,13 +317,13 @@ int X509_signature_print(BIO *bp, const X509_ALGOR *sigalg,
         if (OBJ_find_sigid_algs(sig_nid, &amp;dig_nid, &amp;pkey_nid)) {
             ameth = EVP_PKEY_asn1_find(NULL, pkey_nid);
             if (ameth &amp;&amp; ameth-&gt;sig_print)
-                return ameth-&gt;sig_print(bp, sigalg, sig, 9, 0);
+                return ameth-&gt;sig_print(bp, sigalg, sig, indent + 4, 0);
         }
     }
-    if (sig)
-        return X509_signature_dump(bp, sig, 9);
-    else if (BIO_puts(bp, &quot;\n&quot;) &lt;= 0)
+    if (BIO_write(bp, &quot;\n&quot;, 1) != 1)
         return 0;
+    if (sig)
+        return X509_signature_dump(bp, sig, indent + 4);
     return 1;
 }
 
diff --git a/crypto/x509v3/v3_akey.c b/crypto/x509v3/v3_akey.c
index 78218d5..b656b4b 100644
--- a/crypto/x509v3/v3_akey.c
+++ b/crypto/x509v3/v3_akey.c
@@ -42,7 +42,7 @@ static STACK_OF(CONF_VALUE) *i2v_AUTHORITY_KEYID(X509V3_EXT_METHOD *method,
     char *tmp;
     if (akeyid-&gt;keyid) {
         tmp = OPENSSL_buf2hexstr(akeyid-&gt;keyid-&gt;data, akeyid-&gt;keyid-&gt;length);
-        X509V3_add_value(&quot;keyid&quot;, tmp, &amp;extlist);
+        X509V3_add_value((akeyid-&gt;issuer || akeyid-&gt;serial) ? &quot;keyid&quot; : NULL, tmp, &amp;extlist);
         OPENSSL_free(tmp);
     }
     if (akeyid-&gt;issuer)
diff --git a/crypto/x509v3/v3_alt.c b/crypto/x509v3/v3_alt.c
index 128c68b..9b627e0 100644
--- a/crypto/x509v3/v3_alt.c
+++ b/crypto/x509v3/v3_alt.c
@@ -183,7 +183,6 @@ int GENERAL_NAME_print(BIO *out, GENERAL_NAME *gen)
                 BIO_printf(out, &quot;:%X&quot;, p[0] &lt;&lt; 8 | p[1]);
                 p += 2;
             }
-            BIO_puts(out, &quot;\n&quot;);
         } else {
             BIO_printf(out, &quot;IP Address:&lt;invalid&gt;&quot;);
             break;
diff --git a/crypto/x509v3/v3_cpols.c b/crypto/x509v3/v3_cpols.c
index bfdaf0a..595de62 100644
--- a/crypto/x509v3/v3_cpols.c
+++ b/crypto/x509v3/v3_cpols.c
@@ -403,12 +403,15 @@ static int i2r_certpol(X509V3_EXT_METHOD *method, STACK_OF(POLICYINFO) *pol,
     POLICYINFO *pinfo;
     /* First print out the policy OIDs */
     for (i = 0; i &lt; sk_POLICYINFO_num(pol); i++) {
+        if (i &gt; 0)
+            BIO_puts(out, &quot;\n&quot;);
         pinfo = sk_POLICYINFO_value(pol, i);
         BIO_printf(out, &quot;%*sPolicy: &quot;, indent, &quot;&quot;);
         i2a_ASN1_OBJECT(out, pinfo-&gt;policyid);
-        BIO_puts(out, &quot;\n&quot;);
-        if (pinfo-&gt;qualifiers)
+        if (pinfo-&gt;qualifiers) {
+            BIO_puts(out, &quot;\n&quot;);
             print_qualifiers(out, pinfo-&gt;qualifiers, indent + 2);
+        }
     }
     return 1;
 }
@@ -419,10 +422,12 @@ static void print_qualifiers(BIO *out, STACK_OF(POLICYQUALINFO) *quals,
     POLICYQUALINFO *qualinfo;
     int i;
     for (i = 0; i &lt; sk_POLICYQUALINFO_num(quals); i++) {
+        if (i &gt; 0)
+            BIO_puts(out, &quot;\n&quot;);
         qualinfo = sk_POLICYQUALINFO_value(quals, i);
         switch (OBJ_obj2nid(qualinfo-&gt;pqualid)) {
         case NID_id_qt_cps:
-            BIO_printf(out, &quot;%*sCPS: %s\n&quot;, indent, &quot;&quot;,
+            BIO_printf(out, &quot;%*sCPS: %s&quot;, indent, &quot;&quot;,
                        qualinfo-&gt;d.cpsuri-&gt;data);
             break;
 
@@ -435,7 +440,6 @@ static void print_qualifiers(BIO *out, STACK_OF(POLICYQUALINFO) *quals,
             BIO_printf(out, &quot;%*sUnknown Qualifier: &quot;, indent + 2, &quot;&quot;);
 
             i2a_ASN1_OBJECT(out, qualinfo-&gt;pqualid);
-            BIO_puts(out, &quot;\n&quot;);
             break;
         }
     }
@@ -467,10 +471,11 @@ static void print_notice(BIO *out, USERNOTICE *notice, int indent)
                 OPENSSL_free(tmp);
             }
         }
-        BIO_puts(out, &quot;\n&quot;);
+        if (notice-&gt;exptext)
+            BIO_puts(out, &quot;\n&quot;);
     }
     if (notice-&gt;exptext)
-        BIO_printf(out, &quot;%*sExplicit Text: %s\n&quot;, indent, &quot;&quot;,
+        BIO_printf(out, &quot;%*sExplicit Text: %s&quot;, indent, &quot;&quot;,
                    notice-&gt;exptext-&gt;data);
 }
 
@@ -484,8 +489,10 @@ void X509_POLICY_NODE_print(BIO *out, X509_POLICY_NODE *node, int indent)
     BIO_puts(out, &quot;\n&quot;);
     BIO_printf(out, &quot;%*s%s\n&quot;, indent + 2, &quot;&quot;,
                node_data_critical(dat) ? &quot;Critical&quot; : &quot;Non Critical&quot;);
-    if (dat-&gt;qualifier_set)
+    if (dat-&gt;qualifier_set) {
         print_qualifiers(out, dat-&gt;qualifier_set, indent + 2);
+        BIO_puts(out, &quot;\n&quot;);
+    }
     else
         BIO_printf(out, &quot;%*sNo Qualifiers\n&quot;, indent + 2, &quot;&quot;);
 }
diff --git a/crypto/x509v3/v3_crld.c b/crypto/x509v3/v3_crld.c
index 5d290ac..766bf0e 100644
--- a/crypto/x509v3/v3_crld.c
+++ b/crypto/x509v3/v3_crld.c
@@ -410,9 +410,10 @@ static int print_gens(BIO *out, STACK_OF(GENERAL_NAME) *gens, int indent)
 {
     int i;
     for (i = 0; i &lt; sk_GENERAL_NAME_num(gens); i++) {
+        if (i &gt; 0)
+            BIO_puts(out, &quot;\n&quot;);
         BIO_printf(out, &quot;%*s&quot;, indent + 2, &quot;&quot;);
         GENERAL_NAME_print(out, sk_GENERAL_NAME_value(gens, i));
-        BIO_puts(out, &quot;\n&quot;);
     }
     return 1;
 }
@@ -463,7 +464,8 @@ static int i2r_crldp(const X509V3_EXT_METHOD *method, void *pcrldp, BIO *out,
     DIST_POINT *point;
     int i;
     for (i = 0; i &lt; sk_DIST_POINT_num(crld); i++) {
-        BIO_puts(out, &quot;\n&quot;);
+        if (i &gt; 0)
+            BIO_puts(out, &quot;\n&quot;);
         point = sk_DIST_POINT_value(crld, i);
         if (point-&gt;distpoint)
             print_distpoint(out, point-&gt;distpoint, indent);
diff --git a/crypto/x509v3/v3_ncons.c b/crypto/x509v3/v3_ncons.c
index d16c6ee..9a8ca16 100644
--- a/crypto/x509v3/v3_ncons.c
+++ b/crypto/x509v3/v3_ncons.c
@@ -158,6 +158,8 @@ static int i2r_NAME_CONSTRAINTS(const X509V3_EXT_METHOD *method, void *a,
     NAME_CONSTRAINTS *ncons = a;
     do_i2r_name_constraints(method, ncons-&gt;permittedSubtrees,
                             bp, ind, &quot;Permitted&quot;);
+    if (ncons-&gt;permittedSubtrees &amp;&amp; ncons-&gt;excludedSubtrees)
+        BIO_puts(bp, &quot;\n&quot;);
     do_i2r_name_constraints(method, ncons-&gt;excludedSubtrees,
                             bp, ind, &quot;Excluded&quot;);
     return 1;
@@ -172,13 +174,14 @@ static int do_i2r_name_constraints(const X509V3_EXT_METHOD *method,
     if (sk_GENERAL_SUBTREE_num(trees) &gt; 0)
         BIO_printf(bp, &quot;%*s%s:\n&quot;, ind, &quot;&quot;, name);
     for (i = 0; i &lt; sk_GENERAL_SUBTREE_num(trees); i++) {
+        if (i &gt; 0)
+            BIO_puts(bp, &quot;\n&quot;);
         tree = sk_GENERAL_SUBTREE_value(trees, i);
         BIO_printf(bp, &quot;%*s&quot;, ind + 2, &quot;&quot;);
         if (tree-&gt;base-&gt;type == GEN_IPADD)
             print_nc_ipadd(bp, tree-&gt;base-&gt;d.ip);
         else
             GENERAL_NAME_print(bp, tree-&gt;base);
-        BIO_puts(bp, &quot;\n&quot;);
     }
     return 1;
 }
diff --git a/crypto/x509v3/v3_pci.c b/crypto/x509v3/v3_pci.c
index c0c599b..856b70d 100644
--- a/crypto/x509v3/v3_pci.c
+++ b/crypto/x509v3/v3_pci.c
@@ -75,9 +75,8 @@ static int i2r_pci(X509V3_EXT_METHOD *method, PROXY_CERT_INFO_EXTENSION *pci,
     BIO_puts(out, &quot;\n&quot;);
     BIO_printf(out, &quot;%*sPolicy Language: &quot;, indent, &quot;&quot;);
     i2a_ASN1_OBJECT(out, pci-&gt;proxyPolicy-&gt;policyLanguage);
-    BIO_puts(out, &quot;\n&quot;);
     if (pci-&gt;proxyPolicy-&gt;policy &amp;&amp; pci-&gt;proxyPolicy-&gt;policy-&gt;data)
-        BIO_printf(out, &quot;%*sPolicy Text: %s\n&quot;, indent, &quot;&quot;,
+        BIO_printf(out, &quot;\n%*sPolicy Text: %s&quot;, indent, &quot;&quot;,
                    pci-&gt;proxyPolicy-&gt;policy-&gt;data);
     return 1;
 }
diff --git a/crypto/x509v3/v3_prn.c b/crypto/x509v3/v3_prn.c
index 24e73a7..2ef76c1 100644
--- a/crypto/x509v3/v3_prn.c
+++ b/crypto/x509v3/v3_prn.c
@@ -34,8 +34,11 @@ void X509V3_EXT_val_prn(BIO *out, STACK_OF(CONF_VALUE) *val, int indent,
             BIO_puts(out, &quot;&lt;EMPTY&gt;\n&quot;);
     }
     for (i = 0; i &lt; sk_CONF_VALUE_num(val); i++) {
-        if (ml)
+        if (ml) {
+            if (i &gt; 0)
+                BIO_printf(out, &quot;\n&quot;);
             BIO_printf(out, &quot;%*s&quot;, indent, &quot;&quot;);
+        }
         else if (i &gt; 0)
             BIO_printf(out, &quot;, &quot;);
         nval = sk_CONF_VALUE_value(val, i);
@@ -59,8 +62,6 @@ void X509V3_EXT_val_prn(BIO *out, STACK_OF(CONF_VALUE) *val, int indent,
             }
         }
 #endif
-        if (ml)
-            BIO_puts(out, &quot;\n&quot;);
     }
 }
 
diff --git a/test/certs/cyrillic.msb b/test/certs/cyrillic.msb
index ec58ac9..a6322d5 100644
--- a/test/certs/cyrillic.msb
+++ b/test/certs/cyrillic.msb
@@ -36,26 +36,26 @@ Certificate:
             X509v3 Subject Key Identifier: 
                 11:49:46:19:2A:4E:4D:D1:C8:FB:79:55:3D:81:99:22:EE:34:4F:22
             X509v3 Authority Key Identifier: 
-                keyid:11:49:46:19:2A:4E:4D:D1:C8:FB:79:55:3D:81:99:22:EE:34:4F:22
-
+                11:49:46:19:2A:4E:4D:D1:C8:FB:79:55:3D:81:99:22:EE:34:4F:22
             X509v3 Basic Constraints: 
                 CA:TRUE
     Signature Algorithm: sha256WithRSAEncryption
-         04:8f:c3:77:48:06:29:c0:8d:66:2e:6b:48:a3:b3:e0:dd:5b:
-         0a:e7:a4:0b:7e:72:91:fc:37:29:7f:81:1e:60:66:7b:ba:94:
-         30:f8:c0:79:56:bc:ed:87:88:d9:bd:d8:7b:dc:1b:87:bb:ef:
-         15:d0:77:74:59:d7:3f:30:09:71:86:da:d7:d7:50:cb:ef:8f:
-         34:26:76:b5:0a:de:d0:ce:ca:40:57:86:ce:13:24:2a:9e:97:
-         db:5d:3e:73:8c:24:cc:89:84:42:04:45:62:f9:fd:4b:79:b2:
-         1b:a0:01:d7:4c:1f:4d:d1:4c:5b:99:0a:27:5e:c9:79:3c:0f:
-         b7:3c:09:db:32:d6:ca:56:91:32:0d:7f:79:94:bc:bc:a8:ba:
-         54:4b:39:6e:2d:9a:21:77:13:f8:b5:62:5d:a8:8c:c8:8d:ec:
-         67:6c:14:2d:f6:ce:e6:d3:a6:fa:37:36:5b:31:7a:80:66:83:
-         02:64:82:c1:ec:bf:38:8e:49:b0:e5:ec:09:9b:80:16:e4:32:
-         91:4e:72:c4:5f:2d:b3:e9:57:b1:00:36:2d:1a:e9:9f:4a:b1:
-         1c:d1:ae:fb:15:79:02:0b:14:97:81:ee:42:01:ed:00:58:38:
-         b2:30:89:f2:89:11:b7:03:7c:16:95:30:eb:32:9c:9f:00:e5:
-         22:12:db:7a
+    Signature Value:
+        04:8f:c3:77:48:06:29:c0:8d:66:2e:6b:48:a3:b3:e0:dd:5b:
+        0a:e7:a4:0b:7e:72:91:fc:37:29:7f:81:1e:60:66:7b:ba:94:
+        30:f8:c0:79:56:bc:ed:87:88:d9:bd:d8:7b:dc:1b:87:bb:ef:
+        15:d0:77:74:59:d7:3f:30:09:71:86:da:d7:d7:50:cb:ef:8f:
+        34:26:76:b5:0a:de:d0:ce:ca:40:57:86:ce:13:24:2a:9e:97:
+        db:5d:3e:73:8c:24:cc:89:84:42:04:45:62:f9:fd:4b:79:b2:
+        1b:a0:01:d7:4c:1f:4d:d1:4c:5b:99:0a:27:5e:c9:79:3c:0f:
+        b7:3c:09:db:32:d6:ca:56:91:32:0d:7f:79:94:bc:bc:a8:ba:
+        54:4b:39:6e:2d:9a:21:77:13:f8:b5:62:5d:a8:8c:c8:8d:ec:
+        67:6c:14:2d:f6:ce:e6:d3:a6:fa:37:36:5b:31:7a:80:66:83:
+        02:64:82:c1:ec:bf:38:8e:49:b0:e5:ec:09:9b:80:16:e4:32:
+        91:4e:72:c4:5f:2d:b3:e9:57:b1:00:36:2d:1a:e9:9f:4a:b1:
+        1c:d1:ae:fb:15:79:02:0b:14:97:81:ee:42:01:ed:00:58:38:
+        b2:30:89:f2:89:11:b7:03:7c:16:95:30:eb:32:9c:9f:00:e5:
+        22:12:db:7a
 -----BEGIN CERTIFICATE-----
 MIIEPTCCAyWgAwIBAgIJAL5HPFOmKsA6MA0GCSqGSIb3DQEBCwUAMIG0MQswCQYD
 VQQGEwJSVTEVMBMGA1UECAwM0JzQvtGB0LrQstCwMRUwEwYDVQQHDAzQnNC+0YHQ
diff --git a/test/certs/cyrillic.utf8 b/test/certs/cyrillic.utf8
index 2096e4f..e9a2df2 100644
--- a/test/certs/cyrillic.utf8
+++ b/test/certs/cyrillic.utf8
@@ -36,26 +36,26 @@ Certificate:
             X509v3 Subject Key Identifier: 
                 11:49:46:19:2A:4E:4D:D1:C8:FB:79:55:3D:81:99:22:EE:34:4F:22
             X509v3 Authority Key Identifier: 
-                keyid:11:49:46:19:2A:4E:4D:D1:C8:FB:79:55:3D:81:99:22:EE:34:4F:22
-
+                11:49:46:19:2A:4E:4D:D1:C8:FB:79:55:3D:81:99:22:EE:34:4F:22
             X509v3 Basic Constraints: 
                 CA:TRUE
     Signature Algorithm: sha256WithRSAEncryption
-         04:8f:c3:77:48:06:29:c0:8d:66:2e:6b:48:a3:b3:e0:dd:5b:
-         0a:e7:a4:0b:7e:72:91:fc:37:29:7f:81:1e:60:66:7b:ba:94:
-         30:f8:c0:79:56:bc:ed:87:88:d9:bd:d8:7b:dc:1b:87:bb:ef:
-         15:d0:77:74:59:d7:3f:30:09:71:86:da:d7:d7:50:cb:ef:8f:
-         34:26:76:b5:0a:de:d0:ce:ca:40:57:86:ce:13:24:2a:9e:97:
-         db:5d:3e:73:8c:24:cc:89:84:42:04:45:62:f9:fd:4b:79:b2:
-         1b:a0:01:d7:4c:1f:4d:d1:4c:5b:99:0a:27:5e:c9:79:3c:0f:
-         b7:3c:09:db:32:d6:ca:56:91:32:0d:7f:79:94:bc:bc:a8:ba:
-         54:4b:39:6e:2d:9a:21:77:13:f8:b5:62:5d:a8:8c:c8:8d:ec:
-         67:6c:14:2d:f6:ce:e6:d3:a6:fa:37:36:5b:31:7a:80:66:83:
-         02:64:82:c1:ec:bf:38:8e:49:b0:e5:ec:09:9b:80:16:e4:32:
-         91:4e:72:c4:5f:2d:b3:e9:57:b1:00:36:2d:1a:e9:9f:4a:b1:
-         1c:d1:ae:fb:15:79:02:0b:14:97:81:ee:42:01:ed:00:58:38:
-         b2:30:89:f2:89:11:b7:03:7c:16:95:30:eb:32:9c:9f:00:e5:
-         22:12:db:7a
+    Signature Value:
+        04:8f:c3:77:48:06:29:c0:8d:66:2e:6b:48:a3:b3:e0:dd:5b:
+        0a:e7:a4:0b:7e:72:91:fc:37:29:7f:81:1e:60:66:7b:ba:94:
+        30:f8:c0:79:56:bc:ed:87:88:d9:bd:d8:7b:dc:1b:87:bb:ef:
+        15:d0:77:74:59:d7:3f:30:09:71:86:da:d7:d7:50:cb:ef:8f:
+        34:26:76:b5:0a:de:d0:ce:ca:40:57:86:ce:13:24:2a:9e:97:
+        db:5d:3e:73:8c:24:cc:89:84:42:04:45:62:f9:fd:4b:79:b2:
+        1b:a0:01:d7:4c:1f:4d:d1:4c:5b:99:0a:27:5e:c9:79:3c:0f:
+        b7:3c:09:db:32:d6:ca:56:91:32:0d:7f:79:94:bc:bc:a8:ba:
+        54:4b:39:6e:2d:9a:21:77:13:f8:b5:62:5d:a8:8c:c8:8d:ec:
+        67:6c:14:2d:f6:ce:e6:d3:a6:fa:37:36:5b:31:7a:80:66:83:
+        02:64:82:c1:ec:bf:38:8e:49:b0:e5:ec:09:9b:80:16:e4:32:
+        91:4e:72:c4:5f:2d:b3:e9:57:b1:00:36:2d:1a:e9:9f:4a:b1:
+        1c:d1:ae:fb:15:79:02:0b:14:97:81:ee:42:01:ed:00:58:38:
+        b2:30:89:f2:89:11:b7:03:7c:16:95:30:eb:32:9c:9f:00:e5:
+        22:12:db:7a
 -----BEGIN CERTIFICATE-----
 MIIEPTCCAyWgAwIBAgIJAL5HPFOmKsA6MA0GCSqGSIb3DQEBCwUAMIG0MQswCQYD
 VQQGEwJSVTEVMBMGA1UECAwM0JzQvtGB0LrQstCwMRUwEwYDVQQHDAzQnNC+0YHQ
diff --git a/test/certs/cyrillic_crl.utf8 b/test/certs/cyrillic_crl.utf8
index e55c549..c36a3fd 100644
--- a/test/certs/cyrillic_crl.utf8
+++ b/test/certs/cyrillic_crl.utf8
@@ -9,21 +9,22 @@ Certificate Revocation List (CRL):
                 1
 No Revoked Certificates.
     Signature Algorithm: sha256WithRSAEncryption
-         85:e5:e5:fe:d4:13:3f:07:1a:07:53:6f:f7:a5:01:c9:80:f4:
-         8a:7a:f3:74:fc:af:dd:6a:21:47:88:99:7b:29:bf:46:0b:02:
-         98:d7:80:75:46:f6:cd:da:b5:0f:ff:9f:0c:b7:e6:aa:8e:f6:
-         ae:7f:5c:81:ce:56:89:41:e2:4a:65:cb:02:98:6f:69:e9:3a:
-         f5:cb:40:49:5e:1a:ea:e6:40:b4:48:bc:8d:0e:c7:c6:51:37:
-         ee:c6:7c:26:a3:e7:25:1d:74:54:fa:02:ae:93:e8:74:5a:42:
-         4b:d3:6d:99:61:b2:77:f3:0e:7c:f2:4e:0d:4f:70:96:54:77:
-         84:db:71:03:0b:6e:b8:a7:de:36:9a:50:c4:ed:e9:fa:33:22:
-         f5:e7:63:de:2d:df:58:ad:68:aa:e6:23:88:3a:b2:1b:40:b1:
-         2b:ab:41:23:c3:1b:c7:1b:db:0c:89:81:54:6b:a5:6b:c2:64:
-         5f:db:a9:f2:67:bb:bd:44:a2:43:3f:ea:36:76:5b:70:76:20:
-         5a:49:70:b7:42:dd:e9:67:c0:48:7e:ff:e5:f3:59:70:a7:c0:
-         eb:eb:74:b0:08:82:36:a4:84:69:97:22:02:75:0a:a6:5f:f6:
-         be:d6:af:24:4e:15:c8:3f:62:b1:f9:7e:3c:83:b5:44:da:8d:
-         97:e1:c7:f2
+    Signature Value:
+        85:e5:e5:fe:d4:13:3f:07:1a:07:53:6f:f7:a5:01:c9:80:f4:
+        8a:7a:f3:74:fc:af:dd:6a:21:47:88:99:7b:29:bf:46:0b:02:
+        98:d7:80:75:46:f6:cd:da:b5:0f:ff:9f:0c:b7:e6:aa:8e:f6:
+        ae:7f:5c:81:ce:56:89:41:e2:4a:65:cb:02:98:6f:69:e9:3a:
+        f5:cb:40:49:5e:1a:ea:e6:40:b4:48:bc:8d:0e:c7:c6:51:37:
+        ee:c6:7c:26:a3:e7:25:1d:74:54:fa:02:ae:93:e8:74:5a:42:
+        4b:d3:6d:99:61:b2:77:f3:0e:7c:f2:4e:0d:4f:70:96:54:77:
+        84:db:71:03:0b:6e:b8:a7:de:36:9a:50:c4:ed:e9:fa:33:22:
+        f5:e7:63:de:2d:df:58:ad:68:aa:e6:23:88:3a:b2:1b:40:b1:
+        2b:ab:41:23:c3:1b:c7:1b:db:0c:89:81:54:6b:a5:6b:c2:64:
+        5f:db:a9:f2:67:bb:bd:44:a2:43:3f:ea:36:76:5b:70:76:20:
+        5a:49:70:b7:42:dd:e9:67:c0:48:7e:ff:e5:f3:59:70:a7:c0:
+        eb:eb:74:b0:08:82:36:a4:84:69:97:22:02:75:0a:a6:5f:f6:
+        be:d6:af:24:4e:15:c8:3f:62:b1:f9:7e:3c:83:b5:44:da:8d:
+        97:e1:c7:f2
 -----BEGIN X509 CRL-----
 MIIB6DCB0QIBATANBgkqhkiG9w0BAQsFADCBjjELMAkGA1UEBhMCUlUxFTATBgNV
 BAgMDNCc0L7RgdC60LLQsDELMAkGA1UECgwC0K8xCzAJBgNVBAsMAtCvMSowKAYD
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022411.html">[openssl]  master update
</A></li>
	<LI>Next message: <A HREF="022418.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22416">[ date ]</a>
              <a href="thread.html#22416">[ thread ]</a>
              <a href="subject.html#22416">[ subject ]</a>
              <a href="author.html#22416">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
