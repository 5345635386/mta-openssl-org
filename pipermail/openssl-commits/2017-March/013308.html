<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2017-March/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1488361699.326091.10489.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013288.html">
   <LINK REL="Next"  HREF="013312.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Emilia Kasper</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1488361699.326091.10489.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">emilia at openssl.org
       </A><BR>
    <I>Wed Mar  1 09:48:19 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="013288.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="013312.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13308">[ date ]</a>
              <a href="thread.html#13308">[ thread ]</a>
              <a href="subject.html#13308">[ subject ]</a>
              <a href="author.html#13308">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  2f0ca54c32299638e5a1d7577112a7fc07774f00 (commit)
      from  06611d0a1623a1ce06275b6cdd7a270d9704bf37 (commit)


- Log -----------------------------------------------------------------
commit 2f0ca54c32299638e5a1d7577112a7fc07774f00
Author: Emilia Kasper &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">emilia at openssl.org</A>&gt;
Date:   Tue Feb 28 14:13:40 2017 +0100

    Remove some obsolete/obscure internal define switches:
    
    - FLAT_INC
    - PKCS1_CHECK (the SSL_OP_PKCS1_CHECK options have been
      no-oped)
    - PKCS_TESTVECT (debugging leftovers)
    - SSL_AD_MISSING_SRP_USERNAME (unfinished feature)
    - DTLS_AD_MISSING_HANDSHAKE_MESSAGE (unfinished feature)
    - USE_OBJ_MAC (note this removes a define from the public header but
       very unlikely someone would be depending on it)
    - SSL_FORBID_ENULL
    
    Reviewed-by: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
    Reviewed-by: Stephen Henson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">steve at openssl.org</A>&gt;
    Reviewed-by: Andy Polyakov &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">appro at openssl.org</A>&gt;

-----------------------------------------------------------------------

Summary of changes:
 crypto/cryptlib.c         |   8 +-
 crypto/rsa/rsa_oaep.c     |   5 -
 demos/engines/e_chil.c    |   6 +-
 include/openssl/dtls1.h   |   7 +-
 include/openssl/objects.h | 903 +---------------------------------------------
 ssl/d1_msg.c              |  13 +-
 ssl/record/rec_layer_d1.c |  36 --
 ssl/record/rec_layer_s3.c |   4 -
 ssl/ssl_ciph.c            |   3 -
 ssl/ssl_locl.h            |   2 -
 ssl/statem/statem_clnt.c  |   6 -
 test/build.info           |   2 +-
 test/ectest.c             |   7 +-
 test/rsa_test.c           |   6 +-
 14 files changed, 15 insertions(+), 993 deletions(-)

diff --git a/crypto/cryptlib.c b/crypto/cryptlib.c
index 01b8ce5..b022365 100644
--- a/crypto/cryptlib.c
+++ b/crypto/cryptlib.c
@@ -167,7 +167,13 @@ void OPENSSL_showfatal(const char *fmta, ...)
     va_list ap;
     TCHAR buf[256];
     const TCHAR *fmt;
-# ifdef STD_ERROR_HANDLE        /* what a dirty trick! */
+    /*
+     * First check if it's a console application, in which case the
+     * error message would be printed to standard error.
+     * Windows CE does not have a concept of a console application,
+     * so we need to guard the check.
+     */
+# ifdef STD_ERROR_HANDLE
     HANDLE h;
 
     if ((h = GetStdHandle(STD_ERROR_HANDLE)) != NULL &amp;&amp;
diff --git a/crypto/rsa/rsa_oaep.c b/crypto/rsa/rsa_oaep.c
index 868104f..d583d23 100644
--- a/crypto/rsa/rsa_oaep.c
+++ b/crypto/rsa/rsa_oaep.c
@@ -78,11 +78,6 @@ int RSA_padding_add_PKCS1_OAEP_mgf1(unsigned char *to, int tlen,
     memcpy(db + emlen - flen - mdlen, from, (unsigned int)flen);
     if (RAND_bytes(seed, mdlen) &lt;= 0)
         return 0;
-#ifdef PKCS_TESTVECT
-    memcpy(seed,
-           &quot;\xaa\xfd\x12\xf6\x59\xca\xe6\x34\x89\xb4\x79\xe5\x07\x6d\xde\xc2\xf0\x6c\xb5\x8f&quot;,
-           20);
-#endif
 
     dbmask = OPENSSL_malloc(emlen - mdlen);
     if (dbmask == NULL) {
diff --git a/demos/engines/e_chil.c b/demos/engines/e_chil.c
index 8d81b46..74b9c86 100644
--- a/demos/engines/e_chil.c
+++ b/demos/engines/e_chil.c
@@ -35,11 +35,7 @@
  * The hwcryptohook.h included here is from May 2000.
  * [Richard Levitte]
  */
-#  ifdef FLAT_INC
-#   include &quot;hwcryptohook.h&quot;
-#  else
-#   include &quot;vendor_defns/hwcryptohook.h&quot;
-#  endif
+# include &quot;vendor_defns/hwcryptohook.h&quot;
 
 #  define HWCRHK_LIB_NAME &quot;CHIL engine&quot;
 #  include &quot;e_chil_err.c&quot;
diff --git a/include/openssl/dtls1.h b/include/openssl/dtls1.h
index f4769f8..86a8981 100644
--- a/include/openssl/dtls1.h
+++ b/include/openssl/dtls1.h
@@ -37,12 +37,7 @@ extern &quot;C&quot; {
 
 # define DTLS1_CCS_HEADER_LENGTH                  1
 
-# ifdef DTLS1_AD_MISSING_HANDSHAKE_MESSAGE
-#  define DTLS1_AL_HEADER_LENGTH                   7
-# else
-#  define DTLS1_AL_HEADER_LENGTH                   2
-# endif
-
+# define DTLS1_AL_HEADER_LENGTH                   2
 
 /* Timeout multipliers (timeout slice is defined in apps/timeouts.h */
 # define DTLS1_TMO_READ_COUNT                      2
diff --git a/include/openssl/objects.h b/include/openssl/objects.h
index 09d614f..b554add 100644
--- a/include/openssl/objects.h
+++ b/include/openssl/objects.h
@@ -10,908 +10,7 @@
 #ifndef HEADER_OBJECTS_H
 # define HEADER_OBJECTS_H
 
-# define USE_OBJ_MAC
-
-# ifdef USE_OBJ_MAC
-#  include &lt;openssl/obj_mac.h&gt;
-# else
-#  define SN_undef                        &quot;UNDEF&quot;
-#  define LN_undef                        &quot;undefined&quot;
-#  define NID_undef                       0
-#  define OBJ_undef                       0L
-
-#  define SN_Algorithm                    &quot;Algorithm&quot;
-#  define LN_algorithm                    &quot;algorithm&quot;
-#  define NID_algorithm                   38
-#  define OBJ_algorithm                   1L,3L,14L,3L,2L
-
-#  define LN_rsadsi                       &quot;rsadsi&quot;
-#  define NID_rsadsi                      1
-#  define OBJ_rsadsi                      1L,2L,840L,113549L
-
-#  define LN_pkcs                         &quot;pkcs&quot;
-#  define NID_pkcs                        2
-#  define OBJ_pkcs                        OBJ_rsadsi,1L
-
-#  define SN_md2                          &quot;MD2&quot;
-#  define LN_md2                          &quot;md2&quot;
-#  define NID_md2                         3
-#  define OBJ_md2                         OBJ_rsadsi,2L,2L
-
-#  define SN_md5                          &quot;MD5&quot;
-#  define LN_md5                          &quot;md5&quot;
-#  define NID_md5                         4
-#  define OBJ_md5                         OBJ_rsadsi,2L,5L
-
-#  define SN_rc4                          &quot;RC4&quot;
-#  define LN_rc4                          &quot;rc4&quot;
-#  define NID_rc4                         5
-#  define OBJ_rc4                         OBJ_rsadsi,3L,4L
-
-#  define LN_rsaEncryption                &quot;rsaEncryption&quot;
-#  define NID_rsaEncryption               6
-#  define OBJ_rsaEncryption               OBJ_pkcs,1L,1L
-
-#  define SN_md2WithRSAEncryption         &quot;RSA-MD2&quot;
-#  define LN_md2WithRSAEncryption         &quot;md2WithRSAEncryption&quot;
-#  define NID_md2WithRSAEncryption        7
-#  define OBJ_md2WithRSAEncryption        OBJ_pkcs,1L,2L
-
-#  define SN_md5WithRSAEncryption         &quot;RSA-MD5&quot;
-#  define LN_md5WithRSAEncryption         &quot;md5WithRSAEncryption&quot;
-#  define NID_md5WithRSAEncryption        8
-#  define OBJ_md5WithRSAEncryption        OBJ_pkcs,1L,4L
-
-#  define SN_pbeWithMD2AndDES_CBC         &quot;PBE-MD2-DES&quot;
-#  define LN_pbeWithMD2AndDES_CBC         &quot;pbeWithMD2AndDES-CBC&quot;
-#  define NID_pbeWithMD2AndDES_CBC        9
-#  define OBJ_pbeWithMD2AndDES_CBC        OBJ_pkcs,5L,1L
-
-#  define SN_pbeWithMD5AndDES_CBC         &quot;PBE-MD5-DES&quot;
-#  define LN_pbeWithMD5AndDES_CBC         &quot;pbeWithMD5AndDES-CBC&quot;
-#  define NID_pbeWithMD5AndDES_CBC        10
-#  define OBJ_pbeWithMD5AndDES_CBC        OBJ_pkcs,5L,3L
-
-#  define LN_X500                         &quot;X500&quot;
-#  define NID_X500                        11
-#  define OBJ_X500                        2L,5L
-
-#  define LN_X509                         &quot;X509&quot;
-#  define NID_X509                        12
-#  define OBJ_X509                        OBJ_X500,4L
-
-#  define SN_commonName                   &quot;CN&quot;
-#  define LN_commonName                   &quot;commonName&quot;
-#  define NID_commonName                  13
-#  define OBJ_commonName                  OBJ_X509,3L
-
-#  define SN_countryName                  &quot;C&quot;
-#  define LN_countryName                  &quot;countryName&quot;
-#  define NID_countryName                 14
-#  define OBJ_countryName                 OBJ_X509,6L
-
-#  define SN_localityName                 &quot;L&quot;
-#  define LN_localityName                 &quot;localityName&quot;
-#  define NID_localityName                15
-#  define OBJ_localityName                OBJ_X509,7L
-
-/* Postal Address? PA */
-
-/* should be &quot;ST&quot; (rfc1327) but MS uses 'S' */
-#  define SN_stateOrProvinceName          &quot;ST&quot;
-#  define LN_stateOrProvinceName          &quot;stateOrProvinceName&quot;
-#  define NID_stateOrProvinceName         16
-#  define OBJ_stateOrProvinceName         OBJ_X509,8L
-
-#  define SN_organizationName             &quot;O&quot;
-#  define LN_organizationName             &quot;organizationName&quot;
-#  define NID_organizationName            17
-#  define OBJ_organizationName            OBJ_X509,10L
-
-#  define SN_organizationalUnitName       &quot;OU&quot;
-#  define LN_organizationalUnitName       &quot;organizationalUnitName&quot;
-#  define NID_organizationalUnitName      18
-#  define OBJ_organizationalUnitName      OBJ_X509,11L
-
-#  define SN_rsa                          &quot;RSA&quot;
-#  define LN_rsa                          &quot;rsa&quot;
-#  define NID_rsa                         19
-#  define OBJ_rsa                         OBJ_X500,8L,1L,1L
-
-#  define LN_pkcs7                        &quot;pkcs7&quot;
-#  define NID_pkcs7                       20
-#  define OBJ_pkcs7                       OBJ_pkcs,7L
-
-#  define LN_pkcs7_data                   &quot;pkcs7-data&quot;
-#  define NID_pkcs7_data                  21
-#  define OBJ_pkcs7_data                  OBJ_pkcs7,1L
-
-#  define LN_pkcs7_signed                 &quot;pkcs7-signedData&quot;
-#  define NID_pkcs7_signed                22
-#  define OBJ_pkcs7_signed                OBJ_pkcs7,2L
-
-#  define LN_pkcs7_enveloped              &quot;pkcs7-envelopedData&quot;
-#  define NID_pkcs7_enveloped             23
-#  define OBJ_pkcs7_enveloped             OBJ_pkcs7,3L
-
-#  define LN_pkcs7_signedAndEnveloped     &quot;pkcs7-signedAndEnvelopedData&quot;
-#  define NID_pkcs7_signedAndEnveloped    24
-#  define OBJ_pkcs7_signedAndEnveloped    OBJ_pkcs7,4L
-
-#  define LN_pkcs7_digest                 &quot;pkcs7-digestData&quot;
-#  define NID_pkcs7_digest                25
-#  define OBJ_pkcs7_digest                OBJ_pkcs7,5L
-
-#  define LN_pkcs7_encrypted              &quot;pkcs7-encryptedData&quot;
-#  define NID_pkcs7_encrypted             26
-#  define OBJ_pkcs7_encrypted             OBJ_pkcs7,6L
-
-#  define LN_pkcs3                        &quot;pkcs3&quot;
-#  define NID_pkcs3                       27
-#  define OBJ_pkcs3                       OBJ_pkcs,3L
-
-#  define LN_dhKeyAgreement               &quot;dhKeyAgreement&quot;
-#  define NID_dhKeyAgreement              28
-#  define OBJ_dhKeyAgreement              OBJ_pkcs3,1L
-
-#  define SN_des_ecb                      &quot;DES-ECB&quot;
-#  define LN_des_ecb                      &quot;des-ecb&quot;
-#  define NID_des_ecb                     29
-#  define OBJ_des_ecb                     OBJ_algorithm,6L
-
-#  define SN_des_cfb64                    &quot;DES-CFB&quot;
-#  define LN_des_cfb64                    &quot;des-cfb&quot;
-#  define NID_des_cfb64                   30
-/* IV + num */
-#  define OBJ_des_cfb64                   OBJ_algorithm,9L
-
-#  define SN_des_cbc                      &quot;DES-CBC&quot;
-#  define LN_des_cbc                      &quot;des-cbc&quot;
-#  define NID_des_cbc                     31
-/* IV */
-#  define OBJ_des_cbc                     OBJ_algorithm,7L
-
-#  define SN_des_ede                      &quot;DES-EDE&quot;
-#  define LN_des_ede                      &quot;des-ede&quot;
-#  define NID_des_ede                     32
-/* ?? */
-#  define OBJ_des_ede                     OBJ_algorithm,17L
-
-#  define SN_des_ede3                     &quot;DES-EDE3&quot;
-#  define LN_des_ede3                     &quot;des-ede3&quot;
-#  define NID_des_ede3                    33
-
-#  define SN_idea_cbc                     &quot;IDEA-CBC&quot;
-#  define LN_idea_cbc                     &quot;idea-cbc&quot;
-#  define NID_idea_cbc                    34
-#  define OBJ_idea_cbc                    1L,3L,6L,1L,4L,1L,188L,7L,1L,1L,2L
-
-#  define SN_idea_cfb64                   &quot;IDEA-CFB&quot;
-#  define LN_idea_cfb64                   &quot;idea-cfb&quot;
-#  define NID_idea_cfb64                  35
-
-#  define SN_idea_ecb                     &quot;IDEA-ECB&quot;
-#  define LN_idea_ecb                     &quot;idea-ecb&quot;
-#  define NID_idea_ecb                    36
-
-#  define SN_rc2_cbc                      &quot;RC2-CBC&quot;
-#  define LN_rc2_cbc                      &quot;rc2-cbc&quot;
-#  define NID_rc2_cbc                     37
-#  define OBJ_rc2_cbc                     OBJ_rsadsi,3L,2L
-
-#  define SN_rc2_ecb                      &quot;RC2-ECB&quot;
-#  define LN_rc2_ecb                      &quot;rc2-ecb&quot;
-#  define NID_rc2_ecb                     38
-
-#  define SN_rc2_cfb64                    &quot;RC2-CFB&quot;
-#  define LN_rc2_cfb64                    &quot;rc2-cfb&quot;
-#  define NID_rc2_cfb64                   39
-
-#  define SN_rc2_ofb64                    &quot;RC2-OFB&quot;
-#  define LN_rc2_ofb64                    &quot;rc2-ofb&quot;
-#  define NID_rc2_ofb64                   40
-
-#  define SN_sha                          &quot;SHA&quot;
-#  define LN_sha                          &quot;sha&quot;
-#  define NID_sha                         41
-#  define OBJ_sha                         OBJ_algorithm,18L
-
-#  define SN_shaWithRSAEncryption         &quot;RSA-SHA&quot;
-#  define LN_shaWithRSAEncryption         &quot;shaWithRSAEncryption&quot;
-#  define NID_shaWithRSAEncryption        42
-#  define OBJ_shaWithRSAEncryption        OBJ_algorithm,15L
-
-#  define SN_des_ede_cbc                  &quot;DES-EDE-CBC&quot;
-#  define LN_des_ede_cbc                  &quot;des-ede-cbc&quot;
-#  define NID_des_ede_cbc                 43
-
-#  define SN_des_ede3_cbc                 &quot;DES-EDE3-CBC&quot;
-#  define LN_des_ede3_cbc                 &quot;des-ede3-cbc&quot;
-#  define NID_des_ede3_cbc                44
-#  define OBJ_des_ede3_cbc                OBJ_rsadsi,3L,7L
-
-#  define SN_des_ofb64                    &quot;DES-OFB&quot;
-#  define LN_des_ofb64                    &quot;des-ofb&quot;
-#  define NID_des_ofb64                   45
-#  define OBJ_des_ofb64                   OBJ_algorithm,8L
-
-#  define SN_idea_ofb64                   &quot;IDEA-OFB&quot;
-#  define LN_idea_ofb64                   &quot;idea-ofb&quot;
-#  define NID_idea_ofb64                  46
-
-#  define LN_pkcs9                        &quot;pkcs9&quot;
-#  define NID_pkcs9                       47
-#  define OBJ_pkcs9                       OBJ_pkcs,9L
-
-#  define SN_pkcs9_emailAddress           &quot;Email&quot;
-#  define LN_pkcs9_emailAddress           &quot;emailAddress&quot;
-#  define NID_pkcs9_emailAddress          48
-#  define OBJ_pkcs9_emailAddress          OBJ_pkcs9,1L
-
-#  define LN_pkcs9_unstructuredName       &quot;unstructuredName&quot;
-#  define NID_pkcs9_unstructuredName      49
-#  define OBJ_pkcs9_unstructuredName      OBJ_pkcs9,2L
-
-#  define LN_pkcs9_contentType            &quot;contentType&quot;
-#  define NID_pkcs9_contentType           50
-#  define OBJ_pkcs9_contentType           OBJ_pkcs9,3L
-
-#  define LN_pkcs9_messageDigest          &quot;messageDigest&quot;
-#  define NID_pkcs9_messageDigest         51
-#  define OBJ_pkcs9_messageDigest         OBJ_pkcs9,4L
-
-#  define LN_pkcs9_signingTime            &quot;signingTime&quot;
-#  define NID_pkcs9_signingTime           52
-#  define OBJ_pkcs9_signingTime           OBJ_pkcs9,5L
-
-#  define LN_pkcs9_countersignature       &quot;countersignature&quot;
-#  define NID_pkcs9_countersignature      53
-#  define OBJ_pkcs9_countersignature      OBJ_pkcs9,6L
-
-#  define LN_pkcs9_challengePassword      &quot;challengePassword&quot;
-#  define NID_pkcs9_challengePassword     54
-#  define OBJ_pkcs9_challengePassword     OBJ_pkcs9,7L
-
-#  define LN_pkcs9_unstructuredAddress    &quot;unstructuredAddress&quot;
-#  define NID_pkcs9_unstructuredAddress   55
-#  define OBJ_pkcs9_unstructuredAddress   OBJ_pkcs9,8L
-
-#  define LN_pkcs9_extCertAttributes      &quot;extendedCertificateAttributes&quot;
-#  define NID_pkcs9_extCertAttributes     56
-#  define OBJ_pkcs9_extCertAttributes     OBJ_pkcs9,9L
-
-#  define SN_netscape                     &quot;Netscape&quot;
-#  define LN_netscape                     &quot;Netscape Communications Corp.&quot;
-#  define NID_netscape                    57
-#  define OBJ_netscape                    2L,16L,840L,1L,113730L
-
-#  define SN_netscape_cert_extension      &quot;nsCertExt&quot;
-#  define LN_netscape_cert_extension      &quot;Netscape Certificate Extension&quot;
-#  define NID_netscape_cert_extension     58
-#  define OBJ_netscape_cert_extension     OBJ_netscape,1L
-
-#  define SN_netscape_data_type           &quot;nsDataType&quot;
-#  define LN_netscape_data_type           &quot;Netscape Data Type&quot;
-#  define NID_netscape_data_type          59
-#  define OBJ_netscape_data_type          OBJ_netscape,2L
-
-#  define SN_des_ede_cfb64                &quot;DES-EDE-CFB&quot;
-#  define LN_des_ede_cfb64                &quot;des-ede-cfb&quot;
-#  define NID_des_ede_cfb64               60
-
-#  define SN_des_ede3_cfb64               &quot;DES-EDE3-CFB&quot;
-#  define LN_des_ede3_cfb64               &quot;des-ede3-cfb&quot;
-#  define NID_des_ede3_cfb64              61
-
-#  define SN_des_ede_ofb64                &quot;DES-EDE-OFB&quot;
-#  define LN_des_ede_ofb64                &quot;des-ede-ofb&quot;
-#  define NID_des_ede_ofb64               62
-
-#  define SN_des_ede3_ofb64               &quot;DES-EDE3-OFB&quot;
-#  define LN_des_ede3_ofb64               &quot;des-ede3-ofb&quot;
-#  define NID_des_ede3_ofb64              63
-
-/* I'm not sure about the object ID */
-#  define SN_sha1                         &quot;SHA1&quot;
-#  define LN_sha1                         &quot;sha1&quot;
-#  define NID_sha1                        64
-#  define OBJ_sha1                        OBJ_algorithm,26L
-/* 28 Jun 1996 - eay */
-/* #define OBJ_sha1                     1L,3L,14L,2L,26L,05L &lt;- wrong */
-
-#  define SN_sha1WithRSAEncryption        &quot;RSA-SHA1&quot;
-#  define LN_sha1WithRSAEncryption        &quot;sha1WithRSAEncryption&quot;
-#  define NID_sha1WithRSAEncryption       65
-#  define OBJ_sha1WithRSAEncryption       OBJ_pkcs,1L,5L
-
-#  define SN_dsaWithSHA                   &quot;DSA-SHA&quot;
-#  define LN_dsaWithSHA                   &quot;dsaWithSHA&quot;
-#  define NID_dsaWithSHA                  66
-#  define OBJ_dsaWithSHA                  OBJ_algorithm,13L
-
-#  define SN_dsa_2                        &quot;DSA-old&quot;
-#  define LN_dsa_2                        &quot;dsaEncryption-old&quot;
-#  define NID_dsa_2                       67
-#  define OBJ_dsa_2                       OBJ_algorithm,12L
-
-/* proposed by microsoft to RSA */
-#  define SN_pbeWithSHA1AndRC2_CBC        &quot;PBE-SHA1-RC2-64&quot;
-#  define LN_pbeWithSHA1AndRC2_CBC        &quot;pbeWithSHA1AndRC2-CBC&quot;
-#  define NID_pbeWithSHA1AndRC2_CBC       68
-#  define OBJ_pbeWithSHA1AndRC2_CBC       OBJ_pkcs,5L,11L
-
-/*
- * proposed by microsoft to RSA as pbeWithSHA1AndRC4: it is now defined
- * explicitly in PKCS#5 v2.0 as id-PBKDF2 which is something completely
- * different.
- */
-#  define LN_id_pbkdf2                    &quot;PBKDF2&quot;
-#  define NID_id_pbkdf2                   69
-#  define OBJ_id_pbkdf2                   OBJ_pkcs,5L,12L
-
-#  define SN_dsaWithSHA1_2                &quot;DSA-SHA1-old&quot;
-#  define LN_dsaWithSHA1_2                &quot;dsaWithSHA1-old&quot;
-#  define NID_dsaWithSHA1_2               70
-/* Got this one from 'sdn706r20.pdf' which is actually an NSA document :-) */
-#  define OBJ_dsaWithSHA1_2               OBJ_algorithm,27L
-
-#  define SN_netscape_cert_type           &quot;nsCertType&quot;
-#  define LN_netscape_cert_type           &quot;Netscape Cert Type&quot;
-#  define NID_netscape_cert_type          71
-#  define OBJ_netscape_cert_type          OBJ_netscape_cert_extension,1L
-
-#  define SN_netscape_base_url            &quot;nsBaseUrl&quot;
-#  define LN_netscape_base_url            &quot;Netscape Base Url&quot;
-#  define NID_netscape_base_url           72
-#  define OBJ_netscape_base_url           OBJ_netscape_cert_extension,2L
-
-#  define SN_netscape_revocation_url      &quot;nsRevocationUrl&quot;
-#  define LN_netscape_revocation_url      &quot;Netscape Revocation Url&quot;
-#  define NID_netscape_revocation_url     73
-#  define OBJ_netscape_revocation_url     OBJ_netscape_cert_extension,3L
-
-#  define SN_netscape_ca_revocation_url   &quot;nsCaRevocationUrl&quot;
-#  define LN_netscape_ca_revocation_url   &quot;Netscape CA Revocation Url&quot;
-#  define NID_netscape_ca_revocation_url  74
-#  define OBJ_netscape_ca_revocation_url  OBJ_netscape_cert_extension,4L
-
-#  define SN_netscape_renewal_url         &quot;nsRenewalUrl&quot;
-#  define LN_netscape_renewal_url         &quot;Netscape Renewal Url&quot;
-#  define NID_netscape_renewal_url        75
-#  define OBJ_netscape_renewal_url        OBJ_netscape_cert_extension,7L
-
-#  define SN_netscape_ca_policy_url       &quot;nsCaPolicyUrl&quot;
-#  define LN_netscape_ca_policy_url       &quot;Netscape CA Policy Url&quot;
-#  define NID_netscape_ca_policy_url      76
-#  define OBJ_netscape_ca_policy_url      OBJ_netscape_cert_extension,8L
-
-#  define SN_netscape_ssl_server_name     &quot;nsSslServerName&quot;
-#  define LN_netscape_ssl_server_name     &quot;Netscape SSL Server Name&quot;
-#  define NID_netscape_ssl_server_name    77
-#  define OBJ_netscape_ssl_server_name    OBJ_netscape_cert_extension,12L
-
-#  define SN_netscape_comment             &quot;nsComment&quot;
-#  define LN_netscape_comment             &quot;Netscape Comment&quot;
-#  define NID_netscape_comment            78
-#  define OBJ_netscape_comment            OBJ_netscape_cert_extension,13L
-
-#  define SN_netscape_cert_sequence       &quot;nsCertSequence&quot;
-#  define LN_netscape_cert_sequence       &quot;Netscape Certificate Sequence&quot;
-#  define NID_netscape_cert_sequence      79
-#  define OBJ_netscape_cert_sequence      OBJ_netscape_data_type,5L
-
-#  define SN_desx_cbc                     &quot;DESX-CBC&quot;
-#  define LN_desx_cbc                     &quot;desx-cbc&quot;
-#  define NID_desx_cbc                    80
-
-#  define SN_id_ce                        &quot;id-ce&quot;
-#  define NID_id_ce                       81
-#  define OBJ_id_ce                       2L,5L,29L
-
-#  define SN_subject_key_identifier       &quot;subjectKeyIdentifier&quot;
-#  define LN_subject_key_identifier       &quot;X509v3 Subject Key Identifier&quot;
-#  define NID_subject_key_identifier      82
-#  define OBJ_subject_key_identifier      OBJ_id_ce,14L
-
-#  define SN_key_usage                    &quot;keyUsage&quot;
-#  define LN_key_usage                    &quot;X509v3 Key Usage&quot;
-#  define NID_key_usage                   83
-#  define OBJ_key_usage                   OBJ_id_ce,15L
-
-#  define SN_private_key_usage_period     &quot;privateKeyUsagePeriod&quot;
-#  define LN_private_key_usage_period     &quot;X509v3 Private Key Usage Period&quot;
-#  define NID_private_key_usage_period    84
-#  define OBJ_private_key_usage_period    OBJ_id_ce,16L
-
-#  define SN_subject_alt_name             &quot;subjectAltName&quot;
-#  define LN_subject_alt_name             &quot;X509v3 Subject Alternative Name&quot;
-#  define NID_subject_alt_name            85
-#  define OBJ_subject_alt_name            OBJ_id_ce,17L
-
-#  define SN_issuer_alt_name              &quot;issuerAltName&quot;
-#  define LN_issuer_alt_name              &quot;X509v3 Issuer Alternative Name&quot;
-#  define NID_issuer_alt_name             86
-#  define OBJ_issuer_alt_name             OBJ_id_ce,18L
-
-#  define SN_basic_constraints            &quot;basicConstraints&quot;
-#  define LN_basic_constraints            &quot;X509v3 Basic Constraints&quot;
-#  define NID_basic_constraints           87
-#  define OBJ_basic_constraints           OBJ_id_ce,19L
-
-#  define SN_crl_number                   &quot;crlNumber&quot;
-#  define LN_crl_number                   &quot;X509v3 CRL Number&quot;
-#  define NID_crl_number                  88
-#  define OBJ_crl_number                  OBJ_id_ce,20L
-
-#  define SN_certificate_policies         &quot;certificatePolicies&quot;
-#  define LN_certificate_policies         &quot;X509v3 Certificate Policies&quot;
-#  define NID_certificate_policies        89
-#  define OBJ_certificate_policies        OBJ_id_ce,32L
-
-#  define SN_authority_key_identifier     &quot;authorityKeyIdentifier&quot;
-#  define LN_authority_key_identifier     &quot;X509v3 Authority Key Identifier&quot;
-#  define NID_authority_key_identifier    90
-#  define OBJ_authority_key_identifier    OBJ_id_ce,35L
-
-#  define SN_bf_cbc                       &quot;BF-CBC&quot;
-#  define LN_bf_cbc                       &quot;bf-cbc&quot;
-#  define NID_bf_cbc                      91
-#  define OBJ_bf_cbc                      1L,3L,6L,1L,4L,1L,3029L,1L,2L
-
-#  define SN_bf_ecb                       &quot;BF-ECB&quot;
-#  define LN_bf_ecb                       &quot;bf-ecb&quot;
-#  define NID_bf_ecb                      92
-
-#  define SN_bf_cfb64                     &quot;BF-CFB&quot;
-#  define LN_bf_cfb64                     &quot;bf-cfb&quot;
-#  define NID_bf_cfb64                    93
-
-#  define SN_bf_ofb64                     &quot;BF-OFB&quot;
-#  define LN_bf_ofb64                     &quot;bf-ofb&quot;
-#  define NID_bf_ofb64                    94
-
-#  define SN_mdc2                         &quot;MDC2&quot;
-#  define LN_mdc2                         &quot;mdc2&quot;
-#  define NID_mdc2                        95
-#  define OBJ_mdc2                        2L,5L,8L,3L,101L
-/* An alternative?                      1L,3L,14L,3L,2L,19L */
-
-#  define SN_mdc2WithRSA                  &quot;RSA-MDC2&quot;
-#  define LN_mdc2WithRSA                  &quot;mdc2withRSA&quot;
-#  define NID_mdc2WithRSA                 96
-#  define OBJ_mdc2WithRSA                 2L,5L,8L,3L,100L
-
-#  define SN_rc4_40                       &quot;RC4-40&quot;
-#  define LN_rc4_40                       &quot;rc4-40&quot;
-#  define NID_rc4_40                      97
-
-#  define SN_rc2_40_cbc                   &quot;RC2-40-CBC&quot;
-#  define LN_rc2_40_cbc                   &quot;rc2-40-cbc&quot;
-#  define NID_rc2_40_cbc                  98
-
-#  define SN_givenName                    &quot;G&quot;
-#  define LN_givenName                    &quot;givenName&quot;
-#  define NID_givenName                   99
-#  define OBJ_givenName                   OBJ_X509,42L
-
-#  define SN_surname                      &quot;S&quot;
-#  define LN_surname                      &quot;surname&quot;
-#  define NID_surname                     100
-#  define OBJ_surname                     OBJ_X509,4L
-
-#  define SN_initials                     &quot;I&quot;
-#  define LN_initials                     &quot;initials&quot;
-#  define NID_initials                    101
-#  define OBJ_initials                    OBJ_X509,43L
-
-#  define SN_uniqueIdentifier             &quot;UID&quot;
-#  define LN_uniqueIdentifier             &quot;uniqueIdentifier&quot;
-#  define NID_uniqueIdentifier            102
-#  define OBJ_uniqueIdentifier            OBJ_X509,45L
-
-#  define SN_crl_distribution_points      &quot;crlDistributionPoints&quot;
-#  define LN_crl_distribution_points      &quot;X509v3 CRL Distribution Points&quot;
-#  define NID_crl_distribution_points     103
-#  define OBJ_crl_distribution_points     OBJ_id_ce,31L
-
-#  define SN_md5WithRSA                   &quot;RSA-NP-MD5&quot;
-#  define LN_md5WithRSA                   &quot;md5WithRSA&quot;
-#  define NID_md5WithRSA                  104
-#  define OBJ_md5WithRSA                  OBJ_algorithm,3L
-
-#  define SN_serialNumber                 &quot;SN&quot;
-#  define LN_serialNumber                 &quot;serialNumber&quot;
-#  define NID_serialNumber                105
-#  define OBJ_serialNumber                OBJ_X509,5L
-
-#  define SN_title                        &quot;T&quot;
-#  define LN_title                        &quot;title&quot;
-#  define NID_title                       106
-#  define OBJ_title                       OBJ_X509,12L
-
-#  define SN_description                  &quot;D&quot;
-#  define LN_description                  &quot;description&quot;
-#  define NID_description                 107
-#  define OBJ_description                 OBJ_X509,13L
-
-/* CAST5 is CAST-128, I'm just sticking with the documentation */
-#  define SN_cast5_cbc                    &quot;CAST5-CBC&quot;
-#  define LN_cast5_cbc                    &quot;cast5-cbc&quot;
-#  define NID_cast5_cbc                   108
-#  define OBJ_cast5_cbc                   1L,2L,840L,113533L,7L,66L,10L
-
-#  define SN_cast5_ecb                    &quot;CAST5-ECB&quot;
-#  define LN_cast5_ecb                    &quot;cast5-ecb&quot;
-#  define NID_cast5_ecb                   109
-
-#  define SN_cast5_cfb64                  &quot;CAST5-CFB&quot;
-#  define LN_cast5_cfb64                  &quot;cast5-cfb&quot;
-#  define NID_cast5_cfb64                 110
-
-#  define SN_cast5_ofb64                  &quot;CAST5-OFB&quot;
-#  define LN_cast5_ofb64                  &quot;cast5-ofb&quot;
-#  define NID_cast5_ofb64                 111
-
-#  define LN_pbeWithMD5AndCast5_CBC       &quot;pbeWithMD5AndCast5CBC&quot;
-#  define NID_pbeWithMD5AndCast5_CBC      112
-#  define OBJ_pbeWithMD5AndCast5_CBC      1L,2L,840L,113533L,7L,66L,12L
-
-/*-
- * This is one sun will soon be using :-(
- * id-dsa-with-sha1 ID  ::= {
- *   iso(1) member-body(2) us(840) x9-57 (10040) x9cm(4) 3 }
- */
-#  define SN_dsaWithSHA1                  &quot;DSA-SHA1&quot;
-#  define LN_dsaWithSHA1                  &quot;dsaWithSHA1&quot;
-#  define NID_dsaWithSHA1                 113
-#  define OBJ_dsaWithSHA1                 1L,2L,840L,10040L,4L,3L
-
-#  define NID_md5_sha1                    114
-#  define SN_md5_sha1                     &quot;MD5-SHA1&quot;
-#  define LN_md5_sha1                     &quot;md5-sha1&quot;
-
-#  define SN_sha1WithRSA                  &quot;RSA-SHA1-2&quot;
-#  define LN_sha1WithRSA                  &quot;sha1WithRSA&quot;
-#  define NID_sha1WithRSA                 115
-#  define OBJ_sha1WithRSA                 OBJ_algorithm,29L
-
-#  define SN_dsa                          &quot;DSA&quot;
-#  define LN_dsa                          &quot;dsaEncryption&quot;
-#  define NID_dsa                         116
-#  define OBJ_dsa                         1L,2L,840L,10040L,4L,1L
-
-#  define SN_ripemd160                    &quot;RIPEMD160&quot;
-#  define LN_ripemd160                    &quot;ripemd160&quot;
-#  define NID_ripemd160                   117
-#  define OBJ_ripemd160                   1L,3L,36L,3L,2L,1L
-
-/*
- * The name should actually be rsaSignatureWithripemd160, but I'm going to
- * continue using the convention I'm using with the other ciphers
- */
-#  define SN_ripemd160WithRSA             &quot;RSA-RIPEMD160&quot;
-#  define LN_ripemd160WithRSA             &quot;ripemd160WithRSA&quot;
-#  define NID_ripemd160WithRSA            119
-#  define OBJ_ripemd160WithRSA            1L,3L,36L,3L,3L,1L,2L
-
-/*-
- * Taken from rfc2040
- *  RC5_CBC_Parameters ::= SEQUENCE {
- *      version           INTEGER (v1_0(16)),
- *      rounds            INTEGER (8..127),
- *      blockSizeInBits   INTEGER (64, 128),
- *      iv                OCTET STRING OPTIONAL
- *      }
- */
-#  define SN_rc5_cbc                      &quot;RC5-CBC&quot;
-#  define LN_rc5_cbc                      &quot;rc5-cbc&quot;
-#  define NID_rc5_cbc                     120
-#  define OBJ_rc5_cbc                     OBJ_rsadsi,3L,8L
-
-#  define SN_rc5_ecb                      &quot;RC5-ECB&quot;
-#  define LN_rc5_ecb                      &quot;rc5-ecb&quot;
-#  define NID_rc5_ecb                     121
-
-#  define SN_rc5_cfb64                    &quot;RC5-CFB&quot;
-#  define LN_rc5_cfb64                    &quot;rc5-cfb&quot;
-#  define NID_rc5_cfb64                   122
-
-#  define SN_rc5_ofb64                    &quot;RC5-OFB&quot;
-#  define LN_rc5_ofb64                    &quot;rc5-ofb&quot;
-#  define NID_rc5_ofb64                   123
-
-#  define SN_rle_compression              &quot;RLE&quot;
-#  define LN_rle_compression              &quot;run length compression&quot;
-#  define NID_rle_compression             124
-#  define OBJ_rle_compression             1L,1L,1L,1L,666L,1L
-
-#  define SN_zlib_compression             &quot;ZLIB&quot;
-#  define LN_zlib_compression             &quot;zlib compression&quot;
-#  define NID_zlib_compression            125
-#  define OBJ_zlib_compression            1L,1L,1L,1L,666L,2L
-
-#  define SN_ext_key_usage                &quot;extendedKeyUsage&quot;
-#  define LN_ext_key_usage                &quot;X509v3 Extended Key Usage&quot;
-#  define NID_ext_key_usage               126
-#  define OBJ_ext_key_usage               OBJ_id_ce,37
-
-#  define SN_id_pkix                      &quot;PKIX&quot;
-#  define NID_id_pkix                     127
-#  define OBJ_id_pkix                     1L,3L,6L,1L,5L,5L,7L
-
-#  define SN_id_kp                        &quot;id-kp&quot;
-#  define NID_id_kp                       128
-#  define OBJ_id_kp                       OBJ_id_pkix,3L
-
-/* PKIX extended key usage OIDs */
-
-#  define SN_server_auth                  &quot;serverAuth&quot;
-#  define LN_server_auth                  &quot;TLS Web Server Authentication&quot;
-#  define NID_server_auth                 129
-#  define OBJ_server_auth                 OBJ_id_kp,1L
-
-#  define SN_client_auth                  &quot;clientAuth&quot;
-#  define LN_client_auth                  &quot;TLS Web Client Authentication&quot;
-#  define NID_client_auth                 130
-#  define OBJ_client_auth                 OBJ_id_kp,2L
-
-#  define SN_code_sign                    &quot;codeSigning&quot;
-#  define LN_code_sign                    &quot;Code Signing&quot;
-#  define NID_code_sign                   131
-#  define OBJ_code_sign                   OBJ_id_kp,3L
-
-#  define SN_email_protect                &quot;emailProtection&quot;
-#  define LN_email_protect                &quot;E-mail Protection&quot;
-#  define NID_email_protect               132
-#  define OBJ_email_protect               OBJ_id_kp,4L
-
-#  define SN_time_stamp                   &quot;timeStamping&quot;
-#  define LN_time_stamp                   &quot;Time Stamping&quot;
-#  define NID_time_stamp                  133
-#  define OBJ_time_stamp                  OBJ_id_kp,8L
-
-/* Additional extended key usage OIDs: Microsoft */
-
-#  define SN_ms_code_ind                  &quot;msCodeInd&quot;
-#  define LN_ms_code_ind                  &quot;Microsoft Individual Code Signing&quot;
-#  define NID_ms_code_ind                 134
-#  define OBJ_ms_code_ind                 1L,3L,6L,1L,4L,1L,311L,2L,1L,21L
-
-#  define SN_ms_code_com                  &quot;msCodeCom&quot;
-#  define LN_ms_code_com                  &quot;Microsoft Commercial Code Signing&quot;
-#  define NID_ms_code_com                 135
-#  define OBJ_ms_code_com                 1L,3L,6L,1L,4L,1L,311L,2L,1L,22L
-
-#  define SN_ms_ctl_sign                  &quot;msCTLSign&quot;
-#  define LN_ms_ctl_sign                  &quot;Microsoft Trust List Signing&quot;
-#  define NID_ms_ctl_sign                 136
-#  define OBJ_ms_ctl_sign                 1L,3L,6L,1L,4L,1L,311L,10L,3L,1L
-
-#  define SN_ms_sgc                       &quot;msSGC&quot;
-#  define LN_ms_sgc                       &quot;Microsoft Server Gated Crypto&quot;
-#  define NID_ms_sgc                      137
-#  define OBJ_ms_sgc                      1L,3L,6L,1L,4L,1L,311L,10L,3L,3L
-
-#  define SN_ms_efs                       &quot;msEFS&quot;
-#  define LN_ms_efs                       &quot;Microsoft Encrypted File System&quot;
-#  define NID_ms_efs                      138
-#  define OBJ_ms_efs                      1L,3L,6L,1L,4L,1L,311L,10L,3L,4L
-
-/* Additional usage: Netscape */
-
-#  define SN_ns_sgc                       &quot;nsSGC&quot;
-#  define LN_ns_sgc                       &quot;Netscape Server Gated Crypto&quot;
-#  define NID_ns_sgc                      139
-#  define OBJ_ns_sgc                      OBJ_netscape,4L,1L
-
-#  define SN_delta_crl                    &quot;deltaCRL&quot;
-#  define LN_delta_crl                    &quot;X509v3 Delta CRL Indicator&quot;
-#  define NID_delta_crl                   140
-#  define OBJ_delta_crl                   OBJ_id_ce,27L
-
-#  define SN_crl_reason                   &quot;CRLReason&quot;
-#  define LN_crl_reason                   &quot;CRL Reason Code&quot;
-#  define NID_crl_reason                  141
-#  define OBJ_crl_reason                  OBJ_id_ce,21L
-
-#  define SN_invalidity_date              &quot;invalidityDate&quot;
-#  define LN_invalidity_date              &quot;Invalidity Date&quot;
-#  define NID_invalidity_date             142
-#  define OBJ_invalidity_date             OBJ_id_ce,24L
-
-#  define SN_sxnet                        &quot;SXNetID&quot;
-#  define LN_sxnet                        &quot;Strong Extranet ID&quot;
-#  define NID_sxnet                       143
-#  define OBJ_sxnet                       1L,3L,101L,1L,4L,1L
-
-/* PKCS12 and related OBJECT IDENTIFIERS */
-
-#  define OBJ_pkcs12                      OBJ_pkcs,12L
-#  define OBJ_pkcs12_pbeids               OBJ_pkcs12, 1
-
-#  define SN_pbe_WithSHA1And128BitRC4     &quot;PBE-SHA1-RC4-128&quot;
-#  define LN_pbe_WithSHA1And128BitRC4     &quot;pbeWithSHA1And128BitRC4&quot;
-#  define NID_pbe_WithSHA1And128BitRC4    144
-#  define OBJ_pbe_WithSHA1And128BitRC4    OBJ_pkcs12_pbeids, 1L
-
-#  define SN_pbe_WithSHA1And40BitRC4      &quot;PBE-SHA1-RC4-40&quot;
-#  define LN_pbe_WithSHA1And40BitRC4      &quot;pbeWithSHA1And40BitRC4&quot;
-#  define NID_pbe_WithSHA1And40BitRC4     145
-#  define OBJ_pbe_WithSHA1And40BitRC4     OBJ_pkcs12_pbeids, 2L
-
-#  define SN_pbe_WithSHA1And3_Key_TripleDES_CBC   &quot;PBE-SHA1-3DES&quot;
-#  define LN_pbe_WithSHA1And3_Key_TripleDES_CBC   &quot;pbeWithSHA1And3-KeyTripleDES-CBC&quot;
-#  define NID_pbe_WithSHA1And3_Key_TripleDES_CBC  146
-#  define OBJ_pbe_WithSHA1And3_Key_TripleDES_CBC  OBJ_pkcs12_pbeids, 3L
-
-#  define SN_pbe_WithSHA1And2_Key_TripleDES_CBC   &quot;PBE-SHA1-2DES&quot;
-#  define LN_pbe_WithSHA1And2_Key_TripleDES_CBC   &quot;pbeWithSHA1And2-KeyTripleDES-CBC&quot;
-#  define NID_pbe_WithSHA1And2_Key_TripleDES_CBC  147
-#  define OBJ_pbe_WithSHA1And2_Key_TripleDES_CBC  OBJ_pkcs12_pbeids, 4L
-
-#  define SN_pbe_WithSHA1And128BitRC2_CBC         &quot;PBE-SHA1-RC2-128&quot;
-#  define LN_pbe_WithSHA1And128BitRC2_CBC         &quot;pbeWithSHA1And128BitRC2-CBC&quot;
-#  define NID_pbe_WithSHA1And128BitRC2_CBC        148
-#  define OBJ_pbe_WithSHA1And128BitRC2_CBC        OBJ_pkcs12_pbeids, 5L
-
-#  define SN_pbe_WithSHA1And40BitRC2_CBC  &quot;PBE-SHA1-RC2-40&quot;
-#  define LN_pbe_WithSHA1And40BitRC2_CBC  &quot;pbeWithSHA1And40BitRC2-CBC&quot;
-#  define NID_pbe_WithSHA1And40BitRC2_CBC 149
-#  define OBJ_pbe_WithSHA1And40BitRC2_CBC OBJ_pkcs12_pbeids, 6L
-
-#  define OBJ_pkcs12_Version1     OBJ_pkcs12, 10L
-
-#  define OBJ_pkcs12_BagIds       OBJ_pkcs12_Version1, 1L
-
-#  define LN_keyBag               &quot;keyBag&quot;
-#  define NID_keyBag              150
-#  define OBJ_keyBag              OBJ_pkcs12_BagIds, 1L
-
-#  define LN_pkcs8ShroudedKeyBag  &quot;pkcs8ShroudedKeyBag&quot;
-#  define NID_pkcs8ShroudedKeyBag 151
-#  define OBJ_pkcs8ShroudedKeyBag OBJ_pkcs12_BagIds, 2L
-
-#  define LN_certBag              &quot;certBag&quot;
-#  define NID_certBag             152
-#  define OBJ_certBag             OBJ_pkcs12_BagIds, 3L
-
-#  define LN_crlBag               &quot;crlBag&quot;
-#  define NID_crlBag              153
-#  define OBJ_crlBag              OBJ_pkcs12_BagIds, 4L
-
-#  define LN_secretBag            &quot;secretBag&quot;
-#  define NID_secretBag           154
-#  define OBJ_secretBag           OBJ_pkcs12_BagIds, 5L
-
-#  define LN_safeContentsBag      &quot;safeContentsBag&quot;
-#  define NID_safeContentsBag     155
-#  define OBJ_safeContentsBag     OBJ_pkcs12_BagIds, 6L
-
-#  define LN_friendlyName         &quot;friendlyName&quot;
-#  define NID_friendlyName        156
-#  define OBJ_friendlyName        OBJ_pkcs9, 20L
-
-#  define LN_localKeyID           &quot;localKeyID&quot;
-#  define NID_localKeyID          157
-#  define OBJ_localKeyID          OBJ_pkcs9, 21L
-
-#  define OBJ_certTypes           OBJ_pkcs9, 22L
-
-#  define LN_x509Certificate      &quot;x509Certificate&quot;
-#  define NID_x509Certificate     158
-#  define OBJ_x509Certificate     OBJ_certTypes, 1L
-
-#  define LN_sdsiCertificate      &quot;sdsiCertificate&quot;
-#  define NID_sdsiCertificate     159
-#  define OBJ_sdsiCertificate     OBJ_certTypes, 2L
-
-#  define OBJ_crlTypes            OBJ_pkcs9, 23L
-
-#  define LN_x509Crl              &quot;x509Crl&quot;
-#  define NID_x509Crl             160
-#  define OBJ_x509Crl             OBJ_crlTypes, 1L
-
-/* PKCS#5 v2 OIDs */
-
-#  define LN_pbes2                &quot;PBES2&quot;
-#  define NID_pbes2               161
-#  define OBJ_pbes2               OBJ_pkcs,5L,13L
-
-#  define LN_pbmac1               &quot;PBMAC1&quot;
-#  define NID_pbmac1              162
-#  define OBJ_pbmac1              OBJ_pkcs,5L,14L
-
-#  define LN_hmacWithSHA1         &quot;hmacWithSHA1&quot;
-#  define NID_hmacWithSHA1        163
-#  define OBJ_hmacWithSHA1        OBJ_rsadsi,2L,7L
-
-/* Policy Qualifier Ids */
-
-#  define LN_id_qt_cps            &quot;Policy Qualifier CPS&quot;
-#  define SN_id_qt_cps            &quot;id-qt-cps&quot;
-#  define NID_id_qt_cps           164
-#  define OBJ_id_qt_cps           OBJ_id_pkix,2L,1L
-
-#  define LN_id_qt_unotice        &quot;Policy Qualifier User Notice&quot;
-#  define SN_id_qt_unotice        &quot;id-qt-unotice&quot;
-#  define NID_id_qt_unotice       165
-#  define OBJ_id_qt_unotice       OBJ_id_pkix,2L,2L
-
-#  define SN_rc2_64_cbc                   &quot;RC2-64-CBC&quot;
-#  define LN_rc2_64_cbc                   &quot;rc2-64-cbc&quot;
-#  define NID_rc2_64_cbc                  166
-
-#  define SN_SMIMECapabilities            &quot;SMIME-CAPS&quot;
-#  define LN_SMIMECapabilities            &quot;S/MIME Capabilities&quot;
-#  define NID_SMIMECapabilities           167
-#  define OBJ_SMIMECapabilities           OBJ_pkcs9,15L
-
-#  define SN_pbeWithMD2AndRC2_CBC         &quot;PBE-MD2-RC2-64&quot;
-#  define LN_pbeWithMD2AndRC2_CBC         &quot;pbeWithMD2AndRC2-CBC&quot;
-#  define NID_pbeWithMD2AndRC2_CBC        168
-#  define OBJ_pbeWithMD2AndRC2_CBC        OBJ_pkcs,5L,4L
-
-#  define SN_pbeWithMD5AndRC2_CBC         &quot;PBE-MD5-RC2-64&quot;
-#  define LN_pbeWithMD5AndRC2_CBC         &quot;pbeWithMD5AndRC2-CBC&quot;
-#  define NID_pbeWithMD5AndRC2_CBC        169
-#  define OBJ_pbeWithMD5AndRC2_CBC        OBJ_pkcs,5L,6L
-
-#  define SN_pbeWithSHA1AndDES_CBC        &quot;PBE-SHA1-DES&quot;
-#  define LN_pbeWithSHA1AndDES_CBC        &quot;pbeWithSHA1AndDES-CBC&quot;
-#  define NID_pbeWithSHA1AndDES_CBC       170
-#  define OBJ_pbeWithSHA1AndDES_CBC       OBJ_pkcs,5L,10L
-
-/* Extension request OIDs */
-
-#  define LN_ms_ext_req                   &quot;Microsoft Extension Request&quot;
-#  define SN_ms_ext_req                   &quot;msExtReq&quot;
-#  define NID_ms_ext_req                  171
-#  define OBJ_ms_ext_req                  1L,3L,6L,1L,4L,1L,311L,2L,1L,14L
-
-#  define LN_ext_req                      &quot;Extension Request&quot;
-#  define SN_ext_req                      &quot;extReq&quot;
-#  define NID_ext_req                     172
-#  define OBJ_ext_req                     OBJ_pkcs9,14L
-
-#  define SN_name                         &quot;name&quot;
-#  define LN_name                         &quot;name&quot;
-#  define NID_name                        173
-#  define OBJ_name                        OBJ_X509,41L
-
-#  define SN_dnQualifier                  &quot;dnQualifier&quot;
-#  define LN_dnQualifier                  &quot;dnQualifier&quot;
-#  define NID_dnQualifier                 174
-#  define OBJ_dnQualifier                 OBJ_X509,46L
-
-#  define SN_id_pe                        &quot;id-pe&quot;
-#  define NID_id_pe                       175
-#  define OBJ_id_pe                       OBJ_id_pkix,1L
-
-#  define SN_id_ad                        &quot;id-ad&quot;
-#  define NID_id_ad                       176
-#  define OBJ_id_ad                       OBJ_id_pkix,48L
-
-#  define SN_info_access                  &quot;authorityInfoAccess&quot;
-#  define LN_info_access                  &quot;Authority Information Access&quot;
-#  define NID_info_access                 177
-#  define OBJ_info_access                 OBJ_id_pe,1L
-
-#  define SN_ad_OCSP                      &quot;OCSP&quot;
-#  define LN_ad_OCSP                      &quot;OCSP&quot;
-#  define NID_ad_OCSP                     178
-#  define OBJ_ad_OCSP                     OBJ_id_ad,1L
-
-#  define SN_ad_ca_issuers                &quot;caIssuers&quot;
-#  define LN_ad_ca_issuers                &quot;CA Issuers&quot;
-#  define NID_ad_ca_issuers               179
-#  define OBJ_ad_ca_issuers               OBJ_id_ad,2L
-
-#  define SN_OCSP_sign                    &quot;OCSPSigning&quot;
-#  define LN_OCSP_sign                    &quot;OCSP Signing&quot;
-#  define NID_OCSP_sign                   180
-#  define OBJ_OCSP_sign                   OBJ_id_kp,9L
-# endif                         /* USE_OBJ_MAC */
-
+# include &lt;openssl/obj_mac.h&gt;
 # include &lt;openssl/bio.h&gt;
 # include &lt;openssl/asn1.h&gt;
 
diff --git a/ssl/d1_msg.c b/ssl/d1_msg.c
index ac6d284..a8253b9 100644
--- a/ssl/d1_msg.c
+++ b/ssl/d1_msg.c
@@ -59,23 +59,12 @@ int dtls1_dispatch_alert(SSL *s)
     *ptr++ = s-&gt;s3-&gt;send_alert[0];
     *ptr++ = s-&gt;s3-&gt;send_alert[1];
 
-#ifdef DTLS1_AD_MISSING_HANDSHAKE_MESSAGE
-    if (s-&gt;s3-&gt;send_alert[1] == DTLS1_AD_MISSING_HANDSHAKE_MESSAGE) {
-        s2n(s-&gt;d1-&gt;handshake_read_seq, ptr);
-        l2n3(s-&gt;d1-&gt;r_msg_hdr.frag_off, ptr);
-    }
-#endif
-
     i = do_dtls1_write(s, SSL3_RT_ALERT, &amp;buf[0], sizeof(buf), 0, &amp;written);
     if (i &lt;= 0) {
         s-&gt;s3-&gt;alert_dispatch = 1;
         /* fprintf( stderr, &quot;not done with alert\n&quot; ); */
     } else {
-        if (s-&gt;s3-&gt;send_alert[0] == SSL3_AL_FATAL
-#ifdef DTLS1_AD_MISSING_HANDSHAKE_MESSAGE
-            || s-&gt;s3-&gt;send_alert[1] == DTLS1_AD_MISSING_HANDSHAKE_MESSAGE
-#endif
-            )
+        if (s-&gt;s3-&gt;send_alert[0] == SSL3_AL_FATAL)
             (void)BIO_flush(s-&gt;wbio);
 
         if (s-&gt;msg_callback)
diff --git a/ssl/record/rec_layer_d1.c b/ssl/record/rec_layer_d1.c
index 28da0da..cd6343a 100644
--- a/ssl/record/rec_layer_d1.c
+++ b/ssl/record/rec_layer_d1.c
@@ -599,14 +599,6 @@ int dtls1_read_bytes(SSL *s, int type, int *recvd_type, unsigned char *buf,
              * fragmented--don't always expect dest_maxlen bytes
              */
             if (SSL3_RECORD_get_length(rr) &lt; dest_maxlen) {
-#ifdef DTLS1_AD_MISSING_HANDSHAKE_MESSAGE
-                /*
-                 * for normal alerts rr-&gt;length is 2, while
-                 * dest_maxlen is 7 if we were to handle this
-                 * non-existing alert...
-                 */
-                FIX ME;
-#endif
                 s-&gt;rlayer.rstate = SSL_ST_READ_HEADER;
                 SSL3_RECORD_set_length(rr, 0);
                 goto start;
@@ -678,34 +670,6 @@ int dtls1_read_bytes(SSL *s, int type, int *recvd_type, unsigned char *buf,
                 s-&gt;shutdown |= SSL_RECEIVED_SHUTDOWN;
                 return 0;
             }
-#if 0
-            /* XXX: this is a possible improvement in the future */
-            /* now check if it's a missing record */
-            if (alert_descr == DTLS1_AD_MISSING_HANDSHAKE_MESSAGE) {
-                unsigned short seq;
-                unsigned int frag_off;
-                unsigned char *p = &amp;(s-&gt;rlayer.d-&gt;alert_fragment[2]);
-
-                n2s(p, seq);
-                n2l3(p, frag_off);
-
-                dtls1_retransmit_message(s,
-                                         dtls1_get_queue_priority
-                                         (frag-&gt;msg_header.seq, 0), frag_off,
-                                         &amp;found);
-                if (!found &amp;&amp; SSL_in_init(s)) {
-                    /*
-                     * fprintf( stderr,&quot;in init = %d\n&quot;, SSL_in_init(s));
-                     */
-                    /*
-                     * requested a message not yet sent, send an alert
-                     * ourselves
-                     */
-                    ssl3_send_alert(s, SSL3_AL_WARNING,
-                                    DTLS1_AD_MISSING_HANDSHAKE_MESSAGE);
-                }
-            }
-#endif
         } else if (alert_level == SSL3_AL_FATAL) {
             char tmp[16];
 
diff --git a/ssl/record/rec_layer_s3.c b/ssl/record/rec_layer_s3.c
index 7da07ea..37f7cd3 100644
--- a/ssl/record/rec_layer_s3.c
+++ b/ssl/record/rec_layer_s3.c
@@ -1429,10 +1429,6 @@ int ssl3_read_bytes(SSL *s, int type, int *recvd_type, unsigned char *buf,
                 SSLerr(SSL_F_SSL3_READ_BYTES, SSL_R_NO_RENEGOTIATION);
                 goto f_err;
             }
-#ifdef SSL_AD_MISSING_SRP_USERNAME
-            else if (alert_descr == SSL_AD_MISSING_SRP_USERNAME)
-                return (0);
-#endif
         } else if (alert_level == SSL3_AL_FATAL) {
             char tmp[16];
 
diff --git a/ssl/ssl_ciph.c b/ssl/ssl_ciph.c
index 5fe2117..be33ff3 100644
--- a/ssl/ssl_ciph.c
+++ b/ssl/ssl_ciph.c
@@ -388,9 +388,6 @@ void ssl_load_ciphers(void)
                 disabled_enc_mask |= t-&gt;mask;
         }
     }
-#ifdef SSL_FORBID_ENULL
-    disabled_enc_mask |= SSL_eNULL;
-#endif
     disabled_mac_mask = 0;
     for (i = 0, t = ssl_cipher_table_mac; i &lt; SSL_MD_NUM_IDX; i++, t++) {
         const EVP_MD *md = EVP_get_digestbynid(t-&gt;nid);
diff --git a/ssl/ssl_locl.h b/ssl/ssl_locl.h
index 565fa36..a7b21b2 100644
--- a/ssl/ssl_locl.h
+++ b/ssl/ssl_locl.h
@@ -73,8 +73,6 @@
 #  define OPENSSL_EXTERN OPENSSL_EXPORT
 # endif
 
-# undef PKCS1_CHECK
-
 # define c2l(c,l)        (l = ((unsigned long)(*((c)++)))     , \
                          l|=(((unsigned long)(*((c)++)))&lt;&lt; 8), \
                          l|=(((unsigned long)(*((c)++)))&lt;&lt;16), \
diff --git a/ssl/statem/statem_clnt.c b/ssl/statem/statem_clnt.c
index 52f192d..1943f55 100644
--- a/ssl/statem/statem_clnt.c
+++ b/ssl/statem/statem_clnt.c
@@ -2752,12 +2752,6 @@ static int tls_construct_cke_rsa(SSL *s, WPACKET *pkt, int *al)
     }
     EVP_PKEY_CTX_free(pctx);
     pctx = NULL;
-# ifdef PKCS1_CHECK
-    if (s-&gt;options &amp; SSL_OP_PKCS1_CHECK_1)
-        (*p)[1]++;
-    if (s-&gt;options &amp; SSL_OP_PKCS1_CHECK_2)
-        tmp_buf[0] = 0x70;
-# endif
 
     /* Fix buf for TLS and beyond */
     if (s-&gt;version &gt; SSL3_VERSION &amp;&amp; !WPACKET_close(pkt)) {
diff --git a/test/build.info b/test/build.info
index 12805c7..6bdeb85 100644
--- a/test/build.info
+++ b/test/build.info
@@ -47,7 +47,7 @@ IF[{- !$disabled{tests} -}]
   DEPEND[bntest]=../libcrypto
 
   SOURCE[ectest]=ectest.c
-  INCLUDE[ectest]=../include
+  INCLUDE[ectest]=.. ../include
   DEPEND[ectest]=../libcrypto
 
   SOURCE[ecdsatest]=ecdsatest.c
diff --git a/test/ectest.c b/test/ectest.c
index 0dd0ab8..bb2a08d 100644
--- a/test/ectest.c
+++ b/test/ectest.c
@@ -23,14 +23,11 @@
 
 #include &lt;stdio.h&gt;
 #include &lt;stdlib.h&gt;
-#ifdef FLAT_INC
-# include &quot;e_os.h&quot;
-#else
-# include &quot;../e_os.h&quot;
-#endif
 #include &lt;string.h&gt;
 #include &lt;time.h&gt;
 
+#include &quot;e_os.h&quot;
+
 #ifdef OPENSSL_NO_EC
 int main(int argc, char *argv[])
 {
diff --git a/test/rsa_test.c b/test/rsa_test.c
index 7d06394..a38be33 100644
--- a/test/rsa_test.c
+++ b/test/rsa_test.c
@@ -292,11 +292,7 @@ int main(int argc, char *argv[])
         } else if (memcmp(ctext, ctext_ex, num) == 0)
             printf(&quot;OAEP test vector %d passed!\n&quot;, v);
 
-        /*
-         * Different ciphertexts (rsa_oaep.c without -DPKCS_TESTVECT). Try
-         * decrypting ctext_ex
-         */
-
+        /* Different ciphertexts. Try decrypting ctext_ex */
         num = RSA_private_decrypt(clen, ctext_ex, ptext, key,
                                   RSA_PKCS1_OAEP_PADDING);
 
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013288.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="013312.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13308">[ date ]</a>
              <a href="thread.html#13308">[ thread ]</a>
              <a href="subject.html#13308">[ subject ]</a>
              <a href="author.html#13308">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
