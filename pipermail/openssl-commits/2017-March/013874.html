<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2017-March/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1490758785.872238.2826.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013866.html">
   <LINK REL="Next"  HREF="013877.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Rich Salz</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1490758785.872238.2826.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">rsalz at openssl.org
       </A><BR>
    <I>Wed Mar 29 03:39:45 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="013866.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="013877.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13874">[ date ]</a>
              <a href="thread.html#13874">[ thread ]</a>
              <a href="subject.html#13874">[ subject ]</a>
              <a href="author.html#13874">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  2fae041d6c507315a619e2f29bff86e44cc1d0a1 (commit)
      from  a6ac1ed686346d2164c16446624c973e51d3ae92 (commit)


- Log -----------------------------------------------------------------
commit 2fae041d6c507315a619e2f29bff86e44cc1d0a1
Author: Pauli &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">paul.dale at oracle.com</A>&gt;
Date:   Wed Mar 22 14:27:55 2017 +1000

    Test infrastructure additions.
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Emilia K&#228;sper &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">emilia at openssl.org</A>&gt;
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    Reviewed-by: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/3011">https://github.com/openssl/openssl/pull/3011</A>)

-----------------------------------------------------------------------

Summary of changes:
 test/README                                      |  49 +++-
 test/asn1_internal_test.c                        |   1 +
 test/build.info                                  |   6 +-
 test/cipherlist_test.c                           |  10 +-
 test/crltest.c                                   |  51 +++--
 test/lhash_test.c                                |  74 +++---
 test/mdc2_internal_test.c                        |   5 +-
 test/pkey_meth_test.c                            |   2 +-
 test/poly1305_internal_test.c                    |  10 +-
 test/recipes/{02-test_stack.t =&gt; 01-test_test.t} |   2 +-
 test/ssl_test.c                                  | 130 +++++------
 test/ssl_test_ctx_test.c                         | 169 ++++++--------
 test/stack_test.c                                | 137 +++++------
 test/test_test.c                                 | 276 +++++++++++++++++++++++
 test/testutil.c                                  | 275 +++++++++++++++++++++-
 test/testutil.h                                  | 168 +++++++++++++-
 test/tls13encryptiontest.c                       |  52 ++---
 test/tls13secretstest.c                          | 136 +++++------
 test/x509_internal_test.c                        |   2 +-
 test/x509_time_test.c                            |  14 +-
 20 files changed, 1115 insertions(+), 454 deletions(-)
 copy test/recipes/{02-test_stack.t =&gt; 01-test_test.t} (92%)
 create mode 100644 test/test_test.c

diff --git a/test/README b/test/README
index 3ecbf4d..cf7e4d4 100644
--- a/test/README
+++ b/test/README
@@ -86,25 +86,52 @@ A script to start from could be this:
     }
     
 
-Changes to test/Makefile
-========================
+Changes to test/build.info
+==========================
 
 Whenever a new test involves a new test executable you need to do the
 following (at all times, replace {NAME} and {name} with the name of your
 test):
 
-* among the variables for test executables at the beginning, add a line like
-  this:
+* add {name} to the list of programs under PROGRAMS_NO_INST
 
-    {NAME}TEST= {name}test
+* create a three line description of how to build the test, you will have
+to modify the include paths and source files if you don't want to use the
+basic test framework:
 
-* add `$({NAME}TEST)$(EXE_EXT)' to the assignment of EXE:
+    SOURCE[{name}]={name}.c testutil.c test_main.c
+    INCLUDE[{name}]=.. ../include
+    DEPEND[{name}]=../libcrypto
 
-* add `$({NAME}TEST).o' to the assignment of OBJ:
+Generic form of C test executables
+==================================
 
-* add `$({NAME}TEST).c' to the assignment of SRC:
+    #include &quot;test_main.h&quot;
+    #include &quot;testutil.h&quot;
 
-* add the following lines for building the executable:
+    static int my_test(void)
+    {
+        int testresult = 0;                 /* Assume the test will fail    */
+        int observed;
+
+        observed = function();              /* Call the code under test     */
+        if (!TEST_int_equal(observed, 2))   /* Check the result is correct  */
+            goto end;                       /* Exit on failure - optional   */
+
+        testresult = 1;                     /* Mark the test case a success */
+    end:
+        cleanup();                          /* Any cleanup you require      */
+        return testresult;
+    }
+
+    void register_tests(void)
+    {
+        ADD_TEST(my_test);                  /* Add each test separately     */
+    }
 
-    $({NAME}TEST)$(EXE_EXT): $({NAME}TEST).o $(DLIBCRYPTO)
-           @target=$({NAME}TEST); $(BUILD_CMD)
+You should use the TEST_xxx macros provided by testutil.h to test all failure
+conditions.  These macros produce an error message in a standard format if the
+condition is not met (and nothing if the condition is met).  Additional
+information can be presented with the TEST_info macro that takes a printf
+format string and arguments.  TEST_error is useful for complicated conditions,
+it also takes a printf format string and argument.
diff --git a/test/asn1_internal_test.c b/test/asn1_internal_test.c
index b7e8af0..f936098 100644
--- a/test/asn1_internal_test.c
+++ b/test/asn1_internal_test.c
@@ -82,6 +82,7 @@ static int test_standard_methods()
         return 1;
     }
 
+    TEST_error(&quot;asn1 standard methods out of order&quot;);
     for (tmp = standard_methods, i = 0; i &lt; OSSL_NELEM(standard_methods);
          i++, tmp++)
         fprintf(stderr, &quot;asn1 standard methods: Index %&quot; OSSLzu
diff --git a/test/build.info b/test/build.info
index 2e7737f..fbd6f94 100644
--- a/test/build.info
+++ b/test/build.info
@@ -11,7 +11,7 @@
 -}
 IF[{- !$disabled{tests} -}]
   PROGRAMS_NO_INST=\
-          aborttest \
+          aborttest test_test \
           sanitytest exdatatest bntest \
           ectest ecdsatest ecdhtest gmdifftest pbelutest ideatest \
           md2test \
@@ -38,6 +38,10 @@ IF[{- !$disabled{tests} -}]
   INCLUDE[sanitytest]=../include
   DEPEND[sanitytest]=../libcrypto
 
+  SOURCE[test_test]=test_test.c testutil.c test_main.c
+  INCLUDE[test_test]=.. ../include
+  DEPEND[test_test]=../libcrypto
+
   SOURCE[exdatatest]=exdatatest.c
   INCLUDE[exdatatest]=../include
   DEPEND[exdatatest]=../libcrypto
diff --git a/test/cipherlist_test.c b/test/cipherlist_test.c
index 0c344c9..0013994 100644
--- a/test/cipherlist_test.c
+++ b/test/cipherlist_test.c
@@ -136,18 +136,14 @@ static int test_default_cipherlist(SSL_CTX *ctx)
     OPENSSL_assert(ciphers != NULL);
     num_expected_ciphers = OSSL_NELEM(default_ciphers_in_order);
     num_ciphers = sk_SSL_CIPHER_num(ciphers);
-    if (num_ciphers != num_expected_ciphers) {
-        fprintf(stderr, &quot;Expected %d supported ciphers, got %d.\n&quot;,
-                num_expected_ciphers, num_ciphers);
+    if (!TEST_int_eq(num_ciphers, num_expected_ciphers))
         goto err;
-    }
 
     for (i = 0; i &lt; num_ciphers; i++) {
         expected_cipher_id = default_ciphers_in_order[i];
         cipher_id = SSL_CIPHER_get_id(sk_SSL_CIPHER_value(ciphers, i));
-        if (cipher_id != expected_cipher_id) {
-            fprintf(stderr, &quot;Wrong cipher at position %d: expected %x, &quot;
-                    &quot;got %x\n&quot;, i, expected_cipher_id, cipher_id);
+        if (!TEST_int_eq(cipher_id, expected_cipher_id)) {
+            TEST_info(&quot;Wrong cipher at position %d&quot;, i);
             goto err;
         }
     }
diff --git a/test/crltest.c b/test/crltest.c
index 11585ea..e633fd3 100644
--- a/test/crltest.c
+++ b/test/crltest.c
@@ -243,21 +243,27 @@ static int verify(X509 *leaf, X509 *root, STACK_OF(X509_CRL) *crls,
     STACK_OF(X509) *roots = sk_X509_new_null();
     int status = X509_V_ERR_UNSPECIFIED;
 
-    if (ctx == NULL || store == NULL || param == NULL || roots == NULL)
+    if (!TEST_ptr(ctx))
+        goto err;
+    if (!TEST_ptr(store))
+        goto err;
+    if (!TEST_ptr(param))
+        goto err;
+    if (!TEST_ptr(roots))
         goto err;
 
     /* Create a stack; upref the cert because we free it below. */
     X509_up_ref(root);
-    if (!sk_X509_push(roots, root))
+    if (!TEST_true(sk_X509_push(roots, root)))
         goto err;
 
-    if (!X509_STORE_CTX_init(ctx, store, leaf, NULL))
+    if (!TEST_true(X509_STORE_CTX_init(ctx, store, leaf, NULL)))
         goto err;
     X509_STORE_CTX_set0_trusted_stack(ctx, roots);
     X509_STORE_CTX_set0_crls(ctx, crls);
     X509_VERIFY_PARAM_set_time(param, PARAM_TIME);
-    if (X509_VERIFY_PARAM_get_time(param) != PARAM_TIME) {
-        fprintf(stderr, &quot;set_time/get_time mismatch.\n&quot;);
+    if (!TEST_long_eq(X509_VERIFY_PARAM_get_time(param), PARAM_TIME)) {
+        TEST_info(&quot;set_time/get_time mismatch.&quot;);
         goto err;
     }
     X509_VERIFY_PARAM_set_depth(param, 16);
@@ -306,55 +312,64 @@ static int test_crl()
     X509_CRL *unknown_critical_crl2 = CRL_from_strings(kUnknownCriticalCRL2);
     int status = 0;
 
-    if (root == NULL || leaf == NULL || basic_crl == NULL
-            || revoked_crl == NULL || bad_issuer_crl == NULL
-            || known_critical_crl == NULL || unknown_critical_crl == NULL
-            || unknown_critical_crl2 == NULL) {
-        fprintf(stderr, &quot;Failed to parse certificates and CRLs.\n&quot;);
+    if (!TEST_ptr(root))
+        goto err;
+    if (!TEST_ptr(leaf))
+        goto err;
+    if (!TEST_ptr(basic_crl))
+        goto err;
+    if (!TEST_ptr(revoked_crl))
+        goto err;
+    if (!TEST_ptr(bad_issuer_crl))
+        goto err;
+    if (!TEST_ptr(known_critical_crl))
+        goto err;
+    if (!TEST_ptr(unknown_critical_crl))
+        goto err;
+    if (!TEST_ptr(unknown_critical_crl2))
         goto err;
-    }
 
     if (verify(leaf, root, make_CRL_stack(basic_crl, NULL),
                X509_V_FLAG_CRL_CHECK) != X509_V_OK) {
-        fprintf(stderr, &quot;Cert with CRL didn't verify.\n&quot;);
+        TEST_info(&quot;Cert with CRL didn't verify.&quot;);
         goto err;
     }
 
     if (verify(leaf, root, make_CRL_stack(basic_crl, revoked_crl),
                X509_V_FLAG_CRL_CHECK) != X509_V_ERR_CERT_REVOKED) {
-        fprintf(stderr, &quot;Revoked CRL wasn't checked.\n&quot;);
+        TEST_info(&quot;Revoked CRL wasn't checked.&quot;);
         goto err;
     }
 
     if (verify(leaf, root, NULL,
                X509_V_FLAG_CRL_CHECK) != X509_V_ERR_UNABLE_TO_GET_CRL) {
-        fprintf(stderr, &quot;CRLs were not required.\n&quot;);
+        TEST_info(&quot;CRLs were not required.&quot;);
         goto err;
     }
 
     if (verify(leaf, root, make_CRL_stack(bad_issuer_crl, NULL),
                X509_V_FLAG_CRL_CHECK) != X509_V_ERR_UNABLE_TO_GET_CRL) {
-        fprintf(stderr, &quot;Bad CRL issuer was unnoticed.\n&quot;);
+        TEST_info(&quot;Bad CRL issuer was unnoticed.&quot;);
         goto err;
     }
 
     if (verify(leaf, root, make_CRL_stack(known_critical_crl, NULL),
                X509_V_FLAG_CRL_CHECK) != X509_V_OK) {
-        fprintf(stderr, &quot;CRL with known critical extension was rejected.\n&quot;);
+        TEST_info(&quot;CRL with known critical extension was rejected.&quot;);
         goto err;
     }
 
     if (verify(leaf, root, make_CRL_stack(unknown_critical_crl, NULL),
                X509_V_FLAG_CRL_CHECK) !=
             X509_V_ERR_UNHANDLED_CRITICAL_CRL_EXTENSION) {
-        fprintf(stderr, &quot;CRL with unknown critical extension was accepted.\n&quot;);
+        TEST_info(&quot;CRL with unknown critical extension was accepted.&quot;);
         goto err;
     }
 
     if (verify(leaf, root, make_CRL_stack(unknown_critical_crl2, NULL),
                X509_V_FLAG_CRL_CHECK) !=
             X509_V_ERR_UNHANDLED_CRITICAL_CRL_EXTENSION) {
-        fprintf(stderr, &quot;CRL with unknown critical extension (2) was accepted.\n&quot;);
+        TEST_info(&quot;CRL with unknown critical extension (2) was accepted.&quot;);
         goto err;
     }
 
diff --git a/test/lhash_test.c b/test/lhash_test.c
index b5f2ec8..1761efd 100644
--- a/test/lhash_test.c
+++ b/test/lhash_test.c
@@ -88,62 +88,50 @@ static int test_int_lhash(void)
     unsigned int i;
     int testresult = 0, j, *p;
 
-    if (h == NULL) {
-        fprintf(stderr, &quot;test lhash int allocation\n&quot;);
+    if (!TEST_ptr(h))
         goto end;
-    }
 
     /* insert */
     for (i = 0; i &lt; n_int_tests; i++)
-        if (lh_int_insert(h, int_tests + i) != NULL) {
-            fprintf(stderr, &quot;test lhash int insert %d\n&quot;, i);
+        if (!TEST_ptr_null(lh_int_insert(h, int_tests + i))) {
+            TEST_info(&quot;int insert %d&quot;, i);
             goto end;
         }
 
     /* num_items */
-    if (lh_int_num_items(h) != n_int_tests) {
-            fprintf(stderr, &quot;test lhash int num items\n&quot;);
-            goto end;
-    }
+    if (!TEST_int_eq(lh_int_num_items(h), n_int_tests))
+        goto end;
 
     /* retrieve */
     for (i = 0; i &lt; n_int_tests; i++)
-        if (*lh_int_retrieve(h, int_tests + i) != int_tests[i]) {
-            fprintf(stderr, &quot;test lhash int retrieve value %d\n&quot;, i);
+        if (!TEST_int_eq(*lh_int_retrieve(h, int_tests + i), int_tests[i])) {
+            TEST_info(&quot;lhash int retrieve value %d&quot;, i);
             goto end;
         }
     for (i = 0; i &lt; n_int_tests; i++)
-        if (lh_int_retrieve(h, int_tests + i) != int_tests + i) {
-            fprintf(stderr, &quot;test lhash int retrieve address %d\n&quot;, i);
+        if (!TEST_ptr_eq(lh_int_retrieve(h, int_tests + i), int_tests + i)) {
+            TEST_info(&quot;lhash int retrieve address %d&quot;, i);
             goto end;
         }
     j = 1;
-    if (lh_int_retrieve(h, &amp;j) != int_tests + 2) {
-        fprintf(stderr, &quot;test lhash int retrieve other\n&quot;);
+    if (!TEST_ptr_eq(lh_int_retrieve(h, &amp;j), int_tests + 2))
         goto end;
-    }
 
     /* replace */
     j = 13;
-    if ((p = lh_int_insert(h, &amp;j)) == NULL) {
-        fprintf(stderr, &quot;test lhash int replacement insert\n&quot;);
+    if (!TEST_ptr(p = lh_int_insert(h, &amp;j)))
         goto end;
-    }
-    if (p != int_tests + 1) {
-        fprintf(stderr, &quot;test lhash int replacement pointer\n&quot;);
+    if (!TEST_ptr_eq(p, int_tests + 1))
         goto end;
-    }
-    if (lh_int_retrieve(h, int_tests + 1) != &amp;j) {
-        fprintf(stderr, &quot;test lhash int replacement variable\n&quot;);
+    if (!TEST_ptr_eq(lh_int_retrieve(h, int_tests + 1), &amp;j))
         goto end;
-    }
 
     /* do_all */
     memset(int_found, 0, sizeof(int_found));
     lh_int_doall(h, &amp;int_doall);
     for (i = 0; i &lt; n_int_tests; i++)
-        if (int_found[i] != 1) {
-            fprintf(stderr, &quot;test lhash int doall %d\n&quot;, i);
+        if (!TEST_int_eq(int_found[i], 1)) {
+            TEST_info(&quot;lhash int doall %d&quot;, i);
             goto end;
         }
     
@@ -151,25 +139,23 @@ static int test_int_lhash(void)
     memset(int_found, 0, sizeof(int_found));
     lh_int_doall_short(h, int_doall_arg, int_found);
     for (i = 0; i &lt; n_int_tests; i++)
-        if (int_found[i] != 1) {
-            fprintf(stderr, &quot;test lhash int doall arg %d\n&quot;, i);
+        if (!TEST_int_eq(int_found[i], 1)) {
+            TEST_info(&quot;lhash int doall arg %d&quot;, i);
             goto end;
         }
     
     /* delete */
     for (i = 0; i &lt; n_dels; i++) {
         const int b = lh_int_delete(h, &amp;dels[i].data) == NULL;
-        if ((b ^ dels[i].null) != 0) {
-            fprintf(stderr, &quot;test lhash int delete %d\n&quot;, i);
+        if (!TEST_int_eq(b ^ dels[i].null,  0)) {
+            TEST_info(&quot;lhash int delete %d&quot;, i);
             goto end;
         }
     }
 
     /* error */
-    if (lh_int_error(h) != 0) {
-        fprintf(stderr, &quot;test lhash int error\n&quot;);
+    if (!TEST_int_eq(lh_int_error(h), 0))
         goto end;
-    }
 
     testresult = 1;
 end:
@@ -189,16 +175,14 @@ static int test_stress(void)
     unsigned int i;
     int testresult = 0, *p;
 
-    if (h == NULL) {
-        fprintf(stderr, &quot;test lhash stress allocation\n&quot;);
+    if (!TEST_ptr(h))
         goto end;
-    }
 
     /* insert */
     for (i = 0; i &lt; n; i++) {
         p = OPENSSL_malloc(sizeof(i));
-        if (p == NULL) {
-            fprintf(stderr, &quot;test lhash stress out of memory %d\n&quot;, i);
+        if (!TEST_ptr(p)) {
+            TEST_info(&quot;lhash stress out of memory %d&quot;, i);
             goto end;
         }
         *p = 3 * i + 1;
@@ -206,10 +190,8 @@ static int test_stress(void)
     }
 
     /* num_items */
-    if (lh_int_num_items(h) != n) {
-            fprintf(stderr, &quot;test lhash stress num items\n&quot;);
+    if (!TEST_int_eq(lh_int_num_items(h), n))
             goto end;
-    }
 
     fprintf(stderr, &quot;hash full statistics:\n&quot;);
     OPENSSL_LH_stats((OPENSSL_LHASH *)h, stderr);
@@ -220,12 +202,12 @@ static int test_stress(void)
     for (i = 0; i &lt; n; i++) {
         const int j = (7 * i + 4) % n * 3 + 1;
 
-        if ((p = lh_int_delete(h, &amp;j)) == NULL) {
-            fprintf(stderr, &quot;test lhash stress delete %d\n&quot;, i);
+        if (!TEST_ptr(p = lh_int_delete(h, &amp;j))) {
+            TEST_info(&quot;lhash stress delete %d\n&quot;, i);
             goto end;
         }
-        if (*p != j) {
-            fprintf(stderr, &quot;test lhash stress bad value %d\n&quot;, i);
+        if (!TEST_int_eq(*p, j)) {
+            TEST_info(&quot;lhash stress bad value %d&quot;, i);
             goto end;
         }
         OPENSSL_free(p);
diff --git a/test/mdc2_internal_test.c b/test/mdc2_internal_test.c
index 9acea21..7deaf26 100644
--- a/test/mdc2_internal_test.c
+++ b/test/mdc2_internal_test.c
@@ -56,8 +56,9 @@ static int test_mdc2(int idx)
                 strlen(testdata.input));
     MDC2_Final(&amp;(md[0]), &amp;c);
 
-    if (memcmp(testdata.expected, md, MDC2_DIGEST_LENGTH)) {
-        fprintf(stderr, &quot;mdc2 test %d: unexpected output\n&quot;, idx);
+    if (!TEST_mem_eq(testdata.expected, MDC2_DIGEST_LENGTH,
+                     md, MDC2_DIGEST_LENGTH)) {
+        TEST_info(&quot;mdc2 test %d: unexpected output&quot;, idx);
         return 0;
     }
 
diff --git a/test/pkey_meth_test.c b/test/pkey_meth_test.c
index c76a54f..8876537 100644
--- a/test/pkey_meth_test.c
+++ b/test/pkey_meth_test.c
@@ -39,7 +39,7 @@ static int test_asn1_meths()
 
     }
     if (!good) {
-        fprintf(stderr, &quot;EVP_PKEY_ASN1_METHOD table out of order!\n&quot;);
+        TEST_error(&quot;EVP_PKEY_ASN1_METHOD table out of order&quot;);
         for (i = 0; i &lt; EVP_PKEY_asn1_get_count(); i++) {
             const char *info;
 
diff --git a/test/poly1305_internal_test.c b/test/poly1305_internal_test.c
index 547c2fd..af54ac3 100644
--- a/test/poly1305_internal_test.c
+++ b/test/poly1305_internal_test.c
@@ -1565,14 +1565,14 @@ static int test_poly1305(int idx)
     size_t expectedlen = test.expected.size;
     unsigned char out[16];
 
-    if (expectedlen != sizeof(out))
+    if (!TEST_size_t_eq(expectedlen, sizeof(out)))
         return 0;
 
     Poly1305_Init(&amp;poly1305, key);
     Poly1305_Update(&amp;poly1305, in, inlen);
     Poly1305_Final(&amp;poly1305, out);
 
-    if (memcmp(out, expected, expectedlen) != 0) {
+    if (!TEST_mem_eq(out, expectedlen, expected, expectedlen)) {
         fprintf(stderr, &quot;Poly1305 test #%d failed.\n&quot;, idx);
         fprintf(stderr, &quot;got:      &quot;);
         hexdump(out, sizeof(out));
@@ -1588,7 +1588,7 @@ static int test_poly1305(int idx)
         Poly1305_Update(&amp;poly1305, in+1, inlen-1);
         Poly1305_Final(&amp;poly1305, out);
 
-        if (memcmp(out, expected, expectedlen) != 0) {
+        if (!TEST_mem_eq(out, expectedlen, expected, expectedlen)) {
             fprintf(stderr, &quot;Poly1305 test #%d/1+(N-1) failed.\n&quot;, idx);
             fprintf(stderr, &quot;got:      &quot;);
             hexdump(out, sizeof(out));
@@ -1607,7 +1607,7 @@ static int test_poly1305(int idx)
         Poly1305_Update(&amp;poly1305, in+half, inlen-half);
         Poly1305_Final(&amp;poly1305, out);
 
-        if (memcmp(out, expected, expectedlen) != 0) {
+        if (!TEST_mem_eq(out, expectedlen, expected, expectedlen)) {
             fprintf(stderr, &quot;Poly1305 test #%d/2 failed.\n&quot;, idx);
             fprintf(stderr, &quot;got:      &quot;);
             hexdump(out, sizeof(out));
@@ -1623,7 +1623,7 @@ static int test_poly1305(int idx)
             Poly1305_Update(&amp;poly1305, in+half, inlen-half);
             Poly1305_Final(&amp;poly1305, out);
 
-            if (memcmp(out, expected, expectedlen) != 0) {
+            if (!TEST_mem_eq(out, expectedlen, expected, expectedlen)) {
                 fprintf(stderr, &quot;Poly1305 test #%d/%&quot; OSSLzu &quot;+%&quot; OSSLzu &quot; failed.\n&quot;,
                        idx, half, inlen-half);
                 fprintf(stderr, &quot;got:      &quot;);
diff --git a/test/recipes/02-test_stack.t b/test/recipes/01-test_test.t
similarity index 92%
copy from test/recipes/02-test_stack.t
copy to test/recipes/01-test_test.t
index 548f1eb..90c8314 100644
--- a/test/recipes/02-test_stack.t
+++ b/test/recipes/01-test_test.t
@@ -11,4 +11,4 @@
 
 use OpenSSL::Test::Simple;
 
-simple_test(&quot;test_stack&quot;, &quot;stack_test&quot;);
+simple_test(&quot;test_test&quot;, &quot;test_test&quot;);
diff --git a/test/ssl_test.c b/test/ssl_test.c
index 387f3a6..0cdec46 100644
--- a/test/ssl_test.c
+++ b/test/ssl_test.c
@@ -31,10 +31,10 @@ static const char *print_alert(int alert)
 
 static int check_result(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx)
 {
-    if (result-&gt;result != test_ctx-&gt;expected_result) {
-        fprintf(stderr, &quot;ExpectedResult mismatch: expected %s, got %s.\n&quot;,
-                ssl_test_result_name(test_ctx-&gt;expected_result),
-                ssl_test_result_name(result-&gt;result));
+    if (!TEST_int_eq(result-&gt;result, test_ctx-&gt;expected_result)) {
+        TEST_info(&quot;ExpectedResult mismatch: expected %s, got %s.&quot;,
+                  ssl_test_result_name(test_ctx-&gt;expected_result),
+                  ssl_test_result_name(result-&gt;result));
         return 0;
     }
     return 1;
@@ -42,10 +42,11 @@ static int check_result(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx)
 
 static int check_alerts(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx)
 {
-    if (result-&gt;client_alert_sent != result-&gt;client_alert_received) {
-        fprintf(stderr, &quot;Client sent alert %s but server received %s\n.&quot;,
-                print_alert(result-&gt;client_alert_sent),
-                print_alert(result-&gt;client_alert_received));
+    if (!TEST_int_eq(result-&gt;client_alert_sent,
+                     result-&gt;client_alert_received)) {
+        TEST_info(&quot;Client sent alert %s but server received %s.&quot;,
+                  print_alert(result-&gt;client_alert_sent),
+                  print_alert(result-&gt;client_alert_received));
         /*
          * We can't bail here because the peer doesn't always get far enough
          * to process a received alert. Specifically, in protocol version
@@ -60,10 +61,11 @@ static int check_alerts(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx)
         /* return 0; */
     }
 
-    if (result-&gt;server_alert_sent != result-&gt;server_alert_received) {
-        fprintf(stderr, &quot;Server sent alert %s but client received %s\n.&quot;,
-                print_alert(result-&gt;server_alert_sent),
-                print_alert(result-&gt;server_alert_received));
+    if (!TEST_int_eq(result-&gt;server_alert_sent,
+                     result-&gt;server_alert_received)) {
+        TEST_info(&quot;Server sent alert %s but client received %s.&quot;,
+                  print_alert(result-&gt;server_alert_sent),
+                  print_alert(result-&gt;server_alert_received));
         /* return 0; */
     }
 
@@ -75,47 +77,42 @@ static int check_alerts(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx)
          * where the low byte is the alert code and the high byte is other stuff.
          */
         &amp;&amp; (result-&gt;client_alert_sent &amp; 0xff) != test_ctx-&gt;expected_client_alert) {
-        fprintf(stderr, &quot;ClientAlert mismatch: expected %s, got %s.\n&quot;,
-                print_alert(test_ctx-&gt;expected_client_alert),
-                print_alert(result-&gt;client_alert_sent));
+        TEST_error(&quot;ClientAlert mismatch: expected %s, got %s.&quot;,
+                   print_alert(test_ctx-&gt;expected_client_alert),
+                   print_alert(result-&gt;client_alert_sent));
         return 0;
     }
 
     if (test_ctx-&gt;expected_server_alert
         &amp;&amp; (result-&gt;server_alert_sent &amp; 0xff) != test_ctx-&gt;expected_server_alert) {
-        fprintf(stderr, &quot;ServerAlert mismatch: expected %s, got %s.\n&quot;,
-                print_alert(test_ctx-&gt;expected_server_alert),
-                print_alert(result-&gt;server_alert_sent));
+        TEST_error(&quot;ServerAlert mismatch: expected %s, got %s.&quot;,
+                   print_alert(test_ctx-&gt;expected_server_alert),
+                   print_alert(result-&gt;server_alert_sent));
         return 0;
     }
 
-    if (result-&gt;client_num_fatal_alerts_sent &gt; 1) {
-        fprintf(stderr, &quot;Client sent %d fatal alerts.\n&quot;,
-                result-&gt;client_num_fatal_alerts_sent);
+    if (!TEST_int_le(result-&gt;client_num_fatal_alerts_sent, 1))
         return 0;
-    }
-    if (result-&gt;server_num_fatal_alerts_sent &gt; 1) {
-        fprintf(stderr, &quot;Server sent %d alerts.\n&quot;,
-                result-&gt;server_num_fatal_alerts_sent);
+    if (!TEST_int_le(result-&gt;server_num_fatal_alerts_sent, 1))
         return 0;
-    }
     return 1;
 }
 
 static int check_protocol(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx)
 {
-    if (result-&gt;client_protocol != result-&gt;server_protocol) {
-        fprintf(stderr, &quot;Client has protocol %s but server has %s\n.&quot;,
-                ssl_protocol_name(result-&gt;client_protocol),
-                ssl_protocol_name(result-&gt;server_protocol));
+    if (!TEST_int_eq(result-&gt;client_protocol, result-&gt;server_protocol)) {
+        TEST_info(&quot;Client has protocol %s but server has %s.&quot;,
+                  ssl_protocol_name(result-&gt;client_protocol),
+                  ssl_protocol_name(result-&gt;server_protocol));
         return 0;
     }
 
     if (test_ctx-&gt;expected_protocol) {
-        if (result-&gt;client_protocol != test_ctx-&gt;expected_protocol) {
-            fprintf(stderr, &quot;Protocol mismatch: expected %s, got %s.\n&quot;,
-                    ssl_protocol_name(test_ctx-&gt;expected_protocol),
-                    ssl_protocol_name(result-&gt;client_protocol));
+        if (!TEST_int_eq(result-&gt;client_protocol,
+                         test_ctx-&gt;expected_protocol)) {
+            TEST_info(&quot;Protocol mismatch: expected %s, got %s.\n&quot;,
+                      ssl_protocol_name(test_ctx-&gt;expected_protocol),
+                      ssl_protocol_name(result-&gt;client_protocol));
             return 0;
         }
     }
@@ -124,10 +121,10 @@ static int check_protocol(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx)
 
 static int check_servername(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx)
 {
-    if (result-&gt;servername != test_ctx-&gt;expected_servername) {
-      fprintf(stderr, &quot;Client ServerName mismatch, expected %s, got %s\n.&quot;,
-              ssl_servername_name(test_ctx-&gt;expected_servername),
-              ssl_servername_name(result-&gt;servername));
+    if (!TEST_int_eq(result-&gt;servername, test_ctx-&gt;expected_servername)) {
+      TEST_info(&quot;Client ServerName mismatch, expected %s, got %s.&quot;,
+                ssl_servername_name(test_ctx-&gt;expected_servername),
+                ssl_servername_name(result-&gt;servername));
       return 0;
     }
   return 1;
@@ -137,10 +134,11 @@ static int check_session_ticket(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx
 {
     if (test_ctx-&gt;session_ticket_expected == SSL_TEST_SESSION_TICKET_IGNORE)
         return 1;
-    if (result-&gt;session_ticket != test_ctx-&gt;session_ticket_expected) {
-        fprintf(stderr, &quot;Client SessionTicketExpected mismatch, expected %s, got %s\n.&quot;,
-                ssl_session_ticket_name(test_ctx-&gt;session_ticket_expected),
-                ssl_session_ticket_name(result-&gt;session_ticket));
+    if (!TEST_int_eq(result-&gt;session_ticket,
+                     test_ctx-&gt;session_ticket_expected)) {
+        TEST_info(&quot;Client SessionTicketExpected mismatch, expected %s, got %s.&quot;,
+                  ssl_session_ticket_name(test_ctx-&gt;session_ticket_expected),
+                  ssl_session_ticket_name(result-&gt;session_ticket));
         return 0;
     }
     return 1;
@@ -148,24 +146,20 @@ static int check_session_ticket(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx
 
 static int check_compression(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx)
 {
-    if (result-&gt;compression != test_ctx-&gt;compression_expected) {
-        fprintf(stderr, &quot;Client CompressionExpected mismatch, expected %d, got %d\n.&quot;,
-                test_ctx-&gt;compression_expected,
-                result-&gt;compression);
+    if (!TEST_int_eq(result-&gt;compression, test_ctx-&gt;compression_expected))
         return 0;
-    }
     return 1;
 }
 #ifndef OPENSSL_NO_NEXTPROTONEG
 static int check_npn(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx)
 {
     int ret = 1;
-    ret &amp;= strings_equal(&quot;NPN Negotiated (client vs server)&quot;,
-                         result-&gt;client_npn_negotiated,
-                         result-&gt;server_npn_negotiated);
-    ret &amp;= strings_equal(&quot;ExpectedNPNProtocol&quot;,
-                         test_ctx-&gt;expected_npn_protocol,
-                         result-&gt;client_npn_negotiated);
+    if (!TEST_str_eq(result-&gt;client_npn_negotiated,
+                     result-&gt;server_npn_negotiated))
+        ret = 0;
+    if (!TEST_str_eq(test_ctx-&gt;expected_npn_protocol,
+                     result-&gt;client_npn_negotiated))
+        ret = 0;
     return ret;
 }
 #endif
@@ -173,27 +167,21 @@ static int check_npn(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx)
 static int check_alpn(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx)
 {
     int ret = 1;
-    ret &amp;= strings_equal(&quot;ALPN Negotiated (client vs server)&quot;,
-                         result-&gt;client_alpn_negotiated,
-                         result-&gt;server_alpn_negotiated);
-    ret &amp;= strings_equal(&quot;ExpectedALPNProtocol&quot;,
-                         test_ctx-&gt;expected_alpn_protocol,
-                         result-&gt;client_alpn_negotiated);
+    if (!TEST_str_eq(result-&gt;client_alpn_negotiated,
+                     result-&gt;server_alpn_negotiated))
+        ret = 0;
+    if (!TEST_str_eq(test_ctx-&gt;expected_alpn_protocol,
+                     result-&gt;client_alpn_negotiated))
+        ret = 0;
     return ret;
 }
 
 static int check_resumption(HANDSHAKE_RESULT *result, SSL_TEST_CTX *test_ctx)
 {
-    if (result-&gt;client_resumed != result-&gt;server_resumed) {
-        fprintf(stderr, &quot;Resumption mismatch (client vs server): %d vs %d\n&quot;,
-                result-&gt;client_resumed, result-&gt;server_resumed);
+    if (!TEST_int_eq(result-&gt;client_resumed, result-&gt;server_resumed))
         return 0;
-    }
-    if (result-&gt;client_resumed != test_ctx-&gt;resumption_expected) {
-        fprintf(stderr, &quot;ResumptionExpected mismatch: %d vs %d\n&quot;,
-                test_ctx-&gt;resumption_expected, result-&gt;client_resumed);
+    if (!TEST_int_eq(result-&gt;client_resumed, test_ctx-&gt;resumption_expected))
         return 0;
-    }
     return 1;
 }
 
@@ -201,9 +189,9 @@ static int check_nid(const char *name, int expected_nid, int nid)
 {
     if (expected_nid == 0 || expected_nid == nid)
         return 1;
-    fprintf(stderr, &quot;%s type mismatch, %s vs %s\n&quot;,
-            name, OBJ_nid2ln(expected_nid),
-            nid == NID_undef ? &quot;absent&quot; : OBJ_nid2ln(nid));
+    TEST_error(&quot;%s type mismatch, %s vs %s\n&quot;,
+               name, OBJ_nid2ln(expected_nid),
+               nid == NID_undef ? &quot;absent&quot; : OBJ_nid2ln(nid));
     return 0;
 }
 
@@ -356,7 +344,7 @@ static int test_handshake(int idx)
     BIO_snprintf(test_app, sizeof(test_app), &quot;test-%d&quot;, idx);
 
     test_ctx = SSL_TEST_CTX_create(conf, test_app);
-    if (test_ctx == NULL)
+    if (!TEST_ptr(test_ctx))
         goto err;
 
 #ifndef OPENSSL_NO_DTLS
diff --git a/test/ssl_test_ctx_test.c b/test/ssl_test_ctx_test.c
index 54a32c6..6f277e5 100644
--- a/test/ssl_test_ctx_test.c
+++ b/test/ssl_test_ctx_test.c
@@ -37,28 +37,26 @@ typedef struct ssl_test_ctx_test_fixture {
 static int SSL_TEST_CLIENT_CONF_equal(SSL_TEST_CLIENT_CONF *client,
                                       SSL_TEST_CLIENT_CONF *client2)
 {
-    if (client-&gt;verify_callback != client2-&gt;verify_callback) {
-        fprintf(stderr, &quot;ClientVerifyCallback mismatch: %s vs %s.\n&quot;,
-                ssl_verify_callback_name(client-&gt;verify_callback),
-                ssl_verify_callback_name(client2-&gt;verify_callback));
+    if (!TEST_int_eq(client-&gt;verify_callback, client2-&gt;verify_callback)) {
+        TEST_info(&quot;ClientVerifyCallback mismatch: %s vs %s.&quot;,
+                  ssl_verify_callback_name(client-&gt;verify_callback),
+                  ssl_verify_callback_name(client2-&gt;verify_callback));
         return 0;
     }
-    if (client-&gt;servername != client2-&gt;servername) {
-        fprintf(stderr, &quot;ServerName mismatch: %s vs %s.\n&quot;,
-                ssl_servername_name(client-&gt;servername),
-                ssl_servername_name(client2-&gt;servername));
+    if (!TEST_int_eq(client-&gt;servername, client2-&gt;servername)) {
+        TEST_info(&quot;ServerName mismatch: %s vs %s.&quot;,
+                  ssl_servername_name(client-&gt;servername),
+                  ssl_servername_name(client2-&gt;servername));
         return 0;
     }
-    if (!strings_equal(&quot;Client NPNProtocols&quot;, client-&gt;npn_protocols,
-                       client2-&gt;npn_protocols))
+    if (!TEST_str_eq(client-&gt;npn_protocols, client2-&gt;npn_protocols))
         return 0;
-    if (!strings_equal(&quot;Client ALPNProtocols&quot;, client-&gt;alpn_protocols,
-                       client2-&gt;alpn_protocols))
+    if (!TEST_str_eq(client-&gt;alpn_protocols, client2-&gt;alpn_protocols))
         return 0;
-    if (client-&gt;ct_validation != client2-&gt;ct_validation) {
-        fprintf(stderr, &quot;CTValidation mismatch: %s vs %s.\n&quot;,
-                ssl_ct_validation_name(client-&gt;ct_validation),
-                ssl_ct_validation_name(client2-&gt;ct_validation));
+    if (!TEST_int_eq(client-&gt;ct_validation, client2-&gt;ct_validation)) {
+        TEST_info(&quot;CTValidation mismatch: %s vs %s.&quot;,
+                  ssl_ct_validation_name(client-&gt;ct_validation),
+                  ssl_ct_validation_name(client2-&gt;ct_validation));
         return 0;
     }
     return 1;
@@ -67,27 +65,24 @@ static int SSL_TEST_CLIENT_CONF_equal(SSL_TEST_CLIENT_CONF *client,
 static int SSL_TEST_SERVER_CONF_equal(SSL_TEST_SERVER_CONF *server,
                                       SSL_TEST_SERVER_CONF *server2)
 {
-    if (server-&gt;servername_callback != server2-&gt;servername_callback) {
-        fprintf(stderr, &quot;ServerNameCallback mismatch: %s vs %s.\n&quot;,
-                ssl_servername_callback_name(server-&gt;servername_callback),
-                ssl_servername_callback_name(server2-&gt;servername_callback));
+    if (!TEST_int_eq(server-&gt;servername_callback,
+                     server2-&gt;servername_callback)) {
+        TEST_info(&quot;ServerNameCallback mismatch: %s vs %s.&quot;,
+                  ssl_servername_callback_name(server-&gt;servername_callback),
+                  ssl_servername_callback_name(server2-&gt;servername_callback));
         return 0;
     }
-    if (!strings_equal(&quot;Server NPNProtocols&quot;, server-&gt;npn_protocols,
-                       server2-&gt;npn_protocols))
+    if (!TEST_str_eq(server-&gt;npn_protocols, server2-&gt;npn_protocols))
         return 0;
-    if (!strings_equal(&quot;Server ALPNProtocols&quot;, server-&gt;alpn_protocols,
-                       server2-&gt;alpn_protocols))
+    if (!TEST_str_eq(server-&gt;alpn_protocols, server2-&gt;alpn_protocols))
         return 0;
-    if (server-&gt;broken_session_ticket != server2-&gt;broken_session_ticket) {
-        fprintf(stderr, &quot;Broken session ticket mismatch: %d vs %d.\n&quot;,
-                server-&gt;broken_session_ticket, server2-&gt;broken_session_ticket);
+    if (!TEST_int_eq(server-&gt;broken_session_ticket,
+                     server2-&gt;broken_session_ticket))
         return 0;
-    }
-    if (server-&gt;cert_status != server2-&gt;cert_status) {
-        fprintf(stderr, &quot;CertStatus mismatch: %s vs %s.\n&quot;,
-                ssl_certstatus_name(server-&gt;cert_status),
-                ssl_certstatus_name(server2-&gt;cert_status));
+    if (!TEST_int_eq(server-&gt;cert_status, server2-&gt;cert_status)) {
+        TEST_info(&quot;CertStatus mismatch: %s vs %s.&quot;,
+                  ssl_certstatus_name(server-&gt;cert_status),
+                  ssl_certstatus_name(server2-&gt;cert_status));
         return 0;
     }
     return 1;
@@ -104,92 +99,78 @@ static int SSL_TEST_EXTRA_CONF_equal(SSL_TEST_EXTRA_CONF *extra,
 /* Returns 1 if the contexts are equal, 0 otherwise. */
 static int SSL_TEST_CTX_equal(SSL_TEST_CTX *ctx, SSL_TEST_CTX *ctx2)
 {
-    if (ctx-&gt;method != ctx2-&gt;method) {
-        fprintf(stderr, &quot;Method mismatch: %s vs %s.\n&quot;,
-                ssl_test_method_name(ctx-&gt;method),
-                ssl_test_method_name(ctx2-&gt;method));
+    if (!TEST_int_eq(ctx-&gt;method, ctx2-&gt;method)) {
+        TEST_info(&quot;Method mismatch: %s vs %s.&quot;,
+                  ssl_test_method_name(ctx-&gt;method),
+                  ssl_test_method_name(ctx2-&gt;method));
         return 0;
     }
-    if (ctx-&gt;handshake_mode != ctx2-&gt;handshake_mode) {
-        fprintf(stderr, &quot;HandshakeMode mismatch: %s vs %s.\n&quot;,
-                ssl_handshake_mode_name(ctx-&gt;handshake_mode),
-                ssl_handshake_mode_name(ctx2-&gt;handshake_mode));
+    if (!TEST_int_eq(ctx-&gt;handshake_mode, ctx2-&gt;handshake_mode)) {
+        TEST_info(&quot;HandshakeMode mismatch: %s vs %s.&quot;,
+                  ssl_handshake_mode_name(ctx-&gt;handshake_mode),
+                  ssl_handshake_mode_name(ctx2-&gt;handshake_mode));
         return 0;
     }
-    if (ctx-&gt;app_data_size != ctx2-&gt;app_data_size) {
-        fprintf(stderr, &quot;ApplicationData mismatch: %d vs %d.\n&quot;,
-                ctx-&gt;app_data_size, ctx2-&gt;app_data_size);
+    if (!TEST_int_eq(ctx-&gt;app_data_size, ctx2-&gt;app_data_size))
         return 0;
-    }
 
-    if (ctx-&gt;max_fragment_size != ctx2-&gt;max_fragment_size) {
-        fprintf(stderr, &quot;MaxFragmentSize mismatch: %d vs %d.\n&quot;,
-                ctx-&gt;max_fragment_size, ctx2-&gt;max_fragment_size);
+    if (!TEST_int_eq(ctx-&gt;max_fragment_size, ctx2-&gt;max_fragment_size))
         return 0;
-    }
 
-    if (!SSL_TEST_EXTRA_CONF_equal(&amp;ctx-&gt;extra, &amp;ctx2-&gt;extra)) {
-        fprintf(stderr, &quot;Extra conf mismatch.\n&quot;);
+    if (!SSL_TEST_EXTRA_CONF_equal(&amp;ctx-&gt;extra, &amp;ctx2-&gt;extra))
         return 0;
-    }
-    if (!SSL_TEST_EXTRA_CONF_equal(&amp;ctx-&gt;resume_extra, &amp;ctx2-&gt;resume_extra)) {
-        fprintf(stderr, &quot;Resume extra conf mismatch.\n&quot;);
+    if (!SSL_TEST_EXTRA_CONF_equal(&amp;ctx-&gt;resume_extra, &amp;ctx2-&gt;resume_extra))
         return 0;
-    }
 
-    if (ctx-&gt;expected_result != ctx2-&gt;expected_result) {
-        fprintf(stderr, &quot;ExpectedResult mismatch: %s vs %s.\n&quot;,
-                ssl_test_result_name(ctx-&gt;expected_result),
-                ssl_test_result_name(ctx2-&gt;expected_result));
+    if (!TEST_int_eq(ctx-&gt;expected_result, ctx2-&gt;expected_result)) {
+        TEST_info(&quot;ExpectedResult mismatch: %s vs %s.&quot;,
+                  ssl_test_result_name(ctx-&gt;expected_result),
+                  ssl_test_result_name(ctx2-&gt;expected_result));
         return 0;
     }
-    if (ctx-&gt;expected_client_alert != ctx2-&gt;expected_client_alert) {
-        fprintf(stderr, &quot;ClientAlert mismatch: %s vs %s.\n&quot;,
-                ssl_alert_name(ctx-&gt;expected_client_alert),
-                ssl_alert_name(ctx2-&gt;expected_client_alert));
+    if (!TEST_int_eq(ctx-&gt;expected_client_alert, ctx2-&gt;expected_client_alert)) {
+        TEST_info(&quot;ClientAlert mismatch: %s vs %s.&quot;,
+                  ssl_alert_name(ctx-&gt;expected_client_alert),
+                  ssl_alert_name(ctx2-&gt;expected_client_alert));
         return 0;
     }
-    if (ctx-&gt;expected_server_alert != ctx2-&gt;expected_server_alert) {
-        fprintf(stderr, &quot;ServerAlert mismatch: %s vs %s.\n&quot;,
-                ssl_alert_name(ctx-&gt;expected_server_alert),
-                ssl_alert_name(ctx2-&gt;expected_server_alert));
+    if (!TEST_int_eq(ctx-&gt;expected_server_alert, ctx2-&gt;expected_server_alert)) {
+        TEST_info(&quot;ServerAlert mismatch: %s vs %s.&quot;,
+                  ssl_alert_name(ctx-&gt;expected_server_alert),
+                  ssl_alert_name(ctx2-&gt;expected_server_alert));
         return 0;
     }
-    if (ctx-&gt;expected_protocol != ctx2-&gt;expected_protocol) {
-        fprintf(stderr, &quot;ClientAlert mismatch: %s vs %s.\n&quot;,
-                ssl_protocol_name(ctx-&gt;expected_protocol),
-                ssl_protocol_name(ctx2-&gt;expected_protocol));
+    if (!TEST_int_eq(ctx-&gt;expected_protocol, ctx2-&gt;expected_protocol)) {
+        TEST_info(&quot;ClientAlert mismatch: %s vs %s.&quot;,
+                  ssl_protocol_name(ctx-&gt;expected_protocol),
+                  ssl_protocol_name(ctx2-&gt;expected_protocol));
         return 0;
     }
-    if (ctx-&gt;expected_servername != ctx2-&gt;expected_servername) {
-        fprintf(stderr, &quot;ExpectedServerName mismatch: %s vs %s.\n&quot;,
-                ssl_servername_name(ctx-&gt;expected_servername),
-                ssl_servername_name(ctx2-&gt;expected_servername));
+    if (!TEST_int_eq(ctx-&gt;expected_servername, ctx2-&gt;expected_servername)) {
+        TEST_info(&quot;ExpectedServerName mismatch: %s vs %s.&quot;,
+                  ssl_servername_name(ctx-&gt;expected_servername),
+                  ssl_servername_name(ctx2-&gt;expected_servername));
         return 0;
     }
-    if (ctx-&gt;session_ticket_expected != ctx2-&gt;session_ticket_expected) {
-        fprintf(stderr, &quot;SessionTicketExpected mismatch: %s vs %s.\n&quot;,
+    if (!TEST_int_eq(ctx-&gt;session_ticket_expected,
+                     ctx2-&gt;session_ticket_expected)) {
+        TEST_info(&quot;SessionTicketExpected mismatch: %s vs %s.&quot;,
                 ssl_session_ticket_name(ctx-&gt;session_ticket_expected),
                 ssl_session_ticket_name(ctx2-&gt;session_ticket_expected));
         return 0;
     }
-    if (ctx-&gt;compression_expected != ctx2-&gt;compression_expected) {
-        fprintf(stderr, &quot;ComrpessionExpected mismatch: %d vs %d.\n&quot;,
-                ctx-&gt;compression_expected,
-                ctx2-&gt;compression_expected);
+    if (!TEST_int_eq(ctx-&gt;compression_expected, ctx2-&gt;compression_expected)) {
+        TEST_info(&quot;ComrpessionExpected mismatch: %d vs %d.&quot;,
+                  ctx-&gt;compression_expected,
+                  ctx2-&gt;compression_expected);
         return 0;
     }
-    if (!strings_equal(&quot;ExpectedNPNProtocol&quot;, ctx-&gt;expected_npn_protocol,
-                       ctx2-&gt;expected_npn_protocol))
+    if (!TEST_str_eq(ctx-&gt;expected_npn_protocol, ctx2-&gt;expected_npn_protocol))
         return 0;
-    if (!strings_equal(&quot;ExpectedALPNProtocol&quot;, ctx-&gt;expected_alpn_protocol,
-                       ctx2-&gt;expected_alpn_protocol))
+    if (!TEST_str_eq(ctx-&gt;expected_alpn_protocol, ctx2-&gt;expected_alpn_protocol))
         return 0;
-    if (ctx-&gt;resumption_expected != ctx2-&gt;resumption_expected) {
-        fprintf(stderr, &quot;ResumptionExpected mismatch: %d vs %d.\n&quot;,
-                ctx-&gt;resumption_expected, ctx2-&gt;resumption_expected);
+    if (!TEST_int_eq(ctx-&gt;resumption_expected, ctx2-&gt;resumption_expected))
         return 0;
-    }
     return 1;
 }
 
@@ -208,9 +189,9 @@ static int execute_test(SSL_TEST_CTX_TEST_FIXTURE fixture)
 
     SSL_TEST_CTX *ctx = SSL_TEST_CTX_create(conf, fixture.test_section);
 
-    if (ctx == NULL) {
-        fprintf(stderr, &quot;Failed to parse good configuration %s.\n&quot;,
-                fixture.test_section);
+    if (!TEST_ptr(ctx)) {
+        TEST_info(&quot;Failed to parse good configuration %s.&quot;,
+                  fixture.test_section);
         goto err;
     }
 
@@ -302,9 +283,9 @@ static int test_bad_configuration(int idx)
 {
     SSL_TEST_CTX *ctx = SSL_TEST_CTX_create(conf, bad_configurations[idx]);
 
-    if (ctx != NULL) {
-        fprintf(stderr, &quot;Parsing bad configuration %s succeeded.\n&quot;,
-                bad_configurations[idx]);
+    if (!TEST_ptr_null(ctx)) {
+        TEST_info(&quot;Parsing bad configuration %s succeeded.&quot;,
+                  bad_configurations[idx]);
         SSL_TEST_CTX_free(ctx);
         return 0;
     }
diff --git a/test/stack_test.c b/test/stack_test.c
index 4325766..25b2e00 100644
--- a/test/stack_test.c
+++ b/test/stack_test.c
@@ -90,21 +90,19 @@ static int test_int_stack(void)
 
     /* Check push and num */
     for (i = 0; i &lt; n; i++) {
-        if (sk_sint_num(s) != i) {
-            fprintf(stderr, &quot;test int stack size %d\n&quot;, i);
+        if (!TEST_int_eq(sk_sint_num(s), i)) {
+            TEST_info(&quot;int stack size %d&quot;, i);
             goto end;
         }
         sk_sint_push(s, v + i);
     }
-    if (sk_sint_num(s) != n) {
-        fprintf(stderr, &quot;test int stack size %d\n&quot;, n);
+    if (!TEST_int_eq(sk_sint_num(s), n))
         goto end;
-    }
 
     /* check the values */
     for (i = 0; i &lt; n; i++)
-        if (sk_sint_value(s, i) != v + i) {
-            fprintf(stderr, &quot;test int value %d\n&quot;, i);
+        if (!TEST_ptr_eq(sk_sint_value(s, i), v + i)) {
+            TEST_info(&quot;int value %d&quot;, i);
             goto end;
         }
 
@@ -113,8 +111,8 @@ static int test_int_stack(void)
         int *val = (finds[i].unsorted == -1) ? &amp;notpresent
                                              : v + finds[i].unsorted;
 
-        if (sk_sint_find(s, val) != finds[i].unsorted) {
-            fprintf(stderr, &quot;test int unsorted find %d\n&quot;, i);
+        if (!TEST_int_eq(sk_sint_find(s, val), finds[i].unsorted)) {
+            TEST_info(&quot;int unsorted find %d&quot;, i);
             goto end;
         }
     }
@@ -124,48 +122,42 @@ static int test_int_stack(void)
         int *val = (finds[i].unsorted == -1) ? &amp;notpresent
                                              : v + finds[i].unsorted;
 
-        if (sk_sint_find_ex(s, val) != finds[i].unsorted) {
-            fprintf(stderr, &quot;test int unsorted find_ex %d\n&quot;, i);
+        if (!TEST_int_eq(sk_sint_find_ex(s, val), finds[i].unsorted)) {
+            TEST_info(&quot;int unsorted find_ex %d&quot;, i);
             goto end;
         }
     }
 
     /* sorting */
-    if (sk_sint_is_sorted(s)) {
-        fprintf(stderr, &quot;test int unsorted\n&quot;);
+    if (!TEST_false(sk_sint_is_sorted(s)))
         goto end;
-    }
     sk_sint_set_cmp_func(s, &amp;int_compare);
     sk_sint_sort(s);
-    if (!sk_sint_is_sorted(s)) {
-        fprintf(stderr, &quot;test int sorted\n&quot;);
+    if (!TEST_true(sk_sint_is_sorted(s)))
         goto end;
-    }
 
     /* find sorted -- the value is matched so we don't need to locate it */
     for (i = 0; i &lt; n_finds; i++)
-        if (sk_sint_find(s, &amp;finds[i].value) != finds[i].sorted) {
-            fprintf(stderr, &quot;test int sorted find %d\n&quot;, i);
+        if (!TEST_int_eq(sk_sint_find(s, &amp;finds[i].value), finds[i].sorted)) {
+            TEST_info(&quot;int sorted find %d&quot;, i);
             goto end;
         }
 
     /* find_ex sorted */
     for (i = 0; i &lt; n_finds; i++)
-        if (sk_sint_find_ex(s, &amp;finds[i].value) != finds[i].ex) {
-            fprintf(stderr, &quot;test int sorted find_ex present %d\n&quot;, i);
+        if (!TEST_int_eq(sk_sint_find_ex(s, &amp;finds[i].value), finds[i].ex)) {
+            TEST_info(&quot;int sorted find_ex present %d&quot;, i);
             goto end;
         }
     for (i = 0; i &lt; n_exfinds; i++)
-        if (sk_sint_find_ex(s, &amp;exfinds[i].value) != exfinds[i].ex) {
-            fprintf(stderr, &quot;test int sorted find_ex absent %d\n&quot;, i);
+        if (!TEST_int_eq(sk_sint_find_ex(s, &amp;exfinds[i].value), exfinds[i].ex)){
+            TEST_info(&quot;int sorted find_ex absent %d&quot;, i);
             goto end;
         }
 
     /* shift */
-    if (sk_sint_shift(s) != v + 6) {
-        fprintf(stderr, &quot;test int shift\n&quot;);
+    if (!TEST_ptr_eq(sk_sint_shift(s), v + 6))
         goto end;
-    }
 
     testresult = 1;
 end:
@@ -189,29 +181,25 @@ static int test_uchar_stack(void)
 
     /* unshift and num */
     for (i = 0; i &lt; n; i++) {
-        if (sk_uchar_num(s) != i) {
-            fprintf(stderr, &quot;test uchar stack size %d\n&quot;, i);
+        if (!TEST_int_eq(sk_uchar_num(s), i)) {
+            TEST_info(&quot;uchar stack size %d&quot;, i);
             goto end;
         }
         sk_uchar_unshift(s, v + i);
     }
-    if (sk_uchar_num(s) != n) {
-        fprintf(stderr, &quot;test uchar stack size %d\n&quot;, n);
+    if (!TEST_int_eq(sk_uchar_num(s), n))
         goto end;
-    }
 
     /* dup */
     r = sk_uchar_dup(s);
-    if (sk_uchar_num(r) != n) {
-        fprintf(stderr, &quot;test uchar dup size %d\n&quot;, n);
+    if (!TEST_int_eq(sk_uchar_num(r), n))
         goto end;
-    }
     sk_uchar_sort(r);
 
     /* pop */
     for (i = 0; i &lt; n; i++) 
-        if (sk_uchar_pop(s) != v + i) {
-            fprintf(stderr, &quot;test uchar pop %d\n&quot;, i);
+        if (!TEST_ptr_eq(sk_uchar_pop(s), v + i)) {
+            TEST_info(&quot;uchar pop %d&quot;, i);
             goto end;
         }
 
@@ -220,43 +208,35 @@ static int test_uchar_stack(void)
     s = NULL;
 
     /* dup again */
-    if (sk_uchar_num(r) != n) {
-        fprintf(stderr, &quot;test uchar dup size %d\n&quot;, n);
+    if (!TEST_int_eq(sk_uchar_num(r), n))
         goto end;
-    }
 
     /* zero */
     sk_uchar_zero(r);
-    if (sk_uchar_num(r) != 0) {
-        fprintf(stderr, &quot;test uchar zero %d\n&quot;, n);
+    if (!TEST_int_eq(sk_uchar_num(r), 0))
         goto end;
-    }
 
     /* insert */
     sk_uchar_insert(r, v, 0);
     sk_uchar_insert(r, v + 2, -1);
     sk_uchar_insert(r, v + 1, 1);
     for (i = 0; i &lt; 3; i++)
-        if (sk_uchar_value(r, i) != v + i) {
-            fprintf(stderr, &quot;test uchar insert %d\n&quot;, i);
+        if (!TEST_ptr_eq(sk_uchar_value(r, i), v + i)) {
+            TEST_info(&quot;uchar insert %d&quot;, i);
             goto end;
         }
 
     /* delete */
-    if (sk_uchar_delete(r, 12) != NULL) {
-        fprintf(stderr, &quot;test uchar delete missing %d\n&quot;, n);
+    if (!TEST_ptr_null(sk_uchar_delete(r, 12)))
         goto end;
-    }
-    if (sk_uchar_delete(r, 1) != v + 1) {
-        fprintf(stderr, &quot;test uchar delete middle %d\n&quot;, n);
+    if (!TEST_ptr_eq(sk_uchar_delete(r, 1), v + 1))
         goto end;
-    }
 
     /* set */
     sk_uchar_set(r, 1, v + 1);
     for (i = 0; i &lt; 2; i++)
-        if (sk_uchar_value(r, i) != v + i) {
-            fprintf(stderr, &quot;test uchar set %d\n&quot;, i);
+        if (!TEST_ptr_eq(sk_uchar_value(r, i), v + i)) {
+            TEST_info(&quot;uchar set %d&quot;, i);
             goto end;
         }
 
@@ -293,37 +273,35 @@ static int test_SS_stack(void)
     for (i = 0; i &lt; n; i++) {
         v[i] = OPENSSL_malloc(sizeof(*v[i]));
 
-        if (v[i] == NULL) {
-            fprintf(stderr, &quot;test SS memory allocation failure\n&quot;);
+        if (!TEST_ptr(v[i]))
             goto end;
-        }
         v[i]-&gt;n = i;
         v[i]-&gt;c = 'A' + i;
-        if (sk_SS_num(s) != i) {
-            fprintf(stderr, &quot;test SS stack size %d\n&quot;, i);
+        if (!TEST_int_eq(sk_SS_num(s), i)) {
+            TEST_info(&quot;SS stack size %d&quot;, i);
             goto end;
         }
         sk_SS_push(s, v[i]);
     }
-    if (sk_SS_num(s) != n) {
-        fprintf(stderr, &quot;test SS size %d\n&quot;, n);
+    if (!TEST_int_eq(sk_SS_num(s), n))
         goto end;
-    }
 
     /* deepcopy */
     r = sk_SS_deep_copy(s, &amp;SS_copy, &amp;SS_free);
-    if (r == NULL) {
-        fprintf(stderr, &quot;test SS deepcopy failure\n&quot;);
+    if (!TEST_ptr(r))
         goto end;
-    }
     for (i = 0; i &lt; n; i++) {
         p = sk_SS_value(r, i);
-        if (p == v[i]) {
-            fprintf(stderr, &quot;test SS deepcopy non-copy %d\n&quot;, i);
+        if (!TEST_ptr_ne(p, v[i])) {
+            TEST_info(&quot;SS deepcopy non-copy %d&quot;, i);
             goto end;
         }
-        if (p-&gt;n != v[i]-&gt;n || p-&gt;c != v[i]-&gt;c) {
-            fprintf(stderr, &quot;test SS deepcopy values %d\n&quot;, i);
+        if (!TEST_int_eq(p-&gt;n, v[i]-&gt;n)) {
+            TEST_info(&quot;test SS deepcopy int %d&quot;, i);
+            goto end;
+        }
+        if (!TEST_char_eq(p-&gt;c, v[i]-&gt;c)) {
+            TEST_info(&quot;SS deepcopy char %d&quot;, i);
             goto end;
         }
     }
@@ -333,18 +311,15 @@ static int test_SS_stack(void)
     r = NULL;
 
     /* delete_ptr */
-    if ((p = sk_SS_delete_ptr(s, v[3])) == NULL) {
-        fprintf(stderr, &quot;test SS delete ptr not found\n&quot;);
+    p = sk_SS_delete_ptr(s, v[3]);
+    if (!TEST_ptr(p))
         goto end;
-    }
     SS_free(p);
-    if (sk_SS_num(s) != n-1) {
-        fprintf(stderr, &quot;test SS delete ptr size\n&quot;);
+    if (!TEST_int_eq(sk_SS_num(s), n - 1))
         goto end;
-    }
     for (i = 0; i &lt; n-1; i++)
-        if (sk_SS_value(s, i) != v[i&lt;3 ? i : 1+i]) {
-            fprintf(stderr, &quot;test SS delete ptr item %d\n&quot;, i);
+        if (!TEST_ptr_eq(sk_SS_value(s, i), v[i&lt;3 ? i : 1+i])) {
+            TEST_info(&quot;SS delete ptr item %d&quot;, i);
             goto end;
         }
 
@@ -369,21 +344,19 @@ static int test_SU_stack(void)
             v[i].n = i;
         else
             v[i].c = 'A' + i;
-        if (sk_SU_num(s) != i) {
-            fprintf(stderr, &quot;test SU stack size %d\n&quot;, i);
+        if (!TEST_int_eq(sk_SU_num(s), i)) {
+            TEST_info(&quot;SU stack size %d&quot;, i);
             goto end;
         }
         sk_SU_push(s, v + i);
     }
-    if (sk_SU_num(s) != n) {
-        fprintf(stderr, &quot;test SU size %d\n&quot;, n);
+    if (!TEST_int_eq(sk_SU_num(s), n))
         goto end;
-    }
 
     /* check the pointers are correct */
     for (i = 0; i &lt; n; i++)
-        if (sk_SU_value(s, i) != v + i) {
-            fprintf(stderr, &quot;test SU pointer check %d\n&quot;, i);
+        if (!TEST_ptr_eq(sk_SU_value(s, i),  v + i)) {
+            TEST_info(&quot;SU pointer check %d&quot;, i);
             goto end;
         }
 
diff --git a/test/test_test.c b/test/test_test.c
new file mode 100644
index 0000000..df4725a
--- /dev/null
+++ b/test/test_test.c
@@ -0,0 +1,276 @@
+/*
+ * Copyright 2017 The OpenSSL Project Authors. All Rights Reserved.
+ *
+ * Licensed under the OpenSSL license (the &quot;License&quot;).  You may not use
+ * this file except in compliance with the License.  You can obtain a copy
+ * in the file LICENSE in the source distribution or at
+ * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
+ */
+
+/*
+ * Copyright (c) 2017 Oracle and/or its affiliates.  All rights reserved.
+ */
+
+#include &lt;stdio.h&gt;
+#include &lt;string.h&gt;
+
+#include &lt;openssl/opensslconf.h&gt;
+#include &lt;openssl/err.h&gt;
+#include &lt;openssl/crypto.h&gt;
+
+#include &quot;e_os.h&quot;
+#include &quot;test_main.h&quot;
+#include &quot;testutil.h&quot;
+
+#define C(l, b, t)                                      \
+    if ((t) != b) {                                     \
+        fprintf(stderr, &quot;FATAL : %s != %d\n&quot;, #t, b);   \
+        goto l;                                         \
+    }
+
+static int test_int(void)
+{
+    C(err, 1, TEST_int_eq(1, 1));
+    C(err, 0, TEST_int_eq(1, -1));
+    C(err, 1, TEST_int_ne(1, 2));
+    C(err, 0, TEST_int_ne(3, 3));
+    C(err, 1, TEST_int_lt(4, 9));
+    C(err, 0, TEST_int_lt(9, 4));
+    C(err, 1, TEST_int_le(4, 9));
+    C(err, 1, TEST_int_le(5, 5));
+    C(err, 0, TEST_int_le(9, 4));
+    C(err, 1, TEST_int_gt(8, 5));
+    C(err, 0, TEST_int_gt(5, 8));
+    C(err, 1, TEST_int_ge(8, 5));
+    C(err, 1, TEST_int_ge(6, 6));
+    C(err, 0, TEST_int_ge(5, 8));
+    return 1;
+
+err:
+    return 0;
+}
+
+static int test_uint(void)
+{
+    C(err, 1, TEST_uint_eq(3u, 3u));
+    C(err, 0, TEST_uint_eq(3u, 5u));
+    C(err, 1, TEST_uint_ne(4u, 2u));
+    C(err, 0, TEST_uint_ne(6u, 6u));
+    C(err, 1, TEST_uint_lt(5u, 9u));
+    C(err, 0, TEST_uint_lt(9u, 5u));
+    C(err, 1, TEST_uint_le(5u, 9u));
+    C(err, 1, TEST_uint_le(7u, 7u));
+    C(err, 0, TEST_uint_le(9u, 5u));
+    C(err, 1, TEST_uint_gt(11u, 1u));
+    C(err, 0, TEST_uint_gt(1u, 11u));
+    C(err, 1, TEST_uint_ge(11u, 1u));
+    C(err, 1, TEST_uint_ge(6u, 6u));
+    C(err, 0, TEST_uint_ge(1u, 11u));
+    return 1;
+
+err:
+    return 0;
+}
+
+static int test_char(void)
+{
+    C(err, 1, TEST_char_eq('a', 'a'));
+    C(err, 0, TEST_char_eq('a', 'A'));
+    C(err, 1, TEST_char_ne('a', 'c'));
+    C(err, 0, TEST_char_ne('e', 'e'));
+    C(err, 1, TEST_char_lt('i', 'x'));
+    C(err, 0, TEST_char_lt('x', 'i'));
+    C(err, 1, TEST_char_le('i', 'x'));
+    C(err, 1, TEST_char_le('n', 'n'));
+    C(err, 0, TEST_char_le('x', 'i'));
+    C(err, 1, TEST_char_gt('w', 'n'));
+    C(err, 0, TEST_char_gt('n', 'w'));
+    C(err, 1, TEST_char_ge('w', 'n'));
+    C(err, 1, TEST_char_ge('p', 'p'));
+    C(err, 0, TEST_char_ge('n', 'w'));
+    return 1;
+
+err:
+    return 0;
+}
+
+static int test_uchar(void)
+{
+    C(err, 1, TEST_uchar_eq(49, 49));
+    C(err, 0, TEST_uchar_eq(49, 60));
+    C(err, 1, TEST_uchar_ne(50, 2));
+    C(err, 0, TEST_uchar_ne(66, 66));
+    C(err, 1, TEST_uchar_lt(60, 80));
+    C(err, 0, TEST_uchar_lt(80, 60));
+    C(err, 1, TEST_uchar_le(60, 80));
+    C(err, 1, TEST_uchar_le(78, 78));
+    C(err, 0, TEST_uchar_le(80, 60));
+    C(err, 1, TEST_uchar_gt(88, 37));
+    C(err, 0, TEST_uchar_gt(37, 88));
+    C(err, 1, TEST_uchar_ge(88, 37));
+    C(err, 1, TEST_uchar_ge(66, 66));
+    C(err, 0, TEST_uchar_ge(37, 88));
+    return 1;
+
+err:
+    return 0;
+}
+
+static int test_long(void)
+{
+    C(err, 1, TEST_long_eq(123l, 123l));
+    C(err, 0, TEST_long_eq(123l, -123l));
+    C(err, 1, TEST_long_ne(123l, 500l));
+    C(err, 0, TEST_long_ne(1000l, 1000l));
+    C(err, 1, TEST_long_lt(-8923l, 102934563l));
+    C(err, 0, TEST_long_lt(102934563l, -8923l));
+    C(err, 1, TEST_long_le(-8923l, 102934563l));
+    C(err, 1, TEST_long_le(12345l, 12345l));
+    C(err, 0, TEST_long_le(102934563l, -8923l));
+    C(err, 1, TEST_long_gt(84325677l, 12345l));
+    C(err, 0, TEST_long_gt(12345l, 84325677l));
+    C(err, 1, TEST_long_ge(84325677l, 12345l));
+    C(err, 1, TEST_long_ge(465869l, 465869l));
+    C(err, 0, TEST_long_ge(12345l, 84325677l));
+    return 1;
+
+err:
+    return 0;
+}
+
+static int test_ulong(void)
+{
+    C(err, 1, TEST_ulong_eq(919ul, 919ul));
+    C(err, 0, TEST_ulong_eq(919ul, 10234ul));
+    C(err, 1, TEST_ulong_ne(8190ul, 66ul));
+    C(err, 0, TEST_ulong_ne(10555ul, 10555ul));
+    C(err, 1, TEST_ulong_lt(10234ul, 1000000ul));
+    C(err, 0, TEST_ulong_lt(1000000ul, 10234ul));
+    C(err, 1, TEST_ulong_le(10234ul, 1000000ul));
+    C(err, 1, TEST_ulong_le(100000ul, 100000ul));
+    C(err, 0, TEST_ulong_le(1000000ul, 10234ul));
+    C(err, 1, TEST_ulong_gt(100000000ul, 22ul));
+    C(err, 0, TEST_ulong_gt(22ul, 100000000ul));
+    C(err, 1, TEST_ulong_ge(100000000ul, 22ul));
+    C(err, 1, TEST_ulong_ge(10555ul, 10555ul));
+    C(err, 0, TEST_ulong_ge(22ul, 100000000ul));
+    return 1;
+
+err:
+    return 0;
+}
+
+static int test_size_t(void)
+{
+    C(err, 1, TEST_int_eq((size_t)10, (size_t)10));
+    C(err, 0, TEST_int_eq((size_t)10, (size_t)12));
+    C(err, 1, TEST_int_ne((size_t)10, (size_t)12));
+    C(err, 0, TEST_int_ne((size_t)24, (size_t)24));
+    C(err, 1, TEST_int_lt((size_t)30, (size_t)88));
+    C(err, 0, TEST_int_lt((size_t)88, (size_t)30));
+    C(err, 1, TEST_int_le((size_t)30, (size_t)88));
+    C(err, 1, TEST_int_le((size_t)33, (size_t)33));
+    C(err, 0, TEST_int_le((size_t)88, (size_t)30));
+    C(err, 1, TEST_int_gt((size_t)52, (size_t)33));
+    C(err, 0, TEST_int_gt((size_t)33, (size_t)52));
+    C(err, 1, TEST_int_ge((size_t)52, (size_t)33));
+    C(err, 1, TEST_int_ge((size_t)38, (size_t)38));
+    C(err, 0, TEST_int_ge((size_t)33, (size_t)52));
+    return 1;
+
+err:
+    return 0;
+}
+
+static int test_pointer(void)
+{
+    int x = 0;
+    char y = 1;
+
+    C(err, 1, TEST_ptr(&amp;y));
+    C(err, 0, TEST_ptr(NULL));
+    C(err, 0, TEST_ptr_null(&amp;y));
+    C(err, 1, TEST_ptr_null(NULL));
+    C(err, 1, TEST_ptr_eq(NULL, NULL));
+    C(err, 0, TEST_ptr_eq(NULL, &amp;y));
+    C(err, 0, TEST_ptr_eq(&amp;y, NULL));
+    C(err, 0, TEST_ptr_eq(&amp;y, &amp;x));
+    C(err, 1, TEST_ptr_eq(&amp;x, &amp;x));
+    C(err, 0, TEST_ptr_ne(NULL, NULL));
+    C(err, 1, TEST_ptr_ne(NULL, &amp;y));
+    C(err, 1, TEST_ptr_ne(&amp;y, NULL));
+    C(err, 1, TEST_ptr_ne(&amp;y, &amp;x));
+    C(err, 0, TEST_ptr_ne(&amp;x, &amp;x));
+    return 1;
+
+err:
+    return 0;
+}
+
+static int test_bool(void)
+{
+    C(err, 0, TEST_true(0));
+    C(err, 1, TEST_true(1));
+    C(err, 1, TEST_false(0));
+    C(err, 0, TEST_false(1));
+    return 1;
+
+err:
+    return 0;
+}
+
+static int test_string(void)
+{
+    static char buf[] = &quot;abc&quot;;
+    C(err, 1, TEST_str_eq(NULL, NULL));
+    C(err, 1, TEST_str_eq(&quot;abc&quot;, buf));
+    C(err, 0, TEST_str_eq(&quot;abc&quot;, NULL));
+    C(err, 0, TEST_str_eq(NULL, buf));
+    C(err, 0, TEST_str_ne(NULL, NULL));
+    C(err, 0, TEST_str_ne(&quot;abc&quot;, buf));
+    C(err, 1, TEST_str_ne(&quot;abc&quot;, NULL));
+    C(err, 1, TEST_str_ne(NULL, buf));
+    return 1;
+
+err:
+    return 0;
+}
+
+static int test_memory(void)
+{
+    static char buf[] = &quot;xyz&quot;;
+    C(err, 1, TEST_mem_eq(NULL, 0, NULL, 0));
+    C(err, 1, TEST_mem_eq(NULL, 1, NULL, 2));
+    C(err, 0, TEST_mem_eq(NULL, 0, &quot;xyz&quot;, 3));
+    C(err, 0, TEST_mem_eq(NULL, 0, &quot;&quot;, 0));
+    C(err, 0, TEST_mem_eq(&quot;xyz&quot;, 3, NULL, 0));
+    C(err, 0, TEST_mem_eq(&quot;xyz&quot;, 3, buf, sizeof(buf)));
+    C(err, 1, TEST_mem_eq(&quot;xyz&quot;, 4, buf, sizeof(buf)));
+    return 1;
+
+err:
+    return 0;
+}
+
+static int test_messages(void)
+{
+    TEST_info(&quot;This is an %s message.&quot;, &quot;info&quot;);
+    TEST_error(&quot;This is an %s message.&quot;, &quot;error&quot;);
+    return 1;
+}
+
+void register_tests(void)
+{
+    ADD_TEST(test_int);
+    ADD_TEST(test_uint);
+    ADD_TEST(test_char);
+    ADD_TEST(test_uchar);
+    ADD_TEST(test_long);
+    ADD_TEST(test_ulong);
+    ADD_TEST(test_size_t);
+    ADD_TEST(test_pointer);
+    ADD_TEST(test_bool);
+    ADD_TEST(test_string);
+    ADD_TEST(test_memory);
+    ADD_TEST(test_messages);
+}
diff --git a/test/testutil.c b/test/testutil.c
index aab4513..867be17 100644
--- a/test/testutil.c
+++ b/test/testutil.c
@@ -19,6 +19,9 @@
 #include &lt;openssl/crypto.h&gt;
 #include &lt;openssl/err.h&gt;
 
+/* The size of memory buffers to display on failure */
+#define MEM_BUFFER_SIZE     (21)
+
 /*
  * Declares the structures needed to register each test case function.
  */
@@ -145,18 +148,284 @@ int run_tests(const char *test_prog_name)
     return EXIT_SUCCESS;
 }
 
+/*
+ * A common routine to output test failure messages.  Generally this should not
+ * be called directly, rather it should be called by the following functions.
+ *
+ * |desc| is a printf formatted description with arguments |args| that is
+ * supplied by the user and |desc| can be NULL.  |type| is the data type
+ * that was tested (int, char, ptr, ...).  |fmt| is a system provided
+ * printf format with following arguments that spell out the failure
+ * details i.e. the actual values compared and the operator used.
+ *
+ * The typical use for this is from an utility test function:
+ *
+ * int test6(const char *file, int line, int n) {
+ *     if (n != 6) {
+ *         test_fail_message(1, file, line, &quot;int&quot;, &quot;value %d is not %d&quot;, n, 6);
+ *         return 0;
+ *     }
+ *     return 1;
+ * }
+ *
+ * calling test6(3, &quot;oops&quot;) will return 0 and produce out along the lines of:
+ *      FAIL oops: (int) value 3 is not 6\n
+ *
+ * It general, test_fail_message should not be called directly.
+ */
+static void test_fail_message(const char *prefix, const char *file, int line,
+                              const char *type, const char *fmt, ...)
+            PRINTF_FORMAT(5, 6);
+
+static void test_fail_message_va(const char *prefix, const char *file, int line,
+                                 const char *type, const char *fmt, va_list ap)
+{
+    fputs(prefix != NULL ? prefix : &quot;ERROR&quot;, stderr);
+    fputs(&quot;:&quot;, stderr);
+    if (type)
+        fprintf(stderr, &quot; (%s)&quot;, type);
+    if (fmt != NULL) {
+        fputc(' ', stderr);
+        vfprintf(stderr, fmt, ap);
+    }
+    if (file != NULL) {
+        fprintf(stderr, &quot; @ %s:%d&quot;, file, line);
+    }
+    fputc('\n', stderr);
+}
+
+static void test_fail_message(const char *prefix, const char *file, int line,
+                              const char *type, const char *fmt, ...)
+{
+    va_list ap;
+    va_start(ap, fmt);
+    test_fail_message_va(prefix, file, line, type, fmt, ap);
+    va_end(ap);
+}
+
+void test_info_c90(const char *desc, ...)
+{
+    va_list ap;
+
+    va_start(ap, desc);
+    test_fail_message_va(&quot;INFO&quot;, NULL, -1, NULL, desc, ap);
+    va_end(ap);
+}
+
+void test_info(const char *file, int line, const char *desc, ...)
+{
+    va_list ap;
+
+    va_start(ap, desc);
+    test_fail_message_va(&quot;INFO&quot;, file, line, NULL, desc, ap);
+    va_end(ap);
+}
+
+void test_error_c90(const char *desc, ...)
+{
+    va_list ap;
+
+    va_start(ap, desc);
+    test_fail_message(NULL, NULL, -1, NULL, desc, ap);
+    va_end(ap);
+}
+
+void test_error(const char *file, int line, const char *desc, ...)
+{
+    va_list ap;
+
+    va_start(ap, desc);
+    test_fail_message_va(NULL, file, line, NULL, desc, ap);
+    va_end(ap);
+}
+
+/*
+ * Define some comparisons between pairs of various types.
+ * These functions return 1 if the test is true.
+ * Otherwise, they return 0 and pretty-print diagnostics.
+ *
+ * In each case the functions produced are:
+ *  int test_name_eq(const type t1, const type t2, const char *desc, ...);
+ *  int test_name_ne(const type t1, const type t2, const char *desc, ...);
+ *  int test_name_lt(const type t1, const type t2, const char *desc, ...);
+ *  int test_name_le(const type t1, const type t2, const char *desc, ...);
+ *  int test_name_gt(const type t1, const type t2, const char *desc, ...);
+ *  int test_name_ge(const type t1, const type t2, const char *desc, ...);
+ *
+ * The t1 and t2 arguments are to be compared for equality, inequality,
+ * less than, less than or equal to, greater than and greater than or
+ * equal to respectively.  If the specified condition holds, the functions
+ * return 1.  If the condition does not hold, the functions print a diagnostic
+ * message and return 0.
+ *
+ * The desc argument is a printf format string followed by its arguments and
+ * this is included in the output if the condition being tested for is false.
+ */
+#define DEFINE_COMPARISON(type, name, opname, op, fmt)                  \
+    int test_ ## name ## _ ## opname(const char *file, int line,        \
+                                     const char *s1, const char *s2,    \
+                                     const type t1, const type t2)      \
+    {                                                                   \
+        if (t1 op t2)                                                   \
+            return 1;                                                   \
+        test_fail_message(NULL, file, line, #type,                      \
+                          &quot;%s [&quot; fmt &quot;] &quot; #op &quot; %s [&quot; fmt &quot;]&quot;,          \
+                          s1, t1, s2, t2);                              \
+        return 0;                                                       \
+    }
+
+#define DEFINE_COMPARISONS(type, name, fmt)                             \
+    DEFINE_COMPARISON(type, name, eq, ==, fmt)                          \
+    DEFINE_COMPARISON(type, name, ne, !=, fmt)                          \
+    DEFINE_COMPARISON(type, name, lt, &lt;, fmt)                           \
+    DEFINE_COMPARISON(type, name, le, &lt;=, fmt)                          \
+    DEFINE_COMPARISON(type, name, gt, &gt;, fmt)                           \
+    DEFINE_COMPARISON(type, name, ge, &gt;=, fmt)
+
+DEFINE_COMPARISONS(int, int, &quot;%d&quot;)
+DEFINE_COMPARISONS(unsigned int, uint, &quot;%u&quot;)
+DEFINE_COMPARISONS(char, char, &quot;%c&quot;)
+DEFINE_COMPARISONS(unsigned char, uchar, &quot;%u&quot;)
+DEFINE_COMPARISONS(long, long, &quot;%ld&quot;)
+DEFINE_COMPARISONS(unsigned long, ulong, &quot;%lu&quot;)
+DEFINE_COMPARISONS(size_t, size_t, &quot;%&quot; OSSLzu)
+
+DEFINE_COMPARISON(void *, ptr, eq, ==, &quot;%p&quot;)
+DEFINE_COMPARISON(void *, ptr, ne, !=, &quot;%p&quot;)
+
+int test_ptr_null(const char *file, int line, const char *s, const void *p)
+{
+    if (p == NULL)
+        return 1;
+    test_fail_message(NULL, file, line, &quot;ptr&quot;, &quot;%s [%p] == NULL&quot;, s, p);
+    return 0;
+}
+
+int test_ptr(const char *file, int line, const char *s, const void *p)
+{
+    if (p != NULL)
+        return 1;
+    test_fail_message(NULL, file, line, &quot;ptr&quot;, &quot;%s [%p] != NULL&quot;, s, p);
+    return 0;
+}
+
+int test_true(const char *file, int line, const char *s, int b)
+{
+    if (b)
+        return 1;
+    test_fail_message(NULL, file, line, &quot;bool&quot;, &quot;%s [false] == true&quot;, s);
+    return 0;
+}
+
+int test_false(const char *file, int line, const char *s, int b)
+{
+    if (!b)
+        return 1;
+    test_fail_message(NULL, file, line, &quot;bool&quot;, &quot;%s [true] == false&quot;, s);
+    return 0;
+}
+
 static const char *print_string_maybe_null(const char *s)
 {
     return s == NULL ? &quot;(NULL)&quot; : s;
 }
 
-int strings_equal(const char *desc, const char *s1, const char *s2)
+int test_str_eq(const char *file, int line, const char *st1, const char *st2,
+                const char *s1, const char *s2)
 {
     if (s1 == NULL &amp;&amp; s2 == NULL)
       return 1;
     if (s1 == NULL || s2 == NULL || strcmp(s1, s2) != 0) {
-        fprintf(stderr, &quot;%s mismatch: %s vs %s\n&quot;, desc, print_string_maybe_null(s1),
-                print_string_maybe_null(s2));
+        test_fail_message(NULL, file, line, &quot;string&quot;, &quot;%s [%s] == %s [%s]&quot;,
+                          st1, print_string_maybe_null(s1),
+                          st2, print_string_maybe_null(s2));
+        return 0;
+    }
+    return 1;
+}
+
+int test_str_ne(const char *file, int line, const char *st1, const char *st2,
+                const char *s1, const char *s2)
+{
+    if ((s1 == NULL) ^ (s2 == NULL))
+      return 1;
+    if (s1 == NULL || strcmp(s1, s2) == 0) {
+        test_fail_message(NULL, file, line, &quot;string&quot;, &quot;%s [%s] != %s [%s]&quot;,
+                          st1, print_string_maybe_null(s1),
+                          st2, print_string_maybe_null(s2));
+        return 0;
+    }
+    return 1;
+}
+
+/*
+ * We could use OPENSSL_buf2hexstr() to do this but trying to allocate memory
+ * in a failure state isn't generally a great idea.
+ */
+static const char *print_mem_maybe_null(const void *s, size_t n,
+                                        char out[MEM_BUFFER_SIZE])
+{
+    size_t i;
+    const unsigned char *p = (const unsigned char *)s;
+    int pad = 2*n &gt;= MEM_BUFFER_SIZE;
+
+    if (s == NULL)
+        return &quot;(NULL)&quot;;
+    if (pad)
+        n = MEM_BUFFER_SIZE-4;
+    
+    for (i=0; i&lt;2*n; i++) {
+        unsigned char c = (i &amp; 1) != 0 ? p[i / 2] &amp; 15 : p[i / 2] &gt;&gt; 4;
+        out[i] = &quot;0123456789abcdef&quot;[c];
+    }
+    if (pad) {
+        out[i++] = '.';
+        out[i++] = '.';
+        out[i++] = '.';
+    }
+    out[i] = '\0';
+        
+    return out;
+}
+
+int test_mem_eq(const char *file, int line, const char *st1, const char *st2,
+                const void *s1, size_t n1, const void *s2, size_t n2)
+{
+    char b1[MEM_BUFFER_SIZE], b2[MEM_BUFFER_SIZE];
+
+    if (s1 == NULL &amp;&amp; s2 == NULL)
+        return 1;
+    if (n1 != n2) {
+        test_fail_message(NULL, file, line, &quot;memory&quot;,
+                          &quot;size mismatch %s %s [%&quot;OSSLzu&quot;] != %s %s [%&quot;OSSLzu&quot;]&quot;,
+                          st1, print_mem_maybe_null(s1, n1, b1), n1,
+                          st2, print_mem_maybe_null(s2, n2, b2), n2);
+        return 0;
+    }
+    if (s1 == NULL || s2 == NULL || memcmp(s1, s2, n1) != 0) {
+        test_fail_message(NULL, file, line, &quot;memory&quot;,
+                          &quot;%s %s [%&quot;OSSLzu&quot;] != %s %s [%&quot;OSSLzu&quot;]&quot;,
+                          st1, print_mem_maybe_null(s1, n1, b1), n1,
+                          st2, print_mem_maybe_null(s2, n2, b2), n2);
+        return 0;
+    }
+    return 1;
+}
+
+int test_mem_ne(const char *file, int line, const char *st1, const char *st2,
+                const void *s1, size_t n1, const void *s2, size_t n2)
+{
+    char b1[MEM_BUFFER_SIZE], b2[MEM_BUFFER_SIZE];
+
+    if ((s1 == NULL) ^ (s2 == NULL))
+      return 1;
+    if (n1 != n2)
+        return 1;
+    if (s1 == NULL || memcmp(s1, s2, n1) == 0) {
+        test_fail_message(NULL, file, line, &quot;memory&quot;,
+                          &quot;%s %s [%&quot;OSSLzu&quot;] != %s %s [%&quot;OSSLzu&quot;]&quot;,
+                          st1, print_mem_maybe_null(s1, n1, b1), n1,
+                          st2, print_mem_maybe_null(s2, n2, b2), n2);
         return 0;
     }
     return 1;
diff --git a/test/testutil.h b/test/testutil.h
index cc2f153..1ca295c 100644
--- a/test/testutil.h
+++ b/test/testutil.h
@@ -10,6 +10,8 @@
 #ifndef HEADER_TESTUTIL_H
 # define HEADER_TESTUTIL_H
 
+#include &lt;stdarg.h&gt;
+
 #include &lt;openssl/err.h&gt;
 #include &lt;openssl/e_os2.h&gt;
 
@@ -140,18 +142,176 @@ __owur int run_tests(const char *test_prog_name);
  *  Test assumption verification helpers.
  */
 
+# if defined(__GNUC__)
+#define PRINTF_FORMAT(a, b)   __attribute__ ((format(printf, a, b)))
+# else
+#define PRINTF_FORMAT(a, b)
+#endif
+
+#  define DECLARE_COMPARISON(type, name, opname)                        \
+    int test_ ## name ## _ ## opname(const char *, int,                 \
+                                     const char *, const char *,        \
+                                     const type, const type);
+
+# define DECLARE_COMPARISONS(type, name)                                \
+    DECLARE_COMPARISON(type, name, eq)                                  \
+    DECLARE_COMPARISON(type, name, ne)                                  \
+    DECLARE_COMPARISON(type, name, lt)                                  \
+    DECLARE_COMPARISON(type, name, le)                                  \
+    DECLARE_COMPARISON(type, name, gt)                                  \
+    DECLARE_COMPARISON(type, name, ge)
+
+DECLARE_COMPARISONS(int, int)
+DECLARE_COMPARISONS(unsigned int, uint)
+DECLARE_COMPARISONS(char, char)
+DECLARE_COMPARISONS(unsigned char, uchar)
+DECLARE_COMPARISONS(long, long)
+DECLARE_COMPARISONS(unsigned long, ulong)
+DECLARE_COMPARISONS(size_t, size_t)
+
+/*
+ * Pointer comparisons against other pointers and null.
+ * These functions return 1 if the test is true.
+ * Otherwise, they return 0 and pretty-print diagnostics.
+ * These should not be called directly, use the TEST_xxx macros below instead.
+ */
+DECLARE_COMPARISON(void *, ptr, eq)
+DECLARE_COMPARISON(void *, ptr, ne)
+int test_ptr(const char *file, int line, const char *s, const void *p);
+int test_ptr_null(const char *file, int line, const char *s, const void *p);
+
 /*
- * Returns 1 if |s1| and |s2| are both NULL or equal.
- * Otherwise, returns 0 and pretty-prints diagnostics using |desc|.
+ * Equality tests for strings where NULL is a legitimate value.
+ * These calls return 1 if the two passed strings compare true.
+ * Otherwise, they return 0 and pretty-print diagnostics.
+ * These should not be called directly, use the TEST_xxx macros below instead.
  */
-int strings_equal(const char *desc, const char *s1, const char *s2);
+DECLARE_COMPARISON(char *, str, eq)
+DECLARE_COMPARISON(char *, str, ne)
+
+/*
+ * Equality test for memory blocks where NULL is a legitimate value.
+* These calls return 1 if the two memory blocks compare true.
+ * Otherwise, they return 0 and pretty-print diagnostics.
+ * These should not be called directly, use the TEST_xxx macros below instead.
+ */
+int test_mem_eq(const char *, int, const char *, const char *,
+                const void *, size_t, const void *, size_t);
+int test_mem_ne(const char *, int, const char *, const char *,
+                const void *, size_t, const void *, size_t);
+
+/*
+ * Check a boolean result for being true or false.
+ * They return 1 if the condition is true (i.e. the value is non-zro).
+ * Otherwise, they return 0 and pretty-prints diagnostics using |desc|.
+ * These should not be called directly, use the TEST_xxx macros below instead.
+ */
+int test_true(const char *file, int line, const char *s, int b);
+int test_false(const char *file, int line, const char *s, int b);
+
+/*
+ * Pretty print a failure message.
+ * These should not be called directly, use the TEST_xxx macros below instead.
+ */
+void test_error(const char *file, int line, const char *desc, ...)
+    PRINTF_FORMAT(3, 4);
+void test_error_c90(const char *desc, ...) PRINTF_FORMAT(1, 2);
+void test_info(const char *file, int line, const char *desc, ...)
+    PRINTF_FORMAT(3, 4);
+void test_info_c90(const char *desc, ...) PRINTF_FORMAT(1, 2);
+
+/*
+ * The following macros provide wrapper calls to the test functions with
+ * a default description that indicates the file and line number of the error.
+ */
+# define TEST_int_eq(a, b)    test_int_eq(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_int_ne(a, b)    test_int_ne(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_int_lt(a, b)    test_int_lt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_int_le(a, b)    test_int_le(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_int_gt(a, b)    test_int_gt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_int_ge(a, b)    test_int_ge(__FILE__, __LINE__, #a, #b, a, b)
+
+# define TEST_int_eq(a, b)    test_int_eq(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_int_ne(a, b)    test_int_ne(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_int_lt(a, b)    test_int_lt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_int_le(a, b)    test_int_le(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_int_gt(a, b)    test_int_gt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_int_ge(a, b)    test_int_ge(__FILE__, __LINE__, #a, #b, a, b)
+
+# define TEST_uint_eq(a, b)    test_uint_eq(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_uint_ne(a, b)    test_uint_ne(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_uint_lt(a, b)    test_uint_lt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_uint_le(a, b)    test_uint_le(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_uint_gt(a, b)    test_uint_gt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_uint_ge(a, b)    test_uint_ge(__FILE__, __LINE__, #a, #b, a, b)
+
+# define TEST_char_eq(a, b)    test_char_eq(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_char_ne(a, b)    test_char_ne(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_char_lt(a, b)    test_char_lt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_char_le(a, b)    test_char_le(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_char_gt(a, b)    test_char_gt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_char_ge(a, b)    test_char_ge(__FILE__, __LINE__, #a, #b, a, b)
+
+# define TEST_uchar_eq(a, b)    test_uchar_eq(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_uchar_ne(a, b)    test_uchar_ne(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_uchar_lt(a, b)    test_uchar_lt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_uchar_le(a, b)    test_uchar_le(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_uchar_gt(a, b)    test_uchar_gt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_uchar_ge(a, b)    test_uchar_ge(__FILE__, __LINE__, #a, #b, a, b)
+
+# define TEST_long_eq(a, b)    test_long_eq(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_long_ne(a, b)    test_long_ne(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_long_lt(a, b)    test_long_lt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_long_le(a, b)    test_long_le(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_long_gt(a, b)    test_long_gt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_long_ge(a, b)    test_long_ge(__FILE__, __LINE__, #a, #b, a, b)
+
+# define TEST_ulong_eq(a, b)    test_ulong_eq(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_ulong_ne(a, b)    test_ulong_ne(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_ulong_lt(a, b)    test_ulong_lt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_ulong_le(a, b)    test_ulong_le(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_ulong_gt(a, b)    test_ulong_gt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_ulong_ge(a, b)    test_ulong_ge(__FILE__, __LINE__, #a, #b, a, b)
+
+# define TEST_size_t_eq(a, b)    test_size_t_eq(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_size_t_ne(a, b)    test_size_t_ne(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_size_t_lt(a, b)    test_size_t_lt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_size_t_le(a, b)    test_size_t_le(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_size_t_gt(a, b)    test_size_t_gt(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_size_t_ge(a, b)    test_size_t_ge(__FILE__, __LINE__, #a, #b, a, b)
+
+# define TEST_ptr_eq(a, b)    test_ptr_eq(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_ptr_ne(a, b)    test_ptr_ne(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_ptr(a)          test_ptr(__FILE__, __LINE__, #a, a)
+# define TEST_ptr_null(a)     test_ptr_null(__FILE__, __LINE__, #a, a)
+
+# define TEST_str_eq(a, b)    test_str_eq(__FILE__, __LINE__, #a, #b, a, b)
+# define TEST_str_ne(a, b)    test_str_ne(__FILE__, __LINE__, #a, #b, a, b)
+
+# define TEST_mem_eq(a, m, b, n) test_mem_eq(__FILE__, __LINE__, #a, #b, a, m, b, n)
+# define TEST_mem_ne(a, m, b, n) test_mem_ne(__FILE__, __LINE__, #a, #b, a, m, b, n)
+
+# define TEST_true(a)         test_true(__FILE__, __LINE__, #a, a)
+# define TEST_false(a)        test_false(__FILE__, __LINE__, #a, a)
+
+/*
+ * TEST_error(desc, ...) prints an informative error message in the standard
+ * format.  |desc| is a printf format string.
+ */
+# if !defined(__STDC_VERSION__) || __STDC_VERSION__ &lt; 199901L
+#  define TEST_error         test_error_c90
+#  define TEST_info          test_info_c90
+# else
+#  define TEST_error(...)    test_error(__FILE__, __LINE__, __VA_ARGS__)
+#  define TEST_info(...)     test_info(__FILE__, __LINE__, __VA_ARGS__)
+# endif
 
 /*
  * For &quot;impossible&quot; conditions such as malloc failures or bugs in test code,
  * where continuing the test would be meaningless. Note that OPENSSL_assert
  * is fatal, and is never compiled out.
  */
-#define TEST_check(condition)                   \
+# define TEST_check(condition)                  \
     do {                                        \
         if (!(condition)) {                     \
             ERR_print_errors_fp(stderr);        \
diff --git a/test/tls13encryptiontest.c b/test/tls13encryptiontest.c
index 8229293..8137847 100644
--- a/test/tls13encryptiontest.c
+++ b/test/tls13encryptiontest.c
@@ -269,20 +269,13 @@ static int test_record(SSL3_RECORD *rec, RECORD_DATA *recd, int enc)
     else
         refd = multihexstr2buf(recd-&gt;plaintext, &amp;refdatalen);
 
-    if (refd == NULL) {
-        fprintf(stderr, &quot;Failed to get reference data\n&quot;);
+    if (!TEST_ptr(refd)) {
+        TEST_info(&quot;Failed to get reference data&quot;);
         goto err;
     }
 
-    if (rec-&gt;length != refdatalen) {
-        fprintf(stderr, &quot;Unexpected length\n&quot;);
+    if (!TEST_mem_eq(rec-&gt;data, rec-&gt;length, refd, refdatalen))
         goto err;
-    }
-
-    if (memcmp(rec-&gt;data, refd, refdatalen) != 0) {
-        fprintf(stderr, &quot;Data does not match\n&quot;);
-        goto err;
-    }
 
     ret = 1;
 
@@ -306,27 +299,28 @@ static int test_tls13_encryption(void)
     rec.data = NULL;
 
     ctx = SSL_CTX_new(TLS_method());
-    if (ctx == NULL) {
-        fprintf(stderr, &quot;Failed creating SSL_CTX\n&quot;);
+    if (!TEST_ptr(ctx)) {
+        TEST_info(&quot;Failed creating SSL_CTX&quot;);
         goto err;
     }
 
     s = SSL_new(ctx);
-    if (s == NULL) {
-        fprintf(stderr, &quot;Failed creating SSL\n&quot;);
+    if (!TEST_ptr(s)) {
+        TEST_info(&quot;Failed creating SSL&quot;);
         goto err;
     }
 
     s-&gt;enc_read_ctx = EVP_CIPHER_CTX_new();
+    if (!TEST_ptr(s-&gt;enc_read_ctx))
+        goto err;
+
     s-&gt;enc_write_ctx = EVP_CIPHER_CTX_new();
-    if (s-&gt;enc_read_ctx == NULL || s-&gt;enc_write_ctx == NULL) {
-        fprintf(stderr, &quot;Failed creating EVP_CIPHER_CTX\n&quot;);
+    if (!TEST_ptr(s-&gt;enc_write_ctx))
         goto err;
-    }
 
     s-&gt;s3-&gt;tmp.new_cipher = SSL_CIPHER_find(s, TLS13_AES_128_GCM_SHA256_BYTES);
-    if (s-&gt;s3-&gt;tmp.new_cipher == NULL) {
-        fprintf(stderr, &quot;Failed to find cipher\n&quot;);
+    if (!TEST_ptr(s-&gt;s3-&gt;tmp.new_cipher)) {
+        TEST_info(&quot;Failed to find cipher&quot;);
         goto err;
     }
 
@@ -335,7 +329,7 @@ static int test_tls13_encryption(void)
         ivlen = EVP_CIPHER_iv_length(ciph);
         if (!load_record(&amp;rec, &amp;refdata[ctr], &amp;key, s-&gt;read_iv, ivlen,
                          RECORD_LAYER_get_read_sequence(&amp;s-&gt;rlayer))) {
-            fprintf(stderr, &quot;Failed loading key into EVP_CIPHER_CTX\n&quot;);
+            TEST_error(&quot;Failed loading key into EVP_CIPHER_CTX&quot;);
             goto err;
         }
 
@@ -348,27 +342,27 @@ static int test_tls13_encryption(void)
         if (EVP_CipherInit_ex(s-&gt;enc_write_ctx, ciph, NULL, key, NULL, 1) &lt;= 0
                 || EVP_CipherInit_ex(s-&gt;enc_read_ctx, ciph, NULL, key, NULL, 0)
                    &lt;= 0) {
-            fprintf(stderr, &quot;Failed loading key into EVP_CIPHER_CTX\n&quot;);
+            TEST_error(&quot;Failed loading key into EVP_CIPHER_CTX\n&quot;);
             goto err;
         }
 
         /* Encrypt it */
-        if (tls13_enc(s, &amp;rec, 1, 1) != 1) {
-            fprintf(stderr, &quot;Failed to encrypt record %&quot;OSSLzu&quot;\n&quot;, ctr);
+        if (!TEST_size_t_eq(tls13_enc(s, &amp;rec, 1, 1), 1)) {
+            TEST_info(&quot;Failed to encrypt record %&quot;OSSLzu&quot;&quot;, ctr);
             goto err;
         }
-        if (!test_record(&amp;rec, &amp;refdata[ctr], 1)) {
-            fprintf(stderr, &quot;Record %&quot;OSSLzu&quot; encryption test failed\n&quot;, ctr);
+        if (!TEST_true(test_record(&amp;rec, &amp;refdata[ctr], 1))) {
+            TEST_info(&quot;Record %&quot;OSSLzu&quot; encryption test failed&quot;, ctr);
             goto err;
         }
 
         /* Decrypt it */
-        if (tls13_enc(s, &amp;rec, 1, 0) != 1) {
-            fprintf(stderr, &quot;Failed to decrypt record %&quot;OSSLzu&quot;\n&quot;, ctr);
+        if (!TEST_int_eq(tls13_enc(s, &amp;rec, 1, 0), 1)) {
+            TEST_info(&quot;Failed to decrypt record %&quot;OSSLzu&quot;&quot;, ctr);
             goto err;
         }
-        if (!test_record(&amp;rec, &amp;refdata[ctr], 0)) {
-            fprintf(stderr, &quot;Record %&quot;OSSLzu&quot; decryption test failed\n&quot;, ctr);
+        if (!TEST_true(test_record(&amp;rec, &amp;refdata[ctr], 0))) {
+            TEST_info(&quot;Record %&quot;OSSLzu&quot; decryption test failed&quot;, ctr);
             goto err;
         }
 
diff --git a/test/tls13secretstest.c b/test/tls13secretstest.c
index 47e7766..46ccd19 100644
--- a/test/tls13secretstest.c
+++ b/test/tls13secretstest.c
@@ -213,40 +213,34 @@ static int test_secret(SSL *s, unsigned char *prk,
     const EVP_MD *md = ssl_handshake_md(s);
 
     if (!ssl_handshake_hash(s, hash, sizeof(hash), &amp;hashsize)) {
-        fprintf(stderr, &quot;Failed to get hash\n&quot;);
+        TEST_error(&quot;Failed to get hash&quot;);
         return 0;
     }
 
     if (!tls13_hkdf_expand(s, md, prk, label, labellen, hash, gensecret,
                            hashsize)) {
-        fprintf(stderr, &quot;Secret generation failed\n&quot;);
+        TEST_error(&quot;Secret generation failed&quot;);
         return 0;
     }
 
-    if (memcmp(gensecret, ref_secret, hashsize) != 0) {
-        fprintf(stderr, &quot;Generated secret does not match\n&quot;);
+    if (!TEST_mem_eq(gensecret, hashsize, ref_secret, hashsize))
         return 0;
-    }
 
     if (!tls13_derive_key(s, md, gensecret, key, KEYLEN)) {
-        fprintf(stderr, &quot;Key generation failed\n&quot;);
+        TEST_error(&quot;Key generation failed&quot;);
         return 0;
     }
 
-    if (memcmp(key, ref_key, KEYLEN) != 0) {
-        fprintf(stderr, &quot;Generated key does not match\n&quot;);
+    if (!TEST_mem_eq(key, KEYLEN, ref_key, KEYLEN))
         return 0;
-    }
 
     if (!tls13_derive_iv(s, md, gensecret, iv, IVLEN)) {
-        fprintf(stderr, &quot;IV generation failed\n&quot;);
+        TEST_error(&quot;IV generation failed&quot;);
         return 0;
     }
 
-    if (memcmp(iv, ref_iv, IVLEN) != 0) {
-        fprintf(stderr, &quot;Generated IV does not match\n&quot;);
+    if (!TEST_mem_eq(iv, IVLEN, ref_iv, IVLEN))
         return 0;
-    }
 
     return 1;
 }
@@ -261,64 +255,67 @@ static int test_handshake_secrets(void)
     size_t master_secret_length;
 
     ctx = SSL_CTX_new(TLS_method());
-    if (ctx == NULL)
+    if (!TEST_ptr(ctx))
         goto err;
 
     s = SSL_new(ctx);
-    if (s == NULL)
+    if (!TEST_ptr(s ))
         goto err;
 
     s-&gt;session = SSL_SESSION_new();
-    if (s-&gt;session == NULL)
+    if (!TEST_ptr(s-&gt;session))
         goto err;
 
-    if (!tls13_generate_secret(s, ssl_handshake_md(s), NULL, NULL, 0,
-                               (unsigned char *)&amp;s-&gt;early_secret)) {
-        fprintf(stderr, &quot;Early secret generation failed\n&quot;);
+    if (!TEST_true(tls13_generate_secret(s, ssl_handshake_md(s), NULL, NULL, 0,
+                                         (unsigned char *)&amp;s-&gt;early_secret))) {
+        TEST_info(&quot;Early secret generation failed&quot;);
         goto err;
     }
 
-    if (memcmp(s-&gt;early_secret, early_secret, sizeof(early_secret)) != 0) {
-        fprintf(stderr, &quot;Early secret does not match\n&quot;);
+    if (!TEST_mem_eq(s-&gt;early_secret, sizeof(early_secret),
+                     early_secret, sizeof(early_secret))) {
+        TEST_info(&quot;Early secret does not match&quot;);
         goto err;
     }
 
-    if (!tls13_generate_handshake_secret(s, ecdhe_secret,
-                                         sizeof(ecdhe_secret))) {
-        fprintf(stderr, &quot;Hanshake secret generation failed\n&quot;);
+    if (!TEST_true(tls13_generate_handshake_secret(s, ecdhe_secret,
+                                                   sizeof(ecdhe_secret)))) {
+        TEST_info(&quot;Hanshake secret generation failed&quot;);
         goto err;
     }
 
-    if (memcmp(s-&gt;handshake_secret, handshake_secret,
-               sizeof(handshake_secret)) != 0) {
-        fprintf(stderr, &quot;Handshake secret does not match\n&quot;);
+    if (!TEST_mem_eq(s-&gt;handshake_secret, sizeof(handshake_secret),
+                     handshake_secret, sizeof(handshake_secret)))
         goto err;
-    }
 
     hashsize = EVP_MD_size(ssl_handshake_md(s));
-    if (sizeof(client_hts) != hashsize || sizeof(client_hts_key) != KEYLEN
-            || sizeof(client_hts_iv) != IVLEN) {
-        fprintf(stderr, &quot;Internal test error\n&quot;);
+    if (!TEST_size_t_eq(sizeof(client_hts), hashsize))
+        goto err;
+    if (!TEST_size_t_eq(sizeof(client_hts_key), KEYLEN))
+        goto err;
+    if (!TEST_size_t_eq(sizeof(client_hts_iv), IVLEN))
         goto err;
-    }
 
-    if (!test_secret(s, s-&gt;handshake_secret, (unsigned char *)client_hts_label,
-                     strlen(client_hts_label), client_hts, client_hts_key,
-                     client_hts_iv)) {
-        fprintf(stderr, &quot;Client handshake secret test failed\n&quot;);
+    if (!TEST_true(test_secret(s, s-&gt;handshake_secret,
+                               (unsigned char *)client_hts_label,
+                               strlen(client_hts_label), client_hts,
+                               client_hts_key, client_hts_iv))) {
+        TEST_info(&quot;Client handshake secret test failed&quot;);
         goto err;
     }
 
-    if (sizeof(server_hts) != hashsize || sizeof(server_hts_key) != KEYLEN
-            || sizeof(server_hts_iv) != IVLEN) {
-        fprintf(stderr, &quot;Internal test error\n&quot;);
+    if (!TEST_size_t_eq(sizeof(server_hts), hashsize))
+        goto err;
+    if (!TEST_size_t_eq(sizeof(server_hts_key), KEYLEN))
+        goto err;
+    if (!TEST_size_t_eq(sizeof(server_hts_iv), IVLEN))
         goto err;
-    }
 
-    if (!test_secret(s, s-&gt;handshake_secret, (unsigned char *)server_hts_label,
-                     strlen(server_hts_label), server_hts, server_hts_key,
-                     server_hts_iv)) {
-        fprintf(stderr, &quot;Server handshake secret test failed\n&quot;);
+    if (!TEST_true(test_secret(s, s-&gt;handshake_secret,
+                               (unsigned char *)server_hts_label,
+                               strlen(server_hts_label), server_hts,
+                               server_hts_key, server_hts_iv))) {
+        TEST_info(&quot;Server handshake secret test failed&quot;);
         goto err;
     }
 
@@ -328,43 +325,46 @@ static int test_handshake_secrets(void)
      */
     full_hash = 1;
 
-    if (!tls13_generate_master_secret(s, out_master_secret,
-                                      s-&gt;handshake_secret, hashsize,
-                                      &amp;master_secret_length)) {
-        fprintf(stderr, &quot;Master secret generation failed\n&quot;);
+    if (!TEST_true(tls13_generate_master_secret(s, out_master_secret,
+                                                s-&gt;handshake_secret, hashsize,
+                                                &amp;master_secret_length))) {
+        TEST_info(&quot;Master secret generation failed&quot;);
         goto err;
     }
 
-    if (master_secret_length != sizeof(master_secret) ||
-            memcmp(out_master_secret, master_secret,
-                   sizeof(master_secret)) != 0) {
-        fprintf(stderr, &quot;Master secret does not match\n&quot;);
+    if (!TEST_mem_eq(out_master_secret, master_secret_length,
+                     master_secret, sizeof(master_secret))) {
+        TEST_info(&quot;Master secret does not match&quot;);
         goto err;
     }
 
-    if (sizeof(client_ats) != hashsize || sizeof(client_ats_key) != KEYLEN
-            || sizeof(client_ats_iv) != IVLEN) {
-        fprintf(stderr, &quot;Internal test error\n&quot;);
+    if (!TEST_size_t_eq(sizeof(client_ats), hashsize))
+        goto err;
+    if (!TEST_size_t_eq(sizeof(client_ats_key), KEYLEN))
+        goto err;
+    if (!TEST_size_t_eq(sizeof(client_ats_iv), IVLEN))
         goto err;
-    }
 
-    if (!test_secret(s, out_master_secret, (unsigned char *)client_ats_label,
-                     strlen(client_ats_label), client_ats, client_ats_key,
-                     client_ats_iv)) {
-        fprintf(stderr, &quot;Client application data secret test failed\n&quot;);
+    if (!TEST_true(test_secret(s, out_master_secret,
+                               (unsigned char *)client_ats_label,
+                               strlen(client_ats_label), client_ats,
+                               client_ats_key, client_ats_iv))) {
+        TEST_info(&quot;Client application data secret test failed&quot;);
         goto err;
     }
 
-    if (sizeof(server_ats) != hashsize || sizeof(server_ats_key) != KEYLEN
-            || sizeof(server_ats_iv) != IVLEN) {
-        fprintf(stderr, &quot;Internal test error\n&quot;);
+    if (!TEST_size_t_eq(sizeof(server_ats), hashsize))
+        goto err;
+    if (!TEST_size_t_eq(sizeof(server_ats_key), KEYLEN))
+        goto err;
+    if (!TEST_size_t_eq(sizeof(server_ats_iv), IVLEN))
         goto err;
-    }
 
-    if (!test_secret(s, out_master_secret, (unsigned char *)server_ats_label,
-                     strlen(server_ats_label), server_ats, server_ats_key,
-                     server_ats_iv)) {
-        fprintf(stderr, &quot;Server application data secret test failed\n&quot;);
+    if (!TEST_true(test_secret(s, out_master_secret,
+                               (unsigned char *)server_ats_label,
+                               strlen(server_ats_label), server_ats,
+                               server_ats_key, server_ats_iv))) {
+        TEST_info(&quot;Server application data secret test failed&quot;);
         goto err;
     }
 
diff --git a/test/x509_internal_test.c b/test/x509_internal_test.c
index df88f89..d602efc 100644
--- a/test/x509_internal_test.c
+++ b/test/x509_internal_test.c
@@ -42,7 +42,7 @@ static int test_standard_exts()
     }
     if (!good) {
         tmp = standard_exts;
-        fprintf(stderr, &quot;Extensions out of order!\n&quot;);
+        TEST_error(&quot;Extensions out of order!&quot;);
         for (i = 0; i &lt; STANDARD_EXTENSION_COUNT; i++, tmp++)
             fprintf(stderr, &quot;%d : %s\n&quot;, (*tmp)-&gt;ext_nid,
                     OBJ_nid2sn((*tmp)-&gt;ext_nid));
diff --git a/test/x509_time_test.c b/test/x509_time_test.c
index 5f69ebd..d9a7f50 100644
--- a/test/x509_time_test.c
+++ b/test/x509_time_test.c
@@ -156,8 +156,8 @@ static int test_x509_cmp_time(int idx)
     t.length = strlen(x509_cmp_tests[idx].data);
 
     result = X509_cmp_time(&amp;t, &amp;x509_cmp_tests[idx].cmp_time);
-    if (result != x509_cmp_tests[idx].expected) {
-        fprintf(stderr, &quot;test_x509_cmp_time(%d) failed: expected %d, got %d\n&quot;,
+    if (!TEST_int_eq(result, x509_cmp_tests[idx].expected)) {
+        TEST_info(&quot;test_x509_cmp_time(%d) failed: expected %d, got %d\n&quot;,
                 idx, x509_cmp_tests[idx].expected, result);
         return 0;
     }
@@ -175,18 +175,12 @@ static int test_x509_cmp_time_current()
     asn1_after = ASN1_TIME_adj(NULL, now, 1, 0);
 
     cmp_result  = X509_cmp_time(asn1_before, NULL);
-    if (cmp_result != -1) {
-        fprintf(stderr, &quot;test_x509_cmp_time_current failed: expected -1, got %d\n&quot;,
-                cmp_result);
+    if (!TEST_int_eq(cmp_result, -1))
         failed = 1;
-    }
 
     cmp_result = X509_cmp_time(asn1_after, NULL);
-    if (cmp_result != 1) {
-        fprintf(stderr, &quot;test_x509_cmp_time_current failed: expected 1, got %d\n&quot;,
-                cmp_result);
+    if (!TEST_int_eq(cmp_result, 1))
         failed = 1;
-    }
 
     ASN1_TIME_free(asn1_before);
     ASN1_TIME_free(asn1_after);
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013866.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="013877.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13874">[ date ]</a>
              <a href="thread.html#13874">[ thread ]</a>
              <a href="subject.html#13874">[ subject ]</a>
              <a href="author.html#13874">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
