<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-commits] [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2018-March/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1521025502.041606.28208.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018529.html">
   <LINK REL="Next"  HREF="018534.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-commits] [openssl]  master update</H1>
    <B>Matt Caswell</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl-commits%5D%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1521025502.041606.28208.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl-commits] [openssl]  master update">matt at openssl.org
       </A><BR>
    <I>Wed Mar 14 11:05:02 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="018529.html">[openssl-commits] [openssl]  master update
</A></li>
        <LI>Next message: <A HREF="018534.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18531">[ date ]</a>
              <a href="thread.html#18531">[ thread ]</a>
              <a href="subject.html#18531">[ subject ]</a>
              <a href="author.html#18531">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  fa25763b5528b56b448d64bfbaeac54905b0c80d (commit)
       via  74826901379bf190a9c3b3ceaaca0493454e3536 (commit)
       via  2b527b9b3233eb312a4bf17b044660aa213883b6 (commit)
       via  9d2674cd232ab51f5ae7952a63a614b688145527 (commit)
       via  e54b3ccdbe42d614890fb43cee274e6b14e741dd (commit)
       via  f865b08143b453962ad4afccd69e698d13c60f77 (commit)
      from  5b68d1792021463b7cd5d76c82b251d61a56d869 (commit)


- Log -----------------------------------------------------------------
commit fa25763b5528b56b448d64bfbaeac54905b0c80d
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Mar 14 10:43:53 2018 +0000

    Put the default set of TLSv1.3 ciphersuites in a header file
    
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/5392">https://github.com/openssl/openssl/pull/5392</A>)

commit 74826901379bf190a9c3b3ceaaca0493454e3536
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Mon Mar 12 10:48:32 2018 +0000

    Fix clienthellotest for new TLSv1.3 ciphersuite configuration
    
    A place in clienthellotest was missed in converting to the new mechanism
    for configuration of TLSv1.3 ciphersuites.
    
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/5392">https://github.com/openssl/openssl/pull/5392</A>)

commit 2b527b9b3233eb312a4bf17b044660aa213883b6
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Feb 21 17:47:12 2018 +0000

    Update CHANGES with details of TLSv1.3 ciphersuite configuration
    
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/5392">https://github.com/openssl/openssl/pull/5392</A>)

commit 9d2674cd232ab51f5ae7952a63a614b688145527
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Wed Feb 21 17:23:11 2018 +0000

    Add documentation for TLSv1.3 ciphersuite configuration
    
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/5392">https://github.com/openssl/openssl/pull/5392</A>)

commit e54b3ccdbe42d614890fb43cee274e6b14e741dd
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Mon Feb 19 12:07:18 2018 +0000

    Update s_time to be allow configuration of TLSv1.3 ciphersuites
    
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/5392">https://github.com/openssl/openssl/pull/5392</A>)

commit f865b08143b453962ad4afccd69e698d13c60f77
Author: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Date:   Fri Feb 16 11:26:02 2018 +0000

    Split configuration of TLSv1.3 ciphers from older ciphers
    
    With the current mechanism, old cipher strings that used to work in 1.1.0,
    may inadvertently disable all TLSv1.3 ciphersuites causing connections to
    fail. This is confusing for users.
    
    In reality TLSv1.3 are quite different to older ciphers. They are much
    simpler and there are only a small number of them so, arguably, they don't
    need the same level of control that the older ciphers have.
    
    This change splits the configuration of TLSv1.3 ciphers from older ones.
    By default the TLSv1.3 ciphers are on, so you cannot inadvertently disable
    them through your existing config.
    
    Fixes #5359
    
    Reviewed-by: Tim Hudson &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tjh at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/5392">https://github.com/openssl/openssl/pull/5392</A>)

-----------------------------------------------------------------------

Summary of changes:
 CHANGES                                 |  16 ++-
 apps/apps.h                             |   6 +-
 apps/ciphers.c                          |  14 ++-
 apps/s_time.c                           |  24 ++--
 crypto/err/openssl.txt                  |   1 +
 doc/man1/ciphers.pod                    |  26 +++--
 doc/man1/s_client.pod                   |  19 +++-
 doc/man1/s_server.pod                   |  20 +++-
 doc/man1/s_time.pod                     |  19 +++-
 doc/man3/SSL_CONF_cmd.pod               |  25 ++++-
 doc/man3/SSL_CTX_set_cipher_list.pod    |  50 ++++++++-
 include/openssl/ssl.h                   |   7 ++
 include/openssl/sslerr.h                |   1 +
 include/openssl/tls1.h                  |  12 --
 ssl/s3_lib.c                            | 192 +++++++++++++++++---------------
 ssl/ssl_ciph.c                          |  21 +++-
 ssl/ssl_conf.c                          |  13 +++
 ssl/ssl_err.c                           |   1 +
 ssl/ssl_lib.c                           | 119 +++++++++++++++++++-
 ssl/ssl_locl.h                          |  12 +-
 test/cipherlist_test.c                  |  14 +--
 test/clienthellotest.c                  |   7 +-
 test/fatalerrtest.c                     |   4 +
 test/recipes/70-test_sslsigalgs.t       |  18 +--
 test/recipes/70-test_tls13hrr.t         |   5 +-
 test/recipes/70-test_tls13psk.t         |   6 +-
 test/recipes/80-test_ssl_old.t          |  21 +++-
 test/ssl-tests/02-protocol-version.conf |   2 +
 test/ssl-tests/protocol_version.pm      |   2 +
 test/sslapitest.c                       |  22 ++--
 test/sslcorrupttest.c                   |  12 +-
 test/ssltest_old.c                      |  17 ++-
 util/libssl.num                         |   2 +
 util/perl/TLSProxy/Proxy.pm             |  30 ++++-
 34 files changed, 541 insertions(+), 219 deletions(-)

diff --git a/CHANGES b/CHANGES
index dcbe291..0e275c3 100644
--- a/CHANGES
+++ b/CHANGES
@@ -9,6 +9,15 @@
 
  Changes between 1.1.0g and 1.1.1 [xx XXX xxxx]
 
+  *) Separated TLSv1.3 ciphersuite configuration out from TLSv1.2 ciphersuite
+     configuration. TLSv1.3 ciphersuites are not compatible with TLSv1.2 and
+     below. Similarly TLSv1.2 ciphersuites are not compatible with TLSv1.3.
+     In order to avoid issues where legacy TLSv1.2 ciphersuite configuration
+     would otherwise inadvertently disable all TLSv1.3 ciphersuites the
+     configuraton has been separated out. See the ciphers man page or the
+     SSL_CTX_set_ciphersuites() man page for more information.
+     [Matt Caswell]
+
   *) On POSIX (BSD, Linux, ...) systems the ocsp(1) command running
      in responder mode now supports the new &quot;-multi&quot; option, which
      spawns the specified number of child processes to handle OCSP
@@ -35,12 +44,7 @@
 
   *) Support for TLSv1.3 added. Note that users upgrading from an earlier
      version of OpenSSL should review their configuration settings to ensure
-     that they are still appropriate for TLSv1.3. In particular if no TLSv1.3
-     ciphersuites are enabled then OpenSSL will refuse to make a connection
-     unless (1) TLSv1.3 is explicitly disabled or (2) the ciphersuite
-     configuration is updated to include suitable ciphersuites. The DEFAULT
-     ciphersuite configuration does include TLSv1.3 ciphersuites. For further
-     information on this and other related issues please see:
+     that they are still appropriate for TLSv1.3. For further information see:
      <A HREF="https://www.openssl.org/blog/blog/2018/02/08/tlsv1.3/">https://www.openssl.org/blog/blog/2018/02/08/tlsv1.3/</A>
 
      NOTE: In this pre-release of OpenSSL a draft version of the
diff --git a/apps/apps.h b/apps/apps.h
index aa63527..8f2590e 100644
--- a/apps/apps.h
+++ b/apps/apps.h
@@ -229,7 +229,7 @@ int set_cert_times(X509 *x, const char *startdate, const char *enddate,
         OPT_S_ONRESUMP, OPT_S_NOLEGACYCONN, OPT_S_ALLOW_NO_DHE_KEX, \
         OPT_S_PRIORITIZE_CHACHA, \
         OPT_S_STRICT, OPT_S_SIGALGS, OPT_S_CLIENTSIGALGS, OPT_S_GROUPS, \
-        OPT_S_CURVES, OPT_S_NAMEDCURVE, OPT_S_CIPHER, \
+        OPT_S_CURVES, OPT_S_NAMEDCURVE, OPT_S_CIPHER, OPT_S_CIPHERSUITES, \
         OPT_S_RECORD_PADDING, OPT_S_DEBUGBROKE, OPT_S_COMP, \
         OPT_S_NO_RENEGOTIATION, OPT_S_NO_MIDDLEBOX, OPT_S__LAST
 
@@ -272,7 +272,8 @@ int set_cert_times(X509 *x, const char *startdate, const char *enddate,
             &quot;Groups to advertise (colon-separated list)&quot; }, \
         {&quot;named_curve&quot;, OPT_S_NAMEDCURVE, 's', \
             &quot;Elliptic curve used for ECDHE (server-side only)&quot; }, \
-        {&quot;cipher&quot;, OPT_S_CIPHER, 's', &quot;Specify cipher list to be used&quot;}, \
+        {&quot;cipher&quot;, OPT_S_CIPHER, 's', &quot;Specify TLSv1.2 and below cipher list to be used&quot;}, \
+        {&quot;ciphersuites&quot;, OPT_S_CIPHERSUITES, 's', &quot;Specify TLSv1.3 ciphersuites to be used&quot;}, \
         {&quot;record_padding&quot;, OPT_S_RECORD_PADDING, 's', \
             &quot;Block size to pad TLS 1.3 records to.&quot;}, \
         {&quot;debug_broken_protocol&quot;, OPT_S_DEBUGBROKE, '-', \
@@ -305,6 +306,7 @@ int set_cert_times(X509 *x, const char *startdate, const char *enddate,
         case OPT_S_CURVES: \
         case OPT_S_NAMEDCURVE: \
         case OPT_S_CIPHER: \
+        case OPT_S_CIPHERSUITES: \
         case OPT_S_RECORD_PADDING: \
         case OPT_S_NO_RENEGOTIATION: \
         case OPT_S_DEBUGBROKE: \
diff --git a/apps/ciphers.c b/apps/ciphers.c
index 4e8ffd1..0bb33a4 100644
--- a/apps/ciphers.c
+++ b/apps/ciphers.c
@@ -26,6 +26,7 @@ typedef enum OPTION_choice {
     OPT_TLS1_3,
     OPT_PSK,
     OPT_SRP,
+    OPT_CIPHERSUITES,
     OPT_V, OPT_UPPER_V, OPT_S
 } OPTION_CHOICE;
 
@@ -57,6 +58,8 @@ const OPTIONS ciphers_options[] = {
     {&quot;srp&quot;, OPT_SRP, '-', &quot;include ciphersuites requiring SRP&quot;},
 #endif
     {&quot;convert&quot;, OPT_CONVERT, 's', &quot;Convert standard name into OpenSSL name&quot;},
+    {&quot;ciphersuites&quot;, OPT_CIPHERSUITES, 's',
+     &quot;Configure the TLSv1.3 ciphersuites to use&quot;},
     {NULL}
 };
 
@@ -91,7 +94,7 @@ int ciphers_main(int argc, char **argv)
     int srp = 0;
 #endif
     const char *p;
-    char *ciphers = NULL, *prog, *convert = NULL;
+    char *ciphers = NULL, *prog, *convert = NULL, *ciphersuites = NULL;
     char buf[512];
     OPTION_CHOICE o;
     int min_version = 0, max_version = 0;
@@ -153,6 +156,9 @@ int ciphers_main(int argc, char **argv)
             srp = 1;
 #endif
             break;
+        case OPT_CIPHERSUITES:
+            ciphersuites = opt_arg();
+            break;
         }
     }
     argv = opt_rest();
@@ -185,6 +191,12 @@ int ciphers_main(int argc, char **argv)
     if (srp)
         SSL_CTX_set_srp_client_pwd_callback(ctx, dummy_srp);
 #endif
+
+    if (ciphersuites != NULL &amp;&amp; !SSL_CTX_set_ciphersuites(ctx, ciphersuites)) {
+        BIO_printf(bio_err, &quot;Error setting TLSv1.3 ciphersuites\n&quot;);
+        goto err;
+    }
+
     if (ciphers != NULL) {
         if (!SSL_CTX_set_cipher_list(ctx, ciphers)) {
             BIO_printf(bio_err, &quot;Error in cipher list\n&quot;);
diff --git a/apps/s_time.c b/apps/s_time.c
index 149107c..0d3543e 100644
--- a/apps/s_time.c
+++ b/apps/s_time.c
@@ -59,9 +59,9 @@ static const size_t fmt_http_get_cmd_size = sizeof(fmt_http_get_cmd) - 2;
 
 typedef enum OPTION_choice {
     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,
-    OPT_CONNECT, OPT_CIPHER, OPT_CERT, OPT_NAMEOPT, OPT_KEY, OPT_CAPATH,
-    OPT_CAFILE, OPT_NOCAPATH, OPT_NOCAFILE, OPT_NEW, OPT_REUSE, OPT_BUGS,
-    OPT_VERIFY, OPT_TIME, OPT_SSL3,
+    OPT_CONNECT, OPT_CIPHER, OPT_CIPHERSUITES, OPT_CERT, OPT_NAMEOPT, OPT_KEY,
+    OPT_CAPATH, OPT_CAFILE, OPT_NOCAPATH, OPT_NOCAFILE, OPT_NEW, OPT_REUSE,
+    OPT_BUGS, OPT_VERIFY, OPT_TIME, OPT_SSL3,
     OPT_WWW
 } OPTION_CHOICE;
 
@@ -69,7 +69,9 @@ const OPTIONS s_time_options[] = {
     {&quot;help&quot;, OPT_HELP, '-', &quot;Display this summary&quot;},
     {&quot;connect&quot;, OPT_CONNECT, 's',
      &quot;Where to connect as post:port (default is &quot; SSL_CONNECT_NAME &quot;)&quot;},
-    {&quot;cipher&quot;, OPT_CIPHER, 's', &quot;Cipher to use, see 'openssl ciphers'&quot;},
+    {&quot;cipher&quot;, OPT_CIPHER, 's', &quot;TLSv1.2 and below cipher list to be used&quot;},
+    {&quot;ciphersuites&quot;, OPT_CIPHERSUITES, 's',
+     &quot;Specify TLSv1.3 ciphersuites to be used&quot;},
     {&quot;cert&quot;, OPT_CERT, '&lt;', &quot;Cert file to use, PEM format assumed&quot;},
     {&quot;nameopt&quot;, OPT_NAMEOPT, 's', &quot;Various certificate name options&quot;},
     {&quot;key&quot;, OPT_KEY, '&lt;', &quot;File with key, PEM; default is -cert file&quot;},
@@ -106,7 +108,8 @@ int s_time_main(int argc, char **argv)
     SSL *scon = NULL;
     SSL_CTX *ctx = NULL;
     const SSL_METHOD *meth = NULL;
-    char *CApath = NULL, *CAfile = NULL, *cipher = NULL, *www_path = NULL;
+    char *CApath = NULL, *CAfile = NULL, *cipher = NULL, *ciphersuites = NULL;
+    char *www_path = NULL;
     char *host = SSL_CONNECT_NAME, *certfile = NULL, *keyfile = NULL, *prog;
     double totalTime = 0.0;
     int noCApath = 0, noCAfile = 0;
@@ -170,6 +173,9 @@ int s_time_main(int argc, char **argv)
         case OPT_CIPHER:
             cipher = opt_arg();
             break;
+        case OPT_CIPHERSUITES:
+            ciphersuites = opt_arg();
+            break;
         case OPT_BUGS:
             st_bugs = 1;
             break;
@@ -196,10 +202,6 @@ int s_time_main(int argc, char **argv)
 
     if (cipher == NULL)
         cipher = getenv(&quot;SSL_CIPHER&quot;);
-    if (cipher == NULL) {
-        BIO_printf(bio_err, &quot;No CIPHER specified\n&quot;);
-        goto end;
-    }
 
     if ((ctx = SSL_CTX_new(meth)) == NULL)
         goto end;
@@ -210,7 +212,9 @@ int s_time_main(int argc, char **argv)
 
     if (st_bugs)
         SSL_CTX_set_options(ctx, SSL_OP_ALL);
-    if (!SSL_CTX_set_cipher_list(ctx, cipher))
+    if (cipher != NULL &amp;&amp; !SSL_CTX_set_cipher_list(ctx, cipher))
+        goto end;
+    if (ciphersuites != NULL &amp;&amp; !SSL_CTX_set_ciphersuites(ctx, ciphersuites))
         goto end;
     if (!set_cert_stuff(ctx, certfile, keyfile))
         goto end;
diff --git a/crypto/err/openssl.txt b/crypto/err/openssl.txt
index d867007..606f2b1 100644
--- a/crypto/err/openssl.txt
+++ b/crypto/err/openssl.txt
@@ -986,6 +986,7 @@ SSL_F_ADD_CLIENT_KEY_SHARE_EXT:438:*
 SSL_F_ADD_KEY_SHARE:512:add_key_share
 SSL_F_BYTES_TO_CIPHER_LIST:519:bytes_to_cipher_list
 SSL_F_CHECK_SUITEB_CIPHER_LIST:331:check_suiteb_cipher_list
+SSL_F_CIPHERSUITE_CB:621:ciphersuite_cb
 SSL_F_CONSTRUCT_CA_NAMES:552:construct_ca_names
 SSL_F_CONSTRUCT_KEY_EXCHANGE_TBS:553:construct_key_exchange_tbs
 SSL_F_CREATE_SYNTHETIC_MESSAGE_HASH:539:create_synthetic_message_hash
diff --git a/doc/man1/ciphers.pod b/doc/man1/ciphers.pod
index 129f766..eed5e64 100644
--- a/doc/man1/ciphers.pod
+++ b/doc/man1/ciphers.pod
@@ -22,6 +22,7 @@ B&lt;openssl&gt; B&lt;ciphers&gt;
 [B&lt;-srp&gt;]
 [B&lt;-stdname&gt;]
 [B&lt;-convert name&gt;]
+[B&lt;-ciphersuites val&gt;]
 [B&lt;cipherlist&gt;]
 
 =head1 DESCRIPTION
@@ -105,10 +106,21 @@ Precede each cipher suite by its standard name.
 
 Convert a standard cipher B&lt;name&gt; to its OpenSSL name.
 
+=item B&lt;-ciphersuites val&gt;
+
+Sets the list of TLSv1.3 ciphersuites. This list will be combined with any
+TLSv1.2 and below ciphersuites that have been configured. The format for this
+list is a simple colon (&quot;:&quot;) separated list of TLSv1.3 ciphersuite names. By
+default this value is:
+
+&quot;TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256&quot;
+
 =item B&lt;cipherlist&gt;
 
-A cipher list to convert to a cipher preference list. If it is not included
-then the default cipher list will be used. The format is described below.
+A cipher list of TLSv1.2 and below ciphersuites to convert to a cipher
+preference list. This list will be combined with any TLSv1.3 ciphersuites that
+have been configured. If it is not included then the default cipher list will be
+used. The format is described below.
 
 =back
 
@@ -705,11 +717,11 @@ Note: the CBC modes mentioned in this RFC are not supported.
 
 =head2 TLS v1.3 cipher suites
 
- TLS_AES_128_GCM_SHA256                     TLS13-AES-128-GCM-SHA256
- TLS_AES_256_GCM_SHA384                     TLS13-AES-256-GCM-SHA384
- TLS_CHACHA20_POLY1305_SHA256               TLS13-CHACHA20-POLY1305-SHA256
- TLS_AES_128_CCM_SHA256                     TLS13-AES-128-CCM-SHA256
- TLS_AES_128_CCM_8_SHA256                   TLS13-AES-128-CCM-8-SHA256
+ TLS_AES_128_GCM_SHA256                     TLS_AES_128_GCM_SHA256
+ TLS_AES_256_GCM_SHA384                     TLS_AES_256_GCM_SHA384
+ TLS_CHACHA20_POLY1305_SHA256               TLS_CHACHA20_POLY1305_SHA256
+ TLS_AES_128_CCM_SHA256                     TLS_AES_128_CCM_SHA256
+ TLS_AES_128_CCM_8_SHA256                   TLS_AES_128_CCM_8_SHA256
 
 =head2 Older names used by OpenSSL
 
diff --git a/doc/man1/s_client.pod b/doc/man1/s_client.pod
index f101b33..a06d3a6 100644
--- a/doc/man1/s_client.pod
+++ b/doc/man1/s_client.pod
@@ -99,6 +99,7 @@ B&lt;openssl&gt; B&lt;s_client&gt;
 [B&lt;-sigalgs sigalglist&gt;]
 [B&lt;-curves curvelist&gt;]
 [B&lt;-cipher cipherlist&gt;]
+[B&lt;-ciphersuites val&gt;]
 [B&lt;-serverpref&gt;]
 [B&lt;-starttls protocol&gt;]
 [B&lt;-xmpphost hostname&gt;]
@@ -505,10 +506,20 @@ ultimately selected by the server. For a list of all curves, use:
 
 =item B&lt;-cipher cipherlist&gt;
 
-This allows the cipher list sent by the client to be modified. Although
-the server determines which cipher suite is used it should take the first
-supported cipher in the list sent by the client. See the B&lt;ciphers&gt;
-command for more information.
+This allows the TLSv1.2 and below cipher list sent by the client to be modified.
+This list will be combined with any TLSv1.3 ciphersuites that have been
+configured. Although the server determines which ciphersuite is used it should
+take the first supported cipher in the list sent by the client. See the
+B&lt;ciphers&gt; command for more information.
+
+=item B&lt;-ciphersuites val&gt;
+
+This allows the TLSv1.3 ciphersuites sent by the client to be modified. This
+list will be combined with any TLSv1.2 and below ciphersuites that have been
+configured. Although the server determines which cipher suite is used it should
+take the first supported cipher in the list sent by the client. See the
+B&lt;ciphers&gt; command for more information. The format for this list is a simple
+colon (&quot;:&quot;) separated list of TLSv1.3 ciphersuite names.
 
 =item B&lt;-starttls protocol&gt;
 
diff --git a/doc/man1/s_server.pod b/doc/man1/s_server.pod
index ad04359..2f0f79a 100644
--- a/doc/man1/s_server.pod
+++ b/doc/man1/s_server.pod
@@ -113,6 +113,7 @@ B&lt;openssl&gt; B&lt;s_server&gt;
 [B&lt;-curves val&gt;]
 [B&lt;-named_curve val&gt;]
 [B&lt;-cipher val&gt;]
+[B&lt;-ciphersuites val&gt;]
 [B&lt;-dhparam infile&gt;]
 [B&lt;-record_padding val&gt;]
 [B&lt;-debug_broken_protocol&gt;]
@@ -533,12 +534,23 @@ For a list of all possible curves, use:
 
 =item B&lt;-cipher val&gt;
 
-This allows the cipher list used by the server to be modified.  When
-the client sends a list of supported ciphers the first client cipher
-also included in the server list is used. Because the client specifies
-the preference order, the order of the server cipherlist irrelevant. See
+This allows the list of TLSv1.2 and below ciphersuites used by the server to be
+modified. This list is combined with any TLSv1.3 ciphersuites that have been
+configured. When the client sends a list of supported ciphers the first client
+cipher also included in the server list is used. Because the client specifies
+the preference order, the order of the server cipherlist is irrelevant. See
 the B&lt;ciphers&gt; command for more information.
 
+=item B&lt;-ciphersuites val&gt;
+
+This allows the list of TLSv1.3 ciphersuites used by the server to be modified.
+This list is combined with any TLSv1.2 and below ciphersuites that have been
+configured. When the client sends a list of supported ciphers the first client
+cipher also included in the server list is used. Because the client specifies
+the preference order, the order of the server cipherlist is irrelevant. See
+the B&lt;ciphers&gt; command for more information. The format for this list is a
+simple colon (&quot;:&quot;) separated list of TLSv1.3 ciphersuite names.
+
 =item B&lt;-dhparam infile&gt;
 
 The DH parameter file to use. The ephemeral DH cipher suites generate keys
diff --git a/doc/man1/s_time.pod b/doc/man1/s_time.pod
index ecdac17..62a6788 100644
--- a/doc/man1/s_time.pod
+++ b/doc/man1/s_time.pod
@@ -25,6 +25,7 @@ B&lt;openssl&gt; B&lt;s_time&gt;
 [B&lt;-ssl3&gt;]
 [B&lt;-bugs&gt;]
 [B&lt;-cipher cipherlist&gt;]
+[B&lt;-ciphersuites val&gt;]
 
 =head1 DESCRIPTION
 
@@ -128,10 +129,20 @@ option enables various workarounds.
 
 =item B&lt;-cipher cipherlist&gt;
 
-This allows the cipher list sent by the client to be modified. Although
-the server determines which cipher suite is used it should take the first
-supported cipher in the list sent by the client.
-See the L&lt;ciphers(1)&gt; command for more information.
+This allows the TLSv1.2 and below cipher list sent by the client to be modified.
+This list will be combined with any TLSv1.3 ciphersuites that have been
+configured. Although the server determines which cipher suite is used it should
+take the first supported cipher in the list sent by the client. See the
+L&lt;ciphers(1)&gt; command for more information.
+
+=item B&lt;-ciphersuites val&gt;
+
+This allows the TLSv1.3 ciphersuites sent by the client to be modified. This
+list will be combined with any TLSv1.2 and below ciphersuites that have been
+configured. Although the server determines which cipher suite is used it should
+take the first supported cipher in the list sent by the client. See the
+B&lt;ciphers&gt; command for more information. The format for this list is a simple
+colon (&quot;:&quot;) separated list of TLSv1.3 ciphersuite names.
 
 =item B&lt;-time length&gt;
 
diff --git a/doc/man3/SSL_CONF_cmd.pod b/doc/man3/SSL_CONF_cmd.pod
index b4392f4..e3dc42c 100644
--- a/doc/man3/SSL_CONF_cmd.pod
+++ b/doc/man3/SSL_CONF_cmd.pod
@@ -89,10 +89,18 @@ can be either the B&lt;NIST&gt; name (e.g. B&lt;P-256&gt;) or an OpenSSL OID name
 
 =item B&lt;-cipher&gt;
 
-Sets the cipher suite list to B&lt;value&gt;. Note: syntax checking of B&lt;value&gt; is
-currently not performed unless a B&lt;SSL&gt; or B&lt;SSL_CTX&gt; structure is
+Sets the TLSv1.2 and below ciphersuite list to B&lt;value&gt;. This list will be
+combined with any configured TLSv1.3 ciphersuites. Note: syntax checking
+of B&lt;value&gt; is currently not performed unless a B&lt;SSL&gt; or B&lt;SSL_CTX&gt; structure is
 associated with B&lt;cctx&gt;.
 
+=item B&lt;-ciphersuites&gt;
+
+Sets the available ciphersuites for TLSv1.3 to value. This is a simple colon
+(&quot;:&quot;) separated list of TLSv1.3 ciphersuite names in order of preference. This
+list will be combined any configured TLSv1.2 and below ciphersuites.
+
+
 =item B&lt;-cert&gt;
 
 Attempts to use the file B&lt;value&gt; as the certificate for the appropriate
@@ -219,9 +227,16 @@ Note: the command prefix (if set) alters the recognised B&lt;cmd&gt; values.
 
 =item B&lt;CipherString&gt;
 
-Sets the cipher suite list to B&lt;value&gt;. Note: syntax checking of B&lt;value&gt; is
-currently not performed unless an B&lt;SSL&gt; or B&lt;SSL_CTX&gt; structure is
-associated with B&lt;cctx&gt;.
+Sets the ciphersuite list for TLSv1.2 and below to B&lt;value&gt;. This list will be
+combined with any configured TLSv1.3 ciphersuites. Note: syntax
+checking of B&lt;value&gt; is currently not performed unless an B&lt;SSL&gt; or B&lt;SSL_CTX&gt;
+structure is associated with B&lt;cctx&gt;.
+
+=item B&lt;Ciphersuites&gt;
+
+Sets the available ciphersuites for TLSv1.3 to B&lt;value&gt;. This is a simple colon
+(&quot;:&quot;) separated list of TLSv1.3 ciphersuite names in order of preference. This
+list will be combined any configured TLSv1.2 and below ciphersuites.
 
 =item B&lt;Certificate&gt;
 
diff --git a/doc/man3/SSL_CTX_set_cipher_list.pod b/doc/man3/SSL_CTX_set_cipher_list.pod
index 714bb3a..f4b366e 100644
--- a/doc/man3/SSL_CTX_set_cipher_list.pod
+++ b/doc/man3/SSL_CTX_set_cipher_list.pod
@@ -2,7 +2,11 @@
 
 =head1 NAME
 
-SSL_CTX_set_cipher_list, SSL_set_cipher_list - choose list of available SSL_CIPHERs
+SSL_CTX_set_cipher_list,
+SSL_set_cipher_list,
+SSL_CTX_set_ciphersuites,
+SSL_set_ciphersuites
+- choose list of available SSL_CIPHERs
 
 =head1 SYNOPSIS
 
@@ -11,18 +15,49 @@ SSL_CTX_set_cipher_list, SSL_set_cipher_list - choose list of available SSL_CIPH
  int SSL_CTX_set_cipher_list(SSL_CTX *ctx, const char *str);
  int SSL_set_cipher_list(SSL *ssl, const char *str);
 
+ int SSL_CTX_set_ciphersuites(SSL_CTX *ctx, const char *str);
+ int SSL_set_ciphersuites(SSL *s, const char *str);
+
 =head1 DESCRIPTION
 
-SSL_CTX_set_cipher_list() sets the list of available ciphers for B&lt;ctx&gt;
-using the control string B&lt;str&gt;. The format of the string is described
+SSL_CTX_set_cipher_list() sets the list of available ciphers (TLSv1.2 and below)
+for B&lt;ctx&gt; using the control string B&lt;str&gt;. The format of the string is described
 in L&lt;ciphers(1)&gt;. The list of ciphers is inherited by all
-B&lt;ssl&gt; objects created from B&lt;ctx&gt;.
+B&lt;ssl&gt; objects created from B&lt;ctx&gt;. This function does not impact TLSv1.3
+ciphersuites. Use SSL_CTX_set_ciphersuites() to configure those.
+
+SSL_set_cipher_list() sets the list of ciphers (TLSv1.2 and below) only for
+B&lt;ssl&gt;.
+
+SSL_CTX_set_ciphersuites() is used to configure the available TLSv1.3
+ciphersuites for B&lt;ctx&gt;. This is a simple colon (&quot;:&quot;) separated list of TLSv1.3
+ciphersuite names in order of perference. Valid TLSv1.3 ciphersuite names are:
+
+=over 4
+
+=item TLS_AES_128_GCM_SHA256
+
+=item TLS_AES_256_GCM_SHA384
+
+=item TLS_CHACHA20_POLY1305_SHA256
 
-SSL_set_cipher_list() sets the list of ciphers only for B&lt;ssl&gt;.
+=item TLS_AES_128_CCM_SHA256
+
+=item TLS_AES_128_CCM_8_SHA256
+
+=back
+
+An empty list is permissible. The default value for the this setting is:
+
+&quot;TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256&quot;
+
+SSL_set_ciphersuites() is the same as SSL_CTX_set_ciphersuites() except it
+configures the ciphersuites for B&lt;ssl&gt;.
 
 =head1 NOTES
 
-The control string B&lt;str&gt; should be universally usable and not depend
+The control string B&lt;str&gt; for SSL_CTX_set_cipher_list() and
+SSL_set_cipher_list() should be universally usable and not depend
 on details of the library configuration (ciphers compiled in). Thus no
 syntax checking takes place. Items that are not recognized, because the
 corresponding ciphers are not compiled in or because they are mistyped,
@@ -55,6 +90,9 @@ and the handshake will fail.
 SSL_CTX_set_cipher_list() and SSL_set_cipher_list() return 1 if any cipher
 could be selected and 0 on complete failure.
 
+SSL_CTX_set_ciphersuites() and SSL_set_ciphersuites() return 1 if the requested
+ciphersuite list was configured, and 0 otherwise.
+
 =head1 SEE ALSO
 
 L&lt;ssl(7)&gt;, L&lt;SSL_get_ciphers(3)&gt;,
diff --git a/include/openssl/ssl.h b/include/openssl/ssl.h
index ec29405..0679ada 100644
--- a/include/openssl/ssl.h
+++ b/include/openssl/ssl.h
@@ -169,8 +169,13 @@ extern &quot;C&quot; {
 /*
  * The following cipher list is used by default. It also is substituted when
  * an application-defined cipher list string starts with 'DEFAULT'.
+ * This applies to ciphersuites for TLSv1.2 and below.
  */
 # define SSL_DEFAULT_CIPHER_LIST &quot;ALL:!COMPLEMENTOFDEFAULT:!eNULL&quot;
+/* This is the default set of TLSv1.3 ciphersuites */
+# define TLS_DEFAULT_CIPHERSUITES &quot;TLS_AES_256_GCM_SHA384:&quot; \
+                                  &quot;TLS_CHACHA20_POLY1305_SHA256:&quot; \
+                                  &quot;TLS_AES_128_GCM_SHA256&quot;
 /*
  * As of OpenSSL 1.0.0, ssl_create_cipher_list() in ssl/ssl_ciph.c always
  * starts with a reasonable order, and all we have to do for DEFAULT is
@@ -1500,6 +1505,8 @@ void SSL_set_bio(SSL *s, BIO *rbio, BIO *wbio);
 __owur BIO *SSL_get_rbio(const SSL *s);
 __owur BIO *SSL_get_wbio(const SSL *s);
 __owur int SSL_set_cipher_list(SSL *s, const char *str);
+__owur int SSL_CTX_set_ciphersuites(SSL_CTX *ctx, const char *str);
+__owur int SSL_set_ciphersuites(SSL *s, const char *str);
 void SSL_set_read_ahead(SSL *s, int yes);
 __owur int SSL_get_verify_mode(const SSL *s);
 __owur int SSL_get_verify_depth(const SSL *s);
diff --git a/include/openssl/sslerr.h b/include/openssl/sslerr.h
index 454877d..77db871 100644
--- a/include/openssl/sslerr.h
+++ b/include/openssl/sslerr.h
@@ -23,6 +23,7 @@ int ERR_load_SSL_strings(void);
 # define SSL_F_ADD_KEY_SHARE                              512
 # define SSL_F_BYTES_TO_CIPHER_LIST                       519
 # define SSL_F_CHECK_SUITEB_CIPHER_LIST                   331
+# define SSL_F_CIPHERSUITE_CB                             621
 # define SSL_F_CONSTRUCT_CA_NAMES                         552
 # define SSL_F_CONSTRUCT_KEY_EXCHANGE_TBS                 553
 # define SSL_F_CREATE_SYNTHETIC_MESSAGE_HASH              539
diff --git a/include/openssl/tls1.h b/include/openssl/tls1.h
index 0d5b9f8..b9f0918 100644
--- a/include/openssl/tls1.h
+++ b/include/openssl/tls1.h
@@ -1131,18 +1131,6 @@ __owur int SSL_check_chain(SSL *s, X509 *x, EVP_PKEY *pk, STACK_OF(X509) *chain)
 # define TLS1_TXT_RSA_PSK_WITH_ARIA_128_GCM_SHA256         &quot;RSA-PSK-ARIA128-GCM-SHA256&quot;
 # define TLS1_TXT_RSA_PSK_WITH_ARIA_256_GCM_SHA384         &quot;RSA-PSK-ARIA256-GCM-SHA384&quot;
 
-
-/* TLSv1.3 ciphersuites */
-/*
- * TODO(TLS1.3): Review the naming scheme for TLSv1.3 ciphers and also the
- * cipherstring selection process for these ciphers
- */
-# define TLS1_3_TXT_AES_128_GCM_SHA256                     &quot;TLS13-AES-128-GCM-SHA256&quot;
-# define TLS1_3_TXT_AES_256_GCM_SHA384                     &quot;TLS13-AES-256-GCM-SHA384&quot;
-# define TLS1_3_TXT_CHACHA20_POLY1305_SHA256               &quot;TLS13-CHACHA20-POLY1305-SHA256&quot;
-# define TLS1_3_TXT_AES_128_CCM_SHA256                     &quot;TLS13-AES-128-CCM-SHA256&quot;
-# define TLS1_3_TXT_AES_128_CCM_8_SHA256                   &quot;TLS13-AES-128-CCM-8-SHA256&quot;
-
 # define TLS_CT_RSA_SIGN                 1
 # define TLS_CT_DSS_SIGN                 2
 # define TLS_CT_RSA_FIXED_DH             3
diff --git a/ssl/s3_lib.c b/ssl/s3_lib.c
index 8f0d3e1..f230b5f 100644
--- a/ssl/s3_lib.c
+++ b/ssl/s3_lib.c
@@ -18,6 +18,7 @@
 #include &lt;openssl/rand.h&gt;
 #include &quot;internal/cryptlib.h&quot;
 
+#define TLS13_NUM_CIPHERS       OSSL_NELEM(tls13_ciphers)
 #define SSL3_NUM_CIPHERS        OSSL_NELEM(ssl3_ciphers)
 #define SSL3_NUM_SCSVS          OSSL_NELEM(ssl3_scsvs)
 
@@ -29,6 +30,90 @@ const unsigned char tls12downgrade[] = {
     0x44, 0x4f, 0x57, 0x4e, 0x47, 0x52, 0x44, 0x01
 };
 
+/* The list of available TLSv1.3 ciphers */
+static SSL_CIPHER tls13_ciphers[] = {
+    {
+        1,
+        TLS1_3_RFC_AES_128_GCM_SHA256,
+        TLS1_3_RFC_AES_128_GCM_SHA256,
+        TLS1_3_CK_AES_128_GCM_SHA256,
+        0, 0,
+        SSL_AES128GCM,
+        SSL_AEAD,
+        TLS1_3_VERSION, TLS1_3_VERSION,
+        SSL_kANY,
+        SSL_aANY,
+        SSL_HIGH,
+        SSL_HANDSHAKE_MAC_SHA256,
+        128,
+        128,
+    }, {
+        1,
+        TLS1_3_RFC_AES_256_GCM_SHA384,
+        TLS1_3_RFC_AES_256_GCM_SHA384,
+        TLS1_3_CK_AES_256_GCM_SHA384,
+        SSL_kANY,
+        SSL_aANY,
+        SSL_AES256GCM,
+        SSL_AEAD,
+        TLS1_3_VERSION, TLS1_3_VERSION,
+        0, 0,
+        SSL_HIGH,
+        SSL_HANDSHAKE_MAC_SHA384,
+        256,
+        256,
+    },
+#if !defined(OPENSSL_NO_CHACHA) &amp;&amp; !defined(OPENSSL_NO_POLY1305)
+    {
+        1,
+        TLS1_3_RFC_CHACHA20_POLY1305_SHA256,
+        TLS1_3_RFC_CHACHA20_POLY1305_SHA256,
+        TLS1_3_CK_CHACHA20_POLY1305_SHA256,
+        SSL_kANY,
+        SSL_aANY,
+        SSL_CHACHA20POLY1305,
+        SSL_AEAD,
+        TLS1_3_VERSION, TLS1_3_VERSION,
+        0, 0,
+        SSL_HIGH,
+        SSL_HANDSHAKE_MAC_SHA256,
+        256,
+        256,
+    },
+#endif
+    {
+        1,
+        TLS1_3_RFC_AES_128_CCM_SHA256,
+        TLS1_3_RFC_AES_128_CCM_SHA256,
+        TLS1_3_CK_AES_128_CCM_SHA256,
+        SSL_kANY,
+        SSL_aANY,
+        SSL_AES128CCM,
+        SSL_AEAD,
+        TLS1_3_VERSION, TLS1_3_VERSION,
+        0, 0,
+        SSL_NOT_DEFAULT | SSL_HIGH,
+        SSL_HANDSHAKE_MAC_SHA256,
+        128,
+        128,
+    }, {
+        1,
+        TLS1_3_RFC_AES_128_CCM_8_SHA256,
+        TLS1_3_RFC_AES_128_CCM_8_SHA256,
+        TLS1_3_CK_AES_128_CCM_8_SHA256,
+        SSL_kANY,
+        SSL_aANY,
+        SSL_AES128CCM8,
+        SSL_AEAD,
+        TLS1_3_VERSION, TLS1_3_VERSION,
+        0, 0,
+        SSL_NOT_DEFAULT | SSL_HIGH,
+        SSL_HANDSHAKE_MAC_SHA256,
+        128,
+        128,
+    }
+};
+
 /*
  * The list of available ciphers, mostly organized into the following
  * groups:
@@ -860,88 +945,6 @@ static SSL_CIPHER ssl3_ciphers[] = {
      },
     {
      1,
-     TLS1_3_TXT_AES_128_GCM_SHA256,
-     TLS1_3_RFC_AES_128_GCM_SHA256,
-     TLS1_3_CK_AES_128_GCM_SHA256,
-     0, 0,
-     SSL_AES128GCM,
-     SSL_AEAD,
-     TLS1_3_VERSION, TLS1_3_VERSION,
-     SSL_kANY,
-     SSL_aANY,
-     SSL_HIGH,
-     SSL_HANDSHAKE_MAC_SHA256,
-     128,
-     128,
-     },
-    {
-     1,
-     TLS1_3_TXT_AES_256_GCM_SHA384,
-     TLS1_3_RFC_AES_256_GCM_SHA384,
-     TLS1_3_CK_AES_256_GCM_SHA384,
-     SSL_kANY,
-     SSL_aANY,
-     SSL_AES256GCM,
-     SSL_AEAD,
-     TLS1_3_VERSION, TLS1_3_VERSION,
-     0, 0,
-     SSL_HIGH,
-     SSL_HANDSHAKE_MAC_SHA384,
-     256,
-     256,
-     },
-#if !defined(OPENSSL_NO_CHACHA) &amp;&amp; !defined(OPENSSL_NO_POLY1305)
-    {
-     1,
-     TLS1_3_TXT_CHACHA20_POLY1305_SHA256,
-     TLS1_3_RFC_CHACHA20_POLY1305_SHA256,
-     TLS1_3_CK_CHACHA20_POLY1305_SHA256,
-     SSL_kANY,
-     SSL_aANY,
-     SSL_CHACHA20POLY1305,
-     SSL_AEAD,
-     TLS1_3_VERSION, TLS1_3_VERSION,
-     0, 0,
-     SSL_HIGH,
-     SSL_HANDSHAKE_MAC_SHA256,
-     256,
-     256,
-     },
-#endif
-    {
-     1,
-     TLS1_3_TXT_AES_128_CCM_SHA256,
-     TLS1_3_RFC_AES_128_CCM_SHA256,
-     TLS1_3_CK_AES_128_CCM_SHA256,
-     SSL_kANY,
-     SSL_aANY,
-     SSL_AES128CCM,
-     SSL_AEAD,
-     TLS1_3_VERSION, TLS1_3_VERSION,
-     0, 0,
-     SSL_NOT_DEFAULT | SSL_HIGH,
-     SSL_HANDSHAKE_MAC_SHA256,
-     128,
-     128,
-     },
-    {
-     1,
-     TLS1_3_TXT_AES_128_CCM_8_SHA256,
-     TLS1_3_RFC_AES_128_CCM_8_SHA256,
-     TLS1_3_CK_AES_128_CCM_8_SHA256,
-     SSL_kANY,
-     SSL_aANY,
-     SSL_AES128CCM8,
-     SSL_AEAD,
-     TLS1_3_VERSION, TLS1_3_VERSION,
-     0, 0,
-     SSL_NOT_DEFAULT | SSL_HIGH,
-     SSL_HANDSHAKE_MAC_SHA256,
-     128,
-     128,
-     },
-    {
-     1,
      TLS1_TXT_ECDHE_ECDSA_WITH_NULL_SHA,
      TLS1_RFC_ECDHE_ECDSA_WITH_NULL_SHA,
      TLS1_CK_ECDHE_ECDSA_WITH_NULL_SHA,
@@ -3207,6 +3210,8 @@ static int cipher_compare(const void *a, const void *b)
 
 void ssl_sort_cipher_list(void)
 {
+    qsort(tls13_ciphers, TLS13_NUM_CIPHERS, sizeof(tls13_ciphers[0]),
+          cipher_compare);
     qsort(ssl3_ciphers, SSL3_NUM_CIPHERS, sizeof(ssl3_ciphers[0]),
           cipher_compare);
     qsort(ssl3_scsvs, SSL3_NUM_SCSVS, sizeof(ssl3_scsvs[0]), cipher_compare);
@@ -4027,6 +4032,9 @@ const SSL_CIPHER *ssl3_get_cipher_by_id(uint32_t id)
     const SSL_CIPHER *cp;
 
     c.id = id;
+    cp = OBJ_bsearch_ssl_cipher_id(&amp;c, tls13_ciphers, TLS13_NUM_CIPHERS);
+    if (cp != NULL)
+        return cp;
     cp = OBJ_bsearch_ssl_cipher_id(&amp;c, ssl3_ciphers, SSL3_NUM_CIPHERS);
     if (cp != NULL)
         return cp;
@@ -4035,17 +4043,19 @@ const SSL_CIPHER *ssl3_get_cipher_by_id(uint32_t id)
 
 const SSL_CIPHER *ssl3_get_cipher_by_std_name(const char *stdname)
 {
-    SSL_CIPHER *c = NULL;
-    SSL_CIPHER *tbl = ssl3_ciphers;
-    size_t i;
+    SSL_CIPHER *c = NULL, *tbl;
+    SSL_CIPHER *alltabs[] = {tls13_ciphers, ssl3_ciphers};
+    size_t i, j, tblsize[] = {TLS13_NUM_CIPHERS, SSL3_NUM_CIPHERS};
 
     /* this is not efficient, necessary to optimize this? */
-    for (i = 0; i &lt; SSL3_NUM_CIPHERS; i++, tbl++) {
-        if (tbl-&gt;stdname == NULL)
-            continue;
-        if (strcmp(stdname, tbl-&gt;stdname) == 0) {
-            c = tbl;
-            break;
+    for (j = 0; j &lt; OSSL_NELEM(alltabs); j++) {
+        for (i = 0, tbl = alltabs[j]; i &lt; tblsize[j]; i++, tbl++) {
+            if (tbl-&gt;stdname == NULL)
+                continue;
+            if (strcmp(stdname, tbl-&gt;stdname) == 0) {
+                c = tbl;
+                break;
+            }
         }
     }
     if (c == NULL) {
diff --git a/ssl/ssl_ciph.c b/ssl/ssl_ciph.c
index d31aeb7..49e16fc 100644
--- a/ssl/ssl_ciph.c
+++ b/ssl/ssl_ciph.c
@@ -1274,12 +1274,14 @@ static int check_suiteb_cipher_list(const SSL_METHOD *meth, CERT *c,
 }
 #endif
 
-STACK_OF(SSL_CIPHER) *ssl_create_cipher_list(const SSL_METHOD *ssl_method, STACK_OF(SSL_CIPHER)
-                                             **cipher_list, STACK_OF(SSL_CIPHER)
-                                             **cipher_list_by_id,
-                                             const char *rule_str, CERT *c)
+STACK_OF(SSL_CIPHER) *ssl_create_cipher_list(const SSL_METHOD *ssl_method,
+                                             STACK_OF(SSL_CIPHER) *tls13_ciphersuites,
+                                             STACK_OF(SSL_CIPHER) **cipher_list,
+                                             STACK_OF(SSL_CIPHER) **cipher_list_by_id,
+                                             const char *rule_str,
+                                             CERT *c)
 {
-    int ok, num_of_ciphers, num_of_alias_max, num_of_group_aliases;
+    int ok, num_of_ciphers, num_of_alias_max, num_of_group_aliases, i;
     uint32_t disabled_mkey, disabled_auth, disabled_enc, disabled_mac;
     STACK_OF(SSL_CIPHER) *cipherstack, *tmp_cipher_list;
     const char *rule_p;
@@ -1469,6 +1471,15 @@ STACK_OF(SSL_CIPHER) *ssl_create_cipher_list(const SSL_METHOD *ssl_method, STACK
         return NULL;
     }
 
+    /* Add TLSv1.3 ciphers first - we always prefer those if possible */
+    for (i = 0; i &lt; sk_SSL_CIPHER_num(tls13_ciphersuites); i++) {
+        if (!sk_SSL_CIPHER_push(cipherstack,
+                                sk_SSL_CIPHER_value(tls13_ciphersuites, i))) {
+            sk_SSL_CIPHER_free(cipherstack);
+            return NULL;
+        }
+    }
+
     /*
      * The cipher selection for the list is done. The ciphers are added
      * to the resulting precedence to the STACK_OF(SSL_CIPHER).
diff --git a/ssl/ssl_conf.c b/ssl/ssl_conf.c
index 2c50d19..30e43d9 100644
--- a/ssl/ssl_conf.c
+++ b/ssl/ssl_conf.c
@@ -256,6 +256,7 @@ static int cmd_ECDHParameters(SSL_CONF_CTX *cctx, const char *value)
 static int cmd_CipherString(SSL_CONF_CTX *cctx, const char *value)
 {
     int rv = 1;
+
     if (cctx-&gt;ctx)
         rv = SSL_CTX_set_cipher_list(cctx-&gt;ctx, value);
     if (cctx-&gt;ssl)
@@ -263,6 +264,17 @@ static int cmd_CipherString(SSL_CONF_CTX *cctx, const char *value)
     return rv &gt; 0;
 }
 
+static int cmd_Ciphersuites(SSL_CONF_CTX *cctx, const char *value)
+{
+    int rv = 1;
+
+    if (cctx-&gt;ctx)
+        rv = SSL_CTX_set_ciphersuites(cctx-&gt;ctx, value);
+    if (cctx-&gt;ssl)
+        rv = SSL_set_ciphersuites(cctx-&gt;ssl, value);
+    return rv &gt; 0;
+}
+
 static int cmd_Protocol(SSL_CONF_CTX *cctx, const char *value)
 {
     static const ssl_flag_tbl ssl_protocol_list[] = {
@@ -606,6 +618,7 @@ static const ssl_conf_cmd_tbl ssl_conf_cmds[] = {
     SSL_CONF_CMD_STRING(ECDHParameters, &quot;named_curve&quot;, SSL_CONF_FLAG_SERVER),
 #endif
     SSL_CONF_CMD_STRING(CipherString, &quot;cipher&quot;, 0),
+    SSL_CONF_CMD_STRING(Ciphersuites, &quot;ciphersuites&quot;, 0),
     SSL_CONF_CMD_STRING(Protocol, NULL, 0),
     SSL_CONF_CMD_STRING(MinProtocol, &quot;min_protocol&quot;, 0),
     SSL_CONF_CMD_STRING(MaxProtocol, &quot;max_protocol&quot;, 0),
diff --git a/ssl/ssl_err.c b/ssl/ssl_err.c
index e367a36..64580bb 100644
--- a/ssl/ssl_err.c
+++ b/ssl/ssl_err.c
@@ -20,6 +20,7 @@ static const ERR_STRING_DATA SSL_str_functs[] = {
      &quot;bytes_to_cipher_list&quot;},
     {ERR_PACK(ERR_LIB_SSL, SSL_F_CHECK_SUITEB_CIPHER_LIST, 0),
      &quot;check_suiteb_cipher_list&quot;},
+    {ERR_PACK(ERR_LIB_SSL, SSL_F_CIPHERSUITE_CB, 0), &quot;ciphersuite_cb&quot;},
     {ERR_PACK(ERR_LIB_SSL, SSL_F_CONSTRUCT_CA_NAMES, 0), &quot;construct_ca_names&quot;},
     {ERR_PACK(ERR_LIB_SSL, SSL_F_CONSTRUCT_KEY_EXCHANGE_TBS, 0),
      &quot;construct_key_exchange_tbs&quot;},
diff --git a/ssl/ssl_lib.c b/ssl/ssl_lib.c
index 0814fb3..d5c5918 100644
--- a/ssl/ssl_lib.c
+++ b/ssl/ssl_lib.c
@@ -653,7 +653,9 @@ int SSL_CTX_set_ssl_version(SSL_CTX *ctx, const SSL_METHOD *meth)
 
     ctx-&gt;method = meth;
 
-    sk = ssl_create_cipher_list(ctx-&gt;method, &amp;(ctx-&gt;cipher_list),
+    sk = ssl_create_cipher_list(ctx-&gt;method,
+                                ctx-&gt;tls13_ciphersuites,
+                                &amp;(ctx-&gt;cipher_list),
                                 &amp;(ctx-&gt;cipher_list_by_id),
                                 SSL_DEFAULT_CIPHER_LIST, ctx-&gt;cert);
     if ((sk == NULL) || (sk_SSL_CIPHER_num(sk) &lt;= 0)) {
@@ -712,6 +714,11 @@ SSL *SSL_new(SSL_CTX *ctx)
     s-&gt;max_cert_list = ctx-&gt;max_cert_list;
     s-&gt;max_early_data = ctx-&gt;max_early_data;
 
+    /* Shallow copy of the ciphersuites stack */
+    s-&gt;tls13_ciphersuites = sk_SSL_CIPHER_dup(ctx-&gt;tls13_ciphersuites);
+    if (s-&gt;tls13_ciphersuites == NULL)
+        goto err;
+
     /*
      * Earlier library versions used to copy the pointer to the CERT, not
      * its contents; only when setting new parameters for the per-SSL
@@ -1156,6 +1163,7 @@ void SSL_free(SSL *s)
     /* add extra stuff */
     sk_SSL_CIPHER_free(s-&gt;cipher_list);
     sk_SSL_CIPHER_free(s-&gt;cipher_list_by_id);
+    sk_SSL_CIPHER_free(s-&gt;tls13_ciphersuites);
 
     /* Make the next call work :-) */
     if (s-&gt;session != NULL) {
@@ -2520,8 +2528,9 @@ int SSL_CTX_set_cipher_list(SSL_CTX *ctx, const char *str)
 {
     STACK_OF(SSL_CIPHER) *sk;
 
-    sk = ssl_create_cipher_list(ctx-&gt;method, &amp;ctx-&gt;cipher_list,
-                                &amp;ctx-&gt;cipher_list_by_id, str, ctx-&gt;cert);
+    sk = ssl_create_cipher_list(ctx-&gt;method, ctx-&gt;tls13_ciphersuites,
+                                &amp;ctx-&gt;cipher_list, &amp;ctx-&gt;cipher_list_by_id, str,
+                                ctx-&gt;cert);
     /*
      * ssl_create_cipher_list may return an empty stack if it was unable to
      * find a cipher matching the given rule string (for example if the rule
@@ -2543,8 +2552,9 @@ int SSL_set_cipher_list(SSL *s, const char *str)
 {
     STACK_OF(SSL_CIPHER) *sk;
 
-    sk = ssl_create_cipher_list(s-&gt;ctx-&gt;method, &amp;s-&gt;cipher_list,
-                                &amp;s-&gt;cipher_list_by_id, str, s-&gt;cert);
+    sk = ssl_create_cipher_list(s-&gt;ctx-&gt;method, s-&gt;tls13_ciphersuites,
+                                &amp;s-&gt;cipher_list, &amp;s-&gt;cipher_list_by_id, str,
+                                s-&gt;cert);
     /* see comment in SSL_CTX_set_cipher_list */
     if (sk == NULL)
         return 0;
@@ -2555,6 +2565,99 @@ int SSL_set_cipher_list(SSL *s, const char *str)
     return 1;
 }
 
+static int ciphersuite_cb(const char *elem, int len, void *arg)
+{
+    STACK_OF(SSL_CIPHER) *ciphersuites = (STACK_OF(SSL_CIPHER) *)arg;
+    const SSL_CIPHER *cipher;
+    /* Arbitrary sized temp buffer for the cipher name. Should be big enough */
+    char name[80];
+
+    if (len &gt; (int)(sizeof(name) - 1)) {
+        SSLerr(SSL_F_CIPHERSUITE_CB, SSL_R_NO_CIPHER_MATCH);
+        return 0;
+    }
+
+    memcpy(name, elem, len);
+    name[len] = '\0';
+
+    cipher = ssl3_get_cipher_by_std_name(name);
+    if (cipher == NULL) {
+        SSLerr(SSL_F_CIPHERSUITE_CB, SSL_R_NO_CIPHER_MATCH);
+        return 0;
+    }
+
+    if (!sk_SSL_CIPHER_push(ciphersuites, cipher)) {
+        SSLerr(SSL_F_CIPHERSUITE_CB, ERR_R_INTERNAL_ERROR);
+        return 0;
+    }
+
+    return 1;
+}
+
+static int set_ciphersuites(STACK_OF(SSL_CIPHER) **currciphers, const char *str)
+{
+    STACK_OF(SSL_CIPHER) *newciphers = sk_SSL_CIPHER_new_null();
+
+    if (newciphers == NULL)
+        return 0;
+
+    /* Parse the list. We explicitly allow an empty list */
+    if (*str != '\0'
+            &amp;&amp; !CONF_parse_list(str, ':', 1, ciphersuite_cb, newciphers)) {
+        sk_SSL_CIPHER_free(newciphers);
+        return 0;
+    }
+    sk_SSL_CIPHER_free(*currciphers);
+    *currciphers = newciphers;
+
+    return 1;
+}
+
+static int update_cipher_list(STACK_OF(SSL_CIPHER) *cipher_list,
+                              STACK_OF(SSL_CIPHER) *tls13_ciphersuites)
+{
+    int i;
+
+    /*
+     * Delete any existing TLSv1.3 ciphersuites. These are always first in the
+     * list.
+     */
+    while (sk_SSL_CIPHER_num(cipher_list) &gt; 0
+           &amp;&amp; sk_SSL_CIPHER_value(cipher_list, 0)-&gt;min_tls == TLS1_3_VERSION)
+        sk_SSL_CIPHER_delete(cipher_list, 0);
+
+    /* Insert the new TLSv1.3 ciphersuites */
+    for (i = 0; i &lt; sk_SSL_CIPHER_num(tls13_ciphersuites); i++)
+        sk_SSL_CIPHER_insert(cipher_list,
+                             sk_SSL_CIPHER_value(tls13_ciphersuites, i), i);
+
+    return 1;
+}
+
+int SSL_CTX_set_ciphersuites(SSL_CTX *ctx, const char *str)
+{
+    int ret = set_ciphersuites(&amp;(ctx-&gt;tls13_ciphersuites), str);
+
+    if (ret &amp;&amp; ctx-&gt;cipher_list != NULL) {
+        /* We already have a cipher_list, so we need to update it */
+        return update_cipher_list(ctx-&gt;cipher_list, ctx-&gt;tls13_ciphersuites);
+    }
+
+    return ret;
+}
+
+int SSL_set_ciphersuites(SSL *s, const char *str)
+{
+    int ret = set_ciphersuites(&amp;(s-&gt;tls13_ciphersuites), str);
+
+    if (ret &amp;&amp; s-&gt;cipher_list != NULL) {
+        /* We already have a cipher_list, so we need to update it */
+        return update_cipher_list(s-&gt;cipher_list, s-&gt;tls13_ciphersuites);
+    }
+
+    return ret;
+}
+
 char *SSL_get_shared_ciphers(const SSL *s, char *buf, int len)
 {
     char *p;
@@ -2915,7 +3018,12 @@ SSL_CTX *SSL_CTX_new(const SSL_METHOD *meth)
     if (ret-&gt;ctlog_store == NULL)
         goto err;
 #endif
+
+    if (!SSL_CTX_set_ciphersuites(ret, TLS_DEFAULT_CIPHERSUITES))
+        goto err;
+
     if (!ssl_create_cipher_list(ret-&gt;method,
+                                ret-&gt;tls13_ciphersuites,
                                 &amp;ret-&gt;cipher_list, &amp;ret-&gt;cipher_list_by_id,
                                 SSL_DEFAULT_CIPHER_LIST, ret-&gt;cert)
         || sk_SSL_CIPHER_num(ret-&gt;cipher_list) &lt;= 0) {
@@ -3075,6 +3183,7 @@ void SSL_CTX_free(SSL_CTX *a)
 #endif
     sk_SSL_CIPHER_free(a-&gt;cipher_list);
     sk_SSL_CIPHER_free(a-&gt;cipher_list_by_id);
+    sk_SSL_CIPHER_free(a-&gt;tls13_ciphersuites);
     ssl_cert_free(a-&gt;cert);
     sk_X509_NAME_pop_free(a-&gt;ca_names, X509_NAME_free);
     sk_X509_pop_free(a-&gt;extra_certs, X509_free);
diff --git a/ssl/ssl_locl.h b/ssl/ssl_locl.h
index 246605c..4b8482a 100644
--- a/ssl/ssl_locl.h
+++ b/ssl/ssl_locl.h
@@ -740,6 +740,8 @@ struct ssl_ctx_st {
     STACK_OF(SSL_CIPHER) *cipher_list;
     /* same as above but sorted for lookup */
     STACK_OF(SSL_CIPHER) *cipher_list_by_id;
+    /* TLSv1.3 specific ciphersuites */
+    STACK_OF(SSL_CIPHER) *tls13_ciphersuites;
     struct x509_store_st /* X509_STORE */ *cert_store;
     LHASH_OF(SSL_SESSION) *sessions;
     /*
@@ -1108,6 +1110,8 @@ struct ssl_st {
     /* crypto */
     STACK_OF(SSL_CIPHER) *cipher_list;
     STACK_OF(SSL_CIPHER) *cipher_list_by_id;
+    /* TLSv1.3 specific ciphersuites */
+    STACK_OF(SSL_CIPHER) *tls13_ciphersuites;
     /*
      * These are the ones being used, the ones in SSL_SESSION are the ones to
      * be 'copied' into these ones
@@ -2198,10 +2202,10 @@ __owur int ssl_cipher_id_cmp(const SSL_CIPHER *a, const SSL_CIPHER *b);
 DECLARE_OBJ_BSEARCH_GLOBAL_CMP_FN(SSL_CIPHER, SSL_CIPHER, ssl_cipher_id);
 __owur int ssl_cipher_ptr_id_cmp(const SSL_CIPHER *const *ap,
                                  const SSL_CIPHER *const *bp);
-__owur STACK_OF(SSL_CIPHER) *ssl_create_cipher_list(const SSL_METHOD *meth,
-                                                    STACK_OF(SSL_CIPHER) **pref,
-                                                    STACK_OF(SSL_CIPHER)
-                                                    **sorted,
+__owur STACK_OF(SSL_CIPHER) *ssl_create_cipher_list(const SSL_METHOD *ssl_method,
+                                                    STACK_OF(SSL_CIPHER) *tls13_ciphersuites,
+                                                    STACK_OF(SSL_CIPHER) **cipher_list,
+                                                    STACK_OF(SSL_CIPHER) **cipher_list_by_id,
                                                     const char *rule_str,
                                                     CERT *c);
 __owur int ssl_cache_cipherlist(SSL *s, PACKET *cipher_suites, int sslv2format);
diff --git a/test/cipherlist_test.c b/test/cipherlist_test.c
index 50e3027..b224983 100644
--- a/test/cipherlist_test.c
+++ b/test/cipherlist_test.c
@@ -63,6 +63,13 @@ static CIPHERLIST_TEST_FIXTURE *set_up(const char *const test_case_name)
  * are currently broken and should be considered mission impossible in libssl.
  */
 static const uint32_t default_ciphers_in_order[] = {
+#ifndef OPENSSL_NO_TLS1_3
+    TLS1_3_CK_AES_256_GCM_SHA384,
+# if !defined(OPENSSL_NO_CHACHA) &amp;&amp; !defined(OPENSSL_NO_POLY1305)
+    TLS1_3_CK_CHACHA20_POLY1305_SHA256,
+# endif
+    TLS1_3_CK_AES_128_GCM_SHA256,
+#endif
 #ifndef OPENSSL_NO_TLS1_2
 # ifndef OPENSSL_NO_EC
     TLS1_CK_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,
@@ -127,13 +134,6 @@ static const uint32_t default_ciphers_in_order[] = {
     TLS1_CK_RSA_WITH_AES_256_GCM_SHA384,
     TLS1_CK_RSA_WITH_AES_128_GCM_SHA256,
 #endif
-#ifndef OPENSSL_NO_TLS1_3
-    TLS1_3_CK_AES_256_GCM_SHA384,
-# if !defined(OPENSSL_NO_CHACHA) &amp;&amp; !defined(OPENSSL_NO_POLY1305)
-    TLS1_3_CK_CHACHA20_POLY1305_SHA256,
-# endif
-    TLS1_3_CK_AES_128_GCM_SHA256,
-#endif
 #ifndef OPENSSL_NO_TLS1_2
     TLS1_CK_RSA_WITH_AES_256_SHA256,
     TLS1_CK_RSA_WITH_AES_128_SHA256,
diff --git a/test/clienthellotest.c b/test/clienthellotest.c
index 5cff519..5eded83 100644
--- a/test/clienthellotest.c
+++ b/test/clienthellotest.c
@@ -97,8 +97,7 @@ static int test_client_hello(int currtest)
          * ClientHello is already going to be quite long. To avoid getting one
          * that is too long for this test we use a restricted ciphersuite list
          */
-        if (!TEST_true(SSL_CTX_set_cipher_list(ctx,
-                                               &quot;TLS13-AES-128-GCM-SHA256&quot;)))
+        if (!TEST_true(SSL_CTX_set_cipher_list(ctx, &quot;&quot;)))
             goto end;
          /* Fall through */
     case TEST_ADD_PADDING:
@@ -121,7 +120,9 @@ static int test_client_hello(int currtest)
          * not need padding.
          */
         } else if (!TEST_true(SSL_CTX_set_cipher_list(ctx,
-                              &quot;AES128-SHA:TLS13-AES-128-GCM-SHA256&quot;))) {
+                              &quot;AES128-SHA&quot;))
+                   || !TEST_true(SSL_CTX_set_ciphersuites(ctx,
+                                 &quot;TLS_AES_128_GCM_SHA256&quot;))) {
             goto end;
         }
         break;
diff --git a/test/fatalerrtest.c b/test/fatalerrtest.c
index 2335735..85b11c8 100644
--- a/test/fatalerrtest.c
+++ b/test/fatalerrtest.c
@@ -38,6 +38,10 @@ static int test_fatalerr(void)
      */
     if (!TEST_true(SSL_CTX_set_cipher_list(sctx, &quot;AES128-SHA&quot;))
             || !TEST_true(SSL_CTX_set_cipher_list(cctx, &quot;AES256-SHA&quot;))
+            || !TEST_true(SSL_CTX_set_ciphersuites(sctx,
+                                                   &quot;TLS_AES_128_GCM_SHA256&quot;))
+            || !TEST_true(SSL_CTX_set_ciphersuites(cctx,
+                                                   &quot;TLS_AES_256_GCM_SHA384&quot;))
             || !TEST_true(create_ssl_objects(sctx, cctx, &amp;sssl, &amp;cssl, NULL,
                           NULL)))
         goto err;
diff --git a/test/recipes/70-test_sslsigalgs.t b/test/recipes/70-test_sslsigalgs.t
index c1d8272..95af8a1 100644
--- a/test/recipes/70-test_sslsigalgs.t
+++ b/test/recipes/70-test_sslsigalgs.t
@@ -116,7 +116,7 @@ SKIP: {
     #        should succeed
     $proxy-&gt;clear();
     $proxy-&gt;serverflags(&quot;-no_tls1_3&quot;);
-    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA:TLS13-AES-128-GCM-SHA256&quot;);
+    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA&quot;);
     $proxy-&gt;filter(undef);
     $proxy-&gt;start();
     ok(TLSProxy::Message-&gt;success, &quot;TLSv1.3 client TLSv1.2 server&quot;);
@@ -131,7 +131,7 @@ SKIP: {
     $proxy-&gt;clear();
     $testtype = NO_SIG_ALGS_EXT;
     $proxy-&gt;clientflags(&quot;-no_tls1_3&quot;);
-    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA:TLS13-AES-128-GCM-SHA256&quot;);
+    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA&quot;);
     $proxy-&gt;start();
     ok(TLSProxy::Message-&gt;success, &quot;No TLSv1.2 sigalgs&quot;);
 
@@ -139,7 +139,7 @@ SKIP: {
     $proxy-&gt;clear();
     $testtype = EMPTY_SIG_ALGS_EXT;
     $proxy-&gt;clientflags(&quot;-no_tls1_3&quot;);
-    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA:TLS13-AES-128-GCM-SHA256&quot;);
+    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA&quot;);
     $proxy-&gt;start();
     ok(TLSProxy::Message-&gt;fail, &quot;Empty TLSv1.2 sigalgs&quot;);
 
@@ -147,7 +147,7 @@ SKIP: {
     $proxy-&gt;clear();
     $testtype = NO_KNOWN_SIG_ALGS;
     $proxy-&gt;clientflags(&quot;-no_tls1_3&quot;);
-    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA:TLS13-AES-128-GCM-SHA256&quot;);
+    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA&quot;);
     $proxy-&gt;start();
     ok(TLSProxy::Message-&gt;fail, &quot;No known TLSv1.3 sigalgs&quot;);
 
@@ -156,7 +156,7 @@ SKIP: {
     $proxy-&gt;clear();
     $testtype = NO_PSS_SIG_ALGS;
     $proxy-&gt;clientflags(&quot;-no_tls1_3&quot;);
-    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA:TLS13-AES-128-GCM-SHA256&quot;);
+    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA&quot;);
     $proxy-&gt;start();
     ok(TLSProxy::Message-&gt;success, &quot;No PSS TLSv1.2 sigalgs&quot;);
 
@@ -164,7 +164,7 @@ SKIP: {
     $proxy-&gt;clear();
     $testtype = PSS_ONLY_SIG_ALGS;
     $proxy-&gt;serverflags(&quot;-no_tls1_3&quot;);
-    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA:TLS13-AES-128-GCM-SHA256&quot;);
+    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA&quot;);
     $proxy-&gt;start();
     ok(TLSProxy::Message-&gt;success, &quot;PSS only sigalgs in TLSv1.2&quot;);
 
@@ -175,7 +175,7 @@ SKIP: {
     $proxy-&gt;clear();
     $testtype = PSS_ONLY_SIG_ALGS;
     $proxy-&gt;clientflags(&quot;-no_tls1_3 -sigalgs RSA+SHA256&quot;);
-    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA:TLS13-AES-128-GCM-SHA256&quot;);
+    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA&quot;);
     $proxy-&gt;start();
     ok(TLSProxy::Message-&gt;fail, &quot;Sigalg we did not send in TLSv1.2&quot;);
 
@@ -183,7 +183,7 @@ SKIP: {
     #         matches the certificate should fail in TLSv1.2
     $proxy-&gt;clear();
     $proxy-&gt;clientflags(&quot;-no_tls1_3 -sigalgs ECDSA+SHA256&quot;);
-    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA:TLS13-AES-128-GCM-SHA256&quot;);
+    $proxy-&gt;ciphers(&quot;ECDHE-RSA-AES128-SHA&quot;);
     $proxy-&gt;filter(undef);
     $proxy-&gt;start();
     ok(TLSProxy::Message-&gt;fail, &quot;No matching TLSv1.2 sigalgs&quot;);
@@ -197,7 +197,7 @@ SKIP: {
                                                &quot;server-ecdsa-cert.pem&quot;) .
                         &quot; -key &quot; . srctop_file(&quot;test&quot;, &quot;certs&quot;,
                                                &quot;server-ecdsa-key.pem&quot;)),
-    $proxy-&gt;ciphers(&quot;ECDHE-ECDSA-AES128-SHA:TLS13-AES-128-GCM-SHA256&quot;);
+    $proxy-&gt;ciphers(&quot;ECDHE-ECDSA-AES128-SHA&quot;);
     $proxy-&gt;start();
     ok(TLSProxy::Message-&gt;success, &quot;No TLSv1.2 sigalgs, ECDSA&quot;);
 }
diff --git a/test/recipes/70-test_tls13hrr.t b/test/recipes/70-test_tls13hrr.t
index 56b7faf..e0b47ed 100644
--- a/test/recipes/70-test_tls13hrr.t
+++ b/test/recipes/70-test_tls13hrr.t
@@ -53,7 +53,7 @@ ok(TLSProxy::Message-&gt;fail(), &quot;Server ciphersuite changes&quot;);
 #        we end up selecting a different ciphersuite between HRR and the SH
 $proxy-&gt;clear();
 $proxy-&gt;serverflags(&quot;-curves P-256&quot;);
-$proxy-&gt;ciphers(&quot;TLS13-AES-128-GCM-SHA256:TLS13-AES-256-GCM-SHA384&quot;);
+$proxy-&gt;ciphersuitess(&quot;TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384&quot;);
 $testtype = CHANGE_CH1_CIPHERSUITE;
 $proxy-&gt;start();
 ok(TLSProxy::Message-&gt;fail(), &quot;Client ciphersuite changes&quot;);
@@ -85,8 +85,7 @@ sub hrr_filter
 
     my $ch1 = ${$proxy-&gt;message_list}[0];
 
-    # The server prefers TLS13-AES-256-GCM-SHA384 so it will pick that next
-    # time around
+    # The server will always pick TLS_AES_256_GCM_SHA384
     my @ciphersuites = (TLSProxy::Message::CIPHER_TLS13_AES_128_GCM_SHA256);
     $ch1-&gt;ciphersuite_len(2 * scalar @ciphersuites);
     $ch1-&gt;ciphersuites(\@ciphersuites);
diff --git a/test/recipes/70-test_tls13psk.t b/test/recipes/70-test_tls13psk.t
index bd2508d..fa30dd1 100644
--- a/test/recipes/70-test_tls13psk.t
+++ b/test/recipes/70-test_tls13psk.t
@@ -82,10 +82,10 @@ $proxy-&gt;clear();
 $proxy-&gt;clientflags(&quot;-sess_in &quot;.$session);
 $proxy-&gt;filter(\&amp;modify_psk_filter);
 $proxy-&gt;serverflags(&quot;-curves P-256&quot;);
-$proxy-&gt;cipherc(&quot;TLS13-AES-128-GCM-SHA256:TLS13-AES-256-GCM-SHA384&quot;);
-$proxy-&gt;ciphers(&quot;TLS13-AES-256-GCM-SHA384&quot;);
+$proxy-&gt;ciphersuitesc(&quot;TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384&quot;);
+$proxy-&gt;ciphersuitess(&quot;TLS_AES_256_GCM_SHA384&quot;);
 #We force an early failure because TLS Proxy doesn't actually support
-#TLS13-AES-256-GCM-SHA384. That doesn't matter for this test though.
+#TLS_AES_256_GCM_SHA384. That doesn't matter for this test though.
 $testtype = ILLEGAL_EXT_SECOND_CH;
 $proxy-&gt;start();
 #Check if the PSK is present in the second ClientHello
diff --git a/test/recipes/80-test_ssl_old.t b/test/recipes/80-test_ssl_old.t
index f89779c..377bf09 100644
--- a/test/recipes/80-test_ssl_old.t
+++ b/test/recipes/80-test_ssl_old.t
@@ -432,9 +432,12 @@ sub testssl {
             if $protocolciphersuitecount + scalar(keys %ciphersuites) == 0;
 
         # The count of protocols is because in addition to the ciphersuites
-        # we got above, we're running a weak DH test for each protocol
-        plan tests =&gt; scalar(@protocols) + $protocolciphersuitecount
-            + scalar(keys %ciphersuites);
+        # we got above, we're running a weak DH test for each protocol (except
+        # TLSv1.3)
+        my $testcount = scalar(@protocols) + $protocolciphersuitecount
+                        + scalar(keys %ciphersuites);
+        $testcount-- unless $no_tls1_3;
+        plan tests =&gt; $testcount;
 
         foreach my $protocol (@protocols) {
             ok($ciphersstatus{$protocol}, &quot;Getting ciphers for $protocol&quot;);
@@ -445,21 +448,27 @@ sub testssl {
             # ssltest_old doesn't know -tls1_3, but that's fine, since that's
             # the default choice if TLSv1.3 enabled
             my $flag = $protocol eq &quot;-tls1_3&quot; ? &quot;&quot; : $protocol;
+            my $ciphersuites = &quot;&quot;;
             foreach my $cipher (@{$ciphersuites{$protocol}}) {
                 if ($protocol eq &quot;-ssl3&quot; &amp;&amp; $cipher =~ /ECDH/ ) {
                     note &quot;*****SKIPPING $protocol $cipher&quot;;
                     ok(1);
                 } else {
+                    if ($protocol eq &quot;-tls1_3&quot;) {
+                        $ciphersuites = $cipher;
+                        $cipher = &quot;&quot;;
+                    }
                     ok(run(test([@ssltest, @exkeys, &quot;-cipher&quot;, $cipher,
-                                 $flag || ()])),
-                    &quot;Testing $cipher&quot;);
+                                 &quot;-ciphersuites&quot;, $ciphersuites, $flag || ()])),
+                       &quot;Testing $cipher&quot;);
                 }
             }
+            next if $protocol eq &quot;-tls1_3&quot;;
             is(run(test([@ssltest,
                          &quot;-s_cipher&quot;, &quot;EDH&quot;,
                          &quot;-c_cipher&quot;, 'EDH:@SECLEVEL=1',
                          &quot;-dhe512&quot;,
-                         $protocol eq &quot;SSLv3&quot; ? (&quot;-ssl3&quot;) : ()])), 0,
+                         $protocol])), 0,
                &quot;testing connection with weak DH, expecting failure&quot;);
         }
     };
diff --git a/test/ssl-tests/02-protocol-version.conf b/test/ssl-tests/02-protocol-version.conf
index d0a64cd..4b7d7df 100644
--- a/test/ssl-tests/02-protocol-version.conf
+++ b/test/ssl-tests/02-protocol-version.conf
@@ -18787,6 +18787,7 @@ PrivateKey = ${ENV::TEST_CERTS_DIR}/serverkey.pem
 
 [676-ciphersuite-sanity-check-client-client]
 CipherString = AES128-SHA
+Ciphersuites = 
 VerifyCAFile = ${ENV::TEST_CERTS_DIR}/rootcert.pem
 VerifyMode = Peer
 
@@ -18806,6 +18807,7 @@ client = 677-ciphersuite-sanity-check-server-client
 [677-ciphersuite-sanity-check-server-server]
 Certificate = ${ENV::TEST_CERTS_DIR}/servercert.pem
 CipherString = AES128-SHA
+Ciphersuites = 
 PrivateKey = ${ENV::TEST_CERTS_DIR}/serverkey.pem
 
 [677-ciphersuite-sanity-check-server-client]
diff --git a/test/ssl-tests/protocol_version.pm b/test/ssl-tests/protocol_version.pm
index edc0dd2..2cdc5db 100644
--- a/test/ssl-tests/protocol_version.pm
+++ b/test/ssl-tests/protocol_version.pm
@@ -137,6 +137,7 @@ sub generate_version_tests {
         &quot;client&quot; =&gt; {
             #Offering only &lt;=TLSv1.2 ciphersuites with TLSv1.3 should fail
             &quot;CipherString&quot; =&gt; &quot;AES128-SHA&quot;,
+            &quot;Ciphersuites&quot; =&gt; &quot;&quot;,
         },
         &quot;server&quot; =&gt; {
             &quot;MaxProtocol&quot; =&gt; &quot;TLSv1.2&quot;
@@ -154,6 +155,7 @@ sub generate_version_tests {
         &quot;server&quot; =&gt; {
             #Allowing only &lt;=TLSv1.2 ciphersuites with TLSv1.3 should fail
             &quot;CipherString&quot; =&gt; &quot;AES128-SHA&quot;,
+            &quot;Ciphersuites&quot; =&gt; &quot;&quot;,
         },
         &quot;test&quot; =&gt; {
             &quot;ExpectedResult&quot; =&gt; &quot;ServerFail&quot;,
diff --git a/test/sslapitest.c b/test/sslapitest.c
index 32f60e5..2c122be 100644
--- a/test/sslapitest.c
+++ b/test/sslapitest.c
@@ -2381,8 +2381,8 @@ static int test_ciphersuite_change(void)
     if (!TEST_true(create_ssl_ctx_pair(TLS_server_method(),
                                        TLS_client_method(), &amp;sctx,
                                        &amp;cctx, cert, privkey))
-            || !TEST_true(SSL_CTX_set_cipher_list(cctx,
-                                                  &quot;TLS13-AES-128-GCM-SHA256&quot;))
+            || !TEST_true(SSL_CTX_set_ciphersuites(cctx,
+                                                   &quot;TLS_AES_128_GCM_SHA256&quot;))
             || !TEST_true(create_ssl_objects(sctx, cctx, &amp;serverssl,
                                           &amp;clientssl, NULL, NULL))
             || !TEST_true(create_ssl_connection(serverssl, clientssl,
@@ -2400,8 +2400,8 @@ static int test_ciphersuite_change(void)
 
 # if !defined(OPENSSL_NO_CHACHA) &amp;&amp; !defined(OPENSSL_NO_POLY1305)
     /* Check we can resume a session with a different SHA-256 ciphersuite */
-    if (!TEST_true(SSL_CTX_set_cipher_list(cctx,
-                                           &quot;TLS13-CHACHA20-POLY1305-SHA256&quot;))
+    if (!TEST_true(SSL_CTX_set_ciphersuites(cctx,
+                                            &quot;TLS_CHACHA20_POLY1305_SHA256&quot;))
             || !TEST_true(create_ssl_objects(sctx, cctx, &amp;serverssl, &amp;clientssl,
                                              NULL, NULL))
             || !TEST_true(SSL_set_session(clientssl, clntsess))
@@ -2423,7 +2423,7 @@ static int test_ciphersuite_change(void)
      * Check attempting to resume a SHA-256 session with no SHA-256 ciphersuites
      * succeeds but does not resume.
      */
-    if (!TEST_true(SSL_CTX_set_cipher_list(cctx, &quot;TLS13-AES-256-GCM-SHA384&quot;))
+    if (!TEST_true(SSL_CTX_set_ciphersuites(cctx, &quot;TLS_AES_256_GCM_SHA384&quot;))
             || !TEST_true(create_ssl_objects(sctx, cctx, &amp;serverssl, &amp;clientssl,
                                              NULL, NULL))
             || !TEST_true(SSL_set_session(clientssl, clntsess))
@@ -2441,7 +2441,7 @@ static int test_ciphersuite_change(void)
     serverssl = clientssl = NULL;
 
     /* Create a session based on SHA384 */
-    if (!TEST_true(SSL_CTX_set_cipher_list(cctx, &quot;TLS13-AES-256-GCM-SHA384&quot;))
+    if (!TEST_true(SSL_CTX_set_ciphersuites(cctx, &quot;TLS_AES_256_GCM_SHA384&quot;))
             || !TEST_true(create_ssl_objects(sctx, cctx, &amp;serverssl,
                                           &amp;clientssl, NULL, NULL))
             || !TEST_true(create_ssl_connection(serverssl, clientssl,
@@ -2455,10 +2455,10 @@ static int test_ciphersuite_change(void)
     SSL_free(clientssl);
     serverssl = clientssl = NULL;
 
-    if (!TEST_true(SSL_CTX_set_cipher_list(cctx,
-                   &quot;TLS13-AES-128-GCM-SHA256:TLS13-AES-256-GCM-SHA384&quot;))
-            || !TEST_true(SSL_CTX_set_cipher_list(sctx,
-                                                  &quot;TLS13-AES-256-GCM-SHA384&quot;))
+    if (!TEST_true(SSL_CTX_set_ciphersuites(cctx,
+                   &quot;TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384&quot;))
+            || !TEST_true(SSL_CTX_set_ciphersuites(sctx,
+                                                   &quot;TLS_AES_256_GCM_SHA384&quot;))
             || !TEST_true(create_ssl_objects(sctx, cctx, &amp;serverssl, &amp;clientssl,
                                              NULL, NULL))
             || !TEST_true(SSL_set_session(clientssl, clntsess))
@@ -2520,7 +2520,7 @@ static int test_tls13_psk(int idx)
      * We use a ciphersuite with SHA256 to ease testing old style PSK callbacks
      * which will always default to SHA256
      */
-    if (!TEST_true(SSL_CTX_set_cipher_list(cctx, &quot;TLS13-AES-128-GCM-SHA256&quot;)))
+    if (!TEST_true(SSL_CTX_set_ciphersuites(cctx, &quot;TLS_AES_128_GCM_SHA256&quot;)))
         goto end;
 
     /*
diff --git a/test/sslcorrupttest.c b/test/sslcorrupttest.c
index a0bca38..1923100 100644
--- a/test/sslcorrupttest.c
+++ b/test/sslcorrupttest.c
@@ -202,19 +202,17 @@ static int test_ssl_corrupt(int testidx)
         goto end;
 
     if (!TEST_ptr(ciphers = SSL_CTX_get_ciphers(cctx))
+            || !TEST_true(SSL_CTX_set_ciphersuites(cctx, &quot;&quot;))
             || !TEST_int_eq(sk_SSL_CIPHER_num(ciphers), 1)
             || !TEST_ptr(currcipher = sk_SSL_CIPHER_value(ciphers, 0)))
         goto end;
 
     /*
-     * If we haven't got a TLSv1.3 cipher, then we mustn't attempt to use
-     * TLSv1.3. Version negotiation happens before cipher selection, so we will
-     * get a &quot;no shared cipher&quot; error.
+     * No ciphers we are using are TLSv1.3 compatible so we should not attempt
+     * to negotiate TLSv1.3
      */
-    if (strcmp(SSL_CIPHER_get_version(currcipher), &quot;TLSv1.3&quot;) != 0) {
-        if (!TEST_true(SSL_CTX_set_max_proto_version(cctx, TLS1_2_VERSION)))
-            goto end;
-    }
+    if (!TEST_true(SSL_CTX_set_max_proto_version(cctx, TLS1_2_VERSION)))
+        goto end;
 
     if (!TEST_ptr(c_to_s_fbio = BIO_new(bio_f_tls_corrupt_filter())))
         goto end;
diff --git a/test/ssltest_old.c b/test/ssltest_old.c
index 349d30a..7d31d36 100644
--- a/test/ssltest_old.c
+++ b/test/ssltest_old.c
@@ -612,6 +612,7 @@ static int custom_ext_3_srv_add_cb(SSL *s, unsigned int ext_type,
 }
 
 static char *cipher = NULL;
+static char *ciphersuites = NULL;
 static int verbose = 0;
 static int debug = 0;
 
@@ -671,7 +672,8 @@ static void sv_usage(void)
     fprintf(stderr, &quot; -c_cert arg   - Client certificate file\n&quot;);
     fprintf(stderr,
             &quot; -c_key arg    - Client key file (default: same as -c_cert)\n&quot;);
-    fprintf(stderr, &quot; -cipher arg   - The cipher list\n&quot;);
+    fprintf(stderr, &quot; -cipher arg   - The TLSv1.2 and below cipher list\n&quot;);
+    fprintf(stderr, &quot; -ciphersuites arg   - The TLSv1.3 ciphersuites\n&quot;);
     fprintf(stderr, &quot; -bio_pair     - Use BIO pairs\n&quot;);
     fprintf(stderr, &quot; -ipv4         - Use IPv4 connection on localhost\n&quot;);
     fprintf(stderr, &quot; -ipv6         - Use IPv6 connection on localhost\n&quot;);
@@ -918,7 +920,6 @@ int main(int argc, char *argv[])
 
     verbose = 0;
     debug = 0;
-    cipher = 0;
 
     bio_err = BIO_new_fp(stderr, BIO_NOCLOSE | BIO_FP_TEXT);
 
@@ -1046,6 +1047,10 @@ int main(int argc, char *argv[])
             if (--argc &lt; 1)
                 goto bad;
             cipher = *(++argv);
+        } else if (strcmp(*argv, &quot;-ciphersuites&quot;) == 0) {
+            if (--argc &lt; 1)
+                goto bad;
+            ciphersuites = *(++argv);
         } else if (strcmp(*argv, &quot;-CApath&quot;) == 0) {
             if (--argc &lt; 1)
                 goto bad;
@@ -1377,6 +1382,14 @@ int main(int argc, char *argv[])
             goto end;
         }
     }
+    if (ciphersuites != NULL) {
+        if (!SSL_CTX_set_ciphersuites(c_ctx, ciphersuites)
+            || !SSL_CTX_set_ciphersuites(s_ctx, ciphersuites)
+            || !SSL_CTX_set_ciphersuites(s_ctx2, ciphersuites)) {
+            ERR_print_errors(bio_err);
+            goto end;
+        }
+    }
 
 #ifndef OPENSSL_NO_CT
     if (ct_validation &amp;&amp;
diff --git a/util/libssl.num b/util/libssl.num
index db844e3..344d684 100644
--- a/util/libssl.num
+++ b/util/libssl.num
@@ -484,3 +484,5 @@ SSL_SESSION_set1_ticket_appdata         484	1_1_1	EXIST::FUNCTION:
 SSL_CTX_set_session_ticket_cb           485	1_1_1	EXIST::FUNCTION:
 SSL_CTX_set_stateless_cookie_generate_cb 486	1_1_1	EXIST::FUNCTION:
 SSL_CTX_set_stateless_cookie_verify_cb  487	1_1_1	EXIST::FUNCTION:
+SSL_CTX_set_ciphersuites                488	1_1_1	EXIST::FUNCTION:
+SSL_set_ciphersuites                    489	1_1_1	EXIST::FUNCTION:
diff --git a/util/perl/TLSProxy/Proxy.pm b/util/perl/TLSProxy/Proxy.pm
index 0b722c1..db7b19c 100644
--- a/util/perl/TLSProxy/Proxy.pm
+++ b/util/perl/TLSProxy/Proxy.pm
@@ -58,7 +58,9 @@ sub new
         cert =&gt; $cert,
         debug =&gt; $debug,
         cipherc =&gt; &quot;&quot;,
-        ciphers =&gt; &quot;AES128-SHA:TLS13-AES-128-GCM-SHA256&quot;,
+        ciphersuitesc =&gt; &quot;&quot;,
+        ciphers =&gt; &quot;AES128-SHA&quot;,
+        ciphersuitess =&gt; &quot;TLS_AES_128_GCM_SHA256&quot;,
         flight =&gt; 0,
         record_list =&gt; [],
         message_list =&gt; [],
@@ -135,6 +137,7 @@ sub clearClient
     my $self = shift;
 
     $self-&gt;{cipherc} = &quot;&quot;;
+    $self-&gt;{ciphersuitec} = &quot;&quot;;
     $self-&gt;{flight} = 0;
     $self-&gt;{record_list} = [];
     $self-&gt;{message_list} = [];
@@ -153,7 +156,8 @@ sub clear
     my $self = shift;
 
     $self-&gt;clearClient;
-    $self-&gt;{ciphers} = &quot;AES128-SHA:TLS13-AES-128-GCM-SHA256&quot;;
+    $self-&gt;{ciphers} = &quot;AES128-SHA&quot;;
+    $self-&gt;{ciphersuitess} = &quot;TLS_AES_128_GCM_SHA256&quot;;
     $self-&gt;{serverflags} = &quot;&quot;;
     $self-&gt;{serverconnects} = 1;
     $self-&gt;{serverpid} = 0;
@@ -198,6 +202,9 @@ sub start
         if ($self-&gt;ciphers ne &quot;&quot;) {
             $execcmd .= &quot; -cipher &quot;.$self-&gt;ciphers;
         }
+        if ($self-&gt;ciphersuitess ne &quot;&quot;) {
+            $execcmd .= &quot; -ciphersuites &quot;.$self-&gt;ciphersuitess;
+        }
         if ($self-&gt;serverflags ne &quot;&quot;) {
             $execcmd .= &quot; &quot;.$self-&gt;serverflags;
         }
@@ -234,6 +241,9 @@ sub clientstart
             if ($self-&gt;cipherc ne &quot;&quot;) {
                 $execcmd .= &quot; -cipher &quot;.$self-&gt;cipherc;
             }
+            if ($self-&gt;ciphersuitesc ne &quot;&quot;) {
+                $execcmd .= &quot; -ciphersuites &quot;.$self-&gt;ciphersuitesc;
+            }
             if ($self-&gt;clientflags ne &quot;&quot;) {
                 $execcmd .= &quot; &quot;.$self-&gt;clientflags;
             }
@@ -487,6 +497,14 @@ sub cipherc
     }
     return $self-&gt;{cipherc};
 }
+sub ciphersuitesc
+{
+    my $self = shift;
+    if (@_) {
+        $self-&gt;{ciphersuitesc} = shift;
+    }
+    return $self-&gt;{ciphersuitesc};
+}
 sub ciphers
 {
     my $self = shift;
@@ -495,6 +513,14 @@ sub ciphers
     }
     return $self-&gt;{ciphers};
 }
+sub ciphersuitess
+{
+    my $self = shift;
+    if (@_) {
+        $self-&gt;{ciphersuitess} = shift;
+    }
+    return $self-&gt;{ciphersuitess};
+}
 sub serverflags
 {
     my $self = shift;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018529.html">[openssl-commits] [openssl]  master update
</A></li>
	<LI>Next message: <A HREF="018534.html">[openssl-commits] [openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18531">[ date ]</a>
              <a href="thread.html#18531">[ thread ]</a>
              <a href="subject.html#18531">[ subject ]</a>
              <a href="author.html#18531">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
