<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2020-June/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1591171060.417278.10412.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029058.html">
   <LINK REL="Next"  HREF="029068.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl]  master update</H1>
    <B>tmraz at fedoraproject.org</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1591171060.417278.10412.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl]  master update">tmraz at fedoraproject.org
       </A><BR>
    <I>Wed Jun  3 07:57:40 UTC 2020</I>
    <P><UL>
        <LI>Previous message: <A HREF="029058.html">[openssl]  master update
</A></li>
        <LI>Next message: <A HREF="029068.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29064">[ date ]</a>
              <a href="thread.html#29064">[ thread ]</a>
              <a href="subject.html#29064">[ subject ]</a>
              <a href="author.html#29064">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  2b584ff372b2b25bb6801172bbeb90074b26f88c (commit)
       via  4e6e57cfcdd75b827ff7171927d87e95b5b86ae8 (commit)
      from  5c01a133ecafc5ffa4ae55effd32f4f1fb642293 (commit)


- Log -----------------------------------------------------------------
commit 2b584ff372b2b25bb6801172bbeb90074b26f88c
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at akamai.com</A>&gt;
Date:   Mon Apr 27 12:57:01 2020 -0400

    Update manpage to fix examples, other minor tweaks
    
    Reviewed-by: Matthias St. Pierre &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">Matthias.St.Pierre at ncp-e.com</A>&gt;
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tmraz at fedoraproject.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/11347">https://github.com/openssl/openssl/pull/11347</A>)

commit 4e6e57cfcdd75b827ff7171927d87e95b5b86ae8
Author: Rich Salz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">rsalz at akamai.com</A>&gt;
Date:   Wed Mar 4 14:08:31 2020 -0500

    Cleanup cert config files for tests
    
    Merge test/P[12]ss.cnf into one config file
    Merge CAss.cnf and Uss.cnf into ca-and-certs.cnf
    Remove Netscape cert extensions, add keyUsage comment from some cnf files
    
    Reviewed-by: Matthias St. Pierre &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">Matthias.St.Pierre at ncp-e.com</A>&gt;
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tmraz at fedoraproject.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/11347">https://github.com/openssl/openssl/pull/11347</A>)

-----------------------------------------------------------------------

Summary of changes:
 apps/openssl-vms.cnf                | 53 ----------------------
 apps/openssl.cnf                    | 53 ----------------------
 demos/certs/apps/apps.cnf           |  6 ---
 demos/certs/ca.cnf                  |  6 ---
 doc/man7/proxy-certificates.pod     | 36 +++++++--------
 test/CAss.cnf                       | 69 ----------------------------
 test/P1ss.cnf                       | 31 -------------
 test/P2ss.cnf                       | 39 ----------------
 test/Uss.cnf                        | 36 ---------------
 test/ca-and-certs.cnf               | 90 +++++++++++++++++++++++++++++++++++++
 test/proxy.cnf                      | 61 +++++++++++++++++++++++++
 test/recipes/25-test_verify_store.t | 31 ++++++-------
 test/recipes/80-test_ca.t           | 23 +++++-----
 test/recipes/80-test_ssl_old.t      | 36 +++++++--------
 test/recipes/90-test_store.t        |  5 ++-
 15 files changed, 213 insertions(+), 362 deletions(-)
 delete mode 100644 test/CAss.cnf
 delete mode 100644 test/P1ss.cnf
 delete mode 100644 test/P2ss.cnf
 delete mode 100644 test/Uss.cnf
 create mode 100644 test/ca-and-certs.cnf
 create mode 100644 test/proxy.cnf

diff --git a/apps/openssl-vms.cnf b/apps/openssl-vms.cnf
index c7e7abe994..2420e9c9f5 100644
--- a/apps/openssl-vms.cnf
+++ b/apps/openssl-vms.cnf
@@ -171,27 +171,9 @@ unstructuredName		= An optional company name
 
 basicConstraints=CA:FALSE
 
-# Here are some examples of the usage of nsCertType. If it is omitted
-# the certificate can be used for anything *except* object signing.
-
-# This is OK for an SSL server.
-# nsCertType			= server
-
-# For an object signing certificate this would be used.
-# nsCertType = objsign
-
-# For normal client use this is typical
-# nsCertType = client, email
-
-# and for everything including object signing:
-# nsCertType = client, email, objsign
-
 # This is typical in keyUsage for a client certificate.
 # keyUsage = nonRepudiation, digitalSignature, keyEncipherment
 
-# This will be displayed in Netscape's comment listbox.
-nsComment			= &quot;OpenSSL Generated Certificate&quot;
-
 # PKIX recommendations harmless if included in all certificates.
 subjectKeyIdentifier=hash
 authorityKeyIdentifier=keyid,issuer
@@ -206,13 +188,6 @@ authorityKeyIdentifier=keyid,issuer
 # Copy subject details
 # issuerAltName=issuer:copy
 
-#nsCaRevocationUrl		= <A HREF="http://www.domain.dom/ca-crl.pem">http://www.domain.dom/ca-crl.pem</A>
-#nsBaseUrl
-#nsRevocationUrl
-#nsRenewalUrl
-#nsCaPolicyUrl
-#nsSslServerName
-
 # This is required for TSA certificates.
 # extendedKeyUsage = critical,timeStamping
 
@@ -242,9 +217,6 @@ basicConstraints = critical,CA:true
 # left out by default.
 # keyUsage = cRLSign, keyCertSign
 
-# Some might want this also
-# nsCertType = sslCA, emailCA
-
 # Include email address in subject alt name: another PKIX recommendation
 # subjectAltName=email:copy
 # Copy issuer details
@@ -272,27 +244,9 @@ authorityKeyIdentifier=keyid:always
 
 basicConstraints=CA:FALSE
 
-# Here are some examples of the usage of nsCertType. If it is omitted
-# the certificate can be used for anything *except* object signing.
-
-# This is OK for an SSL server.
-# nsCertType			= server
-
-# For an object signing certificate this would be used.
-# nsCertType = objsign
-
-# For normal client use this is typical
-# nsCertType = client, email
-
-# and for everything including object signing:
-# nsCertType = client, email, objsign
-
 # This is typical in keyUsage for a client certificate.
 # keyUsage = nonRepudiation, digitalSignature, keyEncipherment
 
-# This will be displayed in Netscape's comment listbox.
-nsComment			= &quot;OpenSSL Generated Certificate&quot;
-
 # PKIX recommendations harmless if included in all certificates.
 subjectKeyIdentifier=hash
 authorityKeyIdentifier=keyid,issuer
@@ -307,13 +261,6 @@ authorityKeyIdentifier=keyid,issuer
 # Copy subject details
 # issuerAltName=issuer:copy
 
-#nsCaRevocationUrl		= <A HREF="http://www.domain.dom/ca-crl.pem">http://www.domain.dom/ca-crl.pem</A>
-#nsBaseUrl
-#nsRevocationUrl
-#nsRenewalUrl
-#nsCaPolicyUrl
-#nsSslServerName
-
 # This really needs to be in place for it to be a proxy certificate.
 proxyCertInfo=critical,language:id-ppl-anyLanguage,pathlen:3,policy:foo
 
diff --git a/apps/openssl.cnf b/apps/openssl.cnf
index 52706ae166..4fd5286d2e 100644
--- a/apps/openssl.cnf
+++ b/apps/openssl.cnf
@@ -171,27 +171,9 @@ unstructuredName		= An optional company name
 
 basicConstraints=CA:FALSE
 
-# Here are some examples of the usage of nsCertType. If it is omitted
-# the certificate can be used for anything *except* object signing.
-
-# This is OK for an SSL server.
-# nsCertType			= server
-
-# For an object signing certificate this would be used.
-# nsCertType = objsign
-
-# For normal client use this is typical
-# nsCertType = client, email
-
-# and for everything including object signing:
-# nsCertType = client, email, objsign
-
 # This is typical in keyUsage for a client certificate.
 # keyUsage = nonRepudiation, digitalSignature, keyEncipherment
 
-# This will be displayed in Netscape's comment listbox.
-nsComment			= &quot;OpenSSL Generated Certificate&quot;
-
 # PKIX recommendations harmless if included in all certificates.
 subjectKeyIdentifier=hash
 authorityKeyIdentifier=keyid,issuer
@@ -206,13 +188,6 @@ authorityKeyIdentifier=keyid,issuer
 # Copy subject details
 # issuerAltName=issuer:copy
 
-#nsCaRevocationUrl		= <A HREF="http://www.domain.dom/ca-crl.pem">http://www.domain.dom/ca-crl.pem</A>
-#nsBaseUrl
-#nsRevocationUrl
-#nsRenewalUrl
-#nsCaPolicyUrl
-#nsSslServerName
-
 # This is required for TSA certificates.
 # extendedKeyUsage = critical,timeStamping
 
@@ -242,9 +217,6 @@ basicConstraints = critical,CA:true
 # left out by default.
 # keyUsage = cRLSign, keyCertSign
 
-# Some might want this also
-# nsCertType = sslCA, emailCA
-
 # Include email address in subject alt name: another PKIX recommendation
 # subjectAltName=email:copy
 # Copy issuer details
@@ -272,27 +244,9 @@ authorityKeyIdentifier=keyid:always
 
 basicConstraints=CA:FALSE
 
-# Here are some examples of the usage of nsCertType. If it is omitted
-# the certificate can be used for anything *except* object signing.
-
-# This is OK for an SSL server.
-# nsCertType			= server
-
-# For an object signing certificate this would be used.
-# nsCertType = objsign
-
-# For normal client use this is typical
-# nsCertType = client, email
-
-# and for everything including object signing:
-# nsCertType = client, email, objsign
-
 # This is typical in keyUsage for a client certificate.
 # keyUsage = nonRepudiation, digitalSignature, keyEncipherment
 
-# This will be displayed in Netscape's comment listbox.
-nsComment			= &quot;OpenSSL Generated Certificate&quot;
-
 # PKIX recommendations harmless if included in all certificates.
 subjectKeyIdentifier=hash
 authorityKeyIdentifier=keyid,issuer
@@ -307,13 +261,6 @@ authorityKeyIdentifier=keyid,issuer
 # Copy subject details
 # issuerAltName=issuer:copy
 
-#nsCaRevocationUrl		= <A HREF="http://www.domain.dom/ca-crl.pem">http://www.domain.dom/ca-crl.pem</A>
-#nsBaseUrl
-#nsRevocationUrl
-#nsRenewalUrl
-#nsCaPolicyUrl
-#nsSslServerName
-
 # This really needs to be in place for it to be a proxy certificate.
 proxyCertInfo=critical,language:id-ppl-anyLanguage,pathlen:3,policy:foo
 
diff --git a/demos/certs/apps/apps.cnf b/demos/certs/apps/apps.cnf
index bd762b7ddc..07a3d10b55 100644
--- a/demos/certs/apps/apps.cnf
+++ b/demos/certs/apps/apps.cnf
@@ -35,9 +35,6 @@ commonName			= $ENV::CN
 basicConstraints=critical, CA:FALSE
 keyUsage=critical, nonRepudiation, digitalSignature, keyEncipherment
 
-# This will be displayed in Netscape's comment listbox.
-nsComment			= &quot;OpenSSL Generated Certificate&quot;
-
 [ ec_cert ]
 
 # These extensions are added when 'ca' signs a request for an end entity
@@ -46,9 +43,6 @@ nsComment			= &quot;OpenSSL Generated Certificate&quot;
 basicConstraints=critical, CA:FALSE
 keyUsage=critical, nonRepudiation, digitalSignature, keyAgreement
 
-# This will be displayed in Netscape's comment listbox.
-nsComment			= &quot;OpenSSL Generated Certificate&quot;
-
 # PKIX recommendations harmless if included in all certificates.
 subjectKeyIdentifier=hash
 authorityKeyIdentifier=keyid
diff --git a/demos/certs/ca.cnf b/demos/certs/ca.cnf
index c75a71a6aa..2fbf20490b 100644
--- a/demos/certs/ca.cnf
+++ b/demos/certs/ca.cnf
@@ -35,9 +35,6 @@ commonName			= $ENV::CN
 basicConstraints=critical, CA:FALSE
 keyUsage=critical, nonRepudiation, digitalSignature, keyEncipherment
 
-# This will be displayed in Netscape's comment listbox.
-nsComment			= &quot;OpenSSL Generated Certificate&quot;
-
 # PKIX recommendations harmless if included in all certificates.
 subjectKeyIdentifier=hash
 authorityKeyIdentifier=keyid
@@ -47,9 +44,6 @@ authorityKeyIdentifier=keyid
 basicConstraints=critical, CA:FALSE
 keyUsage=critical, nonRepudiation, digitalSignature, keyEncipherment
 
-# This will be displayed in Netscape's comment listbox.
-nsComment			= &quot;OpenSSL Generated Certificate&quot;
-
 # PKIX recommendations harmless if included in all certificates.
 subjectKeyIdentifier=hash
 authorityKeyIdentifier=keyid
diff --git a/doc/man7/proxy-certificates.pod b/doc/man7/proxy-certificates.pod
index df5ee1b4b5..eab28b5658 100644
--- a/doc/man7/proxy-certificates.pod
+++ b/doc/man7/proxy-certificates.pod
@@ -57,24 +57,22 @@ See L&lt;/NOTES&gt; for a discussion on this requirement.
 Creating proxy certificates can be done using the L&lt;openssl-x509(1)&gt;
 command, with some extra extensions:
 
-    [ v3_proxy ]
+    [ proxy ]
     # A proxy certificate MUST NEVER be a CA certificate.
-    basicConstraints=CA:FALSE
-
+    basicConstraints = CA:FALSE
     # Usual authority key ID
-    authorityKeyIdentifier=keyid,issuer:always
-
+    authorityKeyIdentifier = keyid,issuer:always
     # The extension which marks this certificate as a proxy
-    proxyCertInfo=critical,language:id-ppl-anyLanguage,pathlen:1,policy:text:AB
+    proxyCertInfo = critical,language:id-ppl-anyLanguage,pathlen:1,policy:text:AB
 
 It's also possible to specify the proxy extension in a separate section:
 
-    proxyCertInfo=<A HREF="../../../mailman/listinfo/openssl-commits.html">critical, at proxy_ext</A>
+    proxyCertInfo = <A HREF="../../../mailman/listinfo/openssl-commits.html">critical, at proxy_ext</A>
 
     [ proxy_ext ]
-    language=id-ppl-anyLanguage
-    pathlen=0
-    policy=text:BC
+    language = id-ppl-anyLanguage
+    pathlen = 0
+    policy = text:BC
 
 The policy value has a specific syntax, I&lt;syntag&gt;:I&lt;string&gt;, where the
 I&lt;syntag&gt; determines what will be done with the string.  The following
@@ -99,12 +97,12 @@ colons between each byte (every second hex digit):
 
 indicates that the text of the policy should be taken from a file.
 The string is then a filename.  This is useful for policies that are
-large (more than a few lines, e.g. XML documents).
+more than a few lines, such as XML or other markup.
 
 =back
 
-I&lt;NOTE: The proxy policy value is what determines the rights granted
-to the process during the proxy certificate.  It's up to the
+Note that the proxy policy value is what determines the rights granted
+to the process during the proxy certificate, and it is up to the
 application to interpret and combine these policies.&gt;
 
 With a proxy extension, creating a proxy certificate is a matter of
@@ -112,23 +110,23 @@ two commands:
 
     openssl req -new -config proxy.cnf \
         -out proxy.req -keyout proxy.key \
-        -subj &quot;/DC=org/DC=openssl/DC=users/CN=proxy 1&quot;
+        -subj &quot;/DC=org/DC=openssl/DC=users/CN=proxy&quot;
 
     openssl x509 -req -CAcreateserial -in proxy.req -out proxy.crt \
         -CA user.crt -CAkey user.key -days 7 \
-        -extfile proxy.cnf -extensions v3_proxy1
+        -extfile proxy.cnf -extensions proxy
 
 You can also create a proxy certificate using another proxy
-certificate as issuer (note: using a different configuration
-section for the proxy extensions):
+certificate as issuer. Note that this example uses a different
+configuration section for the proxy extensions:
 
     openssl req -new -config proxy.cnf \
         -out proxy2.req -keyout proxy2.key \
-        -subj &quot;/DC=org/DC=openssl/DC=users/CN=proxy 1/CN=proxy 2&quot;
+        -subj &quot;/DC=org/DC=openssl/DC=users/CN=proxy/CN=proxy 2&quot;
 
     openssl x509 -req -CAcreateserial -in proxy2.req -out proxy2.crt \
         -CA proxy.crt -CAkey proxy.key -days 7 \
-        -extfile proxy.cnf -extensions v3_proxy2
+        -extfile proxy.cnf -extensions proxy_2
 
 =head2 Using proxy certs in applications
 
diff --git a/test/CAss.cnf b/test/CAss.cnf
deleted file mode 100644
index d63f85628b..0000000000
--- a/test/CAss.cnf
+++ /dev/null
@@ -1,69 +0,0 @@
-
-####################################################################
-[ req ]
-default_bits		= 2048
-default_keyfile 	= keySS.pem
-distinguished_name	= req_distinguished_name
-encrypt_rsa_key		= no
-default_md		= sha1
-
-[ req_distinguished_name ]
-countryName			= Country Name (2 letter code)
-countryName_default		= AU
-countryName_value		= AU
-
-organizationName		= Organization Name (eg, company)
-organizationName_value		= Dodgy Brothers
-
-commonName			= Common Name (eg, YOUR name)
-commonName_value		= Dodgy CA
-
-####################################################################
-[ ca ]
-default_ca	= CA_default		# The default ca section
-
-####################################################################
-[ CA_default ]
-
-dir		= ./demoCA		# Where everything is kept
-certs		= $dir/certs		# Where the issued certs are kept
-crl_dir		= $dir/crl		# Where the issued crl are kept
-database	= $dir/index.txt	# database index file.
-#unique_subject	= no			# Set to 'no' to allow creation of
-					# several certificates with same subject.
-new_certs_dir	= $dir/newcerts		# default place for new certs.
-
-certificate	= $dir/cacert.pem 	# The CA certificate
-serial		= $dir/serial 		# The current serial number
-crl		= $dir/crl.pem 		# The current CRL
-private_key	= $dir/private/cakey.pem# The private key
-
-x509_extensions	= v3_ca			# The extensions to add to the cert
-
-name_opt 	= ca_default		# Subject Name options
-cert_opt 	= ca_default		# Certificate field options
-
-default_days	= 365			# how long to certify for
-default_crl_days= 30			# how long before next CRL
-default_md	= md5			# which md to use.
-preserve	= no			# keep passed DN ordering
-
-policy		= policy_anything
-
-[ policy_anything ]
-countryName		= optional
-stateOrProvinceName	= optional
-localityName		= optional
-organizationName	= optional
-organizationalUnitName	= optional
-commonName		= supplied
-emailAddress		= optional
-
-
-
-[ v3_ca ]
-subjectKeyIdentifier=hash
-authorityKeyIdentifier=keyid:always,issuer:always
-basicConstraints = critical,CA:true,pathlen:1
-keyUsage = cRLSign, keyCertSign
-issuerAltName=issuer:copy
diff --git a/test/P1ss.cnf b/test/P1ss.cnf
deleted file mode 100644
index 69baaaf849..0000000000
--- a/test/P1ss.cnf
+++ /dev/null
@@ -1,31 +0,0 @@
-
-####################################################################
-[ req ]
-default_bits		= 2048
-default_keyfile 	= keySS.pem
-distinguished_name	= req_distinguished_name
-encrypt_rsa_key		= no
-default_md		= sha256
-
-[ req_distinguished_name ]
-countryName			= Country Name (2 letter code)
-countryName_default		= AU
-countryName_value		= AU
-
-organizationName                = Organization Name (eg, company)
-organizationName_value          = Dodgy Brothers
-
-0.commonName			= Common Name (eg, YOUR name)
-0.commonName_value		= Brother 1
-
-1.commonName			= Common Name (eg, YOUR name)
-1.commonName_value		= Brother 2
-
-2.commonName			= Common Name (eg, YOUR name)
-2.commonName_value		= Proxy 1
-
-[ v3_proxy ]
-basicConstraints=CA:FALSE
-subjectKeyIdentifier=hash
-authorityKeyIdentifier=keyid,issuer:always
-proxyCertInfo=critical,language:id-ppl-anyLanguage,pathlen:1,policy:text:AB
diff --git a/test/P2ss.cnf b/test/P2ss.cnf
deleted file mode 100644
index 8d4f3c8a68..0000000000
--- a/test/P2ss.cnf
+++ /dev/null
@@ -1,39 +0,0 @@
-
-####################################################################
-[ req ]
-default_bits		= 2048
-default_keyfile 	= keySS.pem
-distinguished_name	= req_distinguished_name
-encrypt_rsa_key		= no
-default_md		= sha256
-
-[ req_distinguished_name ]
-countryName			= Country Name (2 letter code)
-countryName_default		= AU
-countryName_value		= AU
-
-organizationName                = Organization Name (eg, company)
-organizationName_value          = Dodgy Brothers
-
-0.commonName			= Common Name (eg, YOUR name)
-0.commonName_value		= Brother 1
-
-1.commonName			= Common Name (eg, YOUR name)
-1.commonName_value		= Brother 2
-
-2.commonName			= Common Name (eg, YOUR name)
-2.commonName_value		= Proxy 1
-
-3.commonName			= Common Name (eg, YOUR name)
-3.commonName_value		= Proxy 2
-
-[ v3_proxy ]
-basicConstraints=CA:FALSE
-subjectKeyIdentifier=hash
-authorityKeyIdentifier=keyid,issuer:always
-proxyCertInfo=<A HREF="../../../mailman/listinfo/openssl-commits.html">critical, at proxy_ext</A>
-
-[ proxy_ext ]
-language=id-ppl-anyLanguage
-pathlen=0
-policy=text:BC
diff --git a/test/Uss.cnf b/test/Uss.cnf
deleted file mode 100644
index 95ffb67deb..0000000000
--- a/test/Uss.cnf
+++ /dev/null
@@ -1,36 +0,0 @@
-
-CN2 = Brother 2
-
-####################################################################
-[ req ]
-default_bits		= 2048
-default_keyfile 	= keySS.pem
-distinguished_name	= req_distinguished_name
-encrypt_rsa_key		= no
-default_md		    = sha256
-prompt              = no
-
-[ req_distinguished_name ]
-countryName         = AU
-organizationName    = Dodgy Brothers
-0.commonName        = Brother 1
-1.commonName		= $ENV::CN2
-
-[ v3_ee ]
-subjectKeyIdentifier=hash
-authorityKeyIdentifier=keyid,issuer:always
-basicConstraints = CA:false
-keyUsage = nonRepudiation, digitalSignature, keyEncipherment
-
-[ v3_ee_dsa ]
-subjectKeyIdentifier=hash
-authorityKeyIdentifier=keyid:always
-basicConstraints = CA:false
-keyUsage = nonRepudiation, digitalSignature
-
-[ v3_ee_ec ]
-subjectKeyIdentifier=hash
-authorityKeyIdentifier=keyid:always
-basicConstraints = CA:false
-keyUsage = nonRepudiation, digitalSignature, keyAgreement
-
diff --git a/test/ca-and-certs.cnf b/test/ca-and-certs.cnf
new file mode 100644
index 0000000000..598db2b6a0
--- /dev/null
+++ b/test/ca-and-certs.cnf
@@ -0,0 +1,90 @@
+
+CN2 = Brother 2
+
+####################################################################
+[ req ]
+default_bits		= 2048
+default_keyfile 	= keySS.pem
+distinguished_name	= req_distinguished_name
+encrypt_rsa_key		= no
+default_md		= sha1
+
+[ req_distinguished_name ]
+countryName			= Country Name (2 letter code)
+countryName_value		= AU
+organizationName		= Organization Name (eg, company)
+organizationName_value		= Dodgy Brothers
+commonName			= Common Name (eg, YOUR name)
+commonName_value		= Dodgy CA
+
+####################################################################
+[ userreq ]
+default_bits		= 2048
+default_keyfile 	= keySS.pem
+distinguished_name	= user_dn
+encrypt_rsa_key		= no
+default_md		= sha256
+prompt			= no
+
+[ user_dn ]
+countryName		= AU
+organizationName	= Dodgy Brothers
+0.commonName		= Brother 1
+1.commonName		= $ENV::CN2
+
+[ v3_ee ]
+subjectKeyIdentifier	= hash
+authorityKeyIdentifier	= keyid,issuer:always
+basicConstraints 	= CA:false
+keyUsage		= nonRepudiation, digitalSignature, keyEncipherment
+
+[ v3_ee_dsa ]
+subjectKeyIdentifier	= hash
+authorityKeyIdentifier	= keyid:always
+basicConstraints	= CA:false
+keyUsage		= nonRepudiation, digitalSignature
+
+[ v3_ee_ec ]
+subjectKeyIdentifier	= hash
+authorityKeyIdentifier	= keyid:always
+basicConstraints	= CA:false
+keyUsage		= nonRepudiation, digitalSignature, keyAgreement
+
+####################################################################
+[ ca ]
+default_ca	= CA_default
+
+[ CA_default ]
+dir		= ./demoCA
+certs		= $dir/certs
+crl_dir		= $dir/crl
+database	= $dir/index.txt
+new_certs_dir	= $dir/newcerts
+certificate	= $dir/cacert.pem
+serial		= $dir/serial
+crl		= $dir/crl.pem
+private_key	= $dir/private/cakey.pem
+x509_extensions	= v3_ca
+name_opt 	= ca_default
+cert_opt 	= ca_default
+default_days	= 365
+default_crl_days= 30
+default_md	= sha1
+preserve	= no
+policy		= policy_anything
+
+[ policy_anything ]
+countryName		= optional
+stateOrProvinceName	= optional
+localityName		= optional
+organizationName	= optional
+organizationalUnitName	= optional
+commonName		= supplied
+emailAddress		= optional
+
+[ v3_ca ]
+subjectKeyIdentifier	= hash
+authorityKeyIdentifier	= keyid:always,issuer:always
+basicConstraints 	= critical,CA:true,pathlen:1
+keyUsage		= cRLSign, keyCertSign
+issuerAltName		= issuer:copy
diff --git a/test/proxy.cnf b/test/proxy.cnf
new file mode 100644
index 0000000000..e6b60542bb
--- /dev/null
+++ b/test/proxy.cnf
@@ -0,0 +1,61 @@
+
+## Config file for proxy certificate testing.
+
+[ req ]
+default_bits		= 2048
+default_keyfile 	= keySS.pem
+distinguished_name	= req_distinguished_name_p1
+encrypt_rsa_key		= no
+default_md		= sha256
+
+[ req_distinguished_name_p1 ]
+countryName			= Country Name (2 letter code)
+countryName_value		= AU
+organizationName                = Organization Name (eg, company)
+organizationName_value          = Dodgy Brothers
+0.commonName			= Common Name (eg, YOUR name)
+0.commonName_value		= Brother 1
+1.commonName			= Common Name (eg, YOUR name)
+1.commonName_value		= Brother 2
+2.commonName			= Common Name (eg, YOUR name)
+2.commonName_value		= Proxy 1
+
+[ proxy ]
+basicConstraints	= CA:FALSE
+subjectKeyIdentifier	= hash
+authorityKeyIdentifier	= keyid,issuer:always
+proxyCertInfo	= critical,language:id-ppl-anyLanguage,pathlen:1,policy:text:AB
+
+####################################################################
+
+[ proxy2_req ]
+default_bits		= 2048
+default_keyfile 	= keySS.pem
+distinguished_name	= req_distinguished_name_p2
+encrypt_rsa_key		= no
+default_md		= sha256
+
+[ req_distinguished_name_p2 ]
+countryName			= Country Name (2 letter code)
+countryName_value		= AU
+organizationName                = Organization Name (eg, company)
+organizationName_value          = Dodgy Brothers
+0.commonName			= Common Name (eg, YOUR name)
+0.commonName_value		= Brother 1
+1.commonName			= Common Name (eg, YOUR name)
+1.commonName_value		= Brother 2
+2.commonName			= Common Name (eg, YOUR name)
+2.commonName_value		= Proxy 1
+3.commonName			= Common Name (eg, YOUR name)
+3.commonName_value		= Proxy 2
+
+[ proxy_2 ]
+basicConstraints	= CA:FALSE
+subjectKeyIdentifier	= hash
+authorityKeyIdentifier	= keyid,issuer:always
+proxyCertInfo		= <A HREF="../../../mailman/listinfo/openssl-commits.html">critical, at proxy_ext</A>
+
+[ proxy_ext ]
+language	= id-ppl-anyLanguage
+pathlen		= 0
+policy		= text:BC
diff --git a/test/recipes/25-test_verify_store.t b/test/recipes/25-test_verify_store.t
index c8c57a7b2b..2afb8cb56f 100644
--- a/test/recipes/25-test_verify_store.t
+++ b/test/recipes/25-test_verify_store.t
@@ -18,34 +18,31 @@ plan tests =&gt; 10;
 
 my $dummycnf = srctop_file(&quot;apps&quot;, &quot;openssl.cnf&quot;);
 
+my $cnf = srctop_file(&quot;test&quot;, &quot;ca-and-certs.cnf&quot;);
 my $CAkey = &quot;keyCA.ss&quot;;
 my $CAcert=&quot;certCA.ss&quot;;
 my $CAserial=&quot;certCA.srl&quot;;
 my $CAreq=&quot;reqCA.ss&quot;;
-my $CAconf=srctop_file(&quot;test&quot;,&quot;CAss.cnf&quot;);
 my $CAreq2=&quot;req2CA.ss&quot;;	# temp
-
-my $Uconf=srctop_file(&quot;test&quot;,&quot;Uss.cnf&quot;);
 my $Ukey=&quot;keyU.ss&quot;;
 my $Ureq=&quot;reqU.ss&quot;;
 my $Ucert=&quot;certU.ss&quot;;
 
 SKIP: {
     req( 'make cert request',
-         qw(-new),
-         -config       =&gt; $CAconf,
+         qw(-new -section userreq),
+         -config       =&gt; $cnf,
          -out          =&gt; $CAreq,
          -keyout       =&gt; $CAkey );
 
     skip 'failure', 8 unless
         x509( 'convert request into self-signed cert',
-              qw(-req -CAcreateserial),
+              qw(-req -CAcreateserial -days 30),
+              qw(-extensions v3_ca),
               -in       =&gt; $CAreq,
               -out      =&gt; $CAcert,
               -signkey  =&gt; $CAkey,
-              -days     =&gt; 30,
-              -extfile  =&gt; $CAconf,
-              -extensions =&gt; 'v3_ca' );
+              -extfile  =&gt; $cnf );
 
     skip 'failure', 7 unless
         x509( 'convert cert into a cert request',
@@ -56,13 +53,13 @@ SKIP: {
 
     skip 'failure', 6 unless
         req( 'verify request 1',
-             qw(-verify -noout),
+             qw(-verify -noout -section userreq),
              -config    =&gt; $dummycnf,
              -in        =&gt; $CAreq );
 
     skip 'failure', 5 unless
         req( 'verify request 2',
-             qw(-verify -noout),
+             qw(-verify -noout -section userreq),
              -config    =&gt; $dummycnf,
              -in        =&gt; $CAreq2 );
 
@@ -73,29 +70,27 @@ SKIP: {
 
     skip 'failure', 3 unless
         req( 'make a user cert request',
-             qw(-new),
-             -config  =&gt; $Uconf,
+             qw(-new -section userreq),
+             -config  =&gt; $cnf,
              -out     =&gt; $Ureq,
              -keyout  =&gt; $Ukey );
 
     skip 'failure', 2 unless
         x509( 'sign user cert request',
-              qw(-req -CAcreateserial),
+              qw(-req -CAcreateserial -days 30 -extensions v3_ee),
               -in     =&gt; $Ureq,
               -out    =&gt; $Ucert,
               -CA     =&gt; $CAcert,
               -CAkey  =&gt; $CAkey,
               -CAserial =&gt; $CAserial,
-              -days   =&gt; 30,
-              -extfile =&gt; $Uconf,
-              -extensions =&gt; 'v3_ee' )
+              -extfile =&gt; $cnf )
         &amp;&amp; verify( undef,
                    -CAstore =&gt; $CAcert,
                    $Ucert );
 
     skip 'failure', 0 unless
         x509( 'Certificate details',
-              qw( -subject -issuer -startdate -enddate -noout),
+              qw(-subject -issuer -startdate -enddate -noout),
               -in     =&gt; $Ucert );
 }
 
diff --git a/test/recipes/80-test_ca.t b/test/recipes/80-test_ca.t
index 3d4dfcd060..bbb0af7577 100644
--- a/test/recipes/80-test_ca.t
+++ b/test/recipes/80-test_ca.t
@@ -18,26 +18,29 @@ use OpenSSL::Test::Utils;
 setup(&quot;test_ca&quot;);
 
 $ENV{OPENSSL} = cmdstr(app([&quot;openssl&quot;]), display =&gt; 1);
-my $std_openssl_cnf =
-    srctop_file(&quot;apps&quot;, $^O eq &quot;VMS&quot; ? &quot;openssl-vms.cnf&quot; : &quot;openssl.cnf&quot;);
+
+my $cnf = '&quot;' . srctop_file(&quot;test&quot;,&quot;ca-and-certs.cnf&quot;) . '&quot;';;
+my $std_openssl_cnf = '&quot;'
+    . srctop_file(&quot;apps&quot;, $^O eq &quot;VMS&quot; ? &quot;openssl-vms.cnf&quot; : &quot;openssl.cnf&quot;)
+    . '&quot;';
 
 rmtree(&quot;demoCA&quot;, { safe =&gt; 0 });
 
 plan tests =&gt; 6;
  SKIP: {
-     $ENV{OPENSSL_CONFIG} = '-config &quot;'.srctop_file(&quot;test&quot;, &quot;CAss.cnf&quot;).'&quot;';
+     $ENV{OPENSSL_CONFIG} = '-config ' . $cnf;
      skip &quot;failed creating CA structure&quot;, 4
 	 if !ok(run(perlapp([&quot;CA.pl&quot;,&quot;-newca&quot;], stdin =&gt; undef)),
 		'creating CA structure');
 
-     $ENV{OPENSSL_CONFIG} = '-config &quot;'.srctop_file(&quot;test&quot;, &quot;Uss.cnf&quot;).'&quot;';
+     $ENV{OPENSSL_CONFIG} = '-config ' . $cnf;
      skip &quot;failed creating new certificate request&quot;, 3
 	 if !ok(run(perlapp([&quot;CA.pl&quot;,&quot;-newreq&quot;,
-                             &quot;-extra-req&quot;,&quot;-outform DER&quot;])),
+                             '-extra-req', '-outform DER -section userreq'])),
 		'creating certificate request');
-     $ENV{OPENSSL_CONFIG} = '-rand_serial -inform DER -config &quot;'.$std_openssl_cnf.'&quot;';
+     $ENV{OPENSSL_CONFIG} = '-rand_serial -inform DER -config '.$std_openssl_cnf;
      skip &quot;failed to sign certificate request&quot;, 2
-	 if !is(yes(cmdstr(perlapp([&quot;CA.pl&quot;, &quot;-sign&quot;, &quot;-extra-ca&quot;]))), 0,
+	 if !is(yes(cmdstr(perlapp([&quot;CA.pl&quot;, &quot;-sign&quot;]))), 0,
 		'signing certificate request');
 
      ok(run(perlapp([&quot;CA.pl&quot;, &quot;-verify&quot;, &quot;newcert.pem&quot;])),
@@ -46,8 +49,8 @@ plan tests =&gt; 6;
      skip &quot;CT not configured, can't use -precert&quot;, 1
          if disabled(&quot;ct&quot;);
 
-     $ENV{OPENSSL_CONFIG} = '-config &quot;'.srctop_file(&quot;test&quot;, &quot;Uss.cnf&quot;).'&quot;';
-     ok(run(perlapp([&quot;CA.pl&quot;, &quot;-precert&quot;], stderr =&gt; undef)),
+     $ENV{OPENSSL_CONFIG} = '-config ' . $cnf;
+     ok(run(perlapp([&quot;CA.pl&quot;, &quot;-precert&quot;, '-extra-req', '-section userreq'], stderr =&gt; undef)),
         'creating new pre-certificate');
 }
 
@@ -56,7 +59,7 @@ SKIP: {
 	      if disabled(&quot;sm2&quot;);
 
     is(yes(cmdstr(app([&quot;openssl&quot;, &quot;ca&quot;, &quot;-config&quot;,
-                       srctop_file(&quot;test&quot;, &quot;CAss.cnf&quot;),
+                       $cnf,
                        &quot;-in&quot;, srctop_file(&quot;test&quot;, &quot;certs&quot;, &quot;sm2-csr.pem&quot;),
                        &quot;-out&quot;, &quot;sm2-test.crt&quot;,
                        &quot;-sigopt&quot;, &quot;distid:1234567812345678&quot;,
diff --git a/test/recipes/80-test_ssl_old.t b/test/recipes/80-test_ssl_old.t
index e01137d593..85f71614c4 100644
--- a/test/recipes/80-test_ssl_old.t
+++ b/test/recipes/80-test_ssl_old.t
@@ -44,33 +44,27 @@ my @verifycmd = (&quot;openssl&quot;, &quot;verify&quot;);
 my @genpkeycmd = (&quot;openssl&quot;, &quot;genpkey&quot;);
 my $dummycnf = srctop_file(&quot;apps&quot;, &quot;openssl.cnf&quot;);
 
+my $cnf = srctop_file(&quot;test&quot;, &quot;ca-and-certs.cnf&quot;);
 my $CAkey = &quot;keyCA.ss&quot;;
 my $CAcert=&quot;certCA.ss&quot;;
 my $CAserial=&quot;certCA.srl&quot;;
 my $CAreq=&quot;reqCA.ss&quot;;
-my $CAconf=srctop_file(&quot;test&quot;,&quot;CAss.cnf&quot;);
 my $CAreq2=&quot;req2CA.ss&quot;;	# temp
-
-my $Uconf=srctop_file(&quot;test&quot;,&quot;Uss.cnf&quot;);
 my $Ukey=&quot;keyU.ss&quot;;
 my $Ureq=&quot;reqU.ss&quot;;
 my $Ucert=&quot;certU.ss&quot;;
-
 my $Dkey=&quot;keyD.ss&quot;;
 my $Dreq=&quot;reqD.ss&quot;;
 my $Dcert=&quot;certD.ss&quot;;
-
 my $Ekey=&quot;keyE.ss&quot;;
 my $Ereq=&quot;reqE.ss&quot;;
 my $Ecert=&quot;certE.ss&quot;;
 
-my $P1conf=srctop_file(&quot;test&quot;,&quot;P1ss.cnf&quot;);
+my $proxycnf=srctop_file(&quot;test&quot;, &quot;proxy.cnf&quot;);
 my $P1key=&quot;keyP1.ss&quot;;
 my $P1req=&quot;reqP1.ss&quot;;
 my $P1cert=&quot;certP1.ss&quot;;
 my $P1intermediate=&quot;tmp_intP1.ss&quot;;
-
-my $P2conf=srctop_file(&quot;test&quot;,&quot;P2ss.cnf&quot;);
 my $P2key=&quot;keyP2.ss&quot;;
 my $P2req=&quot;reqP2.ss&quot;;
 my $P2cert=&quot;certP2.ss&quot;;
@@ -133,7 +127,7 @@ sub testss {
 
   SKIP: {
       skip 'failure', 16 unless
-	  ok(run(app([@reqcmd, &quot;-config&quot;, $CAconf,
+	  ok(run(app([@reqcmd, &quot;-config&quot;, $cnf,
 		      &quot;-out&quot;, $CAreq, &quot;-keyout&quot;, $CAkey,
 		      @req_new])),
 	     'make cert request');
@@ -141,7 +135,7 @@ sub testss {
       skip 'failure', 15 unless
 	  ok(run(app([@x509cmd, &quot;-CAcreateserial&quot;, &quot;-in&quot;, $CAreq, &quot;-days&quot;, &quot;30&quot;,
 		      &quot;-req&quot;, &quot;-out&quot;, $CAcert, &quot;-signkey&quot;, $CAkey,
-		      &quot;-extfile&quot;, $CAconf, &quot;-extensions&quot;, &quot;v3_ca&quot;],
+		      &quot;-extfile&quot;, $cnf, &quot;-extensions&quot;, &quot;v3_ca&quot;],
 		     stdout =&gt; &quot;err.ss&quot;)),
 	     'convert request into self-signed cert');
 
@@ -167,7 +161,7 @@ sub testss {
 	     'verify signature');
 
       skip 'failure', 10 unless
-	  ok(run(app([@reqcmd, &quot;-config&quot;, $Uconf,
+	  ok(run(app([@reqcmd, &quot;-config&quot;, $cnf, &quot;-section&quot;, &quot;userreq&quot;,
 		      &quot;-out&quot;, $Ureq, &quot;-keyout&quot;, $Ukey, @req_new],
 		     stdout =&gt; &quot;err.ss&quot;)),
 	     'make a user cert request');
@@ -176,7 +170,7 @@ sub testss {
 	  ok(run(app([@x509cmd, &quot;-CAcreateserial&quot;, &quot;-in&quot;, $Ureq, &quot;-days&quot;, &quot;30&quot;,
 		      &quot;-req&quot;, &quot;-out&quot;, $Ucert,
 		      &quot;-CA&quot;, $CAcert, &quot;-CAkey&quot;, $CAkey, &quot;-CAserial&quot;, $CAserial,
-		      &quot;-extfile&quot;, $Uconf, &quot;-extensions&quot;, &quot;v3_ee&quot;],
+		      &quot;-extfile&quot;, $cnf, &quot;-extensions&quot;, &quot;v3_ee&quot;],
 		     stdout =&gt; &quot;err.ss&quot;))
 	     &amp;&amp; run(app([@verifycmd, &quot;-CAfile&quot;, $CAcert, $Ucert])),
 	     'sign user cert request');
@@ -202,7 +196,8 @@ sub testss {
                                stdout =&gt; &quot;err.ss&quot;)),
                        &quot;make a DSA key&quot;);
                 skip 'failure', 3 unless
-                    ok(run(app([@reqcmd, &quot;-new&quot;, &quot;-config&quot;, $Uconf,
+                    ok(run(app([@reqcmd, &quot;-new&quot;, &quot;-config&quot;, $cnf,
+                                &quot;-section&quot;, &quot;userreq&quot;,
                                 &quot;-out&quot;, $Dreq, &quot;-key&quot;, $Dkey],
                                stdout =&gt; &quot;err.ss&quot;)),
                        &quot;make a DSA user cert request&quot;);
@@ -214,7 +209,7 @@ sub testss {
                                 &quot;-out&quot;, $Dcert,
                                 &quot;-CA&quot;, $CAcert, &quot;-CAkey&quot;, $CAkey,
                                 &quot;-CAserial&quot;, $CAserial,
-                                &quot;-extfile&quot;, $Uconf,
+                                &quot;-extfile&quot;, $cnf,
                                 &quot;-extensions&quot;, &quot;v3_ee_dsa&quot;],
                                stdout =&gt; &quot;err.ss&quot;)),
                        &quot;sign DSA user cert request&quot;);
@@ -247,7 +242,8 @@ sub testss {
                                 &quot;-out&quot;, &quot;ecp.ss&quot;])),
                        &quot;make EC parameters&quot;);
                 skip 'failure', 3 unless
-                    ok(run(app([@reqcmd, &quot;-config&quot;, $Uconf,
+                    ok(run(app([@reqcmd, &quot;-config&quot;, $cnf,
+                                &quot;-section&quot;, &quot;userreq&quot;,
                                 &quot;-out&quot;, $Ereq, &quot;-keyout&quot;, $Ekey,
                                 &quot;-newkey&quot;, &quot;ec:ecp.ss&quot;],
                                stdout =&gt; &quot;err.ss&quot;)),
@@ -260,7 +256,7 @@ sub testss {
                                 &quot;-out&quot;, $Ecert,
                                 &quot;-CA&quot;, $CAcert, &quot;-CAkey&quot;, $CAkey,
                                 &quot;-CAserial&quot;, $CAserial,
-                                &quot;-extfile&quot;, $Uconf,
+                                &quot;-extfile&quot;, $cnf,
                                 &quot;-extensions&quot;, &quot;v3_ee_ec&quot;],
                                stdout =&gt; &quot;err.ss&quot;)),
                        &quot;sign ECDSA/ECDH user cert request&quot;);
@@ -277,7 +273,7 @@ sub testss {
       };
 
       skip 'failure', 5 unless
-	  ok(run(app([@reqcmd, &quot;-config&quot;, $P1conf,
+	  ok(run(app([@reqcmd, &quot;-config&quot;, $proxycnf,
 		      &quot;-out&quot;, $P1req, &quot;-keyout&quot;, $P1key, @req_new],
 		     stdout =&gt; &quot;err.ss&quot;)),
 	     'make a proxy cert request');
@@ -287,7 +283,7 @@ sub testss {
 	  ok(run(app([@x509cmd, &quot;-CAcreateserial&quot;, &quot;-in&quot;, $P1req, &quot;-days&quot;, &quot;30&quot;,
 		      &quot;-req&quot;, &quot;-out&quot;, $P1cert,
 		      &quot;-CA&quot;, $Ucert, &quot;-CAkey&quot;, $Ukey,
-		      &quot;-extfile&quot;, $P1conf, &quot;-extensions&quot;, &quot;v3_proxy&quot;],
+		      &quot;-extfile&quot;, $proxycnf, &quot;-extensions&quot;, &quot;proxy&quot;],
 		     stdout =&gt; &quot;err.ss&quot;)),
 	     'sign proxy with user cert');
 
@@ -300,7 +296,7 @@ sub testss {
 	 'Certificate details');
 
       skip 'failure', 2 unless
-	  ok(run(app([@reqcmd, &quot;-config&quot;, $P2conf,
+	  ok(run(app([@reqcmd, &quot;-config&quot;, $proxycnf, &quot;-section&quot;, &quot;proxy2_req&quot;,
 		      &quot;-out&quot;, $P2req, &quot;-keyout&quot;, $P2key,
 		      @req_new],
 		     stdout =&gt; &quot;err.ss&quot;)),
@@ -311,7 +307,7 @@ sub testss {
 	  ok(run(app([@x509cmd, &quot;-CAcreateserial&quot;, &quot;-in&quot;, $P2req, &quot;-days&quot;, &quot;30&quot;,
 		      &quot;-req&quot;, &quot;-out&quot;, $P2cert,
 		      &quot;-CA&quot;, $P1cert, &quot;-CAkey&quot;, $P1key,
-		      &quot;-extfile&quot;, $P2conf, &quot;-extensions&quot;, &quot;v3_proxy&quot;],
+		      &quot;-extfile&quot;, $proxycnf, &quot;-extensions&quot;, &quot;proxy_2&quot;],
 		     stdout =&gt; &quot;err.ss&quot;)),
 	     'sign second proxy cert request with the first proxy cert');
 
diff --git a/test/recipes/90-test_store.t b/test/recipes/90-test_store.t
index 3e2e69f439..337bbb10c9 100644
--- a/test/recipes/90-test_store.t
+++ b/test/recipes/90-test_store.t
@@ -16,6 +16,7 @@ my $test_name = &quot;test_store&quot;;
 setup($test_name);
 
 my $mingw = config('target') =~ m|^mingw|;
+my $cnf = srctop_file(&quot;test&quot;, &quot;ca-and-certs.cnf&quot;);
 
 my @noexist_files =
     ( &quot;test/blahdiblah.pem&quot;,
@@ -295,7 +296,7 @@ sub init {
                       }, grep(/-key-pkcs8-pbes2-sha256\.pem$/, @generated_files))
             # *-cert.pem (intermediary for the .p12 inits)
             &amp;&amp; run(app([&quot;openssl&quot;, &quot;req&quot;, &quot;-x509&quot;,
-                        &quot;-config&quot;, data_file(&quot;ca.cnf&quot;), &quot;-nodes&quot;,
+                        &quot;-config&quot;, $cnf, &quot;-nodes&quot;,
                         &quot;-out&quot;, &quot;cacert.pem&quot;, &quot;-keyout&quot;, &quot;cakey.pem&quot;]))
             &amp;&amp; runall(sub {
                           my $srckey = shift;
@@ -303,7 +304,7 @@ sub init {
                           (my $csr = $dstfile) =~ s|\.pem|.csr|;
 
                           (run(app([&quot;openssl&quot;, &quot;req&quot;, &quot;-new&quot;,
-                                    &quot;-config&quot;, data_file(&quot;user.cnf&quot;),
+                                    &quot;-config&quot;, $cnf,
                                     &quot;-key&quot;, $srckey, &quot;-out&quot;, $csr]))
                            &amp;&amp;
                            run(app([&quot;openssl&quot;, &quot;x509&quot;, &quot;-days&quot;, &quot;3650&quot;,
</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029058.html">[openssl]  master update
</A></li>
	<LI>Next message: <A HREF="029068.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29064">[ date ]</a>
              <a href="thread.html#29064">[ thread ]</a>
              <a href="subject.html#29064">[ subject ]</a>
              <a href="author.html#29064">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
