<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2021-June/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1622638234.344836.24496.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034584.html">
   <LINK REL="Next"  HREF="034587.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl]  master update</H1>
    <B>dev at ddvo.net</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1622638234.344836.24496.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl]  master update">dev at ddvo.net
       </A><BR>
    <I>Wed Jun  2 12:50:34 UTC 2021</I>
    <P><UL>
        <LI>Previous message: <A HREF="034584.html">[openssl]  master update
</A></li>
        <LI>Next message: <A HREF="034587.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34585">[ date ]</a>
              <a href="thread.html#34585">[ thread ]</a>
              <a href="subject.html#34585">[ subject ]</a>
              <a href="author.html#34585">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  4388417157ce77974888089ec133d26d7bb0f465 (commit)
       via  07e84e67a6238d16f995fd1e1a3a6dba47299d00 (commit)
      from  5bcbdee621fbf05df7431b8fbb0ea7de7054e1f0 (commit)


- Log -----------------------------------------------------------------
commit 4388417157ce77974888089ec133d26d7bb0f465
Author: Dr. David von Oheimb &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">David.von.Oheimb at siemens.com</A>&gt;
Date:   Thu May 27 15:11:31 2021 +0200

    80-test_cms.t: Replace use of ee-self-signed.pem by more suitable smrsa1.pem
    
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15499">https://github.com/openssl/openssl/pull/15499</A>)

commit 07e84e67a6238d16f995fd1e1a3a6dba47299d00
Author: Dr. David von Oheimb &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">David.von.Oheimb at siemens.com</A>&gt;
Date:   Thu May 27 14:10:58 2021 +0200

    ee-self-signed.pem: Restore original version, adding -attime to 25-test_verify.t
    
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15499">https://github.com/openssl/openssl/pull/15499</A>)

-----------------------------------------------------------------------

Summary of changes:
 test/certs/ee-self-signed.pem |  33 ++++----
 test/recipes/25-test_verify.t |   2 +-
 test/recipes/80-test_cms.t    | 174 ++++++++++++++++++++----------------------
 3 files changed, 99 insertions(+), 110 deletions(-)

diff --git a/test/certs/ee-self-signed.pem b/test/certs/ee-self-signed.pem
index e854c9ad27..ad1e37ba0e 100644
--- a/test/certs/ee-self-signed.pem
+++ b/test/certs/ee-self-signed.pem
@@ -1,19 +1,18 @@
 -----BEGIN CERTIFICATE-----
-MIIDIjCCAgqgAwIBAgIUT99h/YrAdcDg3fdLy5UajB8e994wDQYJKoZIhvcNAQEL
-BQAwGTEXMBUGA1UEAwwOZWUtc2VsZi1zaWduZWQwIBcNMjAwNzI4MTQxNjA4WhgP
-MjEyMDA3MDQxNDE2MDhaMBkxFzAVBgNVBAMMDmVlLXNlbGYtc2lnbmVkMIIBIjAN
-BgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqP+JWGGFrt7bLA/Vc/vit6gbenVg
-K9R9PHN2ta7eky9/JJBtyRz0ijjNn6KAFlbLtCy7k+UXH/8NxkP+MTT4KNh16aO7
-iILvo3LiU2IFRU3gMZfvqp0Q0lgNngaeMrsbCFZdZQ8/Zo7CNqAR/8BZNf1JHN0c
-QjMGeK4EOCPl53Vn05StWqlAH6xZEPUMwWStSsTGNVOzlmqCGxWL0Zmr5J5vlKrS
-luVX+4yRZIo8JBbG0hm+gmATO2Kw7T4ds8r5a98xuXqeS0dopynHP0riIie075Bj
-1+/Qckk+W625G9Qrb4Zo3dVzErhDydxBD6KjRk+LZ4iED2H+eTQfSokftwIDAQAB
-o2AwXjAdBgNVHQ4EFgQU55viKq2KbDrLdlHljgeYIpfhc6IwHwYDVR0jBBgwFoAU
-55viKq2KbDrLdlHljgeYIpfhc6IwDwYDVR0TAQH/BAUwAwEB/zALBgNVHQ8EBAMC
-B4AwDQYJKoZIhvcNAQELBQADggEBAGDEbS5kJArjjQNK02oxhQyz1dbDy23evRxm
-WW/NtlJAQAgEMXoNo9fioj0L4cvDy40r87V6/RsV2eijwZEfwGloACif7v78w8QO
-h4XiW9oGxcQkdMIYZLDVW9AZPDIkK5NHNfQaeAxCprAufYnRMv035UotLzCBRrkG
-G2TIs45vRp/6mYFVtm0Nf9CFvu4dXH8W+GlBONG0FAiBW+JzgTr9OmrzfqJTEDrf
-vv/hOiu8XvvlF5piPBqKE76rEvkXUSjgDZ2/Ju1fjqpV2I8Hz1Mj9w9tRE8g4E9o
-ZcRXX3MNPaHxnNhgYSPdpywwkyILz2AHwmAzh07cdttRFFPw+fM=
+MIICzzCCAbegAwIBAgIUBP7iEKPlKuinZGQNFxSY3IBIb0swDQYJKoZIhvcNAQEL
+BQAwGTEXMBUGA1UEAwwOZWUtc2VsZi1zaWduZWQwHhcNMjAwNjI4MTA1MTQ1WhcN
+MjAwNzI4MTA1MTQ1WjAZMRcwFQYDVQQDDA5lZS1zZWxmLXNpZ25lZDCCASIwDQYJ
+KoZIhvcNAQEBBQADggEPADCCAQoCggEBAKj/iVhhha7e2ywP1XP74reoG3p1YCvU
+fTxzdrWu3pMvfySQbckc9Io4zZ+igBZWy7Qsu5PlFx//DcZD/jE0+CjYdemju4iC
+76Ny4lNiBUVN4DGX76qdENJYDZ4GnjK7GwhWXWUPP2aOwjagEf/AWTX9SRzdHEIz
+BniuBDgj5ed1Z9OUrVqpQB+sWRD1DMFkrUrExjVTs5ZqghsVi9GZq+Seb5Sq0pbl
+V/uMkWSKPCQWxtIZvoJgEztisO0+HbPK+WvfMbl6nktHaKcpxz9K4iIntO+QY9fv
+0HJJPlutuRvUK2+GaN3VcxK4Q8ncQQ+io0ZPi2eIhA9h/nk0H0qJH7cCAwEAAaMP
+MA0wCwYDVR0PBAQDAgeAMA0GCSqGSIb3DQEBCwUAA4IBAQBiLmIUCGb+hmRGbmpO
+lDqEwiRVdxHBs4OSb3IA9QgU1QKUDRqn7q27RRelmzTXllubZZcX3K6o+dunRW5G
+d3f3FVr+3Z7wnmkQtC2y3NWtGuWNczss+6rMLzKvla5CjRiNPlSvluMNpcs7BJxI
+ppk1LxlaiYlQkDW32OPyxzXWDNv1ZkphcOcoCkHAagnq9x1SszvLTjAlo5XpYrm5
+CPgBOEnVwFCgne5Ab4QPTgkxPh/Ta508I/FKaPLJqci1EfGKipZkS7mMGTUJEeVK
+wZrn4z7RiTfJ4PdqO5iv8eOpt03fqdPEXQWe8DrKyfGM6/e369FaXMFhcd2ZxZy2
+WHoc
 -----END CERTIFICATE-----
diff --git a/test/recipes/25-test_verify.t b/test/recipes/25-test_verify.t
index 03a5e1fbdd..b1f4fd6827 100644
--- a/test/recipes/25-test_verify.t
+++ b/test/recipes/25-test_verify.t
@@ -402,7 +402,7 @@ ok(verify(&quot;some-names2&quot;, &quot;&quot;, [&quot;many-constraints&quot;], [&quot;many-constraints&quot;], ),
 ok(verify(&quot;root-cert-rsa2&quot;, &quot;&quot;, [&quot;root-cert-rsa2&quot;], [], &quot;-check_ss_sig&quot;),
     &quot;Public Key Algorithm rsa instead of rsaEncryption&quot;);
 
-ok(verify(&quot;ee-self-signed&quot;, &quot;&quot;, [&quot;ee-self-signed&quot;], []),
+ok(verify(&quot;ee-self-signed&quot;, &quot;&quot;, [&quot;ee-self-signed&quot;], [], &quot;-attime&quot;, &quot;1593565200&quot;),
    &quot;accept trusted self-signed EE cert excluding key usage keyCertSign&quot;);
 
 SKIP: {
diff --git a/test/recipes/80-test_cms.t b/test/recipes/80-test_cms.t
index 1264726047..48a92f735d 100644
--- a/test/recipes/80-test_cms.t
+++ b/test/recipes/80-test_cms.t
@@ -64,22 +64,24 @@ my @prov = (&quot;-provider-path&quot;, $provpath,
             @config,
             &quot;-provider&quot;, $provname);
 
+my $smrsa1 = catfile($smdir, &quot;smrsa1.pem&quot;);
+my $smroot = catfile($smdir, &quot;smroot.pem&quot;);
+
 my @smime_pkcs7_tests = (
 
     [ &quot;signed content DER format, RSA key&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;DER&quot;, &quot;-nodetach&quot;,
-        &quot;-certfile&quot;, catfile($smdir, &quot;smroot.pem&quot;),
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;), &quot;-out&quot;, &quot;{output}.cms&quot; ],
+        &quot;-certfile&quot;, $smroot, &quot;-signer&quot;, $smrsa1, &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;,  @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed detached content DER format, RSA key&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;DER&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;), &quot;-out&quot;, &quot;{output}.cms&quot; ],
+        &quot;-signer&quot;, $smrsa1, &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot;,
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot;,
         &quot;-content&quot;, $smcont ],
       \&amp;final_compare
     ],
@@ -87,9 +89,9 @@ my @smime_pkcs7_tests = (
     [ &quot;signed content test streaming BER format, RSA&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;DER&quot;, &quot;-nodetach&quot;,
         &quot;-stream&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;), &quot;-out&quot;, &quot;{output}.cms&quot; ],
+        &quot;-signer&quot;, $smrsa1, &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
@@ -97,7 +99,7 @@ my @smime_pkcs7_tests = (
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;DER&quot;, &quot;-nodetach&quot;,
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa1.pem&quot;), &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
@@ -105,7 +107,7 @@ my @smime_pkcs7_tests = (
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;DER&quot;,
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa1.pem&quot;), &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot;,
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot;,
         &quot;-content&quot;, $smcont ],
       \&amp;final_compare
     ],
@@ -114,9 +116,9 @@ my @smime_pkcs7_tests = (
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;DER&quot;,
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa1.pem&quot;), &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd1}&quot;, @prov, &quot;-resign&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;, &quot;-outform&quot;, &quot;DER&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;), &quot;-out&quot;, &quot;{output}2.cms&quot; ],
+        &quot;-signer&quot;, $smrsa1, &quot;-out&quot;, &quot;{output}2.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}2.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot;,
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot;,
         &quot;-content&quot;, $smcont ],
       \&amp;final_compare
     ],
@@ -126,85 +128,84 @@ my @smime_pkcs7_tests = (
         &quot;-nodetach&quot;, &quot;-stream&quot;,
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa1.pem&quot;), &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed content test streaming BER format, 2 DSA and 2 RSA keys&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;DER&quot;,
         &quot;-nodetach&quot;, &quot;-stream&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-signer&quot;, $smrsa1,
         &quot;-signer&quot;, catfile($smdir, &quot;smrsa2.pem&quot;),
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa1.pem&quot;),
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa2.pem&quot;),
         &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed content test streaming BER format, 2 DSA and 2 RSA keys, no attributes&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;DER&quot;,
         &quot;-noattr&quot;, &quot;-nodetach&quot;, &quot;-stream&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-signer&quot;, $smrsa1,
         &quot;-signer&quot;, catfile($smdir, &quot;smrsa2.pem&quot;),
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa1.pem&quot;),
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa2.pem&quot;),
         &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed content S/MIME format, RSA key SHA1&quot;,
       [ &quot;{cmd1}&quot;, @defaultprov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-md&quot;, &quot;sha1&quot;,
-        &quot;-certfile&quot;, catfile($smdir, &quot;smroot.pem&quot;),
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;), &quot;-out&quot;, &quot;{output}.cms&quot; ],
+        &quot;-certfile&quot;, $smroot,
+        &quot;-signer&quot;, $smrsa1, &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed zero-length content S/MIME format, RSA key SHA1&quot;,
       [ &quot;{cmd1}&quot;, @defaultprov, &quot;-sign&quot;, &quot;-in&quot;, $smcont_zero, &quot;-md&quot;, &quot;sha1&quot;,
-        &quot;-certfile&quot;, catfile($smdir, &quot;smroot.pem&quot;),
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;), &quot;-out&quot;, &quot;{output}.cms&quot; ],
+        &quot;-certfile&quot;, $smroot, &quot;-signer&quot;, $smrsa1, &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;zero_compare
     ],
 
     [ &quot;signed content test streaming S/MIME format, 2 DSA and 2 RSA keys&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-nodetach&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-signer&quot;, $smrsa1,
         &quot;-signer&quot;, catfile($smdir, &quot;smrsa2.pem&quot;),
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa1.pem&quot;),
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa2.pem&quot;),
         &quot;-stream&quot;, &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed content test streaming multipart S/MIME format, 2 DSA and 2 RSA keys&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-signer&quot;, $smrsa1,
         &quot;-signer&quot;, catfile($smdir, &quot;smrsa2.pem&quot;),
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa1.pem&quot;),
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa2.pem&quot;),
         &quot;-stream&quot;, &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;enveloped content test streaming S/MIME format, DES, 3 recipients&quot;,
       [ &quot;{cmd1}&quot;, @defaultprov, &quot;-encrypt&quot;, &quot;-in&quot;, $smcont,
         &quot;-stream&quot;, &quot;-out&quot;, &quot;{output}.cms&quot;,
-        catfile($smdir, &quot;smrsa1.pem&quot;),
+        $smrsa1,
         catfile($smdir, &quot;smrsa2.pem&quot;),
         catfile($smdir, &quot;smrsa3.pem&quot;) ],
-      [ &quot;{cmd2}&quot;, @defaultprov, &quot;-decrypt&quot;, &quot;-recip&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+      [ &quot;{cmd2}&quot;, @defaultprov, &quot;-decrypt&quot;, &quot;-recip&quot;, $smrsa1,
         &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
@@ -212,7 +213,7 @@ my @smime_pkcs7_tests = (
     [ &quot;enveloped content test streaming S/MIME format, DES, 3 recipients, 3rd used&quot;,
       [ &quot;{cmd1}&quot;, @defaultprov, &quot;-encrypt&quot;, &quot;-in&quot;, $smcont,
         &quot;-stream&quot;, &quot;-out&quot;, &quot;{output}.cms&quot;,
-        catfile($smdir, &quot;smrsa1.pem&quot;),
+        $smrsa1,
         catfile($smdir, &quot;smrsa2.pem&quot;),
         catfile($smdir, &quot;smrsa3.pem&quot;) ],
       [ &quot;{cmd2}&quot;, @defaultprov, &quot;-decrypt&quot;, &quot;-recip&quot;, catfile($smdir, &quot;smrsa3.pem&quot;),
@@ -223,7 +224,7 @@ my @smime_pkcs7_tests = (
     [ &quot;enveloped content test streaming S/MIME format, DES, 3 recipients, key only used&quot;,
       [ &quot;{cmd1}&quot;, @defaultprov, &quot;-encrypt&quot;, &quot;-in&quot;, $smcont,
         &quot;-stream&quot;, &quot;-out&quot;, &quot;{output}.cms&quot;,
-        catfile($smdir, &quot;smrsa1.pem&quot;),
+        $smrsa1,
         catfile($smdir, &quot;smrsa2.pem&quot;),
         catfile($smdir, &quot;smrsa3.pem&quot;) ],
       [ &quot;{cmd2}&quot;, @defaultprov, &quot;-decrypt&quot;, &quot;-inkey&quot;, catfile($smdir, &quot;smrsa3.pem&quot;),
@@ -234,10 +235,10 @@ my @smime_pkcs7_tests = (
     [ &quot;enveloped content test streaming S/MIME format, AES-256 cipher, 3 recipients&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-encrypt&quot;, &quot;-in&quot;, $smcont,
         &quot;-aes256&quot;, &quot;-stream&quot;, &quot;-out&quot;, &quot;{output}.cms&quot;,
-        catfile($smdir, &quot;smrsa1.pem&quot;),
+        $smrsa1,
         catfile($smdir, &quot;smrsa2.pem&quot;),
         catfile($smdir, &quot;smrsa3.pem&quot;) ],
-      [ &quot;{cmd2}&quot;, @prov, &quot;-decrypt&quot;, &quot;-recip&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+      [ &quot;{cmd2}&quot;, @prov, &quot;-decrypt&quot;, &quot;-recip&quot;, $smrsa1,
         &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
@@ -249,56 +250,56 @@ my @smime_cms_tests = (
     [ &quot;signed content test streaming BER format, 2 DSA and 2 RSA keys, keyid&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;DER&quot;,
         &quot;-nodetach&quot;, &quot;-keyid&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-signer&quot;, $smrsa1,
         &quot;-signer&quot;, catfile($smdir, &quot;smrsa2.pem&quot;),
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa1.pem&quot;),
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa2.pem&quot;),
         &quot;-stream&quot;, &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed content test streaming PEM format, 2 DSA and 2 RSA keys&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;PEM&quot;, &quot;-nodetach&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-signer&quot;, $smrsa1,
         &quot;-signer&quot;, catfile($smdir, &quot;smrsa2.pem&quot;),
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa1.pem&quot;),
         &quot;-signer&quot;, catfile($smdir, &quot;smdsa2.pem&quot;),
         &quot;-stream&quot;, &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;PEM&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed content MIME format, RSA key, signed receipt request&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-nodetach&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-signer&quot;, $smrsa1,
         &quot;-receipt_request_to&quot;, &quot;test\@openssl.org&quot;, &quot;-receipt_request_all&quot;,
         &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed receipt MIME format, RSA key&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-nodetach&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-signer&quot;, $smrsa1,
         &quot;-receipt_request_to&quot;, &quot;test\@openssl.org&quot;, &quot;-receipt_request_all&quot;,
         &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign_receipt&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;,
         &quot;-signer&quot;, catfile($smdir, &quot;smrsa2.pem&quot;), &quot;-out&quot;, &quot;{output}2.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify_receipt&quot;, &quot;{output}2.cms&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;) ]
+        &quot;-CAfile&quot;, $smroot ]
     ],
 
     [ &quot;enveloped content test streaming S/MIME format, DES, 3 recipients, keyid&quot;,
       [ &quot;{cmd1}&quot;, @defaultprov, &quot;-encrypt&quot;, &quot;-in&quot;, $smcont,
         &quot;-stream&quot;, &quot;-out&quot;, &quot;{output}.cms&quot;, &quot;-keyid&quot;,
-        catfile($smdir, &quot;smrsa1.pem&quot;),
+        $smrsa1,
         catfile($smdir, &quot;smrsa2.pem&quot;),
         catfile($smdir, &quot;smrsa3.pem&quot;) ],
-      [ &quot;{cmd2}&quot;, @defaultprov, &quot;-decrypt&quot;, &quot;-recip&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+      [ &quot;{cmd2}&quot;, @defaultprov, &quot;-decrypt&quot;, &quot;-recip&quot;, $smrsa1,
         &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
@@ -397,56 +398,52 @@ my @smime_cms_cades_tests = (
     [ &quot;signed content DER format, RSA key, CAdES-BES compatible&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-cades&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;DER&quot;,
          &quot;-nodetach&quot;,
-        &quot;-certfile&quot;, catfile($smdir, &quot;smroot.pem&quot;),
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;), &quot;-out&quot;, &quot;{output}.cms&quot; ],
+        &quot;-certfile&quot;, $smroot, &quot;-signer&quot;, $smrsa1, &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-cades&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed content DER format, RSA key, SHA256 md, CAdES-BES compatible&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-cades&quot;, &quot;-md&quot;, &quot;sha256&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;,
-        &quot;DER&quot;, &quot;-nodetach&quot;, &quot;-certfile&quot;, catfile($smdir, &quot;smroot.pem&quot;),
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;), &quot;-out&quot;, &quot;{output}.cms&quot; ],
+        &quot;DER&quot;, &quot;-nodetach&quot;, &quot;-certfile&quot;, $smroot,
+        &quot;-signer&quot;, $smrsa1, &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-cades&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed content DER format, RSA key, SHA512 md, CAdES-BES compatible&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-cades&quot;, &quot;-md&quot;, &quot;sha512&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;,
-        &quot;DER&quot;, &quot;-nodetach&quot;, &quot;-certfile&quot;, catfile($smdir, &quot;smroot.pem&quot;),
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;), &quot;-out&quot;, &quot;{output}.cms&quot; ],
+        &quot;DER&quot;, &quot;-nodetach&quot;, &quot;-certfile&quot;, $smroot,
+        &quot;-signer&quot;, $smrsa1, &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-cades&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed content DER format, RSA key, SHA256 md, CAdES-BES compatible&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-cades&quot;, &quot;-binary&quot;,  &quot;-nodetach&quot;, &quot;-nosmimecap&quot;, &quot;-md&quot;, &quot;sha256&quot;,
         &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;DER&quot;, 
-        &quot;-certfile&quot;, catfile($smdir, &quot;smroot.pem&quot;),
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-certfile&quot;, $smroot, &quot;-signer&quot;, $smrsa1,
         &quot;-outform&quot;, &quot;DER&quot;, &quot;-out&quot;, &quot;{output}.cms&quot;  ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-cades&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;resigned content DER format, RSA key, SHA256 md, CAdES-BES compatible&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-cades&quot;, &quot;-binary&quot;,  &quot;-nodetach&quot;, &quot;-nosmimecap&quot;, &quot;-md&quot;, &quot;sha256&quot;,
         &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;DER&quot;, 
-        &quot;-certfile&quot;, catfile($smdir, &quot;smroot.pem&quot;),
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-certfile&quot;, $smroot, &quot;-signer&quot;, $smrsa1,
         &quot;-outform&quot;, &quot;DER&quot;, &quot;-out&quot;, &quot;{output}.cms&quot;  ],
       [ &quot;{cmd1}&quot;, @prov, &quot;-resign&quot;, &quot;-cades&quot;, &quot;-binary&quot;, &quot;-nodetach&quot;, &quot;-nosmimecap&quot;, &quot;-md&quot;, &quot;sha256&quot;,
         &quot;-inform&quot;, &quot;DER&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;,
-        &quot;-certfile&quot;, catfile($smdir, &quot;smroot.pem&quot;),
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa2.pem&quot;),
+        &quot;-certfile&quot;, $smroot, &quot;-signer&quot;, catfile($smdir, &quot;smrsa2.pem&quot;),
         &quot;-outform&quot;, &quot;DER&quot;, &quot;-out&quot;, &quot;{output}2.cms&quot; ],
 
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-cades&quot;, &quot;-in&quot;, &quot;{output}2.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 );
@@ -454,11 +451,10 @@ my @smime_cms_cades_tests = (
 my @smime_cms_cades_ko_tests = (
     [ &quot;sign content DER format, RSA key, not CAdES-BES compatible&quot;,
       [ @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;DER&quot;, &quot;-nodetach&quot;,
-        &quot;-certfile&quot;, catfile($smdir, &quot;smroot.pem&quot;),
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;), &quot;-out&quot;, &quot;{output}.cms&quot; ],
+        &quot;-certfile&quot;, $smroot, &quot;-signer&quot;, $smrsa1, &quot;-out&quot;, &quot;{output}.cms&quot; ],
       &quot;fail to verify token since requiring CAdES-BES compatibility&quot;,
       [ @prov, &quot;-verify&quot;, &quot;-cades&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ]
 );
@@ -489,51 +485,50 @@ my @smime_cms_comp_tests = (
 my @smime_cms_param_tests = (
     [ &quot;signed content test streaming PEM format, RSA keys, PSS signature&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;PEM&quot;, &quot;-nodetach&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-signer&quot;, $smrsa1,
         &quot;-keyopt&quot;, &quot;rsa_padding_mode:pss&quot;,
         &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;PEM&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed content test streaming PEM format, RSA keys, PSS signature, saltlen=max&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;PEM&quot;, &quot;-nodetach&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-signer&quot;, $smrsa1,
         &quot;-keyopt&quot;, &quot;rsa_padding_mode:pss&quot;, &quot;-keyopt&quot;, &quot;rsa_pss_saltlen:max&quot;,
         &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;PEM&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed content test streaming PEM format, RSA keys, PSS signature, no attributes&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;PEM&quot;, &quot;-nodetach&quot;,
-        &quot;-noattr&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-noattr&quot;, &quot;-signer&quot;, $smrsa1,
         &quot;-keyopt&quot;, &quot;rsa_padding_mode:pss&quot;,
         &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;PEM&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;signed content test streaming PEM format, RSA keys, PSS signature, SHA384 MGF1&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-in&quot;, $smcont, &quot;-outform&quot;, &quot;PEM&quot;, &quot;-nodetach&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-signer&quot;, $smrsa1,
         &quot;-keyopt&quot;, &quot;rsa_padding_mode:pss&quot;, &quot;-keyopt&quot;, &quot;rsa_mgf1_md:sha384&quot;,
         &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-inform&quot;, &quot;PEM&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ],
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
 
     [ &quot;enveloped content test streaming S/MIME format, DES, OAEP default parameters&quot;,
       [ &quot;{cmd1}&quot;, @defaultprov, &quot;-encrypt&quot;, &quot;-in&quot;, $smcont,
         &quot;-stream&quot;, &quot;-out&quot;, &quot;{output}.cms&quot;,
-        &quot;-recip&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-recip&quot;, $smrsa1,
         &quot;-keyopt&quot;, &quot;rsa_padding_mode:oaep&quot; ],
-      [ &quot;{cmd2}&quot;, @defaultprov, &quot;-decrypt&quot;, &quot;-recip&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+      [ &quot;{cmd2}&quot;, @defaultprov, &quot;-decrypt&quot;, &quot;-recip&quot;, $smrsa1,
         &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
@@ -541,10 +536,10 @@ my @smime_cms_param_tests = (
     [ &quot;enveloped content test streaming S/MIME format, DES, OAEP SHA256&quot;,
       [ &quot;{cmd1}&quot;, @defaultprov, &quot;-encrypt&quot;, &quot;-in&quot;, $smcont,
         &quot;-stream&quot;, &quot;-out&quot;, &quot;{output}.cms&quot;,
-        &quot;-recip&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+        &quot;-recip&quot;, $smrsa1,
         &quot;-keyopt&quot;, &quot;rsa_padding_mode:oaep&quot;,
         &quot;-keyopt&quot;, &quot;rsa_oaep_md:sha256&quot; ],
-      [ &quot;{cmd2}&quot;, @defaultprov, &quot;-decrypt&quot;, &quot;-recip&quot;, catfile($smdir, &quot;smrsa1.pem&quot;),
+      [ &quot;{cmd2}&quot;, @defaultprov, &quot;-decrypt&quot;, &quot;-recip&quot;, $smrsa1,
         &quot;-in&quot;, &quot;{output}.cms&quot;, &quot;-out&quot;, &quot;{output}.txt&quot; ],
       \&amp;final_compare
     ],
@@ -619,8 +614,7 @@ my @smime_cms_param_tests = (
 my @contenttype_cms_test = (
     [ &quot;signed content test - check that content type is added to additional signerinfo, RSA keys&quot;,
       [ &quot;{cmd1}&quot;, @prov, &quot;-sign&quot;, &quot;-binary&quot;, &quot;-nodetach&quot;, &quot;-stream&quot;, &quot;-in&quot;, $smcont,
-        &quot;-outform&quot;, &quot;DER&quot;,
-        &quot;-signer&quot;, catfile($smdir, &quot;smrsa1.pem&quot;), &quot;-md&quot;, &quot;SHA256&quot;,
+        &quot;-outform&quot;, &quot;DER&quot;, &quot;-signer&quot;, $smrsa1, &quot;-md&quot;, &quot;SHA256&quot;,
         &quot;-out&quot;, &quot;{output}.cms&quot; ],
       [ &quot;{cmd1}&quot;, @prov, &quot;-resign&quot;, &quot;-binary&quot;, &quot;-nodetach&quot;, &quot;-in&quot;, &quot;{output}.cms&quot;,
         &quot;-inform&quot;, &quot;DER&quot;, &quot;-outform&quot;, &quot;DER&quot;,
@@ -628,7 +622,7 @@ my @contenttype_cms_test = (
         &quot;-out&quot;, &quot;{output}2.cms&quot; ],
       sub { my %opts = @_; contentType_matches(&quot;$opts{output}2.cms&quot;) == 2; },
       [ &quot;{cmd2}&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;, &quot;{output}2.cms&quot;, &quot;-inform&quot;, &quot;DER&quot;,
-        &quot;-CAfile&quot;, catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, &quot;{output}.txt&quot; ]
+        &quot;-CAfile&quot;, $smroot, &quot;-out&quot;, &quot;{output}.txt&quot; ]
     ],
 );
 
@@ -761,7 +755,7 @@ subtest &quot;CMS Check that bad attributes fail when verifying signers\n&quot; =&gt; sub {
 
         ok(!run(app([&quot;openssl&quot;, &quot;cms&quot;, @prov, &quot;-verify&quot;, &quot;-in&quot;,
                      catfile($datadir, $name), &quot;-inform&quot;, &quot;DER&quot;, &quot;-CAfile&quot;,
-                     catfile($smdir, &quot;smroot.pem&quot;), &quot;-out&quot;, $out ])),
+                     $smroot, &quot;-out&quot;, $out ])),
             $name);
     }
 };
@@ -817,42 +811,38 @@ subtest &quot;CMS binary input tests\n&quot; =&gt; sub {
     my $input = srctop_file(&quot;test&quot;, &quot;smcont.bin&quot;);
     my $signed = &quot;smcont.signed&quot;;
     my $verified = &quot;smcont.verified&quot;;
-    my $cert = srctop_file(&quot;test&quot;, &quot;certs&quot;, &quot;ee-self-signed.pem&quot;);
-    my $key = srctop_file(&quot;test&quot;, &quot;certs&quot;, &quot;ee-key.pem&quot;);
 
     plan tests =&gt; 11;
 
-    ok(run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-sign&quot;, &quot;-md&quot;, &quot;sha256&quot;,
-                &quot;-signer&quot;, $cert, &quot;-inkey&quot;, $key,
+    ok(run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-sign&quot;, &quot;-md&quot;, &quot;sha256&quot;, &quot;-signer&quot;, $smrsa1,
                 &quot;-binary&quot;, &quot;-in&quot;, $input, &quot;-out&quot;, $signed])),
        &quot;sign binary input with -binary&quot;);
-    ok(run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-verify&quot;, &quot;-CAfile&quot;, $cert,
+    ok(run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-verify&quot;, &quot;-CAfile&quot;, $smroot,
                 &quot;-binary&quot;, &quot;-in&quot;, $signed, &quot;-out&quot;, $verified])),
        &quot;verify binary input with -binary&quot;);
     is(compare($input, $verified), 0, &quot;binary input retained with -binary&quot;);
 
-    ok(run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-sign&quot;, &quot;-md&quot;, &quot;sha256&quot;,
-                &quot;-signer&quot;, $cert, &quot;-inkey&quot;, $key,
+    ok(run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-sign&quot;, &quot;-md&quot;, &quot;sha256&quot;, &quot;-signer&quot;, $smrsa1,
                 &quot;-in&quot;, $input, &quot;-out&quot;, $signed.&quot;.nobin&quot;])),
        &quot;sign binary input without -binary&quot;);
-    ok(run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-verify&quot;, &quot;-CAfile&quot;, $cert,
+    ok(run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-verify&quot;, &quot;-CAfile&quot;, $smroot,
                 &quot;-in&quot;, $signed.&quot;.nobin&quot;, &quot;-out&quot;, $verified.&quot;.nobin&quot;])),
        &quot;verify binary input without -binary&quot;);
     is(compare($input, $verified.&quot;.nobin&quot;), 1, &quot;binary input not retained without -binary&quot;);
-    ok(!run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-verify&quot;, &quot;-CAfile&quot;, $cert, &quot;-crlfeol&quot;,
+    ok(!run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-verify&quot;, &quot;-CAfile&quot;, $smroot, &quot;-crlfeol&quot;,
                 &quot;-binary&quot;, &quot;-in&quot;, $signed, &quot;-out&quot;, $verified.&quot;.crlfeol&quot;])),
        &quot;verify binary input wrong crlfeol&quot;);
 
-    ok(run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-sign&quot;, &quot;-md&quot;, &quot;sha256&quot;, &quot;-crlfeol&quot;,
-                &quot;-signer&quot;, $cert, &quot;-inkey&quot;, $key,
+    ok(run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-sign&quot;, &quot;-md&quot;, &quot;sha256&quot;, &quot;-signer&quot;, $smrsa1,
+                &quot;-crlfeol&quot;,
                 &quot;-binary&quot;, &quot;-in&quot;, $input, &quot;-out&quot;, $signed.&quot;.crlf&quot;])),
        &quot;sign binary input with -binary -crlfeol&quot;);
-    ok(run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-verify&quot;, &quot;-CAfile&quot;, $cert, &quot;-crlfeol&quot;,
+    ok(run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-verify&quot;, &quot;-CAfile&quot;, $smroot, &quot;-crlfeol&quot;,
                 &quot;-binary&quot;, &quot;-in&quot;, $signed.&quot;.crlf&quot;, &quot;-out&quot;, $verified.&quot;.crlf&quot;])),
        &quot;verify binary input with -binary -crlfeol&quot;);
     is(compare($input, $verified.&quot;.crlf&quot;), 0,
        &quot;binary input retained with -binary -crlfeol&quot;);
-    ok(!run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-verify&quot;, &quot;-CAfile&quot;, $cert,
+    ok(!run(app([&quot;openssl&quot;, &quot;cms&quot;, &quot;-verify&quot;, &quot;-CAfile&quot;, $smroot,
                 &quot;-binary&quot;, &quot;-in&quot;, $signed.&quot;.crlf&quot;, &quot;-out&quot;, $verified.&quot;.crlf2&quot;])),
        &quot;verify binary input with -binary missing -crlfeol&quot;);
 };
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034584.html">[openssl]  master update
</A></li>
	<LI>Next message: <A HREF="034587.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34585">[ date ]</a>
              <a href="thread.html#34585">[ thread ]</a>
              <a href="subject.html#34585">[ subject ]</a>
              <a href="author.html#34585">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
