<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2021-June/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1624104174.895534.11338.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034760.html">
   <LINK REL="Next"  HREF="034762.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl]  master update</H1>
    <B>Dr. Paul Dale</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1624104174.895534.11338.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl]  master update">pauli at openssl.org
       </A><BR>
    <I>Sat Jun 19 12:02:54 UTC 2021</I>
    <P><UL>
        <LI>Previous message: <A HREF="034760.html">[openssl]  master update
</A></li>
        <LI>Next message: <A HREF="034762.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34761">[ date ]</a>
              <a href="thread.html#34761">[ thread ]</a>
              <a href="subject.html#34761">[ subject ]</a>
              <a href="author.html#34761">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  c602fadc443fad88aafbab35cdc11ba5ffdf6e30 (commit)
       via  555fea854d6c59efc2ff38d78b4812aeae3c5cd5 (commit)
       via  bb82ef11153c2c386787c988970d4aec3acad8f2 (commit)
       via  2d6f72aa03ab36f2b281d9e01058a824c69cd46d (commit)
       via  f6f3a5d34a1ff9a2f5cf2a6efd461f20370dd5ec (commit)
       via  43c02d9ce267fce7111e67d35f1f5733755f36cf (commit)
       via  d05bfc12541c95fb41a560cb813255c6aafdb2d7 (commit)
       via  a0430488c12036f88d52c96ca941199571304786 (commit)
       via  5ea4d7648cb2cd23d42850865686390896c6e607 (commit)
       via  e69bde88e44c431412d7cf9f9361b84c95fe549d (commit)
      from  d0e5230dcecc6013d351545ceb275aa2ba5baa80 (commit)


- Log -----------------------------------------------------------------
commit c602fadc443fad88aafbab35cdc11ba5ffdf6e30
Author: Pauli &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
Date:   Fri Jun 18 19:56:29 2021 +1000

    test: fix indentation
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15824">https://github.com/openssl/openssl/pull/15824</A>)

commit 555fea854d6c59efc2ff38d78b4812aeae3c5cd5
Author: Pauli &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
Date:   Fri Jun 18 19:47:06 2021 +1000

    rsa:  fix indentation
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15824">https://github.com/openssl/openssl/pull/15824</A>)

commit bb82ef11153c2c386787c988970d4aec3acad8f2
Author: Pauli &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
Date:   Fri Jun 18 19:46:50 2021 +1000

    asn1: fix indentation
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15824">https://github.com/openssl/openssl/pull/15824</A>)

commit 2d6f72aa03ab36f2b281d9e01058a824c69cd46d
Author: Pauli &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
Date:   Fri Jun 18 19:46:36 2021 +1000

    ssl: fix indentation
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15824">https://github.com/openssl/openssl/pull/15824</A>)

commit f6f3a5d34a1ff9a2f5cf2a6efd461f20370dd5ec
Author: Pauli &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
Date:   Fri Jun 18 19:46:27 2021 +1000

    ssl: fix indentation
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15824">https://github.com/openssl/openssl/pull/15824</A>)

commit 43c02d9ce267fce7111e67d35f1f5733755f36cf
Author: Pauli &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
Date:   Fri Jun 18 19:46:16 2021 +1000

    punycode: fix indentation
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15824">https://github.com/openssl/openssl/pull/15824</A>)

commit d05bfc12541c95fb41a560cb813255c6aafdb2d7
Author: Pauli &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
Date:   Fri Jun 18 17:50:54 2021 +1000

    crypto: repalce tabs with spaces
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15824">https://github.com/openssl/openssl/pull/15824</A>)

commit a0430488c12036f88d52c96ca941199571304786
Author: Pauli &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
Date:   Fri Jun 18 17:46:40 2021 +1000

    test: replace tabs with spaces in test recipes
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15824">https://github.com/openssl/openssl/pull/15824</A>)

commit 5ea4d7648cb2cd23d42850865686390896c6e607
Author: Pauli &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
Date:   Fri Jun 18 17:44:57 2021 +1000

    ssl: replace tabs with spaces
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15824">https://github.com/openssl/openssl/pull/15824</A>)

commit e69bde88e44c431412d7cf9f9361b84c95fe549d
Author: Pauli &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
Date:   Fri Jun 18 17:44:44 2021 +1000

    include: replace tabs with spaces in headers
    
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15824">https://github.com/openssl/openssl/pull/15824</A>)

-----------------------------------------------------------------------

Summary of changes:
 crypto/asn1/x_algor.c                       |  10 +-
 crypto/property/property.c                  |   2 +-
 crypto/rsa/rsa_sp800_56b_gen.c              |  12 +-
 include/crypto/punycode.h                   |   8 +-
 include/openssl/configuration.h.in          |  12 +-
 ssl/ktls.c                                  |  16 +-
 ssl/record/rec_layer_s3.c                   |  14 +-
 ssl/statem/extensions.c                     |   2 +-
 ssl/t1_lib.c                                |   2 +-
 test/recipes/15-test_rsa.t                  |  10 +-
 test/recipes/20-test_enc.t                  |  34 +--
 test/recipes/25-test_req.t                  |   2 +-
 test/recipes/25-test_verify.t               |   2 +-
 test/recipes/25-test_verify_store.t         |   2 +-
 test/recipes/60-test_x509_check_cert_pkey.t |   4 +-
 test/recipes/70-test_sslsessiontick.t       |  60 +++---
 test/recipes/80-test_ca.t                   |  14 +-
 test/recipes/80-test_ocsp.t                 | 110 +++++-----
 test/recipes/80-test_ssl_old.t              | 322 ++++++++++++++--------------
 19 files changed, 319 insertions(+), 319 deletions(-)

diff --git a/crypto/asn1/x_algor.c b/crypto/asn1/x_algor.c
index ff83ce4fef..c0a5f76803 100644
--- a/crypto/asn1/x_algor.c
+++ b/crypto/asn1/x_algor.c
@@ -98,7 +98,7 @@ int X509_ALGOR_cmp(const X509_ALGOR *a, const X509_ALGOR *b)
 int X509_ALGOR_copy(X509_ALGOR *dest, const X509_ALGOR *src)
 {
     if (src == NULL || dest == NULL)
-	return 0;
+        return 0;
 
     if (dest-&gt;algorithm)
          ASN1_OBJECT_free(dest-&gt;algorithm);
@@ -110,7 +110,7 @@ int X509_ALGOR_copy(X509_ALGOR *dest, const X509_ALGOR *src)
 
     if (src-&gt;algorithm)
         if ((dest-&gt;algorithm = OBJ_dup(src-&gt;algorithm)) == NULL)
-	    return 0;
+            return 0;
 
     if (src-&gt;parameter != NULL) {
         dest-&gt;parameter = ASN1_TYPE_new();
@@ -120,9 +120,9 @@ int X509_ALGOR_copy(X509_ALGOR *dest, const X509_ALGOR *src)
         /* Assuming this is also correct for a BOOL.
          * set does copy as a side effect.
          */
-        if (ASN1_TYPE_set1(dest-&gt;parameter, 
-              src-&gt;parameter-&gt;type, src-&gt;parameter-&gt;value.ptr) == 0)
-	    return 0;
+        if (ASN1_TYPE_set1(dest-&gt;parameter, src-&gt;parameter-&gt;type,
+                           src-&gt;parameter-&gt;value.ptr) == 0)
+            return 0;
     }
 
     return 1;
diff --git a/crypto/property/property.c b/crypto/property/property.c
index 535120b581..c3f1c5ac58 100644
--- a/crypto/property/property.c
+++ b/crypto/property/property.c
@@ -412,7 +412,7 @@ int ossl_method_store_fetch(OSSL_METHOD_STORE *store, int nid,
 
 #ifndef FIPS_MODULE
     if (!OPENSSL_init_crypto(OPENSSL_INIT_LOAD_CONFIG, NULL))
-	return 0;
+        return 0;
 #endif
 
     if (nid &lt;= 0 || method == NULL || store == NULL)
diff --git a/crypto/rsa/rsa_sp800_56b_gen.c b/crypto/rsa/rsa_sp800_56b_gen.c
index 365996fd07..df2240555b 100644
--- a/crypto/rsa/rsa_sp800_56b_gen.c
+++ b/crypto/rsa/rsa_sp800_56b_gen.c
@@ -285,7 +285,7 @@ int ossl_rsa_sp800_56b_derive_params_from_pq(RSA *rsa, int nbits,
     if (rsa-&gt;dmp1 == NULL)
         rsa-&gt;dmp1 = BN_secure_new();
     if (rsa-&gt;dmp1 == NULL)
-	    goto err;
+        goto err;
     BN_set_flags(rsa-&gt;dmp1, BN_FLG_CONSTTIME);
     if (!BN_mod(rsa-&gt;dmp1, rsa-&gt;d, p1, ctx))
         goto err;
@@ -294,7 +294,7 @@ int ossl_rsa_sp800_56b_derive_params_from_pq(RSA *rsa, int nbits,
     if (rsa-&gt;dmq1 == NULL)
         rsa-&gt;dmq1 = BN_secure_new();
     if (rsa-&gt;dmq1 == NULL)
-	    goto err;
+        goto err;
     BN_set_flags(rsa-&gt;dmq1, BN_FLG_CONSTTIME);
     if (!BN_mod(rsa-&gt;dmq1, rsa-&gt;d, q1, ctx))
         goto err;
@@ -303,7 +303,7 @@ int ossl_rsa_sp800_56b_derive_params_from_pq(RSA *rsa, int nbits,
     BN_free(rsa-&gt;iqmp);
     rsa-&gt;iqmp = BN_secure_new();
     if (rsa-&gt;iqmp == NULL)
-	    goto err;
+        goto err;
     BN_set_flags(rsa-&gt;iqmp, BN_FLG_CONSTTIME);
     if (BN_mod_inverse(rsa-&gt;iqmp, rsa-&gt;q, rsa-&gt;p, ctx) == NULL)
         goto err;
@@ -429,9 +429,9 @@ int ossl_rsa_sp800_56b_pairwise_test(RSA *rsa, BN_CTX *ctx)
     BN_set_flags(k, BN_FLG_CONSTTIME);
 
     ret = (BN_set_word(k, 2)
-          &amp;&amp; BN_mod_exp(tmp, k, rsa-&gt;e, rsa-&gt;n, ctx)
-          &amp;&amp; BN_mod_exp(tmp, tmp, rsa-&gt;d, rsa-&gt;n, ctx)
-          &amp;&amp; BN_cmp(k, tmp) == 0);
+           &amp;&amp; BN_mod_exp(tmp, k, rsa-&gt;e, rsa-&gt;n, ctx)
+           &amp;&amp; BN_mod_exp(tmp, tmp, rsa-&gt;d, rsa-&gt;n, ctx)
+           &amp;&amp; BN_cmp(k, tmp) == 0);
     if (ret == 0)
         ERR_raise(ERR_LIB_RSA, RSA_R_PAIRWISE_TEST_FAILURE);
 err:
diff --git a/include/crypto/punycode.h b/include/crypto/punycode.h
index f47eded262..133826d87e 100644
--- a/include/crypto/punycode.h
+++ b/include/crypto/punycode.h
@@ -12,10 +12,10 @@
 # pragma once
 
 int ossl_punycode_decode (
-	const char *pEncoded,
-	const size_t enc_len,
-	unsigned int *pDecoded,
-	unsigned int *pout_length
+    const char *pEncoded,
+    const size_t enc_len,
+    unsigned int *pDecoded,
+    unsigned int *pout_length
 );
 
 int ossl_a2ulabel(const char *in, char *out, size_t *outlen);
diff --git a/include/openssl/configuration.h.in b/include/openssl/configuration.h.in
index e4d4f526b3..b84dc1dfe3 100644
--- a/include/openssl/configuration.h.in
+++ b/include/openssl/configuration.h.in
@@ -27,9 +27,9 @@ extern &quot;C&quot; {
 
 {- if (@{$config{openssl_sys_defines}}) {
       foreach (@{$config{openssl_sys_defines}}) {
-	$OUT .= &quot;# ifndef $_\n&quot;;
-	$OUT .= &quot;#  define $_ 1\n&quot;;
-	$OUT .= &quot;# endif\n&quot;;
+        $OUT .= &quot;# ifndef $_\n&quot;;
+        $OUT .= &quot;#  define $_ 1\n&quot;;
+        $OUT .= &quot;# endif\n&quot;;
       }
     }
     foreach (@{$config{openssl_api_defines}}) {
@@ -38,9 +38,9 @@ extern &quot;C&quot; {
     }
     if (@{$config{openssl_feature_defines}}) {
       foreach (@{$config{openssl_feature_defines}}) {
-	$OUT .= &quot;# ifndef $_\n&quot;;
-	$OUT .= &quot;#  define $_\n&quot;;
-	$OUT .= &quot;# endif\n&quot;;
+        $OUT .= &quot;# ifndef $_\n&quot;;
+        $OUT .= &quot;#  define $_\n&quot;;
+        $OUT .= &quot;# endif\n&quot;;
       }
     }
     &quot;&quot;;
diff --git a/ssl/ktls.c b/ssl/ktls.c
index a5de8bd720..2d691fdeb2 100644
--- a/ssl/ktls.c
+++ b/ssl/ktls.c
@@ -180,11 +180,11 @@ int ktls_configure_crypto(const SSL *s, const EVP_CIPHER *c, EVP_CIPHER_CTX *dd,
         crypto_info-&gt;gcm128.info.version = s-&gt;version;
         crypto_info-&gt;tls_crypto_info_len = sizeof(crypto_info-&gt;gcm128);
         memcpy(crypto_info-&gt;gcm128.iv, iiv + EVP_GCM_TLS_FIXED_IV_LEN,
-                TLS_CIPHER_AES_GCM_128_IV_SIZE);
+               TLS_CIPHER_AES_GCM_128_IV_SIZE);
         memcpy(crypto_info-&gt;gcm128.salt, iiv, TLS_CIPHER_AES_GCM_128_SALT_SIZE);
         memcpy(crypto_info-&gt;gcm128.key, key, EVP_CIPHER_get_key_length(c));
         memcpy(crypto_info-&gt;gcm128.rec_seq, rl_sequence,
-                TLS_CIPHER_AES_GCM_128_REC_SEQ_SIZE);
+               TLS_CIPHER_AES_GCM_128_REC_SEQ_SIZE);
         if (rec_seq != NULL)
             *rec_seq = crypto_info-&gt;gcm128.rec_seq;
         return 1;
@@ -195,11 +195,11 @@ int ktls_configure_crypto(const SSL *s, const EVP_CIPHER *c, EVP_CIPHER_CTX *dd,
         crypto_info-&gt;gcm256.info.version = s-&gt;version;
         crypto_info-&gt;tls_crypto_info_len = sizeof(crypto_info-&gt;gcm256);
         memcpy(crypto_info-&gt;gcm256.iv, iiv + EVP_GCM_TLS_FIXED_IV_LEN,
-                TLS_CIPHER_AES_GCM_256_IV_SIZE);
+               TLS_CIPHER_AES_GCM_256_IV_SIZE);
         memcpy(crypto_info-&gt;gcm256.salt, iiv, TLS_CIPHER_AES_GCM_256_SALT_SIZE);
         memcpy(crypto_info-&gt;gcm256.key, key, EVP_CIPHER_get_key_length(c));
         memcpy(crypto_info-&gt;gcm256.rec_seq, rl_sequence,
-                TLS_CIPHER_AES_GCM_256_REC_SEQ_SIZE);
+               TLS_CIPHER_AES_GCM_256_REC_SEQ_SIZE);
         if (rec_seq != NULL)
             *rec_seq = crypto_info-&gt;gcm256.rec_seq;
         return 1;
@@ -210,11 +210,11 @@ int ktls_configure_crypto(const SSL *s, const EVP_CIPHER *c, EVP_CIPHER_CTX *dd,
         crypto_info-&gt;ccm128.info.version = s-&gt;version;
         crypto_info-&gt;tls_crypto_info_len = sizeof(crypto_info-&gt;ccm128);
         memcpy(crypto_info-&gt;ccm128.iv, iiv + EVP_CCM_TLS_FIXED_IV_LEN,
-                TLS_CIPHER_AES_CCM_128_IV_SIZE);
+               TLS_CIPHER_AES_CCM_128_IV_SIZE);
         memcpy(crypto_info-&gt;ccm128.salt, iiv, TLS_CIPHER_AES_CCM_128_SALT_SIZE);
         memcpy(crypto_info-&gt;ccm128.key, key, EVP_CIPHER_get_key_length(c));
         memcpy(crypto_info-&gt;ccm128.rec_seq, rl_sequence,
-                TLS_CIPHER_AES_CCM_128_REC_SEQ_SIZE);
+               TLS_CIPHER_AES_CCM_128_REC_SEQ_SIZE);
         if (rec_seq != NULL)
             *rec_seq = crypto_info-&gt;ccm128.rec_seq;
         return 1;
@@ -225,11 +225,11 @@ int ktls_configure_crypto(const SSL *s, const EVP_CIPHER *c, EVP_CIPHER_CTX *dd,
         crypto_info-&gt;chacha20poly1305.info.version = s-&gt;version;
         crypto_info-&gt;tls_crypto_info_len = sizeof(crypto_info-&gt;chacha20poly1305);
         memcpy(crypto_info-&gt;chacha20poly1305.iv, iiv,
-		TLS_CIPHER_CHACHA20_POLY1305_IV_SIZE);
+               TLS_CIPHER_CHACHA20_POLY1305_IV_SIZE);
         memcpy(crypto_info-&gt;chacha20poly1305.key, key,
                EVP_CIPHER_get_key_length(c));
         memcpy(crypto_info-&gt;chacha20poly1305.rec_seq, rl_sequence,
-                TLS_CIPHER_CHACHA20_POLY1305_REC_SEQ_SIZE);
+               TLS_CIPHER_CHACHA20_POLY1305_REC_SEQ_SIZE);
         if (rec_seq != NULL)
             *rec_seq = crypto_info-&gt;chacha20poly1305.rec_seq;
         return 1;
diff --git a/ssl/record/rec_layer_s3.c b/ssl/record/rec_layer_s3.c
index aacd5694fc..28e02e642c 100644
--- a/ssl/record/rec_layer_s3.c
+++ b/ssl/record/rec_layer_s3.c
@@ -1203,13 +1203,13 @@ int ssl3_write_pending(SSL *s, int type, const unsigned char *buf, size_t len,
             i = -1;
         }
 
-	/*
-	 * When an empty fragment is sent on a connection using KTLS,
-	 * it is sent as a write of zero bytes.  If this zero byte
-	 * write succeeds, i will be 0 rather than a non-zero value.
-	 * Treat i == 0 as success rather than an error for zero byte
-	 * writes to permit this case.
-	 */
+        /*
+         * When an empty fragment is sent on a connection using KTLS,
+         * it is sent as a write of zero bytes.  If this zero byte
+         * write succeeds, i will be 0 rather than a non-zero value.
+         * Treat i == 0 as success rather than an error for zero byte
+         * writes to permit this case.
+         */
         if (i &gt;= 0 &amp;&amp; tmpwrit == SSL3_BUFFER_get_left(&amp;wb[currbuf])) {
             SSL3_BUFFER_set_left(&amp;wb[currbuf], 0);
             SSL3_BUFFER_add_offset(&amp;wb[currbuf], tmpwrit);
diff --git a/ssl/statem/extensions.c b/ssl/statem/extensions.c
index f58111c95c..bc437be26a 100644
--- a/ssl/statem/extensions.c
+++ b/ssl/statem/extensions.c
@@ -953,7 +953,7 @@ static int final_server_name(SSL *s, unsigned int context, int sent)
      * exceed sess_accept (zero) for the new context.
      */
     if (SSL_IS_FIRST_HANDSHAKE(s) &amp;&amp; s-&gt;ctx != s-&gt;session_ctx
-		    &amp;&amp; s-&gt;hello_retry_request == SSL_HRR_NONE) {
+            &amp;&amp; s-&gt;hello_retry_request == SSL_HRR_NONE) {
         tsan_counter(&amp;s-&gt;ctx-&gt;stats.sess_accept);
         tsan_decr(&amp;s-&gt;session_ctx-&gt;stats.sess_accept);
     }
diff --git a/ssl/t1_lib.c b/ssl/t1_lib.c
index 2ee97c2ae6..3579202c22 100644
--- a/ssl/t1_lib.c
+++ b/ssl/t1_lib.c
@@ -1431,7 +1431,7 @@ static int sigalg_security_bits(SSL_CTX *ctx, const SIGALG_LOOKUP *lu)
          * SHA1 at 2^63.4 and MD5+SHA1 at 2^67.2
          * <A HREF="https://documents.epfl.ch/users/l/le/lenstra/public/papers/lat.pdf">https://documents.epfl.ch/users/l/le/lenstra/public/papers/lat.pdf</A>
          * puts a chosen-prefix attack for MD5 at 2^39.
-	 */
+         */
         if (md_type == NID_sha1)
             secbits = 64;
         else if (md_type == NID_md5_sha1)
diff --git a/test/recipes/15-test_rsa.t b/test/recipes/15-test_rsa.t
index abcdb0490c..089986f0d8 100644
--- a/test/recipes/15-test_rsa.t
+++ b/test/recipes/15-test_rsa.t
@@ -34,14 +34,14 @@ sub run_rsa_tests {
 
      SKIP: {
          skip &quot;Skipping $cmd conversion test&quot;, 3
-	     if disabled(&quot;rsa&quot;);
+             if disabled(&quot;rsa&quot;);
 
          subtest &quot;$cmd conversions -- private key&quot; =&gt; sub {
-	     tconversion( -type =&gt; $cmd, -prefix =&gt; &quot;$cmd-priv&quot;,
+             tconversion( -type =&gt; $cmd, -prefix =&gt; &quot;$cmd-priv&quot;,
                           -in =&gt; srctop_file(&quot;test&quot;, &quot;testrsa.pem&quot;) );
          };
          subtest &quot;$cmd conversions -- private key PKCS#8&quot; =&gt; sub {
-	     tconversion( -type =&gt; $cmd, -prefix =&gt; &quot;$cmd-pkcs8&quot;,
+             tconversion( -type =&gt; $cmd, -prefix =&gt; &quot;$cmd-pkcs8&quot;,
                           -in =&gt; srctop_file(&quot;test&quot;, &quot;testrsa.pem&quot;),
                           -args =&gt; [&quot;pkey&quot;] );
          };
@@ -49,10 +49,10 @@ sub run_rsa_tests {
 
      SKIP: {
          skip &quot;Skipping msblob conversion test&quot;, 1
-	     if disabled($cmd) || $cmd eq 'pkey';
+             if disabled($cmd) || $cmd eq 'pkey';
 
          subtest &quot;$cmd conversions -- public key&quot; =&gt; sub {
-	     tconversion( -type =&gt; 'msb', -prefix =&gt; &quot;$cmd-msb-pub&quot;,
+             tconversion( -type =&gt; 'msb', -prefix =&gt; &quot;$cmd-msb-pub&quot;,
                           -in =&gt; srctop_file(&quot;test&quot;, &quot;testrsapub.pem&quot;),
                           -args =&gt; [&quot;rsa&quot;, &quot;-pubin&quot;, &quot;-pubout&quot;] );
          };
diff --git a/test/recipes/20-test_enc.t b/test/recipes/20-test_enc.t
index 32a62ef2fd..9a38aed4d0 100644
--- a/test/recipes/20-test_enc.t
+++ b/test/recipes/20-test_enc.t
@@ -52,24 +52,24 @@ plan tests =&gt; 2 + (scalar @ciphers)*2;
      }
 
      foreach my $c (@ciphers) {
-	 my %variant = (&quot;$c&quot; =&gt; [],
-			&quot;$c base64&quot; =&gt; [ &quot;-a&quot; ]);
+         my %variant = (&quot;$c&quot; =&gt; [],
+                        &quot;$c base64&quot; =&gt; [ &quot;-a&quot; ]);
 
-	 foreach my $t (sort keys %variant) {
-	     my $cipherfile = &quot;$test.$c.cipher&quot;;
-	     my $clearfile = &quot;$test.$c.clear&quot;;
-	     my @e = ( &quot;$c&quot;, &quot;-bufsize&quot;, &quot;113&quot;, @{$variant{$t}}, &quot;-e&quot;, &quot;-k&quot;, &quot;test&quot; );
-	     my @d = ( &quot;$c&quot;, &quot;-bufsize&quot;, &quot;157&quot;, @{$variant{$t}}, &quot;-d&quot;, &quot;-k&quot;, &quot;test&quot; );
-	     if ($c eq &quot;cat&quot;) {
-		 $cipherfile = &quot;$test.cipher&quot;;
-		 $clearfile = &quot;$test.clear&quot;;
-		 @e = ( &quot;enc&quot;, @{$variant{$t}}, &quot;-e&quot; );
-		 @d = ( &quot;enc&quot;, @{$variant{$t}}, &quot;-d&quot; );
-	     }
+         foreach my $t (sort keys %variant) {
+             my $cipherfile = &quot;$test.$c.cipher&quot;;
+             my $clearfile = &quot;$test.$c.clear&quot;;
+             my @e = ( &quot;$c&quot;, &quot;-bufsize&quot;, &quot;113&quot;, @{$variant{$t}}, &quot;-e&quot;, &quot;-k&quot;, &quot;test&quot; );
+             my @d = ( &quot;$c&quot;, &quot;-bufsize&quot;, &quot;157&quot;, @{$variant{$t}}, &quot;-d&quot;, &quot;-k&quot;, &quot;test&quot; );
+             if ($c eq &quot;cat&quot;) {
+                 $cipherfile = &quot;$test.cipher&quot;;
+                 $clearfile = &quot;$test.clear&quot;;
+                 @e = ( &quot;enc&quot;, @{$variant{$t}}, &quot;-e&quot; );
+                 @d = ( &quot;enc&quot;, @{$variant{$t}}, &quot;-d&quot; );
+             }
 
-	     ok(run(app([$cmd, @e, @prov, &quot;-in&quot;, $test, &quot;-out&quot;, $cipherfile]))
-		&amp;&amp; run(app([$cmd, @d, @prov, &quot;-in&quot;, $cipherfile, &quot;-out&quot;, $clearfile]))
-		&amp;&amp; compare_text($test,$clearfile) == 0, $t);
-	 }
+             ok(run(app([$cmd, @e, @prov, &quot;-in&quot;, $test, &quot;-out&quot;, $cipherfile]))
+                &amp;&amp; run(app([$cmd, @d, @prov, &quot;-in&quot;, $cipherfile, &quot;-out&quot;, $clearfile]))
+                &amp;&amp; compare_text($test,$clearfile) == 0, $t);
+         }
      }
 }
diff --git a/test/recipes/25-test_req.t b/test/recipes/25-test_req.t
index 9783fe3960..5781f26a9a 100644
--- a/test/recipes/25-test_req.t
+++ b/test/recipes/25-test_req.t
@@ -114,7 +114,7 @@ subtest &quot;generating certificate requests with RSA&quot; =&gt; sub {
                     &quot;-config&quot;, srctop_file(&quot;test&quot;, &quot;test.cnf&quot;),
                     &quot;-new&quot;, &quot;-out&quot;, &quot;testreq_withattrs_der.pem&quot;, &quot;-utf8&quot;,
                     &quot;-key&quot;, srctop_file(&quot;test&quot;, &quot;testrsa_withattrs.der&quot;),
-	            &quot;-keyform&quot;, &quot;DER&quot;])),
+                    &quot;-keyform&quot;, &quot;DER&quot;])),
            &quot;Generating request from a key with extra attributes - PEM&quot;);
 
         ok(run(app([&quot;openssl&quot;, &quot;req&quot;,
diff --git a/test/recipes/25-test_verify.t b/test/recipes/25-test_verify.t
index 269b2ba4aa..acb26f0afd 100644
--- a/test/recipes/25-test_verify.t
+++ b/test/recipes/25-test_verify.t
@@ -417,7 +417,7 @@ ok(verify(&quot;ee-ss-with-keyCertSign&quot;, &quot;&quot;, [&quot;ee-ss-with-keyCertSign&quot;], []),
 
 SKIP: {
     skip &quot;Ed25519 is not supported by this OpenSSL build&quot;, 6
-	      if disabled(&quot;ec&quot;);
+        if disabled(&quot;ec&quot;);
 
     # ED25519 certificate from draft-ietf-curdle-pkix-04
     ok(verify(&quot;ee-ed25519&quot;, &quot;&quot;, [&quot;root-ed25519&quot;], []),
diff --git a/test/recipes/25-test_verify_store.t b/test/recipes/25-test_verify_store.t
index d66dd9d48d..346396a628 100644
--- a/test/recipes/25-test_verify_store.t
+++ b/test/recipes/25-test_verify_store.t
@@ -25,7 +25,7 @@ my $CAkey = &quot;keyCA.ss&quot;;
 my $CAcert=&quot;certCA.ss&quot;;
 my $CAserial=&quot;certCA.srl&quot;;
 my $CAreq=&quot;reqCA.ss&quot;;
-my $CAreq2=&quot;req2CA.ss&quot;;	# temp
+my $CAreq2=&quot;req2CA.ss&quot;; # temp
 my $Ukey=&quot;keyU.ss&quot;;
 my $Ureq=&quot;reqU.ss&quot;;
 my $Ucert=&quot;certU.ss&quot;;
diff --git a/test/recipes/60-test_x509_check_cert_pkey.t b/test/recipes/60-test_x509_check_cert_pkey.t
index 0c8a567fe5..6e7112b4cf 100644
--- a/test/recipes/60-test_x509_check_cert_pkey.t
+++ b/test/recipes/60-test_x509_check_cert_pkey.t
@@ -37,8 +37,8 @@ SKIP: {
     skip &quot;DSA disabled&quot;, 1, if disabled(&quot;dsa&quot;);
     # dsa
     ok(run(test([&quot;x509_check_cert_pkey_test&quot;,
-		 src_file(&quot;server-dsa-cert.pem&quot;),
-		 src_file(&quot;server-dsa-key.pem&quot;), &quot;cert&quot;, &quot;ok&quot;])));
+                 src_file(&quot;server-dsa-cert.pem&quot;),
+                 src_file(&quot;server-dsa-key.pem&quot;), &quot;cert&quot;, &quot;ok&quot;])));
 }
 # ecc
 SKIP: {
diff --git a/test/recipes/70-test_sslsessiontick.t b/test/recipes/70-test_sslsessiontick.t
index 648cb7590c..ce112fd51f 100644
--- a/test/recipes/70-test_sslsessiontick.t
+++ b/test/recipes/70-test_sslsessiontick.t
@@ -221,38 +221,38 @@ sub checkmessages($$$$$$)
 
     subtest $testname =&gt; sub {
 
-	foreach my $message (@{$proxy-&gt;message_list}) {
-	    if ($message-&gt;mt == TLSProxy::Message::MT_CLIENT_HELLO
+        foreach my $message (@{$proxy-&gt;message_list}) {
+            if ($message-&gt;mt == TLSProxy::Message::MT_CLIENT_HELLO
                 || $message-&gt;mt == TLSProxy::Message::MT_SERVER_HELLO) {
-		#Get the extensions data
-		my %extensions = %{$message-&gt;extension_data};
-		if (defined
+                #Get the extensions data
+                my %extensions = %{$message-&gt;extension_data};
+                if (defined
                     $extensions{TLSProxy::Message::EXT_SESSION_TICKET}) {
-		    if ($message-&gt;mt == TLSProxy::Message::MT_CLIENT_HELLO) {
-			$chellotickext = 1;
-		    } else {
-			$shellotickext = 1;
-		    }
-		}
-	    } elsif ($message-&gt;mt == TLSProxy::Message::MT_CERTIFICATE) {
-		#Must be doing a full handshake
-		$fullhand = 1;
-	    } elsif ($message-&gt;mt == TLSProxy::Message::MT_NEW_SESSION_TICKET) {
-		$ticketseen = 1;
-	    }
-	}
-
-	plan tests =&gt; 5;
-
-	ok(TLSProxy::Message-&gt;success, &quot;Handshake&quot;);
-	ok(($testch &amp;&amp; $chellotickext) || (!$testch &amp;&amp; !$chellotickext),
-	   &quot;ClientHello extension Session Ticket check&quot;);
-	ok(($testsh &amp;&amp; $shellotickext) || (!$testsh &amp;&amp; !$shellotickext),
-	   &quot;ServerHello extension Session Ticket check&quot;);
-	ok(($testtickseen &amp;&amp; $ticketseen) || (!$testtickseen &amp;&amp; !$ticketseen),
-	   &quot;Session Ticket message presence check&quot;);
-	ok(($testhand &amp;&amp; $fullhand) || (!$testhand &amp;&amp; !$fullhand),
-	   &quot;Session Ticket full handshake check&quot;);
+                    if ($message-&gt;mt == TLSProxy::Message::MT_CLIENT_HELLO) {
+                        $chellotickext = 1;
+                    } else {
+                        $shellotickext = 1;
+                    }
+                }
+            } elsif ($message-&gt;mt == TLSProxy::Message::MT_CERTIFICATE) {
+                #Must be doing a full handshake
+                $fullhand = 1;
+            } elsif ($message-&gt;mt == TLSProxy::Message::MT_NEW_SESSION_TICKET) {
+                $ticketseen = 1;
+            }
+        }
+
+        plan tests =&gt; 5;
+
+        ok(TLSProxy::Message-&gt;success, &quot;Handshake&quot;);
+        ok(($testch &amp;&amp; $chellotickext) || (!$testch &amp;&amp; !$chellotickext),
+           &quot;ClientHello extension Session Ticket check&quot;);
+        ok(($testsh &amp;&amp; $shellotickext) || (!$testsh &amp;&amp; !$shellotickext),
+           &quot;ServerHello extension Session Ticket check&quot;);
+        ok(($testtickseen &amp;&amp; $ticketseen) || (!$testtickseen &amp;&amp; !$ticketseen),
+           &quot;Session Ticket message presence check&quot;);
+        ok(($testhand &amp;&amp; $fullhand) || (!$testhand &amp;&amp; !$fullhand),
+           &quot;Session Ticket full handshake check&quot;);
     }
 }
 
diff --git a/test/recipes/80-test_ca.t b/test/recipes/80-test_ca.t
index dce9c64120..c1e09032de 100644
--- a/test/recipes/80-test_ca.t
+++ b/test/recipes/80-test_ca.t
@@ -32,20 +32,20 @@ plan tests =&gt; 15;
      my $cakey = srctop_file(&quot;test&quot;, &quot;certs&quot;, &quot;ca-key.pem&quot;);
      $ENV{OPENSSL_CONFIG} = '-config ' . $cnf;
      skip &quot;failed creating CA structure&quot;, 4
-	 if !ok(run(perlapp([&quot;CA.pl&quot;,&quot;-newca&quot;,
+         if !ok(run(perlapp([&quot;CA.pl&quot;,&quot;-newca&quot;,
                              &quot;-extra-req&quot;, &quot;-key $cakey&quot;], stdin =&gt; undef)),
-		'creating CA structure');
+                'creating CA structure');
 
      my $eekey = srctop_file(&quot;test&quot;, &quot;certs&quot;, &quot;ee-key.pem&quot;);
      $ENV{OPENSSL_CONFIG} = '-config ' . $cnf;
      skip &quot;failed creating new certificate request&quot;, 3
-	 if !ok(run(perlapp([&quot;CA.pl&quot;,&quot;-newreq&quot;,
+         if !ok(run(perlapp([&quot;CA.pl&quot;,&quot;-newreq&quot;,
                              '-extra-req', &quot;-outform DER -section userreq -key $eekey&quot;])),
-		'creating certificate request');
+                'creating certificate request');
      $ENV{OPENSSL_CONFIG} = '-rand_serial -inform DER -config '.$std_openssl_cnf;
      skip &quot;failed to sign certificate request&quot;, 2
-	 if !is(yes(cmdstr(perlapp([&quot;CA.pl&quot;, &quot;-sign&quot;]))), 0,
-		'signing certificate request');
+         if !is(yes(cmdstr(perlapp([&quot;CA.pl&quot;, &quot;-sign&quot;]))), 0,
+                'signing certificate request');
 
      ok(run(perlapp([&quot;CA.pl&quot;, &quot;-verify&quot;, &quot;newcert.pem&quot;])),
         'verifying new certificate');
@@ -61,7 +61,7 @@ plan tests =&gt; 15;
 
 SKIP: {
     skip &quot;SM2 is not supported by this OpenSSL build&quot;, 1
-	      if disabled(&quot;sm2&quot;);
+        if disabled(&quot;sm2&quot;);
 
     is(yes(cmdstr(app([&quot;openssl&quot;, &quot;ca&quot;, &quot;-config&quot;,
                        $cnf,
diff --git a/test/recipes/80-test_ocsp.t b/test/recipes/80-test_ocsp.t
index 3727c360ba..bf00386a0f 100644
--- a/test/recipes/80-test_ocsp.t
+++ b/test/recipes/80-test_ocsp.t
@@ -55,143 +55,143 @@ subtest &quot;=== VALID OCSP RESPONSES ===&quot; =&gt; sub {
     plan tests =&gt; 7;
 
     test_ocsp(&quot;NON-DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;ND1.ors&quot;, &quot;ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 0);
+              &quot;ND1.ors&quot;, &quot;ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 0);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;ND2.ors&quot;, &quot;ND2_Issuer_Root.pem&quot;, &quot;&quot;, 0);
+              &quot;ND2.ors&quot;, &quot;ND2_Issuer_Root.pem&quot;, &quot;&quot;, 0);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;ND3.ors&quot;, &quot;ND3_Issuer_Root.pem&quot;, &quot;&quot;, 0);
+              &quot;ND3.ors&quot;, &quot;ND3_Issuer_Root.pem&quot;, &quot;&quot;, 0);
     test_ocsp(&quot;NON-DELEGATED; 3-level CA hierarchy&quot;,
-	      &quot;ND1.ors&quot;, &quot;ND1_Cross_Root.pem&quot;, &quot;ND1_Issuer_ICA-Cross.pem&quot;, 0);
+              &quot;ND1.ors&quot;, &quot;ND1_Cross_Root.pem&quot;, &quot;ND1_Issuer_ICA-Cross.pem&quot;, 0);
     test_ocsp(&quot;DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;D1.ors&quot;, &quot;D1_Issuer_ICA.pem&quot;, &quot;&quot;, 0);
+              &quot;D1.ors&quot;, &quot;D1_Issuer_ICA.pem&quot;, &quot;&quot;, 0);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;D2.ors&quot;, &quot;D2_Issuer_Root.pem&quot;, &quot;&quot;, 0);
+              &quot;D2.ors&quot;, &quot;D2_Issuer_Root.pem&quot;, &quot;&quot;, 0);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;D3.ors&quot;, &quot;D3_Issuer_Root.pem&quot;, &quot;&quot;, 0);
+              &quot;D3.ors&quot;, &quot;D3_Issuer_Root.pem&quot;, &quot;&quot;, 0);
 };
 
 subtest &quot;=== INVALID SIGNATURE on the OCSP RESPONSE ===&quot; =&gt; sub {
     plan tests =&gt; 6;
 
     test_ocsp(&quot;NON-DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;ISOP_ND1.ors&quot;, &quot;ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
+              &quot;ISOP_ND1.ors&quot;, &quot;ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;ISOP_ND2.ors&quot;, &quot;ND2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;ISOP_ND2.ors&quot;, &quot;ND2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;ISOP_ND3.ors&quot;, &quot;ND3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;ISOP_ND3.ors&quot;, &quot;ND3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;ISOP_D1.ors&quot;, &quot;D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
+              &quot;ISOP_D1.ors&quot;, &quot;D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;ISOP_D2.ors&quot;, &quot;D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;ISOP_D2.ors&quot;, &quot;D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;ISOP_D3.ors&quot;, &quot;D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;ISOP_D3.ors&quot;, &quot;D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
 };
 
 subtest &quot;=== WRONG RESPONDERID in the OCSP RESPONSE ===&quot; =&gt; sub {
     plan tests =&gt; 6;
 
     test_ocsp(&quot;NON-DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;WRID_ND1.ors&quot;, &quot;ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
+              &quot;WRID_ND1.ors&quot;, &quot;ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;WRID_ND2.ors&quot;, &quot;ND2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;WRID_ND2.ors&quot;, &quot;ND2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;WRID_ND3.ors&quot;, &quot;ND3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;WRID_ND3.ors&quot;, &quot;ND3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;WRID_D1.ors&quot;, &quot;D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
+              &quot;WRID_D1.ors&quot;, &quot;D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;WRID_D2.ors&quot;, &quot;D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;WRID_D2.ors&quot;, &quot;D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;WRID_D3.ors&quot;, &quot;D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;WRID_D3.ors&quot;, &quot;D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
 };
 
 subtest &quot;=== WRONG ISSUERNAMEHASH in the OCSP RESPONSE ===&quot; =&gt; sub {
     plan tests =&gt; 6;
 
     test_ocsp(&quot;NON-DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;WINH_ND1.ors&quot;, &quot;ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
+              &quot;WINH_ND1.ors&quot;, &quot;ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;WINH_ND2.ors&quot;, &quot;ND2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;WINH_ND2.ors&quot;, &quot;ND2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;WINH_ND3.ors&quot;, &quot;ND3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;WINH_ND3.ors&quot;, &quot;ND3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;WINH_D1.ors&quot;, &quot;D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
+              &quot;WINH_D1.ors&quot;, &quot;D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;WINH_D2.ors&quot;, &quot;D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;WINH_D2.ors&quot;, &quot;D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;WINH_D3.ors&quot;, &quot;D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;WINH_D3.ors&quot;, &quot;D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
 };
 
 subtest &quot;=== WRONG ISSUERKEYHASH in the OCSP RESPONSE ===&quot; =&gt; sub {
     plan tests =&gt; 6;
 
     test_ocsp(&quot;NON-DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;WIKH_ND1.ors&quot;, &quot;ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
+              &quot;WIKH_ND1.ors&quot;, &quot;ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;WIKH_ND2.ors&quot;, &quot;ND2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;WIKH_ND2.ors&quot;, &quot;ND2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;WIKH_ND3.ors&quot;, &quot;ND3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;WIKH_ND3.ors&quot;, &quot;ND3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;WIKH_D1.ors&quot;, &quot;D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
+              &quot;WIKH_D1.ors&quot;, &quot;D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;WIKH_D2.ors&quot;, &quot;D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;WIKH_D2.ors&quot;, &quot;D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;WIKH_D3.ors&quot;, &quot;D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;WIKH_D3.ors&quot;, &quot;D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
 };
 
 subtest &quot;=== WRONG KEY in the DELEGATED OCSP SIGNING CERTIFICATE ===&quot; =&gt; sub {
     plan tests =&gt; 3;
 
     test_ocsp(&quot;DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;WKDOSC_D1.ors&quot;, &quot;D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
+              &quot;WKDOSC_D1.ors&quot;, &quot;D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;WKDOSC_D2.ors&quot;, &quot;D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;WKDOSC_D2.ors&quot;, &quot;D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;WKDOSC_D3.ors&quot;, &quot;D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;WKDOSC_D3.ors&quot;, &quot;D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
 };
 
 subtest &quot;=== INVALID SIGNATURE on the DELEGATED OCSP SIGNING CERTIFICATE ===&quot; =&gt; sub {
     plan tests =&gt; 3;
 
     test_ocsp(&quot;DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;ISDOSC_D1.ors&quot;, &quot;D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
+              &quot;ISDOSC_D1.ors&quot;, &quot;D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;ISDOSC_D2.ors&quot;, &quot;D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;ISDOSC_D2.ors&quot;, &quot;D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;ISDOSC_D3.ors&quot;, &quot;D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;ISDOSC_D3.ors&quot;, &quot;D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
 };
 
 subtest &quot;=== WRONG SUBJECT NAME in the ISSUER CERTIFICATE ===&quot; =&gt; sub {
     plan tests =&gt; 6;
 
     test_ocsp(&quot;NON-DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;ND1.ors&quot;, &quot;WSNIC_ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
+              &quot;ND1.ors&quot;, &quot;WSNIC_ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;ND2.ors&quot;, &quot;WSNIC_ND2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;ND2.ors&quot;, &quot;WSNIC_ND2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;ND3.ors&quot;, &quot;WSNIC_ND3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;ND3.ors&quot;, &quot;WSNIC_ND3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;D1.ors&quot;, &quot;WSNIC_D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
+              &quot;D1.ors&quot;, &quot;WSNIC_D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;D2.ors&quot;, &quot;WSNIC_D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;D2.ors&quot;, &quot;WSNIC_D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;D3.ors&quot;, &quot;WSNIC_D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;D3.ors&quot;, &quot;WSNIC_D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
 };
 
 subtest &quot;=== WRONG KEY in the ISSUER CERTIFICATE ===&quot; =&gt; sub {
     plan tests =&gt; 6;
 
     test_ocsp(&quot;NON-DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;ND1.ors&quot;, &quot;WKIC_ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
+              &quot;ND1.ors&quot;, &quot;WKIC_ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;ND2.ors&quot;, &quot;WKIC_ND2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;ND2.ors&quot;, &quot;WKIC_ND2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;ND3.ors&quot;, &quot;WKIC_ND3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;ND3.ors&quot;, &quot;WKIC_ND3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;D1.ors&quot;, &quot;WKIC_D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
+              &quot;D1.ors&quot;, &quot;WKIC_D1_Issuer_ICA.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;D2.ors&quot;, &quot;WKIC_D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;D2.ors&quot;, &quot;WKIC_D2_Issuer_Root.pem&quot;, &quot;&quot;, 1);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;D3.ors&quot;, &quot;WKIC_D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
+              &quot;D3.ors&quot;, &quot;WKIC_D3_Issuer_Root.pem&quot;, &quot;&quot;, 1);
 };
 
 subtest &quot;=== INVALID SIGNATURE on the ISSUER CERTIFICATE ===&quot; =&gt; sub {
@@ -199,17 +199,17 @@ subtest &quot;=== INVALID SIGNATURE on the ISSUER CERTIFICATE ===&quot; =&gt; sub {
 
     # Expect success, because we're explicitly trusting the issuer certificate.
     test_ocsp(&quot;NON-DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;ND1.ors&quot;, &quot;ISIC_ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 0);
+              &quot;ND1.ors&quot;, &quot;ISIC_ND1_Issuer_ICA.pem&quot;, &quot;&quot;, 0);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;ND2.ors&quot;, &quot;ISIC_ND2_Issuer_Root.pem&quot;, &quot;&quot;, 0);
+              &quot;ND2.ors&quot;, &quot;ISIC_ND2_Issuer_Root.pem&quot;, &quot;&quot;, 0);
     test_ocsp(&quot;NON-DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;ND3.ors&quot;, &quot;ISIC_ND3_Issuer_Root.pem&quot;, &quot;&quot;, 0);
+              &quot;ND3.ors&quot;, &quot;ISIC_ND3_Issuer_Root.pem&quot;, &quot;&quot;, 0);
     test_ocsp(&quot;DELEGATED; Intermediate CA -&gt; EE&quot;,
-	      &quot;D1.ors&quot;, &quot;ISIC_D1_Issuer_ICA.pem&quot;, &quot;&quot;, 0);
+              &quot;D1.ors&quot;, &quot;ISIC_D1_Issuer_ICA.pem&quot;, &quot;&quot;, 0);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; Intermediate CA&quot;,
-	      &quot;D2.ors&quot;, &quot;ISIC_D2_Issuer_Root.pem&quot;, &quot;&quot;, 0);
+              &quot;D2.ors&quot;, &quot;ISIC_D2_Issuer_Root.pem&quot;, &quot;&quot;, 0);
     test_ocsp(&quot;DELEGATED; Root CA -&gt; EE&quot;,
-	      &quot;D3.ors&quot;, &quot;ISIC_D3_Issuer_Root.pem&quot;, &quot;&quot;, 0);
+              &quot;D3.ors&quot;, &quot;ISIC_D3_Issuer_Root.pem&quot;, &quot;&quot;, 0);
 };
 
 subtest &quot;=== OCSP API TESTS===&quot; =&gt; sub {
diff --git a/test/recipes/80-test_ssl_old.t b/test/recipes/80-test_ssl_old.t
index b71bc01655..a69f53b606 100644
--- a/test/recipes/80-test_ssl_old.t
+++ b/test/recipes/80-test_ssl_old.t
@@ -50,7 +50,7 @@ my $CAkey = srctop_file(&quot;test&quot;, &quot;certs&quot;, &quot;ca-key.pem&quot;); # &quot;keyCA.ss&quot;
 my $CAcert=&quot;certCA.ss&quot;;
 my $CAserial=&quot;certCA.srl&quot;;
 my $CAreq=&quot;reqCA.ss&quot;;
-my $CAreq2=&quot;req2CA.ss&quot;;	# temp
+my $CAreq2=&quot;req2CA.ss&quot;; # temp
 my $Ukey = srctop_file(&quot;test&quot;, &quot;certs&quot;, &quot;ee-key.pem&quot;); # &quot;keyU.ss&quot;;
 my $Ureq=&quot;reqU.ss&quot;;
 my $Ucert=&quot;certU.ss&quot;;
@@ -85,13 +85,13 @@ plan tests =&gt;
 
 subtest 'test_ss' =&gt; sub {
     if (testss()) {
-	open OUT, &quot;&gt;&quot;, &quot;intP1.ss&quot;;
-	copy($CAcert, \*OUT); copy($Ucert, \*OUT);
-	close OUT;
+        open OUT, &quot;&gt;&quot;, &quot;intP1.ss&quot;;
+        copy($CAcert, \*OUT); copy($Ucert, \*OUT);
+        close OUT;
 
-	open OUT, &quot;&gt;&quot;, &quot;intP2.ss&quot;;
-	copy($CAcert, \*OUT); copy($Ucert, \*OUT); copy($P1cert, \*OUT);
-	close OUT;
+        open OUT, &quot;&gt;&quot;, &quot;intP2.ss&quot;;
+        copy($CAcert, \*OUT); copy($Ucert, \*OUT); copy($P1cert, \*OUT);
+        close OUT;
     }
 };
 
@@ -115,68 +115,68 @@ sub testss {
     my $dsaparams = data_file(&quot;dsa2048.pem&quot;);
     my @req_new;
     if ($no_rsa) {
-	@req_new = @req_dsa;
+        @req_new = @req_dsa;
     } else {
-	@req_new = (&quot;-new&quot;);
+        @req_new = (&quot;-new&quot;);
     }
 
     plan tests =&gt; 17;
 
   SKIP: {
       skip 'failure', 16 unless
-	  ok(run(app([@reqcmd, &quot;-config&quot;, $cnf,
-		      &quot;-out&quot;, $CAreq, &quot;-key&quot;, $CAkey,
-		      @req_new])),
-	     'make cert request');
+          ok(run(app([@reqcmd, &quot;-config&quot;, $cnf,
+                      &quot;-out&quot;, $CAreq, &quot;-key&quot;, $CAkey,
+                      @req_new])),
+             'make cert request');
 
       skip 'failure', 15 unless
-	  ok(run(app([@x509cmd, &quot;-CAcreateserial&quot;, &quot;-in&quot;, $CAreq, &quot;-days&quot;, &quot;30&quot;,
-		      &quot;-req&quot;, &quot;-out&quot;, $CAcert, &quot;-signkey&quot;, $CAkey,
-		      &quot;-extfile&quot;, $cnf, &quot;-extensions&quot;, &quot;v3_ca&quot;],
-		     stdout =&gt; &quot;err.ss&quot;)),
-	     'convert request into self-signed cert');
+          ok(run(app([@x509cmd, &quot;-CAcreateserial&quot;, &quot;-in&quot;, $CAreq, &quot;-days&quot;, &quot;30&quot;,
+                      &quot;-req&quot;, &quot;-out&quot;, $CAcert, &quot;-signkey&quot;, $CAkey,
+                      &quot;-extfile&quot;, $cnf, &quot;-extensions&quot;, &quot;v3_ca&quot;],
+                     stdout =&gt; &quot;err.ss&quot;)),
+             'convert request into self-signed cert');
 
       skip 'failure', 14 unless
-	  ok(run(app([@x509cmd, &quot;-in&quot;, $CAcert,
-		      &quot;-x509toreq&quot;, &quot;-signkey&quot;, $CAkey, &quot;-out&quot;, $CAreq2],
-		     stdout =&gt; &quot;err.ss&quot;)),
-	     'convert cert into a cert request');
+          ok(run(app([@x509cmd, &quot;-in&quot;, $CAcert,
+                      &quot;-x509toreq&quot;, &quot;-signkey&quot;, $CAkey, &quot;-out&quot;, $CAreq2],
+                     stdout =&gt; &quot;err.ss&quot;)),
+             'convert cert into a cert request');
 
       skip 'failure', 13 unless
-	  ok(run(app([@reqcmd, &quot;-config&quot;, $dummycnf,
-		      &quot;-verify&quot;, &quot;-in&quot;, $CAreq, &quot;-noout&quot;])),
-	     'verify request 1');
+          ok(run(app([@reqcmd, &quot;-config&quot;, $dummycnf,
+                      &quot;-verify&quot;, &quot;-in&quot;, $CAreq, &quot;-noout&quot;])),
+             'verify request 1');
 
 
       skip 'failure', 12 unless
-	  ok(run(app([@reqcmd, &quot;-config&quot;, $dummycnf,
-		      &quot;-verify&quot;, &quot;-in&quot;, $CAreq2, &quot;-noout&quot;])),
-	     'verify request 2');
+          ok(run(app([@reqcmd, &quot;-config&quot;, $dummycnf,
+                      &quot;-verify&quot;, &quot;-in&quot;, $CAreq2, &quot;-noout&quot;])),
+             'verify request 2');
 
       skip 'failure', 11 unless
-	  ok(run(app([@verifycmd, &quot;-CAfile&quot;, $CAcert, $CAcert])),
-	     'verify signature');
+          ok(run(app([@verifycmd, &quot;-CAfile&quot;, $CAcert, $CAcert])),
+             'verify signature');
 
       skip 'failure', 10 unless
-	  ok(run(app([@reqcmd, &quot;-config&quot;, $cnf, &quot;-section&quot;, &quot;userreq&quot;,
-		      &quot;-out&quot;, $Ureq, &quot;-key&quot;, $Ukey, @req_new],
-		     stdout =&gt; &quot;err.ss&quot;)),
-	     'make a user cert request');
+          ok(run(app([@reqcmd, &quot;-config&quot;, $cnf, &quot;-section&quot;, &quot;userreq&quot;,
+                      &quot;-out&quot;, $Ureq, &quot;-key&quot;, $Ukey, @req_new],
+                     stdout =&gt; &quot;err.ss&quot;)),
+             'make a user cert request');
 
       skip 'failure', 9 unless
-	  ok(run(app([@x509cmd, &quot;-CAcreateserial&quot;, &quot;-in&quot;, $Ureq, &quot;-days&quot;, &quot;30&quot;,
-		      &quot;-req&quot;, &quot;-out&quot;, $Ucert,
-		      &quot;-CA&quot;, $CAcert, &quot;-CAkey&quot;, $CAkey, &quot;-CAserial&quot;, $CAserial,
-		      &quot;-extfile&quot;, $cnf, &quot;-extensions&quot;, &quot;v3_ee&quot;],
-		     stdout =&gt; &quot;err.ss&quot;))
-	     &amp;&amp; run(app([@verifycmd, &quot;-CAfile&quot;, $CAcert, $Ucert])),
-	     'sign user cert request');
+          ok(run(app([@x509cmd, &quot;-CAcreateserial&quot;, &quot;-in&quot;, $Ureq, &quot;-days&quot;, &quot;30&quot;,
+                      &quot;-req&quot;, &quot;-out&quot;, $Ucert,
+                      &quot;-CA&quot;, $CAcert, &quot;-CAkey&quot;, $CAkey, &quot;-CAserial&quot;, $CAserial,
+                      &quot;-extfile&quot;, $cnf, &quot;-extensions&quot;, &quot;v3_ee&quot;],
+                     stdout =&gt; &quot;err.ss&quot;))
+             &amp;&amp; run(app([@verifycmd, &quot;-CAfile&quot;, $CAcert, $Ucert])),
+             'sign user cert request');
 
       skip 'failure', 8 unless
-	  ok(run(app([@x509cmd,
-		      &quot;-subject&quot;, &quot;-issuer&quot;, &quot;-startdate&quot;, &quot;-enddate&quot;,
-		      &quot;-noout&quot;, &quot;-in&quot;, $Ucert])),
-	     'Certificate details');
+          ok(run(app([@x509cmd,
+                      &quot;-subject&quot;, &quot;-issuer&quot;, &quot;-startdate&quot;, &quot;-enddate&quot;,
+                      &quot;-noout&quot;, &quot;-in&quot;, $Ucert])),
+             'Certificate details');
 
       skip 'failure', 7 unless
           subtest 'DSA certificate creation' =&gt; sub {
@@ -270,54 +270,54 @@ sub testss {
       };
 
       skip 'failure', 5 unless
-	  ok(run(app([@reqcmd, &quot;-config&quot;, $proxycnf,
-		      &quot;-out&quot;, $P1req, &quot;-key&quot;, $P1key, @req_new],
-		     stdout =&gt; &quot;err.ss&quot;)),
-	     'make a proxy cert request');
+          ok(run(app([@reqcmd, &quot;-config&quot;, $proxycnf,
+                      &quot;-out&quot;, $P1req, &quot;-key&quot;, $P1key, @req_new],
+                     stdout =&gt; &quot;err.ss&quot;)),
+             'make a proxy cert request');
 
 
       skip 'failure', 4 unless
-	  ok(run(app([@x509cmd, &quot;-CAcreateserial&quot;, &quot;-in&quot;, $P1req, &quot;-days&quot;, &quot;30&quot;,
-		      &quot;-req&quot;, &quot;-out&quot;, $P1cert,
-		      &quot;-CA&quot;, $Ucert, &quot;-CAkey&quot;, $Ukey,
-		      &quot;-extfile&quot;, $proxycnf, &quot;-extensions&quot;, &quot;proxy&quot;],
-		     stdout =&gt; &quot;err.ss&quot;)),
-	     'sign proxy with user cert');
+          ok(run(app([@x509cmd, &quot;-CAcreateserial&quot;, &quot;-in&quot;, $P1req, &quot;-days&quot;, &quot;30&quot;,
+                      &quot;-req&quot;, &quot;-out&quot;, $P1cert,
+                      &quot;-CA&quot;, $Ucert, &quot;-CAkey&quot;, $Ukey,
+                      &quot;-extfile&quot;, $proxycnf, &quot;-extensions&quot;, &quot;proxy&quot;],
+                     stdout =&gt; &quot;err.ss&quot;)),
+             'sign proxy with user cert');
 
       copy($Ucert, $P1intermediate);
       run(app([@verifycmd, &quot;-CAfile&quot;, $CAcert,
-	       &quot;-untrusted&quot;, $P1intermediate, $P1cert]));
+               &quot;-untrusted&quot;, $P1intermediate, $P1cert]));
       ok(run(app([@x509cmd,
-		  &quot;-subject&quot;, &quot;-issuer&quot;, &quot;-startdate&quot;, &quot;-enddate&quot;,
-		  &quot;-noout&quot;, &quot;-in&quot;, $P1cert])),
-	 'Certificate details');
+                  &quot;-subject&quot;, &quot;-issuer&quot;, &quot;-startdate&quot;, &quot;-enddate&quot;,
+                  &quot;-noout&quot;, &quot;-in&quot;, $P1cert])),
+         'Certificate details');
 
       skip 'failure', 2 unless
-	  ok(run(app([@reqcmd, &quot;-config&quot;, $proxycnf, &quot;-section&quot;, &quot;proxy2_req&quot;,
-		      &quot;-out&quot;, $P2req, &quot;-key&quot;, $P2key,
-		      @req_new],
-		     stdout =&gt; &quot;err.ss&quot;)),
-	     'make another proxy cert request');
+          ok(run(app([@reqcmd, &quot;-config&quot;, $proxycnf, &quot;-section&quot;, &quot;proxy2_req&quot;,
+                      &quot;-out&quot;, $P2req, &quot;-key&quot;, $P2key,
+                      @req_new],
+                     stdout =&gt; &quot;err.ss&quot;)),
+             'make another proxy cert request');
 
 
       skip 'failure', 1 unless
-	  ok(run(app([@x509cmd, &quot;-CAcreateserial&quot;, &quot;-in&quot;, $P2req, &quot;-days&quot;, &quot;30&quot;,
-		      &quot;-req&quot;, &quot;-out&quot;, $P2cert,
-		      &quot;-CA&quot;, $P1cert, &quot;-CAkey&quot;, $P1key,
-		      &quot;-extfile&quot;, $proxycnf, &quot;-extensions&quot;, &quot;proxy_2&quot;],
-		     stdout =&gt; &quot;err.ss&quot;)),
-	     'sign second proxy cert request with the first proxy cert');
+          ok(run(app([@x509cmd, &quot;-CAcreateserial&quot;, &quot;-in&quot;, $P2req, &quot;-days&quot;, &quot;30&quot;,
+                      &quot;-req&quot;, &quot;-out&quot;, $P2cert,
+                      &quot;-CA&quot;, $P1cert, &quot;-CAkey&quot;, $P1key,
+                      &quot;-extfile&quot;, $proxycnf, &quot;-extensions&quot;, &quot;proxy_2&quot;],
+                     stdout =&gt; &quot;err.ss&quot;)),
+             'sign second proxy cert request with the first proxy cert');
 
 
       open OUT, &quot;&gt;&quot;, $P2intermediate;
       copy($Ucert, \*OUT); copy($P1cert, \*OUT);
       close OUT;
       run(app([@verifycmd, &quot;-CAfile&quot;, $CAcert,
-	       &quot;-untrusted&quot;, $P2intermediate, $P2cert]));
+               &quot;-untrusted&quot;, $P2intermediate, $P2cert]));
       ok(run(app([@x509cmd,
-		  &quot;-subject&quot;, &quot;-issuer&quot;, &quot;-startdate&quot;, &quot;-enddate&quot;,
-		  &quot;-noout&quot;, &quot;-in&quot;, $P2cert])),
-	 'Certificate details');
+                  &quot;-subject&quot;, &quot;-issuer&quot;, &quot;-startdate&quot;, &quot;-enddate&quot;,
+                  &quot;-noout&quot;, &quot;-in&quot;, $P2cert])),
+         'Certificate details');
     }
 }
 
@@ -341,69 +341,69 @@ sub testssl {
 
     my $dsa_cert = 0;
     if (grep /DSA Public Key/, run(app([&quot;openssl&quot;, &quot;x509&quot;, &quot;-in&quot;, $cert,
-					&quot;-text&quot;, &quot;-noout&quot;]), capture =&gt; 1)) {
-	$dsa_cert = 1;
+                                        &quot;-text&quot;, &quot;-noout&quot;]), capture =&gt; 1)) {
+        $dsa_cert = 1;
     }
 
 
     # plan tests =&gt; 11;
 
     subtest 'standard SSL tests' =&gt; sub {
-	######################################################################
-      plan tests =&gt; 13;
+        ######################################################################
+        plan tests =&gt; 13;
 
       SKIP: {
-	  skip &quot;SSLv3 is not supported by this OpenSSL build&quot;, 4
-	      if disabled(&quot;ssl3&quot;);
-
-	  skip &quot;SSLv3 is not supported by the FIPS provider&quot;, 4
-	      if $provider eq &quot;fips&quot;;
-
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-ssl3&quot;])),
-	     'test sslv3 via BIO pair');
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-ssl3&quot;, &quot;-server_auth&quot;, @CA])),
-	     'test sslv3 with server authentication via BIO pair');
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-ssl3&quot;, &quot;-client_auth&quot;, @CA])),
-	     'test sslv3 with client authentication via BIO pair');
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-ssl3&quot;, &quot;-server_auth&quot;, &quot;-client_auth&quot;, @CA])),
-	     'test sslv3 with both server and client authentication via BIO pair');
-	}
+          skip &quot;SSLv3 is not supported by this OpenSSL build&quot;, 4
+              if disabled(&quot;ssl3&quot;);
+
+          skip &quot;SSLv3 is not supported by the FIPS provider&quot;, 4
+              if $provider eq &quot;fips&quot;;
+
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-ssl3&quot;])),
+             'test sslv3 via BIO pair');
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-ssl3&quot;, &quot;-server_auth&quot;, @CA])),
+             'test sslv3 with server authentication via BIO pair');
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-ssl3&quot;, &quot;-client_auth&quot;, @CA])),
+             'test sslv3 with client authentication via BIO pair');
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-ssl3&quot;, &quot;-server_auth&quot;, &quot;-client_auth&quot;, @CA])),
+             'test sslv3 with both server and client authentication via BIO pair');
+        }
 
       SKIP: {
-	  skip &quot;Neither SSLv3 nor any TLS version are supported by this OpenSSL build&quot;, 1
-	      if $no_anytls;
+          skip &quot;Neither SSLv3 nor any TLS version are supported by this OpenSSL build&quot;, 1
+              if $no_anytls;
 
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;])),
-	     'test sslv2/sslv3 via BIO pair');
-	}
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;])),
+             'test sslv2/sslv3 via BIO pair');
+        }
 
       SKIP: {
-	  skip &quot;Neither SSLv3 nor any TLS version are supported by this OpenSSL build&quot;, 8
-	      if $no_anytls;
+          skip &quot;Neither SSLv3 nor any TLS version are supported by this OpenSSL build&quot;, 8
+              if $no_anytls;
 
-	SKIP: {
-	    skip &quot;skipping test of sslv2/sslv3 w/o (EC)DHE test&quot;, 1 if $dsa_cert;
+        SKIP: {
+            skip &quot;skipping test of sslv2/sslv3 w/o (EC)DHE test&quot;, 1 if $dsa_cert;
 
-	    ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-no_dhe&quot;, &quot;-no_ecdhe&quot;])),
-	       'test sslv2/sslv3 w/o (EC)DHE via BIO pair');
-	  }
+            ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-no_dhe&quot;, &quot;-no_ecdhe&quot;])),
+               'test sslv2/sslv3 w/o (EC)DHE via BIO pair');
+          }
 
-	SKIP: {
-	    skip &quot;skipping dhe1024dsa test&quot;, 1
+        SKIP: {
+            skip &quot;skipping dhe1024dsa test&quot;, 1
                 if ($no_dh);
 
             ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-dhe1024dsa&quot;, &quot;-v&quot;])),
                'test sslv2/sslv3 with 1024bit DHE via BIO pair');
           }
 
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-server_auth&quot;, @CA])),
-	     'test sslv2/sslv3 with server authentication');
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-client_auth&quot;, @CA])),
-	     'test sslv2/sslv3 with client authentication via BIO pair');
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-server_auth&quot;, &quot;-client_auth&quot;, @CA])),
-	     'test sslv2/sslv3 with both client and server authentication via BIO pair');
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-server_auth&quot;, &quot;-client_auth&quot;, &quot;-app_verify&quot;, @CA])),
-	     'test sslv2/sslv3 with both client and server authentication via BIO pair and app verify');
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-server_auth&quot;, @CA])),
+             'test sslv2/sslv3 with server authentication');
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-client_auth&quot;, @CA])),
+             'test sslv2/sslv3 with client authentication via BIO pair');
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-server_auth&quot;, &quot;-client_auth&quot;, @CA])),
+             'test sslv2/sslv3 with both client and server authentication via BIO pair');
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-server_auth&quot;, &quot;-client_auth&quot;, &quot;-app_verify&quot;, @CA])),
+             'test sslv2/sslv3 with both client and server authentication via BIO pair and app verify');
 
         SKIP: {
             skip &quot;No IPv4 available on this machine&quot;, 1
@@ -518,45 +518,45 @@ sub testssl {
     };
 
     subtest 'RSA/(EC)DHE/PSK tests' =&gt; sub {
-	######################################################################
+        ######################################################################
 
-	plan tests =&gt; 6;
+        plan tests =&gt; 6;
 
       SKIP: {
-	  skip &quot;TLSv1.0 is not supported by this OpenSSL build&quot;, 6
-	      if $no_tls1 || $provider eq &quot;fips&quot;;
+            skip &quot;TLSv1.0 is not supported by this OpenSSL build&quot;, 6
+                if $no_tls1 || $provider eq &quot;fips&quot;;
 
-	SKIP: {
-	    skip &quot;skipping anonymous DH tests&quot;, 1
-	      if ($no_dh);
+        SKIP: {
+            skip &quot;skipping anonymous DH tests&quot;, 1
+                if ($no_dh);
 
-	    ok(run(test([@ssltest, &quot;-v&quot;, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-cipher&quot;, &quot;ADH&quot;, &quot;-dhe1024dsa&quot;, &quot;-num&quot;, &quot;10&quot;, &quot;-f&quot;, &quot;-time&quot;])),
-	       'test tlsv1 with 1024bit anonymous DH, multiple handshakes');
-	  }
+            ok(run(test([@ssltest, &quot;-v&quot;, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-cipher&quot;, &quot;ADH&quot;, &quot;-dhe1024dsa&quot;, &quot;-num&quot;, &quot;10&quot;, &quot;-f&quot;, &quot;-time&quot;])),
+               'test tlsv1 with 1024bit anonymous DH, multiple handshakes');
+          }
 
-	SKIP: {
-	    skip &quot;skipping RSA tests&quot;, 2
-		if $no_rsa;
+        SKIP: {
+            skip &quot;skipping RSA tests&quot;, 2
+                if $no_rsa;
 
-	    ok(run(test([&quot;ssl_old_test&quot;, &quot;-provider&quot;, &quot;default&quot;, &quot;-v&quot;, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-s_cert&quot;, srctop_file(&quot;apps&quot;,&quot;server2.pem&quot;), &quot;-no_dhe&quot;, &quot;-no_ecdhe&quot;, &quot;-num&quot;, &quot;10&quot;, &quot;-f&quot;, &quot;-time&quot;])),
-	       'test tlsv1 with 1024bit RSA, no (EC)DHE, multiple handshakes');
+            ok(run(test([&quot;ssl_old_test&quot;, &quot;-provider&quot;, &quot;default&quot;, &quot;-v&quot;, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-s_cert&quot;, srctop_file(&quot;apps&quot;,&quot;server2.pem&quot;), &quot;-no_dhe&quot;, &quot;-no_ecdhe&quot;, &quot;-num&quot;, &quot;10&quot;, &quot;-f&quot;, &quot;-time&quot;])),
+               'test tlsv1 with 1024bit RSA, no (EC)DHE, multiple handshakes');
 
-	    skip &quot;skipping RSA+DHE tests&quot;, 1
-		if $no_dh;
+            skip &quot;skipping RSA+DHE tests&quot;, 1
+                if $no_dh;
 
-	    ok(run(test([&quot;ssl_old_test&quot;, &quot;-provider&quot;, &quot;default&quot;, &quot;-v&quot;, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-s_cert&quot;, srctop_file(&quot;apps&quot;,&quot;server2.pem&quot;), &quot;-dhe1024dsa&quot;, &quot;-num&quot;, &quot;10&quot;, &quot;-f&quot;, &quot;-time&quot;])),
-	       'test tlsv1 with 1024bit RSA, 1024bit DHE, multiple handshakes');
-	  }
+            ok(run(test([&quot;ssl_old_test&quot;, &quot;-provider&quot;, &quot;default&quot;, &quot;-v&quot;, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-s_cert&quot;, srctop_file(&quot;apps&quot;,&quot;server2.pem&quot;), &quot;-dhe1024dsa&quot;, &quot;-num&quot;, &quot;10&quot;, &quot;-f&quot;, &quot;-time&quot;])),
+               'test tlsv1 with 1024bit RSA, 1024bit DHE, multiple handshakes');
+          }
 
-	SKIP: {
-	    skip &quot;skipping PSK tests&quot;, 3
-	        if ($no_psk);
+        SKIP: {
+            skip &quot;skipping PSK tests&quot;, 3
+                if ($no_psk);
 
-	    ok(run(test([@ssltest, &quot;-tls1&quot;, &quot;-cipher&quot;, &quot;PSK&quot;, &quot;-psk&quot;, &quot;abc123&quot;])),
-	       'test tls1 with PSK');
+            ok(run(test([@ssltest, &quot;-tls1&quot;, &quot;-cipher&quot;, &quot;PSK&quot;, &quot;-psk&quot;, &quot;abc123&quot;])),
+               'test tls1 with PSK');
 
-	    ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-cipher&quot;, &quot;PSK&quot;, &quot;-psk&quot;, &quot;abc123&quot;])),
-	       'test tls1 with PSK via BIO pair');
+            ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-cipher&quot;, &quot;PSK&quot;, &quot;-psk&quot;, &quot;abc123&quot;])),
+               'test tls1 with PSK via BIO pair');
 
             ok(run(test(['ssl_old_test', '-psk', '0102030405', '-cipher', '@SECLEVEL=2:DHE-PSK-AES128-CCM'])),
                'test auto DH meets security strength');
@@ -566,34 +566,34 @@ sub testssl {
     };
 
     subtest 'Custom Extension tests' =&gt; sub {
-	######################################################################
+        ######################################################################
 
-	plan tests =&gt; 1;
+        plan tests =&gt; 1;
 
       SKIP: {
-	  skip &quot;TLSv1.0 is not supported by this OpenSSL build&quot;, 1
-	      if $no_tls1 || $provider eq &quot;fips&quot;;
+          skip &quot;TLSv1.0 is not supported by this OpenSSL build&quot;, 1
+              if $no_tls1 || $provider eq &quot;fips&quot;;
 
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-custom_ext&quot;])),
-	     'test tls1 with custom extensions');
-	}
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-custom_ext&quot;])),
+             'test tls1 with custom extensions');
+        }
     };
 
     subtest 'Serverinfo tests' =&gt; sub {
-	######################################################################
+        ######################################################################
 
-	plan tests =&gt; 5;
+        plan tests =&gt; 5;
 
       SKIP: {
-	  skip &quot;TLSv1.0 is not supported by this OpenSSL build&quot;, 5
-	      if $no_tls1 || $provider eq &quot;fips&quot;;
-
-	  note('echo test tls1 with serverinfo');
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-serverinfo_file&quot;, $serverinfo])));
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-serverinfo_file&quot;, $serverinfo, &quot;-serverinfo_sct&quot;])));
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-serverinfo_file&quot;, $serverinfo, &quot;-serverinfo_tack&quot;])));
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-serverinfo_file&quot;, $serverinfo, &quot;-serverinfo_sct&quot;, &quot;-serverinfo_tack&quot;])));
-	  ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-custom_ext&quot;, &quot;-serverinfo_file&quot;, $serverinfo, &quot;-serverinfo_sct&quot;, &quot;-serverinfo_tack&quot;])));
-	}
+          skip &quot;TLSv1.0 is not supported by this OpenSSL build&quot;, 5
+              if $no_tls1 || $provider eq &quot;fips&quot;;
+
+          note('echo test tls1 with serverinfo');
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-serverinfo_file&quot;, $serverinfo])));
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-serverinfo_file&quot;, $serverinfo, &quot;-serverinfo_sct&quot;])));
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-serverinfo_file&quot;, $serverinfo, &quot;-serverinfo_tack&quot;])));
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-serverinfo_file&quot;, $serverinfo, &quot;-serverinfo_sct&quot;, &quot;-serverinfo_tack&quot;])));
+          ok(run(test([@ssltest, &quot;-bio_pair&quot;, &quot;-tls1&quot;, &quot;-custom_ext&quot;, &quot;-serverinfo_file&quot;, $serverinfo, &quot;-serverinfo_sct&quot;, &quot;-serverinfo_tack&quot;])));
+        }
     };
 }
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034760.html">[openssl]  master update
</A></li>
	<LI>Next message: <A HREF="034762.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34761">[ date ]</a>
              <a href="thread.html#34761">[ thread ]</a>
              <a href="subject.html#34761">[ subject ]</a>
              <a href="author.html#34761">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
