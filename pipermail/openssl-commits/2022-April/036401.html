<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl/openssl] 8a4c3e: evp_test: Try computing MACs twice with reinitiali...
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2022-April/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl/openssl%5D%208a4c3e%3A%20evp_test%3A%20Try%20computing%20MACs%20twice%20with%0A%20reinitiali...&In-Reply-To=%3Copenssl/openssl/push/refs/heads/openssl-3.0/279e66-4f675d%40github.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036400.html">
   <LINK REL="Next"  HREF="036402.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl/openssl] 8a4c3e: evp_test: Try computing MACs twice with reinitiali...</H1>
    <B>Tomas Mraz</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl/openssl%5D%208a4c3e%3A%20evp_test%3A%20Try%20computing%20MACs%20twice%20with%0A%20reinitiali...&In-Reply-To=%3Copenssl/openssl/push/refs/heads/openssl-3.0/279e66-4f675d%40github.openssl.org%3E"
       TITLE="[openssl/openssl] 8a4c3e: evp_test: Try computing MACs twice with reinitiali...">noreply at reply.github.openssl.org
       </A><BR>
    <I>Tue Apr 19 12:07:31 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="036400.html">[openssl/openssl] e58ba1: evp_test: Try computing MACs twice with reinitiali...
</A></li>
        <LI>Next message (by thread): <A HREF="036402.html">[openssl/openssl] 3b74fd: Do a prelimary check for numbers in openssl prime ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36401">[ date ]</a>
              <a href="thread.html#36401">[ thread ]</a>
              <a href="subject.html#36401">[ subject ]</a>
              <a href="author.html#36401">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>  Branch: refs/heads/openssl-3.0
  Home:   <A HREF="https://github.openssl.org/openssl/openssl">https://github.openssl.org/openssl/openssl</A>
  Commit: 8a4c3ed751cf256a0702fa87417e4bbf429c4562
      <A HREF="https://github.openssl.org/openssl/openssl/commit/8a4c3ed751cf256a0702fa87417e4bbf429c4562">https://github.openssl.org/openssl/openssl/commit/8a4c3ed751cf256a0702fa87417e4bbf429c4562</A>
  Author: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
  Date:   2022-04-19 (Tue, 19 Apr 2022)

  Changed paths:
    M test/evp_test.c
    M test/recipes/30-test_evp_data/evpmac_poly1305.txt

  Log Message:
  -----------
  evp_test: Try computing MACs twice with reinitialization of EVP_MAC_CTX

Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
(Merged from <A HREF="https://github.com/openssl/openssl/pull/18100">https://github.com/openssl/openssl/pull/18100</A>)

(cherry picked from commit e58ba181de6b0dfad0dc371f8d962c82138a906e)


  Commit: 4f675d8c600bfde652aff28cb10c2d16be11fa65
      <A HREF="https://github.openssl.org/openssl/openssl/commit/4f675d8c600bfde652aff28cb10c2d16be11fa65">https://github.openssl.org/openssl/openssl/commit/4f675d8c600bfde652aff28cb10c2d16be11fa65</A>
  Author: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
  Date:   2022-04-19 (Tue, 19 Apr 2022)

  Changed paths:
    M providers/implementations/macs/cmac_prov.c
    M providers/implementations/macs/gmac_prov.c
    M providers/implementations/macs/hmac_prov.c
    M providers/implementations/macs/poly1305_prov.c
    M providers/implementations/macs/siphash_prov.c

  Log Message:
  -----------
  Avoid undefined behavior of provided macs on EVP_MAC reinitialization

When the context is reinitialized, i.e. the same key should be used
we must properly reinitialize the underlying implementation.

However in POLY1305 case it does not make sense as this special MAC
should not reuse keys. We fail with this provided implementation
when reinitialization happens.

Fixes #17811

Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
(Merged from <A HREF="https://github.com/openssl/openssl/pull/18100">https://github.com/openssl/openssl/pull/18100</A>)

(cherry picked from commit c9ddc5af5199909d196ee80ccd7abcff2eb42a34)


Compare: <A HREF="https://github.openssl.org/openssl/openssl/compare/279e66f76ac3...4f675d8c600b">https://github.openssl.org/openssl/openssl/compare/279e66f76ac3...4f675d8c600b</A>
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="036400.html">[openssl/openssl] e58ba1: evp_test: Try computing MACs twice with reinitiali...
</A></li>
	<LI>Next message (by thread): <A HREF="036402.html">[openssl/openssl] 3b74fd: Do a prelimary check for numbers in openssl prime ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36401">[ date ]</a>
              <a href="thread.html#36401">[ thread ]</a>
              <a href="subject.html#36401">[ subject ]</a>
              <a href="author.html#36401">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
