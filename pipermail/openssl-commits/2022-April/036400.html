<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl/openssl] e58ba1: evp_test: Try computing MACs twice with reinitiali...
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2022-April/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl/openssl%5D%20e58ba1%3A%20evp_test%3A%20Try%20computing%20MACs%20twice%20with%0A%20reinitiali...&In-Reply-To=%3Copenssl/openssl/push/refs/heads/master/e763b1-c9ddc5%40github.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036399.html">
   <LINK REL="Next"  HREF="036401.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl/openssl] e58ba1: evp_test: Try computing MACs twice with reinitiali...</H1>
    <B>Tomas Mraz</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl/openssl%5D%20e58ba1%3A%20evp_test%3A%20Try%20computing%20MACs%20twice%20with%0A%20reinitiali...&In-Reply-To=%3Copenssl/openssl/push/refs/heads/master/e763b1-c9ddc5%40github.openssl.org%3E"
       TITLE="[openssl/openssl] e58ba1: evp_test: Try computing MACs twice with reinitiali...">noreply at reply.github.openssl.org
       </A><BR>
    <I>Tue Apr 19 12:07:07 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="036399.html">[openssl/openssl] 279e66: doc: Clarify that calling SSL_set_session(ssl, NUL...
</A></li>
        <LI>Next message (by thread): <A HREF="036401.html">[openssl/openssl] 8a4c3e: evp_test: Try computing MACs twice with reinitiali...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36400">[ date ]</a>
              <a href="thread.html#36400">[ thread ]</a>
              <a href="subject.html#36400">[ subject ]</a>
              <a href="author.html#36400">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>  Branch: refs/heads/master
  Home:   <A HREF="https://github.openssl.org/openssl/openssl">https://github.openssl.org/openssl/openssl</A>
  Commit: e58ba181de6b0dfad0dc371f8d962c82138a906e
      <A HREF="https://github.openssl.org/openssl/openssl/commit/e58ba181de6b0dfad0dc371f8d962c82138a906e">https://github.openssl.org/openssl/openssl/commit/e58ba181de6b0dfad0dc371f8d962c82138a906e</A>
  Author: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
  Date:   2022-04-19 (Tue, 19 Apr 2022)

  Changed paths:
    M test/evp_test.c
    M test/recipes/30-test_evp_data/evpmac_poly1305.txt

  Log Message:
  -----------
  evp_test: Try computing MACs twice with reinitialization of EVP_MAC_CTX

Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
(Merged from <A HREF="https://github.com/openssl/openssl/pull/18100">https://github.com/openssl/openssl/pull/18100</A>)


  Commit: c9ddc5af5199909d196ee80ccd7abcff2eb42a34
      <A HREF="https://github.openssl.org/openssl/openssl/commit/c9ddc5af5199909d196ee80ccd7abcff2eb42a34">https://github.openssl.org/openssl/openssl/commit/c9ddc5af5199909d196ee80ccd7abcff2eb42a34</A>
  Author: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
  Date:   2022-04-19 (Tue, 19 Apr 2022)

  Changed paths:
    M providers/implementations/macs/cmac_prov.c
    M providers/implementations/macs/gmac_prov.c
    M providers/implementations/macs/hmac_prov.c
    M providers/implementations/macs/poly1305_prov.c
    M providers/implementations/macs/siphash_prov.c

  Log Message:
  -----------
  Avoid undefined behavior of provided macs on EVP_MAC reinitialization

When the context is reinitialized, i.e. the same key should be used
we must properly reinitialize the underlying implementation.

However in POLY1305 case it does not make sense as this special MAC
should not reuse keys. We fail with this provided implementation
when reinitialization happens.

Fixes #17811

Reviewed-by: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">matt at openssl.org</A>&gt;
Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
(Merged from <A HREF="https://github.com/openssl/openssl/pull/18100">https://github.com/openssl/openssl/pull/18100</A>)


Compare: <A HREF="https://github.openssl.org/openssl/openssl/compare/e763b1861fb2...c9ddc5af5199">https://github.openssl.org/openssl/openssl/compare/e763b1861fb2...c9ddc5af5199</A>
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="036399.html">[openssl/openssl] 279e66: doc: Clarify that calling SSL_set_session(ssl, NUL...
</A></li>
	<LI>Next message (by thread): <A HREF="036401.html">[openssl/openssl] 8a4c3e: evp_test: Try computing MACs twice with reinitiali...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36400">[ date ]</a>
              <a href="thread.html#36400">[ thread ]</a>
              <a href="subject.html#36400">[ subject ]</a>
              <a href="author.html#36400">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
