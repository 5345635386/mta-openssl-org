<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2019-April/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1556226466.356411.4513.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022926.html">
   <LINK REL="Next"  HREF="022939.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl]  master update</H1>
    <B>Richard Levitte</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1556226466.356411.4513.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl]  master update">levitte at openssl.org
       </A><BR>
    <I>Thu Apr 25 21:07:46 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="022926.html">[openssl]  master update
</A></li>
        <LI>Next message: <A HREF="022939.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22933">[ date ]</a>
              <a href="thread.html#22933">[ thread ]</a>
              <a href="subject.html#22933">[ subject ]</a>
              <a href="author.html#22933">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  5ee08f45bcabc3cef0d7d7b2aa6ecad12ca4197b (commit)
       via  302aa3c26d9e716ed4a3fba453faafa7acadf22c (commit)
       via  3062468b0aa0eaa287e44689157d97774fd5817e (commit)
       via  11aad862850cb2e639756e7126216b6cf38af26b (commit)
      from  bb5b3e6dd0575a4fa96f5085228b716062c00502 (commit)


- Log -----------------------------------------------------------------
commit 5ee08f45bcabc3cef0d7d7b2aa6ecad12ca4197b
Author: Patrick Steuer &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">patrick.steuer at de.ibm.com</A>&gt;
Date:   Mon Mar 25 18:23:59 2019 +0100

    s390x assembly pack: remove poly1305 dependency on non-base memnonics
    
    Signed-off-by: Patrick Steuer &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">patrick.steuer at de.ibm.com</A>&gt;
    
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">paul.dale at oracle.com</A>&gt;
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/8181">https://github.com/openssl/openssl/pull/8181</A>)

commit 302aa3c26d9e716ed4a3fba453faafa7acadf22c
Author: Patrick Steuer &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">patrick.steuer at de.ibm.com</A>&gt;
Date:   Mon Mar 25 18:22:02 2019 +0100

    s390x assembly pack: remove chacha20 dependency on non-base memnonics
    
    Signed-off-by: Patrick Steuer &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">patrick.steuer at de.ibm.com</A>&gt;
    
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">paul.dale at oracle.com</A>&gt;
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/8181">https://github.com/openssl/openssl/pull/8181</A>)

commit 3062468b0aa0eaa287e44689157d97774fd5817e
Author: Patrick Steuer &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">patrick.steuer at de.ibm.com</A>&gt;
Date:   Mon Mar 25 18:20:27 2019 +0100

    s390x assembly pack: update perlasm module
    
    Add non-base instructions which are used by the chacha20 and
    poly1305 modules.
    
    Signed-off-by: Patrick Steuer &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">patrick.steuer at de.ibm.com</A>&gt;
    
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">paul.dale at oracle.com</A>&gt;
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/8181">https://github.com/openssl/openssl/pull/8181</A>)

commit 11aad862850cb2e639756e7126216b6cf38af26b
Author: Patrick Steuer &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">patrick.steuer at de.ibm.com</A>&gt;
Date:   Thu Feb 7 16:44:05 2019 +0100

    s390x assembly pack: allow alignment hints for vector load/store
    
    z14 introduced alignment hints to help vector load/store
    performance. For its predecessors, alignment hint defaults
    to 0 (no alignment indicated).
    
    Signed-off-by: Patrick Steuer &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">patrick.steuer at de.ibm.com</A>&gt;
    
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">paul.dale at oracle.com</A>&gt;
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/8181">https://github.com/openssl/openssl/pull/8181</A>)

-----------------------------------------------------------------------

Summary of changes:
 crypto/chacha/asm/chacha-s390x.pl     |  2 +-
 crypto/perlasm/s390x.pm               | 94 ++++++++++++++++++++++++++++++++---
 crypto/poly1305/asm/poly1305-s390x.pl |  2 +-
 3 files changed, 90 insertions(+), 8 deletions(-)

diff --git a/crypto/chacha/asm/chacha-s390x.pl b/crypto/chacha/asm/chacha-s390x.pl
index 51efe64..1f22b26 100755
--- a/crypto/chacha/asm/chacha-s390x.pl
+++ b/crypto/chacha/asm/chacha-s390x.pl
@@ -40,7 +40,7 @@
 use strict;
 use FindBin qw($Bin);
 use lib &quot;$Bin/../..&quot;;
-use perlasm::s390x qw(:DEFAULT :VX AUTOLOAD LABEL INCLUDE);
+use perlasm::s390x qw(:DEFAULT :VX :LD AUTOLOAD LABEL INCLUDE);
 
 my $flavour = shift;
 
diff --git a/crypto/perlasm/s390x.pm b/crypto/perlasm/s390x.pm
index 5f3a49d..7fb55c7 100644
--- a/crypto/perlasm/s390x.pm
+++ b/crypto/perlasm/s390x.pm
@@ -6,23 +6,37 @@
 # in the file LICENSE in the source distribution or at
 # <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
 
-# Copyright IBM Corp. 2018
+# Copyright IBM Corp. 2018-2019
 # Author: Patrick Steuer &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">patrick.steuer at de.ibm.com</A>&gt;
 
 package perlasm::s390x;
 
 use strict;
 use warnings;
+use bigint;
 use Carp qw(confess);
 use Exporter qw(import);
 
 our @EXPORT=qw(PERLASM_BEGIN PERLASM_END);
 our @EXPORT_OK=qw(AUTOLOAD LABEL INCLUDE stfle);
 our %EXPORT_TAGS=(
+	# long-displacement facility
+	LD =&gt; [qw(clgfi)],
+	# general-instruction-extension facility
+	GE =&gt; [qw(risbg)],
+	# extended-immediate facility
+	EI =&gt; [qw(lt)],
+	# miscellaneous-instruction-extensions facility 1
+	MI1 =&gt; [qw(risbgn)],
+	# message-security assist
 	MSA =&gt; [qw(kmac km kmc kimd klmd)],
+	# message-security-assist extension 4
 	MSA4 =&gt; [qw(kmf kmo pcc kmctr)],
+	# message-security-assist extension 5
 	MSA5 =&gt; [qw(ppno prno)],
+	# message-security-assist extension 8
 	MSA8 =&gt; [qw(kma)],
+	# vector facility
 	VX =&gt; [qw(vgef vgeg vgbm vzero vone vgm vgmb vgmh vgmf vgmg
 	    vl vlr vlrep vlrepb vlreph vlrepf vlrepg vleb vleh vlef vleg vleib
 	    vleih vleif vleig vlgv vlgvb vlgvh vlgvf vlgvg vllez vllezb vllezh
@@ -71,6 +85,7 @@ our %EXPORT_TAGS=(
 	    wfmadb vfms vfmsdb wfmsdb vfpso vfpsodb wfpsodb vflcdb wflcdb
 	    vflndb wflndb vflpdb wflpdb vfsq vfsqdb wfsqdb vfs vfsdb wfsdb
 	    vftci vftcidb wftcidb)],
+	# vector-enhancements facility 1
 	VXE =&gt; [qw(vbperm vllezlf vmsl vmslg vnx vnn voc vpopctb vpopcth
 	    vpopctf vpopctg vfasb wfasb wfaxb wfcsb wfcxb wfksb wfkxb vfcesb
 	    vfcesbs wfcesb wfcesbs wfcexb wfcexbs vfchsb vfchsbs wfchsb wfchsbs
@@ -83,10 +98,11 @@ our %EXPORT_TAGS=(
 	    wfnmsxb vfpsosb wfpsosb vflcsb wflcsb vflnsb wflnsb vflpsb wflpsb
 	    vfpsoxb wfpsoxb vflcxb wflcxb vflnxb wflnxb vflpxb wflpxb vfsqsb
 	    wfsqsb wfsqxb vfssb wfssb wfsxb vftcisb wftcisb wftcixb)],
+	# vector-packed-decimal facility
 	VXD =&gt; [qw(vlrlr vlrl vstrlr vstrl vap vcp vcvb vcvbg vcvd vcvdg vdp
 	    vlip vmp vmsp vpkz vpsop vrp vsdp vsrp vsp vtp vupkz)],
 );
-Exporter::export_ok_tags(qw(MSA MSA4 MSA5 MSA8 VX VXE VXD));
+Exporter::export_ok_tags(qw(LD GE EI MI1 MSA MSA4 MSA5 MSA8 VX VXE VXD));
 
 our $AUTOLOAD;
 
@@ -143,6 +159,28 @@ sub stfle {
 	S(<A HREF="../../../mailman/listinfo/openssl-commits.html">0xb2b0, at _</A>);
 }
 
+# MISC
+
+sub clgfi {
+	confess(err(&quot;ARGNUM&quot;)) if ($#_!=1);
+	RILa(<A HREF="../../../mailman/listinfo/openssl-commits.html">0xc2e, at _</A>);
+}
+
+sub lt {
+	confess(err(&quot;ARGNUM&quot;)) if ($#_!=1);
+	RXYa(<A HREF="../../../mailman/listinfo/openssl-commits.html">0xe312, at _</A>);
+}
+
+sub risbg {
+	confess(err(&quot;ARGNUM&quot;)) if ($#_&lt;3||$#_&gt;4);
+	RIEf(<A HREF="../../../mailman/listinfo/openssl-commits.html">0xec55, at _</A>);
+}
+
+sub risbgn {
+	confess(err(&quot;ARGNUM&quot;)) if ($#_&lt;3||$#_&gt;4);
+	RIEf(<A HREF="../../../mailman/listinfo/openssl-commits.html">0xec59, at _</A>);
+}
+
 # MSA
 
 sub kmac {
@@ -250,7 +288,7 @@ sub vgmg {
 }
 
 sub vl {
-	confess(err(&quot;ARGNUM&quot;)) if ($#_!=1);
+	confess(err(&quot;ARGNUM&quot;)) if ($#_&lt;1||$#_&gt;2);
 	VRX(<A HREF="../../../mailman/listinfo/openssl-commits.html">0xe706, at _</A>);
 }
 
@@ -345,7 +383,7 @@ sub vllezg {
 }
 
 sub vlm {
-	confess(err(&quot;ARGNUM&quot;)) if ($#_!=2);
+	confess(err(&quot;ARGNUM&quot;)) if ($#_&lt;2||$#_&gt;3);
 	VRSa(<A HREF="../../../mailman/listinfo/openssl-commits.html">0xe736, at _</A>);
 }
 
@@ -548,7 +586,7 @@ sub vsegf {
 }
 
 sub vst {
-	confess(err(&quot;ARGNUM&quot;)) if ($#_!=1);
+	confess(err(&quot;ARGNUM&quot;)) if ($#_&lt;1||$#_&gt;2);
 	VRX(<A HREF="../../../mailman/listinfo/openssl-commits.html">0xe70e, at _</A>);
 }
 
@@ -570,7 +608,7 @@ sub vsteg {
 }
 
 sub vstm {
-	confess(err(&quot;ARGNUM&quot;)) if ($#_!=2);
+	confess(err(&quot;ARGNUM&quot;)) if ($#_&lt;2||$#_&gt;3);
 	VRSa(<A HREF="../../../mailman/listinfo/openssl-commits.html">0xe73e, at _</A>);
 }
 
@@ -2486,6 +2524,36 @@ sub vupkz {
 # Instruction Formats
 #
 
+sub RIEf {
+	confess(err(&quot;ARGNUM&quot;)) if ($#_&lt;4||5&lt;$#_);
+	my $ops=join(','<A HREF="../../../mailman/listinfo/openssl-commits.html">, at _</A>[1..$#_]);
+	my $memn=(caller(1))[3];
+	$memn=~s/^.*:://;
+	my ($opcode,$r1,$r2,$i3,$i4,$i5)=(shift,get_R(shift),get_R(shift),
+					  get_I(shift,8),get_I(shift,8),
+					  get_I(shift,8));
+
+	$out.=&quot;\t.word\t&quot;;
+	$out.=sprintf(&quot;%#06x&quot;,(($opcode&gt;&gt;8)&lt;&lt;8|$r1&lt;&lt;4|$r2)).&quot;,&quot;;
+	$out.=sprintf(&quot;%#06x&quot;,($i3&lt;&lt;8)|$i4).&quot;,&quot;;
+	$out.=sprintf(&quot;%#06x&quot;,($i5&lt;&lt;8)|($opcode&amp;0xff));
+	$out.=&quot;\t# $memn\t$ops\n&quot;
+}
+
+sub RILa {
+	confess(err(&quot;ARGNUM&quot;)) if ($#_!=2);
+	my $ops=join(','<A HREF="../../../mailman/listinfo/openssl-commits.html">, at _</A>[1..$#_]);
+	my $memn=(caller(1))[3];
+	$memn=~s/^.*:://;
+	my ($opcode,$r1,$i2)=(shift,get_R(shift),get_I(shift,32));
+
+	$out.=&quot;\t.word\t&quot;;
+	$out.=sprintf(&quot;%#06x&quot;,(($opcode&gt;&gt;4)&lt;&lt;8|$r1&lt;&lt;4|($opcode&amp;0xf))).&quot;,&quot;;
+	$out.=sprintf(&quot;%#06x&quot;,($i2&gt;&gt;16)).&quot;,&quot;;
+	$out.=sprintf(&quot;%#06x&quot;,($i2&amp;0xffff));
+	$out.=&quot;\t# $memn\t$ops\n&quot;
+}
+
 sub RRE {
 	confess(err(&quot;ARGNUM&quot;)) if ($#_&lt;0||2&lt;$#_);
 	my $ops=join(','<A HREF="../../../mailman/listinfo/openssl-commits.html">, at _</A>[1..$#_]);
@@ -2510,6 +2578,20 @@ sub RRFb {
 	$out.=&quot;\t# $memn\t$ops\n&quot;
 }
 
+sub RXYa {
+	confess(err(&quot;ARGNUM&quot;)) if ($#_!=2);
+	my $ops=join(','<A HREF="../../../mailman/listinfo/openssl-commits.html">, at _</A>[1..$#_]);
+	my $memn=(caller(1))[3];
+	$memn=~s/^.*:://;
+	my ($opcode,$r1,$d2,$x2,$b2)=(shift,get_R(shift),get_DXB(shift));
+
+	$out.=&quot;\t.word\t&quot;;
+	$out.=sprintf(&quot;%#06x&quot;,(($opcode&gt;&gt;8)&lt;&lt;8|$r1&lt;&lt;4|$x2)).&quot;,&quot;;
+	$out.=sprintf(&quot;%#06x&quot;,($b2&lt;&lt;12|($d2&amp;0xfff))).&quot;,&quot;;
+	$out.=sprintf(&quot;%#06x&quot;,(($d2&gt;&gt;12)&lt;&lt;8|$opcode&amp;0xff));
+	$out.=&quot;\t# $memn\t$ops\n&quot;
+}
+
 sub S {
 	confess(err(&quot;ARGNUM&quot;)) if ($#_&lt;0||1&lt;$#_);
 	my $ops=join(','<A HREF="../../../mailman/listinfo/openssl-commits.html">, at _</A>[1..$#_]);
diff --git a/crypto/poly1305/asm/poly1305-s390x.pl b/crypto/poly1305/asm/poly1305-s390x.pl
index ea1c2d8..73efdd9 100755
--- a/crypto/poly1305/asm/poly1305-s390x.pl
+++ b/crypto/poly1305/asm/poly1305-s390x.pl
@@ -45,7 +45,7 @@
 use strict;
 use FindBin qw($Bin);
 use lib &quot;$Bin/../..&quot;;
-use perlasm::s390x qw(:DEFAULT :VX AUTOLOAD LABEL INCLUDE);
+use perlasm::s390x qw(:DEFAULT :LD :GE :EI :MI1 :VX AUTOLOAD LABEL INCLUDE);
 
 my $flavour = shift;
 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022926.html">[openssl]  master update
</A></li>
	<LI>Next message: <A HREF="022939.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22933">[ date ]</a>
              <a href="thread.html#22933">[ thread ]</a>
              <a href="subject.html#22933">[ subject ]</a>
              <a href="author.html#22933">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
