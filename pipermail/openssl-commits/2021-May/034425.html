<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl]  master update
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-commits/2021-May/index.html" >
   <LINK REL="made" HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1621815176.064080.24969.nullmailer%40dev.openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034424.html">
   <LINK REL="Next"  HREF="034426.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl]  master update</H1>
    <B>Dr. Paul Dale</B> 
    <A HREF="mailto:openssl-commits%40openssl.org?Subject=Re%3A%20%5Bopenssl%5D%20%20master%20update&In-Reply-To=%3C1621815176.064080.24969.nullmailer%40dev.openssl.org%3E"
       TITLE="[openssl]  master update">pauli at openssl.org
       </A><BR>
    <I>Mon May 24 00:12:56 UTC 2021</I>
    <P><UL>
        <LI>Previous message: <A HREF="034424.html">[openssl]  master update
</A></li>
        <LI>Next message: <A HREF="034426.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34425">[ date ]</a>
              <a href="thread.html#34425">[ thread ]</a>
              <a href="subject.html#34425">[ subject ]</a>
              <a href="author.html#34425">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch master has been updated
       via  7c14d0c1c0ece97f7406b4df466df6439146d6c6 (commit)
      from  c45df3302d20291ff1125f1aeb82fae1cdceaac8 (commit)


- Log -----------------------------------------------------------------
commit 7c14d0c1c0ece97f7406b4df466df6439146d6c6
Author: Shane Lontis &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">shane.lontis at oracle.com</A>&gt;
Date:   Fri May 14 13:08:42 2021 +1000

    Rename the field 'provctx and data' to 'algctx' inside some objects containing
    pointers to provider size algorithm contexts.
    
    Fixes #14284
    
    The gettable_ctx_params methods were confusingly passing a 'provctx' and
    a provider context which are completely different objects.
    Some objects such as EVP_KDF used 'data' while others such as EVP_MD used 'provctx'.
    
    For libcrypto this 'ctx' is an opaque ptr returned when a providers algorithm
    implementation creates an internal context using a new_ctx() method.
    Hence the new name 'algctx'.
    
    Reviewed-by: Tomas Mraz &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">tomas at openssl.org</A>&gt;
    Reviewed-by: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">levitte at openssl.org</A>&gt;
    Reviewed-by: Paul Dale &lt;<A HREF="../../../mailman/listinfo/openssl-commits.html">pauli at openssl.org</A>&gt;
    (Merged from <A HREF="https://github.com/openssl/openssl/pull/15275">https://github.com/openssl/openssl/pull/15275</A>)

-----------------------------------------------------------------------

Summary of changes:
 crypto/evp/asymcipher.c            |  16 ++---
 crypto/evp/ctrl_params_translate.c |   8 +--
 crypto/evp/digest.c                |  84 ++++++++++++-------------
 crypto/evp/evp_enc.c               |  78 ++++++++++++------------
 crypto/evp/evp_lib.c               |  26 ++++----
 crypto/evp/evp_local.h             |  34 ++++++++---
 crypto/evp/evp_rand.c              |  38 ++++++------
 crypto/evp/evp_utils.c             |   6 +-
 crypto/evp/exchange.c              |  14 ++---
 crypto/evp/kdf_lib.c               |  24 ++++----
 crypto/evp/kdf_meth.c              |   4 +-
 crypto/evp/kem.c                   |  16 ++---
 crypto/evp/m_sigver.c              |  38 ++++++------
 crypto/evp/mac_lib.c               |  28 ++++-----
 crypto/evp/mac_meth.c              |   4 +-
 crypto/evp/pmeth_lib.c             | 122 ++++++++++++++++++-------------------
 crypto/evp/signature.c             |  26 ++++----
 include/crypto/evp.h               |  24 ++++++--
 test/drbgtest.c                    |   2 +-
 test/testutil/fake_random.c        |   4 +-
 20 files changed, 314 insertions(+), 282 deletions(-)

diff --git a/crypto/evp/asymcipher.c b/crypto/evp/asymcipher.c
index 1acbe81b68..513cb7e654 100644
--- a/crypto/evp/asymcipher.c
+++ b/crypto/evp/asymcipher.c
@@ -99,8 +99,8 @@ static int evp_pkey_asym_cipher_init(EVP_PKEY_CTX *ctx, int operation,
     /* No more legacy from here down to legacy: */
 
     ctx-&gt;op.ciph.cipher = cipher;
-    ctx-&gt;op.ciph.ciphprovctx = cipher-&gt;newctx(ossl_provider_ctx(cipher-&gt;prov));
-    if (ctx-&gt;op.ciph.ciphprovctx == NULL) {
+    ctx-&gt;op.ciph.algctx = cipher-&gt;newctx(ossl_provider_ctx(cipher-&gt;prov));
+    if (ctx-&gt;op.ciph.algctx == NULL) {
         /* The provider key can stay in the cache */
         ERR_raise(ERR_LIB_EVP, EVP_R_INITIALIZATION_ERROR);
         goto err;
@@ -113,7 +113,7 @@ static int evp_pkey_asym_cipher_init(EVP_PKEY_CTX *ctx, int operation,
             ret = -2;
             goto err;
         }
-        ret = cipher-&gt;encrypt_init(ctx-&gt;op.ciph.ciphprovctx, provkey, params);
+        ret = cipher-&gt;encrypt_init(ctx-&gt;op.ciph.algctx, provkey, params);
         break;
     case EVP_PKEY_OP_DECRYPT:
         if (cipher-&gt;decrypt_init == NULL) {
@@ -121,7 +121,7 @@ static int evp_pkey_asym_cipher_init(EVP_PKEY_CTX *ctx, int operation,
             ret = -2;
             goto err;
         }
-        ret = cipher-&gt;decrypt_init(ctx-&gt;op.ciph.ciphprovctx, provkey, params);
+        ret = cipher-&gt;decrypt_init(ctx-&gt;op.ciph.algctx, provkey, params);
         break;
     default:
         ERR_raise(ERR_LIB_EVP, EVP_R_INITIALIZATION_ERROR);
@@ -194,10 +194,10 @@ int EVP_PKEY_encrypt(EVP_PKEY_CTX *ctx,
         return -1;
     }
 
-    if (ctx-&gt;op.ciph.ciphprovctx == NULL)
+    if (ctx-&gt;op.ciph.algctx == NULL)
         goto legacy;
 
-    ret = ctx-&gt;op.ciph.cipher-&gt;encrypt(ctx-&gt;op.ciph.ciphprovctx, out, outlen,
+    ret = ctx-&gt;op.ciph.cipher-&gt;encrypt(ctx-&gt;op.ciph.algctx, out, outlen,
                                        (out == NULL ? 0 : *outlen), in, inlen);
     return ret;
 
@@ -236,10 +236,10 @@ int EVP_PKEY_decrypt(EVP_PKEY_CTX *ctx,
         return -1;
     }
 
-    if (ctx-&gt;op.ciph.ciphprovctx == NULL)
+    if (ctx-&gt;op.ciph.algctx == NULL)
         goto legacy;
 
-    ret = ctx-&gt;op.ciph.cipher-&gt;decrypt(ctx-&gt;op.ciph.ciphprovctx, out, outlen,
+    ret = ctx-&gt;op.ciph.cipher-&gt;decrypt(ctx-&gt;op.ciph.algctx, out, outlen,
                                        (out == NULL ? 0 : *outlen), in, inlen);
     return ret;
 
diff --git a/crypto/evp/ctrl_params_translate.c b/crypto/evp/ctrl_params_translate.c
index f47209ae83..216305b952 100644
--- a/crypto/evp/ctrl_params_translate.c
+++ b/crypto/evp/ctrl_params_translate.c
@@ -419,13 +419,13 @@ static int default_fixup_args(enum state state,
 
         if (translation-&gt;optype != 0) {
             if ((EVP_PKEY_CTX_IS_SIGNATURE_OP(ctx-&gt;pctx)
-                 &amp;&amp; ctx-&gt;pctx-&gt;op.sig.sigprovctx == NULL)
+                 &amp;&amp; ctx-&gt;pctx-&gt;op.sig.algctx == NULL)
                 || (EVP_PKEY_CTX_IS_DERIVE_OP(ctx-&gt;pctx)
-                    &amp;&amp; ctx-&gt;pctx-&gt;op.kex.exchprovctx == NULL)
+                    &amp;&amp; ctx-&gt;pctx-&gt;op.kex.algctx == NULL)
                 || (EVP_PKEY_CTX_IS_ASYM_CIPHER_OP(ctx-&gt;pctx)
-                    &amp;&amp; ctx-&gt;pctx-&gt;op.ciph.ciphprovctx == NULL)
+                    &amp;&amp; ctx-&gt;pctx-&gt;op.ciph.algctx == NULL)
                 || (EVP_PKEY_CTX_IS_KEM_OP(ctx-&gt;pctx)
-                    &amp;&amp; ctx-&gt;pctx-&gt;op.encap.kemprovctx == NULL)
+                    &amp;&amp; ctx-&gt;pctx-&gt;op.encap.algctx == NULL)
                 /*
                  * The following may be unnecessary, but we have them
                  * for good measure...
diff --git a/crypto/evp/digest.c b/crypto/evp/digest.c
index 25ce609854..b202d466e4 100644
--- a/crypto/evp/digest.c
+++ b/crypto/evp/digest.c
@@ -26,10 +26,10 @@
 
 void evp_md_ctx_clear_digest(EVP_MD_CTX *ctx, int force)
 {
-    if (ctx-&gt;provctx != NULL) {
+    if (ctx-&gt;algctx != NULL) {
         if (ctx-&gt;digest != NULL &amp;&amp; ctx-&gt;digest-&gt;freectx != NULL)
-            ctx-&gt;digest-&gt;freectx(ctx-&gt;provctx);
-        ctx-&gt;provctx = NULL;
+            ctx-&gt;digest-&gt;freectx(ctx-&gt;algctx);
+        ctx-&gt;algctx = NULL;
         EVP_MD_CTX_set_flags(ctx, EVP_MD_CTX_FLAG_CLEANED);
     }
 
@@ -132,7 +132,7 @@ static int evp_md_init_internal(EVP_MD_CTX *ctx, const EVP_MD *type,
 #if !defined(FIPS_MODULE)
     if (ctx-&gt;pctx != NULL
             &amp;&amp; EVP_PKEY_CTX_IS_SIGNATURE_OP(ctx-&gt;pctx)
-            &amp;&amp; ctx-&gt;pctx-&gt;op.sig.sigprovctx != NULL) {
+            &amp;&amp; ctx-&gt;pctx-&gt;op.sig.algctx != NULL) {
         /*
          * Prior to OpenSSL 3.0 calling EVP_DigestInit_ex() on an mdctx
          * previously initialised with EVP_DigestSignInit() would retain
@@ -150,14 +150,14 @@ static int evp_md_init_internal(EVP_MD_CTX *ctx, const EVP_MD *type,
 
     EVP_MD_CTX_clear_flags(ctx, EVP_MD_CTX_FLAG_CLEANED);
 
-    if (ctx-&gt;provctx != NULL) {
+    if (ctx-&gt;algctx != NULL) {
         if (!ossl_assert(ctx-&gt;digest != NULL)) {
             ERR_raise(ERR_LIB_EVP, EVP_R_INITIALIZATION_ERROR);
             return 0;
         }
         if (ctx-&gt;digest-&gt;freectx != NULL)
-            ctx-&gt;digest-&gt;freectx(ctx-&gt;provctx);
-        ctx-&gt;provctx = NULL;
+            ctx-&gt;digest-&gt;freectx(ctx-&gt;algctx);
+        ctx-&gt;algctx = NULL;
     }
 
     if (type != NULL) {
@@ -238,10 +238,10 @@ static int evp_md_init_internal(EVP_MD_CTX *ctx, const EVP_MD *type,
 #endif
     }
 
-    if (ctx-&gt;provctx != NULL &amp;&amp; ctx-&gt;digest != NULL &amp;&amp; ctx-&gt;digest != type) {
+    if (ctx-&gt;algctx != NULL &amp;&amp; ctx-&gt;digest != NULL &amp;&amp; ctx-&gt;digest != type) {
         if (ctx-&gt;digest-&gt;freectx != NULL)
-            ctx-&gt;digest-&gt;freectx(ctx-&gt;provctx);
-        ctx-&gt;provctx = NULL;
+            ctx-&gt;digest-&gt;freectx(ctx-&gt;algctx);
+        ctx-&gt;algctx = NULL;
     }
     if (type-&gt;prov != NULL &amp;&amp; ctx-&gt;fetched_digest != type) {
         if (!EVP_MD_up_ref((EVP_MD *)type)) {
@@ -252,9 +252,9 @@ static int evp_md_init_internal(EVP_MD_CTX *ctx, const EVP_MD *type,
         ctx-&gt;fetched_digest = (EVP_MD *)type;
     }
     ctx-&gt;digest = type;
-    if (ctx-&gt;provctx == NULL) {
-        ctx-&gt;provctx = ctx-&gt;digest-&gt;newctx(ossl_provider_ctx(type-&gt;prov));
-        if (ctx-&gt;provctx == NULL) {
+    if (ctx-&gt;algctx == NULL) {
+        ctx-&gt;algctx = ctx-&gt;digest-&gt;newctx(ossl_provider_ctx(type-&gt;prov));
+        if (ctx-&gt;algctx == NULL) {
             ERR_raise(ERR_LIB_EVP, EVP_R_INITIALIZATION_ERROR);
             return 0;
         }
@@ -265,7 +265,7 @@ static int evp_md_init_internal(EVP_MD_CTX *ctx, const EVP_MD *type,
         return 0;
     }
 
-    return ctx-&gt;digest-&gt;dinit(ctx-&gt;provctx, params);
+    return ctx-&gt;digest-&gt;dinit(ctx-&gt;algctx, params);
 
     /* Code below to be removed when legacy support is dropped. */
  legacy:
@@ -359,7 +359,7 @@ int EVP_DigestUpdate(EVP_MD_CTX *ctx, const void *data, size_t count)
 
     if (ctx-&gt;pctx != NULL
             &amp;&amp; EVP_PKEY_CTX_IS_SIGNATURE_OP(ctx-&gt;pctx)
-            &amp;&amp; ctx-&gt;pctx-&gt;op.sig.sigprovctx != NULL) {
+            &amp;&amp; ctx-&gt;pctx-&gt;op.sig.algctx != NULL) {
         /*
          * Prior to OpenSSL 3.0 EVP_DigestSignUpdate() and
          * EVP_DigestVerifyUpdate() were just macros for EVP_DigestUpdate().
@@ -385,7 +385,7 @@ int EVP_DigestUpdate(EVP_MD_CTX *ctx, const void *data, size_t count)
         ERR_raise(ERR_LIB_EVP, EVP_R_UPDATE_ERROR);
         return 0;
     }
-    return ctx-&gt;digest-&gt;dupdate(ctx-&gt;provctx, data, count);
+    return ctx-&gt;digest-&gt;dupdate(ctx-&gt;algctx, data, count);
 
     /* Code below to be removed when legacy support is dropped. */
  legacy:
@@ -423,7 +423,7 @@ int EVP_DigestFinal_ex(EVP_MD_CTX *ctx, unsigned char *md, unsigned int *isize)
         return 0;
     }
 
-    ret = ctx-&gt;digest-&gt;dfinal(ctx-&gt;provctx, md, &amp;size, mdsize);
+    ret = ctx-&gt;digest-&gt;dfinal(ctx-&gt;algctx, md, &amp;size, mdsize);
 
     if (isize != NULL) {
         if (size &lt;= UINT_MAX) {
@@ -473,7 +473,7 @@ int EVP_DigestFinalXOF(EVP_MD_CTX *ctx, unsigned char *md, size_t size)
     params[i++] = OSSL_PARAM_construct_end();
 
     if (EVP_MD_CTX_set_params(ctx, params) &gt; 0)
-        ret = ctx-&gt;digest-&gt;dfinal(ctx-&gt;provctx, md, &amp;size, size);
+        ret = ctx-&gt;digest-&gt;dfinal(ctx-&gt;algctx, md, &amp;size, size);
 
     return ret;
 
@@ -524,14 +524,14 @@ int EVP_MD_CTX_copy_ex(EVP_MD_CTX *out, const EVP_MD_CTX *in)
     *out = *in;
     /* NULL out pointers in case of error */
     out-&gt;pctx = NULL;
-    out-&gt;provctx = NULL;
+    out-&gt;algctx = NULL;
 
     if (in-&gt;fetched_digest != NULL)
         EVP_MD_up_ref(in-&gt;fetched_digest);
 
-    if (in-&gt;provctx != NULL) {
-        out-&gt;provctx = in-&gt;digest-&gt;dupctx(in-&gt;provctx);
-        if (out-&gt;provctx == NULL) {
+    if (in-&gt;algctx != NULL) {
+        out-&gt;algctx = in-&gt;digest-&gt;dupctx(in-&gt;algctx);
+        if (out-&gt;algctx == NULL) {
             ERR_raise(ERR_LIB_EVP, EVP_R_NOT_ABLE_TO_COPY_CTX);
             return 0;
         }
@@ -666,24 +666,24 @@ int EVP_MD_CTX_set_params(EVP_MD_CTX *ctx, const OSSL_PARAM params[])
     if (pctx != NULL
             &amp;&amp; (pctx-&gt;operation == EVP_PKEY_OP_VERIFYCTX
                 || pctx-&gt;operation == EVP_PKEY_OP_SIGNCTX)
-            &amp;&amp; pctx-&gt;op.sig.sigprovctx != NULL
+            &amp;&amp; pctx-&gt;op.sig.algctx != NULL
             &amp;&amp; pctx-&gt;op.sig.signature-&gt;set_ctx_md_params != NULL)
-        return pctx-&gt;op.sig.signature-&gt;set_ctx_md_params(pctx-&gt;op.sig.sigprovctx,
+        return pctx-&gt;op.sig.signature-&gt;set_ctx_md_params(pctx-&gt;op.sig.algctx,
                                                          params);
 
     if (ctx-&gt;digest != NULL &amp;&amp; ctx-&gt;digest-&gt;set_ctx_params != NULL)
-        return ctx-&gt;digest-&gt;set_ctx_params(ctx-&gt;provctx, params);
+        return ctx-&gt;digest-&gt;set_ctx_params(ctx-&gt;algctx, params);
 
     return 0;
 }
 
 const OSSL_PARAM *EVP_MD_settable_ctx_params(const EVP_MD *md)
 {
-    void *alg;
+    void *provctx;
 
     if (md != NULL &amp;&amp; md-&gt;settable_ctx_params != NULL) {
-        alg = ossl_provider_ctx(EVP_MD_provider(md));
-        return md-&gt;settable_ctx_params(NULL, alg);
+        provctx = ossl_provider_ctx(EVP_MD_provider(md));
+        return md-&gt;settable_ctx_params(NULL, provctx);
     }
     return NULL;
 }
@@ -701,14 +701,14 @@ const OSSL_PARAM *EVP_MD_CTX_settable_params(EVP_MD_CTX *ctx)
     if (pctx != NULL
             &amp;&amp; (pctx-&gt;operation == EVP_PKEY_OP_VERIFYCTX
                 || pctx-&gt;operation == EVP_PKEY_OP_SIGNCTX)
-            &amp;&amp; pctx-&gt;op.sig.sigprovctx != NULL
+            &amp;&amp; pctx-&gt;op.sig.algctx != NULL
             &amp;&amp; pctx-&gt;op.sig.signature-&gt;settable_ctx_md_params != NULL)
         return pctx-&gt;op.sig.signature-&gt;settable_ctx_md_params(
-                   pctx-&gt;op.sig.sigprovctx);
+                   pctx-&gt;op.sig.algctx);
 
     if (ctx-&gt;digest != NULL &amp;&amp; ctx-&gt;digest-&gt;settable_ctx_params != NULL) {
         alg = ossl_provider_ctx(EVP_MD_provider(ctx-&gt;digest));
-        return ctx-&gt;digest-&gt;settable_ctx_params(ctx-&gt;provctx, alg);
+        return ctx-&gt;digest-&gt;settable_ctx_params(ctx-&gt;algctx, alg);
     }
 
     return NULL;
@@ -722,24 +722,24 @@ int EVP_MD_CTX_get_params(EVP_MD_CTX *ctx, OSSL_PARAM params[])
     if (pctx != NULL
             &amp;&amp; (pctx-&gt;operation == EVP_PKEY_OP_VERIFYCTX
                 || pctx-&gt;operation == EVP_PKEY_OP_SIGNCTX)
-            &amp;&amp; pctx-&gt;op.sig.sigprovctx != NULL
+            &amp;&amp; pctx-&gt;op.sig.algctx != NULL
             &amp;&amp; pctx-&gt;op.sig.signature-&gt;get_ctx_md_params != NULL)
-        return pctx-&gt;op.sig.signature-&gt;get_ctx_md_params(pctx-&gt;op.sig.sigprovctx,
+        return pctx-&gt;op.sig.signature-&gt;get_ctx_md_params(pctx-&gt;op.sig.algctx,
                                                          params);
 
     if (ctx-&gt;digest != NULL &amp;&amp; ctx-&gt;digest-&gt;get_params != NULL)
-        return ctx-&gt;digest-&gt;get_ctx_params(ctx-&gt;provctx, params);
+        return ctx-&gt;digest-&gt;get_ctx_params(ctx-&gt;algctx, params);
 
     return 0;
 }
 
 const OSSL_PARAM *EVP_MD_gettable_ctx_params(const EVP_MD *md)
 {
-    void *alg;
+    void *provctx;
 
     if (md != NULL &amp;&amp; md-&gt;gettable_ctx_params != NULL) {
-        alg = ossl_provider_ctx(EVP_MD_provider(md));
-        return md-&gt;gettable_ctx_params(NULL, alg);
+        provctx = ossl_provider_ctx(EVP_MD_provider(md));
+        return md-&gt;gettable_ctx_params(NULL, provctx);
     }
     return NULL;
 }
@@ -747,7 +747,7 @@ const OSSL_PARAM *EVP_MD_gettable_ctx_params(const EVP_MD *md)
 const OSSL_PARAM *EVP_MD_CTX_gettable_params(EVP_MD_CTX *ctx)
 {
     EVP_PKEY_CTX *pctx;
-    void *alg;
+    void *provctx;
 
     if (ctx == NULL)
         return NULL;
@@ -757,14 +757,14 @@ const OSSL_PARAM *EVP_MD_CTX_gettable_params(EVP_MD_CTX *ctx)
     if (pctx != NULL
             &amp;&amp; (pctx-&gt;operation == EVP_PKEY_OP_VERIFYCTX
                 || pctx-&gt;operation == EVP_PKEY_OP_SIGNCTX)
-            &amp;&amp; pctx-&gt;op.sig.sigprovctx != NULL
+            &amp;&amp; pctx-&gt;op.sig.algctx != NULL
             &amp;&amp; pctx-&gt;op.sig.signature-&gt;gettable_ctx_md_params != NULL)
         return pctx-&gt;op.sig.signature-&gt;gettable_ctx_md_params(
-                    pctx-&gt;op.sig.sigprovctx);
+                    pctx-&gt;op.sig.algctx);
 
     if (ctx-&gt;digest != NULL &amp;&amp; ctx-&gt;digest-&gt;gettable_ctx_params != NULL) {
-        alg = ossl_provider_ctx(EVP_MD_provider(ctx-&gt;digest));
-        return ctx-&gt;digest-&gt;gettable_ctx_params(ctx-&gt;provctx, alg);
+        provctx = ossl_provider_ctx(EVP_MD_provider(ctx-&gt;digest));
+        return ctx-&gt;digest-&gt;gettable_ctx_params(ctx-&gt;algctx, provctx);
     }
     return NULL;
 }
diff --git a/crypto/evp/evp_enc.c b/crypto/evp/evp_enc.c
index 50e1c3452b..143ae1b076 100644
--- a/crypto/evp/evp_enc.c
+++ b/crypto/evp/evp_enc.c
@@ -33,10 +33,10 @@ int EVP_CIPHER_CTX_reset(EVP_CIPHER_CTX *ctx)
     if (ctx-&gt;cipher == NULL || ctx-&gt;cipher-&gt;prov == NULL)
         goto legacy;
 
-    if (ctx-&gt;provctx != NULL) {
+    if (ctx-&gt;algctx != NULL) {
         if (ctx-&gt;cipher-&gt;freectx != NULL)
-            ctx-&gt;cipher-&gt;freectx(ctx-&gt;provctx);
-        ctx-&gt;provctx = NULL;
+            ctx-&gt;cipher-&gt;freectx(ctx-&gt;algctx);
+        ctx-&gt;algctx = NULL;
     }
     if (ctx-&gt;fetched_cipher != NULL)
         EVP_CIPHER_free(ctx-&gt;fetched_cipher);
@@ -190,9 +190,9 @@ static int evp_cipher_init_internal(EVP_CIPHER_CTX *ctx,
         ctx-&gt;fetched_cipher = (EVP_CIPHER *)cipher;
     }
     ctx-&gt;cipher = cipher;
-    if (ctx-&gt;provctx == NULL) {
-        ctx-&gt;provctx = ctx-&gt;cipher-&gt;newctx(ossl_provider_ctx(cipher-&gt;prov));
-        if (ctx-&gt;provctx == NULL) {
+    if (ctx-&gt;algctx == NULL) {
+        ctx-&gt;algctx = ctx-&gt;cipher-&gt;newctx(ossl_provider_ctx(cipher-&gt;prov));
+        if (ctx-&gt;algctx == NULL) {
             ERR_raise(ERR_LIB_EVP, EVP_R_INITIALIZATION_ERROR);
             return 0;
         }
@@ -213,7 +213,7 @@ static int evp_cipher_init_internal(EVP_CIPHER_CTX *ctx,
             return 0;
         }
 
-        return ctx-&gt;cipher-&gt;einit(ctx-&gt;provctx,
+        return ctx-&gt;cipher-&gt;einit(ctx-&gt;algctx,
                                   key,
                                   key == NULL ? 0
                                               : EVP_CIPHER_CTX_key_length(ctx),
@@ -228,7 +228,7 @@ static int evp_cipher_init_internal(EVP_CIPHER_CTX *ctx,
         return 0;
     }
 
-    return ctx-&gt;cipher-&gt;dinit(ctx-&gt;provctx,
+    return ctx-&gt;cipher-&gt;dinit(ctx-&gt;algctx,
                               key,
                               key == NULL ? 0
                                           : EVP_CIPHER_CTX_key_length(ctx),
@@ -620,7 +620,7 @@ int EVP_EncryptUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl,
         ERR_raise(ERR_LIB_EVP, EVP_R_UPDATE_ERROR);
         return 0;
     }
-    ret = ctx-&gt;cipher-&gt;cupdate(ctx-&gt;provctx, out, &amp;soutl,
+    ret = ctx-&gt;cipher-&gt;cupdate(ctx-&gt;algctx, out, &amp;soutl,
                                inl + (blocksize == 1 ? 0 : blocksize), in,
                                (size_t)inl);
 
@@ -681,7 +681,7 @@ int EVP_EncryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
         return 0;
     }
 
-    ret = ctx-&gt;cipher-&gt;cfinal(ctx-&gt;provctx, out, &amp;soutl,
+    ret = ctx-&gt;cipher-&gt;cfinal(ctx-&gt;algctx, out, &amp;soutl,
                               blocksize == 1 ? 0 : blocksize);
 
     if (ret) {
@@ -767,7 +767,7 @@ int EVP_DecryptUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl,
         ERR_raise(ERR_LIB_EVP, EVP_R_UPDATE_ERROR);
         return 0;
     }
-    ret = ctx-&gt;cipher-&gt;cupdate(ctx-&gt;provctx, out, &amp;soutl,
+    ret = ctx-&gt;cipher-&gt;cupdate(ctx-&gt;algctx, out, &amp;soutl,
                                inl + (blocksize == 1 ? 0 : blocksize), in,
                                (size_t)inl);
 
@@ -903,7 +903,7 @@ int EVP_DecryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
         return 0;
     }
 
-    ret = ctx-&gt;cipher-&gt;cfinal(ctx-&gt;provctx, out, &amp;soutl,
+    ret = ctx-&gt;cipher-&gt;cfinal(ctx-&gt;algctx, out, &amp;soutl,
                               blocksize == 1 ? 0 : blocksize);
 
     if (ret) {
@@ -985,7 +985,7 @@ int EVP_CIPHER_CTX_set_key_length(EVP_CIPHER_CTX *c, int keylen)
             return 0;
 
         params[0] = OSSL_PARAM_construct_size_t(OSSL_CIPHER_PARAM_KEYLEN, &amp;len);
-        ok = evp_do_ciph_ctx_setparams(c-&gt;cipher, c-&gt;provctx, params);
+        ok = evp_do_ciph_ctx_setparams(c-&gt;cipher, c-&gt;algctx, params);
 
         return ok &gt; 0 ? 1 : 0;
     }
@@ -1022,7 +1022,7 @@ int EVP_CIPHER_CTX_set_padding(EVP_CIPHER_CTX *ctx, int pad)
     if (ctx-&gt;cipher != NULL &amp;&amp; ctx-&gt;cipher-&gt;prov == NULL)
         return 1;
     params[0] = OSSL_PARAM_construct_uint(OSSL_CIPHER_PARAM_PADDING, &amp;pd);
-    ok = evp_do_ciph_ctx_setparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+    ok = evp_do_ciph_ctx_setparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
 
     return ok != 0;
 }
@@ -1115,12 +1115,12 @@ int EVP_CIPHER_CTX_ctrl(EVP_CIPHER_CTX *ctx, int type, int arg, void *ptr)
         params[0] =
             OSSL_PARAM_construct_octet_string(OSSL_CIPHER_PARAM_AEAD_TLS1_AAD,
                                               ptr, sz);
-        ret = evp_do_ciph_ctx_setparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+        ret = evp_do_ciph_ctx_setparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
         if (ret &lt;= 0)
             goto end;
         params[0] =
             OSSL_PARAM_construct_size_t(OSSL_CIPHER_PARAM_AEAD_TLS1_AAD_PAD, &amp;sz);
-        ret = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+        ret = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
         if (ret &lt;= 0)
             goto end;
         return sz;
@@ -1135,14 +1135,14 @@ int EVP_CIPHER_CTX_ctrl(EVP_CIPHER_CTX *ctx, int type, int arg, void *ptr)
     case EVP_CTRL_TLS1_1_MULTIBLOCK_MAX_BUFSIZE:
         params[0] = OSSL_PARAM_construct_size_t(
                 OSSL_CIPHER_PARAM_TLS1_MULTIBLOCK_MAX_SEND_FRAGMENT, &amp;sz);
-        ret = evp_do_ciph_ctx_setparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+        ret = evp_do_ciph_ctx_setparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
         if (ret &lt;= 0)
             return 0;
 
         params[0] = OSSL_PARAM_construct_size_t(
                 OSSL_CIPHER_PARAM_TLS1_MULTIBLOCK_MAX_BUFSIZE, &amp;sz);
         params[1] = OSSL_PARAM_construct_end();
-        ret = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+        ret = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
         if (ret &lt;= 0)
             return 0;
         return sz;
@@ -1157,7 +1157,7 @@ int EVP_CIPHER_CTX_ctrl(EVP_CIPHER_CTX *ctx, int type, int arg, void *ptr)
                 OSSL_CIPHER_PARAM_TLS1_MULTIBLOCK_AAD, (void*)p-&gt;inp, p-&gt;len);
         params[1] = OSSL_PARAM_construct_uint(
                 OSSL_CIPHER_PARAM_TLS1_MULTIBLOCK_INTERLEAVE, &amp;p-&gt;interleave);
-        ret = evp_do_ciph_ctx_setparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+        ret = evp_do_ciph_ctx_setparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
         if (ret &lt;= 0)
             return ret;
         /* Retrieve the return values changed by the set */
@@ -1166,7 +1166,7 @@ int EVP_CIPHER_CTX_ctrl(EVP_CIPHER_CTX *ctx, int type, int arg, void *ptr)
         params[1] = OSSL_PARAM_construct_uint(
                 OSSL_CIPHER_PARAM_TLS1_MULTIBLOCK_INTERLEAVE, &amp;p-&gt;interleave);
         params[2] = OSSL_PARAM_construct_end();
-        ret = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+        ret = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
         if (ret &lt;= 0)
             return 0;
         return sz;
@@ -1183,13 +1183,13 @@ int EVP_CIPHER_CTX_ctrl(EVP_CIPHER_CTX *ctx, int type, int arg, void *ptr)
                 p-&gt;len);
         params[2] = OSSL_PARAM_construct_uint(
                 OSSL_CIPHER_PARAM_TLS1_MULTIBLOCK_INTERLEAVE, &amp;p-&gt;interleave);
-        ret = evp_do_ciph_ctx_setparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+        ret = evp_do_ciph_ctx_setparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
         if (ret &lt;= 0)
             return ret;
         params[0] = OSSL_PARAM_construct_size_t(
                         OSSL_CIPHER_PARAM_TLS1_MULTIBLOCK_ENC_LEN, &amp;sz);
         params[1] = OSSL_PARAM_construct_end();
-        ret = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+        ret = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
         if (ret &lt;= 0)
             return 0;
         return sz;
@@ -1204,9 +1204,9 @@ int EVP_CIPHER_CTX_ctrl(EVP_CIPHER_CTX *ctx, int type, int arg, void *ptr)
     }
 
     if (set_params)
-        ret = evp_do_ciph_ctx_setparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+        ret = evp_do_ciph_ctx_setparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
     else
-        ret = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+        ret = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
     goto end;
 
     /* Code below to be removed when legacy support is dropped. */
@@ -1236,14 +1236,14 @@ int EVP_CIPHER_get_params(EVP_CIPHER *cipher, OSSL_PARAM params[])
 int EVP_CIPHER_CTX_set_params(EVP_CIPHER_CTX *ctx, const OSSL_PARAM params[])
 {
     if (ctx-&gt;cipher != NULL &amp;&amp; ctx-&gt;cipher-&gt;set_ctx_params != NULL)
-        return ctx-&gt;cipher-&gt;set_ctx_params(ctx-&gt;provctx, params);
+        return ctx-&gt;cipher-&gt;set_ctx_params(ctx-&gt;algctx, params);
     return 0;
 }
 
 int EVP_CIPHER_CTX_get_params(EVP_CIPHER_CTX *ctx, OSSL_PARAM params[])
 {
     if (ctx-&gt;cipher != NULL &amp;&amp; ctx-&gt;cipher-&gt;get_ctx_params != NULL)
-        return ctx-&gt;cipher-&gt;get_ctx_params(ctx-&gt;provctx, params);
+        return ctx-&gt;cipher-&gt;get_ctx_params(ctx-&gt;algctx, params);
     return 0;
 }
 
@@ -1257,22 +1257,22 @@ const OSSL_PARAM *EVP_CIPHER_gettable_params(const EVP_CIPHER *cipher)
 
 const OSSL_PARAM *EVP_CIPHER_settable_ctx_params(const EVP_CIPHER *cipher)
 {
-    void *alg;
+    void *provctx;
 
     if (cipher != NULL &amp;&amp; cipher-&gt;settable_ctx_params != NULL) {
-        alg = ossl_provider_ctx(EVP_CIPHER_provider(cipher));
-        return cipher-&gt;settable_ctx_params(NULL, alg);
+        provctx = ossl_provider_ctx(EVP_CIPHER_provider(cipher));
+        return cipher-&gt;settable_ctx_params(NULL, provctx);
     }
     return NULL;
 }
 
 const OSSL_PARAM *EVP_CIPHER_gettable_ctx_params(const EVP_CIPHER *cipher)
 {
-    void *alg;
+    void *provctx;
 
     if (cipher != NULL &amp;&amp; cipher-&gt;gettable_ctx_params != NULL) {
-        alg = ossl_provider_ctx(EVP_CIPHER_provider(cipher));
-        return cipher-&gt;gettable_ctx_params(NULL, alg);
+        provctx = ossl_provider_ctx(EVP_CIPHER_provider(cipher));
+        return cipher-&gt;gettable_ctx_params(NULL, provctx);
     }
     return NULL;
 }
@@ -1283,18 +1283,18 @@ const OSSL_PARAM *EVP_CIPHER_CTX_settable_params(EVP_CIPHER_CTX *cctx)
 
     if (cctx != NULL &amp;&amp; cctx-&gt;cipher-&gt;settable_ctx_params != NULL) {
         alg = ossl_provider_ctx(EVP_CIPHER_provider(cctx-&gt;cipher));
-        return cctx-&gt;cipher-&gt;settable_ctx_params(cctx-&gt;provctx, alg);
+        return cctx-&gt;cipher-&gt;settable_ctx_params(cctx-&gt;algctx, alg);
     }
     return NULL;
 }
 
 const OSSL_PARAM *EVP_CIPHER_CTX_gettable_params(EVP_CIPHER_CTX *cctx)
 {
-    void *alg;
+    void *provctx;
 
     if (cctx != NULL &amp;&amp; cctx-&gt;cipher-&gt;gettable_ctx_params != NULL) {
-        alg = ossl_provider_ctx(EVP_CIPHER_provider(cctx-&gt;cipher));
-        return cctx-&gt;cipher-&gt;gettable_ctx_params(cctx-&gt;provctx, alg);
+        provctx = ossl_provider_ctx(EVP_CIPHER_provider(cctx-&gt;cipher));
+        return cctx-&gt;cipher-&gt;gettable_ctx_params(cctx-&gt;algctx, provctx);
     }
     return NULL;
 }
@@ -1351,15 +1351,15 @@ int EVP_CIPHER_CTX_copy(EVP_CIPHER_CTX *out, const EVP_CIPHER_CTX *in)
     EVP_CIPHER_CTX_reset(out);
 
     *out = *in;
-    out-&gt;provctx = NULL;
+    out-&gt;algctx = NULL;
 
     if (in-&gt;fetched_cipher != NULL &amp;&amp; !EVP_CIPHER_up_ref(in-&gt;fetched_cipher)) {
         out-&gt;fetched_cipher = NULL;
         return 0;
     }
 
-    out-&gt;provctx = in-&gt;cipher-&gt;dupctx(in-&gt;provctx);
-    if (out-&gt;provctx == NULL) {
+    out-&gt;algctx = in-&gt;cipher-&gt;dupctx(in-&gt;algctx);
+    if (out-&gt;algctx == NULL) {
         ERR_raise(ERR_LIB_EVP, EVP_R_NOT_ABLE_TO_COPY_CTX);
         return 0;
     }
diff --git a/crypto/evp/evp_lib.c b/crypto/evp/evp_lib.c
index 7d40113790..adae97b8f5 100644
--- a/crypto/evp/evp_lib.c
+++ b/crypto/evp/evp_lib.c
@@ -412,16 +412,16 @@ int EVP_Cipher(EVP_CIPHER_CTX *ctx, unsigned char *out,
         size_t blocksize = EVP_CIPHER_CTX_block_size(ctx);
 
         if (ctx-&gt;cipher-&gt;ccipher != NULL)
-            ret =  ctx-&gt;cipher-&gt;ccipher(ctx-&gt;provctx, out, &amp;outl,
+            ret =  ctx-&gt;cipher-&gt;ccipher(ctx-&gt;algctx, out, &amp;outl,
                                         inl + (blocksize == 1 ? 0 : blocksize),
                                         in, (size_t)inl)
                 ? (int)outl : -1;
         else if (in != NULL)
-            ret = ctx-&gt;cipher-&gt;cupdate(ctx-&gt;provctx, out, &amp;outl,
+            ret = ctx-&gt;cipher-&gt;cupdate(ctx-&gt;algctx, out, &amp;outl,
                                        inl + (blocksize == 1 ? 0 : blocksize),
                                        in, (size_t)inl);
         else
-            ret = ctx-&gt;cipher-&gt;cfinal(ctx-&gt;provctx, out, &amp;outl,
+            ret = ctx-&gt;cipher-&gt;cfinal(ctx-&gt;algctx, out, &amp;outl,
                                       blocksize == 1 ? 0 : blocksize);
 
         return ret;
@@ -505,7 +505,7 @@ int EVP_CIPHER_CTX_iv_length(const EVP_CIPHER_CTX *ctx)
     OSSL_PARAM params[2] = { OSSL_PARAM_END, OSSL_PARAM_END };
 
     params[0] = OSSL_PARAM_construct_size_t(OSSL_CIPHER_PARAM_IVLEN, &amp;v);
-    rv = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+    rv = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
     if (rv == EVP_CTRL_RET_UNSUPPORTED)
         goto legacy;
     return rv != 0 ? (int)v : -1;
@@ -526,7 +526,7 @@ int EVP_CIPHER_CTX_tag_length(const EVP_CIPHER_CTX *ctx)
     OSSL_PARAM params[2] = { OSSL_PARAM_END, OSSL_PARAM_END };
 
     params[0] = OSSL_PARAM_construct_size_t(OSSL_CIPHER_PARAM_AEAD_TAGLEN, &amp;v);
-    ret = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+    ret = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
     return ret == 1 ? (int)v : 0;
 }
 
@@ -540,7 +540,7 @@ const unsigned char *EVP_CIPHER_CTX_original_iv(const EVP_CIPHER_CTX *ctx)
     params[0] =
         OSSL_PARAM_construct_octet_ptr(OSSL_CIPHER_PARAM_IV,
                                        (void **)&amp;v, sizeof(ctx-&gt;oiv));
-    ok = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+    ok = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
 
     return ok != 0 ? v : NULL;
 }
@@ -557,7 +557,7 @@ const unsigned char *EVP_CIPHER_CTX_iv(const EVP_CIPHER_CTX *ctx)
     params[0] =
         OSSL_PARAM_construct_octet_ptr(OSSL_CIPHER_PARAM_UPDATED_IV,
                                        (void **)&amp;v, sizeof(ctx-&gt;iv));
-    ok = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+    ok = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
 
     return ok != 0 ? v : NULL;
 }
@@ -571,7 +571,7 @@ unsigned char *EVP_CIPHER_CTX_iv_noconst(EVP_CIPHER_CTX *ctx)
     params[0] =
         OSSL_PARAM_construct_octet_ptr(OSSL_CIPHER_PARAM_UPDATED_IV,
                                        (void **)&amp;v, sizeof(ctx-&gt;iv));
-    ok = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+    ok = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
 
     return ok != 0 ? v : NULL;
 }
@@ -583,7 +583,7 @@ int EVP_CIPHER_CTX_get_updated_iv(EVP_CIPHER_CTX *ctx, void *buf, size_t len)
 
     params[0] =
         OSSL_PARAM_construct_octet_string(OSSL_CIPHER_PARAM_UPDATED_IV, buf, len);
-    return evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+    return evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
 }
 
 int EVP_CIPHER_CTX_get_original_iv(EVP_CIPHER_CTX *ctx, void *buf, size_t len)
@@ -592,7 +592,7 @@ int EVP_CIPHER_CTX_get_original_iv(EVP_CIPHER_CTX *ctx, void *buf, size_t len)
 
     params[0] =
         OSSL_PARAM_construct_octet_string(OSSL_CIPHER_PARAM_IV, buf, len);
-    return evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+    return evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
 }
 
 unsigned char *EVP_CIPHER_CTX_buf_noconst(EVP_CIPHER_CTX *ctx)
@@ -607,7 +607,7 @@ int EVP_CIPHER_CTX_num(const EVP_CIPHER_CTX *ctx)
     OSSL_PARAM params[2] = { OSSL_PARAM_END, OSSL_PARAM_END };
 
     params[0] = OSSL_PARAM_construct_uint(OSSL_CIPHER_PARAM_NUM, &amp;v);
-    ok = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+    ok = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
 
     return ok != 0 ? (int)v : EVP_CTRL_RET_UNSUPPORTED;
 }
@@ -619,7 +619,7 @@ int EVP_CIPHER_CTX_set_num(EVP_CIPHER_CTX *ctx, int num)
     OSSL_PARAM params[2] = { OSSL_PARAM_END, OSSL_PARAM_END };
 
     params[0] = OSSL_PARAM_construct_uint(OSSL_CIPHER_PARAM_NUM, &amp;n);
-    ok = evp_do_ciph_ctx_setparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+    ok = evp_do_ciph_ctx_setparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
 
     if (ok != 0)
         ctx-&gt;num = (int)n;
@@ -638,7 +638,7 @@ int EVP_CIPHER_CTX_key_length(const EVP_CIPHER_CTX *ctx)
     OSSL_PARAM params[2] = { OSSL_PARAM_END, OSSL_PARAM_END };
 
     params[0] = OSSL_PARAM_construct_size_t(OSSL_CIPHER_PARAM_KEYLEN, &amp;v);
-    ok = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;provctx, params);
+    ok = evp_do_ciph_ctx_getparams(ctx-&gt;cipher, ctx-&gt;algctx, params);
 
     return ok != 0 ? (int)v : EVP_CTRL_RET_UNSUPPORTED;
 }
diff --git a/crypto/evp/evp_local.h b/crypto/evp/evp_local.h
index 1490f0df4f..a0f363805c 100644
--- a/crypto/evp/evp_local.h
+++ b/crypto/evp/evp_local.h
@@ -7,8 +7,6 @@
  * <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
  */
 
-/* EVP_MD_CTX related stuff */
-
 #include &lt;openssl/core_dispatch.h&gt;
 #include &quot;internal/refcount.h&quot;
 
@@ -27,8 +25,11 @@ struct evp_md_ctx_st {
     /* Update function: usually copied from EVP_MD */
     int (*update) (EVP_MD_CTX *ctx, const void *data, size_t count);
 
-    /* Provider ctx */
-    void *provctx;
+    /*
+     * Opaque ctx returned from a providers digest algorithm implementation
+     * OSSL_FUNC_digest_newctx()
+     */
+    void *algctx;
     EVP_MD *fetched_digest;
 } /* EVP_MD_CTX */ ;
 
@@ -51,24 +52,39 @@ struct evp_cipher_ctx_st {
     int block_mask;
     unsigned char final[EVP_MAX_BLOCK_LENGTH]; /* possible final block */
 
-    /* Provider ctx */
-    void *provctx;
+    /*
+     * Opaque ctx returned from a providers cipher algorithm implementation
+     * OSSL_FUNC_cipher_newctx()
+     */
+    void *algctx;
     EVP_CIPHER *fetched_cipher;
 } /* EVP_CIPHER_CTX */ ;
 
 struct evp_mac_ctx_st {
     EVP_MAC *meth;               /* Method structure */
-    void *data;                  /* Individual method data */
+    /*
+     * Opaque ctx returned from a providers MAC algorithm implementation
+     * OSSL_FUNC_mac_newctx()
+     */
+    void *algctx;
 } /* EVP_MAC_CTX */;
 
 struct evp_kdf_ctx_st {
     EVP_KDF *meth;              /* Method structure */
-    void *data;                 /* Algorithm-specific data */
+    /*
+     * Opaque ctx returned from a providers KDF algorithm implementation
+     * OSSL_FUNC_kdf_newctx()
+     */
+    void *algctx;
 } /* EVP_KDF_CTX */ ;
 
 struct evp_rand_ctx_st {
     EVP_RAND *meth;             /* Method structure */
-    void *data;                 /* Algorithm-specific data */
+    /*
+     * Opaque ctx returned from a providers rand algorithm implementation
+     * OSSL_FUNC_rand_newctx()
+     */
+    void *algctx;
     EVP_RAND_CTX *parent;       /* Parent EVP_RAND or NULL if none */
     CRYPTO_REF_COUNT refcnt;    /* Context reference count */
     CRYPTO_RWLOCK *refcnt_lock;
diff --git a/crypto/evp/evp_rand.c b/crypto/evp/evp_rand.c
index 5cd6588fa8..c886d9a563 100644
--- a/crypto/evp/evp_rand.c
+++ b/crypto/evp/evp_rand.c
@@ -97,7 +97,7 @@ static void *evp_rand_new(void)
 int EVP_RAND_enable_locking(EVP_RAND_CTX *rand)
 {
     if (rand-&gt;meth-&gt;enable_locking != NULL)
-        return rand-&gt;meth-&gt;enable_locking(rand-&gt;data);
+        return rand-&gt;meth-&gt;enable_locking(rand-&gt;algctx);
     ERR_raise(ERR_LIB_EVP, EVP_R_LOCKING_NOT_SUPPORTED);
     return 0;
 }
@@ -106,7 +106,7 @@ int EVP_RAND_enable_locking(EVP_RAND_CTX *rand)
 static int evp_rand_lock(EVP_RAND_CTX *rand)
 {
     if (rand-&gt;meth-&gt;lock != NULL)
-        return rand-&gt;meth-&gt;lock(rand-&gt;data);
+        return rand-&gt;meth-&gt;lock(rand-&gt;algctx);
     return 1;
 }
 
@@ -114,7 +114,7 @@ static int evp_rand_lock(EVP_RAND_CTX *rand)
 static void evp_rand_unlock(EVP_RAND_CTX *rand)
 {
     if (rand-&gt;meth-&gt;unlock != NULL)
-        rand-&gt;meth-&gt;unlock(rand-&gt;data);
+        rand-&gt;meth-&gt;unlock(rand-&gt;algctx);
 }
 
 static void *evp_rand_from_algorithm(int name_id,
@@ -356,14 +356,14 @@ EVP_RAND_CTX *EVP_RAND_CTX_new(EVP_RAND *rand, EVP_RAND_CTX *parent)
             OPENSSL_free(ctx);
             return NULL;
         }
-        parent_ctx = parent-&gt;data;
+        parent_ctx = parent-&gt;algctx;
         parent_dispatch = parent-&gt;meth-&gt;dispatch;
     }
-    if ((ctx-&gt;data = rand-&gt;newctx(ossl_provider_ctx(rand-&gt;prov), parent_ctx,
-                                  parent_dispatch)) == NULL
+    if ((ctx-&gt;algctx = rand-&gt;newctx(ossl_provider_ctx(rand-&gt;prov), parent_ctx,
+                                    parent_dispatch)) == NULL
             || !EVP_RAND_up_ref(rand)) {
         ERR_raise(ERR_LIB_EVP, ERR_R_MALLOC_FAILURE);
-        rand-&gt;freectx(ctx-&gt;data);
+        rand-&gt;freectx(ctx-&gt;algctx);
         CRYPTO_THREAD_lock_free(ctx-&gt;refcnt_lock);
         OPENSSL_free(ctx);
         EVP_RAND_CTX_free(parent);
@@ -387,8 +387,8 @@ void EVP_RAND_CTX_free(EVP_RAND_CTX *ctx)
     if (ref &gt; 0)
         return;
     parent = ctx-&gt;parent;
-    ctx-&gt;meth-&gt;freectx(ctx-&gt;data);
-    ctx-&gt;data = NULL;
+    ctx-&gt;meth-&gt;freectx(ctx-&gt;algctx);
+    ctx-&gt;algctx = NULL;
     EVP_RAND_free(ctx-&gt;meth);
     CRYPTO_THREAD_lock_free(ctx-&gt;refcnt_lock);
     OPENSSL_free(ctx);
@@ -403,7 +403,7 @@ EVP_RAND *EVP_RAND_CTX_rand(EVP_RAND_CTX *ctx)
 static int evp_rand_get_ctx_params_locked(EVP_RAND_CTX *ctx,
                                           OSSL_PARAM params[])
 {
-    return ctx-&gt;meth-&gt;get_ctx_params(ctx-&gt;data, params);
+    return ctx-&gt;meth-&gt;get_ctx_params(ctx-&gt;algctx, params);
 }
 
 int EVP_RAND_CTX_get_params(EVP_RAND_CTX *ctx, OSSL_PARAM params[])
@@ -421,7 +421,7 @@ static int evp_rand_set_ctx_params_locked(EVP_RAND_CTX *ctx,
                                           const OSSL_PARAM params[])
 {
     if (ctx-&gt;meth-&gt;set_ctx_params != NULL)
-        return ctx-&gt;meth-&gt;set_ctx_params(ctx-&gt;data, params);
+        return ctx-&gt;meth-&gt;set_ctx_params(ctx-&gt;algctx, params);
     return 1;
 }
 
@@ -470,7 +470,7 @@ const OSSL_PARAM *EVP_RAND_CTX_gettable_params(EVP_RAND_CTX *ctx)
     if (ctx-&gt;meth-&gt;gettable_ctx_params == NULL)
         return NULL;
     provctx = ossl_provider_ctx(EVP_RAND_provider(ctx-&gt;meth));
-    return ctx-&gt;meth-&gt;gettable_ctx_params(ctx-&gt;data, provctx);
+    return ctx-&gt;meth-&gt;gettable_ctx_params(ctx-&gt;algctx, provctx);
 }
 
 const OSSL_PARAM *EVP_RAND_CTX_settable_params(EVP_RAND_CTX *ctx)
@@ -480,7 +480,7 @@ const OSSL_PARAM *EVP_RAND_CTX_settable_params(EVP_RAND_CTX *ctx)
     if (ctx-&gt;meth-&gt;settable_ctx_params == NULL)
         return NULL;
     provctx = ossl_provider_ctx(EVP_RAND_provider(ctx-&gt;meth));
-    return ctx-&gt;meth-&gt;settable_ctx_params(ctx-&gt;data, provctx);
+    return ctx-&gt;meth-&gt;settable_ctx_params(ctx-&gt;algctx, provctx);
 }
 
 void EVP_RAND_do_all_provided(OSSL_LIB_CTX *libctx,
@@ -506,7 +506,7 @@ static int evp_rand_instantiate_locked
     (EVP_RAND_CTX *ctx, unsigned int strength, int prediction_resistance,
      const unsigned char *pstr, size_t pstr_len, const OSSL_PARAM params[])
 {
-    return ctx-&gt;meth-&gt;instantiate(ctx-&gt;data, strength, prediction_resistance,
+    return ctx-&gt;meth-&gt;instantiate(ctx-&gt;algctx, strength, prediction_resistance,
                                   pstr, pstr_len, params);
 }
 
@@ -527,7 +527,7 @@ int EVP_RAND_instantiate(EVP_RAND_CTX *ctx, unsigned int strength,
 
 static int evp_rand_uninstantiate_locked(EVP_RAND_CTX *ctx)
 {
-    return ctx-&gt;meth-&gt;uninstantiate(ctx-&gt;data);
+    return ctx-&gt;meth-&gt;uninstantiate(ctx-&gt;algctx);
 }
 
 int EVP_RAND_uninstantiate(EVP_RAND_CTX *ctx)
@@ -559,7 +559,7 @@ static int evp_rand_generate_locked(EVP_RAND_CTX *ctx, unsigned char *out,
     }
     for (; outlen &gt; 0; outlen -= chunk, out += chunk) {
         chunk = outlen &gt; max_request ? max_request : outlen;
-        if (!ctx-&gt;meth-&gt;generate(ctx-&gt;data, out, chunk, strength,
+        if (!ctx-&gt;meth-&gt;generate(ctx-&gt;algctx, out, chunk, strength,
                                  prediction_resistance, addin, addin_len)) {
             ERR_raise(ERR_LIB_EVP, EVP_R_GENERATE_ERROR);
             return 0;
@@ -592,7 +592,7 @@ static int evp_rand_reseed_locked(EVP_RAND_CTX *ctx, int prediction_resistance,
                                   const unsigned char *addin, size_t addin_len)
 {
     if (ctx-&gt;meth-&gt;reseed != NULL)
-        return ctx-&gt;meth-&gt;reseed(ctx-&gt;data, prediction_resistance,
+        return ctx-&gt;meth-&gt;reseed(ctx-&gt;algctx, prediction_resistance,
                                  ent, ent_len, addin, addin_len);
     return 1;
 }
@@ -640,7 +640,7 @@ static int evp_rand_nonce_locked(EVP_RAND_CTX *ctx, unsigned char *out,
 
     if (ctx-&gt;meth-&gt;nonce == NULL)
         return 0;
-    if (ctx-&gt;meth-&gt;nonce(ctx-&gt;data, out, str, outlen, outlen))
+    if (ctx-&gt;meth-&gt;nonce(ctx-&gt;algctx, out, str, outlen, outlen))
         return 1;
     return evp_rand_generate_locked(ctx, out, outlen, str, 0, NULL, 0);
 }
@@ -670,7 +670,7 @@ int EVP_RAND_state(EVP_RAND_CTX *ctx)
 static int evp_rand_verify_zeroization_locked(EVP_RAND_CTX *ctx)
 {
     if (ctx-&gt;meth-&gt;verify_zeroization != NULL)
-        return ctx-&gt;meth-&gt;verify_zeroization(ctx-&gt;data);
+        return ctx-&gt;meth-&gt;verify_zeroization(ctx-&gt;algctx);
     return 0;
 }
 
diff --git a/crypto/evp/evp_utils.c b/crypto/evp/evp_utils.c
index ad37698657..3cc17921f8 100644
--- a/crypto/evp/evp_utils.c
+++ b/crypto/evp/evp_utils.c
@@ -1,5 +1,5 @@
 /*
- * Copyright 2019-2020 The OpenSSL Project Authors. All Rights Reserved.
+ * Copyright 2019-2021 The OpenSSL Project Authors. All Rights Reserved.
  *
  * Licensed under the Apache License 2.0 (the &quot;License&quot;).  You may not use
  * this file except in compliance with the License.  You can obtain a copy
@@ -42,10 +42,10 @@ int name (const type *obj, OSSL_PARAM params[])                                \
 }
 
 #define PARAM_CTX_FUNC(name, func, type, err)                                  \
-int name (const type *obj, void *provctx, OSSL_PARAM params[])                 \
+int name (const type *obj, void *algctx, OSSL_PARAM params[])                  \
 {                                                                              \
     PARAM_CHECK(obj, func, err)                                                \
-    return obj-&gt;func(provctx, params);                                         \
+    return obj-&gt;func(algctx, params);                                          \
 }
 
 #define PARAM_FUNCTIONS(type,                                                  \
diff --git a/crypto/evp/exchange.c b/crypto/evp/exchange.c
index 0ff5d8848c..fb5521681a 100644
--- a/crypto/evp/exchange.c
+++ b/crypto/evp/exchange.c
@@ -284,13 +284,13 @@ int EVP_PKEY_derive_init_ex(EVP_PKEY_CTX *ctx, const OSSL_PARAM params[])
     /* No more legacy from here down to legacy: */
 
     ctx-&gt;op.kex.exchange = exchange;
-    ctx-&gt;op.kex.exchprovctx = exchange-&gt;newctx(ossl_provider_ctx(exchange-&gt;prov));
-    if (ctx-&gt;op.kex.exchprovctx == NULL) {
+    ctx-&gt;op.kex.algctx = exchange-&gt;newctx(ossl_provider_ctx(exchange-&gt;prov));
+    if (ctx-&gt;op.kex.algctx == NULL) {
         /* The provider key can stay in the cache */
         ERR_raise(ERR_LIB_EVP, EVP_R_INITIALIZATION_ERROR);
         goto err;
     }
-    ret = exchange-&gt;init(ctx-&gt;op.kex.exchprovctx, provkey, params);
+    ret = exchange-&gt;init(ctx-&gt;op.kex.algctx, provkey, params);
 
     return ret ? 1 : 0;
  err:
@@ -335,7 +335,7 @@ int EVP_PKEY_derive_set_peer_ex(EVP_PKEY_CTX *ctx, EVP_PKEY *peer,
         return -1;
     }
 
-    if (!EVP_PKEY_CTX_IS_DERIVE_OP(ctx) || ctx-&gt;op.kex.exchprovctx == NULL)
+    if (!EVP_PKEY_CTX_IS_DERIVE_OP(ctx) || ctx-&gt;op.kex.algctx == NULL)
         goto legacy;
 
     if (ctx-&gt;op.kex.exchange-&gt;set_peer == NULL) {
@@ -361,7 +361,7 @@ int EVP_PKEY_derive_set_peer_ex(EVP_PKEY_CTX *ctx, EVP_PKEY *peer,
      */
     if (provkey == NULL)
         goto legacy;
-    return ctx-&gt;op.kex.exchange-&gt;set_peer(ctx-&gt;op.kex.exchprovctx, provkey);
+    return ctx-&gt;op.kex.exchange-&gt;set_peer(ctx-&gt;op.kex.algctx, provkey);
 
  legacy:
 #ifdef FIPS_MODULE
@@ -447,10 +447,10 @@ int EVP_PKEY_derive(EVP_PKEY_CTX *ctx, unsigned char *key, size_t *pkeylen)
         return -1;
     }
 
-    if (ctx-&gt;op.kex.exchprovctx == NULL)
+    if (ctx-&gt;op.kex.algctx == NULL)
         goto legacy;
 
-    ret = ctx-&gt;op.kex.exchange-&gt;derive(ctx-&gt;op.kex.exchprovctx, key, pkeylen,
+    ret = ctx-&gt;op.kex.exchange-&gt;derive(ctx-&gt;op.kex.algctx, key, pkeylen,
                                        key != NULL ? *pkeylen : 0);
 
     return ret;
diff --git a/crypto/evp/kdf_lib.c b/crypto/evp/kdf_lib.c
index 8b2dc71996..55f5c50ab5 100644
--- a/crypto/evp/kdf_lib.c
+++ b/crypto/evp/kdf_lib.c
@@ -32,11 +32,11 @@ EVP_KDF_CTX *EVP_KDF_CTX_new(EVP_KDF *kdf)
 
     ctx = OPENSSL_zalloc(sizeof(EVP_KDF_CTX));
     if (ctx == NULL
-        || (ctx-&gt;data = kdf-&gt;newctx(ossl_provider_ctx(kdf-&gt;prov))) == NULL
+        || (ctx-&gt;algctx = kdf-&gt;newctx(ossl_provider_ctx(kdf-&gt;prov))) == NULL
         || !EVP_KDF_up_ref(kdf)) {
         ERR_raise(ERR_LIB_EVP, ERR_R_MALLOC_FAILURE);
         if (ctx != NULL)
-            kdf-&gt;freectx(ctx-&gt;data);
+            kdf-&gt;freectx(ctx-&gt;algctx);
         OPENSSL_free(ctx);
         ctx = NULL;
     } else {
@@ -49,8 +49,8 @@ void EVP_KDF_CTX_free(EVP_KDF_CTX *ctx)
 {
     if (ctx == NULL)
         return;
-    ctx-&gt;meth-&gt;freectx(ctx-&gt;data);
-    ctx-&gt;data = NULL;
+    ctx-&gt;meth-&gt;freectx(ctx-&gt;algctx);
+    ctx-&gt;algctx = NULL;
     EVP_KDF_free(ctx-&gt;meth);
     OPENSSL_free(ctx);
 }
@@ -59,7 +59,7 @@ EVP_KDF_CTX *EVP_KDF_CTX_dup(const EVP_KDF_CTX *src)
 {
     EVP_KDF_CTX *dst;
 
-    if (src == NULL || src-&gt;data == NULL || src-&gt;meth-&gt;dupctx == NULL)
+    if (src == NULL || src-&gt;algctx == NULL || src-&gt;meth-&gt;dupctx == NULL)
         return NULL;
 
     dst = OPENSSL_malloc(sizeof(*dst));
@@ -75,8 +75,8 @@ EVP_KDF_CTX *EVP_KDF_CTX_dup(const EVP_KDF_CTX *src)
         return NULL;
     }
 
-    dst-&gt;data = src-&gt;meth-&gt;dupctx(src-&gt;data);
-    if (dst-&gt;data == NULL) {
+    dst-&gt;algctx = src-&gt;meth-&gt;dupctx(src-&gt;algctx);
+    if (dst-&gt;algctx == NULL) {
         EVP_KDF_CTX_free(dst);
         return NULL;
     }
@@ -119,7 +119,7 @@ void EVP_KDF_CTX_reset(EVP_KDF_CTX *ctx)
         return;
 
     if (ctx-&gt;meth-&gt;reset != NULL)
-        ctx-&gt;meth-&gt;reset(ctx-&gt;data);
+        ctx-&gt;meth-&gt;reset(ctx-&gt;algctx);
 }
 
 size_t EVP_KDF_CTX_get_kdf_size(EVP_KDF_CTX *ctx)
@@ -132,7 +132,7 @@ size_t EVP_KDF_CTX_get_kdf_size(EVP_KDF_CTX *ctx)
 
     *params = OSSL_PARAM_construct_size_t(OSSL_KDF_PARAM_SIZE, &amp;s);
     if (ctx-&gt;meth-&gt;get_ctx_params != NULL
-        &amp;&amp; ctx-&gt;meth-&gt;get_ctx_params(ctx-&gt;data, params))
+        &amp;&amp; ctx-&gt;meth-&gt;get_ctx_params(ctx-&gt;algctx, params))
             return s;
     if (ctx-&gt;meth-&gt;get_params != NULL
         &amp;&amp; ctx-&gt;meth-&gt;get_params(params))
@@ -146,7 +146,7 @@ int EVP_KDF_derive(EVP_KDF_CTX *ctx, unsigned char *key, size_t keylen,
     if (ctx == NULL)
         return 0;
 
-    return ctx-&gt;meth-&gt;derive(ctx-&gt;data, key, keylen, params);
+    return ctx-&gt;meth-&gt;derive(ctx-&gt;algctx, key, keylen, params);
 }
 
 /*
@@ -165,14 +165,14 @@ int EVP_KDF_get_params(EVP_KDF *kdf, OSSL_PARAM params[])
 int EVP_KDF_CTX_get_params(EVP_KDF_CTX *ctx, OSSL_PARAM params[])
 {
     if (ctx-&gt;meth-&gt;get_ctx_params != NULL)
-        return ctx-&gt;meth-&gt;get_ctx_params(ctx-&gt;data, params);
+        return ctx-&gt;meth-&gt;get_ctx_params(ctx-&gt;algctx, params);
     return 1;
 }
 
 int EVP_KDF_CTX_set_params(EVP_KDF_CTX *ctx, const OSSL_PARAM params[])
 {
     if (ctx-&gt;meth-&gt;set_ctx_params != NULL)
-        return ctx-&gt;meth-&gt;set_ctx_params(ctx-&gt;data, params);
+        return ctx-&gt;meth-&gt;set_ctx_params(ctx-&gt;algctx, params);
     return 1;
 }
 
diff --git a/crypto/evp/kdf_meth.c b/crypto/evp/kdf_meth.c
index 0c6defa0f2..9cf0ca125b 100644
--- a/crypto/evp/kdf_meth.c
+++ b/crypto/evp/kdf_meth.c
@@ -209,7 +209,7 @@ const OSSL_PARAM *EVP_KDF_CTX_gettable_params(EVP_KDF_CTX *ctx)
     if (ctx-&gt;meth-&gt;gettable_ctx_params == NULL)
         return NULL;
     alg = ossl_provider_ctx(EVP_KDF_provider(ctx-&gt;meth));
-    return ctx-&gt;meth-&gt;gettable_ctx_params(ctx-&gt;data, alg);
+    return ctx-&gt;meth-&gt;gettable_ctx_params(ctx-&gt;algctx, alg);
 }
 
 const OSSL_PARAM *EVP_KDF_CTX_settable_params(EVP_KDF_CTX *ctx)
@@ -219,7 +219,7 @@ const OSSL_PARAM *EVP_KDF_CTX_settable_params(EVP_KDF_CTX *ctx)
     if (ctx-&gt;meth-&gt;settable_ctx_params == NULL)
         return NULL;
     alg = ossl_provider_ctx(EVP_KDF_provider(ctx-&gt;meth));
-    return ctx-&gt;meth-&gt;settable_ctx_params(ctx-&gt;data, alg);
+    return ctx-&gt;meth-&gt;settable_ctx_params(ctx-&gt;algctx, alg);
 }
 
 void EVP_KDF_do_all_provided(OSSL_LIB_CTX *libctx,
diff --git a/crypto/evp/kem.c b/crypto/evp/kem.c
index 5ee9a43892..493eabf97b 100644
--- a/crypto/evp/kem.c
+++ b/crypto/evp/kem.c
@@ -67,8 +67,8 @@ static int evp_kem_init(EVP_PKEY_CTX *ctx, int operation,
     }
 
     ctx-&gt;op.encap.kem = kem;
-    ctx-&gt;op.encap.kemprovctx = kem-&gt;newctx(ossl_provider_ctx(kem-&gt;prov));
-    if (ctx-&gt;op.encap.kemprovctx == NULL) {
+    ctx-&gt;op.encap.algctx = kem-&gt;newctx(ossl_provider_ctx(kem-&gt;prov));
+    if (ctx-&gt;op.encap.algctx == NULL) {
         /* The provider key can stay in the cache */
         ERR_raise(ERR_LIB_EVP, EVP_R_INITIALIZATION_ERROR);
         goto err;
@@ -81,7 +81,7 @@ static int evp_kem_init(EVP_PKEY_CTX *ctx, int operation,
             ret = -2;
             goto err;
         }
-        ret = kem-&gt;encapsulate_init(ctx-&gt;op.encap.kemprovctx, provkey, params);
+        ret = kem-&gt;encapsulate_init(ctx-&gt;op.encap.algctx, provkey, params);
         break;
     case EVP_PKEY_OP_DECAPSULATE:
         if (kem-&gt;decapsulate_init == NULL) {
@@ -89,7 +89,7 @@ static int evp_kem_init(EVP_PKEY_CTX *ctx, int operation,
             ret = -2;
             goto err;
         }
-        ret = kem-&gt;decapsulate_init(ctx-&gt;op.encap.kemprovctx, provkey, params);
+        ret = kem-&gt;decapsulate_init(ctx-&gt;op.encap.algctx, provkey, params);
         break;
     default:
         ERR_raise(ERR_LIB_EVP, EVP_R_INITIALIZATION_ERROR);
@@ -123,7 +123,7 @@ int EVP_PKEY_encapsulate(EVP_PKEY_CTX *ctx,
         return -1;
     }
 
-    if (ctx-&gt;op.encap.kemprovctx == NULL) {
+    if (ctx-&gt;op.encap.algctx == NULL) {
         ERR_raise(ERR_LIB_EVP, EVP_R_OPERATION_NOT_SUPPORTED_FOR_THIS_KEYTYPE);
         return -2;
     }
@@ -131,7 +131,7 @@ int EVP_PKEY_encapsulate(EVP_PKEY_CTX *ctx,
     if (out != NULL &amp;&amp; secret == NULL)
         return 0;
 
-    return ctx-&gt;op.encap.kem-&gt;encapsulate(ctx-&gt;op.encap.kemprovctx,
+    return ctx-&gt;op.encap.kem-&gt;encapsulate(ctx-&gt;op.encap.algctx,
                                           out, outlen, secret, secretlen);
 }
 
@@ -154,11 +154,11 @@ int EVP_PKEY_decapsulate(EVP_PKEY_CTX *ctx,
         return -1;
     }
 
-    if (ctx-&gt;op.encap.kemprovctx == NULL) {
+    if (ctx-&gt;op.encap.algctx == NULL) {
         ERR_raise(ERR_LIB_EVP, EVP_R_OPERATION_NOT_SUPPORTED_FOR_THIS_KEYTYPE);
         return -2;
     }
-    return ctx-&gt;op.encap.kem-&gt;decapsulate(ctx-&gt;op.encap.kemprovctx,
+    return ctx-&gt;op.encap.kem-&gt;decapsulate(ctx-&gt;op.encap.algctx,
                                           secret, secretlen, in, inlen);
 }
 
diff --git a/crypto/evp/m_sigver.c b/crypto/evp/m_sigver.c
index 17565554e0..296269a88e 100644
--- a/crypto/evp/m_sigver.c
+++ b/crypto/evp/m_sigver.c
@@ -51,14 +51,14 @@ static int do_sigver_init(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
     void *provkey = NULL;
     int ret;
 
-    if (ctx-&gt;provctx != NULL) {
+    if (ctx-&gt;algctx != NULL) {
         if (!ossl_assert(ctx-&gt;digest != NULL)) {
             ERR_raise(ERR_LIB_EVP, EVP_R_INITIALIZATION_ERROR);
             return 0;
         }
         if (ctx-&gt;digest-&gt;freectx != NULL)
-            ctx-&gt;digest-&gt;freectx(ctx-&gt;provctx);
-        ctx-&gt;provctx = NULL;
+            ctx-&gt;digest-&gt;freectx(ctx-&gt;algctx);
+        ctx-&gt;algctx = NULL;
     }
 
     if (ctx-&gt;pctx == NULL) {
@@ -147,9 +147,9 @@ static int do_sigver_init(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
     locpctx-&gt;op.sig.signature = signature;
     locpctx-&gt;operation = ver ? EVP_PKEY_OP_VERIFYCTX
                              : EVP_PKEY_OP_SIGNCTX;
-    locpctx-&gt;op.sig.sigprovctx
+    locpctx-&gt;op.sig.algctx
         = signature-&gt;newctx(ossl_provider_ctx(signature-&gt;prov), props);
-    if (locpctx-&gt;op.sig.sigprovctx == NULL) {
+    if (locpctx-&gt;op.sig.algctx == NULL) {
         ERR_raise(ERR_LIB_EVP,  EVP_R_INITIALIZATION_ERROR);
         goto err;
     }
@@ -203,14 +203,14 @@ static int do_sigver_init(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
             ERR_raise(ERR_LIB_EVP, EVP_R_INITIALIZATION_ERROR);
             goto err;
         }
-        ret = signature-&gt;digest_verify_init(locpctx-&gt;op.sig.sigprovctx,
+        ret = signature-&gt;digest_verify_init(locpctx-&gt;op.sig.algctx,
                                             mdname, provkey, params);
     } else {
         if (signature-&gt;digest_sign_init == NULL) {
             ERR_raise(ERR_LIB_EVP, EVP_R_INITIALIZATION_ERROR);
             goto err;
         }
-        ret = signature-&gt;digest_sign_init(locpctx-&gt;op.sig.sigprovctx,
+        ret = signature-&gt;digest_sign_init(locpctx-&gt;op.sig.algctx,
                                           mdname, provkey, params);
     }
 
@@ -340,7 +340,7 @@ int EVP_DigestSignUpdate(EVP_MD_CTX *ctx, const void *data, size_t dsize)
 
     if (pctx == NULL
             || pctx-&gt;operation != EVP_PKEY_OP_SIGNCTX
-            || pctx-&gt;op.sig.sigprovctx == NULL
+            || pctx-&gt;op.sig.algctx == NULL
             || pctx-&gt;op.sig.signature == NULL)
         goto legacy;
 
@@ -349,7 +349,7 @@ int EVP_DigestSignUpdate(EVP_MD_CTX *ctx, const void *data, size_t dsize)
         return 0;
     }
 
-    return pctx-&gt;op.sig.signature-&gt;digest_sign_update(pctx-&gt;op.sig.sigprovctx,
+    return pctx-&gt;op.sig.signature-&gt;digest_sign_update(pctx-&gt;op.sig.algctx,
                                                       data, dsize);
 
  legacy:
@@ -370,7 +370,7 @@ int EVP_DigestVerifyUpdate(EVP_MD_CTX *ctx, const void *data, size_t dsize)
 
     if (pctx == NULL
             || pctx-&gt;operation != EVP_PKEY_OP_VERIFYCTX
-            || pctx-&gt;op.sig.sigprovctx == NULL
+            || pctx-&gt;op.sig.algctx == NULL
             || pctx-&gt;op.sig.signature == NULL)
         goto legacy;
 
@@ -379,7 +379,7 @@ int EVP_DigestVerifyUpdate(EVP_MD_CTX *ctx, const void *data, size_t dsize)
         return 0;
     }
 
-    return pctx-&gt;op.sig.signature-&gt;digest_verify_update(pctx-&gt;op.sig.sigprovctx,
+    return pctx-&gt;op.sig.signature-&gt;digest_verify_update(pctx-&gt;op.sig.algctx,
                                                         data, dsize);
 
  legacy:
@@ -403,11 +403,11 @@ int EVP_DigestSignFinal(EVP_MD_CTX *ctx, unsigned char *sigret,
 
     if (pctx == NULL
             || pctx-&gt;operation != EVP_PKEY_OP_SIGNCTX
-            || pctx-&gt;op.sig.sigprovctx == NULL
+            || pctx-&gt;op.sig.algctx == NULL
             || pctx-&gt;op.sig.signature == NULL)
         goto legacy;
 
-    return pctx-&gt;op.sig.signature-&gt;digest_sign_final(pctx-&gt;op.sig.sigprovctx,
+    return pctx-&gt;op.sig.signature-&gt;digest_sign_final(pctx-&gt;op.sig.algctx,
                                                      sigret, siglen, SIZE_MAX);
 
  legacy:
@@ -491,10 +491,10 @@ int EVP_DigestSign(EVP_MD_CTX *ctx, unsigned char *sigret, size_t *siglen,
 
     if (pctx != NULL
             &amp;&amp; pctx-&gt;operation == EVP_PKEY_OP_SIGNCTX
-            &amp;&amp; pctx-&gt;op.sig.sigprovctx != NULL
+            &amp;&amp; pctx-&gt;op.sig.algctx != NULL
             &amp;&amp; pctx-&gt;op.sig.signature != NULL) {
         if (pctx-&gt;op.sig.signature-&gt;digest_sign != NULL)
-            return pctx-&gt;op.sig.signature-&gt;digest_sign(pctx-&gt;op.sig.sigprovctx,
+            return pctx-&gt;op.sig.signature-&gt;digest_sign(pctx-&gt;op.sig.algctx,
                                                        sigret, siglen, SIZE_MAX,
                                                        tbs, tbslen);
     } else {
@@ -519,11 +519,11 @@ int EVP_DigestVerifyFinal(EVP_MD_CTX *ctx, const unsigned char *sig,
 
     if (pctx == NULL
             || pctx-&gt;operation != EVP_PKEY_OP_VERIFYCTX
-            || pctx-&gt;op.sig.sigprovctx == NULL
+            || pctx-&gt;op.sig.algctx == NULL
             || pctx-&gt;op.sig.signature == NULL)
         goto legacy;
 
-    return pctx-&gt;op.sig.signature-&gt;digest_verify_final(pctx-&gt;op.sig.sigprovctx,
+    return pctx-&gt;op.sig.signature-&gt;digest_verify_final(pctx-&gt;op.sig.algctx,
                                                        sig, siglen);
 
  legacy:
@@ -574,10 +574,10 @@ int EVP_DigestVerify(EVP_MD_CTX *ctx, const unsigned char *sigret,
 
     if (pctx != NULL
             &amp;&amp; pctx-&gt;operation == EVP_PKEY_OP_VERIFYCTX
-            &amp;&amp; pctx-&gt;op.sig.sigprovctx != NULL
+            &amp;&amp; pctx-&gt;op.sig.algctx != NULL
             &amp;&amp; pctx-&gt;op.sig.signature != NULL) {
         if (pctx-&gt;op.sig.signature-&gt;digest_verify != NULL)
-            return pctx-&gt;op.sig.signature-&gt;digest_verify(pctx-&gt;op.sig.sigprovctx,
+            return pctx-&gt;op.sig.signature-&gt;digest_verify(pctx-&gt;op.sig.algctx,
                                                          sigret, siglen,
                                                          tbs, tbslen);
     } else {
diff --git a/crypto/evp/mac_lib.c b/crypto/evp/mac_lib.c
index 8a34df3757..eef37e882c 100644
--- a/crypto/evp/mac_lib.c
+++ b/crypto/evp/mac_lib.c
@@ -24,11 +24,11 @@ EVP_MAC_CTX *EVP_MAC_CTX_new(EVP_MAC *mac)
     EVP_MAC_CTX *ctx = OPENSSL_zalloc(sizeof(EVP_MAC_CTX));
 
     if (ctx == NULL
-        || (ctx-&gt;data = mac-&gt;newctx(ossl_provider_ctx(mac-&gt;prov))) == NULL
+        || (ctx-&gt;algctx = mac-&gt;newctx(ossl_provider_ctx(mac-&gt;prov))) == NULL
         || !EVP_MAC_up_ref(mac)) {
         ERR_raise(ERR_LIB_EVP, ERR_R_MALLOC_FAILURE);
         if (ctx != NULL)
-            mac-&gt;freectx(ctx-&gt;data);
+            mac-&gt;freectx(ctx-&gt;algctx);
         OPENSSL_free(ctx);
         ctx = NULL;
     } else {
@@ -41,8 +41,8 @@ void EVP_MAC_CTX_free(EVP_MAC_CTX *ctx)
 {
     if (ctx == NULL)
         return;
-    ctx-&gt;meth-&gt;freectx(ctx-&gt;data);
-    ctx-&gt;data = NULL;
+    ctx-&gt;meth-&gt;freectx(ctx-&gt;algctx);
+    ctx-&gt;algctx = NULL;
     /* refcnt-- */
     EVP_MAC_free(ctx-&gt;meth);
     OPENSSL_free(ctx);
@@ -52,7 +52,7 @@ EVP_MAC_CTX *EVP_MAC_CTX_dup(const EVP_MAC_CTX *src)
 {
     EVP_MAC_CTX *dst;
 
-    if (src-&gt;data == NULL)
+    if (src-&gt;algctx == NULL)
         return NULL;
 
     dst = OPENSSL_malloc(sizeof(*dst));
@@ -68,8 +68,8 @@ EVP_MAC_CTX *EVP_MAC_CTX_dup(const EVP_MAC_CTX *src)
         return NULL;
     }
 
-    dst-&gt;data = src-&gt;meth-&gt;dupctx(src-&gt;data);
-    if (dst-&gt;data == NULL) {
+    dst-&gt;algctx = src-&gt;meth-&gt;dupctx(src-&gt;algctx);
+    if (dst-&gt;algctx == NULL) {
         EVP_MAC_CTX_free(dst);
         return NULL;
     }
@@ -86,12 +86,12 @@ size_t EVP_MAC_CTX_get_mac_size(EVP_MAC_CTX *ctx)
 {
     size_t sz = 0;
 
-    if (ctx-&gt;data != NULL) {
+    if (ctx-&gt;algctx != NULL) {
         OSSL_PARAM params[2] = { OSSL_PARAM_END, OSSL_PARAM_END };
 
         params[0] = OSSL_PARAM_construct_size_t(OSSL_MAC_PARAM_SIZE, &amp;sz);
         if (ctx-&gt;meth-&gt;get_ctx_params != NULL) {
-            if (ctx-&gt;meth-&gt;get_ctx_params(ctx-&gt;data, params))
+            if (ctx-&gt;meth-&gt;get_ctx_params(ctx-&gt;algctx, params))
                 return sz;
         } else if (ctx-&gt;meth-&gt;get_params != NULL) {
             if (ctx-&gt;meth-&gt;get_params(params))
@@ -108,12 +108,12 @@ size_t EVP_MAC_CTX_get_mac_size(EVP_MAC_CTX *ctx)
 int EVP_MAC_init(EVP_MAC_CTX *ctx, const unsigned char *key, size_t keylen,
                  const OSSL_PARAM params[])
 {
-    return ctx-&gt;meth-&gt;init(ctx-&gt;data, key, keylen, params);
+    return ctx-&gt;meth-&gt;init(ctx-&gt;algctx, key, keylen, params);
 }
 
 int EVP_MAC_update(EVP_MAC_CTX *ctx, const unsigned char *data, size_t datalen)
 {
-    return ctx-&gt;meth-&gt;update(ctx-&gt;data, data, datalen);
+    return ctx-&gt;meth-&gt;update(ctx-&gt;algctx, data, datalen);
 }
 
 static int evp_mac_final(EVP_MAC_CTX *ctx, int xof,
@@ -149,7 +149,7 @@ static int evp_mac_final(EVP_MAC_CTX *ctx, int xof,
             return 0;
         }
     }
-    res = ctx-&gt;meth-&gt;final(ctx-&gt;data, out, &amp;l, outsize);
+    res = ctx-&gt;meth-&gt;final(ctx-&gt;algctx, out, &amp;l, outsize);
     if (outl != NULL)
         *outl = l;
     return res;
@@ -182,14 +182,14 @@ int EVP_MAC_get_params(EVP_MAC *mac, OSSL_PARAM params[])
 int EVP_MAC_CTX_get_params(EVP_MAC_CTX *ctx, OSSL_PARAM params[])
 {
     if (ctx-&gt;meth-&gt;get_ctx_params != NULL)
-        return ctx-&gt;meth-&gt;get_ctx_params(ctx-&gt;data, params);
+        return ctx-&gt;meth-&gt;get_ctx_params(ctx-&gt;algctx, params);
     return 1;
 }
 
 int EVP_MAC_CTX_set_params(EVP_MAC_CTX *ctx, const OSSL_PARAM params[])
 {
     if (ctx-&gt;meth-&gt;set_ctx_params != NULL)
-        return ctx-&gt;meth-&gt;set_ctx_params(ctx-&gt;data, params);
+        return ctx-&gt;meth-&gt;set_ctx_params(ctx-&gt;algctx, params);
     return 1;
 }
 
diff --git a/crypto/evp/mac_meth.c b/crypto/evp/mac_meth.c
index 342aadc996..6396eb38fd 100644
--- a/crypto/evp/mac_meth.c
+++ b/crypto/evp/mac_meth.c
@@ -214,7 +214,7 @@ const OSSL_PARAM *EVP_MAC_CTX_gettable_params(EVP_MAC_CTX *ctx)
     if (ctx-&gt;meth-&gt;gettable_ctx_params == NULL)
         return NULL;
     alg = ossl_provider_ctx(EVP_MAC_provider(ctx-&gt;meth));
-    return ctx-&gt;meth-&gt;gettable_ctx_params(ctx-&gt;data, alg);
+    return ctx-&gt;meth-&gt;gettable_ctx_params(ctx-&gt;algctx, alg);
 }
 
 const OSSL_PARAM *EVP_MAC_CTX_settable_params(EVP_MAC_CTX *ctx)
@@ -224,7 +224,7 @@ const OSSL_PARAM *EVP_MAC_CTX_settable_params(EVP_MAC_CTX *ctx)
     if (ctx-&gt;meth-&gt;settable_ctx_params == NULL)
         return NULL;
     alg = ossl_provider_ctx(EVP_MAC_provider(ctx-&gt;meth));
-    return ctx-&gt;meth-&gt;settable_ctx_params(ctx-&gt;data, alg);
+    return ctx-&gt;meth-&gt;settable_ctx_params(ctx-&gt;algctx, alg);
 }
 
 void EVP_MAC_do_all_provided(OSSL_LIB_CTX *libctx,
diff --git a/crypto/evp/pmeth_lib.c b/crypto/evp/pmeth_lib.c
index 506e90fed8..47062c02c1 100644
--- a/crypto/evp/pmeth_lib.c
+++ b/crypto/evp/pmeth_lib.c
@@ -160,15 +160,15 @@ int evp_pkey_ctx_state(const EVP_PKEY_CTX *ctx)
         return EVP_PKEY_STATE_UNKNOWN;
 
     if ((EVP_PKEY_CTX_IS_DERIVE_OP(ctx)
-         &amp;&amp; ctx-&gt;op.kex.exchprovctx != NULL)
+         &amp;&amp; ctx-&gt;op.kex.algctx != NULL)
         || (EVP_PKEY_CTX_IS_SIGNATURE_OP(ctx)
-            &amp;&amp; ctx-&gt;op.sig.sigprovctx != NULL)
+            &amp;&amp; ctx-&gt;op.sig.algctx != NULL)
         || (EVP_PKEY_CTX_IS_ASYM_CIPHER_OP(ctx)
-            &amp;&amp; ctx-&gt;op.ciph.ciphprovctx != NULL)
+            &amp;&amp; ctx-&gt;op.ciph.algctx != NULL)
         || (EVP_PKEY_CTX_IS_GEN_OP(ctx)
             &amp;&amp; ctx-&gt;op.keymgmt.genctx != NULL)
         || (EVP_PKEY_CTX_IS_KEM_OP(ctx)
-            &amp;&amp; ctx-&gt;op.encap.kemprovctx != NULL))
+            &amp;&amp; ctx-&gt;op.encap.algctx != NULL))
         return EVP_PKEY_STATE_PROVIDER;
 
     return EVP_PKEY_STATE_LEGACY;
@@ -360,29 +360,29 @@ EVP_PKEY_CTX *EVP_PKEY_CTX_new_from_pkey(OSSL_LIB_CTX *libctx, EVP_PKEY *pkey,
 void evp_pkey_ctx_free_old_ops(EVP_PKEY_CTX *ctx)
 {
     if (EVP_PKEY_CTX_IS_SIGNATURE_OP(ctx)) {
-        if (ctx-&gt;op.sig.sigprovctx != NULL &amp;&amp; ctx-&gt;op.sig.signature != NULL)
-            ctx-&gt;op.sig.signature-&gt;freectx(ctx-&gt;op.sig.sigprovctx);
+        if (ctx-&gt;op.sig.algctx != NULL &amp;&amp; ctx-&gt;op.sig.signature != NULL)
+            ctx-&gt;op.sig.signature-&gt;freectx(ctx-&gt;op.sig.algctx);
         EVP_SIGNATURE_free(ctx-&gt;op.sig.signature);
-        ctx-&gt;op.sig.sigprovctx = NULL;
+        ctx-&gt;op.sig.algctx = NULL;
         ctx-&gt;op.sig.signature = NULL;
     } else if (EVP_PKEY_CTX_IS_DERIVE_OP(ctx)) {
-        if (ctx-&gt;op.kex.exchprovctx != NULL &amp;&amp; ctx-&gt;op.kex.exchange != NULL)
-            ctx-&gt;op.kex.exchange-&gt;freectx(ctx-&gt;op.kex.exchprovctx);
+        if (ctx-&gt;op.kex.algctx != NULL &amp;&amp; ctx-&gt;op.kex.exchange != NULL)
+            ctx-&gt;op.kex.exchange-&gt;freectx(ctx-&gt;op.kex.algctx);
         EVP_KEYEXCH_free(ctx-&gt;op.kex.exchange);
-        ctx-&gt;op.kex.exchprovctx = NULL;
+        ctx-&gt;op.kex.algctx = NULL;
         ctx-&gt;op.kex.exchange = NULL;
     } else if (EVP_PKEY_CTX_IS_KEM_OP(ctx)) {
-        if (ctx-&gt;op.encap.kemprovctx != NULL &amp;&amp; ctx-&gt;op.encap.kem != NULL)
-            ctx-&gt;op.encap.kem-&gt;freectx(ctx-&gt;op.encap.kemprovctx);
+        if (ctx-&gt;op.encap.algctx != NULL &amp;&amp; ctx-&gt;op.encap.kem != NULL)
+            ctx-&gt;op.encap.kem-&gt;freectx(ctx-&gt;op.encap.algctx);
         EVP_KEM_free(ctx-&gt;op.encap.kem);
-        ctx-&gt;op.encap.kemprovctx = NULL;
+        ctx-&gt;op.encap.algctx = NULL;
         ctx-&gt;op.encap.kem = NULL;
     }
     else if (EVP_PKEY_CTX_IS_ASYM_CIPHER_OP(ctx)) {
-        if (ctx-&gt;op.ciph.ciphprovctx != NULL &amp;&amp; ctx-&gt;op.ciph.cipher != NULL)
-            ctx-&gt;op.ciph.cipher-&gt;freectx(ctx-&gt;op.ciph.ciphprovctx);
+        if (ctx-&gt;op.ciph.algctx != NULL &amp;&amp; ctx-&gt;op.ciph.cipher != NULL)
+            ctx-&gt;op.ciph.cipher-&gt;freectx(ctx-&gt;op.ciph.algctx);
         EVP_ASYM_CIPHER_free(ctx-&gt;op.ciph.cipher);
-        ctx-&gt;op.ciph.ciphprovctx = NULL;
+        ctx-&gt;op.ciph.algctx = NULL;
         ctx-&gt;op.ciph.cipher = NULL;
     } else if (EVP_PKEY_CTX_IS_GEN_OP(ctx)) {
         if (ctx-&gt;op.keymgmt.genctx != NULL &amp;&amp; ctx-&gt;keymgmt != NULL)
@@ -489,12 +489,12 @@ EVP_PKEY_CTX *EVP_PKEY_CTX_dup(const EVP_PKEY_CTX *pctx)
             if (!EVP_KEYEXCH_up_ref(rctx-&gt;op.kex.exchange))
                 goto err;
         }
-        if (pctx-&gt;op.kex.exchprovctx != NULL) {
+        if (pctx-&gt;op.kex.algctx != NULL) {
             if (!ossl_assert(pctx-&gt;op.kex.exchange != NULL))
                 goto err;
-            rctx-&gt;op.kex.exchprovctx
-                = pctx-&gt;op.kex.exchange-&gt;dupctx(pctx-&gt;op.kex.exchprovctx);
-            if (rctx-&gt;op.kex.exchprovctx == NULL) {
+            rctx-&gt;op.kex.algctx
+                = pctx-&gt;op.kex.exchange-&gt;dupctx(pctx-&gt;op.kex.algctx);
+            if (rctx-&gt;op.kex.algctx == NULL) {
                 EVP_KEYEXCH_free(rctx-&gt;op.kex.exchange);
                 goto err;
             }
@@ -506,12 +506,12 @@ EVP_PKEY_CTX *EVP_PKEY_CTX_dup(const EVP_PKEY_CTX *pctx)
             if (!EVP_SIGNATURE_up_ref(rctx-&gt;op.sig.signature))
                 goto err;
         }
-        if (pctx-&gt;op.sig.sigprovctx != NULL) {
+        if (pctx-&gt;op.sig.algctx != NULL) {
             if (!ossl_assert(pctx-&gt;op.sig.signature != NULL))
                 goto err;
-            rctx-&gt;op.sig.sigprovctx
-                = pctx-&gt;op.sig.signature-&gt;dupctx(pctx-&gt;op.sig.sigprovctx);
-            if (rctx-&gt;op.sig.sigprovctx == NULL) {
+            rctx-&gt;op.sig.algctx
+                = pctx-&gt;op.sig.signature-&gt;dupctx(pctx-&gt;op.sig.algctx);
+            if (rctx-&gt;op.sig.algctx == NULL) {
                 EVP_SIGNATURE_free(rctx-&gt;op.sig.signature);
                 goto err;
             }
@@ -523,12 +523,12 @@ EVP_PKEY_CTX *EVP_PKEY_CTX_dup(const EVP_PKEY_CTX *pctx)
             if (!EVP_ASYM_CIPHER_up_ref(rctx-&gt;op.ciph.cipher))
                 goto err;
         }
-        if (pctx-&gt;op.ciph.ciphprovctx != NULL) {
+        if (pctx-&gt;op.ciph.algctx != NULL) {
             if (!ossl_assert(pctx-&gt;op.ciph.cipher != NULL))
                 goto err;
-            rctx-&gt;op.ciph.ciphprovctx
-                = pctx-&gt;op.ciph.cipher-&gt;dupctx(pctx-&gt;op.ciph.ciphprovctx);
-            if (rctx-&gt;op.ciph.ciphprovctx == NULL) {
+            rctx-&gt;op.ciph.algctx
+                = pctx-&gt;op.ciph.cipher-&gt;dupctx(pctx-&gt;op.ciph.algctx);
+            if (rctx-&gt;op.ciph.algctx == NULL) {
                 EVP_ASYM_CIPHER_free(rctx-&gt;op.ciph.cipher);
                 goto err;
             }
@@ -540,12 +540,12 @@ EVP_PKEY_CTX *EVP_PKEY_CTX_dup(const EVP_PKEY_CTX *pctx)
             if (!EVP_KEM_up_ref(rctx-&gt;op.encap.kem))
                 goto err;
         }
-        if (pctx-&gt;op.encap.kemprovctx != NULL) {
+        if (pctx-&gt;op.encap.algctx != NULL) {
             if (!ossl_assert(pctx-&gt;op.encap.kem != NULL))
                 goto err;
-            rctx-&gt;op.encap.kemprovctx
-                = pctx-&gt;op.encap.kem-&gt;dupctx(pctx-&gt;op.encap.kemprovctx);
-            if (rctx-&gt;op.encap.kemprovctx == NULL) {
+            rctx-&gt;op.encap.algctx
+                = pctx-&gt;op.encap.kem-&gt;dupctx(pctx-&gt;op.encap.algctx);
+            if (rctx-&gt;op.encap.algctx == NULL) {
                 EVP_KEM_free(rctx-&gt;op.encap.kem);
                 goto err;
             }
@@ -660,19 +660,19 @@ int EVP_PKEY_CTX_set_params(EVP_PKEY_CTX *ctx, const OSSL_PARAM *params)
             &amp;&amp; ctx-&gt;op.kex.exchange != NULL
             &amp;&amp; ctx-&gt;op.kex.exchange-&gt;set_ctx_params != NULL)
             return
-                ctx-&gt;op.kex.exchange-&gt;set_ctx_params(ctx-&gt;op.kex.exchprovctx,
+                ctx-&gt;op.kex.exchange-&gt;set_ctx_params(ctx-&gt;op.kex.algctx,
                                                      params);
         if (EVP_PKEY_CTX_IS_SIGNATURE_OP(ctx)
             &amp;&amp; ctx-&gt;op.sig.signature != NULL
             &amp;&amp; ctx-&gt;op.sig.signature-&gt;set_ctx_params != NULL)
             return
-                ctx-&gt;op.sig.signature-&gt;set_ctx_params(ctx-&gt;op.sig.sigprovctx,
+                ctx-&gt;op.sig.signature-&gt;set_ctx_params(ctx-&gt;op.sig.algctx,
                                                       params);
         if (EVP_PKEY_CTX_IS_ASYM_CIPHER_OP(ctx)
             &amp;&amp; ctx-&gt;op.ciph.cipher != NULL
             &amp;&amp; ctx-&gt;op.ciph.cipher-&gt;set_ctx_params != NULL)
             return
-                ctx-&gt;op.ciph.cipher-&gt;set_ctx_params(ctx-&gt;op.ciph.ciphprovctx,
+                ctx-&gt;op.ciph.cipher-&gt;set_ctx_params(ctx-&gt;op.ciph.algctx,
                                                     params);
         if (EVP_PKEY_CTX_IS_GEN_OP(ctx)
             &amp;&amp; ctx-&gt;keymgmt != NULL
@@ -684,7 +684,7 @@ int EVP_PKEY_CTX_set_params(EVP_PKEY_CTX *ctx, const OSSL_PARAM *params)
             &amp;&amp; ctx-&gt;op.encap.kem != NULL
             &amp;&amp; ctx-&gt;op.encap.kem-&gt;set_ctx_params != NULL)
             return
-                ctx-&gt;op.encap.kem-&gt;set_ctx_params(ctx-&gt;op.encap.kemprovctx,
+                ctx-&gt;op.encap.kem-&gt;set_ctx_params(ctx-&gt;op.encap.algctx,
                                                   params);
         break;
 #ifndef FIPS_MODULE
@@ -704,25 +704,25 @@ int EVP_PKEY_CTX_get_params(EVP_PKEY_CTX *ctx, OSSL_PARAM *params)
             &amp;&amp; ctx-&gt;op.kex.exchange != NULL
             &amp;&amp; ctx-&gt;op.kex.exchange-&gt;get_ctx_params != NULL)
             return
-                ctx-&gt;op.kex.exchange-&gt;get_ctx_params(ctx-&gt;op.kex.exchprovctx,
+                ctx-&gt;op.kex.exchange-&gt;get_ctx_params(ctx-&gt;op.kex.algctx,
                                                      params);
         if (EVP_PKEY_CTX_IS_SIGNATURE_OP(ctx)
             &amp;&amp; ctx-&gt;op.sig.signature != NULL
             &amp;&amp; ctx-&gt;op.sig.signature-&gt;get_ctx_params != NULL)
             return
-                ctx-&gt;op.sig.signature-&gt;get_ctx_params(ctx-&gt;op.sig.sigprovctx,
+                ctx-&gt;op.sig.signature-&gt;get_ctx_params(ctx-&gt;op.sig.algctx,
                                                       params);
         if (EVP_PKEY_CTX_IS_ASYM_CIPHER_OP(ctx)
             &amp;&amp; ctx-&gt;op.ciph.cipher != NULL
             &amp;&amp; ctx-&gt;op.ciph.cipher-&gt;get_ctx_params != NULL)
             return
-                ctx-&gt;op.ciph.cipher-&gt;get_ctx_params(ctx-&gt;op.ciph.ciphprovctx,
+                ctx-&gt;op.ciph.cipher-&gt;get_ctx_params(ctx-&gt;op.ciph.algctx,
                                                     params);
         if (EVP_PKEY_CTX_IS_KEM_OP(ctx)
             &amp;&amp; ctx-&gt;op.encap.kem != NULL
             &amp;&amp; ctx-&gt;op.encap.kem-&gt;get_ctx_params != NULL)
             return
-                ctx-&gt;op.encap.kem-&gt;get_ctx_params(ctx-&gt;op.encap.kemprovctx,
+                ctx-&gt;op.encap.kem-&gt;get_ctx_params(ctx-&gt;op.encap.algctx,
                                                   params);
         break;
 #ifndef FIPS_MODULE
@@ -743,7 +743,7 @@ const OSSL_PARAM *EVP_PKEY_CTX_gettable_params(const EVP_PKEY_CTX *ctx)
             &amp;&amp; ctx-&gt;op.kex.exchange != NULL
             &amp;&amp; ctx-&gt;op.kex.exchange-&gt;gettable_ctx_params != NULL) {
         provctx = ossl_provider_ctx(EVP_KEYEXCH_provider(ctx-&gt;op.kex.exchange));
-        return ctx-&gt;op.kex.exchange-&gt;gettable_ctx_params(ctx-&gt;op.kex.exchprovctx,
+        return ctx-&gt;op.kex.exchange-&gt;gettable_ctx_params(ctx-&gt;op.kex.algctx,
                                                          provctx);
     }
     if (EVP_PKEY_CTX_IS_SIGNATURE_OP(ctx)
@@ -751,7 +751,7 @@ const OSSL_PARAM *EVP_PKEY_CTX_gettable_params(const EVP_PKEY_CTX *ctx)
             &amp;&amp; ctx-&gt;op.sig.signature-&gt;gettable_ctx_params != NULL) {
         provctx = ossl_provider_ctx(
                       EVP_SIGNATURE_provider(ctx-&gt;op.sig.signature));
-        return ctx-&gt;op.sig.signature-&gt;gettable_ctx_params(ctx-&gt;op.sig.sigprovctx,
+        return ctx-&gt;op.sig.signature-&gt;gettable_ctx_params(ctx-&gt;op.sig.algctx,
                                                           provctx);
     }
     if (EVP_PKEY_CTX_IS_ASYM_CIPHER_OP(ctx)
@@ -759,14 +759,14 @@ const OSSL_PARAM *EVP_PKEY_CTX_gettable_params(const EVP_PKEY_CTX *ctx)
             &amp;&amp; ctx-&gt;op.ciph.cipher-&gt;gettable_ctx_params != NULL) {
         provctx = ossl_provider_ctx(
                       EVP_ASYM_CIPHER_provider(ctx-&gt;op.ciph.cipher));
-        return ctx-&gt;op.ciph.cipher-&gt;gettable_ctx_params(ctx-&gt;op.ciph.ciphprovctx,
+        return ctx-&gt;op.ciph.cipher-&gt;gettable_ctx_params(ctx-&gt;op.ciph.algctx,
                                                         provctx);
     }
     if (EVP_PKEY_CTX_IS_KEM_OP(ctx)
         &amp;&amp; ctx-&gt;op.encap.kem != NULL
         &amp;&amp; ctx-&gt;op.encap.kem-&gt;gettable_ctx_params != NULL) {
         provctx = ossl_provider_ctx(EVP_KEM_provider(ctx-&gt;op.encap.kem));
-        return ctx-&gt;op.encap.kem-&gt;gettable_ctx_params(ctx-&gt;op.encap.kemprovctx,
+        return ctx-&gt;op.encap.kem-&gt;gettable_ctx_params(ctx-&gt;op.encap.algctx,
                                                       provctx);
     }
     return NULL;
@@ -780,7 +780,7 @@ const OSSL_PARAM *EVP_PKEY_CTX_settable_params(const EVP_PKEY_CTX *ctx)
             &amp;&amp; ctx-&gt;op.kex.exchange != NULL
             &amp;&amp; ctx-&gt;op.kex.exchange-&gt;settable_ctx_params != NULL) {
         provctx = ossl_provider_ctx(EVP_KEYEXCH_provider(ctx-&gt;op.kex.exchange));
-        return ctx-&gt;op.kex.exchange-&gt;settable_ctx_params(ctx-&gt;op.kex.exchprovctx,
+        return ctx-&gt;op.kex.exchange-&gt;settable_ctx_params(ctx-&gt;op.kex.algctx,
                                                          provctx);
     }
     if (EVP_PKEY_CTX_IS_SIGNATURE_OP(ctx)
@@ -788,7 +788,7 @@ const OSSL_PARAM *EVP_PKEY_CTX_settable_params(const EVP_PKEY_CTX *ctx)
             &amp;&amp; ctx-&gt;op.sig.signature-&gt;settable_ctx_params != NULL) {
         provctx = ossl_provider_ctx(
                       EVP_SIGNATURE_provider(ctx-&gt;op.sig.signature));
-        return ctx-&gt;op.sig.signature-&gt;settable_ctx_params(ctx-&gt;op.sig.sigprovctx,
+        return ctx-&gt;op.sig.signature-&gt;settable_ctx_params(ctx-&gt;op.sig.algctx,
                                                           provctx);
     }
     if (EVP_PKEY_CTX_IS_ASYM_CIPHER_OP(ctx)
@@ -796,7 +796,7 @@ const OSSL_PARAM *EVP_PKEY_CTX_settable_params(const EVP_PKEY_CTX *ctx)
             &amp;&amp; ctx-&gt;op.ciph.cipher-&gt;settable_ctx_params != NULL) {
         provctx = ossl_provider_ctx(
                       EVP_ASYM_CIPHER_provider(ctx-&gt;op.ciph.cipher));
-        return ctx-&gt;op.ciph.cipher-&gt;settable_ctx_params(ctx-&gt;op.ciph.ciphprovctx,
+        return ctx-&gt;op.ciph.cipher-&gt;settable_ctx_params(ctx-&gt;op.ciph.algctx,
                                                         provctx);
     }
     if (EVP_PKEY_CTX_IS_GEN_OP(ctx)
@@ -810,7 +810,7 @@ const OSSL_PARAM *EVP_PKEY_CTX_settable_params(const EVP_PKEY_CTX *ctx)
         &amp;&amp; ctx-&gt;op.encap.kem != NULL
         &amp;&amp; ctx-&gt;op.encap.kem-&gt;settable_ctx_params != NULL) {
         provctx = ossl_provider_ctx(EVP_KEM_provider(ctx-&gt;op.encap.kem));
-        return ctx-&gt;op.encap.kem-&gt;settable_ctx_params(ctx-&gt;op.encap.kemprovctx,
+        return ctx-&gt;op.encap.kem-&gt;settable_ctx_params(ctx-&gt;op.encap.algctx,
                                                       provctx);
     }
     return NULL;
@@ -891,7 +891,7 @@ int EVP_PKEY_CTX_get_signature_md(EVP_PKEY_CTX *ctx, const EVP_MD **md)
         return -2;
     }
 
-    if (ctx-&gt;op.sig.sigprovctx == NULL)
+    if (ctx-&gt;op.sig.algctx == NULL)
         return EVP_PKEY_CTX_ctrl(ctx, -1, EVP_PKEY_OP_TYPE_SIG,
                                  EVP_PKEY_CTRL_GET_MD, 0, (void *)(md));
 
@@ -947,14 +947,14 @@ static int evp_pkey_ctx_set_md(EVP_PKEY_CTX *ctx, const EVP_MD *md,
 
 int EVP_PKEY_CTX_set_signature_md(EVP_PKEY_CTX *ctx, const EVP_MD *md)
 {
-    return evp_pkey_ctx_set_md(ctx, md, ctx-&gt;op.sig.sigprovctx == NULL,
+    return evp_pkey_ctx_set_md(ctx, md, ctx-&gt;op.sig.algctx == NULL,
                                OSSL_SIGNATURE_PARAM_DIGEST,
                                EVP_PKEY_OP_TYPE_SIG, EVP_PKEY_CTRL_MD);
 }
 
 int EVP_PKEY_CTX_set_tls1_prf_md(EVP_PKEY_CTX *ctx, const EVP_MD *md)
 {
-    return evp_pkey_ctx_set_md(ctx, md, ctx-&gt;op.kex.exchprovctx == NULL,
+    return evp_pkey_ctx_set_md(ctx, md, ctx-&gt;op.kex.algctx == NULL,
                                OSSL_KDF_PARAM_DIGEST,
                                EVP_PKEY_OP_DERIVE, EVP_PKEY_CTRL_TLS_MD);
 }
@@ -997,7 +997,7 @@ static int evp_pkey_ctx_set1_octet_string(EVP_PKEY_CTX *ctx, int fallback,
 int EVP_PKEY_CTX_set1_tls1_prf_secret(EVP_PKEY_CTX *ctx,
                                       const unsigned char *sec, int seclen)
 {
-    return evp_pkey_ctx_set1_octet_string(ctx, ctx-&gt;op.kex.exchprovctx == NULL,
+    return evp_pkey_ctx_set1_octet_string(ctx, ctx-&gt;op.kex.algctx == NULL,
                                           OSSL_KDF_PARAM_SECRET,
                                           EVP_PKEY_OP_DERIVE,
                                           EVP_PKEY_CTRL_TLS_SECRET,
@@ -1007,7 +1007,7 @@ int EVP_PKEY_CTX_set1_tls1_prf_secret(EVP_PKEY_CTX *ctx,
 int EVP_PKEY_CTX_add1_tls1_prf_seed(EVP_PKEY_CTX *ctx,
                                     const unsigned char *seed, int seedlen)
 {
-    return evp_pkey_ctx_set1_octet_string(ctx, ctx-&gt;op.kex.exchprovctx == NULL,
+    return evp_pkey_ctx_set1_octet_string(ctx, ctx-&gt;op.kex.algctx == NULL,
                                           OSSL_KDF_PARAM_SEED,
                                           EVP_PKEY_OP_DERIVE,
                                           EVP_PKEY_CTRL_TLS_SEED,
@@ -1016,7 +1016,7 @@ int EVP_PKEY_CTX_add1_tls1_prf_seed(EVP_PKEY_CTX *ctx,
 
 int EVP_PKEY_CTX_set_hkdf_md(EVP_PKEY_CTX *ctx, const EVP_MD *md)
 {
-    return evp_pkey_ctx_set_md(ctx, md, ctx-&gt;op.kex.exchprovctx == NULL,
+    return evp_pkey_ctx_set_md(ctx, md, ctx-&gt;op.kex.algctx == NULL,
                                OSSL_KDF_PARAM_DIGEST,
                                EVP_PKEY_OP_DERIVE, EVP_PKEY_CTRL_HKDF_MD);
 }
@@ -1024,7 +1024,7 @@ int EVP_PKEY_CTX_set_hkdf_md(EVP_PKEY_CTX *ctx, const EVP_MD *md)
 int EVP_PKEY_CTX_set1_hkdf_salt(EVP_PKEY_CTX *ctx,
                                 const unsigned char *salt, int saltlen)
 {
-    return evp_pkey_ctx_set1_octet_string(ctx, ctx-&gt;op.kex.exchprovctx == NULL,
+    return evp_pkey_ctx_set1_octet_string(ctx, ctx-&gt;op.kex.algctx == NULL,
                                           OSSL_KDF_PARAM_SALT,
                                           EVP_PKEY_OP_DERIVE,
                                           EVP_PKEY_CTRL_HKDF_SALT,
@@ -1034,7 +1034,7 @@ int EVP_PKEY_CTX_set1_hkdf_salt(EVP_PKEY_CTX *ctx,
 int EVP_PKEY_CTX_set1_hkdf_key(EVP_PKEY_CTX *ctx,
                                       const unsigned char *key, int keylen)
 {
-    return evp_pkey_ctx_set1_octet_string(ctx, ctx-&gt;op.kex.exchprovctx == NULL,
+    return evp_pkey_ctx_set1_octet_string(ctx, ctx-&gt;op.kex.algctx == NULL,
                                           OSSL_KDF_PARAM_KEY,
                                           EVP_PKEY_OP_DERIVE,
                                           EVP_PKEY_CTRL_HKDF_KEY,
@@ -1044,7 +1044,7 @@ int EVP_PKEY_CTX_set1_hkdf_key(EVP_PKEY_CTX *ctx,
 int EVP_PKEY_CTX_add1_hkdf_info(EVP_PKEY_CTX *ctx,
                                       const unsigned char *info, int infolen)
 {
-    return evp_pkey_ctx_set1_octet_string(ctx, ctx-&gt;op.kex.exchprovctx == NULL,
+    return evp_pkey_ctx_set1_octet_string(ctx, ctx-&gt;op.kex.algctx == NULL,
                                           OSSL_KDF_PARAM_INFO,
                                           EVP_PKEY_OP_DERIVE,
                                           EVP_PKEY_CTRL_HKDF_INFO,
@@ -1062,7 +1062,7 @@ int EVP_PKEY_CTX_hkdf_mode(EVP_PKEY_CTX *ctx, int mode)
     }
 
     /* Code below to be removed when legacy support is dropped. */
-    if (ctx-&gt;op.kex.exchprovctx == NULL)
+    if (ctx-&gt;op.kex.algctx == NULL)
         return EVP_PKEY_CTX_ctrl(ctx, -1, EVP_PKEY_OP_DERIVE,
                                  EVP_PKEY_CTRL_HKDF_MODE, mode, NULL);
     /* end of legacy support */
@@ -1081,7 +1081,7 @@ int EVP_PKEY_CTX_hkdf_mode(EVP_PKEY_CTX *ctx, int mode)
 int EVP_PKEY_CTX_set1_pbe_pass(EVP_PKEY_CTX *ctx, const char *pass,
                                int passlen)
 {
-    return evp_pkey_ctx_set1_octet_string(ctx, ctx-&gt;op.kex.exchprovctx == NULL,
+    return evp_pkey_ctx_set1_octet_string(ctx, ctx-&gt;op.kex.algctx == NULL,
                                           OSSL_KDF_PARAM_PASSWORD,
                                           EVP_PKEY_OP_DERIVE,
                                           EVP_PKEY_CTRL_PASS,
@@ -1091,7 +1091,7 @@ int EVP_PKEY_CTX_set1_pbe_pass(EVP_PKEY_CTX *ctx, const char *pass,
 int EVP_PKEY_CTX_set1_scrypt_salt(EVP_PKEY_CTX *ctx,
                                   const unsigned char *salt, int saltlen)
 {
-    return evp_pkey_ctx_set1_octet_string(ctx, ctx-&gt;op.kex.exchprovctx == NULL,
+    return evp_pkey_ctx_set1_octet_string(ctx, ctx-&gt;op.kex.algctx == NULL,
                                           OSSL_KDF_PARAM_SALT,
                                           EVP_PKEY_OP_DERIVE,
                                           EVP_PKEY_CTRL_SCRYPT_SALT,
@@ -1110,7 +1110,7 @@ static int evp_pkey_ctx_set_uint64(EVP_PKEY_CTX *ctx, const char *param,
     }
 
     /* Code below to be removed when legacy support is dropped. */
-    if (ctx-&gt;op.kex.exchprovctx == NULL)
+    if (ctx-&gt;op.kex.algctx == NULL)
         return EVP_PKEY_CTX_ctrl_uint64(ctx, -1, op, ctrl, val);
     /* end of legacy support */
 
diff --git a/crypto/evp/signature.c b/crypto/evp/signature.c
index e80d4f503d..b4e0ff2527 100644
--- a/crypto/evp/signature.c
+++ b/crypto/evp/signature.c
@@ -459,9 +459,9 @@ static int evp_pkey_signature_init(EVP_PKEY_CTX *ctx, int operation,
     /* No more legacy from here down to legacy: */
 
     ctx-&gt;op.sig.signature = signature;
-    ctx-&gt;op.sig.sigprovctx =
+    ctx-&gt;op.sig.algctx =
         signature-&gt;newctx(ossl_provider_ctx(signature-&gt;prov), ctx-&gt;propquery);
-    if (ctx-&gt;op.sig.sigprovctx == NULL) {
+    if (ctx-&gt;op.sig.algctx == NULL) {
         /* The provider key can stay in the cache */
         ERR_raise(ERR_LIB_EVP, EVP_R_INITIALIZATION_ERROR);
         goto err;
@@ -474,7 +474,7 @@ static int evp_pkey_signature_init(EVP_PKEY_CTX *ctx, int operation,
             ret = -2;
             goto err;
         }
-        ret = signature-&gt;sign_init(ctx-&gt;op.sig.sigprovctx, provkey, params);
+        ret = signature-&gt;sign_init(ctx-&gt;op.sig.algctx, provkey, params);
         break;
     case EVP_PKEY_OP_VERIFY:
         if (signature-&gt;verify_init == NULL) {
@@ -482,7 +482,7 @@ static int evp_pkey_signature_init(EVP_PKEY_CTX *ctx, int operation,
             ret = -2;
             goto err;
         }
-        ret = signature-&gt;verify_init(ctx-&gt;op.sig.sigprovctx, provkey, params);
+        ret = signature-&gt;verify_init(ctx-&gt;op.sig.algctx, provkey, params);
         break;
     case EVP_PKEY_OP_VERIFYRECOVER:
         if (signature-&gt;verify_recover_init == NULL) {
@@ -490,7 +490,7 @@ static int evp_pkey_signature_init(EVP_PKEY_CTX *ctx, int operation,
             ret = -2;
             goto err;
         }
-        ret = signature-&gt;verify_recover_init(ctx-&gt;op.sig.sigprovctx, provkey,
+        ret = signature-&gt;verify_recover_init(ctx-&gt;op.sig.algctx, provkey,
                                              params);
         break;
     default:
@@ -499,8 +499,8 @@ static int evp_pkey_signature_init(EVP_PKEY_CTX *ctx, int operation,
     }
 
     if (ret &lt;= 0) {
-        signature-&gt;freectx(ctx-&gt;op.sig.sigprovctx);
-        ctx-&gt;op.sig.sigprovctx = NULL;
+        signature-&gt;freectx(ctx-&gt;op.sig.algctx);
+        ctx-&gt;op.sig.algctx = NULL;
         goto err;
     }
     goto end;
@@ -583,10 +583,10 @@ int EVP_PKEY_sign(EVP_PKEY_CTX *ctx,
         return -1;
     }
 
-    if (ctx-&gt;op.sig.sigprovctx == NULL)
+    if (ctx-&gt;op.sig.algctx == NULL)
         goto legacy;
 
-    ret = ctx-&gt;op.sig.signature-&gt;sign(ctx-&gt;op.sig.sigprovctx, sig, siglen,
+    ret = ctx-&gt;op.sig.signature-&gt;sign(ctx-&gt;op.sig.algctx, sig, siglen,
                                       SIZE_MAX, tbs, tbslen);
 
     return ret;
@@ -627,10 +627,10 @@ int EVP_PKEY_verify(EVP_PKEY_CTX *ctx,
         return -1;
     }
 
-    if (ctx-&gt;op.sig.sigprovctx == NULL)
+    if (ctx-&gt;op.sig.algctx == NULL)
         goto legacy;
 
-    ret = ctx-&gt;op.sig.signature-&gt;verify(ctx-&gt;op.sig.sigprovctx, sig, siglen,
+    ret = ctx-&gt;op.sig.signature-&gt;verify(ctx-&gt;op.sig.algctx, sig, siglen,
                                         tbs, tbslen);
 
     return ret;
@@ -670,10 +670,10 @@ int EVP_PKEY_verify_recover(EVP_PKEY_CTX *ctx,
         return -1;
     }
 
-    if (ctx-&gt;op.sig.sigprovctx == NULL)
+    if (ctx-&gt;op.sig.algctx == NULL)
         goto legacy;
 
-    ret = ctx-&gt;op.sig.signature-&gt;verify_recover(ctx-&gt;op.sig.sigprovctx, rout,
+    ret = ctx-&gt;op.sig.signature-&gt;verify_recover(ctx-&gt;op.sig.algctx, rout,
                                                 routlen,
                                                 (rout == NULL ? 0 : *routlen),
                                                 sig, siglen);
diff --git a/include/crypto/evp.h b/include/crypto/evp.h
index 92a9f0fc29..ea61b83469 100644
--- a/include/crypto/evp.h
+++ b/include/crypto/evp.h
@@ -58,21 +58,37 @@ struct evp_pkey_ctx_st {
 
         struct {
             EVP_KEYEXCH *exchange;
-            void *exchprovctx;
+            /*
+             * Opaque ctx returned from a providers exchange algorithm
+             * implementation OSSL_FUNC_keyexch_newctx()
+             */
+            void *algctx;
         } kex;
 
         struct {
             EVP_SIGNATURE *signature;
-            void *sigprovctx;
+            /*
+             * Opaque ctx returned from a providers signature algorithm
+             * implementation OSSL_FUNC_signature_newctx()
+             */
+            void *algctx;
         } sig;
 
         struct {
             EVP_ASYM_CIPHER *cipher;
-            void *ciphprovctx;
+            /*
+             * Opaque ctx returned from a providers asymmetric cipher algorithm
+             * implementation OSSL_FUNC_asym_cipher_newctx()
+             */
+            void *algctx;
         } ciph;
         struct {
             EVP_KEM *kem;
-            void *kemprovctx;
+            /*
+             * Opaque ctx returned from a providers KEM algorithm
+             * implementation OSSL_FUNC_kem_newctx()
+             */
+            void *algctx;
         } encap;
     } op;
 
diff --git a/test/drbgtest.c b/test/drbgtest.c
index 70e062ce75..ad5266ce3e 100644
--- a/test/drbgtest.c
+++ b/test/drbgtest.c
@@ -104,7 +104,7 @@ DRBG_UINT(reseed_counter)
 
 static PROV_DRBG *prov_rand(EVP_RAND_CTX *drbg)
 {
-    return (PROV_DRBG *)drbg-&gt;data;
+    return (PROV_DRBG *)drbg-&gt;algctx;
 }
 
 static void set_reseed_counter(EVP_RAND_CTX *drbg, unsigned int n)
diff --git a/test/testutil/fake_random.c b/test/testutil/fake_random.c
index bdd48d394c..f2f0e2793f 100644
--- a/test/testutil/fake_random.c
+++ b/test/testutil/fake_random.c
@@ -179,7 +179,7 @@ static int check_rng(EVP_RAND_CTX *rng, const char *name)
         TEST_info(&quot;random: %s&quot;, name);
         return 0;
     }
-    f = rng-&gt;data;
+    f = rng-&gt;algctx;
     f-&gt;name = name;
     f-&gt;ctx = rng;
     return 1;
@@ -216,7 +216,7 @@ void fake_rand_set_callback(EVP_RAND_CTX *rng,
                                       const char *name, EVP_RAND_CTX *ctx))
 {
     if (rng != NULL)
-        ((FAKE_RAND *)rng-&gt;data)-&gt;cb = cb;
+        ((FAKE_RAND *)rng-&gt;algctx)-&gt;cb = cb;
 }
 
 void fake_rand_set_public_private_callbacks(OSSL_LIB_CTX *libctx,
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034424.html">[openssl]  master update
</A></li>
	<LI>Next message: <A HREF="034426.html">[openssl]  master update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34425">[ date ]</a>
              <a href="thread.html#34425">[ thread ]</a>
              <a href="subject.html#34425">[ subject ]</a>
              <a href="author.html#34425">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-commits.html">More information about the openssl-commits
mailing list</a><br>
</body></html>
