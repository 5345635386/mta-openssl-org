<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-project/2018-September/index.html" >
   <LINK REL="made" HREF="mailto:openssl-project%40openssl.org?Subject=Re%3A%20%5Bopenssl-project%5D%20coverity%20defect%20release%20criteria%20%28Fwd%3A%20New%0A%20Defects%20reported%20by%20Coverity%20Scan%20for%20openssl/openssl%29&In-Reply-To=%3C20180909160416.GV73164%40kduck.kaduk.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001035.html">
   <LINK REL="Next"  HREF="001037.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)</H1>
    <B>Benjamin Kaduk</B> 
    <A HREF="mailto:openssl-project%40openssl.org?Subject=Re%3A%20%5Bopenssl-project%5D%20coverity%20defect%20release%20criteria%20%28Fwd%3A%20New%0A%20Defects%20reported%20by%20Coverity%20Scan%20for%20openssl/openssl%29&In-Reply-To=%3C20180909160416.GV73164%40kduck.kaduk.org%3E"
       TITLE="[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)">kaduk at mit.edu
       </A><BR>
    <I>Sun Sep  9 16:04:16 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="001035.html">[openssl-project] Please freeze the repo
</A></li>
        <LI>Next message: <A HREF="001037.html">[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1036">[ date ]</a>
              <a href="thread.html#1036">[ thread ]</a>
              <a href="subject.html#1036">[ subject ]</a>
              <a href="author.html#1036">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I see that Matthias has opened pull requests for a couple of these already;
are you planning to work through the rest of them as well?

-Ben

On Sun, Sep 09, 2018 at 09:28:12AM +0000, <A HREF="../../../mailman/listinfo/openssl-project.html">scan-admin at coverity.com</A> wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> Please find the latest report on new defect(s) introduced to openssl/openssl found with Coverity Scan.
</I>&gt;<i> 
</I>&gt;<i> 6 new defect(s) introduced to openssl/openssl found with Coverity Scan.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> New defect(s) Reported-by: Coverity Scan
</I>&gt;<i> Showing 6 of 6 defect(s)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ** CID 1439138:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ________________________________________________________________________________________________________
</I>&gt;<i> *** CID 1439138:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;<i> /crypto/rsa/rsa_pss.c: 247 in RSA_padding_add_PKCS1_PSS_mgf1()
</I>&gt;<i> 241         EM[emLen - 1] = 0xbc;
</I>&gt;<i> 242     
</I>&gt;<i> 243         ret = 1;
</I>&gt;<i> 244     
</I>&gt;<i> 245      err:
</I>&gt;<i> 246         EVP_MD_CTX_free(ctx);
</I>&gt;<i> &gt;&gt;&gt;     CID 1439138:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;<i> &gt;&gt;&gt;     &quot;sLen&quot; is passed to a parameter that cannot be negative.
</I>&gt;<i> 247         OPENSSL_clear_free(salt, sLen);
</I>&gt;<i> 248     
</I>&gt;<i> 249         return ret;
</I>&gt;<i> 250     
</I>&gt;<i> 251     }
</I>&gt;<i> 252     
</I>&gt;<i> 253     #if defined(_MSC_VER)
</I>&gt;<i> 254     # pragma optimize(&quot;&quot;,on)
</I>&gt;<i> 
</I>&gt;<i> ** CID 1439137:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ________________________________________________________________________________________________________
</I>&gt;<i> *** CID 1439137:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;<i> /crypto/sm2/sm2_pmeth.c: 277 in pkey_sm2_digest_custom()
</I>&gt;<i> 271         }
</I>&gt;<i> 272     
</I>&gt;<i> 273         /* get hashed prefix 'z' of tbs message */
</I>&gt;<i> 274         if (!sm2_compute_z_digest(z, md, smctx-&gt;id, smctx-&gt;id_len, ec))
</I>&gt;<i> 275             return 0;
</I>&gt;<i> 276     
</I>&gt;<i> &gt;&gt;&gt;     CID 1439137:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;<i> &gt;&gt;&gt;     &quot;EVP_MD_size(md)&quot; is passed to a parameter that cannot be negative.
</I>&gt;<i> 277         return EVP_DigestUpdate(mctx, z, EVP_MD_size(md));
</I>&gt;<i> 278     }
</I>&gt;<i> 279     
</I>&gt;<i> 280     const EVP_PKEY_METHOD sm2_pkey_meth = {
</I>&gt;<i> 281         EVP_PKEY_SM2,
</I>&gt;<i> 282         0,
</I>&gt;<i> 
</I>&gt;<i> ** CID 1439136:  Resource leaks  (RESOURCE_LEAK)
</I>&gt;<i> /test/dhtest.c: 202 in dh_test()
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ________________________________________________________________________________________________________
</I>&gt;<i> *** CID 1439136:  Resource leaks  (RESOURCE_LEAK)
</I>&gt;<i> /test/dhtest.c: 202 in dh_test()
</I>&gt;<i> 196         BN_free(bp);
</I>&gt;<i> 197         BN_free(bg);
</I>&gt;<i> 198         BN_free(cpriv_key);
</I>&gt;<i> 199         BN_GENCB_free(_cb);
</I>&gt;<i> 200         DH_free(dh);
</I>&gt;<i> 201     
</I>&gt;<i> &gt;&gt;&gt;     CID 1439136:  Resource leaks  (RESOURCE_LEAK)
</I>&gt;<i> &gt;&gt;&gt;     Variable &quot;priv_key&quot; going out of scope leaks the storage it points to.
</I>&gt;<i> 202         return ret;
</I>&gt;<i> 203     }
</I>&gt;<i> 204     
</I>&gt;<i> 205     static int cb(int p, int n, BN_GENCB *arg)
</I>&gt;<i> 206     {
</I>&gt;<i> 207         return 1;
</I>&gt;<i> 
</I>&gt;<i> ** CID 1439135:  Memory - illegal accesses  (INCOMPATIBLE_CAST)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ________________________________________________________________________________________________________
</I>&gt;<i> *** CID 1439135:  Memory - illegal accesses  (INCOMPATIBLE_CAST)
</I>&gt;<i> /apps/speed.c: 3105 in speed_main()
</I>&gt;<i> 3099                 ERR_print_errors(bio_err);
</I>&gt;<i> 3100                 rsa_count = 1;
</I>&gt;<i> 3101             } else {
</I>&gt;<i> 3102                 for (i = 0; i &lt; loopargs_len; i++) {
</I>&gt;<i> 3103                     /* Perform EdDSA signature test */
</I>&gt;<i> 3104                     loopargs[i].siglen = test_ed_curves[testnum].siglen;
</I>&gt;<i> &gt;&gt;&gt;     CID 1439135:  Memory - illegal accesses  (INCOMPATIBLE_CAST)
</I>&gt;<i> &gt;&gt;&gt;     Pointer &quot;&amp;loopargs[i].siglen&quot; points to an object whose effective type is &quot;unsigned int&quot; (32 bits, unsigned) but is dereferenced as a wider &quot;unsigned long&quot; (64 bits, unsigned).  This may lead to memory corruption.
</I>&gt;<i> 3105                     st = EVP_DigestSign(loopargs[i].eddsa_ctx[testnum],
</I>&gt;<i> 3106                                         loopargs[i].buf2, (size_t *)&amp;loopargs[i].siglen,
</I>&gt;<i> 3107                                         loopargs[i].buf, 20);
</I>&gt;<i> 3108                     if (st == 0)
</I>&gt;<i> 3109                         break;
</I>&gt;<i> 3110                 }
</I>&gt;<i> 
</I>&gt;<i> ** CID 1423323:  Null pointer dereferences  (FORWARD_NULL)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ________________________________________________________________________________________________________
</I>&gt;<i> *** CID 1423323:  Null pointer dereferences  (FORWARD_NULL)
</I>&gt;<i> /test/evp_extra_test.c: 894 in test_EVP_PKEY_check()
</I>&gt;<i> 888     
</I>&gt;<i> 889         if (!TEST_int_eq(EVP_PKEY_param_check(ctx), expected_param_check))
</I>&gt;<i> 890             goto done;
</I>&gt;<i> 891     
</I>&gt;<i> 892         ctx2 = EVP_PKEY_CTX_new_id(0xdefaced, NULL);
</I>&gt;<i> 893         /* assign the pkey directly, as an internal test */
</I>&gt;<i> &gt;&gt;&gt;     CID 1423323:  Null pointer dereferences  (FORWARD_NULL)
</I>&gt;<i> &gt;&gt;&gt;     Passing null pointer &quot;pkey&quot; to &quot;EVP_PKEY_up_ref&quot;, which dereferences it.
</I>&gt;<i> 894         EVP_PKEY_up_ref(pkey);
</I>&gt;<i> 895         ctx2-&gt;pkey = pkey;
</I>&gt;<i> 896     
</I>&gt;<i> 897         if (!TEST_int_eq(EVP_PKEY_check(ctx2), 0xbeef))
</I>&gt;<i> 898             goto done;
</I>&gt;<i> 899     
</I>&gt;<i> 
</I>&gt;<i> ** CID 1201571:  Error handling issues  (CHECKED_RETURN)
</I>&gt;<i> /crypto/pkcs12/p12_init.c: 25 in PKCS12_init()
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ________________________________________________________________________________________________________
</I>&gt;<i> *** CID 1201571:  Error handling issues  (CHECKED_RETURN)
</I>&gt;<i> /crypto/pkcs12/p12_init.c: 25 in PKCS12_init()
</I>&gt;<i> 19         PKCS12 *pkcs12;
</I>&gt;<i> 20     
</I>&gt;<i> 21         if ((pkcs12 = PKCS12_new()) == NULL) {
</I>&gt;<i> 22             PKCS12err(PKCS12_F_PKCS12_INIT, ERR_R_MALLOC_FAILURE);
</I>&gt;<i> 23             return NULL;
</I>&gt;<i> 24         }
</I>&gt;<i> &gt;&gt;&gt;     CID 1201571:  Error handling issues  (CHECKED_RETURN)
</I>&gt;<i> &gt;&gt;&gt;     Calling &quot;ASN1_INTEGER_set&quot; without checking return value (as is done elsewhere 30 out of 37 times).
</I>&gt;<i> 25         ASN1_INTEGER_set(pkcs12-&gt;version, 3);
</I>&gt;<i> 26         pkcs12-&gt;authsafes-&gt;type = OBJ_nid2obj(mode);
</I>&gt;<i> 27         switch (mode) {
</I>&gt;<i> 28         case NID_pkcs7_data:
</I>&gt;<i> 29             if ((pkcs12-&gt;authsafes-&gt;d.data = ASN1_OCTET_STRING_new()) == NULL) {
</I>&gt;<i> 30                 PKCS12err(PKCS12_F_PKCS12_INIT, ERR_R_MALLOC_FAILURE);
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ________________________________________________________________________________________________________
</I>&gt;<i> To view the defects in Coverity Scan visit, <A HREF="https://u2389337.ct.sendgrid.net/wf/click?upn=08onrYu34A-2BWcWUl-2F-2BfV0V05UPxvVjWch-2Bd2MGckcRakUl6QyjujEohY7rPpoYUE4H-2Fm-2BeoDOl8jw7bf4Z78hw-3D-3D_bpOft2V4l9NXEcTx5CnNFJqpP-2F8a09dz6vsuNilvAJgBy9hWgnGhTAFGZnkvhcJuSQocoiCV36Dw66FwvViDOF-2BGQbzbMH8LM1tsnputryXt7SEgZZ-2FmpoWsuVr91UzOFBmmlL0bipzCjL7WfoT7QvLLnFuGxTjboshY44ftCBEhW8TAZR-2B1c1y7JdbYkdSXw-2B7Vmts-2F-2BitkvIjISgebBlgXuThX1DnzutpYSf00XD0-3D">https://u2389337.ct.sendgrid.net/wf/click?upn=08onrYu34A-2BWcWUl-2F-2BfV0V05UPxvVjWch-2Bd2MGckcRakUl6QyjujEohY7rPpoYUE4H-2Fm-2BeoDOl8jw7bf4Z78hw-3D-3D_bpOft2V4l9NXEcTx5CnNFJqpP-2F8a09dz6vsuNilvAJgBy9hWgnGhTAFGZnkvhcJuSQocoiCV36Dw66FwvViDOF-2BGQbzbMH8LM1tsnputryXt7SEgZZ-2FmpoWsuVr91UzOFBmmlL0bipzCjL7WfoT7QvLLnFuGxTjboshY44ftCBEhW8TAZR-2B1c1y7JdbYkdSXw-2B7Vmts-2F-2BitkvIjISgebBlgXuThX1DnzutpYSf00XD0-3D</A>
</I>&gt;<i> 
</I>&gt;<i>   To manage Coverity Scan email notifications for &quot;<A HREF="../../../mailman/listinfo/openssl-project.html">kaduk-github at mit.edu</A>&quot;, click <A HREF="https://u2389337.ct.sendgrid.net/wf/click?upn=08onrYu34A-2BWcWUl-2F-2BfV0V05UPxvVjWch-2Bd2MGckcRbVDbis712qZDP-2FA8y06Nq414hC6p-2BsqBEViFMJYotwSt4SYNeSzd6tPCdCHgDzpHIBW-2Fr0I0sQJCop-2Fx5Lu2ueYFxYqLmFh7APZbTTED-2B53KXZ2qVo0Y2q2bUC-2BpL2TzE-3D_bpOft2V4l9NXEcTx5CnNFJqpP-2F8a09dz6vsuNilvAJgBy9hWgnGhTAFGZnkvhcJu7xxYKPr1HkiPh-2BL3MaUbhQMZae3MPjv9c6bU6U4uhOZEhiS1P-2BwpukQ4-2BcSzk5FouA75ij0odEEgZcWTB05BKimz0wg0Y8JsC1Izz20-2FpfRp2kjWD47vvs4NmxuDPkNqvS3qoLRQ0vIXW8CFF339G-2B7jGolZ214Wxo3Gh6Hc0HY-3D">https://u2389337.ct.sendgrid.net/wf/click?upn=08onrYu34A-2BWcWUl-2F-2BfV0V05UPxvVjWch-2Bd2MGckcRbVDbis712qZDP-2FA8y06Nq414hC6p-2BsqBEViFMJYotwSt4SYNeSzd6tPCdCHgDzpHIBW-2Fr0I0sQJCop-2Fx5Lu2ueYFxYqLmFh7APZbTTED-2B53KXZ2qVo0Y2q2bUC-2BpL2TzE-3D_bpOft2V4l9NXEcTx5CnNFJqpP-2F8a09dz6vsuNilvAJgBy9hWgnGhTAFGZnkvhcJu7xxYKPr1HkiPh-2BL3MaUbhQMZae3MPjv9c6bU6U4uhOZEhiS1P-2BwpukQ4-2BcSzk5FouA75ij0odEEgZcWTB05BKimz0wg0Y8JsC1Izz20-2FpfRp2kjWD47vvs4NmxuDPkNqvS3qoLRQ0vIXW8CFF339G-2B7jGolZ214Wxo3Gh6Hc0HY-3D</A>
</I>&gt;<i> 
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001035.html">[openssl-project] Please freeze the repo
</A></li>
	<LI>Next message: <A HREF="001037.html">[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1036">[ date ]</a>
              <a href="thread.html#1036">[ thread ]</a>
              <a href="subject.html#1036">[ subject ]</a>
              <a href="author.html#1036">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-project.html">More information about the openssl-project
mailing list</a><br>
</body></html>
