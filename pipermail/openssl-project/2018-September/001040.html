<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-project/2018-September/index.html" >
   <LINK REL="made" HREF="mailto:openssl-project%40openssl.org?Subject=Re%3A%20%5Bopenssl-project%5D%20coverity%20defect%20release%20criteria%20%28Fwd%3A%20New%0A%20Defects%20reported%20by%20Coverity%20Scan%20for%20openssl/openssl%29&In-Reply-To=%3C20180909230225.GX73164%40kduck.kaduk.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001038.html">
   <LINK REL="Next"  HREF="001041.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)</H1>
    <B>Benjamin Kaduk</B> 
    <A HREF="mailto:openssl-project%40openssl.org?Subject=Re%3A%20%5Bopenssl-project%5D%20coverity%20defect%20release%20criteria%20%28Fwd%3A%20New%0A%20Defects%20reported%20by%20Coverity%20Scan%20for%20openssl/openssl%29&In-Reply-To=%3C20180909230225.GX73164%40kduck.kaduk.org%3E"
       TITLE="[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)">kaduk at mit.edu
       </A><BR>
    <I>Sun Sep  9 23:02:25 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="001038.html">[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
</A></li>
        <LI>Next message: <A HREF="001041.html">[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1040">[ date ]</a>
              <a href="thread.html#1040">[ thread ]</a>
              <a href="subject.html#1040">[ subject ]</a>
              <a href="author.html#1040">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, Sep 09, 2018 at 10:38:50PM +0000, Dr. Matthias St. Pierre wrote:
&gt;<i> preliminary status report:
</I>&gt;<i> 
</I>&gt;<i> *** CID 1439138:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;<i> 	see <A HREF="https://github.com/openssl/openssl/pull/7156">https://github.com/openssl/openssl/pull/7156</A>
</I>&gt;<i> 	
</I>&gt;<i> *** CID 1439137:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;<i> 	work in progress...               
</I>
I think this one may be a false positive -- it's worried that EVP_MD_size()
will return -1, but we've essentially already validated that the md is
valid by the time we get there.  I didn't do a full check, though.

-Ben

&gt;<i> *** CID 1439136:  Resource leaks  (RESOURCE_LEAK)
</I>&gt;<i> 	see <A HREF="https://github.com/openssl/openssl/pull/7155">https://github.com/openssl/openssl/pull/7155</A>
</I>&gt;<i> 
</I>&gt;<i> *** CID 1439135:  Memory - illegal accesses  (INCOMPATIBLE_CAST)
</I>&gt;<i> 	todo
</I>&gt;<i> 
</I>&gt;<i> *** CID 1423323:  Null pointer dereferences  (FORWARD_NULL)
</I>&gt;<i> 	see <A HREF="https://github.com/openssl/openssl/pull/7158">https://github.com/openssl/openssl/pull/7158</A>
</I>&gt;<i> 
</I>&gt;<i> *** CID 1201571:  Error handling issues  (CHECKED_RETURN)
</I>&gt;<i> 	todo
</I>&gt;<i> 
</I>&gt;<i> if anybody wants to fix one of the CIDs marked 'todo', no problem. Just drop a note on the openssl-project list.
</I>&gt;<i> 
</I>&gt;<i> Matthias
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt; -----Urspr&#252;ngliche Nachricht-----
</I>&gt;<i> &gt; Von: openssl-project &lt;<A HREF="../../../mailman/listinfo/openssl-project.html">openssl-project-bounces at openssl.org</A>&gt; Im Auftrag von Benjamin Kaduk
</I>&gt;<i> &gt; Gesendet: Sonntag, 9. September 2018 18:04
</I>&gt;<i> &gt; An: <A HREF="../../../mailman/listinfo/openssl-project.html">openssl-project at openssl.org</A>
</I>&gt;<i> &gt; Betreff: [openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I see that Matthias has opened pull requests for a couple of these already;
</I>&gt;<i> &gt; are you planning to work through the rest of them as well?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; -Ben
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; On Sun, Sep 09, 2018 at 09:28:12AM +0000, <A HREF="../../../mailman/listinfo/openssl-project.html">scan-admin at coverity.com</A> wrote:
</I>&gt;<i> &gt; &gt; Hi,
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Please find the latest report on new defect(s) introduced to openssl/openssl found with Coverity Scan.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; 6 new defect(s) introduced to openssl/openssl found with Coverity Scan.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; New defect(s) Reported-by: Coverity Scan
</I>&gt;<i> &gt; &gt; Showing 6 of 6 defect(s)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ** CID 1439138:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ________________________________________________________________________________________________________
</I>&gt;<i> &gt; &gt; *** CID 1439138:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;<i> &gt; &gt; /crypto/rsa/rsa_pss.c: 247 in RSA_padding_add_PKCS1_PSS_mgf1()
</I>&gt;<i> &gt; &gt; 241         EM[emLen - 1] = 0xbc;
</I>&gt;<i> &gt; &gt; 242
</I>&gt;<i> &gt; &gt; 243         ret = 1;
</I>&gt;<i> &gt; &gt; 244
</I>&gt;<i> &gt; &gt; 245      err:
</I>&gt;<i> &gt; &gt; 246         EVP_MD_CTX_free(ctx);
</I>&gt;<i> &gt; &gt; &gt;&gt;&gt;     CID 1439138:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;<i> &gt; &gt; &gt;&gt;&gt;     &quot;sLen&quot; is passed to a parameter that cannot be negative.
</I>&gt;<i> &gt; &gt; 247         OPENSSL_clear_free(salt, sLen);
</I>&gt;<i> &gt; &gt; 248
</I>&gt;<i> &gt; &gt; 249         return ret;
</I>&gt;<i> &gt; &gt; 250
</I>&gt;<i> &gt; &gt; 251     }
</I>&gt;<i> &gt; &gt; 252
</I>&gt;<i> &gt; &gt; 253     #if defined(_MSC_VER)
</I>&gt;<i> &gt; &gt; 254     # pragma optimize(&quot;&quot;,on)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ** CID 1439137:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ________________________________________________________________________________________________________
</I>&gt;<i> &gt; &gt; *** CID 1439137:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;<i> &gt; &gt; /crypto/sm2/sm2_pmeth.c: 277 in pkey_sm2_digest_custom()
</I>&gt;<i> &gt; &gt; 271         }
</I>&gt;<i> &gt; &gt; 272
</I>&gt;<i> &gt; &gt; 273         /* get hashed prefix 'z' of tbs message */
</I>&gt;<i> &gt; &gt; 274         if (!sm2_compute_z_digest(z, md, smctx-&gt;id, smctx-&gt;id_len, ec))
</I>&gt;<i> &gt; &gt; 275             return 0;
</I>&gt;<i> &gt; &gt; 276
</I>&gt;<i> &gt; &gt; &gt;&gt;&gt;     CID 1439137:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;<i> &gt; &gt; &gt;&gt;&gt;     &quot;EVP_MD_size(md)&quot; is passed to a parameter that cannot be negative.
</I>&gt;<i> &gt; &gt; 277         return EVP_DigestUpdate(mctx, z, EVP_MD_size(md));
</I>&gt;<i> &gt; &gt; 278     }
</I>&gt;<i> &gt; &gt; 279
</I>&gt;<i> &gt; &gt; 280     const EVP_PKEY_METHOD sm2_pkey_meth = {
</I>&gt;<i> &gt; &gt; 281         EVP_PKEY_SM2,
</I>&gt;<i> &gt; &gt; 282         0,
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ** CID 1439136:  Resource leaks  (RESOURCE_LEAK)
</I>&gt;<i> &gt; &gt; /test/dhtest.c: 202 in dh_test()
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ________________________________________________________________________________________________________
</I>&gt;<i> &gt; &gt; *** CID 1439136:  Resource leaks  (RESOURCE_LEAK)
</I>&gt;<i> &gt; &gt; /test/dhtest.c: 202 in dh_test()
</I>&gt;<i> &gt; &gt; 196         BN_free(bp);
</I>&gt;<i> &gt; &gt; 197         BN_free(bg);
</I>&gt;<i> &gt; &gt; 198         BN_free(cpriv_key);
</I>&gt;<i> &gt; &gt; 199         BN_GENCB_free(_cb);
</I>&gt;<i> &gt; &gt; 200         DH_free(dh);
</I>&gt;<i> &gt; &gt; 201
</I>&gt;<i> &gt; &gt; &gt;&gt;&gt;     CID 1439136:  Resource leaks  (RESOURCE_LEAK)
</I>&gt;<i> &gt; &gt; &gt;&gt;&gt;     Variable &quot;priv_key&quot; going out of scope leaks the storage it points to.
</I>&gt;<i> &gt; &gt; 202         return ret;
</I>&gt;<i> &gt; &gt; 203     }
</I>&gt;<i> &gt; &gt; 204
</I>&gt;<i> &gt; &gt; 205     static int cb(int p, int n, BN_GENCB *arg)
</I>&gt;<i> &gt; &gt; 206     {
</I>&gt;<i> &gt; &gt; 207         return 1;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ** CID 1439135:  Memory - illegal accesses  (INCOMPATIBLE_CAST)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ________________________________________________________________________________________________________
</I>&gt;<i> &gt; &gt; *** CID 1439135:  Memory - illegal accesses  (INCOMPATIBLE_CAST)
</I>&gt;<i> &gt; &gt; /apps/speed.c: 3105 in speed_main()
</I>&gt;<i> &gt; &gt; 3099                 ERR_print_errors(bio_err);
</I>&gt;<i> &gt; &gt; 3100                 rsa_count = 1;
</I>&gt;<i> &gt; &gt; 3101             } else {
</I>&gt;<i> &gt; &gt; 3102                 for (i = 0; i &lt; loopargs_len; i++) {
</I>&gt;<i> &gt; &gt; 3103                     /* Perform EdDSA signature test */
</I>&gt;<i> &gt; &gt; 3104                     loopargs[i].siglen = test_ed_curves[testnum].siglen;
</I>&gt;<i> &gt; &gt; &gt;&gt;&gt;     CID 1439135:  Memory - illegal accesses  (INCOMPATIBLE_CAST)
</I>&gt;<i> &gt; &gt; &gt;&gt;&gt;     Pointer &quot;&amp;loopargs[i].siglen&quot; points to an object whose effective type is &quot;unsigned int&quot; (32 bits, unsigned) but is dereferenced as a
</I>&gt;<i> &gt; wider &quot;unsigned long&quot; (64 bits, unsigned).  This may lead to memory corruption.
</I>&gt;<i> &gt; &gt; 3105                     st = EVP_DigestSign(loopargs[i].eddsa_ctx[testnum],
</I>&gt;<i> &gt; &gt; 3106                                         loopargs[i].buf2, (size_t *)&amp;loopargs[i].siglen,
</I>&gt;<i> &gt; &gt; 3107                                         loopargs[i].buf, 20);
</I>&gt;<i> &gt; &gt; 3108                     if (st == 0)
</I>&gt;<i> &gt; &gt; 3109                         break;
</I>&gt;<i> &gt; &gt; 3110                 }
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ** CID 1423323:  Null pointer dereferences  (FORWARD_NULL)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ________________________________________________________________________________________________________
</I>&gt;<i> &gt; &gt; *** CID 1423323:  Null pointer dereferences  (FORWARD_NULL)
</I>&gt;<i> &gt; &gt; /test/evp_extra_test.c: 894 in test_EVP_PKEY_check()
</I>&gt;<i> &gt; &gt; 888
</I>&gt;<i> &gt; &gt; 889         if (!TEST_int_eq(EVP_PKEY_param_check(ctx), expected_param_check))
</I>&gt;<i> &gt; &gt; 890             goto done;
</I>&gt;<i> &gt; &gt; 891
</I>&gt;<i> &gt; &gt; 892         ctx2 = EVP_PKEY_CTX_new_id(0xdefaced, NULL);
</I>&gt;<i> &gt; &gt; 893         /* assign the pkey directly, as an internal test */
</I>&gt;<i> &gt; &gt; &gt;&gt;&gt;     CID 1423323:  Null pointer dereferences  (FORWARD_NULL)
</I>&gt;<i> &gt; &gt; &gt;&gt;&gt;     Passing null pointer &quot;pkey&quot; to &quot;EVP_PKEY_up_ref&quot;, which dereferences it.
</I>&gt;<i> &gt; &gt; 894         EVP_PKEY_up_ref(pkey);
</I>&gt;<i> &gt; &gt; 895         ctx2-&gt;pkey = pkey;
</I>&gt;<i> &gt; &gt; 896
</I>&gt;<i> &gt; &gt; 897         if (!TEST_int_eq(EVP_PKEY_check(ctx2), 0xbeef))
</I>&gt;<i> &gt; &gt; 898             goto done;
</I>&gt;<i> &gt; &gt; 899
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ** CID 1201571:  Error handling issues  (CHECKED_RETURN)
</I>&gt;<i> &gt; &gt; /crypto/pkcs12/p12_init.c: 25 in PKCS12_init()
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ________________________________________________________________________________________________________
</I>&gt;<i> &gt; &gt; *** CID 1201571:  Error handling issues  (CHECKED_RETURN)
</I>&gt;<i> &gt; &gt; /crypto/pkcs12/p12_init.c: 25 in PKCS12_init()
</I>&gt;<i> &gt; &gt; 19         PKCS12 *pkcs12;
</I>&gt;<i> &gt; &gt; 20
</I>&gt;<i> &gt; &gt; 21         if ((pkcs12 = PKCS12_new()) == NULL) {
</I>&gt;<i> &gt; &gt; 22             PKCS12err(PKCS12_F_PKCS12_INIT, ERR_R_MALLOC_FAILURE);
</I>&gt;<i> &gt; &gt; 23             return NULL;
</I>&gt;<i> &gt; &gt; 24         }
</I>&gt;<i> &gt; &gt; &gt;&gt;&gt;     CID 1201571:  Error handling issues  (CHECKED_RETURN)
</I>&gt;<i> &gt; &gt; &gt;&gt;&gt;     Calling &quot;ASN1_INTEGER_set&quot; without checking return value (as is done elsewhere 30 out of 37 times).
</I>&gt;<i> &gt; &gt; 25         ASN1_INTEGER_set(pkcs12-&gt;version, 3);
</I>&gt;<i> &gt; &gt; 26         pkcs12-&gt;authsafes-&gt;type = OBJ_nid2obj(mode);
</I>&gt;<i> &gt; &gt; 27         switch (mode) {
</I>&gt;<i> &gt; &gt; 28         case NID_pkcs7_data:
</I>&gt;<i> &gt; &gt; 29             if ((pkcs12-&gt;authsafes-&gt;d.data = ASN1_OCTET_STRING_new()) == NULL) {
</I>&gt;<i> &gt; &gt; 30                 PKCS12err(PKCS12_F_PKCS12_INIT, ERR_R_MALLOC_FAILURE);
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ________________________________________________________________________________________________________
</I>&gt;<i> &gt; &gt; To view the defects in Coverity Scan visit, <A HREF="https://u2389337.ct.sendgrid.net/wf/click?upn=08onrYu34A-2BWcWUl-2F-">https://u2389337.ct.sendgrid.net/wf/click?upn=08onrYu34A-2BWcWUl-2F-</A>
</I>&gt;<i> &gt; 2BfV0V05UPxvVjWch-2Bd2MGckcRakUl6QyjujEohY7rPpoYUE4H-2Fm-2BeoDOl8jw7bf4Z78hw-3D-3D_bpOft2V4l9NXEcTx5CnNFJqpP-
</I>&gt;<i> &gt; 2F8a09dz6vsuNilvAJgBy9hWgnGhTAFGZnkvhcJuSQocoiCV36Dw66FwvViDOF-2BGQbzbMH8LM1tsnputryXt7SEgZZ-
</I>&gt;<i> &gt; 2FmpoWsuVr91UzOFBmmlL0bipzCjL7WfoT7QvLLnFuGxTjboshY44ftCBEhW8TAZR-2B1c1y7JdbYkdSXw-2B7Vmts-2F-
</I>&gt;<i> &gt; 2BitkvIjISgebBlgXuThX1DnzutpYSf00XD0-3D
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;   To manage Coverity Scan email notifications for &quot;<A HREF="../../../mailman/listinfo/openssl-project.html">kaduk-github at mit.edu</A>&quot;, click
</I>&gt;<i> &gt; <A HREF="https://u2389337.ct.sendgrid.net/wf/click?upn=08onrYu34A-2BWcWUl-2F-2BfV0V05UPxvVjWch-2Bd2MGckcRbVDbis712qZDP-">https://u2389337.ct.sendgrid.net/wf/click?upn=08onrYu34A-2BWcWUl-2F-2BfV0V05UPxvVjWch-2Bd2MGckcRbVDbis712qZDP-</A>
</I>&gt;<i> &gt; 2FA8y06Nq414hC6p-2BsqBEViFMJYotwSt4SYNeSzd6tPCdCHgDzpHIBW-2Fr0I0sQJCop-2Fx5Lu2ueYFxYqLmFh7APZbTTED-
</I>&gt;<i> &gt; 2B53KXZ2qVo0Y2q2bUC-2BpL2TzE-3D_bpOft2V4l9NXEcTx5CnNFJqpP-2F8a09dz6vsuNilvAJgBy9hWgnGhTAFGZnkvhcJu7xxYKPr1HkiPh-
</I>&gt;<i> &gt; 2BL3MaUbhQMZae3MPjv9c6bU6U4uhOZEhiS1P-2BwpukQ4-2BcSzk5FouA75ij0odEEgZcWTB05BKimz0wg0Y8JsC1Izz20-
</I>&gt;<i> &gt; 2FpfRp2kjWD47vvs4NmxuDPkNqvS3qoLRQ0vIXW8CFF339G-2B7jGolZ214Wxo3Gh6Hc0HY-3D
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; openssl-project mailing list
</I>&gt;<i> &gt; <A HREF="../../../mailman/listinfo/openssl-project.html">openssl-project at openssl.org</A>
</I>&gt;<i> &gt; <A HREF="../../../mailman/listinfo/openssl-project.html">https://mta.openssl.org/mailman/listinfo/openssl-project</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> openssl-project mailing list
</I>&gt;<i> <A HREF="../../../mailman/listinfo/openssl-project.html">openssl-project at openssl.org</A>
</I>&gt;<i> <A HREF="../../../mailman/listinfo/openssl-project.html">https://mta.openssl.org/mailman/listinfo/openssl-project</A>
</I></PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001038.html">[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
</A></li>
	<LI>Next message: <A HREF="001041.html">[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1040">[ date ]</a>
              <a href="thread.html#1040">[ thread ]</a>
              <a href="subject.html#1040">[ subject ]</a>
              <a href="author.html#1040">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-project.html">More information about the openssl-project
mailing list</a><br>
</body></html>
