<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-project/2018-September/index.html" >
   <LINK REL="made" HREF="mailto:openssl-project%40openssl.org?Subject=Re%3A%20%5Bopenssl-project%5D%20coverity%20defect%20release%20criteria%20%28Fwd%3A%20New%0A%20Defects%20reported%20by%20Coverity%20Scan%20for%20openssl/openssl%29&In-Reply-To=%3C9d14fb20-9ac8-be8e-d669-1c5e4944bfb1%40openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001037.html">
   <LINK REL="Next"  HREF="001042.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)</H1>
    <B>Matt Caswell</B> 
    <A HREF="mailto:openssl-project%40openssl.org?Subject=Re%3A%20%5Bopenssl-project%5D%20coverity%20defect%20release%20criteria%20%28Fwd%3A%20New%0A%20Defects%20reported%20by%20Coverity%20Scan%20for%20openssl/openssl%29&In-Reply-To=%3C9d14fb20-9ac8-be8e-d669-1c5e4944bfb1%40openssl.org%3E"
       TITLE="[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)">matt at openssl.org
       </A><BR>
    <I>Sun Sep  9 22:44:33 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="001037.html">[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
</A></li>
        <LI>Next message: <A HREF="001042.html">[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1039">[ date ]</a>
              <a href="thread.html#1039">[ thread ]</a>
              <a href="subject.html#1039">[ subject ]</a>
              <a href="author.html#1039">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On 09/09/18 19:31, Dr. Matthias St. Pierre wrote:
&gt;<i> I am currently occupied with other things, so I won't be able to look at it before later this evening or tomorrow.
</I>&gt;<i> 
</I>&gt;<i> I also had a quick look at CID 1423323 (see below) but I was unable to see why 'pkey' would be a NULL pointer
</I>&gt;<i> when passed to 'EVP_PKEY_up_ref'. So I'm not sure yet whether this is a false positive.
</I>
It's because Coverity doesn't know that &quot;type&quot; will only ever be 0, 1 or
2. If it wasn't one of those then pkey would be NULL.

BTW, note that there is an oddity in the way we have Coverity set up.
It's my understanding that we filter out defect reports in the tests and
only worry about issues found in the main code base. If you look in the
Coverity tool itself you will never see any issues in the test suite (at
least I've never figured out how to see them if they are there).
Nonetheless it still reports them in the emails it sends out.

As far as the release criteria go we only count the ones shown in the
Coverity tool. That's not to say we shouldn't fix issues in the tests as
well (and actually I'd suggest we stop filtering out problems in the
tests if anyone knows how to do that...perhaps Tim?).

Matt


&gt;<i> 
</I>&gt;<i> Matthias
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> -----Urspr&#252;ngliche Nachricht-----
</I>&gt;&gt;<i> Von: openssl-project &lt;<A HREF="../../../mailman/listinfo/openssl-project.html">openssl-project-bounces at openssl.org</A>&gt; Im Auftrag von Benjamin Kaduk
</I>&gt;&gt;<i> Gesendet: Sonntag, 9. September 2018 18:04
</I>&gt;&gt;<i> An: <A HREF="../../../mailman/listinfo/openssl-project.html">openssl-project at openssl.org</A>
</I>&gt;&gt;<i> Betreff: [openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I see that Matthias has opened pull requests for a couple of these already;
</I>&gt;&gt;<i> are you planning to work through the rest of them as well?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -Ben
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Sun, Sep 09, 2018 at 09:28:12AM +0000, <A HREF="../../../mailman/listinfo/openssl-project.html">scan-admin at coverity.com</A> wrote:
</I>&gt;&gt;&gt;<i> Hi,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Please find the latest report on new defect(s) introduced to openssl/openssl found with Coverity Scan.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 6 new defect(s) introduced to openssl/openssl found with Coverity Scan.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> New defect(s) Reported-by: Coverity Scan
</I>&gt;&gt;&gt;<i> Showing 6 of 6 defect(s)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ** CID 1439138:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ________________________________________________________________________________________________________
</I>&gt;&gt;&gt;<i> *** CID 1439138:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;&gt;&gt;<i> /crypto/rsa/rsa_pss.c: 247 in RSA_padding_add_PKCS1_PSS_mgf1()
</I>&gt;&gt;&gt;<i> 241         EM[emLen - 1] = 0xbc;
</I>&gt;&gt;&gt;<i> 242
</I>&gt;&gt;&gt;<i> 243         ret = 1;
</I>&gt;&gt;&gt;<i> 244
</I>&gt;&gt;&gt;<i> 245      err:
</I>&gt;&gt;&gt;<i> 246         EVP_MD_CTX_free(ctx);
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>     CID 1439138:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>     &quot;sLen&quot; is passed to a parameter that cannot be negative.
</I>&gt;&gt;&gt;<i> 247         OPENSSL_clear_free(salt, sLen);
</I>&gt;&gt;&gt;<i> 248
</I>&gt;&gt;&gt;<i> 249         return ret;
</I>&gt;&gt;&gt;<i> 250
</I>&gt;&gt;&gt;<i> 251     }
</I>&gt;&gt;&gt;<i> 252
</I>&gt;&gt;&gt;<i> 253     #if defined(_MSC_VER)
</I>&gt;&gt;&gt;<i> 254     # pragma optimize(&quot;&quot;,on)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ** CID 1439137:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ________________________________________________________________________________________________________
</I>&gt;&gt;&gt;<i> *** CID 1439137:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;&gt;&gt;<i> /crypto/sm2/sm2_pmeth.c: 277 in pkey_sm2_digest_custom()
</I>&gt;&gt;&gt;<i> 271         }
</I>&gt;&gt;&gt;<i> 272
</I>&gt;&gt;&gt;<i> 273         /* get hashed prefix 'z' of tbs message */
</I>&gt;&gt;&gt;<i> 274         if (!sm2_compute_z_digest(z, md, smctx-&gt;id, smctx-&gt;id_len, ec))
</I>&gt;&gt;&gt;<i> 275             return 0;
</I>&gt;&gt;&gt;<i> 276
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>     CID 1439137:  Integer handling issues  (NEGATIVE_RETURNS)
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>     &quot;EVP_MD_size(md)&quot; is passed to a parameter that cannot be negative.
</I>&gt;&gt;&gt;<i> 277         return EVP_DigestUpdate(mctx, z, EVP_MD_size(md));
</I>&gt;&gt;&gt;<i> 278     }
</I>&gt;&gt;&gt;<i> 279
</I>&gt;&gt;&gt;<i> 280     const EVP_PKEY_METHOD sm2_pkey_meth = {
</I>&gt;&gt;&gt;<i> 281         EVP_PKEY_SM2,
</I>&gt;&gt;&gt;<i> 282         0,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ** CID 1439136:  Resource leaks  (RESOURCE_LEAK)
</I>&gt;&gt;&gt;<i> /test/dhtest.c: 202 in dh_test()
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ________________________________________________________________________________________________________
</I>&gt;&gt;&gt;<i> *** CID 1439136:  Resource leaks  (RESOURCE_LEAK)
</I>&gt;&gt;&gt;<i> /test/dhtest.c: 202 in dh_test()
</I>&gt;&gt;&gt;<i> 196         BN_free(bp);
</I>&gt;&gt;&gt;<i> 197         BN_free(bg);
</I>&gt;&gt;&gt;<i> 198         BN_free(cpriv_key);
</I>&gt;&gt;&gt;<i> 199         BN_GENCB_free(_cb);
</I>&gt;&gt;&gt;<i> 200         DH_free(dh);
</I>&gt;&gt;&gt;<i> 201
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>     CID 1439136:  Resource leaks  (RESOURCE_LEAK)
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>     Variable &quot;priv_key&quot; going out of scope leaks the storage it points to.
</I>&gt;&gt;&gt;<i> 202         return ret;
</I>&gt;&gt;&gt;<i> 203     }
</I>&gt;&gt;&gt;<i> 204
</I>&gt;&gt;&gt;<i> 205     static int cb(int p, int n, BN_GENCB *arg)
</I>&gt;&gt;&gt;<i> 206     {
</I>&gt;&gt;&gt;<i> 207         return 1;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ** CID 1439135:  Memory - illegal accesses  (INCOMPATIBLE_CAST)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ________________________________________________________________________________________________________
</I>&gt;&gt;&gt;<i> *** CID 1439135:  Memory - illegal accesses  (INCOMPATIBLE_CAST)
</I>&gt;&gt;&gt;<i> /apps/speed.c: 3105 in speed_main()
</I>&gt;&gt;&gt;<i> 3099                 ERR_print_errors(bio_err);
</I>&gt;&gt;&gt;<i> 3100                 rsa_count = 1;
</I>&gt;&gt;&gt;<i> 3101             } else {
</I>&gt;&gt;&gt;<i> 3102                 for (i = 0; i &lt; loopargs_len; i++) {
</I>&gt;&gt;&gt;<i> 3103                     /* Perform EdDSA signature test */
</I>&gt;&gt;&gt;<i> 3104                     loopargs[i].siglen = test_ed_curves[testnum].siglen;
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>     CID 1439135:  Memory - illegal accesses  (INCOMPATIBLE_CAST)
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>     Pointer &quot;&amp;loopargs[i].siglen&quot; points to an object whose effective type is &quot;unsigned int&quot; (32 bits, unsigned) but is dereferenced as a
</I>&gt;&gt;<i> wider &quot;unsigned long&quot; (64 bits, unsigned).  This may lead to memory corruption.
</I>&gt;&gt;&gt;<i> 3105                     st = EVP_DigestSign(loopargs[i].eddsa_ctx[testnum],
</I>&gt;&gt;&gt;<i> 3106                                         loopargs[i].buf2, (size_t *)&amp;loopargs[i].siglen,
</I>&gt;&gt;&gt;<i> 3107                                         loopargs[i].buf, 20);
</I>&gt;&gt;&gt;<i> 3108                     if (st == 0)
</I>&gt;&gt;&gt;<i> 3109                         break;
</I>&gt;&gt;&gt;<i> 3110                 }
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ** CID 1423323:  Null pointer dereferences  (FORWARD_NULL)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ________________________________________________________________________________________________________
</I>&gt;&gt;&gt;<i> *** CID 1423323:  Null pointer dereferences  (FORWARD_NULL)
</I>&gt;&gt;&gt;<i> /test/evp_extra_test.c: 894 in test_EVP_PKEY_check()
</I>&gt;&gt;&gt;<i> 888
</I>&gt;&gt;&gt;<i> 889         if (!TEST_int_eq(EVP_PKEY_param_check(ctx), expected_param_check))
</I>&gt;&gt;&gt;<i> 890             goto done;
</I>&gt;&gt;&gt;<i> 891
</I>&gt;&gt;&gt;<i> 892         ctx2 = EVP_PKEY_CTX_new_id(0xdefaced, NULL);
</I>&gt;&gt;&gt;<i> 893         /* assign the pkey directly, as an internal test */
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>     CID 1423323:  Null pointer dereferences  (FORWARD_NULL)
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>     Passing null pointer &quot;pkey&quot; to &quot;EVP_PKEY_up_ref&quot;, which dereferences it.
</I>&gt;&gt;&gt;<i> 894         EVP_PKEY_up_ref(pkey);
</I>&gt;&gt;&gt;<i> 895         ctx2-&gt;pkey = pkey;
</I>&gt;&gt;&gt;<i> 896
</I>&gt;&gt;&gt;<i> 897         if (!TEST_int_eq(EVP_PKEY_check(ctx2), 0xbeef))
</I>&gt;&gt;&gt;<i> 898             goto done;
</I>&gt;&gt;&gt;<i> 899
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ** CID 1201571:  Error handling issues  (CHECKED_RETURN)
</I>&gt;&gt;&gt;<i> /crypto/pkcs12/p12_init.c: 25 in PKCS12_init()
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ________________________________________________________________________________________________________
</I>&gt;&gt;&gt;<i> *** CID 1201571:  Error handling issues  (CHECKED_RETURN)
</I>&gt;&gt;&gt;<i> /crypto/pkcs12/p12_init.c: 25 in PKCS12_init()
</I>&gt;&gt;&gt;<i> 19         PKCS12 *pkcs12;
</I>&gt;&gt;&gt;<i> 20
</I>&gt;&gt;&gt;<i> 21         if ((pkcs12 = PKCS12_new()) == NULL) {
</I>&gt;&gt;&gt;<i> 22             PKCS12err(PKCS12_F_PKCS12_INIT, ERR_R_MALLOC_FAILURE);
</I>&gt;&gt;&gt;<i> 23             return NULL;
</I>&gt;&gt;&gt;<i> 24         }
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>     CID 1201571:  Error handling issues  (CHECKED_RETURN)
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>     Calling &quot;ASN1_INTEGER_set&quot; without checking return value (as is done elsewhere 30 out of 37 times).
</I>&gt;&gt;&gt;<i> 25         ASN1_INTEGER_set(pkcs12-&gt;version, 3);
</I>&gt;&gt;&gt;<i> 26         pkcs12-&gt;authsafes-&gt;type = OBJ_nid2obj(mode);
</I>&gt;&gt;&gt;<i> 27         switch (mode) {
</I>&gt;&gt;&gt;<i> 28         case NID_pkcs7_data:
</I>&gt;&gt;&gt;<i> 29             if ((pkcs12-&gt;authsafes-&gt;d.data = ASN1_OCTET_STRING_new()) == NULL) {
</I>&gt;&gt;&gt;<i> 30                 PKCS12err(PKCS12_F_PKCS12_INIT, ERR_R_MALLOC_FAILURE);
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ________________________________________________________________________________________________________
</I>&gt;&gt;&gt;<i> To view the defects in Coverity Scan visit, <A HREF="https://u2389337.ct.sendgrid.net/wf/click?upn=08onrYu34A-2BWcWUl-2F-">https://u2389337.ct.sendgrid.net/wf/click?upn=08onrYu34A-2BWcWUl-2F-</A>
</I>&gt;&gt;<i> 2BfV0V05UPxvVjWch-2Bd2MGckcRakUl6QyjujEohY7rPpoYUE4H-2Fm-2BeoDOl8jw7bf4Z78hw-3D-3D_bpOft2V4l9NXEcTx5CnNFJqpP-
</I>&gt;&gt;<i> 2F8a09dz6vsuNilvAJgBy9hWgnGhTAFGZnkvhcJuSQocoiCV36Dw66FwvViDOF-2BGQbzbMH8LM1tsnputryXt7SEgZZ-
</I>&gt;&gt;<i> 2FmpoWsuVr91UzOFBmmlL0bipzCjL7WfoT7QvLLnFuGxTjboshY44ftCBEhW8TAZR-2B1c1y7JdbYkdSXw-2B7Vmts-2F-
</I>&gt;&gt;<i> 2BitkvIjISgebBlgXuThX1DnzutpYSf00XD0-3D
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>   To manage Coverity Scan email notifications for &quot;<A HREF="../../../mailman/listinfo/openssl-project.html">kaduk-github at mit.edu</A>&quot;, click
</I>&gt;&gt;<i> <A HREF="https://u2389337.ct.sendgrid.net/wf/click?upn=08onrYu34A-2BWcWUl-2F-2BfV0V05UPxvVjWch-2Bd2MGckcRbVDbis712qZDP-">https://u2389337.ct.sendgrid.net/wf/click?upn=08onrYu34A-2BWcWUl-2F-2BfV0V05UPxvVjWch-2Bd2MGckcRbVDbis712qZDP-</A>
</I>&gt;&gt;<i> 2FA8y06Nq414hC6p-2BsqBEViFMJYotwSt4SYNeSzd6tPCdCHgDzpHIBW-2Fr0I0sQJCop-2Fx5Lu2ueYFxYqLmFh7APZbTTED-
</I>&gt;&gt;<i> 2B53KXZ2qVo0Y2q2bUC-2BpL2TzE-3D_bpOft2V4l9NXEcTx5CnNFJqpP-2F8a09dz6vsuNilvAJgBy9hWgnGhTAFGZnkvhcJu7xxYKPr1HkiPh-
</I>&gt;&gt;<i> 2BL3MaUbhQMZae3MPjv9c6bU6U4uhOZEhiS1P-2BwpukQ4-2BcSzk5FouA75ij0odEEgZcWTB05BKimz0wg0Y8JsC1Izz20-
</I>&gt;&gt;<i> 2FpfRp2kjWD47vvs4NmxuDPkNqvS3qoLRQ0vIXW8CFF339G-2B7jGolZ214Wxo3Gh6Hc0HY-3D
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> openssl-project mailing list
</I>&gt;&gt;<i> <A HREF="../../../mailman/listinfo/openssl-project.html">openssl-project at openssl.org</A>
</I>&gt;&gt;<i> <A HREF="../../../mailman/listinfo/openssl-project.html">https://mta.openssl.org/mailman/listinfo/openssl-project</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> openssl-project mailing list
</I>&gt;<i> <A HREF="../../../mailman/listinfo/openssl-project.html">openssl-project at openssl.org</A>
</I>&gt;<i> <A HREF="../../../mailman/listinfo/openssl-project.html">https://mta.openssl.org/mailman/listinfo/openssl-project</A>
</I>&gt;<i> 
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001037.html">[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
</A></li>
	<LI>Next message: <A HREF="001042.html">[openssl-project] coverity defect release criteria (Fwd: New Defects reported by Coverity Scan for openssl/openssl)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1039">[ date ]</a>
              <a href="thread.html#1039">[ thread ]</a>
              <a href="subject.html#1039">[ subject ]</a>
              <a href="author.html#1039">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-project.html">More information about the openssl-project
mailing list</a><br>
</body></html>
