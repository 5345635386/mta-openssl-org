<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Timestamp validation checks critical flag on EKU
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2022-January/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Timestamp%20validation%20checks%20critical%20flag%20on%20EKU&In-Reply-To=%3C0832AA25-049C-4243-B9A1-FC75D6F6626C%40vigilsec.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014828.html">
   <LINK REL="Next"  HREF="014831.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Timestamp validation checks critical flag on EKU</H1>
    <B>Russ Housley</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Timestamp%20validation%20checks%20critical%20flag%20on%20EKU&In-Reply-To=%3C0832AA25-049C-4243-B9A1-FC75D6F6626C%40vigilsec.com%3E"
       TITLE="Timestamp validation checks critical flag on EKU">housley at vigilsec.com
       </A><BR>
    <I>Fri Jan 28 12:58:13 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014828.html">Timestamp validation checks critical flag on EKU
</A></li>
        <LI>Next message (by thread): <A HREF="014831.html">Timestamp validation checks critical flag on EKU
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14829">[ date ]</a>
              <a href="thread.html#14829">[ thread ]</a>
              <a href="subject.html#14829">[ subject ]</a>
              <a href="author.html#14829">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>RFC 3161 says:

2.3. Identification of the TSA

   The TSA MUST sign each time-stamp message with a key reserved
   specifically for that purpose.  A TSA MAY have distinct private keys,
   e.g., to accommodate different policies, different algorithms,
   different private key sizes or to increase the performance.  The
   corresponding certificate MUST contain only one instance of the
   extended key usage field extension as defined in [RFC2459] Section
   4.2.1.13 with KeyPurposeID having value:

   id-kp-timeStamping.  This extension MUST be critical.

   The following object identifier identifies the KeyPurposeID having
   value id-kp-timeStamping.

   id-kp-timeStamping OBJECT IDENTIFIER ::= {iso(1)
                   identified-organization(3) dod(6)
                   internet(1) security(5) mechanisms(5) pkix(7)
                   kp (3) timestamping (8)}


&gt;<i> On Jan 28, 2022, at 6:25 AM, <A HREF="../../../mailman/listinfo/openssl-users.html">weber at infotech.de</A> wrote:
</I>&gt;<i> 
</I>&gt;<i> Dear OpenSSL users,
</I>&gt;<i> 
</I>&gt;<i> recently we checked an older timestamp using the OpenSSL Library version 1.1.1i.
</I>&gt;<i> The check revealed, that the timestamp verification failed.
</I>&gt;<i> 
</I>&gt;<i> Digging into the code we found that if an eku entry for timestamping is preset
</I>&gt;<i> it is expected to be marked critical (see v3_purp.c:798 ff.).
</I>&gt;<i> 
</I>&gt;<i> Thats's not the case for the timetamp cert in use.
</I>&gt;<i> 
</I>&gt;<i> We couldn'f find any source that enforces the critical flag on eku timestamp entries.
</I>&gt;<i> RFC 5280 says, that makring the EKU as critical is deliberate tu the issuer.
</I>&gt;<i> 
</I>&gt;<i> Any thoughts or pointer to the mentioned requirement?
</I>&gt;<i> 
</I>&gt;<i> Thanks in advance
</I>&gt;<i> --
</I>&gt;<i> Christian Weber
</I>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014828.html">Timestamp validation checks critical flag on EKU
</A></li>
	<LI>Next message (by thread): <A HREF="014831.html">Timestamp validation checks critical flag on EKU
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14829">[ date ]</a>
              <a href="thread.html#14829">[ thread ]</a>
              <a href="subject.html#14829">[ subject ]</a>
              <a href="author.html#14829">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
