<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [SOLVED] Re: OpenSSL 3.0 hangs at exit with FIPS provider
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2020-July/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5BSOLVED%5D%20Re%3A%20OpenSSL%203.0%20hangs%20at%20exit%20with%20FIPS%20provider&In-Reply-To=%3CCADqc48R%2BVmy45tG9CZgzJYncghMOXeKatZ%3DMhQw0E8VzBBjmTQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012771.html">
   <LINK REL="Next"  HREF="012770.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[SOLVED] Re: OpenSSL 3.0 hangs at exit with FIPS provider</H1>
    <B>Thomas Dwyer III</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5BSOLVED%5D%20Re%3A%20OpenSSL%203.0%20hangs%20at%20exit%20with%20FIPS%20provider&In-Reply-To=%3CCADqc48R%2BVmy45tG9CZgzJYncghMOXeKatZ%3DMhQw0E8VzBBjmTQ%40mail.gmail.com%3E"
       TITLE="[SOLVED] Re: OpenSSL 3.0 hangs at exit with FIPS provider">tomiii at tomiii.com
       </A><BR>
    <I>Mon Jul 20 17:47:57 UTC 2020</I>
    <P><UL>
        <LI>Previous message: <A HREF="012771.html">[SOLVED] Re: OpenSSL 3.0 hangs at exit with FIPS provider
</A></li>
        <LI>Next message: <A HREF="012770.html">build error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12775">[ date ]</a>
              <a href="thread.html#12775">[ thread ]</a>
              <a href="subject.html#12775">[ subject ]</a>
              <a href="author.html#12775">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I just created <A HREF="https://github.com/openssl/openssl/issues/12496">https://github.com/openssl/openssl/issues/12496</A> for this.


Regards,
Tom.III


On Sat, Jul 18, 2020 at 1:06 AM Dr. Matthias St. Pierre &lt;
<A HREF="../../../mailman/listinfo/openssl-users.html">Matthias.St.Pierre at ncp-e.com</A>&gt; wrote:

&gt;<i> Thomas,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; I consider this a bug, of course, but at least now I know what's causing
</I>&gt;<i> it and how to work around it.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> thanks for sharing your analysis. Would you mind creating a GitHub issue
</I>&gt;<i> for the hang?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://github.com/openssl/openssl/issues">https://github.com/openssl/openssl/issues</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Matthias
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *[image: NCP engingeering GmbH]* *Dr. Matthias St. Pierre*
</I>&gt;<i>
</I>&gt;<i> Senior Software Engineer
</I>&gt;<i> <A HREF="../../../mailman/listinfo/openssl-users.html">matthias.st.pierre at ncp-e.com</A>
</I>&gt;<i> Phone: +49 911 9968-0
</I>&gt;<i> www.ncp-e.com
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> * Follow us on:* Facebook &lt;<A HREF="https://www.facebook.com/NCPengineering">https://www.facebook.com/NCPengineering</A>&gt; |
</I>&gt;<i> Twitter &lt;<A HREF="https://twitter.com/NCP_engineering">https://twitter.com/NCP_engineering</A>&gt; | Xing
</I>&gt;<i> &lt;<A HREF="https://www.xing.com/companies/ncpengineeringgmbh">https://www.xing.com/companies/ncpengineeringgmbh</A>&gt; | YouTube
</I>&gt;<i> &lt;<A HREF="https://www.youtube.com/user/NCPengineeringGmbH">https://www.youtube.com/user/NCPengineeringGmbH</A>&gt; | LinkedIn
</I>&gt;<i> &lt;<A HREF="http://www.linkedin.com/company/ncp-engineering-inc.?trk=cws-cpw-coname-0-0">http://www.linkedin.com/company/ncp-engineering-inc.?trk=cws-cpw-coname-0-0</A>&gt;
</I>&gt;<i>
</I>&gt;<i> *Headquarters Germany: *NCP engineering GmbH &#8226; Dombuehler Str. 2 &#8226; 90449
</I>&gt;<i> &#8226; Nuremberg
</I>&gt;<i> *North American HQ:* NCP engineering Inc. &#8226; 601 Cleveland Str., Suite
</I>&gt;<i> 501-25 &#8226; Clearwater, FL 33755
</I>&gt;<i>
</I>&gt;<i> Authorized representatives: Peter Soell, Patrick Oliver Graf, Beate
</I>&gt;<i> Dietrich
</I>&gt;<i> Registry Court: Lower District Court of Nuremberg
</I>&gt;<i> Commercial register No.: HRB 7786 Nuremberg, VAT identification No.: DE
</I>&gt;<i> 133557619
</I>&gt;<i>
</I>&gt;<i> This e-mail message including any attachments is for the sole use of the
</I>&gt;<i> intended recipient(s) and may contain privileged or confidential
</I>&gt;<i> information. Any unauthorized review, use, disclosure or distribution is
</I>&gt;<i> prohibited. If you are not the intended recipient, please immediately
</I>&gt;<i> contact the sender by reply e-mail and delete the original message and
</I>&gt;<i> destroy all copies thereof.
</I>&gt;<i>
</I>&gt;<i> &lt;<A HREF="https://www.ncp-e.com/de/aktuelles/events/veranstaltungen">https://www.ncp-e.com/de/aktuelles/events/veranstaltungen</A>&gt;
</I>&gt;<i> &lt;<A HREF="https://www.ncp-e.com/de/aktuelles/events/veranstaltungen">https://www.ncp-e.com/de/aktuelles/events/veranstaltungen</A>&gt;
</I>&gt;<i>
</I>&gt;<i> *From:* openssl-users &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>&gt; *On Behalf Of *Thomas
</I>&gt;<i> Dwyer III
</I>&gt;<i> *Sent:* Friday, July 17, 2020 6:57 PM
</I>&gt;<i> *To:* openssl-users &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>&gt;
</I>&gt;<i> *Subject:* [SOLVED] Re: OpenSSL 3.0 hangs at exit with FIPS provider
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> It turns out the problem was caused by a misinterpretation of the phrase
</I>&gt;<i> &quot;add the following lines near the beginning&quot; in section 7.1 of the
</I>&gt;<i> documentation at <A HREF="https://wiki.openssl.org/index.php/OpenSSL_3.0">https://wiki.openssl.org/index.php/OpenSSL_3.0</A> for
</I>&gt;<i> enabling FIPS support. I added these lines to the very top of the file:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> openssl_conf = openssl_init
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> .include /usr/local/ssl/fipsmodule.cnf
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [openssl_init]
</I>&gt;<i>
</I>&gt;<i> providers = provider_sect
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [provider_sect]
</I>&gt;<i>
</I>&gt;<i> fips = fips_sect
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This caused the existing default section to now become part of the
</I>&gt;<i> [provider_sect] section. Apparently any name=value line in that particular
</I>&gt;<i> section where no [value] section exists causes OpenSSL to hang at exit when
</I>&gt;<i> the FIPS provider is used. I consider this a bug, of course, but at least
</I>&gt;<i> now I know what's causing it and how to work around it.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Regarding how to confirm which provider is actually providing a given
</I>&gt;<i> algorithm, I found that EVP_MD_provider() returns NULL for any EVP_MD
</I>&gt;<i> obtained via EVP_get_digestbyname() (even after it's used successfully by
</I>&gt;<i> EVP_DigestInit_ex()) but it returns a valid OSSL_PROVIDER for any EVP_MD
</I>&gt;<i> obtained via EVP_MD_fetch(). Is this intentional?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Tom.III
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://mta.openssl.org/pipermail/openssl-users/attachments/20200720/208c8a32/attachment.html">https://mta.openssl.org/pipermail/openssl-users/attachments/20200720/208c8a32/attachment.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: NCP_logo_2f45208a-c14d-4000-bcd3-1ab400c0e48c.gif
Type: image/gif
Size: 2815 bytes
Desc: not available
URL: &lt;<A HREF="https://mta.openssl.org/pipermail/openssl-users/attachments/20200720/208c8a32/attachment.gif">https://mta.openssl.org/pipermail/openssl-users/attachments/20200720/208c8a32/attachment.gif</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012771.html">[SOLVED] Re: OpenSSL 3.0 hangs at exit with FIPS provider
</A></li>
	<LI>Next message: <A HREF="012770.html">build error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12775">[ date ]</a>
              <a href="thread.html#12775">[ thread ]</a>
              <a href="subject.html#12775">[ subject ]</a>
              <a href="author.html#12775">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
