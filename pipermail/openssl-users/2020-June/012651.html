<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Error building OpenSSL-1.1.1g
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2020-June/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Error%20building%20OpenSSL-1.1.1g&In-Reply-To=%3C00bc01d64bbd%247cf520f0%2476df62d0%24%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012646.html">
   <LINK REL="Next"  HREF="012652.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Error building OpenSSL-1.1.1g</H1>
    <B>mhkelley2017 at gmail.com</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Error%20building%20OpenSSL-1.1.1g&In-Reply-To=%3C00bc01d64bbd%247cf520f0%2476df62d0%24%40gmail.com%3E"
       TITLE="Error building OpenSSL-1.1.1g">mhkelley2017 at gmail.com
       </A><BR>
    <I>Fri Jun 26 13:27:06 UTC 2020</I>
    <P><UL>
        <LI>Previous message: <A HREF="012646.html">Error building OpenSSL-1.1.1g
</A></li>
        <LI>Next message: <A HREF="012652.html">Error building OpenSSL-1.1.1g
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12651">[ date ]</a>
              <a href="thread.html#12651">[ thread ]</a>
              <a href="subject.html#12651">[ subject ]</a>
              <a href="author.html#12651">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matt,

Thanks for your suggestion ...

&gt;&gt;<i> 
</I>&gt;&gt;<i> 2. Has anyone succeeded building OpenSSL for use in a Windows
</I>&gt;&gt;<i> 10 environment *without* need for visual studio?
</I>&gt;<i>
</I>&gt;<i> You can do this using the MinGW compilers and the MSys2 shell. Note the
</I>&gt;<i> MinGW compilers target *native* windows. So although you use Msys2 to
</I>&gt;<i> build it, the resulting binaries are fully native.
</I>
That was one of the first things I tried.  After exploring a few rabbit holes, I gave up and downloaded Visual Studio..

Here is how far I got  I have been unable to even figure out where this error comes from ...

----------------------------------------------------------------------------------
$ where perl
C:\Perl64\bin\perl.exe
$ perl Configure mingw --prefix=$PREFIX
******************************************************************************
This perl implementation doesn't produce Unix like paths (with forward slash
directory separators).  Please use an implementation that matches your
building platform.

This Perl version: 5.24.3 for MSWin32-x64-multi-thread
******************************************************************************
Configuring OpenSSL version 1.1.1g (0x1010107fL) for mingw
Using os-specific seed configuration
----------------------------------------------------------------------------------


-----Original Message-----
From: openssl-users &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>&gt; On Behalf Of Matt Caswell
Sent: Friday, June 26, 2020 3:04 AM
To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
Subject: Re: Error building OpenSSL-1.1.1g



On 26/06/2020 00:47, <A HREF="../../../mailman/listinfo/openssl-users.html">mhkelley2017 at gmail.com</A> wrote:
&gt;<i> 1. How do I figure out whether OpenSSL is trying to build the 32- or 64-bit version and which options, or environmental variables, or specific PATH elements do I need to pay attention to in order to accomplish that?
</I>
My windows environment died on my recently, so I can't check the actual
output. IIRC just typing &quot;cl&quot; at the command line should give you
details about the compiler being used and whether it is for 32 or 64 bits.

Visual Studio has a number of &quot;developer command prompts&quot; available with
it. If you start one of those it should have all the right environment
variables set up for you. There should be different command prompts for
32 bit vs 64 bit.

<A HREF="https://docs.microsoft.com/en-us/dotnet/framework/tools/developer-command-prompt-for-vs">https://docs.microsoft.com/en-us/dotnet/framework/tools/developer-command-prompt-for-vs</A>

Alternatively there is the vcvarsall.bat script which comes with VS that
enables you to setup all the environment variables - you can specify as
an argument to script whether you are targeting 32 bit or 64 bit.

<A HREF="https://stackoverflow.com/questions/43372235/vcvarsall-bat-for-visual-studio-2017">https://stackoverflow.com/questions/43372235/vcvarsall-bat-for-visual-studio-2017</A>

As well as the VS tools environment variables you will need to make sure
both Perl (e.g. Strawberry Perl) and NASM are installed and are on your
%PATH%.


&gt;<i> 
</I>&gt;<i> 2. Has anyone succeeded building OpenSSL for use in a Windows 10 environment *without* need for visual studio?
</I>
You can do this using the MinGW compilers and the MSys2 shell. Note the
MinGW compilers target *native* windows. So although you use Msys2 to
build it, the resulting binaries are fully native.


There are details in the newly rewritten instructions for Windows:

<A HREF="https://github.com/openssl/openssl/blob/OpenSSL_1_1_1-stable/NOTES.WIN">https://github.com/openssl/openssl/blob/OpenSSL_1_1_1-stable/NOTES.WIN</A>

Matt


&gt;<i> 
</I>&gt;<i> I'd really appreciate any useful information or pointers to such.
</I>&gt;<i> 
</I>&gt;<i> Thanks. 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: openssl-users &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>&gt; On Behalf Of Matt Caswell
</I>&gt;<i> Sent: Thursday, June 25, 2020 2:03 PM
</I>&gt;<i> To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
</I>&gt;<i> Subject: Re: Error building OpenSSL-1.1.1g
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On 25/06/2020 20:20, <A HREF="../../../mailman/listinfo/openssl-users.html">mhkelley2017 at gmail.com</A> wrote:
</I>&gt;&gt;<i> Thanks! That helped, but I have two follow-ups.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1) To whom would I suggest minor changes to the available installation
</I>&gt;&gt;<i> instructions to help avoid future such misunderstandings?
</I>&gt;<i> 
</I>&gt;<i> You can raise on issue on Github. Or even better raise a PR with your
</I>&gt;<i> suggested changes. However, as it so happens the Windows instructions
</I>&gt;<i> have very recently been significantly updated - so some of your
</I>&gt;<i> suggestions may already have been included:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://github.com/openssl/openssl/pull/12098">https://github.com/openssl/openssl/pull/12098</A>
</I>&gt;<i> 
</I>&gt;&gt;<i> crypto\aes\aesni-mb-x86_64.obj : fatal error LNK1112: module machine type
</I>&gt;&gt;<i> 'x64' conflicts with target machine type 'x86'
</I>&gt;<i> 
</I>&gt;<i> This usually occurs when attempting to build 64-bit OpenSSL using the
</I>&gt;<i> 32-bit VisualStudio tools.
</I>&gt;<i> 
</I>&gt;<i> Matt
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> Could Not Find
</I>&gt;&gt;<i> c:\Users\Owner\LocalPrograms\OpenSSL\openssl-1.1.1g\libcrypto-1_1-x64.*
</I>&gt;&gt;<i> NMAKE : fatal error U1077: 'link' : return code '0x1'
</I>&gt;&gt;<i> Stop.
</I>&gt;&gt;<i> NMAKE : fatal error U1077: '&quot;C:\Program Files (x86)\Microsoft Visual
</I>&gt;&gt;<i> Studio\2019\Community\VC\Tools\MSVC\14.26.28801\bin\HostX86\x86\nmake.exe&quot;'
</I>&gt;&gt;<i> : return code '0x2'
</I>&gt;&gt;<i> Stop.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;<i> From: openssl-users &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>&gt; On Behalf Of Matt
</I>&gt;&gt;<i> Caswell
</I>&gt;&gt;<i> Sent: Thursday, June 25, 2020 12:15 PM
</I>&gt;&gt;<i> To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
</I>&gt;&gt;<i> Subject: Re: Error building OpenSSL-1.1.1g
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 25/06/2020 18:32, Michael Wojcik wrote:
</I>&gt;&gt;&gt;&gt;<i> From: openssl-users [mailto:<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>] On Behalf
</I>&gt;&gt;<i> Of <A HREF="../../../mailman/listinfo/openssl-users.html">mhkelley2017 at gmail.com</A>
</I>&gt;&gt;&gt;&gt;<i> Sent: Thursday, June 25, 2020 11:54
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Error:  'ml64' is not recognized as an internal or external command,
</I>&gt;&gt;&gt;&gt;<i> operable program or batch file.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> It's part of Visual C. The VC-WIN64A-masm configuration
</I>&gt;&gt;<i> (Configurations/50-masm.conf) specifies it as the assembler.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Note that using masm to compile OpenSSL is no longer supported by us
</I>&gt;&gt;<i> (although it might still work).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Preferred is to use the VC-WIN64A target and the nasm compiler.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you use the Developer Studio command prompt (64-bit) it should have
</I>&gt;&gt;<i> all the environment variables set up already to find the various VS tools.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Matt
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Building with Visual Studio  2019 Community
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Maybe VS2019 Community doesn't include the assembler? I haven't looked. Or
</I>&gt;&gt;<i> maybe it's part of some optional component?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> In VS2017 Professional, which is what I have configured at the moment on
</I>&gt;&gt;<i> this machine, it's in .../VC/Tools/MSVC/14.16.27023/bin/HostX86/x64, thanks
</I>&gt;&gt;<i> to VS's gratuitously complicated directory layout.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;<i> Michael Wojcik
</I>&gt;&gt;&gt;<i> Distinguished Engineer, Micro Focus
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012646.html">Error building OpenSSL-1.1.1g
</A></li>
	<LI>Next message: <A HREF="012652.html">Error building OpenSSL-1.1.1g
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12651">[ date ]</a>
              <a href="thread.html#12651">[ thread ]</a>
              <a href="subject.html#12651">[ subject ]</a>
              <a href="author.html#12651">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
