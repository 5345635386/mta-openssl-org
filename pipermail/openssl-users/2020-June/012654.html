<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Error building OpenSSL-1.1.1g
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2020-June/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Error%20building%20OpenSSL-1.1.1g&In-Reply-To=%3C00d801d64bca%2442b3b980%24c81b2c80%24%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012652.html">
   <LINK REL="Next"  HREF="012655.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Error building OpenSSL-1.1.1g</H1>
    <B>mhkelley2017 at gmail.com</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Error%20building%20OpenSSL-1.1.1g&In-Reply-To=%3C00d801d64bca%2442b3b980%24c81b2c80%24%40gmail.com%3E"
       TITLE="Error building OpenSSL-1.1.1g">mhkelley2017 at gmail.com
       </A><BR>
    <I>Fri Jun 26 14:58:32 UTC 2020</I>
    <P><UL>
        <LI>Previous message: <A HREF="012652.html">Error building OpenSSL-1.1.1g
</A></li>
        <LI>Next message: <A HREF="012655.html">Error building OpenSSL-1.1.1g
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12654">[ date ]</a>
              <a href="thread.html#12654">[ thread ]</a>
              <a href="subject.html#12654">[ subject ]</a>
              <a href="author.html#12654">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matt,

I fear I my wear out my welcome before I manage to get a working OpenSSL ...

&gt;<i> Make sure msys2 has the perl package installed and remove
</I>&gt;<i> this one from your path.
</I>
OK, I'll bite.

As near as I can tell, this suggestion means one of two things.

1) use one of the &quot;completion&quot;  functions named &quot;perl&quot; that apparently came with the original MSYS2 installation (both in folder msys64\usr\share\bash-completion\completions).  Since neither seemed to do anything useful here, I presume you mean

2) install a perl package from MSYS2 for use with MSYS2.  If this is what you meant, I still have two apparently relevant choices.

a) mingw-w64-perl
b) perl (seems specific to Cygwin and Linux)

The former gives me the same error as ActivePerl
The latter seems to be just ignored.

I'm clearly missing something, but must be too dense to figure out what.

Mike

-----Original Message-----
From: openssl-users &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>&gt; On Behalf Of Matt Caswell
Sent: Friday, June 26, 2020 7:31 AM
To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
Subject: Re: Error building OpenSSL-1.1.1g



On 26/06/2020 14:27, <A HREF="../../../mailman/listinfo/openssl-users.html">mhkelley2017 at gmail.com</A> wrote:
&gt;<i> Matt,
</I>&gt;<i> 
</I>&gt;<i> Thanks for your suggestion ...
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 2. Has anyone succeeded building OpenSSL for use in a Windows
</I>&gt;&gt;&gt;<i> 10 environment *without* need for visual studio?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You can do this using the MinGW compilers and the MSys2 shell. Note the
</I>&gt;&gt;<i> MinGW compilers target *native* windows. So although you use Msys2 to
</I>&gt;&gt;<i> build it, the resulting binaries are fully native.
</I>&gt;<i> 
</I>&gt;<i> That was one of the first things I tried.  After exploring a few rabbit holes, I gave up and downloaded Visual Studio..
</I>&gt;<i> 
</I>&gt;<i> Here is how far I got  I have been unable to even figure out where this error comes from ...
</I>&gt;<i> 
</I>&gt;<i> ----------------------------------------------------------------------------------
</I>&gt;<i> $ where perl
</I>&gt;<i> C:\Perl64\bin\perl.exe
</I>&gt;<i> $ perl Configure mingw --prefix=$PREFIX
</I>&gt;<i> ******************************************************************************
</I>&gt;<i> This perl implementation doesn't produce Unix like paths (with forward slash
</I>&gt;<i> directory separators).  Please use an implementation that matches your
</I>&gt;<i> building platform.
</I>&gt;<i> 
</I>&gt;<i> This Perl version: 5.24.3 for MSWin32-x64-multi-thread
</I>&gt;<i> ******************************************************************************
</I>
For msys2 based builds you must use the msys2 provided perl version, not
a native perl. Make sure msys2 has the perl package installed and remove
this one from your path.

Maybe we should add an FAQ section of common faults and how to fix them.

Matt




&gt;<i> Configuring OpenSSL version 1.1.1g (0x1010107fL) for mingw
</I>&gt;<i> Using os-specific seed configuration
</I>&gt;<i> ----------------------------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: openssl-users &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>&gt; On Behalf Of Matt Caswell
</I>&gt;<i> Sent: Friday, June 26, 2020 3:04 AM
</I>&gt;<i> To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
</I>&gt;<i> Subject: Re: Error building OpenSSL-1.1.1g
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On 26/06/2020 00:47, <A HREF="../../../mailman/listinfo/openssl-users.html">mhkelley2017 at gmail.com</A> wrote:
</I>&gt;&gt;<i> 1. How do I figure out whether OpenSSL is trying to build the 32- or 64-bit version and which options, or environmental variables, or specific PATH elements do I need to pay attention to in order to accomplish that?
</I>&gt;<i> 
</I>&gt;<i> My windows environment died on my recently, so I can't check the actual
</I>&gt;<i> output. IIRC just typing &quot;cl&quot; at the command line should give you
</I>&gt;<i> details about the compiler being used and whether it is for 32 or 64 bits.
</I>&gt;<i> 
</I>&gt;<i> Visual Studio has a number of &quot;developer command prompts&quot; available with
</I>&gt;<i> it. If you start one of those it should have all the right environment
</I>&gt;<i> variables set up for you. There should be different command prompts for
</I>&gt;<i> 32 bit vs 64 bit.
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://docs.microsoft.com/en-us/dotnet/framework/tools/developer-command-prompt-for-vs">https://docs.microsoft.com/en-us/dotnet/framework/tools/developer-command-prompt-for-vs</A>
</I>&gt;<i> 
</I>&gt;<i> Alternatively there is the vcvarsall.bat script which comes with VS that
</I>&gt;<i> enables you to setup all the environment variables - you can specify as
</I>&gt;<i> an argument to script whether you are targeting 32 bit or 64 bit.
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://stackoverflow.com/questions/43372235/vcvarsall-bat-for-visual-studio-2017">https://stackoverflow.com/questions/43372235/vcvarsall-bat-for-visual-studio-2017</A>
</I>&gt;<i> 
</I>&gt;<i> As well as the VS tools environment variables you will need to make sure
</I>&gt;<i> both Perl (e.g. Strawberry Perl) and NASM are installed and are on your
</I>&gt;<i> %PATH%.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2. Has anyone succeeded building OpenSSL for use in a Windows 10 environment *without* need for visual studio?
</I>&gt;<i> 
</I>&gt;<i> You can do this using the MinGW compilers and the MSys2 shell. Note the
</I>&gt;<i> MinGW compilers target *native* windows. So although you use Msys2 to
</I>&gt;<i> build it, the resulting binaries are fully native.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> There are details in the newly rewritten instructions for Windows:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://github.com/openssl/openssl/blob/OpenSSL_1_1_1-stable/NOTES.WIN">https://github.com/openssl/openssl/blob/OpenSSL_1_1_1-stable/NOTES.WIN</A>
</I>&gt;<i> 
</I>&gt;<i> Matt
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'd really appreciate any useful information or pointers to such.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks. 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;<i> From: openssl-users &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>&gt; On Behalf Of Matt Caswell
</I>&gt;&gt;<i> Sent: Thursday, June 25, 2020 2:03 PM
</I>&gt;&gt;<i> To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
</I>&gt;&gt;<i> Subject: Re: Error building OpenSSL-1.1.1g
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 25/06/2020 20:20, <A HREF="../../../mailman/listinfo/openssl-users.html">mhkelley2017 at gmail.com</A> wrote:
</I>&gt;&gt;&gt;<i> Thanks! That helped, but I have two follow-ups.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 1) To whom would I suggest minor changes to the available installation
</I>&gt;&gt;&gt;<i> instructions to help avoid future such misunderstandings?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You can raise on issue on Github. Or even better raise a PR with your
</I>&gt;&gt;<i> suggested changes. However, as it so happens the Windows instructions
</I>&gt;&gt;<i> have very recently been significantly updated - so some of your
</I>&gt;&gt;<i> suggestions may already have been included:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="https://github.com/openssl/openssl/pull/12098">https://github.com/openssl/openssl/pull/12098</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> crypto\aes\aesni-mb-x86_64.obj : fatal error LNK1112: module machine type
</I>&gt;&gt;&gt;<i> 'x64' conflicts with target machine type 'x86'
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This usually occurs when attempting to build 64-bit OpenSSL using the
</I>&gt;&gt;<i> 32-bit VisualStudio tools.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Matt
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Could Not Find
</I>&gt;&gt;&gt;<i> c:\Users\Owner\LocalPrograms\OpenSSL\openssl-1.1.1g\libcrypto-1_1-x64.*
</I>&gt;&gt;&gt;<i> NMAKE : fatal error U1077: 'link' : return code '0x1'
</I>&gt;&gt;&gt;<i> Stop.
</I>&gt;&gt;&gt;<i> NMAKE : fatal error U1077: '&quot;C:\Program Files (x86)\Microsoft Visual
</I>&gt;&gt;&gt;<i> Studio\2019\Community\VC\Tools\MSVC\14.26.28801\bin\HostX86\x86\nmake.exe&quot;'
</I>&gt;&gt;&gt;<i> : return code '0x2'
</I>&gt;&gt;&gt;<i> Stop.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;&gt;<i> From: openssl-users &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>&gt; On Behalf Of Matt
</I>&gt;&gt;&gt;<i> Caswell
</I>&gt;&gt;&gt;<i> Sent: Thursday, June 25, 2020 12:15 PM
</I>&gt;&gt;&gt;<i> To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
</I>&gt;&gt;&gt;<i> Subject: Re: Error building OpenSSL-1.1.1g
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 25/06/2020 18:32, Michael Wojcik wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i> From: openssl-users [mailto:<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>] On Behalf
</I>&gt;&gt;&gt;<i> Of <A HREF="../../../mailman/listinfo/openssl-users.html">mhkelley2017 at gmail.com</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> Sent: Thursday, June 25, 2020 11:54
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Error:  'ml64' is not recognized as an internal or external command,
</I>&gt;&gt;&gt;&gt;&gt;<i> operable program or batch file.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> It's part of Visual C. The VC-WIN64A-masm configuration
</I>&gt;&gt;&gt;<i> (Configurations/50-masm.conf) specifies it as the assembler.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Note that using masm to compile OpenSSL is no longer supported by us
</I>&gt;&gt;&gt;<i> (although it might still work).
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Preferred is to use the VC-WIN64A target and the nasm compiler.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> If you use the Developer Studio command prompt (64-bit) it should have
</I>&gt;&gt;&gt;<i> all the environment variables set up already to find the various VS tools.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Matt
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Building with Visual Studio  2019 Community
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Maybe VS2019 Community doesn't include the assembler? I haven't looked. Or
</I>&gt;&gt;&gt;<i> maybe it's part of some optional component?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> In VS2017 Professional, which is what I have configured at the moment on
</I>&gt;&gt;&gt;<i> this machine, it's in .../VC/Tools/MSVC/14.16.27023/bin/HostX86/x64, thanks
</I>&gt;&gt;&gt;<i> to VS's gratuitously complicated directory layout.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;&gt;<i> Michael Wojcik
</I>&gt;&gt;&gt;&gt;<i> Distinguished Engineer, Micro Focus
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012652.html">Error building OpenSSL-1.1.1g
</A></li>
	<LI>Next message: <A HREF="012655.html">Error building OpenSSL-1.1.1g
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12654">[ date ]</a>
              <a href="thread.html#12654">[ thread ]</a>
              <a href="subject.html#12654">[ subject ]</a>
              <a href="author.html#12654">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
