<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] decrypt error
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2019-January/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20decrypt%20error&In-Reply-To=%3CA0075AC8F849D648B8077B454DA0D87E2CD3A03C%40ES-2010.francotyp.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009780.html">
   <LINK REL="Next"  HREF="009768.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] decrypt error</H1>
    <B>Scharfenberg, Carsten</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20decrypt%20error&In-Reply-To=%3CA0075AC8F849D648B8077B454DA0D87E2CD3A03C%40ES-2010.francotyp.com%3E"
       TITLE="[openssl-users] decrypt error">c.scharfenberg at francotyp.com
       </A><BR>
    <I>Thu Jan 24 09:19:03 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="009780.html">[openssl-users] SSL_read() returns -1, and SSL_read_ex does not update readbytes where a record containing a session ticket is being read (TLS 1.3)
</A></li>
        <LI>Next message: <A HREF="009768.html">[openssl-users] decrypt error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9767">[ date ]</a>
              <a href="thread.html#9767">[ thread ]</a>
              <a href="subject.html#9767">[ subject ]</a>
              <a href="author.html#9767">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello everybody,

I've just joined this group because I hope you guys can help me with my problem.

I'm using haproxy 1.8.17 and openssl 1.1.1a from Debian testing to serve TLS 1.2 connections with client authentication.
The TLS handshake runs through fine. But then the server answers with a Decrypt Error Alert to the Finish message sent by the client.
How would I debug this error?
Is it possible that something is wrong with my certificates?

I've had a look into the source code. Unfortunately it's not so easy to read. It seems to me the alert is generated here:
ssl\statem\statem_lib.c:809 in function 'tls_process_finished' when the comparison of 'pkt' and 's-&gt;s3-&gt;tmp.peer_finish_md' fails.
Unfortunately I currently do not know what this means.

For detailed information I've appended a pcap file.



Regards,
C. Scharfenberg

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://mta.openssl.org/pipermail/openssl-users/attachments/20190124/97ead4f1/attachment-0001.html">http://mta.openssl.org/pipermail/openssl-users/attachments/20190124/97ead4f1/attachment-0001.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: decrpyt_error.pcap
Type: application/octet-stream
Size: 7359 bytes
Desc: decrpyt_error.pcap
URL: &lt;<A HREF="http://mta.openssl.org/pipermail/openssl-users/attachments/20190124/97ead4f1/attachment-0001.obj">http://mta.openssl.org/pipermail/openssl-users/attachments/20190124/97ead4f1/attachment-0001.obj</A>&gt;
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009780.html">[openssl-users] SSL_read() returns -1, and SSL_read_ex does not update readbytes where a record containing a session ticket is being read (TLS 1.3)
</A></li>
	<LI>Next message: <A HREF="009768.html">[openssl-users] decrypt error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9767">[ date ]</a>
              <a href="thread.html#9767">[ thread ]</a>
              <a href="subject.html#9767">[ subject ]</a>
              <a href="author.html#9767">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
