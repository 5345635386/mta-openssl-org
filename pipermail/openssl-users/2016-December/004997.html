<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] Problem with certificate check when it does not	match CN
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2016-December/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Problem%20with%20certificate%20check%20when%20it%20does%20not%0A%09match%20CN&In-Reply-To=%3CCAOBG12nERmsNJFnXPbHzj02_DHdFLCDzNWQGVBbw%3Dorf4kfNFg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004995.html">
   <LINK REL="Next"  HREF="005000.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] Problem with certificate check when it does not	match CN</H1>
    <B>Brice Andr&#233;</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Problem%20with%20certificate%20check%20when%20it%20does%20not%0A%09match%20CN&In-Reply-To=%3CCAOBG12nERmsNJFnXPbHzj02_DHdFLCDzNWQGVBbw%3Dorf4kfNFg%40mail.gmail.com%3E"
       TITLE="[openssl-users] Problem with certificate check when it does not	match CN">brice at famille-andre.be
       </A><BR>
    <I>Sun Dec 18 20:05:42 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="004995.html">[openssl-users] Error code 554184855 on PKCS7_sign_add_signer?
</A></li>
        <LI>Next message: <A HREF="005000.html">[openssl-users] Problem with certificate check when it does not match CN
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4997">[ date ]</a>
              <a href="thread.html#4997">[ thread ]</a>
              <a href="subject.html#4997">[ subject ]</a>
              <a href="author.html#4997">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear all,

I use a gsoap application for which I write the server (php/apache) and
client (gsoap and openssl). As I am pretty sure my problem comes from
openssl and not gsoap, I am asking my question here.

I developped the service a few years ago and got wildcard certificates from
Startcom. Due to the recent probems with startcom, I migrated my
certificates to COMODO. I also tried to rationalise the number of
certificates, and I think several of my problems come from here.

For a dedicate web service, I use a server located at
<A HREF="https://www.online-rdv.be/v1/....">https://www.online-rdv.be/v1/....</A> With my previous certificate, CN of
certificate was a wildcard certificate : *.online-rdv.be. Everything worked
fine.

But now, my new certificate is common for all my web sites. So, the CN is
www.ams-solutions.be and, in the list of alternate names, I have an entry *.
online-rdv.be.

&gt;<i>From this point, all gsoap connections fail from SSL checks. If checked the
</I>certificate bundle provided to my gsoap client application and it contains
root certificate, as well as intermediate certificates.

This same soap server is directly used by the website and all browsers I
checked do not encounter the problem.

So, my best guess is that the way I configure openssl with gsoap is not
correct and does not allow validating a web site if it does not match the
CN certificate field.

I do no special configuration (nearly all default parameters). In fact, the
only ssl configuration I perform is the following :

  soap_ssl_init();
   soap_ssl_client_context(service.soap,
                           SOAP_SSL_DEFAULT,
                           NULL,
                           NULL,
                           cert_path.GetCString(),
                           NULL,
                           NULL);


where cert_path points to a file with root and intermediate certificates.

Any suggestion on how to solve my problem ?

Regards,

Brice
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://mta.openssl.org/pipermail/openssl-users/attachments/20161218/f901b08d/attachment.html">http://mta.openssl.org/pipermail/openssl-users/attachments/20161218/f901b08d/attachment.html</A>&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004995.html">[openssl-users] Error code 554184855 on PKCS7_sign_add_signer?
</A></li>
	<LI>Next message: <A HREF="005000.html">[openssl-users] Problem with certificate check when it does not match CN
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4997">[ date ]</a>
              <a href="thread.html#4997">[ thread ]</a>
              <a href="subject.html#4997">[ subject ]</a>
              <a href="author.html#4997">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
