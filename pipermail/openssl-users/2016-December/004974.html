<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] It reported verify error:num=20:unable to get local issuer certificate in my embedded linux device, when I used the openssl command
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2016-December/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20It%20reported%20verify%20error%3Anum%3D20%3Aunable%20to%20get%0A%20local%20issuer%20certificate%20in%20my%20embedded%20linux%20device%2C%0A%20when%20I%20used%20the%20openssl%20command&In-Reply-To=%3Cc99aff63-b634-f97e-5ec1-2e1da4b0e3ec%40wisemo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004973.html">
   <LINK REL="Next"  HREF="004976.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] It reported verify error:num=20:unable to get local issuer certificate in my embedded linux device, when I used the openssl command</H1>
    <B>Jakob Bohm</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20It%20reported%20verify%20error%3Anum%3D20%3Aunable%20to%20get%0A%20local%20issuer%20certificate%20in%20my%20embedded%20linux%20device%2C%0A%20when%20I%20used%20the%20openssl%20command&In-Reply-To=%3Cc99aff63-b634-f97e-5ec1-2e1da4b0e3ec%40wisemo.com%3E"
       TITLE="[openssl-users] It reported verify error:num=20:unable to get local issuer certificate in my embedded linux device, when I used the openssl command">jb-openssl at wisemo.com
       </A><BR>
    <I>Wed Dec 14 07:51:14 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="004973.html">[openssl-users] It reported verify error:num=20:unable to get local issuer certificate in my embedded linux device, when I used the openssl command
</A></li>
        <LI>Next message: <A HREF="004976.html">[openssl-users] It reported verify error:num=20:unable to get local issuer certificate in my embedded linux device, when I used the openssl command
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4974">[ date ]</a>
              <a href="thread.html#4974">[ thread ]</a>
              <a href="subject.html#4974">[ subject ]</a>
              <a href="author.html#4974">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 14/12/2016 08:30, &#26472;&#20426; wrote:
&gt;<i> Hi openssl-er,
</I>&gt;<i>
</I>&gt;<i> I'm newbie in the openssl.
</I>&gt;<i> Recently, I ported the openssl to my embedded linux device and ran the 
</I>&gt;<i> openssl command.
</I>&gt;<i> But there was an error occured.
</I>&gt;<i> I had done google search a lot, but I didn't find the answer.
</I>&gt;<i> My issue is strange, my test steps like below:
</I>&gt;<i> 1. copy the openssl, libs, cacert.pem to the embedded linux platform.
</I>&gt;<i>
</I>Does cacert.pem contain the CA certificate that issued the certificate for
<A HREF="https://curl.haxx.se">https://curl.haxx.se</A> ?

In general, the argument to -CAfile should be the concatenation of the PEM
format CA root certificates that your embedded platform wants to trust as
issuing trustworthy certificates for servers you will connect to.

Alternatively, the argument to -CApath should point to a directory
(traditionally named &quot;/etc/ssl/certs&quot;) containing:

   One PEM file with each such trusted CA certificate
   The symlinks generated by the c_rehash script (these map simple checksums
     of the certificate names to the file names containing CA certificates
     with names with those checksums, this reduces memory consumption but
     increases disk read operations).

If your embedded file system does not support symlinks, you can instead
rename the PEM files to the names of the symlinks that c_rehash generates
on a more full-blown development computer.

&gt;<i> 2. run the command:
</I>&gt;<i> /tmp #:./openssl s_client -connect curl.haxx.se:443 
</I>&gt;<i> &lt;<A HREF="http://curl.haxx.se:443">http://curl.haxx.se:443</A>&gt; -CAfile /tmp/cacert.pem
</I>&gt;<i>
</I>&gt;<i> 3. the error log is
</I>&gt;<i> ------log ----------------
</I>&gt;<i> CONNECTED(00000003)
</I>&gt;<i> depth=0 CN = anja.haxx.se &lt;<A HREF="http://anja.haxx.se">http://anja.haxx.se</A>&gt;
</I>&gt;<i> verify error:num=20:unable to get local issuer certificate
</I>&gt;<i> verify return:1
</I>&gt;<i> depth=0 CN = anja.haxx.se &lt;<A HREF="http://anja.haxx.se">http://anja.haxx.se</A>&gt;
</I>&gt;<i> verify error:num=21:unable to verify the first certificate
</I>&gt;<i> verify return:1
</I>&gt;<i> ---
</I>&gt;<i> Certificate chain
</I>&gt;<i>  0 s:/CN=anja.haxx.se &lt;<A HREF="http://anja.haxx.se">http://anja.haxx.se</A>&gt;
</I>&gt;<i>    i:/C=US/O=Let's Encrypt/CN=Let's Encrypt Authority X3
</I>&gt;<i>  1 s:/C=US/O=Let's Encrypt/CN=Let's Encrypt Authority X3
</I>&gt;<i>    i:/O=Digital Signature Trust Co./CN=DST Root CA X3
</I>&gt;<i> ---
</I>&gt;<i> Server certificate
</I>&gt;<i> ----------------------------------
</I>&gt;<i>
</I>&gt;<i> 4. my openssl version -d and version is
</I>&gt;<i> /tmp # ./openssl version
</I>&gt;<i> OpenSSL 1.1.0c  10 Nov 2016
</I>&gt;<i> /tmp # ./openssl version -d
</I>&gt;<i> OPENSSLDIR: &quot;/home/georgeyang/workspace/speech_code/openssl/openssl/final&quot;
</I>&gt;<i>
</I>&gt;<i> 5. In my PC, I found this command worked well. It could return the ok 
</I>&gt;<i> value.
</I>&gt;<i> Although the openssl version is 1.0.1f.
</I>&gt;<i> So I think my cacert.pem is right.
</I>&gt;<i>
</I>&gt;<i> 6. I also used other command like:
</I>&gt;<i> /tmp # ./openssl s_client -connect curl.haxx.se:443 
</I>&gt;<i> &lt;<A HREF="http://curl.haxx.se:443">http://curl.haxx.se:443</A>&gt; -CApath /tmp/cacert.pem
</I>&gt;<i> /tmp # ./openssl s_client -CApath 
</I>&gt;<i> /home/georgeyang/workspace/speech_code/openssl/openssl/final/ -connect 
</I>&gt;<i> curl.haxx.se:443 &lt;<A HREF="http://curl.haxx.se:443">http://curl.haxx.se:443</A>&gt;
</I>&gt;<i> /tmp # ./openssl s_client -connect curl.haxx.se:443 
</I>&gt;<i> &lt;<A HREF="http://curl.haxx.se:443">http://curl.haxx.se:443</A>&gt; -servername curl.haxx.se 
</I>&gt;<i> &lt;<A HREF="http://curl.haxx.se">http://curl.haxx.se</A>&gt; -key /etc/ssl/private/ssl-cert-snakeoil.key 
</I>&gt;<i> -CAfile /etc/ssl/certs/cacert.pem
</I>&gt;<i> But they are all NG.
</I>&gt;<i>
</I>&gt;<i> In google, they all said -CAfile or -CApath could help, But it doesn't 
</I>&gt;<i> work for me. &gt;&quot;&lt;
</I>&gt;<i> Please help
</I>&gt;<i>
</I>


Enjoy

Jakob
-- 
Jakob Bohm, CIO, Partner, WiseMo A/S.  <A HREF="https://www.wisemo.com">https://www.wisemo.com</A>
Transformervej 29, 2860 S&#248;borg, Denmark.  Direct +45 31 13 16 10
This public discussion message is non-binding and may contain errors.
WiseMo - Remote Service Management for PCs, Phones and Embedded

</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004973.html">[openssl-users] It reported verify error:num=20:unable to get local issuer certificate in my embedded linux device, when I used the openssl command
</A></li>
	<LI>Next message: <A HREF="004976.html">[openssl-users] It reported verify error:num=20:unable to get local issuer certificate in my embedded linux device, when I used the openssl command
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4974">[ date ]</a>
              <a href="thread.html#4974">[ thread ]</a>
              <a href="subject.html#4974">[ subject ]</a>
              <a href="author.html#4974">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
