<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] Incompatible Object error from EC_POINT_mul	(Nicola)
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2018-October/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Incompatible%20Object%20error%20from%20EC_POINT_mul%0A%09%28Nicola%29&In-Reply-To=%3C014601d45f2b%24684aec00%2438e0c400%24%40secid.co.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008947.html">
   <LINK REL="Next"  HREF="008950.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] Incompatible Object error from EC_POINT_mul	(Nicola)</H1>
    <B>John Hughes</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Incompatible%20Object%20error%20from%20EC_POINT_mul%0A%09%28Nicola%29&In-Reply-To=%3C014601d45f2b%24684aec00%2438e0c400%24%40secid.co.uk%3E"
       TITLE="[openssl-users] Incompatible Object error from EC_POINT_mul	(Nicola)">john.hughes at secid.co.uk
       </A><BR>
    <I>Mon Oct  8 17:21:53 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="008947.html">[openssl-users] Issue with using TLS
</A></li>
        <LI>Next message: <A HREF="008950.html">[openssl-users] public version of encode_pkcs1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8948">[ date ]</a>
              <a href="thread.html#8948">[ thread ]</a>
              <a href="subject.html#8948">[ subject ]</a>
              <a href="author.html#8948">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Nicola,

Brilliant - that sorted it. I have produced a public key this way and
successfully compared it with the public key in the original key pair.

You may want to update the wiki page to add that step into the sample code


Regards

John

-----Original Message-----
From: openssl-users [mailto:<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>] On Behalf Of
<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-request at openssl.org</A>
Sent: 08 October 2018 08:36
To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
Subject: openssl-users Digest, Vol 47, Issue 8

Send openssl-users mailing list submissions to
	<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>

To subscribe or unsubscribe via the World Wide Web, visit
	<A HREF="../../../mailman/listinfo/openssl-users.html">https://mta.openssl.org/mailman/listinfo/openssl-users</A>
or, via email, send a message with subject or body 'help' to
	<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-request at openssl.org</A>

You can reach the person managing the list at
	<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-owner at openssl.org</A>

When replying, please edit your Subject line so it is more specific than
&quot;Re: Contents of openssl-users digest...&quot;


Today's Topics:

   1. Re: Wiki misleading Enc (Richard Levitte)
   2. Re: osf-contact Latest Openssl Issue with Bind	9.12.2-P2 on
      RHEL 7.5 (<A HREF="../../../mailman/listinfo/openssl-users.html">aakash.kumar at orange.com</A>)
   3. Re: Incompatible Object error from EC_POINT_mul (Nicola)


----------------------------------------------------------------------

Message: 1
Date: Mon, 08 Oct 2018 07:03:34 +0200 (CEST)
From: Richard Levitte &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">levitte at openssl.org</A>&gt;
To: <A HREF="../../../mailman/listinfo/openssl-users.html">paul at zil.li</A>
Cc: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
Subject: Re: [openssl-users] Wiki misleading Enc
Message-ID: &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">20181008.070334.1188127225315146424.levitte at openssl.org</A>&gt;
Content-Type: Text/Plain; charset=us-ascii

Fixed.  Thanks.

In message &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">1df7e534-d4f0-7ac1-4de5-4cb8fb37d9e0 at zil.li</A>&gt; on Sat, 6 Oct 2018
22:48:01 +0200, Paul Zillmann &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">paul at zil.li</A>&gt; said:

&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> the wiki page [1] is wrong about the pass parameter.
</I>&gt;<i> According to [2] the parameter for a keyfile is -pass file:path and 
</I>&gt;<i> not -pass pass:path
</I>&gt;<i> 
</I>&gt;<i> - Paul
</I>&gt;<i> 
</I>&gt;<i> 1: <A HREF="https://wiki.openssl.org/index.php/Enc">https://wiki.openssl.org/index.php/Enc</A>
</I>&gt;<i> 2: <A HREF="https://www.openssl.org/docs/man1.0.2/apps/openssl.html">https://www.openssl.org/docs/man1.0.2/apps/openssl.html</A>
</I>&gt;<i> 
</I>

------------------------------

Message: 2
Date: Mon, 8 Oct 2018 05:50:40 +0000
From: &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">aakash.kumar at orange.com</A>&gt;
To: &quot;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>&quot; &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>&gt;
Cc: &quot;<A HREF="../../../mailman/listinfo/openssl-users.html">osf-contact at openssl.org</A>&quot; &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">osf-contact at openssl.org</A>&gt;
Subject: Re: [openssl-users] osf-contact Latest Openssl Issue with
	Bind	9.12.2-P2 on RHEL 7.5
Message-ID:
	
&lt;14773_1538977844_5BBAF034_14773_368_1_D9E1007BEB274445807B4DF1046EDA2711076
<A HREF="../../../mailman/listinfo/openssl-users.html">38A at OPEXCSINM91.corporate.adroot.infra.ftgroup</A>&gt;
	
Content-Type: text/plain; charset=&quot;iso-2022-jp&quot;

Hi Team,



Please find below error in text format.



[<A HREF="../../../mailman/listinfo/openssl-users.html">root at g3r1</A> ~]# systemctl status bind -l

? bind.service - LSB: DNS Daemon

   Loaded: loaded (/etc/rc.d/init.d/bind)

   Active: active (exited) since Fri 2018-10-05 13:31:09 CEST; 2 days ago

     Docs: man:systemd-sysv-generator(8)

  Process: 32417 ExecStop=/etc/rc.d/init.d/bind stop (code=exited,
status=0/SUCCESS)

  Process: 32421 ExecStart=/etc/rc.d/init.d/bind start (code=exited,
status=0/SUCCESS)



Oct 05 13:31:09 g3r1 named[32429]:
----------------------------------------------------

Oct 05 13:31:09 g3r1 named[32429]: adjusted limit on open files from 4096 to
1048576

Oct 05 13:31:09 g3r1 named[32429]: found 1 CPU, using 1 worker thread

Oct 05 13:31:09 g3r1 named[32429]: using 1 UDP listener per interface

Oct 05 13:31:09 g3r1 named[32429]: using up to 4096 sockets

Oct 05 13:31:09 g3r1 named[32429]: openssl_link.c:296: fatal error:

Oct 05 13:31:09 g3r1 named[32429]: OpenSSL pseudorandom number generator
cannot be initialized (see the `PRNG not seeded' message in the OpenSSL FAQ)

Oct 05 13:31:09 g3r1 named[32429]: exiting (due to fatal error in library)

Oct 05 13:31:09 g3r1 bind[32421]: [13B blob data]

Oct 05 13:31:09 g3r1 systemd[1]: Started LSB: DNS Daemon.





[<A HREF="../../../mailman/listinfo/openssl-users.html">root at g3r1</A> ~]# tail /var/log/message

Oct  5 13:31:09 g3r1 systemd: Starting LSB: DNS Daemon...

Oct  5 13:31:09 g3r1 bind: /etc/rc.d/init.d/bind: line 36: log_info_msg:
command not found

Oct  5 13:31:09 g3r1 named[32429]: starting BIND 9.12.2-P2 &lt;id:b2bf278&gt;

Oct  5 13:31:09 g3r1 named[32429]: running on Linux x86_64
3.10.0-327.13.1.el7.x86_64 #1 SMP Mon Feb 29 13:22:02 EST 2016

Oct  5 13:31:09 g3r1 named[32429]: built with '--prefix=/usr'
'--sysconfdir=/etc' '--localstatedir=/var' 'mandir=/usr/share/man'
'--enable-threads' '--with-libtool' '--with-openssl=/usr/local/ssl'
'--disable-static' '--with-randomdev=/dev/urandom'

Oct  5 13:31:09 g3r1 named[32429]: running as: named -u named -t /srv/named
-c /etc/named.conf

Oct  5 13:31:09 g3r1 named[32429]: compiled by GCC 4.8.5 20150623 (Red Hat
4.8.5-28)

Oct  5 13:31:09 g3r1 named[32429]: compiled with OpenSSL version: OpenSSL
1.0.2p  14 Aug 2018

Oct  5 13:31:09 g3r1 named[32429]: linked to OpenSSL version: OpenSSL 1.0.2p
14 Aug 2018

Oct  5 13:31:09 g3r1 named[32429]: compiled with zlib version: 1.2.7

Oct  5 13:31:09 g3r1 named[32429]: linked to zlib version: 1.2.7

Oct  5 13:31:09 g3r1 named[32429]: threads support is enabled

Oct  5 13:31:09 g3r1 named[32429]:
----------------------------------------------------

Oct  5 13:31:09 g3r1 named[32429]: BIND 9 is maintained by Internet Systems
Consortium,

Oct  5 13:31:09 g3r1 named[32429]: Inc. (ISC), a non-profit 501(c)(3)
public-benefit

Oct  5 13:31:09 g3r1 named[32429]: corporation.  Support and training for
BIND 9 are

Oct  5 13:31:09 g3r1 named[32429]: available at <A HREF="https://www.isc.org/support">https://www.isc.org/support</A>

Oct  5 13:31:09 g3r1 named[32429]:
----------------------------------------------------

Oct  5 13:31:09 g3r1 named[32429]: adjusted limit on open files from 4096 to
1048576

Oct  5 13:31:09 g3r1 named[32429]: found 1 CPU, using 1 worker thread

Oct  5 13:31:09 g3r1 named[32429]: using 1 UDP listener per interface

Oct  5 13:31:09 g3r1 named[32429]: using up to 4096 sockets

Oct  5 13:31:09 g3r1 named[32429]: openssl_link.c:296: fatal error:

Oct  5 13:31:09 g3r1 named[32429]: OpenSSL pseudorandom number generator
cannot be initialized (see the `PRNG not seeded' message in the OpenSSL FAQ)





Thanks &amp; Regards,



Aakash kumar

ITE - India

Tower B, 8th Floor, DLF Infinity Towers,

DLF Cyber City Phase - II

Gurgaon - 122002, Haryana, INDIA

<A HREF="../../../mailman/listinfo/openssl-users.html">Aakash.kumar at orange.com</A>



  Mobile: +91-8527288977

  CVS: 7357 3706







-----Original Message-----
From: Viktor Dukhovni [mailto:<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at dukhovni.org</A>]
Sent: 05 October 2018 21:23
To: KUMAR Aakash IMT/OINIS
Cc: <A HREF="../../../mailman/listinfo/openssl-users.html">osf-contact at openssl.org</A>; SRIVASTAVA Himanshu IMT/OINIS; VARSHNEY Praveen
IMT/OINIS
Subject: Re: osf-contact Latest Openssl Issue with Bind 9.12.2-P2 on RHEL
7.5





Please try to send the text of error reports, not pictures.



&gt;<i> I am getting below error while starting the bind service.
</I>
&gt;<i>
</I>
&gt;<i> &lt;image002.png&gt;
</I>


If you ask on the openssl-users list, someone else may have seen

the same issue, and may have useful advice to share.



NOTE!!!:  I've set the Reply-To: address to &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>&gt;.

If you just hit &quot;Reply&quot;, your answer may go to the list, though you'd

need to join the list first to be able to post...



Does the error still happen when you disable &quot;chroot&quot; in BIND?

Perhaps BIND is doing late initialization of the PRNG after

entering the chroot jail, and maybe trying to use &quot;/dev/urandom&quot;,

which not be in the jail?  That's a wild guess.  You'd need to

trace system calls to see what it is actually doing...



--

                Viktor.



____________________________________________________________________________
_____________________________________________

Ce message et ses pieces jointes peuvent contenir des informations
confidentielles ou privilegiees et ne doivent donc pas etre diffuses,
exploites ou copies sans autorisation. Si vous avez recu ce message par
erreur, veuillez le signaler a l'expediteur et le detruire ainsi que les
pieces jointes. Les messages electroniques etant susceptibles d'alteration,
Orange decline toute responsabilite si ce message a ete altere, deforme ou
falsifie. Merci.

This message and its attachments may contain confidential or privileged
information that may be protected by law; they should not be distributed,
used or copied without authorisation.
If you have received this email in error, please notify the sender and
delete this message and its attachments.
As emails may be altered, Orange is not liable for messages that have been
modified, changed or falsified.
Thank you.

-------------- next part --------------
An HTML attachment was scrubbed...
URL:
&lt;<A HREF="http://mta.openssl.org/pipermail/openssl-users/attachments/20181008/9a4c315">http://mta.openssl.org/pipermail/openssl-users/attachments/20181008/9a4c315</A>
f/attachment-0001.html&gt;

------------------------------

Message: 3
Date: Mon, 8 Oct 2018 10:35:33 +0300
From: Nicola &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">nic.tuv at gmail.com</A>&gt;
To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
Subject: Re: [openssl-users] Incompatible Object error from
	EC_POINT_mul
Message-ID:
	&lt;CANm5x_NZ7Xwtgy8sfWYWPjcEvYktFY6apBKXp=<A HREF="../../../mailman/listinfo/openssl-users.html">_222F7K7Qv9g at mail.gmail.com</A>&gt;
Content-Type: text/plain; charset=&quot;utf-8&quot;

Hi,

I did not run this in the debugger, but one issue is that you are not
initializing `pub` before calling EC_POINT_mul : try adding

pub = EC_POINT_new(curve);
(and check for errors making sure pub is not null afterwards).

Hope this helps!


Best regards,

Nicola


On Mon, Oct 8, 2018, 00:31 John Hughes &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">john.hughes at secid.co.uk</A>&gt; wrote:

&gt;<i> I'm trying to generate a public key from a private key generated on a 
</I>&gt;<i> HSM (and obtained by calling PKCS#11). Everything works fine until I 
</I>&gt;<i> call EC_POINT_mul - at which point I get the error message:
</I>&gt;<i>
</I>&gt;<i>        error:100BB065:elliptic curve routines:ec_wNAF_mul:incompatible 
</I>&gt;<i> objects
</I>&gt;<i>
</I>&gt;<i> I have checked the BIGNUM conversion - and that seems to be fine. The 
</I>&gt;<i> key pair on the HSM is also generated using brainpoolP256r1.
</I>&gt;<i>
</I>&gt;<i> The basis of the code can be found at the end of the email. I'm 
</I>&gt;<i> basically trying to follow the example provided in:
</I>&gt;<i>         <A HREF="https://wiki.openssl.org/index.php/Elliptic_Curve_Cryptography.">https://wiki.openssl.org/index.php/Elliptic_Curve_Cryptography.</A>
</I>&gt;<i>
</I>&gt;<i> I'm using openssl 1.10h
</I>&gt;<i>
</I>&gt;<i> Any pointers or help would be appreciated.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> John
</I>&gt;<i>
</I>&gt;<i> ---------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>         BN_CTX *ctx;
</I>&gt;<i>         ctx = BN_CTX_new();
</I>&gt;<i>         if(!ctx) {
</I>&gt;<i>                 outputInfo(&quot;unable to create openssl BN_CTX&quot;);
</I>&gt;<i>                 return;
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>         EC_GROUP *curve;
</I>&gt;<i>
</I>&gt;<i>         outputInfo(&quot;about to create EC_GROUP_new_by_curve_name&quot;);
</I>&gt;<i>         if(NULL == (curve =
</I>&gt;<i> EC_GROUP_new_by_curve_name(NID_brainpoolP256r1))) {
</I>&gt;<i>                 outputERRORmess(&quot;unable to setup curve&quot;);
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>         outputInfo(&quot;about to create EC_KEY_new_by_curve_name&quot;);
</I>&gt;<i>         EC_KEY *key;
</I>&gt;<i>         if(NULL == (key = EC_KEY_new_by_curve_name(NID_brainpoolP256r1)))
</I>{
&gt;<i>                 outputERRORmess(&quot;unable to setup EC_KEY&quot;);
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>         // now get the private key contained in CKA_VALUE via PKCS#111 
</I>&gt;<i> and place in *attrPrivate.pValue
</I>&gt;<i>
</I>&gt;<i>                 .......... (handle error)
</I>&gt;<i>
</I>&gt;<i>         EC_POINT *pub;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>         BIGNUM *prv = BN_bin2bn((unsigned char*)attrPrivate.pValue, 
</I>&gt;<i> attrPrivate.ulValueLen, NULL);
</I>&gt;<i>         if (prv == NULL) {
</I>&gt;<i>
</I>&gt;<i>         ...... (handle error)
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>         if (1 != EC_KEY_set_private_key(key, prv)) {
</I>&gt;<i>
</I>&gt;<i>                 ........ (handle error)
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>         if (1 != EC_POINT_mul(curve, pub, prv, NULL, NULL, ctx)) {
</I>&gt;<i>                 outputInfo(&quot;unable to calculate the public key from 
</I>&gt;<i> the HSM's private key using EC_POINT_mul&quot;);
</I>&gt;<i>                 (handle error)
</I>&gt;<i>
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> openssl-users mailing list
</I>&gt;<i> To unsubscribe: <A HREF="../../../mailman/listinfo/openssl-users.html">https://mta.openssl.org/mailman/listinfo/openssl-users</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL:
&lt;<A HREF="http://mta.openssl.org/pipermail/openssl-users/attachments/20181008/bcd9871">http://mta.openssl.org/pipermail/openssl-users/attachments/20181008/bcd9871</A>
5/attachment.html&gt;

------------------------------

Subject: Digest Footer

_______________________________________________
openssl-users mailing list
<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
<A HREF="../../../mailman/listinfo/openssl-users.html">https://mta.openssl.org/mailman/listinfo/openssl-users</A>


------------------------------

End of openssl-users Digest, Vol 47, Issue 8
********************************************

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008947.html">[openssl-users] Issue with using TLS
</A></li>
	<LI>Next message: <A HREF="008950.html">[openssl-users] public version of encode_pkcs1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8948">[ date ]</a>
              <a href="thread.html#8948">[ thread ]</a>
              <a href="subject.html#8948">[ subject ]</a>
              <a href="author.html#8948">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
