<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> OpenSSL reports wrong TLS version to FreeRADIUS
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2020-March/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20OpenSSL%20reports%20wrong%20TLS%20version%20to%20FreeRADIUS&In-Reply-To=%3C67140e16-28d3-6824-2340-8f59f1784301%40openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011954.html">
   <LINK REL="Next"  HREF="011958.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>OpenSSL reports wrong TLS version to FreeRADIUS</H1>
    <B>Matt Caswell</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20OpenSSL%20reports%20wrong%20TLS%20version%20to%20FreeRADIUS&In-Reply-To=%3C67140e16-28d3-6824-2340-8f59f1784301%40openssl.org%3E"
       TITLE="OpenSSL reports wrong TLS version to FreeRADIUS">matt at openssl.org
       </A><BR>
    <I>Tue Mar  3 14:44:06 UTC 2020</I>
    <P><UL>
        <LI>Previous message: <A HREF="011954.html">OpenSSL reports wrong TLS version to FreeRADIUS
</A></li>
        <LI>Next message: <A HREF="011958.html">OpenSSL reports wrong TLS version to FreeRADIUS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11955">[ date ]</a>
              <a href="thread.html#11955">[ thread ]</a>
              <a href="subject.html#11955">[ subject ]</a>
              <a href="author.html#11955">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On 03/03/2020 12:51, iilinasi wrote:
&gt;<i> Alfred, I'd like to say &quot;thanks&quot; once more.
</I>&gt;<i> 
</I>&gt;<i> I tried with newer ciphers and version 1.2 - and now freeradius (3.0.16)
</I>&gt;<i> indeed sends me the second &quot;challenge&quot;. So, it's a huge progress.
</I>&gt;<i> 
</I>&gt;<i> However it still complains on the unknown TLS version. I attach the
</I>&gt;<i> server log and the packet capture, just in case.
</I>
This is the interesting part from the server log.

(1) eap_tls: TLS_accept: before SSL initialization
(1) eap_tls: &lt;&lt;&lt; recv UNKNOWN TLS VERSION ?0304? [length 0048]
(1) eap_tls: TLS_accept: SSLv3/TLS read client hello

The &quot;before SSL initialization&quot; and the &quot;SSLv3/TLS read client hello&quot;
strings are generated by OpenSSL. They are the return values from a call
to the function SSL_state_string_long() and are intended to give a human
readable output of what state the SSL object is in and where in the
handshake process it has got to.

Interestingly the &quot;UNKNOWN TLS VERSION&quot; message appears between the
&quot;before&quot; state and the &quot;read client hello&quot; state. The latter will be
returned after the SSL object has gone through its initial setup but
before or during the processing of a ClientHello received from the
client. The TLS protocol version that server will use is chosen during
the processing of that ClientHello. Depending on exactly at what point
we're at it is possible that a call to SSL_version() will return either
the selected version or (if we haven't got as far as selecting a version
yet), the version that the SSL object was initialised with.

New SSL objects created using TLS_method(), or TLS_server_method() will
have their version initialised to TLS_MAX_VERSION. In OpenSSL 1.1.1
TLS_MAX_VERSION is 0x0304 (TLSv1.3).

The string &quot;UNKNOWN TLS VERSION&quot; does not appear in libssl at all. So my
guess is that this warning is actually coming from eap_tls after it has
made a call to SSL_version(). Since the version has not actually been
negotiated yet it comes back with TLSv1.3, and eap_tls doesn't know how
to handle it.

Is this actually an error? Or just a warning?

Matt
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011954.html">OpenSSL reports wrong TLS version to FreeRADIUS
</A></li>
	<LI>Next message: <A HREF="011958.html">OpenSSL reports wrong TLS version to FreeRADIUS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11955">[ date ]</a>
              <a href="thread.html#11955">[ thread ]</a>
              <a href="subject.html#11955">[ subject ]</a>
              <a href="author.html#11955">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
