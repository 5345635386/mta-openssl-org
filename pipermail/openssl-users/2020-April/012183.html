<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> tbslen parameter in EVP_PKEY_sign() and EVP_PKEY_verify()
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2020-April/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20tbslen%20parameter%20in%20EVP_PKEY_sign%28%29%20and%20EVP_PKEY_verify%28%29&In-Reply-To=%3CCAM1XXMdE5m1X3sEkFVYCGwibrKZ3uWMtP9J7GMJ%3DnNt_89hA4A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012182.html">
   <LINK REL="Next"  HREF="012186.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>tbslen parameter in EVP_PKEY_sign() and EVP_PKEY_verify()</H1>
    <B>Jason Proctor</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20tbslen%20parameter%20in%20EVP_PKEY_sign%28%29%20and%20EVP_PKEY_verify%28%29&In-Reply-To=%3CCAM1XXMdE5m1X3sEkFVYCGwibrKZ3uWMtP9J7GMJ%3DnNt_89hA4A%40mail.gmail.com%3E"
       TITLE="tbslen parameter in EVP_PKEY_sign() and EVP_PKEY_verify()">jason at spatiallabs.com
       </A><BR>
    <I>Tue Apr  7 18:39:26 UTC 2020</I>
    <P><UL>
        <LI>Previous message: <A HREF="012182.html">tbslen parameter in EVP_PKEY_sign() and EVP_PKEY_verify()
</A></li>
        <LI>Next message: <A HREF="012186.html">Replacing SECLEVEL with AUTHSECLEVEL and TLSSECLEVEL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12183">[ date ]</a>
              <a href="thread.html#12183">[ thread ]</a>
              <a href="subject.html#12183">[ subject ]</a>
              <a href="author.html#12183">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yes (duh) of course. The actual sign and verify functions don't know
anything about the original payload. They only care about the thing
being signed.

Thanks for the help!

On Tue, Apr 7, 2020 at 11:18 AM Kyle Hamilton &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">aerowolf at gmail.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> 32 bytes means you're signing using RSA-WITH-SHA-256, yes?
</I>&gt;<i>
</I>&gt;<i> tbs is the digest value you calculated, tbslen is the size in bytes of
</I>&gt;<i> the digest.
</I>&gt;<i>
</I>&gt;<i> -Kyle H
</I>&gt;<i>
</I>&gt;<i> On Tue, Apr 7, 2020 at 1:07 PM Jason Proctor &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">jason at spatiallabs.com</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Esteemed cryptologists,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Question regarding the &quot;tbslen&quot; parameter to the sign and verify
</I>&gt;<i> &gt; functions. The documentation says --
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &quot;The verified data (i.e. the data believed originally signed) is
</I>&gt;<i> &gt; specified using the tbs and tbslen parameters.&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Which might indicate that tbslen is the length of the payload. However
</I>&gt;<i> &gt; I found that I had to set this to the length of the *signature* to get
</I>&gt;<i> &gt; these calls to work. The sign() operation fails at rsa_pmeth.c line
</I>&gt;<i> &gt; 134, and the debugger does indeed tell me that it's expecting 32
</I>&gt;<i> &gt; there, rather than the payload length which is 1024.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Is this correct? Anything I'm missing, here?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; thanks for any clarity here
</I>&gt;<i> &gt; <A HREF="../../../mailman/listinfo/openssl-users.html">Jason at Spatial</A>
</I></PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012182.html">tbslen parameter in EVP_PKEY_sign() and EVP_PKEY_verify()
</A></li>
	<LI>Next message: <A HREF="012186.html">Replacing SECLEVEL with AUTHSECLEVEL and TLSSECLEVEL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12183">[ date ]</a>
              <a href="thread.html#12183">[ thread ]</a>
              <a href="subject.html#12183">[ subject ]</a>
              <a href="author.html#12183">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
