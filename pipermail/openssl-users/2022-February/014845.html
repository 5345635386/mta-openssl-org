<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Handshake Failure : SSL_accept:Error in before SSL initialization
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2022-February/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Handshake%20Failure%20%3A%20SSL_accept%3AError%20in%20before%20SSL%20initialization&In-Reply-To=%3CCAMiDcbH48duqGMO7rtqp3%3Dv5feoQKdnbG8nt4D8_Tan8pCNm0A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014844.html">
   <LINK REL="Next"  HREF="014846.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Handshake Failure : SSL_accept:Error in before SSL initialization</H1>
    <B>Kamala Ayyar</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Handshake%20Failure%20%3A%20SSL_accept%3AError%20in%20before%20SSL%20initialization&In-Reply-To=%3CCAMiDcbH48duqGMO7rtqp3%3Dv5feoQKdnbG8nt4D8_Tan8pCNm0A%40mail.gmail.com%3E"
       TITLE="Handshake Failure : SSL_accept:Error in before SSL initialization">kamala.ayyar at gmail.com
       </A><BR>
    <I>Fri Feb  4 15:17:16 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014844.html">error with p12 file importing
</A></li>
        <LI>Next message (by thread): <A HREF="014846.html">Handshake Failure : SSL_accept:Error in before SSL initialization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14845">[ date ]</a>
              <a href="thread.html#14845">[ thread ]</a>
              <a href="subject.html#14845">[ subject ]</a>
              <a href="author.html#14845">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

We are facing a strange handshake failure issue with a test server and
client application using OpenSSL in Windows.  We have tried with both
1.1.1g and 3.0.1 versions- same problem. We created a Dll to handle the
OpenSSL functions- where the SSL context, SSL object and certificates are
handled. The certificates are obtained from the Windows store and converted
to cert and key using PKCS12_parse()
The server accepts non secure connection from the client and then passes
the socket to the Dll that calls the TLS_server_method() and creates the
SSL context, SSL object and loads the certificates for use. It however
fails at SSL_accept(m_pSsl). We use a call
back SSL_set_info_callback(m_pSsl, apps_ssl_info_callback) that gave us the
following error information
SSL_accept:Error in before SSL initialization
On the client side the same Dll is called with a client
method TLS_client_method() and the error displayed is SSL_connect:Error in
SSLv3/TLS write client hello
We have confirmed the certificates are good and valid.

The same Dll called from a different heavily threaded application with over
2000+ clients works well and handshake connections established
without issues on a different port number.

We have also tried to use OpenSSL methods directly without using the Dll
but we get the same failure.  This was also used with server and client on
the same machine as well as different machines with the same outcome.  The
non secure communication works fine between the server and the client

Thanks
Kamala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://mta.openssl.org/pipermail/openssl-users/attachments/20220204/9b6ed7da/attachment.htm">https://mta.openssl.org/pipermail/openssl-users/attachments/20220204/9b6ed7da/attachment.htm</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014844.html">error with p12 file importing
</A></li>
	<LI>Next message (by thread): <A HREF="014846.html">Handshake Failure : SSL_accept:Error in before SSL initialization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14845">[ date ]</a>
              <a href="thread.html#14845">[ thread ]</a>
              <a href="subject.html#14845">[ subject ]</a>
              <a href="author.html#14845">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
