<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Default DHE group
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2019-March/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Default%20DHE%20group&In-Reply-To=%3C369dccfc-a42a-87dc-48d1-0413bf4aeb5d%40openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010114.html">
   <LINK REL="Next"  HREF="010119.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Default DHE group</H1>
    <B>Matt Caswell</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Default%20DHE%20group&In-Reply-To=%3C369dccfc-a42a-87dc-48d1-0413bf4aeb5d%40openssl.org%3E"
       TITLE="Default DHE group">matt at openssl.org
       </A><BR>
    <I>Tue Mar 19 11:36:07 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="010114.html">Default DHE group
</A></li>
        <LI>Next message: <A HREF="010119.html">Building OpenSSL 1.1.1b for WinCE700
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10126">[ date ]</a>
              <a href="thread.html#10126">[ thread ]</a>
              <a href="subject.html#10126">[ subject ]</a>
              <a href="author.html#10126">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On 18/03/2019 23:05, Zeev Tarantov wrote:
&gt;<i> Since openssl verion 1.1.0, code for TLS server can use
</I>&gt;<i> `SSL_CTX_set_dh_auto(ctx, 1);` to let openssl handle choice of DH group which
</I>&gt;<i> will be used to generate ephemeral keys if a DHE cipher suite is negotiated.
</I>&gt;<i> 
</I>&gt;<i> TLS 1.3 limits DHE parameters to use groups from RFC 7919, from ffdhe2048 to
</I>&gt;<i> ffdhe8192.
</I>&gt;<i> Reference: <A HREF="https://tools.ietf.org/html/rfc8446#section-4.2.8.1">https://tools.ietf.org/html/rfc8446#section-4.2.8.1</A>
</I>&gt;<i> 
</I>&gt;<i> I'm looking at the function ssl_get_auto_dh in github master and you get one of:
</I>&gt;<i> RFC 5114 DH_get_1024_160
</I>&gt;<i> RFC 5114 DH_get_2048_224
</I>&gt;<i> RFC 3526 BN_get_rfc3526_prime_3072
</I>&gt;<i> RFC 3526 BN_get_rfc3526_prime_8192
</I>&gt;<i> 
</I>&gt;<i> Because SSL_CTX_set_dh_auto does not use the values from RFC 7919, application
</I>&gt;<i> developers choose to not use SSL_CTX_set_dh_auto.
</I>&gt;<i> See for example this commit to nginx web server:
</I>&gt;<i> <A HREF="https://hg.nginx.org/nginx/rev/1aa9650a8154">https://hg.nginx.org/nginx/rev/1aa9650a8154</A>
</I>
Well I don't think that commit is an example of developers choosing not to use
SSL_CTX_set_dh_auto because it doesn't use the values from RFC7919. The commit
doesn't mention RFC7919 at all and actually predates the publication of that RFC
in any case. Rather it seems to be a policy decision to not use fixed DH
parameters due to precomputation attacks. That concern would apply equally well
to RFC7919 - although I'm not aware of any practical precomputation attacks for
non-export grade DH params.

I'm also not aware of any concerns raised about the RFC3526/RFC5114 params
(other than the 1024 one is quite small - but looking at the logic of
SSL_CTX_set_dh_auto it selects a size based on the strength of the other
elements in the ciphersuite - so it will use larger DH params where appropriate).

&gt;<i> I also cannot really recommend postfix switch to SSL_CTX_set_dh_auto from the
</I>&gt;<i> hardcoded default generated by the postfix developers
</I>&gt;<i> (<A HREF="https://github.com/vdukhovni/postfix/blob/postfix-3.4/postfix/src/tls/tls_dh.c">https://github.com/vdukhovni/postfix/blob/postfix-3.4/postfix/src/tls/tls_dh.c</A>).
</I>&gt;<i> 
</I>&gt;<i> Patching software using openssl to use RFC 7919 groups &quot;manually&quot; does not scale
</I>&gt;<i> well. Expecting server admins to configure this at install time is laughable.
</I>&gt;<i> 
</I>&gt;<i> The situation is so dire, Google Chrome famously decided there are so many
</I>&gt;<i> RSA-2048/DHE-1024 web servers deployed, that disabling DHE is the right thing to do!
</I>
Again, this seems to be mixing up different things. I'm not sure how that is
relevant to the RFC7919 vs RFC5114/RFC3526 discussion.

&gt;<i> 
</I>&gt;<i> In case dh_auto was set, why doesn't openssl use the RFC 7919 groups also with
</I>&gt;<i> TLS versions below 1.3?
</I>
In fact OpenSSL does not support DHE in TLSv1.3 at all so it is not a case of
using RFC7919 for one protocol version and not for others. There is a PR for
adding TLSv1.3 support for this:

<A HREF="https://github.com/openssl/openssl/pull/8178">https://github.com/openssl/openssl/pull/8178</A>

The reason that they aren't supported by SSL_CTX_set_dh_auto() at the moment is
that that function was introduced before RFC7919 was published (and in fact
1.1.0 was released in the same month as the publication of that RFC). I notice
that the underlying RFC7919 params have been integrated into the latest versions
of OpenSSL but only in libcrypto - not in libssl. I'd certainly have no
objection to updating SSL_CTX_set_dh_auto() to use more modern parameters in
OpenSSL 3.0 (PRs welcome) - although I don't think we could justify backporting
such a change to a stable branch (1.1.1).

Matt
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010114.html">Default DHE group
</A></li>
	<LI>Next message: <A HREF="010119.html">Building OpenSSL 1.1.1b for WinCE700
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10126">[ date ]</a>
              <a href="thread.html#10126">[ thread ]</a>
              <a href="subject.html#10126">[ subject ]</a>
              <a href="author.html#10126">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
