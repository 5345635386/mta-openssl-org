<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Default DHE group
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2019-March/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Default%20DHE%20group&In-Reply-To=%3CCAMzrhQ_kkGC6rKKD25zWjO%2B-KY-t9J0of0uYenbzkrDOt_RTDA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010106.html">
   <LINK REL="Next"  HREF="010126.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Default DHE group</H1>
    <B>Zeev Tarantov</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Default%20DHE%20group&In-Reply-To=%3CCAMzrhQ_kkGC6rKKD25zWjO%2B-KY-t9J0of0uYenbzkrDOt_RTDA%40mail.gmail.com%3E"
       TITLE="Default DHE group">zeev.tarantov at gmail.com
       </A><BR>
    <I>Mon Mar 18 23:05:14 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="010106.html">In-memory SSL_CTX_use_certificate_chain_file?
</A></li>
        <LI>Next message: <A HREF="010126.html">Default DHE group
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10114">[ date ]</a>
              <a href="thread.html#10114">[ thread ]</a>
              <a href="subject.html#10114">[ subject ]</a>
              <a href="author.html#10114">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Since openssl verion 1.1.0, code for TLS server can use
`SSL_CTX_set_dh_auto(ctx, 1);` to let openssl handle choice of DH group
which will be used to generate ephemeral keys if a DHE cipher suite is
negotiated.

TLS 1.3 limits DHE parameters to use groups from RFC 7919, from ffdhe2048
to ffdhe8192.
Reference: <A HREF="https://tools.ietf.org/html/rfc8446#section-4.2.8.1">https://tools.ietf.org/html/rfc8446#section-4.2.8.1</A>

I'm looking at the function ssl_get_auto_dh in github master and you get
one of:
RFC 5114 DH_get_1024_160
RFC 5114 DH_get_2048_224
RFC 3526 BN_get_rfc3526_prime_3072
RFC 3526 BN_get_rfc3526_prime_8192

Because SSL_CTX_set_dh_auto does not use the values from RFC 7919,
application developers choose to not use SSL_CTX_set_dh_auto.
See for example this commit to nginx web server:
<A HREF="https://hg.nginx.org/nginx/rev/1aa9650a8154">https://hg.nginx.org/nginx/rev/1aa9650a8154</A>

I also cannot really recommend postfix switch to SSL_CTX_set_dh_auto from
the hardcoded default generated by the postfix developers (
<A HREF="https://github.com/vdukhovni/postfix/blob/postfix-3.4/postfix/src/tls/tls_dh.c">https://github.com/vdukhovni/postfix/blob/postfix-3.4/postfix/src/tls/tls_dh.c</A>
).

Patching software using openssl to use RFC 7919 groups &quot;manually&quot; does not
scale well. Expecting server admins to configure this at install time is
laughable.

The situation is so dire, Google Chrome famously decided there are so many
RSA-2048/DHE-1024 web servers deployed, that disabling DHE is the right
thing to do!

In case dh_auto was set, why doesn't openssl use the RFC 7919 groups also
with TLS versions below 1.3?
They are much more reputable than RFC 5114, which is what you get with an
RSA-2048 certificate, which is most common.

If this is fixed, maybe maybe TLS server software using openssl will be
able to switch to SSL_CTX_set_dh_auto, which will result in many more
server using secure key agreement. The alternative is that slowly people
will converge on the Google Chrome decision to disable DHE. Maybe it is
already too late, but perhaps with can still be done in openssl 1.1.1.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://mta.openssl.org/pipermail/openssl-users/attachments/20190319/01157250/attachment.html">http://mta.openssl.org/pipermail/openssl-users/attachments/20190319/01157250/attachment.html</A>&gt;
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010106.html">In-memory SSL_CTX_use_certificate_chain_file?
</A></li>
	<LI>Next message: <A HREF="010126.html">Default DHE group
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10114">[ date ]</a>
              <a href="thread.html#10114">[ thread ]</a>
              <a href="subject.html#10114">[ subject ]</a>
              <a href="author.html#10114">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
