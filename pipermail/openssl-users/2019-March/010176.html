<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Internal IP Exposed
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2019-March/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Internal%20IP%20Exposed&In-Reply-To=%3C723c1fa0-b45b-04b4-db81-65ae814ed62e%40binect.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010174.html">
   <LINK REL="Next"  HREF="010186.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Internal IP Exposed</H1>
    <B>Jochen Bern</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Internal%20IP%20Exposed&In-Reply-To=%3C723c1fa0-b45b-04b4-db81-65ae814ed62e%40binect.de%3E"
       TITLE="Internal IP Exposed">Jochen.Bern at binect.de
       </A><BR>
    <I>Mon Mar 25 12:25:21 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="010174.html">Internal IP Exposed
</A></li>
        <LI>Next message: <A HREF="010186.html">Internal IP Exposed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10176">[ date ]</a>
              <a href="thread.html#10176">[ thread ]</a>
              <a href="subject.html#10176">[ subject ]</a>
              <a href="author.html#10176">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/25/2019 01:08 PM, <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-request at openssl.org</A> digested:
&gt;<i> Date: Mon, 25 Mar 2019 11:33:55 +1100
</I>&gt;<i> From: Abdul Qoyyuum &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">aqoyyuum at cardaccess.com.au</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> GET /images HTTP/1.0
</I>
Note that this is a HTTP 1.*0* request that doesn't require the client
to send a Host: header stating what *his* idea of &quot;which server am I
trying to talk to?&quot; is.

&gt;<i> HTTP/1.0 301 Moved Permanently
</I>&gt;<i> Location: <A HREF="https://10.240.123.1:10443/images/">https://10.240.123.1:10443/images/</A>
</I>
/images is a directory, which means that the client is supposed to ask
for &quot;/images/&quot; (with a trailing slash) to request a directory listing.

The server is helpfully sending back a HTTP Redirect to tell the client
what he *should* request instead, in the form of a complete URL, which
necessitates a host and port part. Having no idea who and what the
*client* expects to talk to, the server fills in what *it* knows - its
local (internal) IP and port. This &quot;attack&quot; already worked that way
almost 20 years ago, when I demonstrated it to some (horrified) bank IT
people on their Netscape-based online banking solution middleware ...

OpenSSL is not involved here, and whether (and what) you can do to close
the gap depends on what HTTP server (and, if present, reverse proxy
solution) you're using.

Regards,
-- 
Jochen Bern
Systemingenieur

www.binect.de
www.facebook.de/binect

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4278 bytes
Desc: S/MIME Cryptographic Signature
URL: &lt;<A HREF="http://mta.openssl.org/pipermail/openssl-users/attachments/20190325/09753121/attachment.bin">http://mta.openssl.org/pipermail/openssl-users/attachments/20190325/09753121/attachment.bin</A>&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010174.html">Internal IP Exposed
</A></li>
	<LI>Next message: <A HREF="010186.html">Internal IP Exposed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10176">[ date ]</a>
              <a href="thread.html#10176">[ thread ]</a>
              <a href="subject.html#10176">[ subject ]</a>
              <a href="author.html#10176">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
