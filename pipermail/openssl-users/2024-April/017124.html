<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [EXTERNAL] - Re: Seeing intermittent crash for TLSv1.3
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2024-April/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5BEXTERNAL%5D%20-%20Re%3A%20Seeing%20intermittent%20crash%20for%20TLSv1.3&In-Reply-To=%3C4f7c3c94-4f40-4bc9-838c-1c91a3693dcc%40redhat.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017123.html">
   <LINK REL="Next"  HREF="017119.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[EXTERNAL] - Re: Seeing intermittent crash for TLSv1.3</H1>
    <B>Hubert Kario</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5BEXTERNAL%5D%20-%20Re%3A%20Seeing%20intermittent%20crash%20for%20TLSv1.3&In-Reply-To=%3C4f7c3c94-4f40-4bc9-838c-1c91a3693dcc%40redhat.com%3E"
       TITLE="[EXTERNAL] - Re: Seeing intermittent crash for TLSv1.3">hkario at redhat.com
       </A><BR>
    <I>Wed Apr 24 12:05:48 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017123.html">[EXTERNAL] - Re: Seeing intermittent crash for TLSv1.3
</A></li>
        <LI>Next message (by thread): <A HREF="017119.html">status of PKCS#11 providers?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17124">[ date ]</a>
              <a href="thread.html#17124">[ thread ]</a>
              <a href="subject.html#17124">[ subject ]</a>
              <a href="author.html#17124">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tuesday, 23 April 2024 15:51:34 CEST, Michael Wojcik via openssl-users 
wrote:
&gt;&gt;<i> From: openssl-users &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>&gt; On Behalf Of
</I>&gt;&gt;<i> Hubert Kario
</I>&gt;&gt;<i> Sent: Tuesday, 23 April, 2024 02:05
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Try using --malloc-fill=af --free-fill=fa ?
</I>&gt;&gt;<i> (or some other non-zero values)
</I>&gt;<i>
</I>&gt;<i> Or on a glibc platform (which I'm assuming Rahul's original 
</I>&gt;<i> message referred to, as that looked like a gdb backtrace), 
</I>&gt;<i> enabling libc_malloc_debug with LD_PRELOAD and setting 
</I>&gt;<i> MALLOC_CHECK_ or the equivalent glibc tunable. In my experience 
</I>&gt;<i> it can be a bit of work getting glibc malloc debugging working, 
</I>&gt;<i> and Valgrind is usually a better option; but if, as Rahul 
</I>&gt;<i> reported, valgrind is not diagnosing the issue, glibc malloc 
</I>&gt;<i> debugging is another possible route.
</I>&gt;<i>
</I>&gt;<i> That said, it's not entirely clear to me whether Rahul 
</I>&gt;<i> exhausted the valgrind option, since in the previous message he 
</I>&gt;<i> wrote that &quot;we are not able to see this crash when we are 
</I>&gt;<i> running our debug modules with Purify or Valgrind&quot;. I'd suggest 
</I>&gt;<i> running the precise problem scenario &#8212; same build, same 
</I>&gt;<i> reproduction sequence &#8212; under valgrind (memcheck), and then go 
</I>&gt;<i> through the valgrind output, starting with the post-termination 
</I>&gt;<i> report. If valgrind doesn't identify a problem with the debug 
</I>&gt;<i> build, try it with the release build.
</I>
I proposed use of those two options because I personally had exact same
situation (not with OpenSSL, but with a C application still):
valgrind was content and application was running fine, but when running
without valgrind the application would segfault.
To make it segfault in valgrind those two options were necessary, then
it was crashing reliably under valgrind too.
-- 
Regards,
Hubert Kario
Principal Quality Engineer, RHEL Crypto team
Web: www.cz.redhat.com
Red Hat Czech s.r.o., Purky&#328;ova 115, 612 00, Brno, Czech Republic

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017123.html">[EXTERNAL] - Re: Seeing intermittent crash for TLSv1.3
</A></li>
	<LI>Next message (by thread): <A HREF="017119.html">status of PKCS#11 providers?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17124">[ date ]</a>
              <a href="thread.html#17124">[ thread ]</a>
              <a href="subject.html#17124">[ subject ]</a>
              <a href="author.html#17124">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
