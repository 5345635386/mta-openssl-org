<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] OpenSSL error message when decrypting Ethereum	encrypted private key
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2018-January/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20OpenSSL%20error%20message%20when%20decrypting%20Ethereum%0A%09encrypted%20private%20key&In-Reply-To=%3CCABi%2BQur2WDZeHzOA5kg4vDiHU1LiJE6km2iqXMFkTxASqcvKaw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007340.html">
   <LINK REL="Next"  HREF="007311.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] OpenSSL error message when decrypting Ethereum	encrypted private key</H1>
    <B>Chris B</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20OpenSSL%20error%20message%20when%20decrypting%20Ethereum%0A%09encrypted%20private%20key&In-Reply-To=%3CCABi%2BQur2WDZeHzOA5kg4vDiHU1LiJE6km2iqXMFkTxASqcvKaw%40mail.gmail.com%3E"
       TITLE="[openssl-users] OpenSSL error message when decrypting Ethereum	encrypted private key">cryptoassetrecovery at gmail.com
       </A><BR>
    <I>Sun Jan 14 15:26:51 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="007340.html">[openssl-users] SSL Cert serial number non-uniqueness impact
</A></li>
        <LI>Next message: <A HREF="007311.html">[openssl-users] OpenSSL error message when decrypting Ethereum encrypted private key
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7310">[ date ]</a>
              <a href="thread.html#7310">[ thread ]</a>
              <a href="subject.html#7310">[ subject ]</a>
              <a href="author.html#7310">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm trying to help someone recover his password for an older format
ethereum encrypted private key (EPK). My plan has been to use his best
guess at the password to brute force the actual password.

The EPK is a 132 character string, and it looks something like this:
U2FsdGV0X185M9YAa/27pmEvFzC5pqLI4xWrA6ouGVCx0EeJ9s8DzeGuBtYJPDCKDy0m80yvHdQYDMPa+Hwv2JPbuGJNoUMhFWpcQW1VF+EAy0tYb7Wtv2+IRWZzcpsE8e2a

(That is: 128 ASCII digits and/or letters, plus three &quot;+&quot; and a &quot;/&quot;.)

This article (
<A HREF="https://www.reddit.com/r/Bitcoin/comments/3gwdge/importing_old_encrypted_private_keys/">https://www.reddit.com/r/Bitcoin/comments/3gwdge/importing_old_encrypted_private_keys/</A>)
seems to describe a very similar EPK. The author of that post decrypted
their key with the following command:

openssl enc -in FILE_OF_KEYS -a -d -salt -aes256 -pass pass:&quot;PASSWORD_HERE&quot;

I have tried this same approach, but I'm getting an error:

EVP_DecryptFinal_ex:wrong final block length

Here's an example:

/usr/bin/openssl enc -d -aes-256-cbc -a -in enc_private_key.txt -out
recovered.key -pass pass:TheBig7ebowski

And here's the output:

bad decrypt

140220549330848:error:0606506D:digital envelope
routines:EVP_DecryptFinal_ex:wrong final block length:evp_enc.c:581:

I'm not sure how to interpret that output. I could interpret it as:
o Your system for decrypting the password is perfect, but: this is not the
right password.
o There's something wrong with the EPK -- its length must be a multiple of
the AES block length.
o There's something wrong with the unencrypted private key -- its length
must be a multiple of the AES block length.
o Something else entirely

Can anyone help me understand how to interpret this error message?

Thanks,
Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://mta.openssl.org/pipermail/openssl-users/attachments/20180114/29d5b1e0/attachment.html">http://mta.openssl.org/pipermail/openssl-users/attachments/20180114/29d5b1e0/attachment.html</A>&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007340.html">[openssl-users] SSL Cert serial number non-uniqueness impact
</A></li>
	<LI>Next message: <A HREF="007311.html">[openssl-users] OpenSSL error message when decrypting Ethereum encrypted private key
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7310">[ date ]</a>
              <a href="thread.html#7310">[ thread ]</a>
              <a href="subject.html#7310">[ subject ]</a>
              <a href="author.html#7310">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
