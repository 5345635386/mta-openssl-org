<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] help with timestamping
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2016-April/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20help%20with%20timestamping&In-Reply-To=%3CCAJ%2BQ1PWJT3DY-poqSKr%3D6ytM0SRgZjdpKTc9oKKGnFefee1hxg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003583.html">
   <LINK REL="Next"  HREF="003622.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] help with timestamping</H1>
    <B>Alex Samad</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20help%20with%20timestamping&In-Reply-To=%3CCAJ%2BQ1PWJT3DY-poqSKr%3D6ytM0SRgZjdpKTc9oKKGnFefee1hxg%40mail.gmail.com%3E"
       TITLE="[openssl-users] help with timestamping">alex at samad.com.au
       </A><BR>
    <I>Fri Apr 22 22:54:38 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="003583.html">[openssl-users] help with timestamping
</A></li>
        <LI>Next message: <A HREF="003622.html">[openssl-users] help with timestamping
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3592">[ date ]</a>
              <a href="thread.html#3592">[ thread ]</a>
              <a href="subject.html#3592">[ subject ]</a>
              <a href="author.html#3592">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Here is a dump.

I can see the CN - but I could see that before.

There is also a RSA - maybe a signature or maybe is the public key for the cert.

I would expect to see some signed data (sha + symantec cert + time)
and also the public cert ( and maybe the intermediaries..)


    &lt;30 82 03 AB&gt;
  0 939: SEQUENCE {
    &lt;30 03&gt;
  4   3:   SEQUENCE {
    &lt;02 01&gt;
  6   1:     INTEGER 0
       :     }
    &lt;30 82 03 A2&gt;
  9 930:   SEQUENCE {
    &lt;06 09&gt;
 13   9:     OBJECT IDENTIFIER signedData (1 2 840 113549 1 7 2)
       :       (PKCS #7)
    &lt;A0 82 03 93&gt;
 24 915:     [0] {
    &lt;30 82 03 8F&gt;
 28 911:       SEQUENCE {
    &lt;02 01&gt;
 32   1:         INTEGER 3
    &lt;31 0D&gt;
 35  13:         SET {
    &lt;30 0B&gt;
 37  11:           SEQUENCE {
    &lt;06 09&gt;
 39   9:             OBJECT IDENTIFIER sha-256 (2 16 840 1 101 3 4 2 1)
       :               (NIST Algorithm)
       :             }
       :           }
    &lt;30 82 01 1B&gt;
 50 283:         SEQUENCE {
    &lt;06 0B&gt;
 54  11:           OBJECT IDENTIFIER tSTInfo (1 2 840 113549 1 9 16 1 4)
       :             (S/MIME Content Types)
    &lt;A0 82 01 0A&gt;
 67 266:           [0] {
    &lt;04 82 01 06&gt;
 71 262:             OCTET STRING, encapsulates {
    &lt;30 82 01 02&gt;
 75 258:               SEQUENCE {
    &lt;02 01&gt;
 79   1:                 INTEGER 1
    &lt;06 0B&gt;
 82  11:                 OBJECT IDENTIFIER '2 16 840 1 113733 1 7 23 3'
    &lt;30 31&gt;
 95  49:                 SEQUENCE {
    &lt;30 0D&gt;
 97  13:                   SEQUENCE {
    &lt;06 09&gt;
 99   9:                     OBJECT IDENTIFIER sha-256 (2 16 840 1 101 3 4 2 1)
       :                       (NIST Algorithm)
    &lt;05 00&gt;
110   0:                     NULL
       :                     }
    &lt;04 20&gt;
112  32:                   OCTET STRING
       :                     8C 6D 95 5B E0 CD 8B C9    .m.[....
       :                     DF 8C AB 57 45 C4 69 E6    ...WE.i.
       :                     7A B9 CE CB 14 8F 55 25    z.....U%
       :                     91 2E 57 37 3E 5C B8 D5
       :                   }
    &lt;02 14&gt;
146  20:                 INTEGER
       :                   57 0B 9C 3A 11 CA 31 8E    W..:..1.
       :                   24 78 D3 68 0C 0F EF D9    $x.h....
       :                   23 8E 06 AB                #...
    &lt;18 0F&gt;
168  15:                 GeneralizedTime 19/04/2016 03:52:25 GMT
    &lt;30 03&gt;
185   3:                 SEQUENCE {
    &lt;02 01&gt;
187   1:                   INTEGER 30
       :                   }
    &lt;02 08&gt;
190   8:                 INTEGER 58 0E 59 D8 7F 39 6B 25
    &lt;A0 81 86&gt;
200 134:                 [0] {
    &lt;A4 81 83&gt;
203 131:                   [4] {
    &lt;30 81 80&gt;
206 128:                     SEQUENCE {
    &lt;31 0B&gt;
209  11:                       SET {
    &lt;30 09&gt;
211   9:                         SEQUENCE {
    &lt;06 03&gt;
213   3:                           OBJECT IDENTIFIER countryName (2 5 4 6)
       :                             (X.520 DN component)
    &lt;13 02&gt;
218   2:                           PrintableString 'US'
       :                           }
       :                         }
    &lt;31 1D&gt;
222  29:                       SET {
    &lt;30 1B&gt;
224  27:                         SEQUENCE {
    &lt;06 03&gt;
226   3:                           OBJECT IDENTIFIER organizationName (2 5 4 10)
       :                             (X.520 DN component)
    &lt;13 14&gt;
231  20:                           PrintableString 'Symantec Corporation'
       :                           }
       :                         }
    &lt;31 1F&gt;
253  31:                       SET {
    &lt;30 1D&gt;
255  29:                         SEQUENCE {
    &lt;06 03&gt;
257   3:                           OBJECT IDENTIFIER
       :                             organizationalUnitName (2 5 4 11)
       :                             (X.520 DN component)
    &lt;13 16&gt;
262  22:                           PrintableString 'Symantec Trust Network'
       :                           }
       :                         }
    &lt;31 31&gt;
286  49:                       SET {
    &lt;30 2F&gt;
288  47:                         SEQUENCE {
    &lt;06 03&gt;
290   3:                           OBJECT IDENTIFIER commonName (2 5 4 3)
       :                             (X.520 DN component)
    &lt;13 28&gt;
295  40:                           PrintableString 'Symantec SHA256
TimeStamping Signer - G1'
       :                           }
       :                         }
       :                       }
       :                     }
       :                   }
       :                 }
       :               }
       :             }
       :           }
    &lt;31 82 02 5A&gt;
337 602:         SET {
    &lt;30 82 02 56&gt;
341 598:           SEQUENCE {
    &lt;02 01&gt;
345   1:             INTEGER 1
    &lt;30 81 8B&gt;
348 139:             SEQUENCE {
    &lt;30 77&gt;
351 119:               SEQUENCE {
    &lt;31 0B&gt;
353  11:                 SET {
    &lt;30 09&gt;
355   9:                   SEQUENCE {
    &lt;06 03&gt;
357   3:                     OBJECT IDENTIFIER countryName (2 5 4 6)
       :                       (X.520 DN component)
    &lt;13 02&gt;
362   2:                     PrintableString 'US'
       :                     }
       :                   }
    &lt;31 1D&gt;
366  29:                 SET {
    &lt;30 1B&gt;
368  27:                   SEQUENCE {
    &lt;06 03&gt;
370   3:                     OBJECT IDENTIFIER organizationName (2 5 4 10)
       :                       (X.520 DN component)
    &lt;13 14&gt;
375  20:                     PrintableString 'Symantec Corporation'
       :                     }
       :                   }
    &lt;31 1F&gt;
397  31:                 SET {
    &lt;30 1D&gt;
399  29:                   SEQUENCE {
    &lt;06 03&gt;
401   3:                     OBJECT IDENTIFIER organizationalUnitName (2 5 4 11)
       :                       (X.520 DN component)
    &lt;13 16&gt;
406  22:                     PrintableString 'Symantec Trust Network'
       :                     }
       :                   }
    &lt;31 28&gt;
430  40:                 SET {
    &lt;30 26&gt;
432  38:                   SEQUENCE {
    &lt;06 03&gt;
434   3:                     OBJECT IDENTIFIER commonName (2 5 4 3)
       :                       (X.520 DN component)
    &lt;13 1F&gt;
439  31:                     PrintableString 'Symantec SHA256 TimeStamping CA'
       :                     }
       :                   }
       :                 }
    &lt;02 10&gt;
472  16:               INTEGER 54 F3 7D A1 71 67 51 BC 6A 8D 0A D2 74
B2 8B 13
       :               }
    &lt;30 0B&gt;
490  11:             SEQUENCE {
    &lt;06 09&gt;
492   9:               OBJECT IDENTIFIER sha-256 (2 16 840 1 101 3 4 2 1)
       :                 (NIST Algorithm)
       :               }
    &lt;A0 81 A4&gt;
503 164:             [0] {
    &lt;30 1A&gt;
506  26:               SEQUENCE {
    &lt;06 09&gt;
508   9:                 OBJECT IDENTIFIER contentType (1 2 840 113549 1 9 3)
       :                   (PKCS #9)
    &lt;31 0D&gt;
519  13:                 SET {
    &lt;06 0B&gt;
521  11:                   OBJECT IDENTIFIER tSTInfo (1 2 840 113549 1 9 16 1 4)
       :                     (S/MIME Content Types)
       :                   }
       :                 }
    &lt;30 1C&gt;
534  28:               SEQUENCE {
    &lt;06 09&gt;
536   9:                 OBJECT IDENTIFIER signingTime (1 2 840 113549 1 9 5)
       :                   (PKCS #9)
    &lt;31 0F&gt;
547  15:                 SET {
    &lt;17 0D&gt;
549  13:                   UTCTime 19/04/2016 03:52:25 GMT
       :                   }
       :                 }
    &lt;30 2F&gt;
564  47:               SEQUENCE {
    &lt;06 09&gt;
566   9:                 OBJECT IDENTIFIER messageDigest (1 2 840 113549 1 9 4)
       :                   (PKCS #9)
    &lt;31 22&gt;
577  34:                 SET {
    &lt;04 20&gt;
579  32:                   OCTET STRING
       :                     98 1B CF E1 5D 96 79 D6    ....].y.
       :                     47 53 3E 27 A1 0C 57 4E    GS&gt;'..WN
       :                     62 48 8E 43 F8 B5 17 D4    bH.C....
       :                     1C 8F 9A 86 ED D7 A6 B4
       :                   }
       :                 }
    &lt;30 37&gt;
613  55:               SEQUENCE {
    &lt;06 0B&gt;
615  11:                 OBJECT IDENTIFIER
       :                   signingCertificateV2 (1 2 840 113549 1 9 16 2 47)
       :                   (S/MIME Authenticated Attributes)
    &lt;31 28&gt;
628  40:                 SET {
    &lt;30 26&gt;
630  38:                   SEQUENCE {
    &lt;30 24&gt;
632  36:                     SEQUENCE {
    &lt;30 22&gt;
634  34:                       SEQUENCE {
    &lt;04 20&gt;
636  32:                         OCTET STRING
       :                           82 D5 56 DB DB 5D AD 5F    ..V..]._
       :                           A0 7B B6 07 26 A6 D8 6E    .{..&amp;..n
       :                           73 0B 5B B7 29 88 5B B6    s.[.).[.
       :                           DE 4F F2 75 29 02 2C FC
       :                         }
       :                       }
       :                     }
       :                   }
       :                 }
       :               }
    &lt;30 0B&gt;
670  11:             SEQUENCE {
    &lt;06 09&gt;
672   9:               OBJECT IDENTIFIER rsaEncryption (1 2 840 113549 1 1 1)
       :                 (PKCS #1)
       :               }
    &lt;04 82 01 00&gt;
683 256:             OCTET STRING
       :               77 60 BE 64 F1 4C 04 B9    w`.d.L..
       :               4D 64 39 59 DC 53 27 02    Md9Y.S'.
       :               06 1F 0C C7 31 EC 5B A2    ....1.[.
       :               79 FB CA A3 07 DE D3 E6    y.......
       :               88 CE 84 37 4C 20 EF DF    ...7L ..
       :               9B BB D4 0B 6F DC 42 05    ....o.B.
       :               DA 8D 22 EF 24 A8 46 68    ..&quot;.$.Fh
       :               79 DA CB B5 A9 CD F6 7E    y......~
       :               D5 B8 D4 DD B4 44 5F 40    .....D_@
       :               0A A2 59 C8 3B 2C 52 6F    ..Y.;,Ro
       :               BE 88 6C D3 A4 F6 3C B1    ..l...&lt;.
       :               52 27 25 E3 E9 6F 4A 2B    R'%..oJ+
       :               C6 C4 CD EA 73 65 6C 04    ....sel.
       :               9A A4 79 4E A4 95 F4 F7    ..yN....
       :               1C C6 2E E8 D3 4B 01 8F    .....K..
       :               F2 0B 80 6C 28 67 3E 10    ...l(g&gt;.
       :               D7 76 1E C5 4E BF 87 37    .v..N..7
       :               CB 99 51 81 74 5C 50 57    ..Q.t\PW
       :               80 3F 5D 3E 84 76 12 0A    .?]&gt;.v..
       :               B0 A3 99 DF E5 3B A4 8F    .....;..
       :               DE 04 50 A8 E6 D0 00 6D    ..P....m
       :               61 21 B1 A9 A9 D6 05 79    a!.....y
       :               0A 00 FA D5 1D A6 D6 F8    ........
       :               6A 22 07 E5 BC 01 C1 E0    j&quot;......
       :               10 09 BD 92 09 B5 B7 29    .......)
       :               8B 6A 4D 28 C4 63 7A 4C    .jM(.czL
       :               8E 7A AF 87 5D BE A4 BD    .z..]...
       :               C1 20 9A D0 82 57 03 21    . ...W.!
       :               F3 E2 6F F5 44 22 F9 27    ..o.D&quot;.'
       :               41 9C 66 27 BB 52 39 E2    A.f'.R9.
       :               4B C8 2B 82 58 AC 0E AF    K.+.X...
       :               8D AE A5 C7 A5 1A A3 5E
       :             }
       :           }
       :         }
       :       }
       :     }
       :   }

On 19 April 2016 at 14:29, Jakob Bohm &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">jb-openssl at wisemo.com</A>&gt; wrote:
&gt;<i> On 19/04/2016 05:55, Alex Samad wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hi
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have a SHA.sha file
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> /usr/bin/openssl ts -query -data SHA.sha -sha256 | /usr/bin/curl -s -H
</I>&gt;&gt;<i> Content-Type:application/timestamp-query --data-binary @-
</I>&gt;&gt;<i> <A HREF="http://sha256timestamp.ws.symantec.com/sha256/timestamp">http://sha256timestamp.ws.symantec.com/sha256/timestamp</A> &gt; SHA.sha.tsr
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> /usr/bin/openssl ts -reply -in SHA.sha.tsr -text  &gt; SHA.sha.ts.txt
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> cat SHA.sha.ts.txt
</I>&gt;&gt;<i> Status info:
</I>&gt;&gt;<i> Status: Granted.
</I>&gt;&gt;<i> Status description: unspecified
</I>&gt;&gt;<i> Failure info: unspecified
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> TST info:
</I>&gt;&gt;<i> Version: 1
</I>&gt;&gt;<i> Policy OID: 2.16.840.1.113733.1.7.23.3
</I>&gt;&gt;<i> Hash Algorithm: sha256
</I>&gt;&gt;<i> Message data:
</I>&gt;&gt;<i>      0000 - 8c 6d 95 5b e0 cd 8b c9-df 8c ab 57 45 c4 69 e6
</I>&gt;&gt;<i> .m.[.......WE.i.
</I>&gt;&gt;<i>      0010 - 7a b9 ce cb 14 8f 55 25-91 2e 57 37 3e 5c b8 d5
</I>&gt;&gt;<i> z.....U%..W7&gt;\..
</I>&gt;&gt;<i> Serial number: 0x570B9C3A11CA318E2478D3680C0FEFD9238E06AB
</I>&gt;&gt;<i> Time stamp: Apr 19 03:52:25 2016 GMT
</I>&gt;&gt;<i> Accuracy: 0x1E seconds, unspecified millis, unspecified micros
</I>&gt;&gt;<i> Ordering: no
</I>&gt;&gt;<i> Nonce: 0x580E59D87F396B25
</I>&gt;&gt;<i> TSA: DirName:/C=US/O=Symantec Corporation/OU=Symantec Trust
</I>&gt;&gt;<i> Network/CN=Symantec SHA256 TimeStamping Signer - G1
</I>&gt;&gt;<i> Extensions:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> But when I go to verify it
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   openssl ts -verify -data SHA.sha -in SHA.sha.tsr
</I>&gt;&gt;<i> Verification: FAILED
</I>&gt;&gt;<i> 140569777235784:error:2107C080:PKCS7
</I>&gt;&gt;<i> routines:PKCS7_get0_signers:signer certificate not
</I>&gt;&gt;<i> found:pk7_smime.c:476:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> is this because I didn't provide a cert to sign it with ?
</I>&gt;<i>
</I>&gt;<i> No, it is because it cannot find the certificate that Symantec
</I>&gt;<i> used to sign the response, specifically the certificate with
</I>&gt;<i> Subject name &quot;/C=US/O=Symantec Corporation/OU=Symantec Trust
</I>&gt;<i> Network/CN=Symantec SHA256 TimeStamping Signer - G1&quot;.
</I>&gt;<i>
</I>&gt;<i> I am kind of disappointed in how little detail is included in
</I>&gt;<i> the output from ts -reply -text, I expected it to output all
</I>&gt;<i> the fields, similar to what other openssl commands do when
</I>&gt;<i> passed the -text option.
</I>&gt;<i>
</I>&gt;<i> So I guess the next step would be to dump SHA.sha.tsr using
</I>&gt;<i> Peter Gutmann's dumpasn1.c program, something like
</I>&gt;<i>
</I>&gt;<i> openssl base64 -d -in SHA.sha.tsr -out SHA.sha.tsr.bin
</I>&gt;<i> dumpasn1 -v SHA.sha.tsr.bin
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Enjoy
</I>&gt;<i>
</I>&gt;<i> Jakob
</I>&gt;<i> --
</I>&gt;<i> Jakob Bohm, CIO, Partner, WiseMo A/S.  <A HREF="https://www.wisemo.com">https://www.wisemo.com</A>
</I>&gt;<i> Transformervej 29, 2860 S&#248;borg, Denmark.  Direct +45 31 13 16 10
</I>&gt;<i> This public discussion message is non-binding and may contain errors.
</I>&gt;<i> WiseMo - Remote Service Management for PCs, Phones and Embedded
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> openssl-users mailing list
</I>&gt;<i> To unsubscribe: <A HREF="../../../mailman/listinfo/openssl-users.html">https://mta.openssl.org/mailman/listinfo/openssl-users</A>
</I></PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003583.html">[openssl-users] help with timestamping
</A></li>
	<LI>Next message: <A HREF="003622.html">[openssl-users] help with timestamping
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3592">[ date ]</a>
              <a href="thread.html#3592">[ thread ]</a>
              <a href="subject.html#3592">[ subject ]</a>
              <a href="author.html#3592">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
