<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> I have finally figured out how to export Private Key from Fortigate firewall and successfully install Godaddy Wildcard SSL certificate in UniFi Cloud Key Gen 2 Plus Network Controller
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2022-October/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20I%20have%20finally%20figured%20out%20how%20to%20export%20Private%20Key%20from%20Fortigate%0A%20firewall%20and%20successfully%20install%20Godaddy%20Wildcard%20SSL%20certificate%20in%20UniFi%0A%20Cloud%20Key%20Gen%202%20Plus%20Network%20Controller&In-Reply-To=%3CCAD3upLtTGeakXE883-D8TvHHFsCxVQVv8GdK%3DSQx6_E6jrQHdA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015566.html">
   <LINK REL="Next"  HREF="015563.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>I have finally figured out how to export Private Key from Fortigate firewall and successfully install Godaddy Wildcard SSL certificate in UniFi Cloud Key Gen 2 Plus Network Controller</H1>
    <B>Turritopsis Dohrnii Teo En Ming</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20I%20have%20finally%20figured%20out%20how%20to%20export%20Private%20Key%20from%20Fortigate%0A%20firewall%20and%20successfully%20install%20Godaddy%20Wildcard%20SSL%20certificate%20in%20UniFi%0A%20Cloud%20Key%20Gen%202%20Plus%20Network%20Controller&In-Reply-To=%3CCAD3upLtTGeakXE883-D8TvHHFsCxVQVv8GdK%3DSQx6_E6jrQHdA%40mail.gmail.com%3E"
       TITLE="I have finally figured out how to export Private Key from Fortigate firewall and successfully install Godaddy Wildcard SSL certificate in UniFi Cloud Key Gen 2 Plus Network Controller">tdtemccnp at gmail.com
       </A><BR>
    <I>Wed Oct 26 13:50:32 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015566.html">Forthcoming OpenSSL Bug Fix Release
</A></li>
        <LI>Next message (by thread): <A HREF="015563.html">SSL_read empty -&gt; close?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15558">[ date ]</a>
              <a href="thread.html#15558">[ thread ]</a>
              <a href="subject.html#15558">[ subject ]</a>
              <a href="author.html#15558">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Subject: I have finally figured out how to export Private Key from
Fortigate firewall and successfully install Godaddy Wildcard SSL
certificate in UniFi Cloud Key Gen 2 Plus Network Controller

Good day from Singapore,

Author: Mr. Turritopsis Dohrnii Teo En Ming
Country: Singapore
Date: 26 Oct 2022 Wednesday

I have finally figured out how to export Private Key from Fortigate
firewall and successfully install Godaddy Wildcard SSL certificate in UniFi
Cloud Key Gen 2 Plus Network Controller because I have finally found the
correct reference guides! Please refer to the following list.

Reference Guides
=================

Youtube video: Ubiquiti Networks UniFi OS SSL Certificate Installation
Link: <A HREF="https://www.youtube.com/watch?v=WxhY71ebc9o">https://www.youtube.com/watch?v=WxhY71ebc9o</A>

Guide: Extracting Private Key from FortiGate Firewall
Link:
<A HREF="https://infosecmonkey.com/extracting-private-key-from-fortigate-firewall/">https://infosecmonkey.com/extracting-private-key-from-fortigate-firewall/</A>

Guide: Extracting private key from FortiGate SSL Certificates
Link:
<A HREF="https://www.linkedin.com/pulse/extracting-private-key-from-fortigate-ssl-kuganesan-srijeyanthan">https://www.linkedin.com/pulse/extracting-private-key-from-fortigate-ssl-kuganesan-srijeyanthan</A>

Guide: How to decrypt an RSA private key and then use it in kyrtool to
merge the SSL certificates.
Link:
<A HREF="https://support.hcltechsw.com/csm?id=kb_article&amp;sysparm_article=KB0098900">https://support.hcltechsw.com/csm?id=kb_article&amp;sysparm_article=KB0098900</A>

Guide: How to Fix an Encrypted SSL Private Key
Link: <A HREF="https://serverpilot.io/docs/how-to-fix-an-encrypted-ssl-private-key/">https://serverpilot.io/docs/how-to-fix-an-encrypted-ssl-private-key/</A>

DETAILED INSTRUCTIONS FROM TEO EN MING
=======================================

Login to the Fortigate 201F firewall and run the following commands using
CLI.

config vpn certificate local

edit &lt;certificate-name&gt;

show full

You will see something like:

-----BEGIN ENCRYPTED PRIVATE KEY-----
&lt;---snipped---&gt;
-----END ENCRYPTED PRIVATE KEY-----

Save the above encrypted private key as encrypted.txt in notepad or
notepad++ in Windows Server.

Then decrypt the encrypted private key using the openssl linux command.

openssl rsa -in encrypted.txt -out plain.txt

Download and install Keystore Explorer in Windows Server.

Launch KeyStore Explorer 5.5.1.

Click Create a new KeyStore.

Click JKS.

Click OK.

Click Import Key Pair.

Click OpenSSL.

Click OK.

Uncheck Encrypted Private Key.

Browse OpenSSL Private Key File. (plain.txt)

Browse Certificate(s) File. (chain.crt generated from Godaddy Wildcard SSL
certificate)

Click Import.

Enter Alias: unifi

Click OK.

Enter New Password: aircontrolenterprise

Confirm New Password: aircontrolenterprise

Click OK.

Click OK.

Click Save.

Enter New Password: aircontrolenterprise

Confirm New Password: aircontrolenterprise

Save KeyStore As: keystore (filename without extension)

Click Save.

Launch WinSCP in Windows Server.

Transfer keystore file to /srv/unifi/data.

Browse to /data/unifi-core/config. Create backup folder.

Move default/original unifi-core.crt and unifi-core.key to above backup
folder.

Upload plain.txt to /data/unifi-core/config as unifi-core.key.

Upload chain.crt (generated from Godaddy Wildcard SSL certificate) to
/data/unifi-core/config as unifi-core.crt

Reboot UniFi Cloud Key Gen 2 Plus network controller. You MUST reboot for
it to take effect!

SUCCESS!

Browse to <A HREF="https://cloudkey.teo-en-ming-corp.com">https://cloudkey.teo-en-ming-corp.com</A> on your favorite web
browser. You should see a padlock icon on the browser address bar. This
means that the Wildcard SSL certificate was installed correctly.

I started doing it at 5.00 PM and completed doing it at 6.00 PM Singapore
time on 26 Oct 2022 Wednesday.

Regards,

Mr. Turritopsis Dohrnii Teo En Ming
Targeted Individual in Singapore
Blogs:
<A HREF="https://tdtemcerts.blogspot.com">https://tdtemcerts.blogspot.com</A>
<A HREF="https://tdtemcerts.wordpress.com">https://tdtemcerts.wordpress.com</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://mta.openssl.org/pipermail/openssl-users/attachments/20221026/486cd8ff/attachment.htm">https://mta.openssl.org/pipermail/openssl-users/attachments/20221026/486cd8ff/attachment.htm</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015566.html">Forthcoming OpenSSL Bug Fix Release
</A></li>
	<LI>Next message (by thread): <A HREF="015563.html">SSL_read empty -&gt; close?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15558">[ date ]</a>
              <a href="thread.html#15558">[ thread ]</a>
              <a href="subject.html#15558">[ subject ]</a>
              <a href="author.html#15558">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
