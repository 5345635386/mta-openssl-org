<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] DTLS for SCTP connections
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2017-February/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20DTLS%20for%20SCTP%20connections&In-Reply-To=%3CCAF7NSfQBYFMcq9Mr1oRk7E2uzohjUoXPzY8pTVX2FMZ%2BF58osA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005326.html">
   <LINK REL="Next"  HREF="005334.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] DTLS for SCTP connections</H1>
    <B>mahesh gs</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20DTLS%20for%20SCTP%20connections&In-Reply-To=%3CCAF7NSfQBYFMcq9Mr1oRk7E2uzohjUoXPzY8pTVX2FMZ%2BF58osA%40mail.gmail.com%3E"
       TITLE="[openssl-users] DTLS for SCTP connections">mahesh116 at gmail.com
       </A><BR>
    <I>Fri Feb 24 09:31:36 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="005326.html">[openssl-users] DTLS for SCTP connections
</A></li>
        <LI>Next message: <A HREF="005334.html">[openssl-users] DTLS for SCTP connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5333">[ date ]</a>
              <a href="thread.html#5333">[ thread ]</a>
              <a href="subject.html#5333">[ subject ]</a>
              <a href="author.html#5333">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I did some more search regarding this problem and found that its a defect
in kernel SCTP. OS was built with linux kernel version 2.6 which is quite
old.

Defect Link : <A HREF="https://sourceforge.net/p/lksctp/mailman/message/27729264/">https://sourceforge.net/p/lksctp/mailman/message/27729264/</A>

I upgraded to RHEL 7.1 and the problem resolved.

Thanks for your support.

On Thu, Feb 23, 2017 at 10:43 AM, mahesh gs &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">mahesh116 at gmail.com</A>&gt; wrote:

&gt;<i> Hi Michael,
</I>&gt;<i>
</I>&gt;<i> I am using &quot;Red Hat Enterprise Linux Server release 6.4 (Santiago)&quot; and
</I>&gt;<i> openssl version is 1.1.0.
</I>&gt;<i>
</I>&gt;<i> SCTP version :
</I>&gt;<i>
</I>&gt;<i> [<A HREF="../../../mailman/listinfo/openssl-users.html">root at localhost</A> DIAMETER]# rpm -qa | grep -i &quot;sctp&quot;
</I>&gt;<i> *lksctp-tools-1.0.10-5.el6.x86_64*
</I>&gt;<i> [<A HREF="../../../mailman/listinfo/openssl-users.html">root at localhost</A> DIAMETER]# rpm -qi lksctp-tools-1.0.10-5.el6.x86_64
</I>&gt;<i> Name        : lksctp-tools                 Relocations: (not relocatable)
</I>&gt;<i> Version     : 1.0.10                            Vendor: Red Hat, Inc.
</I>&gt;<i> Release     : 5.el6                         *Build Date: Mon 22 Feb 2010
</I>&gt;<i> 12:24:33 PM CET*
</I>&gt;<i> Install Date: Wed 08 Feb 2017 10:08:12 AM CET      Build Host:
</I>&gt;<i> hs20-bc1-2.build.redhat.com
</I>&gt;<i> Group       : System Environment/Libraries   Source RPM:
</I>&gt;<i> lksctp-tools-1.0.10-5.el6.src.rpm
</I>&gt;<i> Size        : 203688                           License: GPLv2 and GPLv2+
</I>&gt;<i> and LGPLv2 and BSD
</I>&gt;<i> Signature   : RSA/8, Mon 16 Aug 2010 08:17:01 PM CEST, Key ID
</I>&gt;<i> 199e2f91fd431d51
</I>&gt;<i> Packager    : Red Hat, Inc. &lt;<A HREF="http://bugzilla.redhat.com/bugzilla">http://bugzilla.redhat.com/bugzilla</A>&gt;
</I>&gt;<i> URL         : <A HREF="http://lksctp.sourceforge.net">http://lksctp.sourceforge.net</A>
</I>&gt;<i> Summary     : User-space access to Linux Kernel SCTP
</I>&gt;<i> Description :
</I>&gt;<i> This is the lksctp-tools package for Linux Kernel SCTP (Stream Control
</I>&gt;<i> Transmission Protocol) Reference Implementation.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Mahesh G S
</I>&gt;<i>
</I>&gt;<i> On Wed, Feb 22, 2017 at 8:33 PM, Michael Tuexen &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">Michael.Tuexen at lurchi.</A>
</I>&gt;<i> franken.de&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> &gt; On 22 Feb 2017, at 07:47, mahesh gs &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">mahesh116 at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Hi,
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Thank you for sharing the sample code.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; I tried running SCTP DTLS Echo server and client. I am facing strange
</I>&gt;&gt;<i> problem &quot;ssl_connect&quot; hangs on the client side, even the &quot;ssl_accept&quot; hangs
</I>&gt;&gt;<i> on the server side.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Client side back trace
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; (gdb) bt
</I>&gt;&gt;<i> &gt; #0  0x0000003db4c0ea10 in __recvmsg_nocancel () from
</I>&gt;&gt;<i> /lib64/libpthread.so.0
</I>&gt;&gt;<i> &gt; #1  0x00007ffff7a64dc5 in dgram_sctp_read (b=0x6223f0, out=0x629073
</I>&gt;&gt;<i> &quot;\026\376\377&quot;, outl=17741) at bss_dgram.c:1178
</I>&gt;&gt;<i> &gt; #2  0x00007ffff7a597a9 in BIO_read (b=0x6223f0, out=0x629073,
</I>&gt;&gt;<i> outl=17741) at bio_lib.c:210
</I>&gt;&gt;<i> &gt; #3  0x00007ffff7db80e4 in ssl3_read_n (s=0x622c70, n=13, max=17741,
</I>&gt;&gt;<i> extend=&lt;value optimized out&gt;) at s3_pkt.c:258
</I>&gt;&gt;<i> &gt; #4  0x00007ffff7dcaf75 in dtls1_get_record (s=0x622c70) at d1_pkt.c:676
</I>&gt;&gt;<i> &gt; #5  0x00007ffff7dcb6b8 in dtls1_read_bytes (s=0x622c70, type=22,
</I>&gt;&gt;<i> buf=0x7ffffffedfd0 &quot;\006&quot;, len=12, peek=0) at d1_pkt.c:938
</I>&gt;&gt;<i> &gt; #6  0x00007ffff7dcdda5 in dtls1_get_message_fragment (s=0x622c70,
</I>&gt;&gt;<i> st1=&lt;value optimized out&gt;, stn=4449, max=30, ok=0x7ffffffee09c)
</I>&gt;&gt;<i> &gt;     at d1_both.c:908
</I>&gt;&gt;<i> &gt; #7  0x00007ffff7dce414 in dtls1_get_message (s=0x622c70, st1=4448,
</I>&gt;&gt;<i> stn=4449, mt=14, max=30, ok=0x7ffffffee09c) at d1_both.c:512
</I>&gt;&gt;<i> &gt; #8  0x00007ffff7dacaf9 in ssl3_get_server_done (s=0x622c70) at
</I>&gt;&gt;<i> s3_clnt.c:2458
</I>&gt;&gt;<i> &gt; #9  0x00007ffff7dc8467 in dtls1_connect (s=0x622c70) at d1_clnt.c:466
</I>&gt;&gt;<i> &gt; #10 0x0000000000402f75 in start_client(char*, char*, int, int, int) ()
</I>&gt;&gt;<i> &gt; #11 0x0000000000403573 in main ()
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Server side back trace
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; (gdb) info threads
</I>&gt;&gt;<i> &gt;   2 Thread 0x7ffff793c700 (LWP 20161)  0x0000003db4c0ea2d in recvmsg ()
</I>&gt;&gt;<i> from /lib64/libpthread.so.0
</I>&gt;&gt;<i> &gt; * 1 Thread 0x7ffff793e720 (LWP 20155)  0x0000003db4c0e84d in accept ()
</I>&gt;&gt;<i> from /lib64/libpthread.so.0
</I>&gt;&gt;<i> &gt; (gdb) t 2
</I>&gt;&gt;<i> &gt; [Switching to thread 2 (Thread 0x7ffff793c700 (LWP 20161))]#0
</I>&gt;&gt;<i> 0x0000003db4c0ea2d in recvmsg () from /lib64/libpthread.so.0
</I>&gt;&gt;<i> &gt; (gdb) bt
</I>&gt;&gt;<i> &gt; #0  0x0000003db4c0ea2d in recvmsg () from /lib64/libpthread.so.0
</I>&gt;&gt;<i> &gt; #1  0x00007ffff7a633a6 in BIO_dgram_sctp_wait_for_dry
</I>&gt;&gt;<i> (b=0x7ffff0001930) at bss_dgram.c:1803
</I>&gt;&gt;<i> &gt; #2  0x00007ffff7dc7830 in dtls1_accept (s=0x7ffff00008c0) at
</I>&gt;&gt;<i> d1_srvr.c:403
</I>&gt;&gt;<i> &gt; #3  0x00000000004021ee in connection_handle(void*) ()
</I>&gt;&gt;<i> &gt; #4  0x0000003db4c07851 in start_thread () from /lib64/libpthread.so.0
</I>&gt;&gt;<i> &gt; #5  0x0000003db48e890d in clone () from /lib64/libc.so.6
</I>&gt;&gt;<i> &gt; (gdb)
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; I am also attaching the wireshark trace (port 4443) and a server key
</I>&gt;&gt;<i> for decoding wireshark.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Command used on server side: ./dtls_sctp_echo -L 16.181.38.161 -p 4443
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Command used on client side : ./dtls_sctp_echo -L 16.181.38.161 -p 4443
</I>&gt;&gt;<i> -l 50 -n 5 16.181.38.161
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Thanks in advance for your valuable input
</I>&gt;&gt;<i> I've CCed Irene, who did some testing recently on FreeBSD, where the
</I>&gt;&gt;<i> implementation works.
</I>&gt;&gt;<i> The server is waiting for a sender dry event which it should get.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Which version of OpenSSL are you using and which OS are you using?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Best regards
</I>&gt;&gt;<i> Michael
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Regards,
</I>&gt;&gt;<i> &gt; Mahesh G S
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; On Tue, Feb 21, 2017 at 2:28 PM, Michael Tuexen &lt;
</I>&gt;&gt;<i> <A HREF="../../../mailman/listinfo/openssl-users.html">Michael.Tuexen at lurchi.franken.de</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; &gt; On 21 Feb 2017, at 09:53, mahesh gs &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">mahesh116 at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; Hi,
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; We have a client, server applications that is using SCTP as a
</I>&gt;&gt;<i> transport protocol. We have to secure the connections using DTLS. I am
</I>&gt;&gt;<i> using openssl version 1.0.2 which supports DTLS. But the problem i am
</I>&gt;&gt;<i> facing is usage of DTLS SCTP related API's. Openssl documentation does not
</I>&gt;&gt;<i> clearly explain all the SCTP related API's and usage sequence.
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; I have tried going though internet and found most of the sites
</I>&gt;&gt;<i> redirect to one link for SCTP DTLS sample code. But this link is not
</I>&gt;&gt;<i> working.
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; <A HREF="http://sctp.fh-muenster.de/dtls-samples.html">http://sctp.fh-muenster.de/dtls-samples.html</A>
</I>&gt;&gt;<i> &gt; Try
</I>&gt;&gt;<i> &gt; <A HREF="http://web.archive.org/web/20150617012520/http://sctp.fh-mue">http://web.archive.org/web/20150617012520/http://sctp.fh-mue</A>
</I>&gt;&gt;<i> nster.de/dtls-samples.html
</I>&gt;&gt;<i> &gt; and yes, we need to bring the machine up again.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Best regards
</I>&gt;&gt;<i> &gt; Michael
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; If any of you has an sample code of DTLS adaptation for SCTP. It
</I>&gt;&gt;<i> would immensely help me for my work.
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; Looking forward to your valuable inputs.
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; Thanks,
</I>&gt;&gt;<i> &gt; &gt; Mahesh G S
</I>&gt;&gt;<i> &gt; &gt; --
</I>&gt;&gt;<i> &gt; &gt; openssl-users mailing list
</I>&gt;&gt;<i> &gt; &gt; To unsubscribe: <A HREF="https://mta.openssl.org/mailma">https://mta.openssl.org/mailma</A>
</I>&gt;&gt;<i> n/listinfo/openssl-users
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; --
</I>&gt;&gt;<i> &gt; openssl-users mailing list
</I>&gt;&gt;<i> &gt; To unsubscribe: <A HREF="../../../mailman/listinfo/openssl-users.html">https://mta.openssl.org/mailman/listinfo/openssl-users</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; &lt;log.pcap&gt;&lt;server.key.pem&gt;--
</I>&gt;&gt;<i> &gt; openssl-users mailing list
</I>&gt;&gt;<i> &gt; To unsubscribe: <A HREF="../../../mailman/listinfo/openssl-users.html">https://mta.openssl.org/mailman/listinfo/openssl-users</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> openssl-users mailing list
</I>&gt;&gt;<i> To unsubscribe: <A HREF="../../../mailman/listinfo/openssl-users.html">https://mta.openssl.org/mailman/listinfo/openssl-users</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://mta.openssl.org/pipermail/openssl-users/attachments/20170224/1b4e21ff/attachment.html">http://mta.openssl.org/pipermail/openssl-users/attachments/20170224/1b4e21ff/attachment.html</A>&gt;
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005326.html">[openssl-users] DTLS for SCTP connections
</A></li>
	<LI>Next message: <A HREF="005334.html">[openssl-users] DTLS for SCTP connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5333">[ date ]</a>
              <a href="thread.html#5333">[ thread ]</a>
              <a href="subject.html#5333">[ subject ]</a>
              <a href="author.html#5333">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
