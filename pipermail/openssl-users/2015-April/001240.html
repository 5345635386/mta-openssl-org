<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] Certificate template information
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2015-April/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Certificate%20template%20information&In-Reply-To=%3C20150428080849.E293D449C52%40nhs-pd1e-esg105.ad1.nhs.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001239.html">
   <LINK REL="Next"  HREF="001241.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] Certificate template information</H1>
    <B>Franks Andy (IT Technical Architecture Manager)</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Certificate%20template%20information&In-Reply-To=%3C20150428080849.E293D449C52%40nhs-pd1e-esg105.ad1.nhs.net%3E"
       TITLE="[openssl-users] Certificate template information">Andy.Franks at sath.nhs.uk
       </A><BR>
    <I>Tue Apr 28 08:08:48 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001239.html">[openssl-users] Certificate template information
</A></li>
        <LI>Next message: <A HREF="001241.html">[openssl-users] Certificate template information
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1240">[ date ]</a>
              <a href="thread.html#1240">[ thread ]</a>
              <a href="subject.html#1240">[ subject ]</a>
              <a href="author.html#1240">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Rich, Jakob. 
So, can I use openssl as it is to query the values of the extension on an existing certificate do you think? The usual issue seems that people want to use openssl to form a request and insert the ms CA template name in there otherwise it complains. I don't want to do that, I want to take a presented certificate (to freeradius) and perform something in the shell that will check  against acceptable template names (and that the certificate chains properly, but that's not a problem).
I can't find anything on google citing that someone has achieved it so far.
Thanks again.
Andy

-----Original Message-----
From: openssl-users [mailto:<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>] On Behalf Of Jakob Bohm
Sent: 28 April 2015 04:17
To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
Subject: Re: [openssl-users] Certificate template information

On 28/04/2015 02:59, Salz, Rich wrote:
&gt;&gt;<i> I have need to identify a Microsoft generated certificate's template name, I believe as part of oid 1.3.6.1.4.1.311.21.7
</I>&gt;<i> Where, in a cert OtherName field?
</I>It is an extension.  Microsoft certificate server (their
bundled CA software) puts the name of the &quot;certificate
template&quot; (analogous to an openssl.cnf section) in a
certificate extension, and a few other Microsoft tools
unfortunately check this name in addition to more
relevant conditions such as EKU values etc.

The form I know of can be implemented as follows in
openssl.cnf (in the [sometemplatename_cert] section of
the file):

#     enrollCerttypeExtension (1 3 6 1 4 1 311 20 2)
#   OCTET STRING, encapsulates {
#     BMPString 'SomeTemplateName'
#     }
#   }
1.3.6.1.4.1.311.20.2 = ASN1:BMP:SomeTemplateName

I am not sure about the 1.3.6.1.4.1.311.21.7 OID, but it
might be similar.

Enjoy

Jakob
-- 
Jakob Bohm, CIO, Partner, WiseMo A/S.  <A HREF="http://www.wisemo.com">http://www.wisemo.com</A>
Transformervej 29, 2860 S&#248;borg, Denmark.  Direct +45 31 13 16 10
This public discussion message is non-binding and may contain errors.
WiseMo - Remote Service Management for PCs, Phones and Embedded

_______________________________________________
openssl-users mailing list
To unsubscribe: <A HREF="../../../mailman/listinfo/openssl-users.html">https://mta.openssl.org/mailman/listinfo/openssl-users</A>
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001239.html">[openssl-users] Certificate template information
</A></li>
	<LI>Next message: <A HREF="001241.html">[openssl-users] Certificate template information
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1240">[ date ]</a>
              <a href="thread.html#1240">[ thread ]</a>
              <a href="subject.html#1240">[ subject ]</a>
              <a href="author.html#1240">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
