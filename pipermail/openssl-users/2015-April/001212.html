<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] Can RSA_private_decrypt succeed with the wrong	padding?
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2015-April/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Can%20RSA_private_decrypt%20succeed%20with%20the%20wrong%0A%09padding%3F&In-Reply-To=%3C6378BFFB8601BD438AD9AF3CA610548E59B059FB%40DEWDFEMB16B.global.corp.sap%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001203.html">
   <LINK REL="Next"  HREF="001213.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] Can RSA_private_decrypt succeed with the wrong	padding?</H1>
    <B>Perrow, Graeme</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Can%20RSA_private_decrypt%20succeed%20with%20the%20wrong%0A%09padding%3F&In-Reply-To=%3C6378BFFB8601BD438AD9AF3CA610548E59B059FB%40DEWDFEMB16B.global.corp.sap%3E"
       TITLE="[openssl-users] Can RSA_private_decrypt succeed with the wrong	padding?">graeme.perrow at sap.com
       </A><BR>
    <I>Sat Apr 25 00:49:21 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001203.html">[openssl-users] Web Services Security: SOAP Message Security 1.0 (WS-Security 2004)? Signature Value
</A></li>
        <LI>Next message: <A HREF="001213.html">[openssl-users] Can RSA_private_decrypt succeed with the wrong padding?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1212">[ date ]</a>
              <a href="thread.html#1212">[ thread ]</a>
              <a href="subject.html#1212">[ subject ]</a>
              <a href="author.html#1212">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Using OpenSSL 1.0.1m on 64-bit Windows and Linux.

I have implemented RSA encryption using the RSA_public_encrypt and RSA_private_decrypt functions and various padding types. This is working fine except that in very rare cases, my test fails because decrypting succeeds when it should fail. I'm basically doing this (pseudocode):

RSA_public_encrypt( &quot;abc&quot;, encrypted_data, my_public_key, RSA_PKCS1_OAEP_PADDING );
RSA_private_decrypt( encrypted_data, decrypted_data, my_private_key, RSA_NO_PADDING );

Note that the padding types are different. The vast majority of the time, I get an error from the RSA_private_decrypt call but now and again, it succeeds. The output data is NOT &quot;abc&quot; however, it's seemingly random data. I've seen varying lengths for the output data as well, from 11 bytes to 115.

I don't understand the underlying crypto well enough to know - is it possible for RSA_private_decrypt to be unable to tell that the wrong padding was used, or is this a bug in OpenSSL?

Thanks
Graeme Perrow


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://mta.openssl.org/pipermail/openssl-users/attachments/20150425/dca647de/attachment.html">http://mta.openssl.org/pipermail/openssl-users/attachments/20150425/dca647de/attachment.html</A>&gt;
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001203.html">[openssl-users] Web Services Security: SOAP Message Security 1.0 (WS-Security 2004)? Signature Value
</A></li>
	<LI>Next message: <A HREF="001213.html">[openssl-users] Can RSA_private_decrypt succeed with the wrong padding?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1212">[ date ]</a>
              <a href="thread.html#1212">[ thread ]</a>
              <a href="subject.html#1212">[ subject ]</a>
              <a href="author.html#1212">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
