<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] Working with large DH parameters
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2015-April/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Working%20with%20large%20DH%20parameters&In-Reply-To=%3CSNT152-W688E316B2714C76C3B5924BFE80%40phx.gbl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001242.html">
   <LINK REL="Next"  HREF="001250.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] Working with large DH parameters</H1>
    <B>jack seth</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Working%20with%20large%20DH%20parameters&In-Reply-To=%3CSNT152-W688E316B2714C76C3B5924BFE80%40phx.gbl%3E"
       TITLE="[openssl-users] Working with large DH parameters">bird_112 at hotmail.com
       </A><BR>
    <I>Tue Apr 28 14:26:25 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001242.html">[openssl-users] Certificate template information
</A></li>
        <LI>Next message: <A HREF="001250.html">[openssl-users] Generating RSA PrivateKey and PublicKey	programmaticallly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1249">[ date ]</a>
              <a href="thread.html#1249">[ thread ]</a>
              <a href="subject.html#1249">[ subject ]</a>
              <a href="author.html#1249">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ok I have been doing some experiments with OpenVPN and I can connect using 10000 bit DH parameters.&#160; Any bigger than that up to at least 13824 I get the following 'modulus too large' error on the client log:

TLS_ERROR: BIO read tls_read_plaintext error: error:05066067:Diffie-Hellman routines:COMPUTE_KEY:modulus too large: error:14098005:SSL routines:SSL3_SEND_CLIENT_KEY_EXCHANGE:DH lib
Wed Apr 22 07:08:58 2015 TLS Error: TLS object -&gt; incoming plaintext read error
Wed Apr 22 07:08:58 2015 TLS Error: TLS handshake failed

Something interesting/weird also happened.&#160; I tried to test 10001, 10002, and 10004 bit DH to find the exact place I would get the 'modulus too large' error.&#160; But the server log reported the DH parameters being 10008 instead.&#160; I did a test at 15104 that gave the same error but then I tried two more times and the client just sat at the 'initial packet point' like it does with the 16384 bit parameters.&#160; So somewhere between 13824 and 16384 it switches between the error above and just sitting there 'frozen'.

Questions: 1. Can the modulus error be cured?&#160; 2. Do you think the same modulus error is going on when the client appears to freeze with parameters larger than 13824 or is something else going (i.e. why does it freeze instead of giving the 'modulus error')?&#160; 3. Why does the server log report 10001, 10002, 10004 bit DH as 10008? 		 	   		  
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001242.html">[openssl-users] Certificate template information
</A></li>
	<LI>Next message: <A HREF="001250.html">[openssl-users] Generating RSA PrivateKey and PublicKey	programmaticallly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1249">[ date ]</a>
              <a href="thread.html#1249">[ thread ]</a>
              <a href="subject.html#1249">[ subject ]</a>
              <a href="author.html#1249">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
