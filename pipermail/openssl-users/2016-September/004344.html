<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] Obtaining PKCS7 data length
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2016-September/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Obtaining%20PKCS7%20data%20length&In-Reply-To=%3C0d748762-d20b-8ff3-437d-82d9e4d1d577%40edeca.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004335.html">
   <LINK REL="Next"  HREF="004336.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] Obtaining PKCS7 data length</H1>
    <B>David</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Obtaining%20PKCS7%20data%20length&In-Reply-To=%3C0d748762-d20b-8ff3-437d-82d9e4d1d577%40edeca.net%3E"
       TITLE="[openssl-users] Obtaining PKCS7 data length">lists at edeca.net
       </A><BR>
    <I>Fri Sep  2 22:40:47 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="004335.html">[openssl-users] Obtaining PKCS7 data length
</A></li>
        <LI>Next message: <A HREF="004336.html">[openssl-users] More secure use of DSA?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4344">[ date ]</a>
              <a href="thread.html#4344">[ thread ]</a>
              <a href="subject.html#4344">[ subject ]</a>
              <a href="author.html#4344">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02/09/2016 16:39, Dr. Stephen Henson wrote:
&gt;<i> On Tue, Aug 30, 2016, David wrote:
</I>&gt;&gt;<i> How can I obtain the length of the overall sequence which contains PKCS7
</I>&gt;&gt;<i> signed data?  This is important because the length I already have may be
</I>&gt;&gt;<i> longer than the actual PKCS7 data.
</I>&gt;&gt;<i>
</I>&gt;<i> I'm curious: why do you want that information?
</I>
I am loading PKCS7 data from Windows Portable Executable files which is
used for code signing (&quot;Authenticode&quot;).

The file structure itself gives a length for the relevant data that I
pass to d2i_PKCS7().  However there may be trailing data which does not
relate to the PKCS7 structure.

My requirement for the length is to spot errors or abuse by comparing
the length parsed by OpenSSL to the PE specific headers, e.g. to detect
issues like MS13-098 [1].

&gt;<i> If you want the entire length of the parsed data you can use d2i_PKCS7() to
</I>&gt;<i> parse the buffer: the passed pointer is then incremented to immediately follow
</I>&gt;<i> the PKCS7 structure. You can then get the length by subtracting the
</I>&gt;<i> start of the buffer.
</I>
Thank you - this works fine.

David

1 - <A HREF="https://technet.microsoft.com/en-gb/library/security/2915720">https://technet.microsoft.com/en-gb/library/security/2915720</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004335.html">[openssl-users] Obtaining PKCS7 data length
</A></li>
	<LI>Next message: <A HREF="004336.html">[openssl-users] More secure use of DSA?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4344">[ date ]</a>
              <a href="thread.html#4344">[ thread ]</a>
              <a href="subject.html#4344">[ subject ]</a>
              <a href="author.html#4344">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
