<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] A self-signed CA certificate in the CA files *sometimes* stops verification working
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2016-September/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20A%20self-signed%20CA%20certificate%20in%20the%20CA%20files%0A%20%2Asometimes%2A%20stops%20verification%20working&In-Reply-To=%3C2f9a8291-2c04-749f-7162-36c4a0558d89%40wisemo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004384.html">
   <LINK REL="Next"  HREF="004383.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] A self-signed CA certificate in the CA files *sometimes* stops verification working</H1>
    <B>Jakob Bohm</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20A%20self-signed%20CA%20certificate%20in%20the%20CA%20files%0A%20%2Asometimes%2A%20stops%20verification%20working&In-Reply-To=%3C2f9a8291-2c04-749f-7162-36c4a0558d89%40wisemo.com%3E"
       TITLE="[openssl-users] A self-signed CA certificate in the CA files *sometimes* stops verification working">jb-openssl at wisemo.com
       </A><BR>
    <I>Tue Sep  6 20:52:32 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="004384.html">[openssl-users] A self-signed CA certificate in the CA files *sometimes* stops verification working
</A></li>
        <LI>Next message: <A HREF="004383.html">[openssl-users] A self-signed CA certificate in the CA files *sometimes* stops verification working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4382">[ date ]</a>
              <a href="thread.html#4382">[ thread ]</a>
              <a href="subject.html#4382">[ subject ]</a>
              <a href="author.html#4382">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Could this be related to the recent work to treat the list of
certificates as a SET of potentially relevant certificates
rather than as an ordered list of certificates that must form
the trust chain?

Reading through the 1.1.0 changelog makes it unclear how much
of this standards-compliance fix has been implemented so far,
and how much of it is included in 1.0.2h.

On 06/09/2016 20:10, John Unsworth wrote:
&gt;<i> This seems to me to be very easy to validate by just inserting a self-signed certificate at the front of a CAfile that works.
</I>&gt;<i>
</I>&gt;<i> ...
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: openssl-users [mailto:<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>] On Behalf Of Viktor Dukhovni
</I>&gt;<i> Sent: 06 September 2016 18:47
</I>&gt;<i> To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
</I>&gt;<i> Subject: Re: [openssl-users] A self-signed CA certificate in the CA file *sometimes* stops verification working
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> On Sep 6, 2016, at 11:53 AM, John Unsworth &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">John.Unsworth at synchronoss.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have noticed the following behaviour:
</I>&gt;&gt;<i>   
</I>&gt;&gt;<i> 1 Create a certificate file with two CA certificates, one for the server being connected to (server A) and one for another server (server B).
</I>&gt;&gt;<i> 2 Whichever way the CA certificates are ordered the connect works OK.
</I>&gt;&gt;<i> 3 Add a self-signed CA certificate in the file before the one for server A. The connect fails &#8216;Verify return code: 21 (unable to verify the first certificate)&#8217;.
</I>&gt;&gt;<i> 4 Move the self-signed CA certificate after the one for server A. The connect works OK.
</I>&gt;&gt;<i>   
</I>&gt;&gt;<i> Why should the self-signed certificate affect the connection when the required CA certificate is in the certificate file? Is this a bug?
</I>&gt;<i> You've provided much too little detail for a meaningful answer.
</I>&gt;<i>
</I>&gt;<i> Post the server chain being validated as reported by
</I>&gt;<i>
</I>&gt;<i>     $ openssl s_client -showcerts -connect &lt;server&gt;:443 &gt; chain.pem
</I>&gt;<i>     $ openssl crl2pkcs7 -nocrl -certfile chain.pem |
</I>&gt;<i>       openssl pkcs7 -print_certs
</I>&gt;<i>
</I>&gt;<i> and all three CA certificates.  Do not post any of the private keys.
</I>&gt;<i>
</I>

Enjoy

Jakob
-- 
Jakob Bohm, CIO, Partner, WiseMo A/S.  <A HREF="https://www.wisemo.com">https://www.wisemo.com</A>
Transformervej 29, 2860 S&#248;borg, Denmark.  Direct +45 31 13 16 10
This public discussion message is non-binding and may contain errors.
WiseMo - Remote Service Management for PCs, Phones and Embedded

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004384.html">[openssl-users] A self-signed CA certificate in the CA files *sometimes* stops verification working
</A></li>
	<LI>Next message: <A HREF="004383.html">[openssl-users] A self-signed CA certificate in the CA files *sometimes* stops verification working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4382">[ date ]</a>
              <a href="thread.html#4382">[ thread ]</a>
              <a href="subject.html#4382">[ subject ]</a>
              <a href="author.html#4382">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
