<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] ECDHE-ECDSA certificate returning with no shared	cipher error
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2015-February/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20ECDHE-ECDSA%20certificate%20returning%20with%20no%20shared%0A%09cipher%20error&In-Reply-To=%3CCA%2BmfXPGjF%3D1gYM85F8BJx8bFu7%3DJ%3DjDkUtRb7kKkzhoYw5Jh5g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000416.html">
   <LINK REL="Next"  HREF="000430.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] ECDHE-ECDSA certificate returning with no shared	cipher error</H1>
    <B>Rajeswari K</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20ECDHE-ECDSA%20certificate%20returning%20with%20no%20shared%0A%09cipher%20error&In-Reply-To=%3CCA%2BmfXPGjF%3D1gYM85F8BJx8bFu7%3DJ%3DjDkUtRb7kKkzhoYw5Jh5g%40mail.gmail.com%3E"
       TITLE="[openssl-users] ECDHE-ECDSA certificate returning with no shared	cipher error">raji.kotamraju at gmail.com
       </A><BR>
    <I>Mon Feb  2 02:18:10 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="000416.html">[openssl-users] SSL/TLS sessions of client
</A></li>
        <LI>Next message: <A HREF="000430.html">[openssl-users] ECDHE-ECDSA certificate returning with no	shared	cipher error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#420">[ date ]</a>
              <a href="thread.html#420">[ thread ]</a>
              <a href="subject.html#420">[ subject ]</a>
              <a href="author.html#420">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Openssl users,

Am facing an issue of &quot;no shared cipher&quot; error during SSL Handshake, when
tried to negotiate ECDHE cipher suite.

We are using openssl-1.0.1j version.  Can you please share your thoughts?

Following are the logs during SSL Handshake.

Server has 2 from 0xE29690E0:
0x10B42900:ECDHE-ECDSA-AES256-SHA
0x10B428D0:ECDHE-ECDSA-AES128-SHA
Client sent 2 from 0xE442F5B0:
0x10B42900:ECDHE-ECDSA-AES256-SHA
0x10B428D0:ECDHE-ECDSA-AES128-SHA
rt=0 rte=0 dht=1 ecdht=1 re=1 ree=1 rs=0 ds=0 dhr=0 dhd=0
0:[00000080:00000040:00000089:00000005]0x10B42900:ECDHE-ECDSA-AES256-SHA
rt=0 rte=0 dht=1 ecdht=1 re=1 ree=1 rs=0 ds=0 dhr=0 dhd=0
0:[00000080:00000040:00000089:00000005]0x10B428D0:ECDHE-ECDSA-AES128-SHA


*Feb  2 01:00:46.884: SSL_accept:before/accept initialization
*Feb  2 01:00:46.884: SSL_accept:would block on read in SSLv3 read client
hello B

*Feb  2 01:00:47.892: &lt;&lt;&lt; TLS 1.2 Handshake [length 0092], ClientHello
*Feb  2 01:00:47.892:     01 00 00 8E 03 03 C3 CB 15 58 20 B9 49 1D 73 C7
*Feb  2 01:00:47.892:     F8 C1 4D 31 10 A1 B6 D9 62 9E DF 91 A8 DC 8F 79
*Feb  2 01:00:47.892:     95 79 20 55 AC CF 00 00 06 C0 0A C0 09 00 FF 01
*Feb  2 01:00:47.893:     00 00 5F 00 0B 00 04 03 00 01 02 00 0A 00 34 00
*Feb  2 01:00:47.893:     32 00 0E 00 0D 00 19 00 0B 00 0C 00 18 00 09 00
*Feb  2 01:00:47.893:     0A 00 16 00 17 00 08 00 06 00 07 00 14 00 15 00
*Feb  2 01:00:47.893:     04 00 05 00 12 00 13 00 01 00 02 00 03 00 0F 00
*Feb  2 01:00:47.893:     10 00 11 00 0D 00 16 00 14 06 01 06 03 05 01 05
*Feb  2 01:00:47.893:     03 04 01 04 03 03 01 03 03 02 01 02 03 00 0F 00
*Feb  2 01:00:47.893:     01 01
*Feb  2 01:00:47.893: TLS client extension &quot;EC point formats&quot; (id=11), len=4

*Feb  2 01:00:47.893:     03 00 01 02
*Feb  2 01:00:47.893: TLS client extension &quot;elliptic curves&quot; (id=10), len=52

*Feb  2 01:00:47.893:     00 32 00 0E 00 0D 00 19 00 0B 00 0C 00 18 00 09
*Feb  2 01:00:47.893:     00 0A 00 16 00 17 00 08 00 06 00 07 00 14 00 15
*Feb  2 01:00:47.893:     00 04 00 05 00 12 00 13 00 01 00 02 00 03 00 0F
*Feb  2 01:00:47.893:     00 10 00 11
*Feb  2 01:00:47.893: TLS client extension &quot;signature algorithms&quot; (id=13),
len=22

*Feb  2 01:00:47.893:     00 14 06 01 06 03 05 01 05 03 04 01 04 03 03 01
*Feb  2 01:00:47.893:     03 03 02 01 02 03
*Feb  2 01:00:47.893: TLS client extension &quot;heartbeat&quot; (id=15), len=1

*Feb  2 01:00:47.893:     01

*Feb  2 01:00:47.894: &gt;&gt;&gt; TLS 1.2 Alert [length 0002], fatal
handshake_failure
*Feb  2 01:00:47.894:     02 28
*Feb  2 01:00:47.894:
Router#
*Feb  2 01:00:47.894: SSL3 alert write:fatal:handshake failure
*Feb  2 01:00:47.894: SSL_accept:error in SSLv3 read client hello C
*Feb  2 01:00:47.894: 3854049196:error:1408A0C1:SSL
routines:SSL3_GET_CLIENT_HELLO:no shared cipher  s3_srvr.c:1381:


Have updated with temporary ECDH callback during SSL Server initialization.

ECDSA certificate is being signed using openssl commands.

Am not seeing any issue with RSA baesd ciphers. But only with ECDSA based
ciphers having problem on my setup.

Can you please share will the certificate loading is something different
than RSA?

Thanks,
Rajeswari.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://mta.openssl.org/pipermail/openssl-users/attachments/20150202/c1d6050b/attachment-0001.html">http://mta.openssl.org/pipermail/openssl-users/attachments/20150202/c1d6050b/attachment-0001.html</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000416.html">[openssl-users] SSL/TLS sessions of client
</A></li>
	<LI>Next message: <A HREF="000430.html">[openssl-users] ECDHE-ECDSA certificate returning with no	shared	cipher error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#420">[ date ]</a>
              <a href="thread.html#420">[ thread ]</a>
              <a href="subject.html#420">[ subject ]</a>
              <a href="author.html#420">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
