<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Best Practices for private key files handling
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2022-September/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Best%20Practices%20for%20private%20key%20files%20handling&In-Reply-To=%3Cce4d4673-b7f5-b02c-4153-108322345336%40elyograg.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015409.html">
   <LINK REL="Next"  HREF="015411.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Best Practices for private key files handling</H1>
    <B>Shawn Heisey</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Best%20Practices%20for%20private%20key%20files%20handling&In-Reply-To=%3Cce4d4673-b7f5-b02c-4153-108322345336%40elyograg.org%3E"
       TITLE="Best Practices for private key files handling">openssl at elyograg.org
       </A><BR>
    <I>Thu Sep 15 22:15:14 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015409.html">Best Practices for private key files handling
</A></li>
        <LI>Next message (by thread): <A HREF="015411.html">Best Practices for private key files handling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15410">[ date ]</a>
              <a href="thread.html#15410">[ thread ]</a>
              <a href="subject.html#15410">[ subject ]</a>
              <a href="author.html#15410">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/15/22 15:40, Philip Prindeville wrote:
&gt;<i> I was thinking of the case where the directory containing the keys (as configured) is correctly owned, but contains a symlink pointing outside of that directory somewhere else... say to a file owned by an ordinary user.
</I>&gt;<i>
</I>&gt;<i> In that case, as has been pointed out, it might be sufficient to just pay attention to the owner/group/modes of the file and reject them if:
</I>&gt;<i>
</I>&gt;<i> (1) the file isn't 600 or 400;
</I>&gt;<i> (2) the file isn't owned by root or the app-id that the app runs at.
</I>&gt;<i>
</I>&gt;<i> Do we agree on that?
</I>
Yes, that sounds very good.

That's the potential problem with symlinks.&#160; Rarely should they ever 
point to something that is under the control of an unprivileged user.&#160; 
Exceptions might be in cases where you actually do want a configuration 
for that user to come from a directory that they control ... but that 
should only be done in situations where that input is considered 
untrusted and is stringently validated and sanitized before it is used.

If symlinks are used responsibly, they won't have security risks. In 
general, if the program checks the ownership and permissions of the 
actual file before using it, it shouldn't matter whether there is a 
symlink or not.

Thanks,
Shawn

</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015409.html">Best Practices for private key files handling
</A></li>
	<LI>Next message (by thread): <A HREF="015411.html">Best Practices for private key files handling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15410">[ date ]</a>
              <a href="thread.html#15410">[ thread ]</a>
              <a href="subject.html#15410">[ subject ]</a>
              <a href="author.html#15410">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
