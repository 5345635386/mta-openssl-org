<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Use OpenSSL to decrypt TLS session from PCAP files
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2020-December/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Use%20OpenSSL%20to%20decrypt%20TLS%20session%20from%20PCAP%20files&In-Reply-To=%3CCA%2BMvkHo04LcFNkAGawCh1nT_62M%2B0xXxD2fXuJrZ_v2qR6JrYQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013196.html">
   <LINK REL="Next"  HREF="013200.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Use OpenSSL to decrypt TLS session from PCAP files</H1>
    <B>Oren Shpigel</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Use%20OpenSSL%20to%20decrypt%20TLS%20session%20from%20PCAP%20files&In-Reply-To=%3CCA%2BMvkHo04LcFNkAGawCh1nT_62M%2B0xXxD2fXuJrZ_v2qR6JrYQ%40mail.gmail.com%3E"
       TITLE="Use OpenSSL to decrypt TLS session from PCAP files">orens at nonamesecurity.com
       </A><BR>
    <I>Tue Dec  8 15:28:19 UTC 2020</I>
    <P><UL>
        <LI>Previous message: <A HREF="013196.html">Use OpenSSL to decrypt TLS session from PCAP files
</A></li>
        <LI>Next message: <A HREF="013200.html">Use OpenSSL to decrypt TLS session from PCAP files
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13199">[ date ]</a>
              <a href="thread.html#13199">[ thread ]</a>
              <a href="subject.html#13199">[ subject ]</a>
              <a href="author.html#13199">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, thanks for the answer.

I know wireshark and ssldump have this capability, but I'm looking for a
way to do it in my own software in C++, (using OpenSSL, if possible, but
open to other suggestions as well).

On Tue, Dec 8, 2020 at 4:32 PM Dr. Matthias St. Pierre &lt;
<A HREF="../../../mailman/listinfo/openssl-users.html">Matthias.St.Pierre at ncp-e.com</A>&gt; wrote:

&gt;<i> Do you need to integrate the decryption into your own software, or are
</I>&gt;<i> you just looking for a possibility to monitor and view the traffic?
</I>&gt;<i>
</I>&gt;<i> If it&#8217;s the latter, try and take a look at the SSL decryption support that
</I>&gt;<i> Wireshark provides.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://wiki.wireshark.org/TLS">https://wiki.wireshark.org/TLS</A>
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://www.comparitech.com/net-admin/decrypt-ssl-with-wireshark/">https://www.comparitech.com/net-admin/decrypt-ssl-with-wireshark/</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> hth,
</I>&gt;<i>
</I>&gt;<i> Matthias
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Disclaimer: I haven&#8217;t used it for TLS myself, only for IPsec, and I can&#8217;t
</I>&gt;<i> tell how up-to-date it is, in particular whether it is TLS 1.3 ready.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *[image: NCP engingeering GmbH]* *Dr. Matthias St. Pierre*
</I>&gt;<i>
</I>&gt;<i> Senior Software Engineer
</I>&gt;<i> <A HREF="../../../mailman/listinfo/openssl-users.html">matthias.st.pierre at ncp-e.com</A>
</I>&gt;<i> Phone: +49 911 9968-0
</I>&gt;<i> www.ncp-e.com
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> * Follow us on:* Facebook &lt;<A HREF="https://www.facebook.com/NCPengineering">https://www.facebook.com/NCPengineering</A>&gt; |
</I>&gt;<i> Twitter &lt;<A HREF="https://twitter.com/NCP_engineering">https://twitter.com/NCP_engineering</A>&gt; | Xing
</I>&gt;<i> &lt;<A HREF="https://www.xing.com/companies/ncpengineeringgmbh">https://www.xing.com/companies/ncpengineeringgmbh</A>&gt; | YouTube
</I>&gt;<i> &lt;<A HREF="https://www.youtube.com/user/NCPengineeringGmbH">https://www.youtube.com/user/NCPengineeringGmbH</A>&gt; | LinkedIn
</I>&gt;<i> &lt;<A HREF="http://www.linkedin.com/company/ncp-engineering-inc.?trk=cws-cpw-coname-0-0">http://www.linkedin.com/company/ncp-engineering-inc.?trk=cws-cpw-coname-0-0</A>&gt;
</I>&gt;<i>
</I>&gt;<i> *Headquarters Germany: *NCP engineering GmbH &#8226; Dombuehler Str. 2 &#8226; 90449
</I>&gt;<i> &#8226; Nuremberg
</I>&gt;<i> *North American HQ:* NCP engineering Inc. &#8226; 601 Cleveland Str., Suite
</I>&gt;<i> 501-25 &#8226; Clearwater, FL 33755
</I>&gt;<i>
</I>&gt;<i> Authorized representatives: Peter Soell, Patrick Oliver Graf, Beate
</I>&gt;<i> Dietrich
</I>&gt;<i> Registry Court: Lower District Court of Nuremberg
</I>&gt;<i> Commercial register No.: HRB 7786 Nuremberg, VAT identification No.: DE
</I>&gt;<i> 133557619
</I>&gt;<i>
</I>&gt;<i> This e-mail message including any attachments is for the sole use of the
</I>&gt;<i> intended recipient(s) and may contain privileged or confidential
</I>&gt;<i> information. Any unauthorized review, use, disclosure or distribution is
</I>&gt;<i> prohibited. If you are not the intended recipient, please immediately
</I>&gt;<i> contact the sender by reply e-mail and delete the original message and
</I>&gt;<i> destroy all copies thereof.
</I>&gt;<i>
</I>&gt;<i> &lt;<A HREF="https://www.ncp-e.com/de/aktuelles/events/veranstaltungen">https://www.ncp-e.com/de/aktuelles/events/veranstaltungen</A>&gt;
</I>&gt;<i> &lt;<A HREF="https://www.ncp-e.com/de/aktuelles/events/veranstaltungen">https://www.ncp-e.com/de/aktuelles/events/veranstaltungen</A>&gt;
</I>&gt;<i>
</I>&gt;<i> *From**:* openssl-users &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>&gt; *On Behalf Of
</I>&gt;<i> *Oren Shpigel
</I>&gt;<i> *Sent:* Tuesday, December 8, 2020 3:15 PM
</I>&gt;<i> *To:* <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
</I>&gt;<i> *Subject:* Use OpenSSL to decrypt TLS session from PCAP files
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I generated a PCAP file with TLS session, and I have the matching private
</I>&gt;<i> key used by my HTTPS server.
</I>&gt;<i> The TLS session is not using DH for key exchange, so it should be possible
</I>&gt;<i> to decrypt.
</I>&gt;<i> I know OpenSSL can be used to connect to a socket to &quot;actively&quot; handle the
</I>&gt;<i> TLS session, but is there a way to &quot;passively&quot; decode and decrypt a session?
</I>&gt;<i> How can I &quot;feed&quot; the packets (both directions) into the OpenSSL library?
</I>&gt;<i>
</I>&gt;<i> Thanks!
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://mta.openssl.org/pipermail/openssl-users/attachments/20201208/2cba2004/attachment-0001.html">https://mta.openssl.org/pipermail/openssl-users/attachments/20201208/2cba2004/attachment-0001.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: NCP_logo_2f45208a-c14d-4000-bcd3-1ab400c0e48c.gif
Type: image/gif
Size: 2815 bytes
Desc: not available
URL: &lt;<A HREF="https://mta.openssl.org/pipermail/openssl-users/attachments/20201208/2cba2004/attachment-0001.gif">https://mta.openssl.org/pipermail/openssl-users/attachments/20201208/2cba2004/attachment-0001.gif</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013196.html">Use OpenSSL to decrypt TLS session from PCAP files
</A></li>
	<LI>Next message: <A HREF="013200.html">Use OpenSSL to decrypt TLS session from PCAP files
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13199">[ date ]</a>
              <a href="thread.html#13199">[ thread ]</a>
              <a href="subject.html#13199">[ subject ]</a>
              <a href="author.html#13199">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
