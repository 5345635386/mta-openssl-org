<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Use OpenSSL to decrypt TLS session from PCAP files
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2020-December/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Use%20OpenSSL%20to%20decrypt%20TLS%20session%20from%20PCAP%20files&In-Reply-To=%3C8f9c7ad4-f3cb-38a1-0968-61833bb77462%40openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013199.html">
   <LINK REL="Next"  HREF="013201.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Use OpenSSL to decrypt TLS session from PCAP files</H1>
    <B>Matt Caswell</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Use%20OpenSSL%20to%20decrypt%20TLS%20session%20from%20PCAP%20files&In-Reply-To=%3C8f9c7ad4-f3cb-38a1-0968-61833bb77462%40openssl.org%3E"
       TITLE="Use OpenSSL to decrypt TLS session from PCAP files">matt at openssl.org
       </A><BR>
    <I>Tue Dec  8 15:46:00 UTC 2020</I>
    <P><UL>
        <LI>Previous message: <A HREF="013199.html">Use OpenSSL to decrypt TLS session from PCAP files
</A></li>
        <LI>Next message: <A HREF="013201.html">Use OpenSSL to decrypt TLS session from PCAP files
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13200">[ date ]</a>
              <a href="thread.html#13200">[ thread ]</a>
              <a href="subject.html#13200">[ subject ]</a>
              <a href="author.html#13200">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On 08/12/2020 15:28, Oren Shpigel wrote:
&gt;<i> Hi, thanks for the answer.
</I>&gt;<i> 
</I>&gt;<i> I know wireshark and ssldump have this capability, but I'm looking for a
</I>&gt;<i> way to do it in my own software in C++, (using OpenSSL, if possible, but
</I>&gt;<i> open to other suggestions as well).
</I>
Unfortunately OpenSSL does not support this capability. It obviously
supports all the required low-level crypto primitives to do it - but you
would have to put them together yourself, as well as do all the packet
parsing, etc. This would be ... difficult. :-)

Matt


&gt;<i> 
</I>&gt;<i> On Tue, Dec 8, 2020 at 4:32 PM Dr. Matthias St. Pierre
</I>&gt;<i> &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">Matthias.St.Pierre at ncp-e.com</A> &lt;mailto:<A HREF="../../../mailman/listinfo/openssl-users.html">Matthias.St.Pierre at ncp-e.com</A>&gt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i>     Do you need to integrate the decryption into your own software, or
</I>&gt;<i>     are you just looking for a possibility to monitor and view the
</I>&gt;<i>     traffic?____
</I>&gt;<i> 
</I>&gt;<i>     If it&#8217;s the latter, try and take a look at the SSL decryption
</I>&gt;<i>     support that Wireshark provides. ____
</I>&gt;<i> 
</I>&gt;<i>     __&#160;__
</I>&gt;<i> 
</I>&gt;<i>     <A HREF="https://wiki.wireshark.org/TLS___">https://wiki.wireshark.org/TLS___</A>_
</I>&gt;<i> 
</I>&gt;<i>     <A HREF="https://www.comparitech.com/net-admin/decrypt-ssl-with-wireshark/___">https://www.comparitech.com/net-admin/decrypt-ssl-with-wireshark/___</A>_
</I>&gt;<i> 
</I>&gt;<i>     __&#160;__
</I>&gt;<i> 
</I>&gt;<i>     __&#160;__
</I>&gt;<i> 
</I>&gt;<i>     hth,____
</I>&gt;<i> 
</I>&gt;<i>     Matthias____
</I>&gt;<i> 
</I>&gt;<i>     __&#160;__
</I>&gt;<i> 
</I>&gt;<i>     Disclaimer: I haven&#8217;t used it for TLS myself, only for IPsec, and I
</I>&gt;<i>     can&#8217;t tell how up-to-date it is, in particular whether it is TLS 1.3
</I>&gt;<i>     ready.____
</I>&gt;<i> 
</I>&gt;<i>     __&#160;__
</I>&gt;<i> 
</I>&gt;<i>     &#160;
</I>&gt;<i> 
</I>&gt;<i>     *NCP engingeering GmbH* 	** 	*Dr. Matthias St. Pierre*
</I>&gt;<i> 
</I>&gt;<i>     Senior Software Engineer
</I>&gt;<i>     <A HREF="../../../mailman/listinfo/openssl-users.html">matthias.st.pierre at ncp-e.com</A> &lt;mailto:<A HREF="../../../mailman/listinfo/openssl-users.html">matthias.st.pierre at ncp-e.com</A>&gt;
</I>&gt;<i>     Phone: +49 911 9968-0
</I>&gt;<i>     www.ncp-e.com &lt;<A HREF="http://www.ncp-e.com">http://www.ncp-e.com</A>&gt;
</I>&gt;<i> 
</I>&gt;<i>     *
</I>&gt;<i>     Follow us on:*&#160;Facebook &lt;<A HREF="https://www.facebook.com/NCPengineering">https://www.facebook.com/NCPengineering</A>&gt; |
</I>&gt;<i>     Twitter &lt;<A HREF="https://twitter.com/NCP_engineering">https://twitter.com/NCP_engineering</A>&gt;&#160;| Xing
</I>&gt;<i>     &lt;<A HREF="https://www.xing.com/companies/ncpengineeringgmbh">https://www.xing.com/companies/ncpengineeringgmbh</A>&gt;&#160;| YouTube
</I>&gt;<i>     &lt;<A HREF="https://www.youtube.com/user/NCPengineeringGmbH">https://www.youtube.com/user/NCPengineeringGmbH</A>&gt; | LinkedIn
</I>&gt;<i>     &lt;<A HREF="http://www.linkedin.com/company/ncp-engineering-inc.?trk=cws-cpw-coname-0-0">http://www.linkedin.com/company/ncp-engineering-inc.?trk=cws-cpw-coname-0-0</A>&gt;
</I>&gt;<i> 
</I>&gt;<i>     *Headquarters Germany: *NCP engineering GmbH &#8226; Dombuehler Str. 2 &#8226;
</I>&gt;<i>     90449 &#8226; Nuremberg
</I>&gt;<i>     *North American HQ:* NCP engineering Inc. &#8226; 601 Cleveland Str.,
</I>&gt;<i>     Suite 501-25 &#8226; Clearwater, FL 33755
</I>&gt;<i> 
</I>&gt;<i>     Authorized representatives: Peter Soell, Patrick Oliver Graf, Beate
</I>&gt;<i>     Dietrich
</I>&gt;<i>     Registry Court: Lower District Court of Nuremberg
</I>&gt;<i>     Commercial register No.: HRB 7786 Nuremberg, VAT identification No.:
</I>&gt;<i>     DE 133557619
</I>&gt;<i> 
</I>&gt;<i>     This e-mail message including any attachments is for the sole use of
</I>&gt;<i>     the intended recipient(s) and may contain privileged or confidential
</I>&gt;<i>     information. Any unauthorized review, use, disclosure or
</I>&gt;<i>     distribution is prohibited. If you are not the intended recipient,
</I>&gt;<i>     please immediately contact the sender by reply e-mail and delete the
</I>&gt;<i>     original message and destroy all copies thereof.
</I>&gt;<i> 
</I>&gt;<i>     &lt;<A HREF="https://www.ncp-e.com/de/aktuelles/events/veranstaltungen">https://www.ncp-e.com/de/aktuelles/events/veranstaltungen</A>&gt;&lt;<A HREF="https://www.ncp-e.com/de/aktuelles/events/veranstaltungen">https://www.ncp-e.com/de/aktuelles/events/veranstaltungen</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     *From**:*openssl-users &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>
</I>&gt;<i>     &lt;mailto:<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>&gt;&gt; *On Behalf Of *Oren Shpigel
</I>&gt;<i>     *Sent:* Tuesday, December 8, 2020 3:15 PM
</I>&gt;<i>     *To:* <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A> &lt;mailto:<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>&gt;
</I>&gt;<i>     *Subject:* Use OpenSSL to decrypt TLS session from PCAP files____
</I>&gt;<i> 
</I>&gt;<i>     __&#160;__
</I>&gt;<i> 
</I>&gt;<i>     Hi,&#160;____
</I>&gt;<i> 
</I>&gt;<i>     I generated a PCAP file with TLS session, and I have the matching
</I>&gt;<i>     private key used by my HTTPS server.
</I>&gt;<i>     The TLS session is not using DH for key exchange, so it should be
</I>&gt;<i>     possible to decrypt.
</I>&gt;<i>     I know OpenSSL can be used to connect to a socket to &quot;actively&quot;
</I>&gt;<i>     handle the TLS session, but is there a way to &quot;passively&quot; decode and
</I>&gt;<i>     decrypt a session?
</I>&gt;<i>     How can I &quot;feed&quot; the packets (both directions) into the OpenSSL
</I>&gt;<i>     library?____
</I>&gt;<i> 
</I>&gt;<i>     Thanks!____
</I>&gt;<i> 
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013199.html">Use OpenSSL to decrypt TLS session from PCAP files
</A></li>
	<LI>Next message: <A HREF="013201.html">Use OpenSSL to decrypt TLS session from PCAP files
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13200">[ date ]</a>
              <a href="thread.html#13200">[ thread ]</a>
              <a href="subject.html#13200">[ subject ]</a>
              <a href="author.html#13200">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
