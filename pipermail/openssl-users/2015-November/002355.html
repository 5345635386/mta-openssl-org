<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] Verifying Authenticode timestamp using openssl apis
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2015-November/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Verifying%20Authenticode%20timestamp%20using%20openssl%0A%20apis&In-Reply-To=%3C185179316.7990685.1448361996747.JavaMail.yahoo%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002354.html">
   <LINK REL="Next"  HREF="002356.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] Verifying Authenticode timestamp using openssl apis</H1>
    <B>Leena Soman</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Verifying%20Authenticode%20timestamp%20using%20openssl%0A%20apis&In-Reply-To=%3C185179316.7990685.1448361996747.JavaMail.yahoo%40mail.yahoo.com%3E"
       TITLE="[openssl-users] Verifying Authenticode timestamp using openssl apis">leenanand at yahoo.com
       </A><BR>
    <I>Tue Nov 24 10:46:36 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002354.html">[openssl-users] Verifying Authenticode timestamp using openssl apis
</A></li>
        <LI>Next message: <A HREF="002356.html">[openssl-users] openssl des-ede3-cbc does not match with Java one
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2355">[ date ]</a>
              <a href="thread.html#2355">[ thread ]</a>
              <a href="subject.html#2355">[ subject ]</a>
              <a href="author.html#2355">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Matt,Here is an excerpt of openssl asn1parse ------------------------------------------------------------------------------------------------3588:d=5&#160; hl=4 l=4940 cons: cont [ 1 ]
&#160;3592:d=6&#160; hl=4 l=4936 cons: SEQUENCE
&#160;3596:d=7&#160; hl=2 l=&#160; 10 prim: OBJECT&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :1.3.6.1.4.1.311.3.3.1
&#160;3608:d=7&#160; hl=4 l=4920 cons: SET
&#160;3612:d=8&#160; hl=4 l=4916 cons: SEQUENCE
&#160;3616:d=9&#160; hl=2 l=&#160;&#160; 9 prim: OBJECT&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :pkcs7-signedData
&#160;3627:d=9&#160; hl=4 l=4901 cons: cont [ 0 ]
&#160;3631:d=10 hl=4 l=4897 cons: SEQUENCE
&#160;3635:d=11 hl=2 l=&#160;&#160; 1 prim: INTEGER&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :03
&#160;3638:d=11 hl=2 l=&#160; 15 cons: SET
&#160;3640:d=12 hl=2 l=&#160; 13 cons: SEQUENCE
&#160;3642:d=13 hl=2 l=&#160;&#160; 9 prim: OBJECT&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :sha256
&#160;3653:d=13 hl=2 l=&#160;&#160; 0 prim: NULL
&#160;3655:d=11 hl=4 l= 316 cons: SEQUENCE
&#160;3659:d=12 hl=2 l=&#160; 11 prim: OBJECT&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :id-smime-ct-TSTInfo
&#160;3672:d=12 hl=4 l= 299 cons: cont [ 0 ]
&#160;3676:d=13 hl=4 l= 295 prim: OCTET STRING&#160;&#160;&#160;&#160;&#160; [HEX DUMP]:30820123020101060A2B0601040184590A03013031300D060960864801650304020105000420817580D34E29FAD72349E478B6EA0B6354F926FD5CB8719E230D0672BFC5E9C102065593CB94E2BC181232303135303731303035303331352E37315A3007020101800201F4A081B9A481B63081B3310B3009060355040613025553311330110603550408130A57617368696E67746F6E3110300E060355040713075265646D6F6E64311E301C060355040A13154D6963726F736F667420436F72706F726174696F6E310D300B060355040B13044D4F505231273025060355040B131E6E436970686572204453452045534E3A433046342D333038362D44454638312530230603550403131C4D6963726F736F66742054696D652D5374616D702053657276696365
&#160;3975:d=11 hl=4 l=3792 cons: cont [ 0 ]
&#160;3979:d=12 hl=4 l=1649 cons: SEQUENCE
&#160;3983:d=13 hl=4 l=1113 cons: SEQUENCE
&#160;3987:d=14 hl=2 l=&#160;&#160; 3 cons: cont [ 0 ]
&#160;3989:d=15 hl=2 l=&#160;&#160; 1 prim: INTEGER&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :02
&#160;3992:d=14 hl=2 l=&#160; 10 prim: INTEGER&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :6109812A000000000002
&#160;4004:d=14 hl=2 l=&#160; 13 cons: SEQUENCE
&#160;4006:d=15 hl=2 l=&#160;&#160; 9 prim: OBJECT&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :sha256WithRSAEncryption
&#160;4017:d=15 hl=2 l=&#160;&#160; 0 prim: NULL
&#160;4019:d=14 hl=3 l= 136 cons: SEQUENCE
&#160;4022:d=15 hl=2 l=&#160; 11 cons: SET
&#160;4024:d=16 hl=2 l=&#160;&#160; 9 cons: SEQUENCE
&#160;4026:d=17 hl=2 l=&#160;&#160; 3 prim: OBJECT&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :countryName
&#160;4031:d=17 hl=2 l=&#160;&#160; 2 prim: PRINTABLESTRING&#160;&#160; :US-------------------------------------------------------------------------------------------------
Thanks,Leena.
&#160;      From: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">matt at openssl.org</A>&gt;
 To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A> 
 Sent: Tuesday, November 24, 2015 3:00 PM
 Subject: Re: [openssl-users] Verifying Authenticode timestamp using openssl apis
   




On 24/11/15 05:17, Leena Soman wrote:
&gt;<i> Hello,
</I>&gt;<i> I am trying to verify the timestamp in a file signed using Authenticode.
</I>&gt;<i> I have found that this timestamp is in the RFC3161 format.
</I>&gt;<i> Using openssl apis, I have parsed the Authenticode signature and reached
</I>&gt;<i> the oid 1.3.6.1.4.1.311.3.3.1. I have subsequently used the following apis :
</I>
Am I right in understanding that you are attempting to use the OpenSSL
ASN.1 APIs to parse an RFC3161 response?

Did you realise that OpenSSL has APIs that support RFC3161 directly? See
opensssl/ts.h as well as the &quot;openssl ts&quot; command line app.

Matt
_______________________________________________
openssl-users mailing list
To unsubscribe: <A HREF="../../../mailman/listinfo/openssl-users.html">https://mta.openssl.org/mailman/listinfo/openssl-users</A>


  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://mta.openssl.org/pipermail/openssl-users/attachments/20151124/81d67a5a/attachment-0001.html">http://mta.openssl.org/pipermail/openssl-users/attachments/20151124/81d67a5a/attachment-0001.html</A>&gt;
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002354.html">[openssl-users] Verifying Authenticode timestamp using openssl apis
</A></li>
	<LI>Next message: <A HREF="002356.html">[openssl-users] openssl des-ede3-cbc does not match with Java one
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2355">[ date ]</a>
              <a href="thread.html#2355">[ thread ]</a>
              <a href="subject.html#2355">[ subject ]</a>
              <a href="author.html#2355">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
