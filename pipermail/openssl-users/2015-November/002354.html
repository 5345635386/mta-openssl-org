<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] Verifying Authenticode timestamp using openssl apis
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2015-November/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Verifying%20Authenticode%20timestamp%20using%20openssl%0A%20apis&In-Reply-To=%3C1753346158.5386979.1448361881191.JavaMail.yahoo%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002353.html">
   <LINK REL="Next"  HREF="002355.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] Verifying Authenticode timestamp using openssl apis</H1>
    <B>Leena Soman</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Verifying%20Authenticode%20timestamp%20using%20openssl%0A%20apis&In-Reply-To=%3C1753346158.5386979.1448361881191.JavaMail.yahoo%40mail.yahoo.com%3E"
       TITLE="[openssl-users] Verifying Authenticode timestamp using openssl apis">leenanand at yahoo.com
       </A><BR>
    <I>Tue Nov 24 10:44:41 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002353.html">[openssl-users] Verifying Authenticode timestamp using openssl apis
</A></li>
        <LI>Next message: <A HREF="002355.html">[openssl-users] Verifying Authenticode timestamp using openssl apis
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2354">[ date ]</a>
              <a href="thread.html#2354">[ thread ]</a>
              <a href="subject.html#2354">[ subject ]</a>
              <a href="author.html#2354">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi&#160;Matt,Yes I have seen them and&#160;am planning on using them. But the timestamp is embedded in the Authenticode signature as&#160;a PKCS7 signedData under OID 1.3.6.1.4.1.311.3.3.1.&#160;I have reached this oid but need to convert the PKCS7 signedData into&#160;a structure&#160;after which I will be able to use the ts apis.After some debugging, I found that the&#160;version in the PKCS7 structure is 3. So I am now wondering if I need to use d2i_CMS_SignedData instead of d2i_PKCS7.
Thanks,Leena.
&#160;      From: Matt Caswell &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">matt at openssl.org</A>&gt;
 To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A> 
 Sent: Tuesday, November 24, 2015 3:00 PM
 Subject: Re: [openssl-users] Verifying Authenticode timestamp using openssl apis
   




On 24/11/15 05:17, Leena Soman wrote:
&gt;<i> Hello,
</I>&gt;<i> I am trying to verify the timestamp in a file signed using Authenticode.
</I>&gt;<i> I have found that this timestamp is in the RFC3161 format.
</I>&gt;<i> Using openssl apis, I have parsed the Authenticode signature and reached
</I>&gt;<i> the oid 1.3.6.1.4.1.311.3.3.1. I have subsequently used the following apis :
</I>
Am I right in understanding that you are attempting to use the OpenSSL
ASN.1 APIs to parse an RFC3161 response?

Did you realise that OpenSSL has APIs that support RFC3161 directly? See
opensssl/ts.h as well as the &quot;openssl ts&quot; command line app.

Matt
_______________________________________________
openssl-users mailing list
To unsubscribe: <A HREF="../../../mailman/listinfo/openssl-users.html">https://mta.openssl.org/mailman/listinfo/openssl-users</A>


  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://mta.openssl.org/pipermail/openssl-users/attachments/20151124/9045f052/attachment.html">http://mta.openssl.org/pipermail/openssl-users/attachments/20151124/9045f052/attachment.html</A>&gt;
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002353.html">[openssl-users] Verifying Authenticode timestamp using openssl apis
</A></li>
	<LI>Next message: <A HREF="002355.html">[openssl-users] Verifying Authenticode timestamp using openssl apis
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2354">[ date ]</a>
              <a href="thread.html#2354">[ thread ]</a>
              <a href="subject.html#2354">[ subject ]</a>
              <a href="author.html#2354">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
