<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Why this error (should, from what I understand, be ok)
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2023-February/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Why%20this%20error%20%28should%2C%20from%20what%20I%20understand%2C%20be%20ok%29&In-Reply-To=%3C176b26b4-e077-7dc8-cc72-34a78f8f49f3%40denninger.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015888.html">
   <LINK REL="Next"  HREF="015890.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Why this error (should, from what I understand, be ok)</H1>
    <B>Karl Denninger</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Why%20this%20error%20%28should%2C%20from%20what%20I%20understand%2C%20be%20ok%29&In-Reply-To=%3C176b26b4-e077-7dc8-cc72-34a78f8f49f3%40denninger.net%3E"
       TITLE="Why this error (should, from what I understand, be ok)">karl at denninger.net
       </A><BR>
    <I>Tue Feb 14 00:56:22 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015888.html">openssl-users Digest, Vol 99, Issue 26
</A></li>
        <LI>Next message (by thread): <A HREF="015890.html">Why this error (should, from what I understand, be ok)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15889">[ date ]</a>
              <a href="thread.html#15889">[ thread ]</a>
              <a href="subject.html#15889">[ subject ]</a>
              <a href="author.html#15889">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Environment is a client/server, with both ends checking the certificates.

Compiled under OpenSSL 1.1.1s (yes, I know it needs updating and it will 
be, but gotta fix this first.)

Server certificate has the following extensions:

 &#160;&#160;&#160;&#160;&#160;&#160;&#160; X509v3 extensions:
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Authority Information Access:
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; OCSP - URI:<A HREF="http://ocsp.cudasystems.net:8888">http://ocsp.cudasystems.net:8888</A>

 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; X509v3 Basic Constraints:
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; CA:FALSE
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Netscape Cert Type:
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; SSL Server
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; X509v3 Key Usage: critical
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Digital Signature, Key Encipherment
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; X509v3 Extended Key Usage:
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TLS Web Server Authentication, TLS Web Client 
Authentication
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Netscape Comment:
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; OpenSSL Generated Server Certificate
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; X509v3 Subject Key Identifier:
53:60:7B:09:2C:DF:4A:E9:F3:1F:1D:66:B9:21:D4:F1:0E:EC:61:68
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; X509v3 Authority Key Identifier:
keyid:5D:C0:5E:C2:A7:8D:D3:CD:0F:9F:9B:C5:51:02:18:AB:5C:D3:8E:CF
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; DirName:/C=US/ST=Florida/L=Niceville/O=Cuda Systems 
LLC/OU=Cuda Systems CA/CN=Cuda Systems LLC 2017 CA
serial:E4:48:8A:82:10:CE:5E:BB:DF:C5:8C:63:21:35:D8:0D:D8:48

 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; X509v3 Subject Alternative Name:
email:<A HREF="../../../mailman/listinfo/openssl-users.html">karl at denninger.net</A>, DNS:tnhouse.homedaemon.org


The client is able to follow the signature and verifies it. However, the 
client certificate with the same extensions:

 &#160;&#160;&#160;&#160;&#160;&#160;&#160; X509v3 extensions:
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Authority Information Access:
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; OCSP - URI:<A HREF="http://ocsp.cudasystems.net:8888">http://ocsp.cudasystems.net:8888</A>

 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; X509v3 Basic Constraints:
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; CA:FALSE
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Netscape Cert Type:
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; SSL Server
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; X509v3 Key Usage: critical
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Digital Signature, Key Encipherment
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; X509v3 Extended Key Usage:
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TLS Web Server Authentication, TLS Web Client 
Authentication
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Netscape Comment:
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; OpenSSL Generated Server Certificate
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; X509v3 Subject Key Identifier:
D0:34:4E:C7:2B:A1:52:A3:3A:DF:89:6F:FD:03:1C:E2:C8:2D:B5:45
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; X509v3 Authority Key Identifier:
keyid:5D:C0:5E:C2:A7:8D:D3:CD:0F:9F:9B:C5:51:02:18:AB:5C:D3:8E:CF
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; DirName:/C=US/ST=Florida/L=Niceville/O=Cuda Systems 
LLC/OU=Cuda Systems CA/CN=Cuda Systems LLC 2017 CA
serial:E4:48:8A:82:10:CE:5E:BB:DF:C5:8C:63:21:35:D8:0D:D8:48

 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; X509v3 Subject Alternative Name:
email:<A HREF="../../../mailman/listinfo/openssl-users.html">karl at denninger.net</A>, DNS:tnhouse-wm.homedaemon.org

Connects, but the server complains on verification that the client cert 
supplied has &quot;invalid purpose.&quot;

&quot;TLS Web Client Authentication&quot; /should /be ok as a client certificate 
I'd expect -- but it isn't, and the server throws up on it.&#160; Or is it 
that I must have the *type* defined as &quot;client&quot; in &quot;nsCertType&quot;?

Feb 13 19:00:50 TnHouse HD-MCP[60420]: SSL ACCEPT Error [certificate 
verify failed] on [::ffff:192.168.10.215] 26
Feb 13 19:00:50 TnHouse HD-MCP[60420]: Slave do_accept SSL failed for 
handle 13

Return code 26 is &quot;invalid purpose&quot;

# define&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; X509_V_ERR_INVALID_PURPOSE 26

Thanks in advance.

-- 
Karl Denninger
<A HREF="../../../mailman/listinfo/openssl-users.html">karl at denninger.net</A>
/The Market Ticker/
/[S/MIME encrypted email preferred]/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://mta.openssl.org/pipermail/openssl-users/attachments/20230213/a6e70749/attachment.htm">https://mta.openssl.org/pipermail/openssl-users/attachments/20230213/a6e70749/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4864 bytes
Desc: S/MIME Cryptographic Signature
URL: &lt;<A HREF="https://mta.openssl.org/pipermail/openssl-users/attachments/20230213/a6e70749/attachment.p7s">https://mta.openssl.org/pipermail/openssl-users/attachments/20230213/a6e70749/attachment.p7s</A>&gt;
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015888.html">openssl-users Digest, Vol 99, Issue 26
</A></li>
	<LI>Next message (by thread): <A HREF="015890.html">Why this error (should, from what I understand, be ok)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15889">[ date ]</a>
              <a href="thread.html#15889">[ thread ]</a>
              <a href="subject.html#15889">[ subject ]</a>
              <a href="author.html#15889">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
