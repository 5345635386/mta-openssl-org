<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] BEAST and SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2015-July/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20BEAST%20and%20SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS&In-Reply-To=%3C55AF9C0A.2070901%40wisemo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001866.html">
   <LINK REL="Next"  HREF="001867.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] BEAST and SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS</H1>
    <B>Jakob Bohm</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20BEAST%20and%20SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS&In-Reply-To=%3C55AF9C0A.2070901%40wisemo.com%3E"
       TITLE="[openssl-users] BEAST and SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS">jb-openssl at wisemo.com
       </A><BR>
    <I>Wed Jul 22 13:35:06 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001866.html">[openssl-users] BEAST and SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS
</A></li>
        <LI>Next message: <A HREF="001867.html">[openssl-users] Extended key usage keyAgreement bit in certificate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1869">[ date ]</a>
              <a href="thread.html#1869">[ thread ]</a>
              <a href="subject.html#1869">[ subject ]</a>
              <a href="author.html#1869">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 22/07/2015 14:12, jonetsu wrote:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Our Nessus version  6.4.1 is detecting a BEAST vulnerability against OpenSSL 1.0.1e.  The source code defines SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS as 0x00000800L and several tests are made for this value in the code.  The CHANGES mentions though that this had some side effects, the option now being part of SSL_OP_ALL.  It would look like, from the scan, that the fragments are not enabled by default, could it be ?
</I>Yep, for some silly reason,
SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS was/is included in
the default value SSL_OP_ALL.  This is in the same
header as SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS.

The proper solution, as just about everybody knows
by now would have been to insert 1-byte fragments
(known as the 1/n-1 solution) which some other
SSL/TLS implementations do.


Enjoy

Jakob
-- 
Jakob Bohm, CIO, Partner, WiseMo A/S.  <A HREF="http://www.wisemo.com">http://www.wisemo.com</A>
Transformervej 29, 2860 S&#248;borg, Denmark.  Direct +45 31 13 16 10
This public discussion message is non-binding and may contain errors.
WiseMo - Remote Service Management for PCs, Phones and Embedded

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://mta.openssl.org/pipermail/openssl-users/attachments/20150722/f7985bdb/attachment.html">http://mta.openssl.org/pipermail/openssl-users/attachments/20150722/f7985bdb/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001866.html">[openssl-users] BEAST and SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS
</A></li>
	<LI>Next message: <A HREF="001867.html">[openssl-users] Extended key usage keyAgreement bit in certificate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1869">[ date ]</a>
              <a href="thread.html#1869">[ thread ]</a>
              <a href="subject.html#1869">[ subject ]</a>
              <a href="author.html#1869">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
