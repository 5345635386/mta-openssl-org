<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Error-wrong version number
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2023-September/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Error-wrong%20version%20number&In-Reply-To=%3Ca11f1ff3-d8bb-aea4-a0f2-64f3fb9ea26d%40openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016699.html">
   <LINK REL="Next"  HREF="016702.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Error-wrong version number</H1>
    <B>Matt Caswell</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Error-wrong%20version%20number&In-Reply-To=%3Ca11f1ff3-d8bb-aea4-a0f2-64f3fb9ea26d%40openssl.org%3E"
       TITLE="Error-wrong version number">matt at openssl.org
       </A><BR>
    <I>Thu Sep  7 14:50:33 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016699.html">Error-wrong version number
</A></li>
        <LI>Next message (by thread): <A HREF="016702.html">OpenSSL Security Advisory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16701">[ date ]</a>
              <a href="thread.html#16701">[ thread ]</a>
              <a href="subject.html#16701">[ subject ]</a>
              <a href="author.html#16701">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On 07/09/2023 15:35, Kirtikumar via openssl-users wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> We are seeing below error during TLS/SSL handshake(SSL_accept()) between 
</I>&gt;<i> client and server (both are windows).
</I>&gt;<i> 
</I>&gt;<i> *Error:*
</I>&gt;<i> 
</I>&gt;<i> &quot;64160000:error:0A00010B:SSL routines:ssl3_get_record:wrong version 
</I>&gt;<i> number:ssl\\record\\ssl3_record.c:355:\n&quot;
</I>
This error happens when the server received something that doesn't look 
like TLS. The data being sent from your client has either become 
corrupted in some way, or you are not using TLS at all for some reason.

I suggest getting a pcap trace of the handshake to see if you can get a 
hint as to what might be happening.

Matt

&gt;<i> 
</I>&gt;<i> ERR_get_error() has returned 167772427
</I>&gt;<i> 
</I>&gt;<i> Everything before SSL_accept looks Ok.
</I>&gt;<i> 
</I>&gt;<i> *Configurations:*
</I>&gt;<i> 
</I>&gt;<i> Client is windows running Openssl 1.1.1K and Server is windows running 
</I>&gt;<i> Openssl 3.0.8, same config is working fine when client is linux.
</I>&gt;<i> 
</I>&gt;<i> *Solutions tried:*
</I>&gt;<i> 
</I>&gt;<i> Tried to lower SSL security by --- 
</I>&gt;<i> SSL_CTX_set_security_level(m_pCtx_IPC, 0); , but it didn't help.
</I>&gt;<i> 
</I>&gt;<i> Observed &quot;Remote host suddenly stooped&quot; error in client logs and it is 
</I>&gt;<i> because server sent &quot;Flags: 0x014 (RST, ACK)&quot; to client which might be 
</I>&gt;<i> because it received some non TLS data.
</I>&gt;<i> 
</I>&gt;<i> Please let me know if anyone could help us to resolve above issue.
</I>&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i> 
</I>&gt;<i> Kirtikumar
</I>&gt;<i> 
</I></PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016699.html">Error-wrong version number
</A></li>
	<LI>Next message (by thread): <A HREF="016702.html">OpenSSL Security Advisory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16701">[ date ]</a>
              <a href="thread.html#16701">[ thread ]</a>
              <a href="subject.html#16701">[ subject ]</a>
              <a href="author.html#16701">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
