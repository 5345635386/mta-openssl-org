<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Need Help on OpenSSl 3.0.x and FIPS enablement
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2023-March/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Need%20Help%20on%20OpenSSl%203.0.x%20and%20FIPS%20enablement&In-Reply-To=%3Cf04d66365302f5a113904bc31442e1ec78ae2ebb.camel%40openssl.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015950.html">
   <LINK REL="Next"  HREF="015952.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Need Help on OpenSSl 3.0.x and FIPS enablement</H1>
    <B>Tomas Mraz</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20Need%20Help%20on%20OpenSSl%203.0.x%20and%20FIPS%20enablement&In-Reply-To=%3Cf04d66365302f5a113904bc31442e1ec78ae2ebb.camel%40openssl.org%3E"
       TITLE="Need Help on OpenSSl 3.0.x and FIPS enablement">tomas at openssl.org
       </A><BR>
    <I>Thu Mar  2 09:42:10 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015950.html">Need Help on OpenSSl 3.0.x and FIPS enablement
</A></li>
        <LI>Next message (by thread): <A HREF="015952.html">Stapled OCSP responses for intermediate certs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15951">[ date ]</a>
              <a href="thread.html#15951">[ thread ]</a>
              <a href="subject.html#15951">[ subject ]</a>
              <a href="author.html#15951">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yes, the current security policy does not allow for anything else. And
to be compliant you must follow it precisely.

On the other hand, fipsmodule.cnf as generated by the build process
actually does not contain the configuration file checksum which
triggers running the selftest every time the fips module is loaded.

So it would be actually possible to modify the security policy document
to allow that _incomplete_ fipsmodule.cnf to be used without running
fipsinstall on every deployed platform at the cost of having the full
set of selftests run on every fips module load.

Tomas

On Thu, 2023-03-02 at 19:45 +1100, Dr Paul Dale wrote:
&gt;<i> &#160;You **must** run the fipsinstall program on every device that you
</I>&gt;<i> want to claim as FIPS validated.&#160; This means that it must be
</I>&gt;<i> installed &amp; executed on each and every platform.&#160; There is no room
</I>&gt;<i> for maneuver here.&#160; Obey the security policy to the letter or not be
</I>&gt;<i> FIPS.&#160; Deeply embedded platforms do **not** get an exception and
</I>&gt;<i> never have.
</I>&gt;<i> &#160;
</I>&gt;<i> &#160;If you want to discuss things further, you should engage with your
</I>&gt;<i> FIPS lab.
</I>&gt;<i> &#160;
</I>&gt;<i> &#160;Pauli
</I>&gt;<i> &#160;
</I>&gt;<i> On 2/3/2023 7:34 pm, Prasad, PCRaghavendra wrote:
</I>&gt;<i> &#160;
</I>&gt;<i> &gt; Hi Paul,
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; Thanks for the information.
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; We will go through the documents once again for more understanding.
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; One basic doubt is when we deploy/build OpenSSL on our  build
</I>&gt;<i> &gt; machine with FIPS enabled (enable_fips) which will generate
</I>&gt;<i> &gt; fips.dll/so and fipsmodule.cnf.
</I>&gt;<i> &gt; We then change the openssl.cnf to access the fipsmodule.cnf and
</I>&gt;<i> &gt; enable fips on the build machine and execute the application or do
</I>&gt;<i> &gt; it programmatically to load the fips module and run the
</I>&gt;<i> &gt; application.
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; As for running on different machines to the build one, the security
</I>&gt;<i> &gt; policy [csrc.nist.gov] is clear that the checksum configuration
</I>&gt;<i> &gt; cannot be copied between machines:
</I>&gt;<i> &gt; &#160;* But we carry libssl.so and libcrypto.so in our build artifacts
</I>&gt;<i> &gt; till now and activate the fips at run time in our application
</I>&gt;<i> &gt; (OpenSSL 1.0.2 FIPS) &#160;on different machines (customer machines) as
</I>&gt;<i> &gt; we are embedded software, so how it can be achieved using OpenSSL
</I>&gt;<i> &gt; 3.0.x + FIPS versions? how can we achieve FIPS on different
</I>&gt;<i> &gt; machines but built on one machine? Is it possible
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; Can you please throw some input on this?
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; Thanks,
</I>&gt;<i> &gt; Ragahvendra
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; From: openssl-users &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>&gt; On Behalf
</I>&gt;<i> &gt; Of Dr Paul Dale
</I>&gt;<i> &gt; &#160;Sent: Wednesday, March 1, 2023 3:34 AM
</I>&gt;<i> &gt; &#160;To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
</I>&gt;<i> &gt; &#160;Subject: Re: Need Help on OpenSSl 3.0.x and FIPS enablement
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; [EXTERNAL EMAIL] 
</I>&gt;<i> &gt; Have you read the relevant documentation?&#160; Specifically, the FIPS
</I>&gt;<i> &gt; module guide [openssl.org], the FIPS provider [openssl.org] and the
</I>&gt;<i> &gt; migration guide [openssl.org]?&#160; These answer most of your questions
</I>&gt;<i> &gt; and can be easy to miss.
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; &#160;With the FIPS provider in OpenSSL 3.0 you will not be able to
</I>&gt;<i> &gt; escape having some configuration in a file.&#160; The FIPS provider does
</I>&gt;<i> &gt; an integrity check on start up and the correct checksum comes from
</I>&gt;<i> &gt; configuration.
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; &#160;As for running on different machines to the build one, the
</I>&gt;<i> &gt; security policy [csrc.nist.gov] is clear that the checksum
</I>&gt;<i> &gt; configuration cannot be copied between machines:
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; &gt; Note: The Module shall have the self-tests run, and the Module
</I>&gt;<i> &gt; &gt; config file output generated on each platform where it is
</I>&gt;<i> &gt; &gt; intended to be used. The Module config file output data shall not
</I>&gt;<i> &gt; &gt; be copied from one machine to another.
</I>&gt;<i> &gt; I'll note that following the build and installation instructions
</I>&gt;<i> &gt; from in the security policy [csrc.nist.gov] is necessary for a FIPS
</I>&gt;<i> &gt; compliant provider.
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; &#160;Pauli
</I>&gt;<i> &gt; On 1/3/23 04:52, Prasad, PCRaghavendra via openssl-users wrote:
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &gt; &gt; Hi Team,
</I>&gt;<i> &gt; &gt; &#160;
</I>&gt;<i> &gt; &gt; Our team has started migrating from OpenSSL 1.0.2 to OpenSSL
</I>&gt;<i> &gt; &gt; 3.0.x version.
</I>&gt;<i> &gt; &gt; We are doing POC for the same on windows and Linux.
</I>&gt;<i> &gt; &gt; &#160;
</I>&gt;<i> &gt; &gt; We have a tight schedule to finish the migration by April 1st
</I>&gt;<i> &gt; &gt; week as we need to fix one critical BD issue and support TLS 1.3
</I>&gt;<i> &gt; &gt; feature as well.
</I>&gt;<i> &gt; &gt; &#160;
</I>&gt;<i> &gt; &gt; The team and I are going through multiple docs of OpenSSL 3.x and
</I>&gt;<i> &gt; &gt; trying to figure out how to configure fips once we build the
</I>&gt;<i> &gt; &gt; OpenSSL.
</I>&gt;<i> &gt; &gt; &#160;
</I>&gt;<i> &gt; &gt; Few things:
</I>&gt;<i> &gt; &gt; &#160;&#160;&#160;1. In openssl 3.0.x Fips module is installed/integrated by
</I>&gt;<i> &gt; &gt; default (enable-fips) during the build step
</I>&gt;<i> &gt; &gt; &#160;&#160;&#160;2. Fipsmodule.cnf is present in the default location
</I>&gt;<i> &gt; &gt; (c:\usr\local\ssl\)
</I>&gt;<i> &gt; &gt; &#160;&#160;&#160;3. After reading multiple ways on how to enable fips, one way
</I>&gt;<i> &gt; &gt; is the config way where we need to change few params in
</I>&gt;<i> &gt; &gt; openssl.cnf
</I>&gt;<i> &gt; &gt; &#160;&#160;&#160;4. By changing that and we did the test using openssl.exe (
</I>&gt;<i> &gt; &gt; sha1 passed and md5 failed) all good
</I>&gt;<i> &gt; &gt; &#160;&#160;&#160;5. Now the challenge is we need to set the fips enablement
</I>&gt;<i> &gt; &gt; programmatically which we were going through multiple docs
</I>&gt;<i> &gt; &gt; (openssl and some forums)
</I>&gt;<i> &gt; &gt; &#160;&#160;&#160;6. Till now we used OpenSSL 1.0.2 where the fipsmodule is
</I>&gt;<i> &gt; &gt; embedded in libcrypto and we need to set it at the beginning of
</I>&gt;<i> &gt; &gt; the application (fips_mode_set()) and everything else is taken
</I>&gt;<i> &gt; &gt; care by default.
</I>&gt;<i> &gt; &gt; &#160;&#160;&#160;7. Now with OpenSSL 3.0.x how to set that fips mode for the
</I>&gt;<i> &gt; &gt; entire application is not very clear
</I>&gt;<i> &gt; &gt; &#160;&#160;&#160;8. Very where they are talking about the config files, our
</I>&gt;<i> &gt; &gt; application is a standalone application that bundles all the
</I>&gt;<i> &gt; &gt; required libs(crypto/SSL) and runs on its own, it will not refer
</I>&gt;<i> &gt; &gt; to any system config/lib files
</I>&gt;<i> &gt; &gt; &#160;&#160;&#160;9. So our doubt is if we build on the application on build
</I>&gt;<i> &gt; &gt; machine containing OpenSSL 3.0.x and create an artifact. We need
</I>&gt;<i> &gt; &gt; to run on different machines.
</I>&gt;<i> &gt; &gt; &#160;&#160;10. In OpenSSL 3.0.x is there any hard dependency on the .cnf
</I>&gt;<i> &gt; &gt; files should we carry them in our artifact and if so should we
</I>&gt;<i> &gt; &gt; install them in the default path like ( C:\usr or /us/local)
</I>&gt;<i> &gt; &gt; which we were not doing till now?
</I>&gt;<i> &gt; &gt; &#160;
</I>&gt;<i> &gt; &gt; Any input on this will be really helpful
</I>&gt;<i> &gt; &gt; &#160;
</I>&gt;<i> &gt; &gt; Thanks,
</I>&gt;<i> &gt; &gt; Raghavendra
</I>&gt;<i> &gt; &gt; &#160;
</I>&gt;<i> &gt; &gt; Internal Use - Confidential
</I>&gt;<i> &gt; &#160;
</I>&gt;<i> &#160;
</I>
-- 
Tom&#225;&#353; Mr&#225;z, OpenSSL

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015950.html">Need Help on OpenSSl 3.0.x and FIPS enablement
</A></li>
	<LI>Next message (by thread): <A HREF="015952.html">Stapled OCSP responses for intermediate certs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15951">[ date ]</a>
              <a href="thread.html#15951">[ thread ]</a>
              <a href="subject.html#15951">[ subject ]</a>
              <a href="author.html#15951">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
