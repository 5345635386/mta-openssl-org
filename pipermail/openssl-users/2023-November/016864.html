<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> openssl-users Digest, Vol 108, Issue 25
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2023-November/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20openssl-users%20Digest%2C%20Vol%20108%2C%20Issue%2025&In-Reply-To=%3CCADJKLZ-5kTx7nrGyZOZ1dfc3TOqx8berr2%3DBhT%3DUBvWPPviSEQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016861.html">
   <LINK REL="Next"  HREF="016865.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>openssl-users Digest, Vol 108, Issue 25</H1>
    <B>meera pulse</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20openssl-users%20Digest%2C%20Vol%20108%2C%20Issue%2025&In-Reply-To=%3CCADJKLZ-5kTx7nrGyZOZ1dfc3TOqx8berr2%3DBhT%3DUBvWPPviSEQ%40mail.gmail.com%3E"
       TITLE="openssl-users Digest, Vol 108, Issue 25">memopulse at gmail.com
       </A><BR>
    <I>Thu Nov 23 10:18:02 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016861.html">TLS connect failure with an engine (OpenSSL 3.0.8)
</A></li>
        <LI>Next message (by thread): <A HREF="016865.html">OpenSSL version 3.2.0 published
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16864">[ date ]</a>
              <a href="thread.html#16864">[ thread ]</a>
              <a href="subject.html#16864">[ subject ]</a>
              <a href="author.html#16864">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Tom,

Thank you for your response. We want to perform fipsinstall using some API
(not on terminal), which I need to execute at runtime after my service has
started, on a demand basis, based on certain conditions. Hope it is clear.

Regards,
Memo

On Wed, Nov 22, 2023 at 1:28&#8239;AM &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-request at openssl.org</A>&gt; wrote:

&gt;<i> Send openssl-users mailing list submissions to
</I>&gt;<i>         <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
</I>&gt;<i>
</I>&gt;<i> To subscribe or unsubscribe via the World Wide Web, visit
</I>&gt;<i>         <A HREF="../../../mailman/listinfo/openssl-users.html">https://mta.openssl.org/mailman/listinfo/openssl-users</A>
</I>&gt;<i> or, via email, send a message with subject or body 'help' to
</I>&gt;<i>         <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-request at openssl.org</A>
</I>&gt;<i>
</I>&gt;<i> You can reach the person managing the list at
</I>&gt;<i>         <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-owner at openssl.org</A>
</I>&gt;<i>
</I>&gt;<i> When replying, please edit your Subject line so it is more specific
</I>&gt;<i> than &quot;Re: Contents of openssl-users digest...&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Today's Topics:
</I>&gt;<i>
</I>&gt;<i>    1. Re: Programmatic Execution of the &quot;OpenSSL-fipsinstall&quot;
</I>&gt;<i>       Command (Ladd, Watson)
</I>&gt;<i>    2. TLS connect failure with an engine (OpenSSL 3.0.8)
</I>&gt;<i>       (Manish Patidar)
</I>&gt;<i>    3. Re: Programmatic Execution of the &quot;OpenSSL-fipsinstall&quot;
</I>&gt;<i>       Command (Thomas Dwyer III)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ----------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 1
</I>&gt;<i> Date: Tue, 21 Nov 2023 14:48:21 +0000
</I>&gt;<i> From: &quot;Ladd, Watson&quot; &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">wladd at akamai.com</A>&gt;
</I>&gt;<i> To: meera pulse &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">memopulse at gmail.com</A>&gt;, &quot;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>&quot;
</I>&gt;<i>         &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>&gt;
</I>&gt;<i> Subject: Re: Programmatic Execution of the &quot;OpenSSL-fipsinstall&quot;
</I>&gt;<i>         Command
</I>&gt;<i> Message-ID: &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">749d27cda12a44209aa69c6fded607b5 at akamai.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=&quot;iso-8859-1&quot;
</I>&gt;<i>
</I>&gt;<i> Yes, we've done it via the moral equivalent of postinstall hooks in our
</I>&gt;<i> packaging system. It works reasonably straightfowardly.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ________________________________
</I>&gt;<i> From: openssl-users &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users-bounces at openssl.org</A>&gt; on behalf of
</I>&gt;<i> meera pulse &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">memopulse at gmail.com</A>&gt;
</I>&gt;<i> Sent: Tuesday, November 21, 2023 2:05 AM
</I>&gt;<i> To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
</I>&gt;<i> Subject: Programmatic Execution of the &quot;OpenSSL-fipsinstall&quot; Command
</I>&gt;<i>
</I>&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> I am currently working on a project that involves the use of the
</I>&gt;<i> &quot;OpenSSL-fipsinstall&quot; command, and I'm exploring the possibility of running
</I>&gt;<i> it programmatically. I would appreciate some guidance on the steps involved
</I>&gt;<i> and whether this approach is feasible.
</I>&gt;<i>
</I>&gt;<i> Has anyone successfully executed the &quot;OpenSSL-fipsinstall&quot; command
</I>&gt;<i> programmatically?
</I>&gt;<i> What steps need to be taken to achieve programmatic execution of
</I>&gt;<i> &quot;OpenSSL-fipsinstall&quot;?
</I>&gt;<i> Are there any potential challenges or considerations that I should be
</I>&gt;<i> aware of?
</I>&gt;<i> I'm eager to hear from anyone with experience or insights into this
</I>&gt;<i> matter. Your assistance will be invaluable in helping me navigate through
</I>&gt;<i> this aspect of my project.
</I>&gt;<i>
</I>&gt;<i> Thank you in advance for your time and expertise!
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Memo
</I>&gt;<i> -------------- next part --------------
</I>&gt;<i> An HTML attachment was scrubbed...
</I>&gt;<i> URL: &lt;
</I>&gt;<i> <A HREF="https://mta.openssl.org/pipermail/openssl-users/attachments/20231121/ec32da30/attachment-0001.htm">https://mta.openssl.org/pipermail/openssl-users/attachments/20231121/ec32da30/attachment-0001.htm</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 2
</I>&gt;<i> Date: Tue, 21 Nov 2023 23:47:38 +0530
</I>&gt;<i> From: Manish Patidar &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">mann.patidar at gmail.com</A>&gt;
</I>&gt;<i> To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
</I>&gt;<i> Subject: TLS connect failure with an engine (OpenSSL 3.0.8)
</I>&gt;<i> Message-ID:
</I>&gt;<i>         &lt;CAN6ajHJ8dnj12Gdc8pKTECh=
</I>&gt;<i> <A HREF="../../../mailman/listinfo/openssl-users.html">g3dkgUw3jn+EXSoPgVNN5ApgJA at mail.gmail.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=&quot;utf-8&quot;
</I>&gt;<i>
</I>&gt;<i> Hi
</I>&gt;<i>
</I>&gt;<i> I am using OpenSSL 3.0.8 with an engine .
</I>&gt;<i> We are using an engine for AES GCM encryption/decryption.
</I>&gt;<i> While TLS connection, connection is failing during change cipher state.
</I>&gt;<i>
</I>&gt;<i> int tls1_change_cipher_state(SSL *s, int which) {
</I>&gt;<i>    if (EVP_CIPHER_get0_provider(c) != NULL
</I>&gt;<i>             &amp;&amp; !*tls_provider_set_tls_params*(s, *dd*, c, m)) {
</I>&gt;<i>         /* SSLfatal already called */
</I>&gt;<i>         goto err;
</I>&gt;<i>     }
</I>&gt;<i> }
</I>&gt;<i> int tls_provider_set_tls_params(SSL *s, EVP_CIPHER_CTX **ctx*,
</I>&gt;<i>                                 const EVP_CIPHER *ciph,
</I>&gt;<i>                                 const EVP_MD *md) {
</I>&gt;<i>     if (!*EVP_CIPHER_CTX_set_params*(*ctx*, params)) {
</I>&gt;<i>         SSLfatal(s, SSL_AD_INTERNAL_ERROR, ERR_R_INTERNAL_ERROR);
</I>&gt;<i>         return 0;
</I>&gt;<i>     }
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> int EVP_CIPHER_CTX_set_params(EVP_CIPHER_CTX **ctx*, const OSSL_PARAM
</I>&gt;<i> params[])
</I>&gt;<i> {
</I>&gt;<i>     if (ctx-&gt;cipher != NULL &amp;&amp; ctx-&gt;*cipher*-&gt;*set_ctx_params* != NULL) {
</I>&gt;<i>         ctx-&gt;iv_len = -1;
</I>&gt;<i>         return ctx-&gt;cipher-&gt;set_ctx_params(ctx-&gt;algctx, params);
</I>&gt;<i>     }
</I>&gt;<i>     *return 0;*
</I>&gt;<i> }
</I>&gt;<i> I think there is some issue here, as ctx-&gt;cipher is created from the
</I>&gt;<i> engine, *set_ctx_param* is not set in the ctx-&gt;cipher.
</I>&gt;<i> This check is leading to a drop in the connection.
</I>&gt;<i>
</I>&gt;<i> If we bypass this check , the TLS connection is passing.
</I>&gt;<i> Is there something missing here, please let me know how to avoid this
</I>&gt;<i> issue.
</I>&gt;<i>
</I>&gt;<i> Regards
</I>&gt;<i> Manish
</I>&gt;<i> -------------- next part --------------
</I>&gt;<i> An HTML attachment was scrubbed...
</I>&gt;<i> URL: &lt;
</I>&gt;<i> <A HREF="https://mta.openssl.org/pipermail/openssl-users/attachments/20231121/6f752570/attachment-0001.htm">https://mta.openssl.org/pipermail/openssl-users/attachments/20231121/6f752570/attachment-0001.htm</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 3
</I>&gt;<i> Date: Tue, 21 Nov 2023 11:56:43 -0800
</I>&gt;<i> From: Thomas Dwyer III &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">thomas.dwyer at oracle.com</A>&gt;
</I>&gt;<i> To: <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
</I>&gt;<i> Subject: Re: Programmatic Execution of the &quot;OpenSSL-fipsinstall&quot;
</I>&gt;<i>         Command
</I>&gt;<i> Message-ID: &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">36fc5eb9-728a-45a9-a0cb-749700aea3ad at oracle.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=&quot;utf-8&quot;; Format=&quot;flowed&quot;
</I>&gt;<i>
</I>&gt;<i> When you say programmatically, do you mean executing literally the
</I>&gt;<i> &quot;openssl fipsinstall&quot; command with suitable arguments, or do you mean
</I>&gt;<i> running an equivalent replacement program? We do the latter, in a
</I>&gt;<i> slightly different way than the OpenSSL documentation provides. We
</I>&gt;<i> cross-compile OpenSSL on x86_64 for an embedded 32-bit ARM platform so
</I>&gt;<i> it's not possible for us to execute fipsinstall as part of our build
</I>&gt;<i> process (and non-compliant anyway since coping fipsmodule.cnf to other
</I>&gt;<i> systems is not allowed). Also, flash space constraints prohibit us from
</I>&gt;<i> including the large openssl binary in our images. And then there's the
</I>&gt;<i> chicken-egg situation with shipping a static configuration file that
</I>&gt;<i> &quot;.include&quot;s a nonexistent fipsmodule.cnf.
</I>&gt;<i>
</I>&gt;<i> Our solution was to ship a static configuration file that contains:
</I>&gt;<i>
</I>&gt;<i>  ??? [fips_sect]
</I>&gt;<i>  ??? .include /path/to/fipsmodule.cnf
</I>&gt;<i>
</I>&gt;<i> where fipsmodule.cnf (initially empty) resides in a smaller writable
</I>&gt;<i> location of flash separate from where most other things live. On first
</I>&gt;<i> boot we detect that fipsmodule.cnf is empty and we run a very small
</I>&gt;<i> standalone fipsinstall replacement that loads the FIPS provider, runs
</I>&gt;<i> the self-tests, and generates the same contents as &quot;openssl fipsinstall&quot;
</I>&gt;<i> but without the [fips_sect] header. This solves the problem of using
</I>&gt;<i> libcrypto with a syntactically incorrect configuration (i.e. where
</I>&gt;<i> [provider_sect] in the static openssl.cnf references [fips_sect] which
</I>&gt;<i> doesn't exist yet). Finally, we let the administrator toggle FIPS on/off
</I>&gt;<i> by storing a persistent flag that gets read by a constructor that we
</I>&gt;<i> added to libcrypto:
</I>&gt;<i>
</I>&gt;<i>  ??? void __attribute__ ((constructor)) fipsmode(void)
</I>&gt;<i>  ??? {
</I>&gt;<i>  ??????? int mode = {fetch value of persistent flag}
</I>&gt;<i>  ??????? EVP_default_properties_enable_fips(NULL, mode);
</I>&gt;<i>  ??? }
</I>&gt;<i>
</I>&gt;<i> Note that a forced reboot is required when toggling this flag since the
</I>&gt;<i> change won't apply to any instances of libcrypto already loaded by
</I>&gt;<i> running processes.
</I>&gt;<i>
</I>&gt;<i> We can get away with this because we don't use OpenSSL's FIPS
</I>&gt;<i> certificate--we send our implementation through CMVP and get our own
</I>&gt;<i> certificate. That's probably cost-prohibitive for smaller organizations.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Tom.III
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 11/21/23 02:05, meera pulse wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Hello,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I am currently working on a project that involves the use of the
</I>&gt;<i> &gt; &quot;OpenSSL-fipsinstall&quot; command, and I'm exploring the possibility of
</I>&gt;<i> &gt; running it programmatically. I would appreciate some guidance on the
</I>&gt;<i> &gt; steps involved and whether this approach is feasible.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Has anyone successfully executed the &quot;OpenSSL-fipsinstall&quot; command
</I>&gt;<i> &gt; programmatically?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; What steps need to be taken to achieve programmatic execution of
</I>&gt;<i> &gt; &quot;OpenSSL-fipsinstall&quot;?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Are there any potential challenges or considerations that I should be
</I>&gt;<i> &gt; aware of?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm eager to hear from anyone with experience or insights into this
</I>&gt;<i> &gt; matter. Your assistance will be invaluable in helping me navigate
</I>&gt;<i> &gt; through this aspect of my project.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thank you in advance for your time and expertise!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Memo
</I>&gt;<i> &gt;
</I>&gt;<i> -------------- next part --------------
</I>&gt;<i> An HTML attachment was scrubbed...
</I>&gt;<i> URL: &lt;
</I>&gt;<i> <A HREF="https://mta.openssl.org/pipermail/openssl-users/attachments/20231121/fa8bc3ec/attachment.htm">https://mta.openssl.org/pipermail/openssl-users/attachments/20231121/fa8bc3ec/attachment.htm</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Subject: Digest Footer
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> openssl-users mailing list
</I>&gt;<i> <A HREF="../../../mailman/listinfo/openssl-users.html">openssl-users at openssl.org</A>
</I>&gt;<i> <A HREF="../../../mailman/listinfo/openssl-users.html">https://mta.openssl.org/mailman/listinfo/openssl-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> End of openssl-users Digest, Vol 108, Issue 25
</I>&gt;<i> **********************************************
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://mta.openssl.org/pipermail/openssl-users/attachments/20231123/c8b3dfd1/attachment-0001.htm">https://mta.openssl.org/pipermail/openssl-users/attachments/20231123/c8b3dfd1/attachment-0001.htm</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016861.html">TLS connect failure with an engine (OpenSSL 3.0.8)
</A></li>
	<LI>Next message (by thread): <A HREF="016865.html">OpenSSL version 3.2.0 published
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16864">[ date ]</a>
              <a href="thread.html#16864">[ thread ]</a>
              <a href="subject.html#16864">[ subject ]</a>
              <a href="author.html#16864">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
