<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] help with timestamping
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2016-May/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20help%20with%20timestamping&In-Reply-To=%3CCAJ%2BQ1PXcM4NjtJ9%2BSPu14tNBKiNZ8h9Cnmy52ODK8Uwa7Y0fnw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003645.html">
   <LINK REL="Next"  HREF="003736.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] help with timestamping</H1>
    <B>Alex Samad</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20help%20with%20timestamping&In-Reply-To=%3CCAJ%2BQ1PXcM4NjtJ9%2BSPu14tNBKiNZ8h9Cnmy52ODK8Uwa7Y0fnw%40mail.gmail.com%3E"
       TITLE="[openssl-users] help with timestamping">alex at samad.com.au
       </A><BR>
    <I>Tue May  3 04:20:22 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="003645.html">[openssl-users] Changing IV in EVP API?
</A></li>
        <LI>Next message: <A HREF="003736.html">[openssl-users] help with timestamping
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3648">[ date ]</a>
              <a href="thread.html#3648">[ thread ]</a>
              <a href="subject.html#3648">[ subject ]</a>
              <a href="author.html#3648">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Got a bit further


=======
#!/bin/bash


rm -f /tmp/test.data* /tmp/sym.cer


cat &gt; /tmp/test.data &lt;&lt;EOF
This is a test
A test
EOF







cat &gt; /tmp/symINT.cer &lt;&lt; EOF
# Signing cert public key
#Issuer: C=US, O=Symantec Corporation, OU=Symantec Trust Network,
CN=Symantec SHA256 TimeStamping CA
#Subject: C=US, O=Symantec Corporation, OU=Symantec Trust Network,
CN=Symantec SHA256 TimeStamping Signer - G1
-----BEGIN CERTIFICATE-----
MIIFSzCCBDOgAwIBAgIQVPN9oXFnUbxqjQrSdLKLEzANBgkqhkiG9w0BAQsFADB3
MQswCQYDVQQGEwJVUzEdMBsGA1UEChMUU3ltYW50ZWMgQ29ycG9yYXRpb24xHzAd
BgNVBAsTFlN5bWFudGVjIFRydXN0IE5ldHdvcmsxKDAmBgNVBAMTH1N5bWFudGVj
IFNIQTI1NiBUaW1lU3RhbXBpbmcgQ0EwHhcNMTYwMTEyMDAwMDAwWhcNMjcwNDEx
MjM1OTU5WjCBgDELMAkGA1UEBhMCVVMxHTAbBgNVBAoTFFN5bWFudGVjIENvcnBv
cmF0aW9uMR8wHQYDVQQLExZTeW1hbnRlYyBUcnVzdCBOZXR3b3JrMTEwLwYDVQQD
EyhTeW1hbnRlYyBTSEEyNTYgVGltZVN0YW1waW5nIFNpZ25lciAtIEcxMIIBIjAN
BgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAn/vfjx+nz54+GsvraK3PJxzugVWp
hwhY5YFNCRTg7dDz1A8/IbYeDjTU8WgKb32Pidny6qfYJTikjDbK7ijPM/h1Pdid
z5LdVuP2sHlUZrVFgkNE0mqxqxeiw+XvAOon8yeIDoc89m68qez2uy5qdwYivfq4
f8MkB/c/u0yw/0PLk8oSqpUkAJCyKzai0t3Ss9GZMt3P9MxzFkmDfyTr7XhG0+5f
bEJlG2eN8CYaDl6HblqPoIJ+bp/NJt69Ye9EXkWLqJTTHAQyof+kp6KqdwHbKt4P
TJI2xmmsXISArSX17TDDaB0X2wpNmjR4WQGbawKFOOIncaIUVDBgkyBIIwIDAQAB
o4IBxzCCAcMwDAYDVR0TAQH/BAIwADBmBgNVHSAEXzBdMFsGC2CGSAGG+EUBBxcD
MEwwIwYIKwYBBQUHAgEWF2h0dHBzOi8vZC5zeW1jYi5jb20vY3BzMCUGCCsGAQUF
BwICMBkaF2h0dHBzOi8vZC5zeW1jYi5jb20vcnBhMEAGA1UdHwQ5MDcwNaAzoDGG
L2h0dHA6Ly90cy1jcmwud3Muc3ltYW50ZWMuY29tL3NoYTI1Ni10c3MtY2EuY3Js
MBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMIMA4GA1UdDwEB/wQEAwIHgDB3BggrBgEF
BQcBAQRrMGkwKgYIKwYBBQUHMAGGHmh0dHA6Ly90cy1vY3NwLndzLnN5bWFudGVj
LmNvbTA7BggrBgEFBQcwAoYvaHR0cDovL3RzLWFpYS53cy5zeW1hbnRlYy5jb20v
c2hhMjU2LXRzcy1jYS5jZXIwKAYDVR0RBCEwH6QdMBsxGTAXBgNVBAMTEFRpbWVT
dGFtcC0yMDQ4LTQwHQYDVR0OBBYEFO1rYM87WPg+Msy/pOir6OqiUEJ/MB8GA1Ud
IwQYMBaAFK9j1sqjToVy4Ke8QfMpojh/gHViMA0GCSqGSIb3DQEBCwUAA4IBAQCi
jV5dHe5O0pP9T+X0babwiUVVuwjKqyShFiTJTxfBn/TdAprCR8Cp3IiJd8GGhvHV
SZbz+x6Y1skdNSOImYpi4XWoTXinPewkgBWeaNQ6pMJM3HFslp2OHgwubFIBnlaQ
P6Jeks222kEaJIOheqNf/o07bznRP0FfVhwnDOV8BdhnNojlsMLDBKNaVrgSBI7U
nCRrG2a0vqAa4bXN7ONEpLE855LzWN3f6LFYS3BLzpAAzNyj0dJudRZURALvG1RE
Y+i1cMi5R5pbRcRudpoYsfcQM8gLUfVVjP0hHkGPTj6QXYAByLwkfoZoFBUUNDV0
SbeHUinWll6ioxbUsNN7
-----END CERTIFICATE-----
# CA for signing cert
#Issuer: C=US, O=VeriSign, Inc., OU=VeriSign Trust Network, OU=(c)
2008 VeriSign, Inc. - For authorized use only, CN=VeriSign Universal
Root Certification Authority
#Subject: C=US, O=Symantec Corporation, OU=Symantec Trust Network,
CN=Symantec SHA256 TimeStamping CA
-----BEGIN CERTIFICATE-----
MIIFODCCBCCgAwIBAgIQewWx1EloUUT3yYnSnBmdEjANBgkqhkiG9w0BAQsFADCB
vTELMAkGA1UEBhMCVVMxFzAVBgNVBAoTDlZlcmlTaWduLCBJbmMuMR8wHQYDVQQL
ExZWZXJpU2lnbiBUcnVzdCBOZXR3b3JrMTowOAYDVQQLEzEoYykgMjAwOCBWZXJp
U2lnbiwgSW5jLiAtIEZvciBhdXRob3JpemVkIHVzZSBvbmx5MTgwNgYDVQQDEy9W
ZXJpU2lnbiBVbml2ZXJzYWwgUm9vdCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTAe
Fw0xNjAxMTIwMDAwMDBaFw0zMTAxMTEyMzU5NTlaMHcxCzAJBgNVBAYTAlVTMR0w
GwYDVQQKExRTeW1hbnRlYyBDb3Jwb3JhdGlvbjEfMB0GA1UECxMWU3ltYW50ZWMg
VHJ1c3QgTmV0d29yazEoMCYGA1UEAxMfU3ltYW50ZWMgU0hBMjU2IFRpbWVTdGFt
cGluZyBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALtZnVlVT52M
cl0agaLrVfOwAa08cawyjwVrhponADKXak3JZBRLKbvC2Sm5Luxjs+HPPwtWkPhi
G37rpgfi3n9ebUA41JEG50F8eRzLy60bv9iVkfPw7mz4rZY5Ln/BJ7h4OcWEpe3t
r4eOzo3HberSmLU6Hx45ncP0mqj0hOHE0XxxxgYptD/kgw0mw3sIPk35CrczSf/K
O9T1sptL4YiZGvXA6TMU1t/HgNuR7v68kldyd/TNqMz+CfWTN76ViGrF3PSxS9TO
6AmRX7WEeTWKeKwZMo8jwTJBG1kOqT6xzPnWK++32OTVHW0ROpL2k8mc40juu1MO
1DaXhnjFoTcCAwEAAaOCAXcwggFzMA4GA1UdDwEB/wQEAwIBBjASBgNVHRMBAf8E
CDAGAQH/AgEAMGYGA1UdIARfMF0wWwYLYIZIAYb4RQEHFwMwTDAjBggrBgEFBQcC
ARYXaHR0cHM6Ly9kLnN5bWNiLmNvbS9jcHMwJQYIKwYBBQUHAgIwGRoXaHR0cHM6
Ly9kLnN5bWNiLmNvbS9ycGEwLgYIKwYBBQUHAQEEIjAgMB4GCCsGAQUFBzABhhJo
dHRwOi8vcy5zeW1jZC5jb20wNgYDVR0fBC8wLTAroCmgJ4YlaHR0cDovL3Muc3lt
Y2IuY29tL3VuaXZlcnNhbC1yb290LmNybDATBgNVHSUEDDAKBggrBgEFBQcDCDAo
BgNVHREEITAfpB0wGzEZMBcGA1UEAxMQVGltZVN0YW1wLTIwNDgtMzAdBgNVHQ4E
FgQUr2PWyqNOhXLgp7xB8ymiOH+AdWIwHwYDVR0jBBgwFoAUtnf6aUhHn1MS1cLq
BzJ2B9GXBxkwDQYJKoZIhvcNAQELBQADggEBAHXqsC3VNBlcMkX+DuHUT6Z4wW/X
6t3cT/OhyIGI96ePFeZAKa3mXfSi2VZkhHEwKt0eYRdmIFYGmBmNXXHy+Je8Cf0c
kUfJ4uiNA/vMkC/WCmxOM+zWtJPITJBjSDlAIcTd1m6JmDy1mJfoqQa3CcmPU1dB
kC/hHk1O3MoQeGxCbvC2xfhhXFL1TvZrjfdKer7zzf0D19n2A6gP41P3CnXsxnUu
qmaFBJm3+AZX4cYO9uiv2uybGB+queM6AL/OipTLAduexzi7D1Kr0eOUA2AKTaD+
J20UMvw/l0Dhv5mJ2+Q5FL3a5NPD6itas5VYVQR9x5rsIwONhSrS/66pYYE=
-----END CERTIFICATE-----

EOF



cat &gt; /tmp/symCA.cer &lt;&lt; EOF
#Issuer: C=US, O=VeriSign, Inc., OU=VeriSign Trust Network, OU=(c)
2008 VeriSign, Inc. - For authorized use only, CN=VeriSign Universal
Root Certification Authority
#Subject: C=US, O=VeriSign, Inc., OU=VeriSign Trust Network, OU=(c)
2008 VeriSign, Inc. - For authorized use only, CN=VeriSign Universal
Root Certification Authority
-----BEGIN CERTIFICATE-----
MIIEuTCCA6GgAwIBAgIQQBrEZCGzEyEDDrvkEhrFHTANBgkqhkiG9w0BAQsFADCB
vTELMAkGA1UEBhMCVVMxFzAVBgNVBAoTDlZlcmlTaWduLCBJbmMuMR8wHQYDVQQL
ExZWZXJpU2lnbiBUcnVzdCBOZXR3b3JrMTowOAYDVQQLEzEoYykgMjAwOCBWZXJp
U2lnbiwgSW5jLiAtIEZvciBhdXRob3JpemVkIHVzZSBvbmx5MTgwNgYDVQQDEy9W
ZXJpU2lnbiBVbml2ZXJzYWwgUm9vdCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTAe
Fw0wODA0MDIwMDAwMDBaFw0zNzEyMDEyMzU5NTlaMIG9MQswCQYDVQQGEwJVUzEX
MBUGA1UEChMOVmVyaVNpZ24sIEluYy4xHzAdBgNVBAsTFlZlcmlTaWduIFRydXN0
IE5ldHdvcmsxOjA4BgNVBAsTMShjKSAyMDA4IFZlcmlTaWduLCBJbmMuIC0gRm9y
IGF1dGhvcml6ZWQgdXNlIG9ubHkxODA2BgNVBAMTL1ZlcmlTaWduIFVuaXZlcnNh
bCBSb290IENlcnRpZmljYXRpb24gQXV0aG9yaXR5MIIBIjANBgkqhkiG9w0BAQEF
AAOCAQ8AMIIBCgKCAQEAx2E3XrEBNNti1xWb/1hajCMj1mCOkdeQmIN65lgZOIzF
9uVkhbSicfvtvbnazU0AtMgtc6XHaXGVHzk8skQHnOgO+k1KxCHfKWGPMiJhgsWH
H26MfF8WIFFE0XBPV+rjHOPMee5Y2A7Cs0WTwCznmhcrewA3ekEzeOEz4vMQGn+H
LL729fdC4uW/h2KJXwBL38Xd5HVEMkE6HnFuacsLdUYI0crSK5XQz/u5QGtkjFdN
/BMReYTtXlT2NJ8IAfMQJQYXStrxHXpma5hgZqTZ79IugvHw7wnqRMkVauIDbjPT
rJ9VAMf2CGqUuV/c4DPxhGD5WycRtPwW8rtWaoAljQIDAQABo4GyMIGvMA8GA1Ud
EwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgEGMG0GCCsGAQUFBwEMBGEwX6FdoFsw
WTBXMFUWCWltYWdlL2dpZjAhMB8wBwYFKw4DAhoEFI/l0xqGrI2Oa8PPgGrUSBgs
exkuMCUWI2h0dHA6Ly9sb2dvLnZlcmlzaWduLmNvbS92c2xvZ28uZ2lmMB0GA1Ud
DgQWBBS2d/ppSEefUxLVwuoHMnYH0ZcHGTANBgkqhkiG9w0BAQsFAAOCAQEASvj4
sAPmLGd75JR3Y8xuTPl9Dg3cyLk1uXBPY/ok+myDjEedO2Pzmvl2MpWRsXe8rJq+
seQxIcaBlVZaDrHC1LGmWazxY8u4TB1ZkErvkBYoH1quEPuBUDgMbMzxPcP1Y+Oz
4yHJJDnp/RVmRvQbEdBNc6N9Rvk97ahfYtTxP/jgdFcrGJ2BtMQo2pSXpXDrrB2+
BxHw1dvd5Yzw1TKwg+ZX4o+/vqGqvz0dtdQ46tewXDpPaj+PwGZsY6rp2aQW9IHR
lRQOfc2VNNnSj3BzgXucfr2YYdhFh5iQxeuGMMY1v/D/w1WIg0vvBZIGcfK4mJO3
7M2CYfE45k+XmCpajQ==
-----END CERTIFICATE-----
EOF


/usr/bin/openssl ts -query -data /tmp/test.data -sha256 -out
/tmp/test.data.tsq -no_nonce


/usr/bin/curl -s -H Content-Type:application/timestamp-query
--data-binary @/tmp/test.data.tsq
<A HREF="http://sha256timestamp.ws.symantec.com/sha256/timestamp">http://sha256timestamp.ws.symantec.com/sha256/timestamp</A> -o
/tmp/test.data.tsr


#/usr/bin/openssl ts -query -data /tmp/test.data -sha256 |
/usr/bin/curl -s -H Content-Type:application/timestamp-query
--data-binary @-
<A HREF="http://sha256timestamp.ws.symantec.com/sha256/timestamp">http://sha256timestamp.ws.symantec.com/sha256/timestamp</A> &gt;
/tmp/test.data.tsr

/usr/bin/openssl ts -reply -in /tmp/test.data.tsr -text  &gt;
/tmp/test.data.tsr.txt

#openssl ts -verify -data /tmp/test.data -in /tmp/test.data.tsr
#openssl ts -verify -data /tmp/test.data -in /tmp/test.data.tsr
-untrusted /tmp/symINT.cer
openssl ts -verify -data /tmp/test.data -in /tmp/test.data.tsr
-untrusted /tmp/symINT.cer  -CAfile /tmp/symCA.cer

=======


results in this
Verification: FAILED
140328034314056:error:2F067065:time stamp
routines:TS_CHECK_SIGNING_CERTS:ess signing certificate
error:ts_rsp_verify.c:291:


which lead me to this
<A HREF="http://openssl.6102.n7.nabble.com/possible-Bug-in-OpenSSL-rfc-3161-TSA-service-tt43128.html#none">http://openssl.6102.n7.nabble.com/possible-Bug-in-OpenSSL-rfc-3161-TSA-service-tt43128.html#none</A>

Not sure if there has been any work on this since then.


On 29 April 2016 at 11:25, Alex Samad &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">alex at samad.com.au</A>&gt; wrote:
&gt;<i> Okay I have the cert from sym
</I>&gt;<i>
</I>&gt;<i> -----BEGIN CERTIFICATE-----
</I>&gt;<i> MIIFSzCCBDOgAwIBAgIQVPN9oXFnUbxqjQrSdLKLEzANBgkqhkiG9w0BAQsFADB3
</I>&gt;<i> MQswCQYDVQQGEwJVUzEdMBsGA1UEChMUU3ltYW50ZWMgQ29ycG9yYXRpb24xHzAd
</I>&gt;<i> BgNVBAsTFlN5bWFudGVjIFRydXN0IE5ldHdvcmsxKDAmBgNVBAMTH1N5bWFudGVj
</I>&gt;<i> IFNIQTI1NiBUaW1lU3RhbXBpbmcgQ0EwHhcNMTYwMTEyMDAwMDAwWhcNMjcwNDEx
</I>&gt;<i> MjM1OTU5WjCBgDELMAkGA1UEBhMCVVMxHTAbBgNVBAoTFFN5bWFudGVjIENvcnBv
</I>&gt;<i> cmF0aW9uMR8wHQYDVQQLExZTeW1hbnRlYyBUcnVzdCBOZXR3b3JrMTEwLwYDVQQD
</I>&gt;<i> EyhTeW1hbnRlYyBTSEEyNTYgVGltZVN0YW1waW5nIFNpZ25lciAtIEcxMIIBIjAN
</I>&gt;<i> BgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAn/vfjx+nz54+GsvraK3PJxzugVWp
</I>&gt;<i> hwhY5YFNCRTg7dDz1A8/IbYeDjTU8WgKb32Pidny6qfYJTikjDbK7ijPM/h1Pdid
</I>&gt;<i> z5LdVuP2sHlUZrVFgkNE0mqxqxeiw+XvAOon8yeIDoc89m68qez2uy5qdwYivfq4
</I>&gt;<i> f8MkB/c/u0yw/0PLk8oSqpUkAJCyKzai0t3Ss9GZMt3P9MxzFkmDfyTr7XhG0+5f
</I>&gt;<i> bEJlG2eN8CYaDl6HblqPoIJ+bp/NJt69Ye9EXkWLqJTTHAQyof+kp6KqdwHbKt4P
</I>&gt;<i> TJI2xmmsXISArSX17TDDaB0X2wpNmjR4WQGbawKFOOIncaIUVDBgkyBIIwIDAQAB
</I>&gt;<i> o4IBxzCCAcMwDAYDVR0TAQH/BAIwADBmBgNVHSAEXzBdMFsGC2CGSAGG+EUBBxcD
</I>&gt;<i> MEwwIwYIKwYBBQUHAgEWF2h0dHBzOi8vZC5zeW1jYi5jb20vY3BzMCUGCCsGAQUF
</I>&gt;<i> BwICMBkaF2h0dHBzOi8vZC5zeW1jYi5jb20vcnBhMEAGA1UdHwQ5MDcwNaAzoDGG
</I>&gt;<i> L2h0dHA6Ly90cy1jcmwud3Muc3ltYW50ZWMuY29tL3NoYTI1Ni10c3MtY2EuY3Js
</I>&gt;<i> MBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMIMA4GA1UdDwEB/wQEAwIHgDB3BggrBgEF
</I>&gt;<i> BQcBAQRrMGkwKgYIKwYBBQUHMAGGHmh0dHA6Ly90cy1vY3NwLndzLnN5bWFudGVj
</I>&gt;<i> LmNvbTA7BggrBgEFBQcwAoYvaHR0cDovL3RzLWFpYS53cy5zeW1hbnRlYy5jb20v
</I>&gt;<i> c2hhMjU2LXRzcy1jYS5jZXIwKAYDVR0RBCEwH6QdMBsxGTAXBgNVBAMTEFRpbWVT
</I>&gt;<i> dGFtcC0yMDQ4LTQwHQYDVR0OBBYEFO1rYM87WPg+Msy/pOir6OqiUEJ/MB8GA1Ud
</I>&gt;<i> IwQYMBaAFK9j1sqjToVy4Ke8QfMpojh/gHViMA0GCSqGSIb3DQEBCwUAA4IBAQCi
</I>&gt;<i> jV5dHe5O0pP9T+X0babwiUVVuwjKqyShFiTJTxfBn/TdAprCR8Cp3IiJd8GGhvHV
</I>&gt;<i> SZbz+x6Y1skdNSOImYpi4XWoTXinPewkgBWeaNQ6pMJM3HFslp2OHgwubFIBnlaQ
</I>&gt;<i> P6Jeks222kEaJIOheqNf/o07bznRP0FfVhwnDOV8BdhnNojlsMLDBKNaVrgSBI7U
</I>&gt;<i> nCRrG2a0vqAa4bXN7ONEpLE855LzWN3f6LFYS3BLzpAAzNyj0dJudRZURALvG1RE
</I>&gt;<i> Y+i1cMi5R5pbRcRudpoYsfcQM8gLUfVVjP0hHkGPTj6QXYAByLwkfoZoFBUUNDV0
</I>&gt;<i> SbeHUinWll6ioxbUsNN7
</I>&gt;<i> -----END CERTIFICATE-----
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> openssl x509 -in newsym1.cer -noout -subject
</I>&gt;<i> subject= /C=US/O=Symantec Corporation/OU=Symantec Trust
</I>&gt;<i> Network/CN=Symantec SHA256 TimeStamping Signer - G1
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Still getting
</I>&gt;<i>
</I>&gt;<i>  openssl ts -verify -data SHA.sha -in SHA.sha.tsr  -CApath newsym1.cer
</I>&gt;<i> Verification: FAILED
</I>&gt;<i> 139630315571016:error:2107C080:PKCS7
</I>&gt;<i> routines:PKCS7_get0_signers:signer certificate not
</I>&gt;<i> found:pk7_smime.c:476:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 27 April 2016 at 14:53, Jakob Bohm &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">jb-openssl at wisemo.com</A>&gt; wrote:
</I>&gt;&gt;<i> OK, It looks like this signing service is (quite unusually)
</I>&gt;&gt;<i> not providing the certificate in its message, which is quite
</I>&gt;&gt;<i> unusual.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> All it provides is some information /about/ that certificate,
</I>&gt;&gt;<i> specifically it provides the following info:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The certificate was issued to C=US, O=Symantec Corporation,
</I>&gt;&gt;<i> OU=Symantec Trust Network,
</I>&gt;&gt;<i> CN=Symantec SHA256 TimeStamping Signer - G1
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The certificate was issued by C=US, O=Symantec Corporation,
</I>&gt;&gt;<i> OU=Symantec Trust Network, CN=Symantec SHA256 TimeStamping CA
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The certificate serial number (in hex) is
</I>&gt;&gt;<i> 54 F3 7D A1 71 67 51 BC 6A 8D 0A D2 74 B2 8B 13
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The certificate fingerprint (SHA-256) is
</I>&gt;&gt;<i> 82 D5 56 DB DB 5D AD 5FA0 7B B6 07 26 A6 D8 6E
</I>&gt;&gt;<i> 73 0B 5B B7 29 88 5B B6DE 4F F2 75 29 02 2C FC
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Someone with knowledge of the Symantec/Verisign/Thawte/GeoTrust/
</I>&gt;&gt;<i> TrustCenter repository web site may be able to use this
</I>&gt;&gt;<i> information to download the missing certificates, but there
</I>&gt;&gt;<i> is no information in this file that would allow a computer
</I>&gt;&gt;<i> to do this.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I wonder if changing some parameter in the timestamp request
</I>&gt;&gt;<i> would cause the Symantec server to return a more complete
</I>&gt;&gt;<i> timestamp token.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Or maybe something else is failing.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 23/04/2016 00:54, Alex Samad wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Here is a dump.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I can see the CN - but I could see that before.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> There is also a RSA - maybe a signature or maybe is the public key for the
</I>&gt;&gt;&gt;<i> cert.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I would expect to see some signed data (sha + symantec cert + time)
</I>&gt;&gt;&gt;<i> and also the public cert ( and maybe the intermediaries..)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>      &lt;30 82 03 AB&gt;
</I>&gt;&gt;&gt;<i>    0 939: SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;30 03&gt;
</I>&gt;&gt;&gt;<i>    4   3:   SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;02 01&gt;
</I>&gt;&gt;&gt;<i>    6   1:     INTEGER 0
</I>&gt;&gt;&gt;<i>         :     }
</I>&gt;&gt;&gt;<i>      &lt;30 82 03 A2&gt;
</I>&gt;&gt;&gt;<i>    9 930:   SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 09&gt;
</I>&gt;&gt;&gt;<i>   13   9:     OBJECT IDENTIFIER signedData (1 2 840 113549 1 7 2)
</I>&gt;&gt;&gt;<i>         :       (PKCS #7)
</I>&gt;&gt;&gt;<i>      &lt;A0 82 03 93&gt;
</I>&gt;&gt;&gt;<i>   24 915:     [0] {
</I>&gt;&gt;&gt;<i>      &lt;30 82 03 8F&gt;
</I>&gt;&gt;&gt;<i>   28 911:       SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;02 01&gt;
</I>&gt;&gt;&gt;<i>   32   1:         INTEGER 3
</I>&gt;&gt;&gt;<i>      &lt;31 0D&gt;
</I>&gt;&gt;&gt;<i>   35  13:         SET {
</I>&gt;&gt;&gt;<i>      &lt;30 0B&gt;
</I>&gt;&gt;&gt;<i>   37  11:           SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 09&gt;
</I>&gt;&gt;&gt;<i>   39   9:             OBJECT IDENTIFIER sha-256 (2 16 840 1 101 3 4 2 1)
</I>&gt;&gt;&gt;<i>         :               (NIST Algorithm)
</I>&gt;&gt;&gt;<i>         :             }
</I>&gt;&gt;&gt;<i>         :           }
</I>&gt;&gt;&gt;<i>      &lt;30 82 01 1B&gt;
</I>&gt;&gt;&gt;<i>   50 283:         SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 0B&gt;
</I>&gt;&gt;&gt;<i>   54  11:           OBJECT IDENTIFIER tSTInfo (1 2 840 113549 1 9 16 1 4)
</I>&gt;&gt;&gt;<i>         :             (S/MIME Content Types)
</I>&gt;&gt;&gt;<i>      &lt;A0 82 01 0A&gt;
</I>&gt;&gt;&gt;<i>   67 266:           [0] {
</I>&gt;&gt;&gt;<i>      &lt;04 82 01 06&gt;
</I>&gt;&gt;&gt;<i>   71 262:             OCTET STRING, encapsulates {
</I>&gt;&gt;&gt;<i>      &lt;30 82 01 02&gt;
</I>&gt;&gt;&gt;<i>   75 258:               SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;02 01&gt;
</I>&gt;&gt;&gt;<i>   79   1:                 INTEGER 1
</I>&gt;&gt;&gt;<i>      &lt;06 0B&gt;
</I>&gt;&gt;&gt;<i>   82  11:                 OBJECT IDENTIFIER '2 16 840 1 113733 1 7 23 3'
</I>&gt;&gt;&gt;<i>      &lt;30 31&gt;
</I>&gt;&gt;&gt;<i>   95  49:                 SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;30 0D&gt;
</I>&gt;&gt;&gt;<i>   97  13:                   SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 09&gt;
</I>&gt;&gt;&gt;<i>   99   9:                     OBJECT IDENTIFIER sha-256 (2 16 840 1 101 3
</I>&gt;&gt;&gt;<i> 4 2 1)
</I>&gt;&gt;&gt;<i>         :                       (NIST Algorithm)
</I>&gt;&gt;&gt;<i>      &lt;05 00&gt;
</I>&gt;&gt;&gt;<i> 110   0:                     NULL
</I>&gt;&gt;&gt;<i>         :                     }
</I>&gt;&gt;&gt;<i>      &lt;04 20&gt;
</I>&gt;&gt;&gt;<i> 112  32:                   OCTET STRING
</I>&gt;&gt;&gt;<i>         :                     8C 6D 95 5B E0 CD 8B C9    .m.[....
</I>&gt;&gt;&gt;<i>         :                     DF 8C AB 57 45 C4 69 E6    ...WE.i.
</I>&gt;&gt;&gt;<i>         :                     7A B9 CE CB 14 8F 55 25    z.....U%
</I>&gt;&gt;&gt;<i>         :                     91 2E 57 37 3E 5C B8 D5
</I>&gt;&gt;&gt;<i>         :                   }
</I>&gt;&gt;&gt;<i>      &lt;02 14&gt;
</I>&gt;&gt;&gt;<i> 146  20:                 INTEGER
</I>&gt;&gt;&gt;<i>         :                   57 0B 9C 3A 11 CA 31 8E    W..:..1.
</I>&gt;&gt;&gt;<i>         :                   24 78 D3 68 0C 0F EF D9    $x.h....
</I>&gt;&gt;&gt;<i>         :                   23 8E 06 AB                #...
</I>&gt;&gt;&gt;<i>      &lt;18 0F&gt;
</I>&gt;&gt;&gt;<i> 168  15:                 GeneralizedTime 19/04/2016 03:52:25 GMT
</I>&gt;&gt;&gt;<i>      &lt;30 03&gt;
</I>&gt;&gt;&gt;<i> 185   3:                 SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;02 01&gt;
</I>&gt;&gt;&gt;<i> 187   1:                   INTEGER 30
</I>&gt;&gt;&gt;<i>         :                   }
</I>&gt;&gt;&gt;<i>      &lt;02 08&gt;
</I>&gt;&gt;&gt;<i> 190   8:                 INTEGER 58 0E 59 D8 7F 39 6B 25
</I>&gt;&gt;&gt;<i>      &lt;A0 81 86&gt;
</I>&gt;&gt;&gt;<i> 200 134:                 [0] {
</I>&gt;&gt;&gt;<i>      &lt;A4 81 83&gt;
</I>&gt;&gt;&gt;<i> 203 131:                   [4] {
</I>&gt;&gt;&gt;<i>      &lt;30 81 80&gt;
</I>&gt;&gt;&gt;<i> 206 128:                     SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;31 0B&gt;
</I>&gt;&gt;&gt;<i> 209  11:                       SET {
</I>&gt;&gt;&gt;<i>      &lt;30 09&gt;
</I>&gt;&gt;&gt;<i> 211   9:                         SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 03&gt;
</I>&gt;&gt;&gt;<i> 213   3:                           OBJECT IDENTIFIER countryName (2 5 4 6)
</I>&gt;&gt;&gt;<i>         :                             (X.520 DN component)
</I>&gt;&gt;&gt;<i>      &lt;13 02&gt;
</I>&gt;&gt;&gt;<i> 218   2:                           PrintableString 'US'
</I>&gt;&gt;&gt;<i>         :                           }
</I>&gt;&gt;&gt;<i>         :                         }
</I>&gt;&gt;&gt;<i>      &lt;31 1D&gt;
</I>&gt;&gt;&gt;<i> 222  29:                       SET {
</I>&gt;&gt;&gt;<i>      &lt;30 1B&gt;
</I>&gt;&gt;&gt;<i> 224  27:                         SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 03&gt;
</I>&gt;&gt;&gt;<i> 226   3:                           OBJECT IDENTIFIER organizationName (2 5
</I>&gt;&gt;&gt;<i> 4 10)
</I>&gt;&gt;&gt;<i>         :                             (X.520 DN component)
</I>&gt;&gt;&gt;<i>      &lt;13 14&gt;
</I>&gt;&gt;&gt;<i> 231  20:                           PrintableString 'Symantec Corporation'
</I>&gt;&gt;&gt;<i>         :                           }
</I>&gt;&gt;&gt;<i>         :                         }
</I>&gt;&gt;&gt;<i>      &lt;31 1F&gt;
</I>&gt;&gt;&gt;<i> 253  31:                       SET {
</I>&gt;&gt;&gt;<i>      &lt;30 1D&gt;
</I>&gt;&gt;&gt;<i> 255  29:                         SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 03&gt;
</I>&gt;&gt;&gt;<i> 257   3:                           OBJECT IDENTIFIER
</I>&gt;&gt;&gt;<i>         :                             organizationalUnitName (2 5 4 11)
</I>&gt;&gt;&gt;<i>         :                             (X.520 DN component)
</I>&gt;&gt;&gt;<i>      &lt;13 16&gt;
</I>&gt;&gt;&gt;<i> 262  22:                           PrintableString 'Symantec Trust
</I>&gt;&gt;&gt;<i> Network'
</I>&gt;&gt;&gt;<i>         :                           }
</I>&gt;&gt;&gt;<i>         :                         }
</I>&gt;&gt;&gt;<i>      &lt;31 31&gt;
</I>&gt;&gt;&gt;<i> 286  49:                       SET {
</I>&gt;&gt;&gt;<i>      &lt;30 2F&gt;
</I>&gt;&gt;&gt;<i> 288  47:                         SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 03&gt;
</I>&gt;&gt;&gt;<i> 290   3:                           OBJECT IDENTIFIER commonName (2 5 4 3)
</I>&gt;&gt;&gt;<i>         :                             (X.520 DN component)
</I>&gt;&gt;&gt;<i>      &lt;13 28&gt;
</I>&gt;&gt;&gt;<i> 295  40:                           PrintableString 'Symantec SHA256
</I>&gt;&gt;&gt;<i> TimeStamping Signer - G1'
</I>&gt;&gt;&gt;<i>         :                           }
</I>&gt;&gt;&gt;<i>         :                         }
</I>&gt;&gt;&gt;<i>         :                       }
</I>&gt;&gt;&gt;<i>         :                     }
</I>&gt;&gt;&gt;<i>         :                   }
</I>&gt;&gt;&gt;<i>         :                 }
</I>&gt;&gt;&gt;<i>         :               }
</I>&gt;&gt;&gt;<i>         :             }
</I>&gt;&gt;&gt;<i>         :           }
</I>&gt;&gt;&gt;<i>      &lt;31 82 02 5A&gt;
</I>&gt;&gt;&gt;<i> 337 602:         SET {
</I>&gt;&gt;&gt;<i>      &lt;30 82 02 56&gt;
</I>&gt;&gt;&gt;<i> 341 598:           SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;02 01&gt;
</I>&gt;&gt;&gt;<i> 345   1:             INTEGER 1
</I>&gt;&gt;&gt;<i>      &lt;30 81 8B&gt;
</I>&gt;&gt;&gt;<i> 348 139:             SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;30 77&gt;
</I>&gt;&gt;&gt;<i> 351 119:               SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;31 0B&gt;
</I>&gt;&gt;&gt;<i> 353  11:                 SET {
</I>&gt;&gt;&gt;<i>      &lt;30 09&gt;
</I>&gt;&gt;&gt;<i> 355   9:                   SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 03&gt;
</I>&gt;&gt;&gt;<i> 357   3:                     OBJECT IDENTIFIER countryName (2 5 4 6)
</I>&gt;&gt;&gt;<i>         :                       (X.520 DN component)
</I>&gt;&gt;&gt;<i>      &lt;13 02&gt;
</I>&gt;&gt;&gt;<i> 362   2:                     PrintableString 'US'
</I>&gt;&gt;&gt;<i>         :                     }
</I>&gt;&gt;&gt;<i>         :                   }
</I>&gt;&gt;&gt;<i>      &lt;31 1D&gt;
</I>&gt;&gt;&gt;<i> 366  29:                 SET {
</I>&gt;&gt;&gt;<i>      &lt;30 1B&gt;
</I>&gt;&gt;&gt;<i> 368  27:                   SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 03&gt;
</I>&gt;&gt;&gt;<i> 370   3:                     OBJECT IDENTIFIER organizationName (2 5 4 10)
</I>&gt;&gt;&gt;<i>         :                       (X.520 DN component)
</I>&gt;&gt;&gt;<i>      &lt;13 14&gt;
</I>&gt;&gt;&gt;<i> 375  20:                     PrintableString 'Symantec Corporation'
</I>&gt;&gt;&gt;<i>         :                     }
</I>&gt;&gt;&gt;<i>         :                   }
</I>&gt;&gt;&gt;<i>      &lt;31 1F&gt;
</I>&gt;&gt;&gt;<i> 397  31:                 SET {
</I>&gt;&gt;&gt;<i>      &lt;30 1D&gt;
</I>&gt;&gt;&gt;<i> 399  29:                   SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 03&gt;
</I>&gt;&gt;&gt;<i> 401   3:                     OBJECT IDENTIFIER organizationalUnitName (2 5
</I>&gt;&gt;&gt;<i> 4 11)
</I>&gt;&gt;&gt;<i>         :                       (X.520 DN component)
</I>&gt;&gt;&gt;<i>      &lt;13 16&gt;
</I>&gt;&gt;&gt;<i> 406  22:                     PrintableString 'Symantec Trust Network'
</I>&gt;&gt;&gt;<i>         :                     }
</I>&gt;&gt;&gt;<i>         :                   }
</I>&gt;&gt;&gt;<i>      &lt;31 28&gt;
</I>&gt;&gt;&gt;<i> 430  40:                 SET {
</I>&gt;&gt;&gt;<i>      &lt;30 26&gt;
</I>&gt;&gt;&gt;<i> 432  38:                   SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 03&gt;
</I>&gt;&gt;&gt;<i> 434   3:                     OBJECT IDENTIFIER commonName (2 5 4 3)
</I>&gt;&gt;&gt;<i>         :                       (X.520 DN component)
</I>&gt;&gt;&gt;<i>      &lt;13 1F&gt;
</I>&gt;&gt;&gt;<i> 439  31:                     PrintableString 'Symantec SHA256 TimeStamping
</I>&gt;&gt;&gt;<i> CA'
</I>&gt;&gt;&gt;<i>         :                     }
</I>&gt;&gt;&gt;<i>         :                   }
</I>&gt;&gt;&gt;<i>         :                 }
</I>&gt;&gt;&gt;<i>      &lt;02 10&gt;
</I>&gt;&gt;&gt;<i> 472  16:               INTEGER 54 F3 7D A1 71 67 51 BC 6A 8D 0A D2 74
</I>&gt;&gt;&gt;<i> B2 8B 13
</I>&gt;&gt;&gt;<i>         :               }
</I>&gt;&gt;&gt;<i>      &lt;30 0B&gt;
</I>&gt;&gt;&gt;<i> 490  11:             SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 09&gt;
</I>&gt;&gt;&gt;<i> 492   9:               OBJECT IDENTIFIER sha-256 (2 16 840 1 101 3 4 2 1)
</I>&gt;&gt;&gt;<i>         :                 (NIST Algorithm)
</I>&gt;&gt;&gt;<i>         :               }
</I>&gt;&gt;&gt;<i>      &lt;A0 81 A4&gt;
</I>&gt;&gt;&gt;<i> 503 164:             [0] {
</I>&gt;&gt;&gt;<i>      &lt;30 1A&gt;
</I>&gt;&gt;&gt;<i> 506  26:               SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 09&gt;
</I>&gt;&gt;&gt;<i> 508   9:                 OBJECT IDENTIFIER contentType (1 2 840 113549 1 9
</I>&gt;&gt;&gt;<i> 3)
</I>&gt;&gt;&gt;<i>         :                   (PKCS #9)
</I>&gt;&gt;&gt;<i>      &lt;31 0D&gt;
</I>&gt;&gt;&gt;<i> 519  13:                 SET {
</I>&gt;&gt;&gt;<i>      &lt;06 0B&gt;
</I>&gt;&gt;&gt;<i> 521  11:                   OBJECT IDENTIFIER tSTInfo (1 2 840 113549 1 9
</I>&gt;&gt;&gt;<i> 16 1 4)
</I>&gt;&gt;&gt;<i>         :                     (S/MIME Content Types)
</I>&gt;&gt;&gt;<i>         :                   }
</I>&gt;&gt;&gt;<i>         :                 }
</I>&gt;&gt;&gt;<i>      &lt;30 1C&gt;
</I>&gt;&gt;&gt;<i> 534  28:               SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 09&gt;
</I>&gt;&gt;&gt;<i> 536   9:                 OBJECT IDENTIFIER signingTime (1 2 840 113549 1 9
</I>&gt;&gt;&gt;<i> 5)
</I>&gt;&gt;&gt;<i>         :                   (PKCS #9)
</I>&gt;&gt;&gt;<i>      &lt;31 0F&gt;
</I>&gt;&gt;&gt;<i> 547  15:                 SET {
</I>&gt;&gt;&gt;<i>      &lt;17 0D&gt;
</I>&gt;&gt;&gt;<i> 549  13:                   UTCTime 19/04/2016 03:52:25 GMT
</I>&gt;&gt;&gt;<i>         :                   }
</I>&gt;&gt;&gt;<i>         :                 }
</I>&gt;&gt;&gt;<i>      &lt;30 2F&gt;
</I>&gt;&gt;&gt;<i> 564  47:               SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 09&gt;
</I>&gt;&gt;&gt;<i> 566   9:                 OBJECT IDENTIFIER messageDigest (1 2 840 113549 1
</I>&gt;&gt;&gt;<i> 9 4)
</I>&gt;&gt;&gt;<i>         :                   (PKCS #9)
</I>&gt;&gt;&gt;<i>      &lt;31 22&gt;
</I>&gt;&gt;&gt;<i> 577  34:                 SET {
</I>&gt;&gt;&gt;<i>      &lt;04 20&gt;
</I>&gt;&gt;&gt;<i> 579  32:                   OCTET STRING
</I>&gt;&gt;&gt;<i>         :                     98 1B CF E1 5D 96 79 D6    ....].y.
</I>&gt;&gt;&gt;<i>         :                     47 53 3E 27 A1 0C 57 4E    GS&gt;'..WN
</I>&gt;&gt;&gt;<i>         :                     62 48 8E 43 F8 B5 17 D4    bH.C....
</I>&gt;&gt;&gt;<i>         :                     1C 8F 9A 86 ED D7 A6 B4
</I>&gt;&gt;&gt;<i>         :                   }
</I>&gt;&gt;&gt;<i>         :                 }
</I>&gt;&gt;&gt;<i>      &lt;30 37&gt;
</I>&gt;&gt;&gt;<i> 613  55:               SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 0B&gt;
</I>&gt;&gt;&gt;<i> 615  11:                 OBJECT IDENTIFIER
</I>&gt;&gt;&gt;<i>         :                   signingCertificateV2 (1 2 840 113549 1 9 16 2
</I>&gt;&gt;&gt;<i> 47)
</I>&gt;&gt;&gt;<i>         :                   (S/MIME Authenticated Attributes)
</I>&gt;&gt;&gt;<i>      &lt;31 28&gt;
</I>&gt;&gt;&gt;<i> 628  40:                 SET {
</I>&gt;&gt;&gt;<i>      &lt;30 26&gt;
</I>&gt;&gt;&gt;<i> 630  38:                   SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;30 24&gt;
</I>&gt;&gt;&gt;<i> 632  36:                     SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;30 22&gt;
</I>&gt;&gt;&gt;<i> 634  34:                       SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;04 20&gt;
</I>&gt;&gt;&gt;<i> 636  32:                         OCTET STRING
</I>&gt;&gt;&gt;<i>         :                           82 D5 56 DB DB 5D AD 5F    ..V..]._
</I>&gt;&gt;&gt;<i>         :                           A0 7B B6 07 26 A6 D8 6E    .{..&amp;..n
</I>&gt;&gt;&gt;<i>         :                           73 0B 5B B7 29 88 5B B6    s.[.).[.
</I>&gt;&gt;&gt;<i>         :                           DE 4F F2 75 29 02 2C FC
</I>&gt;&gt;&gt;<i>         :                         }
</I>&gt;&gt;&gt;<i>         :                       }
</I>&gt;&gt;&gt;<i>         :                     }
</I>&gt;&gt;&gt;<i>         :                   }
</I>&gt;&gt;&gt;<i>         :                 }
</I>&gt;&gt;&gt;<i>         :               }
</I>&gt;&gt;&gt;<i>      &lt;30 0B&gt;
</I>&gt;&gt;&gt;<i> 670  11:             SEQUENCE {
</I>&gt;&gt;&gt;<i>      &lt;06 09&gt;
</I>&gt;&gt;&gt;<i> 672   9:               OBJECT IDENTIFIER rsaEncryption (1 2 840 113549 1 1
</I>&gt;&gt;&gt;<i> 1)
</I>&gt;&gt;&gt;<i>         :                 (PKCS #1)
</I>&gt;&gt;&gt;<i>         :               }
</I>&gt;&gt;&gt;<i>      &lt;04 82 01 00&gt;
</I>&gt;&gt;&gt;<i> 683 256:             OCTET STRING
</I>&gt;&gt;&gt;<i>         :               77 60 BE 64 F1 4C 04 B9    w`.d.L..
</I>&gt;&gt;&gt;<i>         :               4D 64 39 59 DC 53 27 02    Md9Y.S'.
</I>&gt;&gt;&gt;<i>         :               06 1F 0C C7 31 EC 5B A2    ....1.[.
</I>&gt;&gt;&gt;<i>         :               79 FB CA A3 07 DE D3 E6    y.......
</I>&gt;&gt;&gt;<i>         :               88 CE 84 37 4C 20 EF DF    ...7L ..
</I>&gt;&gt;&gt;<i>         :               9B BB D4 0B 6F DC 42 05    ....o.B.
</I>&gt;&gt;&gt;<i>         :               DA 8D 22 EF 24 A8 46 68    ..&quot;.$.Fh
</I>&gt;&gt;&gt;<i>         :               79 DA CB B5 A9 CD F6 7E    y......~
</I>&gt;&gt;&gt;<i>         :               D5 B8 D4 DD B4 44 5F 40    .....D_@
</I>&gt;&gt;&gt;<i>         :               0A A2 59 C8 3B 2C 52 6F    ..Y.;,Ro
</I>&gt;&gt;&gt;<i>         :               BE 88 6C D3 A4 F6 3C B1    ..l...&lt;.
</I>&gt;&gt;&gt;<i>         :               52 27 25 E3 E9 6F 4A 2B    R'%..oJ+
</I>&gt;&gt;&gt;<i>         :               C6 C4 CD EA 73 65 6C 04    ....sel.
</I>&gt;&gt;&gt;<i>         :               9A A4 79 4E A4 95 F4 F7    ..yN....
</I>&gt;&gt;&gt;<i>         :               1C C6 2E E8 D3 4B 01 8F    .....K..
</I>&gt;&gt;&gt;<i>         :               F2 0B 80 6C 28 67 3E 10    ...l(g&gt;.
</I>&gt;&gt;&gt;<i>         :               D7 76 1E C5 4E BF 87 37    .v..N..7
</I>&gt;&gt;&gt;<i>         :               CB 99 51 81 74 5C 50 57    ..Q.t\PW
</I>&gt;&gt;&gt;<i>         :               80 3F 5D 3E 84 76 12 0A    .?]&gt;.v..
</I>&gt;&gt;&gt;<i>         :               B0 A3 99 DF E5 3B A4 8F    .....;..
</I>&gt;&gt;&gt;<i>         :               DE 04 50 A8 E6 D0 00 6D    ..P....m
</I>&gt;&gt;&gt;<i>         :               61 21 B1 A9 A9 D6 05 79    a!.....y
</I>&gt;&gt;&gt;<i>         :               0A 00 FA D5 1D A6 D6 F8    ........
</I>&gt;&gt;&gt;<i>         :               6A 22 07 E5 BC 01 C1 E0    j&quot;......
</I>&gt;&gt;&gt;<i>         :               10 09 BD 92 09 B5 B7 29    .......)
</I>&gt;&gt;&gt;<i>         :               8B 6A 4D 28 C4 63 7A 4C    .jM(.czL
</I>&gt;&gt;&gt;<i>         :               8E 7A AF 87 5D BE A4 BD    .z..]...
</I>&gt;&gt;&gt;<i>         :               C1 20 9A D0 82 57 03 21    . ...W.!
</I>&gt;&gt;&gt;<i>         :               F3 E2 6F F5 44 22 F9 27    ..o.D&quot;.'
</I>&gt;&gt;&gt;<i>         :               41 9C 66 27 BB 52 39 E2    A.f'.R9.
</I>&gt;&gt;&gt;<i>         :               4B C8 2B 82 58 AC 0E AF    K.+.X...
</I>&gt;&gt;&gt;<i>         :               8D AE A5 C7 A5 1A A3 5E
</I>&gt;&gt;&gt;<i>         :             }
</I>&gt;&gt;&gt;<i>         :           }
</I>&gt;&gt;&gt;<i>         :         }
</I>&gt;&gt;&gt;<i>         :       }
</I>&gt;&gt;&gt;<i>         :     }
</I>&gt;&gt;&gt;<i>         :   }
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 19 April 2016 at 14:29, Jakob Bohm &lt;<A HREF="../../../mailman/listinfo/openssl-users.html">jb-openssl at wisemo.com</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> On 19/04/2016 05:55, Alex Samad wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Hi
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I have a SHA.sha file
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> /usr/bin/openssl ts -query -data SHA.sha -sha256 | /usr/bin/curl -s -H
</I>&gt;&gt;&gt;&gt;&gt;<i> Content-Type:application/timestamp-query --data-binary @-
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="http://sha256timestamp.ws.symantec.com/sha256/timestamp">http://sha256timestamp.ws.symantec.com/sha256/timestamp</A> &gt; SHA.sha.tsr
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> /usr/bin/openssl ts -reply -in SHA.sha.tsr -text  &gt; SHA.sha.ts.txt
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> cat SHA.sha.ts.txt
</I>&gt;&gt;&gt;&gt;&gt;<i> Status info:
</I>&gt;&gt;&gt;&gt;&gt;<i> Status: Granted.
</I>&gt;&gt;&gt;&gt;&gt;<i> Status description: unspecified
</I>&gt;&gt;&gt;&gt;&gt;<i> Failure info: unspecified
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> TST info:
</I>&gt;&gt;&gt;&gt;&gt;<i> Version: 1
</I>&gt;&gt;&gt;&gt;&gt;<i> Policy OID: 2.16.840.1.113733.1.7.23.3
</I>&gt;&gt;&gt;&gt;&gt;<i> Hash Algorithm: sha256
</I>&gt;&gt;&gt;&gt;&gt;<i> Message data:
</I>&gt;&gt;&gt;&gt;&gt;<i>       0000 - 8c 6d 95 5b e0 cd 8b c9-df 8c ab 57 45 c4 69 e6
</I>&gt;&gt;&gt;&gt;&gt;<i> .m.[.......WE.i.
</I>&gt;&gt;&gt;&gt;&gt;<i>       0010 - 7a b9 ce cb 14 8f 55 25-91 2e 57 37 3e 5c b8 d5
</I>&gt;&gt;&gt;&gt;&gt;<i> z.....U%..W7&gt;\..
</I>&gt;&gt;&gt;&gt;&gt;<i> Serial number: 0x570B9C3A11CA318E2478D3680C0FEFD9238E06AB
</I>&gt;&gt;&gt;&gt;&gt;<i> Time stamp: Apr 19 03:52:25 2016 GMT
</I>&gt;&gt;&gt;&gt;&gt;<i> Accuracy: 0x1E seconds, unspecified millis, unspecified micros
</I>&gt;&gt;&gt;&gt;&gt;<i> Ordering: no
</I>&gt;&gt;&gt;&gt;&gt;<i> Nonce: 0x580E59D87F396B25
</I>&gt;&gt;&gt;&gt;&gt;<i> TSA: DirName:/C=US/O=Symantec Corporation/OU=Symantec Trust
</I>&gt;&gt;&gt;&gt;&gt;<i> Network/CN=Symantec SHA256 TimeStamping Signer - G1
</I>&gt;&gt;&gt;&gt;&gt;<i> Extensions:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> But when I go to verify it
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>    openssl ts -verify -data SHA.sha -in SHA.sha.tsr
</I>&gt;&gt;&gt;&gt;&gt;<i> Verification: FAILED
</I>&gt;&gt;&gt;&gt;&gt;<i> 140569777235784:error:2107C080:PKCS7
</I>&gt;&gt;&gt;&gt;&gt;<i> routines:PKCS7_get0_signers:signer certificate not
</I>&gt;&gt;&gt;&gt;&gt;<i> found:pk7_smime.c:476:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> is this because I didn't provide a cert to sign it with ?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> No, it is because it cannot find the certificate that Symantec
</I>&gt;&gt;&gt;&gt;<i> used to sign the response, specifically the certificate with
</I>&gt;&gt;&gt;&gt;<i> Subject name &quot;/C=US/O=Symantec Corporation/OU=Symantec Trust
</I>&gt;&gt;&gt;&gt;<i> Network/CN=Symantec SHA256 TimeStamping Signer - G1&quot;.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I am kind of disappointed in how little detail is included in
</I>&gt;&gt;&gt;&gt;<i> the output from ts -reply -text, I expected it to output all
</I>&gt;&gt;&gt;&gt;<i> the fields, similar to what other openssl commands do when
</I>&gt;&gt;&gt;&gt;<i> passed the -text option.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> So I guess the next step would be to dump SHA.sha.tsr using
</I>&gt;&gt;&gt;&gt;<i> Peter Gutmann's dumpasn1.c program, something like
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> openssl base64 -d -in SHA.sha.tsr -out SHA.sha.tsr.bin
</I>&gt;&gt;&gt;&gt;<i> dumpasn1 -v SHA.sha.tsr.bin
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Enjoy
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Jakob
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> Jakob Bohm, CIO, Partner, WiseMo A/S.  <A HREF="https://www.wisemo.com">https://www.wisemo.com</A>
</I>&gt;&gt;<i> Transformervej 29, 2860 S&#248;borg, Denmark.  Direct +45 31 13 16 10
</I>&gt;&gt;<i> This public discussion message is non-binding and may contain errors.
</I>&gt;&gt;<i> WiseMo - Remote Service Management for PCs, Phones and Embedded
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> openssl-users mailing list
</I>&gt;&gt;<i> To unsubscribe: <A HREF="../../../mailman/listinfo/openssl-users.html">https://mta.openssl.org/mailman/listinfo/openssl-users</A>
</I></PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003645.html">[openssl-users] Changing IV in EVP API?
</A></li>
	<LI>Next message: <A HREF="003736.html">[openssl-users] help with timestamping
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3648">[ date ]</a>
              <a href="thread.html#3648">[ thread ]</a>
              <a href="subject.html#3648">[ subject ]</a>
              <a href="author.html#3648">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
