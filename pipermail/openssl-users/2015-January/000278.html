<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openssl-users] Possible bug in DSA_verify() since CVE-2014-8275 patch (present in 1.0.1k and 1.0.1l)
   </TITLE>
   <LINK REL="Index" HREF="https://mta.openssl.org/pipermail/openssl-users/2015-January/index.html" >
   <LINK REL="made" HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Possible%20bug%20in%20DSA_verify%28%29%20since%0A%20CVE-2014-8275%20patch%20%28present%20in%201.0.1k%20and%201.0.1l%29&In-Reply-To=%3C54B96448.7080707%40invoxia.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000277.html">
   <LINK REL="Next"  HREF="000281.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openssl-users] Possible bug in DSA_verify() since CVE-2014-8275 patch (present in 1.0.1k and 1.0.1l)</H1>
    <B>arnaud.mouiche at invoxia.com</B> 
    <A HREF="mailto:openssl-users%40openssl.org?Subject=Re%3A%20%5Bopenssl-users%5D%20Possible%20bug%20in%20DSA_verify%28%29%20since%0A%20CVE-2014-8275%20patch%20%28present%20in%201.0.1k%20and%201.0.1l%29&In-Reply-To=%3C54B96448.7080707%40invoxia.com%3E"
       TITLE="[openssl-users] Possible bug in DSA_verify() since CVE-2014-8275 patch (present in 1.0.1k and 1.0.1l)">arnaud.mouiche at invoxia.com
       </A><BR>
    <I>Fri Jan 16 19:19:36 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="000277.html">[openssl-users] Possible bug in DSA_verify() since CVE-2014-8275 patch (present in 1.0.1k and 1.0.1l)
</A></li>
        <LI>Next message: <A HREF="000281.html">[openssl-users] Possible bug in DSA_verify() since CVE-2014-8275 patch (present in 1.0.1k and 1.0.1l)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#278">[ date ]</a>
              <a href="thread.html#278">[ thread ]</a>
              <a href="subject.html#278">[ subject ]</a>
              <a href="author.html#278">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Le 16/01/2015 19:57, Dr. Stephen Henson a &#233;crit :
&gt;<i> On Fri, Jan 16, 2015, <A HREF="../../../mailman/listinfo/openssl-users.html">arnaud.mouiche at invoxia.com</A> wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi all.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I was just checking the latest 1.0.1l version (running previously
</I>&gt;&gt;<i> the 1.0.1i).
</I>&gt;&gt;<i> some DSA signature check done with DSA_verify() are not working any
</I>&gt;&gt;<i> more, for at least one private/public key I'm using.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The public key was generated from the private key, long time ago, as
</I>&gt;&gt;<i> usual with command &quot;openssl dsa -in key.priv -out key.pub -pubout&quot;
</I>&gt;&gt;<i> So, it is not a forged key.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Here is the various things I tried / see.
</I>&gt;&gt;<i> I someone can tell me if this is an openssl issue, or simply the way
</I>&gt;&gt;<i> I'm using openssl lib, I will appreciate.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1) I imagine first that old generated keys are no more valid one to
</I>&gt;&gt;<i> enforce the CVE-2014-8275 warning, yet,
</I>&gt;&gt;<i> generating a new public key with the new openssl version lead to the
</I>&gt;&gt;<i> same issue.
</I>&gt;&gt;<i>
</I>&gt;<i> No this should have no effect on previous keys.
</I>&gt;<i>
</I>&gt;<i> CVE-2014-8275 makes signature checking for DSA/ECDSA more strict and some
</I>&gt;<i> invalid encodings are no longer tolerated.
</I>&gt;<i>
</I>&gt;<i> What produced the signature that is now being rejected? Is it OpenSSL or some
</I>&gt;<i> other library? How are you obtaining the length of the signature?
</I>
DSA_verify() stops at the public key length check, and don't even check the signature.
I'm only using openssl tools/lib
- the private key was generate few years ago with openssl (don't remember the version)
- the public key was generated with openssl with &quot;openssl dsa -in key.priv -out key.pub -pubout&quot;
and the resulting public key file, is rejected by DSA_verify() (even if I'm using last 1.0.1l version to generate this public key file
- the signature is DSA signing of a sha256 hash

If you want to know about the signature, it was generating by signing the hash result

&gt;<i>
</I>&gt;<i> There are ways to workaround the stricter checks by reencoding the signature
</I>&gt;<i> yourself or calling DSA_do_verify after decoding the signature yourself.
</I>I have no issue to hack my tools to make it work by calling 
DSA_do_verify() directly (ie. skipping the public key length)
Yet, I worry about any other software (not mine) that may failed for the 
same reasons, whereas working fine before.
Again, the public key was generated by openssl itself. It seems wrong 
that openssl didn't like it now.

Regards,
arnaud
&gt;<i>
</I>&gt;<i> Steve.
</I>&gt;<i> --
</I>&gt;<i> Dr Stephen N. Henson. OpenSSL project core developer.
</I>&gt;<i> Commercial tech support now available see: <A HREF="http://www.openssl.org">http://www.openssl.org</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> openssl-users mailing list
</I>&gt;<i> To unsubscribe: <A HREF="../../../mailman/listinfo/openssl-users.html">https://mta.openssl.org/mailman/listinfo/openssl-users</A>
</I>
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000277.html">[openssl-users] Possible bug in DSA_verify() since CVE-2014-8275 patch (present in 1.0.1k and 1.0.1l)
</A></li>
	<LI>Next message: <A HREF="000281.html">[openssl-users] Possible bug in DSA_verify() since CVE-2014-8275 patch (present in 1.0.1k and 1.0.1l)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#278">[ date ]</a>
              <a href="thread.html#278">[ thread ]</a>
              <a href="subject.html#278">[ subject ]</a>
              <a href="author.html#278">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/openssl-users.html">More information about the openssl-users
mailing list</a><br>
</body></html>
